nohup: ignoring input
Map:   0%|          | 0/11314 [00:00<?, ? examples/s]Map:   9%|▉         | 1000/11314 [00:00<00:01, 5722.76 examples/s]Map:  18%|█▊        | 2000/11314 [00:00<00:01, 5424.69 examples/s]Map:  27%|██▋       | 3000/11314 [00:00<00:01, 6187.91 examples/s]Map:  35%|███▌      | 4000/11314 [00:00<00:01, 5938.75 examples/s]Map:  44%|████▍     | 5000/11314 [00:00<00:01, 5758.11 examples/s]Map:  53%|█████▎    | 6000/11314 [00:01<00:00, 5863.63 examples/s]Map:  62%|██████▏   | 7000/11314 [00:01<00:00, 6120.91 examples/s]Map:  71%|███████   | 8000/11314 [00:01<00:00, 5970.40 examples/s]Map:  80%|███████▉  | 9000/11314 [00:01<00:00, 5805.95 examples/s]Map:  88%|████████▊ | 10000/11314 [00:01<00:00, 5623.65 examples/s]Map:  97%|█████████▋| 11000/11314 [00:01<00:00, 5977.69 examples/s]Map: 100%|██████████| 11314/11314 [00:02<00:00, 5631.98 examples/s]
Map:   0%|          | 0/7532 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7532 [00:00<00:00, 9493.91 examples/s]Map:  27%|██▋       | 2000/7532 [00:00<00:00, 7580.00 examples/s]Map:  40%|███▉      | 3000/7532 [00:00<00:00, 5608.02 examples/s]Map:  53%|█████▎    | 4000/7532 [00:00<00:00, 6631.26 examples/s]Map:  66%|██████▋   | 5000/7532 [00:00<00:00, 6766.44 examples/s]Map:  80%|███████▉  | 6000/7532 [00:01<00:00, 4595.58 examples/s]Map:  93%|█████████▎| 7000/7532 [00:01<00:00, 4812.83 examples/s]Map: 100%|██████████| 7532/7532 [00:01<00:00, 5053.77 examples/s]
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:02<00:05,  2.85s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:05<00:02,  2.62s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.10s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:06<00:00,  2.26s/it]
Some weights of LlamaForSequenceClassification were not initialized from the model checkpoint at ./model/models--llama-2-7b-hf/ and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
trainable params: 8,388,608 || all params: 6,615,814,144 || trainable%: 0.1268
the model architecture is 
PeftModelForCausalLM(
  (base_model): LoraModel(
    (model): LlamaForSequenceClassification(
      (model): LlamaModel(
        (embed_tokens): Embedding(32000, 4096)
        (layers): ModuleList(
          (0-31): 32 x LlamaDecoderLayer(
            (self_attn): LlamaAttention(
              (q_proj): lora.Linear(
                (base_layer): Linear(in_features=4096, out_features=4096, bias=False)
                (lora_dropout): ModuleDict(
                  (default): Dropout(p=0.05, inplace=False)
                )
                (lora_A): ModuleDict(
                  (default): Linear(in_features=4096, out_features=16, bias=False)
                )
                (lora_B): ModuleDict(
                  (default): Linear(in_features=16, out_features=4096, bias=False)
                )
                (lora_embedding_A): ParameterDict()
                (lora_embedding_B): ParameterDict()
                (lora_magnitude_vector): ModuleDict()
              )
              (k_proj): Linear(in_features=4096, out_features=4096, bias=False)
              (v_proj): lora.Linear(
                (base_layer): Linear(in_features=4096, out_features=4096, bias=False)
                (lora_dropout): ModuleDict(
                  (default): Dropout(p=0.05, inplace=False)
                )
                (lora_A): ModuleDict(
                  (default): Linear(in_features=4096, out_features=16, bias=False)
                )
                (lora_B): ModuleDict(
                  (default): Linear(in_features=16, out_features=4096, bias=False)
                )
                (lora_embedding_A): ParameterDict()
                (lora_embedding_B): ParameterDict()
                (lora_magnitude_vector): ModuleDict()
              )
              (o_proj): Linear(in_features=4096, out_features=4096, bias=False)
            )
            (mlp): LlamaMLP(
              (gate_proj): Linear(in_features=4096, out_features=11008, bias=False)
              (up_proj): Linear(in_features=4096, out_features=11008, bias=False)
              (down_proj): Linear(in_features=11008, out_features=4096, bias=False)
              (act_fn): SiLU()
            )
            (input_layernorm): LlamaRMSNorm((4096,), eps=1e-05)
            (post_attention_layernorm): LlamaRMSNorm((4096,), eps=1e-05)
          )
        )
        (norm): LlamaRMSNorm((4096,), eps=1e-05)
        (rotary_emb): LlamaRotaryEmbedding()
      )
      (score): Linear(in_features=4096, out_features=20, bias=False)
    )
  )
)
the number of packet is  782
ROUND:0
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:50,  2.82s/it]                                              {'loss': 4.8348, 'grad_norm': 38.202545166015625, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:50,  2.82s/it]  5%|▌         | 2/40 [00:04<01:29,  2.37s/it]                                              {'loss': 5.3637, 'grad_norm': 39.64714050292969, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:29,  2.37s/it]  8%|▊         | 3/40 [00:07<01:23,  2.26s/it]                                              {'loss': 5.5327, 'grad_norm': 40.84109878540039, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:07<01:23,  2.26s/it] 10%|█         | 4/40 [00:09<01:19,  2.21s/it]                                              {'loss': 4.1499, 'grad_norm': 35.45108413696289, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:11<01:16,  2.18s/it]                                              {'loss': 2.283, 'grad_norm': 28.43246078491211, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 4.6381, 'grad_norm': 34.17192077636719, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 4.9513, 'grad_norm': 34.28759765625, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 6.1056, 'grad_norm': 172.2063446044922, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.6793, 'grad_norm': 26.20722198486328, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:20<00:55,  1.84s/it]                                               {'loss': 0.622, 'grad_norm': 18.78696060180664, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:55,  1.84s/it] 28%|██▊       | 11/40 [00:22<00:56,  1.94s/it]                                               {'loss': 0.7888, 'grad_norm': 18.26917266845703, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:56,  1.94s/it] 30%|███       | 12/40 [00:24<00:56,  2.01s/it]                                               {'loss': 0.2284, 'grad_norm': 8.729957580566406, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.01s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.05s/it]                                               {'loss': 0.7522, 'grad_norm': 14.966772079467773, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.05s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it]                                               {'loss': 0.9307, 'grad_norm': 18.947587966918945, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it]                                               {'loss': 0.6187, 'grad_norm': 18.474349975585938, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it] 40%|████      | 16/40 [00:31<00:36,  1.54s/it]                                               {'loss': 0.0006, 'grad_norm': 0.07995030283927917, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.72s/it]                                               {'loss': 0.107, 'grad_norm': 9.559078216552734, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.72s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 0.0484, 'grad_norm': 3.4396302700042725, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.1061, 'grad_norm': 6.6468000411987305, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 0.2004, 'grad_norm': 10.168712615966797, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it]                                               {'loss': 0.3375, 'grad_norm': 12.534927368164062, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.11s/it]                                               {'loss': 0.2528, 'grad_norm': 9.952560424804688, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.11s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it]                                               {'loss': 0.0547, 'grad_norm': 4.083287239074707, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 0.5454, 'grad_norm': 73.11389923095703, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.0271, 'grad_norm': 3.040292263031006, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.0856, 'grad_norm': 6.168371200561523, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0347, 'grad_norm': 2.0667929649353027, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.05s/it]                                               {'loss': 0.0267, 'grad_norm': 1.546306848526001, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.0374, 'grad_norm': 2.8754124641418457, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.0192, 'grad_norm': 1.947796106338501, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.0086, 'grad_norm': 0.6378791332244873, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0024, 'grad_norm': 0.3286988437175751, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0059, 'grad_norm': 0.46013331413269043, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.0206, 'grad_norm': 2.6948602199554443, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.0085, 'grad_norm': 1.0792332887649536, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0566, 'grad_norm': 5.574926376342773, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0232, 'grad_norm': 2.0326738357543945, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.18s/it]                                               {'loss': 0.0467, 'grad_norm': 4.856334686279297, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]                                               {'loss': 0.0045, 'grad_norm': 0.33810919523239136, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0001, 'grad_norm': 0.012074122205376625, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.4827, 'train_samples_per_second': 7.199, 'train_steps_per_second': 0.51, 'train_loss': 1.138491532302578, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:64
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 6.1093, 'grad_norm': 6.204586982727051, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 5.7396, 'grad_norm': 2.6603543758392334, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 5.513, 'grad_norm': 2.914773464202881, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 4.1841, 'grad_norm': 5.483545303344727, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.904, 'grad_norm': 11.42907428741455, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.2528, 'grad_norm': 21.128366470336914, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 3.7267, 'grad_norm': 40.234004974365234, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.87, 'grad_norm': 203.63621520996094, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 1.8934, 'grad_norm': 5.910005569458008, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.8381, 'grad_norm': 5.263684272766113, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 3.0311, 'grad_norm': 9.243249893188477, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 3.0846, 'grad_norm': 8.402016639709473, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 2.6215, 'grad_norm': 26.512920379638672, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 2.4901, 'grad_norm': 6.119847297668457, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it]                                               {'loss': 1.4065, 'grad_norm': 5.10765266418457, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 1.0767, 'grad_norm': 23.523296356201172, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 1.1606, 'grad_norm': 4.690975189208984, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.7625, 'grad_norm': 4.5660271644592285, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it]                                               {'loss': 1.164, 'grad_norm': 4.507815361022949, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 1.3125, 'grad_norm': 8.208125114440918, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.9989, 'grad_norm': 5.312363624572754, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.8728, 'grad_norm': 8.003802299499512, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.7335, 'grad_norm': 7.699149131774902, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 2.6055, 'grad_norm': 9.948537826538086, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.3542, 'grad_norm': 2.3844401836395264, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.4666, 'grad_norm': 7.963910102844238, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.422, 'grad_norm': 3.5255696773529053, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.3431, 'grad_norm': 4.1174421310424805, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.5352, 'grad_norm': 4.453907012939453, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.3531, 'grad_norm': 3.162229299545288, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.6271, 'grad_norm': 4.984827041625977, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.5515, 'grad_norm': 10.712860107421875, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.0898, 'grad_norm': 1.2343460321426392, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.2254, 'grad_norm': 1.8105422258377075, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.1864, 'grad_norm': 3.360757827758789, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.2652, 'grad_norm': 4.651397705078125, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.7345, 'grad_norm': 6.114809513092041, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.698, 'grad_norm': 6.787680625915527, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.4, 'grad_norm': 4.751781940460205, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0066, 'grad_norm': 0.43987053632736206, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.3085, 'train_samples_per_second': 7.124, 'train_steps_per_second': 0.504, 'train_loss': 1.7902616769541055, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 4.1298, 'grad_norm': 3.5641934871673584, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 5.5608, 'grad_norm': 20.06470489501953, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 5.455, 'grad_norm': 2.7899622917175293, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 5.8932, 'grad_norm': 4.285428047180176, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 4.3497, 'grad_norm': 3.867373466491699, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it]                                              {'loss': 2.9435, 'grad_norm': 6.569112777709961, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 3.7478, 'grad_norm': 3.8589563369750977, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 2.8424, 'grad_norm': 18.64139747619629, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.5791, 'grad_norm': 4.647568702697754, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 3.0205, 'grad_norm': 10.687585830688477, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 1.9495, 'grad_norm': 6.253343105316162, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.9739, 'grad_norm': 4.473371982574463, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 2.8736, 'grad_norm': 4.154457092285156, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.3319, 'grad_norm': 3.316744565963745, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it]                                               {'loss': 2.2352, 'grad_norm': 4.243130683898926, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 3.786, 'grad_norm': 24.04973602294922, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.9488, 'grad_norm': 3.0297393798828125, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.8638, 'grad_norm': 2.3290767669677734, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 1.3565, 'grad_norm': 3.988731861114502, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.6808, 'grad_norm': 4.354766368865967, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 1.09, 'grad_norm': 3.846198320388794, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.5861, 'grad_norm': 2.8018462657928467, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.7225, 'grad_norm': 4.015421390533447, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.0544, 'grad_norm': 1.7072038650512695, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.553, 'grad_norm': 2.132065773010254, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.4269, 'grad_norm': 3.0339462757110596, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 1.2404, 'grad_norm': 2.887172222137451, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.2629, 'grad_norm': 3.437431812286377, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.2808, 'grad_norm': 2.6072640419006348, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.547, 'grad_norm': 3.033846855163574, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.5194, 'grad_norm': 9.035004615783691, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.0462, 'grad_norm': 1.7678617238998413, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.4125, 'grad_norm': 2.529059886932373, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.2844, 'grad_norm': 2.633523464202881, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.3232, 'grad_norm': 2.01692271232605, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.6488, 'grad_norm': 7.31478214263916, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it]                                               {'loss': 0.0731, 'grad_norm': 1.3484103679656982, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.5733, 'grad_norm': 3.6091861724853516, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.2856, 'grad_norm': 1.8756612539291382, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.1184, 'grad_norm': 3.4355719089508057, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.0841, 'train_samples_per_second': 7.144, 'train_steps_per_second': 0.506, 'train_loss': 1.6642718560993672, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 4.576, 'grad_norm': 2.9527552127838135, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 3.3663, 'grad_norm': 3.1602864265441895, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 4.2936, 'grad_norm': 11.01315975189209, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 3.6631, 'grad_norm': 5.507281303405762, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.0169, 'grad_norm': 6.459211349487305, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 3.2567, 'grad_norm': 6.836190700531006, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 3.9693, 'grad_norm': 22.21822738647461, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 10.086, 'grad_norm': 42.93578338623047, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 2.1132, 'grad_norm': 8.955940246582031, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 2.7883, 'grad_norm': 18.99003791809082, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 2.6467, 'grad_norm': 4.117117404937744, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.7518, 'grad_norm': 4.209500789642334, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 2.4925, 'grad_norm': 5.741426944732666, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 2.2357, 'grad_norm': 8.166536331176758, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 2.115, 'grad_norm': 4.789624214172363, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 5.3952, 'grad_norm': 22.853212356567383, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 1.2962, 'grad_norm': 5.624661922454834, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.5679, 'grad_norm': 6.663360595703125, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 1.6809, 'grad_norm': 18.65120506286621, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.7891, 'grad_norm': 60.57327651977539, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 1.3756, 'grad_norm': 9.527517318725586, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 1.6718, 'grad_norm': 4.217237949371338, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 1.4508, 'grad_norm': 10.276254653930664, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0055, 'grad_norm': 0.25206518173217773, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it]                                               {'loss': 0.3717, 'grad_norm': 3.1098926067352295, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.7934, 'grad_norm': 3.7049338817596436, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 1.219, 'grad_norm': 5.606001377105713, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.9447, 'grad_norm': 9.973555564880371, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.9359, 'grad_norm': 8.847100257873535, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.6092, 'grad_norm': 6.646665096282959, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 1.4217, 'grad_norm': 25.245952606201172, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:03<00:12,  1.58s/it]                                               {'loss': 1.2175, 'grad_norm': 28.72513198852539, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it]                                               {'loss': 0.8704, 'grad_norm': 8.268637657165527, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.3522, 'grad_norm': 2.5017049312591553, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.669, 'grad_norm': 1.6644123792648315, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.4052, 'grad_norm': 9.325589179992676, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.5518, 'grad_norm': 6.087669849395752, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.3912, 'grad_norm': 2.6808557510375977, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.6836, 'grad_norm': 3.407789468765259, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.031, 'grad_norm': 1.818658709526062, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.3333, 'train_samples_per_second': 7.122, 'train_steps_per_second': 0.504, 'train_loss': 1.9267805305309593, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:6
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.10s/it]                                              {'loss': 3.7543, 'grad_norm': 4.609455585479736, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.10s/it]  5%|▌         | 2/40 [00:04<01:20,  2.11s/it]                                              {'loss': 3.7091, 'grad_norm': 4.182503700256348, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.11s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 3.0379, 'grad_norm': 3.3873977661132812, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 3.1084, 'grad_norm': 3.4049220085144043, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 4.7093, 'grad_norm': 5.749637126922607, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 3.1549, 'grad_norm': 3.6591010093688965, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 4.5661, 'grad_norm': 9.192248344421387, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 2.7994, 'grad_norm': 15.932018280029297, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.5506, 'grad_norm': 3.145981550216675, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.1457, 'grad_norm': 4.008787155151367, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.2879, 'grad_norm': 8.269330978393555, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:23<00:56,  2.03s/it]                                               {'loss': 0.8574, 'grad_norm': 4.504936218261719, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 1.8101, 'grad_norm': 8.11905574798584, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 2.2033, 'grad_norm': 9.033846855163574, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:52,  2.12s/it]                                               {'loss': 2.8325, 'grad_norm': 8.763707160949707, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:52,  2.12s/it] 40%|████      | 16/40 [00:30<00:36,  1.53s/it]                                               {'loss': 0.0055, 'grad_norm': 0.19362927973270416, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.53s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it]                                               {'loss': 1.1148, 'grad_norm': 5.723783493041992, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 0.4185, 'grad_norm': 2.481828212738037, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.2331, 'grad_norm': 2.207692861557007, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 0.879, 'grad_norm': 3.94686222076416, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.6386, 'grad_norm': 8.176127433776855, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.11s/it]                                               {'loss': 0.4822, 'grad_norm': 11.468798637390137, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.11s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it]                                               {'loss': 0.5251, 'grad_norm': 4.007750988006592, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 0.0816, 'grad_norm': 2.572880744934082, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.4932, 'grad_norm': 2.4732985496520996, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.87s/it]                                               {'loss': 0.4359, 'grad_norm': 2.667314291000366, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.87s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it]                                               {'loss': 0.446, 'grad_norm': 5.331764221191406, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it] 70%|███████   | 28/40 [00:54<00:24,  2.04s/it]                                               {'loss': 0.4451, 'grad_norm': 4.107320308685303, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.04s/it] 72%|███████▎  | 29/40 [00:57<00:22,  2.09s/it]                                               {'loss': 0.3405, 'grad_norm': 3.307796001434326, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:22,  2.09s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.2371, 'grad_norm': 2.6432676315307617, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it]                                               {'loss': 0.4011, 'grad_norm': 6.124875545501709, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.0005, 'grad_norm': 0.02689465694129467, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.1264, 'grad_norm': 1.1642858982086182, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.1166, 'grad_norm': 2.8015859127044678, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.2138, 'grad_norm': 1.7517467737197876, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it]                                               {'loss': 0.1541, 'grad_norm': 3.5982460975646973, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.12s/it]                                               {'loss': 0.1429, 'grad_norm': 3.540712594985962, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it]                                               {'loss': 0.5023, 'grad_norm': 5.47459602355957, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.16s/it]                                               {'loss': 0.0659, 'grad_norm': 1.2158069610595703, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.16s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.0001, 'grad_norm': 0.007620168384164572, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 77.8399, 'train_samples_per_second': 7.258, 'train_steps_per_second': 0.514, 'train_loss': 1.2256713192087774, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]100%|██████████| 40/40 [01:17<00:00,  1.95s/it]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]                                              {'loss': 3.5244, 'grad_norm': 2.069477081298828, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 3.8792, 'grad_norm': 3.20417857170105, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 4.6732, 'grad_norm': 6.485666275024414, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 2.9727, 'grad_norm': 3.8221945762634277, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 3.9475, 'grad_norm': 3.603724241256714, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 3.7074, 'grad_norm': 3.383108377456665, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 5.1704, 'grad_norm': 8.55655288696289, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.1313, 'grad_norm': 14.168519020080566, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 2.9544, 'grad_norm': 3.8995625972747803, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.2369, 'grad_norm': 2.9779317378997803, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 2.4229, 'grad_norm': 4.070528507232666, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 2.2413, 'grad_norm': 4.53788423538208, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.3529, 'grad_norm': 4.519537925720215, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 2.236, 'grad_norm': 4.030803680419922, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.8093, 'grad_norm': 5.070850849151611, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 3.7285, 'grad_norm': 10.110733032226562, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.6843, 'grad_norm': 2.6281559467315674, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.7686, 'grad_norm': 7.945752143859863, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.7501, 'grad_norm': 6.535307884216309, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.5641, 'grad_norm': 8.55587100982666, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 1.1176, 'grad_norm': 5.05438756942749, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 1.0782, 'grad_norm': 14.769384384155273, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.8248, 'grad_norm': 11.449705123901367, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.3117, 'grad_norm': 9.816418647766113, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.6498, 'grad_norm': 7.240946292877197, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.6165, 'grad_norm': 2.5888853073120117, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.6861, 'grad_norm': 4.30048942565918, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.3294, 'grad_norm': 3.228325366973877, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.7571, 'grad_norm': 3.67608380317688, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.9208, 'grad_norm': 4.340247631072998, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1124, 'grad_norm': 1.2039220333099365, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 2.402, 'grad_norm': 10.879579544067383, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.075, 'grad_norm': 1.7079075574874878, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.3891, 'grad_norm': 3.6319899559020996, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.7475, 'grad_norm': 7.670087814331055, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.4064, 'grad_norm': 2.4097535610198975, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it]                                               {'loss': 0.0777, 'grad_norm': 1.277921438217163, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.1646, 'grad_norm': 1.577104091644287, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.3046, 'grad_norm': 3.108423948287964, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0614, 'grad_norm': 1.3562092781066895, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.8379, 'train_samples_per_second': 7.167, 'train_steps_per_second': 0.507, 'train_loss': 1.5197018439881504, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:43
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.11s/it]                                              {'loss': 5.4921, 'grad_norm': 3.4945180416107178, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.11s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 4.0456, 'grad_norm': 2.2079508304595947, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 5.9281, 'grad_norm': 4.0285515785217285, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 5.6036, 'grad_norm': 5.526296138763428, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 5.0339, 'grad_norm': 6.293701171875, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 4.9755, 'grad_norm': 10.252777099609375, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 3.9475, 'grad_norm': 6.591843605041504, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 5.5719, 'grad_norm': 23.13014030456543, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 2.6302, 'grad_norm': 6.085331439971924, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 3.1647, 'grad_norm': 9.30763053894043, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 2.3305, 'grad_norm': 6.101934909820557, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 2.5438, 'grad_norm': 14.626580238342285, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 3.6478, 'grad_norm': 5.5009541511535645, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 3.4597, 'grad_norm': 9.125650405883789, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 1.5266, 'grad_norm': 4.828287124633789, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 4.7913, 'grad_norm': 22.95377540588379, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 1.4817, 'grad_norm': 4.849359512329102, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 1.656, 'grad_norm': 5.001744747161865, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 1.5401, 'grad_norm': 15.50294303894043, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.8687, 'grad_norm': 8.57402515411377, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 1.2305, 'grad_norm': 6.227643013000488, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 2.364, 'grad_norm': 9.132661819458008, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 1.8933, 'grad_norm': 9.283147811889648, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 2.1016, 'grad_norm': 38.406734466552734, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.5795, 'grad_norm': 2.5089030265808105, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.6177, 'grad_norm': 12.070430755615234, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.3085, 'grad_norm': 3.5631792545318604, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 1.2634, 'grad_norm': 10.0642728805542, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.8337, 'grad_norm': 9.778494834899902, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.4931, 'grad_norm': 19.94988250732422, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 1.0369, 'grad_norm': 4.40725564956665, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0, 'grad_norm': 0.0011984120355919003, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.5556, 'grad_norm': 2.982515573501587, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.1496, 'grad_norm': 4.690309047698975, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.4355, 'grad_norm': 4.178236961364746, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.5811, 'grad_norm': 6.170414447784424, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.1792, 'grad_norm': 2.5618162155151367, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.2462, 'grad_norm': 14.564478874206543, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.2525, 'grad_norm': 6.7975921630859375, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'loss': 3.7545, 'grad_norm': 20.774688720703125, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'train_runtime': 79.3857, 'train_samples_per_second': 7.117, 'train_steps_per_second': 0.504, 'train_loss': 2.2278913229606587, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 6.7495, 'grad_norm': 3.6246273517608643, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 4.4517, 'grad_norm': 2.4475419521331787, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 4.9867, 'grad_norm': 3.861471176147461, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 5.7518, 'grad_norm': 3.8156492710113525, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it]                                              {'loss': 5.4774, 'grad_norm': 3.6791794300079346, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 4.1587, 'grad_norm': 3.7505648136138916, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 3.8752, 'grad_norm': 3.4947988986968994, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.0008, 'grad_norm': 0.011634672060608864, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 2.6843, 'grad_norm': 4.399175643920898, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 2.3782, 'grad_norm': 3.4844741821289062, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 2.5457, 'grad_norm': 3.600792169570923, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.9943, 'grad_norm': 6.168730735778809, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 2.4478, 'grad_norm': 5.864361763000488, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 1.7906, 'grad_norm': 6.52854585647583, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it]                                               {'loss': 1.9688, 'grad_norm': 5.756460189819336, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0572, 'grad_norm': 1.1482065916061401, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.7888, 'grad_norm': 5.262785911560059, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.8886, 'grad_norm': 3.2075796127319336, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it]                                               {'loss': 1.132, 'grad_norm': 4.299562454223633, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 1.2187, 'grad_norm': 12.631452560424805, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 1.1673, 'grad_norm': 10.08519458770752, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 1.2038, 'grad_norm': 14.931717872619629, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 1.0658, 'grad_norm': 7.85884428024292, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.3149, 'grad_norm': 13.851038932800293, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.494, 'grad_norm': 5.411025524139404, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.3386, 'grad_norm': 2.171588659286499, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.5683, 'grad_norm': 5.708359718322754, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.3305, 'grad_norm': 2.5958898067474365, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 1.1085, 'grad_norm': 10.553646087646484, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.6072, 'grad_norm': 5.376959800720215, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.3365, 'grad_norm': 3.128350019454956, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 2.9196, 'grad_norm': 16.272104263305664, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.1971, 'grad_norm': 3.57834792137146, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.355, 'grad_norm': 1.9671167135238647, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.259, 'grad_norm': 4.026686191558838, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.1058, 'grad_norm': 1.7757675647735596, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.7402, 'grad_norm': 204.05747985839844, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 2.2137, 'grad_norm': 39.633277893066406, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]                                               {'loss': 1.7949, 'grad_norm': 22.134174346923828, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.1348, 'grad_norm': 15.949902534484863, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.3522, 'train_samples_per_second': 7.12, 'train_steps_per_second': 0.504, 'train_loss': 1.7900539880036377, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:7
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 4.8426, 'grad_norm': 4.7622246742248535, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 5.0589, 'grad_norm': 7.372904300689697, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 5.052, 'grad_norm': 6.810824871063232, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 4.4393, 'grad_norm': 4.45886754989624, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 5.1996, 'grad_norm': 14.37547779083252, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 5.8267, 'grad_norm': 8.3374662399292, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 4.0384, 'grad_norm': 8.886507987976074, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 6.414, 'grad_norm': 54.46516799926758, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.77s/it]                                              {'loss': 2.5347, 'grad_norm': 3.73045015335083, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it]                                               {'loss': 2.8318, 'grad_norm': 10.208772659301758, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 2.3116, 'grad_norm': 7.731374740600586, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 1.9561, 'grad_norm': 3.718392848968506, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 2.3632, 'grad_norm': 4.513014793395996, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 2.7292, 'grad_norm': 4.945324420928955, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 2.2265, 'grad_norm': 8.585490226745605, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.6016, 'grad_norm': 12.506736755371094, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 1.9133, 'grad_norm': 4.697979927062988, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 1.203, 'grad_norm': 6.891681671142578, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 2.3314, 'grad_norm': 9.763080596923828, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 1.6712, 'grad_norm': 5.898464202880859, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 2.5493, 'grad_norm': 5.32457971572876, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.834, 'grad_norm': 7.547778606414795, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it]                                               {'loss': 1.3168, 'grad_norm': 6.5986104011535645, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 1.1469, 'grad_norm': 21.372350692749023, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 2.1127, 'grad_norm': 10.833770751953125, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.795, 'grad_norm': 4.114287853240967, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it]                                               {'loss': 0.6305, 'grad_norm': 2.9177865982055664, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.4527, 'grad_norm': 5.969194412231445, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.801, 'grad_norm': 2.9010825157165527, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.6274, 'grad_norm': 3.8523871898651123, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it]                                               {'loss': 0.5811, 'grad_norm': 3.4055659770965576, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it] 80%|████████  | 32/40 [01:03<00:12,  1.62s/it]                                               {'loss': 0.2737, 'grad_norm': 5.837772846221924, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.62s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.8834, 'grad_norm': 4.507558345794678, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.97s/it]                                               {'loss': 1.7057, 'grad_norm': 9.715414047241211, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.97s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.8059, 'grad_norm': 6.339997291564941, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 1.1317, 'grad_norm': 7.0382304191589355, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.3012, 'grad_norm': 4.321482181549072, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.6621, 'grad_norm': 5.555227756500244, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.5617, 'grad_norm': 2.4814722537994385, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0794, 'grad_norm': 1.7247108221054077, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.8289, 'train_samples_per_second': 7.078, 'train_steps_per_second': 0.501, 'train_loss': 2.0949292510747908, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 4.0403, 'grad_norm': 5.344676494598389, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 5.6166, 'grad_norm': 3.9645049571990967, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 5.0148, 'grad_norm': 3.3565943241119385, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:19,  2.22s/it]                                              {'loss': 2.6923, 'grad_norm': 4.596203804016113, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 4.3483, 'grad_norm': 3.4313302040100098, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 3.3922, 'grad_norm': 5.286221504211426, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 3.3329, 'grad_norm': 5.912651538848877, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.444, 'grad_norm': 7.279548168182373, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.6932, 'grad_norm': 2.7222187519073486, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.90s/it]                                               {'loss': 2.0368, 'grad_norm': 3.308657169342041, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 1.5526, 'grad_norm': 4.666678428649902, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.7319, 'grad_norm': 3.17098069190979, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 2.2571, 'grad_norm': 44.21757888793945, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it]                                               {'loss': 1.073, 'grad_norm': 4.723086833953857, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it]                                               {'loss': 1.6705, 'grad_norm': 8.521533012390137, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.0175, 'grad_norm': 0.6286733150482178, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 1.0952, 'grad_norm': 6.85893440246582, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it]                                               {'loss': 1.4116, 'grad_norm': 26.211750030517578, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 1.2289, 'grad_norm': 13.843728065490723, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:41,  2.10s/it]                                               {'loss': 0.7856, 'grad_norm': 14.563157081604004, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.2459, 'grad_norm': 3.555220365524292, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 1.0105, 'grad_norm': 3.7368319034576416, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.8516, 'grad_norm': 9.075003623962402, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.1099, 'grad_norm': 3.3154139518737793, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 1.2753, 'grad_norm': 14.912137985229492, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 1.1004, 'grad_norm': 7.288283348083496, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.8012, 'grad_norm': 5.010158061981201, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.12s/it]                                               {'loss': 0.455, 'grad_norm': 3.2612407207489014, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.9923, 'grad_norm': 4.559457302093506, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it]                                               {'loss': 0.7359, 'grad_norm': 2.528716564178467, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.4597, 'grad_norm': 4.063453674316406, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.002, 'grad_norm': 0.07149644941091537, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.2398, 'grad_norm': 2.863067626953125, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it]                                               {'loss': 0.5762, 'grad_norm': 5.133319854736328, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.3598, 'grad_norm': 4.040384769439697, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.3963, 'grad_norm': 4.923557758331299, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.2801, 'grad_norm': 1.8349578380584717, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.3205, 'grad_norm': 4.588656425476074, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.273, 'grad_norm': 2.5207667350769043, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0862, 'grad_norm': 6.179169654846191, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.9567, 'train_samples_per_second': 7.066, 'train_steps_per_second': 0.5, 'train_loss': 1.3751728948671371, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:53,  1.60it/s]  1%|          | 3/471 [00:02<06:55,  1.13it/s]  1%|          | 4/471 [00:03<08:01,  1.03s/it]  1%|          | 5/471 [00:05<08:38,  1.11s/it]  1%|▏         | 6/471 [00:06<09:00,  1.16s/it]  1%|▏         | 7/471 [00:07<09:16,  1.20s/it]  2%|▏         | 8/471 [00:08<09:26,  1.22s/it]  2%|▏         | 9/471 [00:10<09:32,  1.24s/it]  2%|▏         | 10/471 [00:11<09:36,  1.25s/it]  2%|▏         | 11/471 [00:12<09:38,  1.26s/it]  3%|▎         | 12/471 [00:13<09:40,  1.26s/it]  3%|▎         | 13/471 [00:15<09:41,  1.27s/it]  3%|▎         | 14/471 [00:16<09:41,  1.27s/it]  3%|▎         | 15/471 [00:17<09:41,  1.28s/it]  3%|▎         | 16/471 [00:19<09:42,  1.28s/it]  4%|▎         | 17/471 [00:20<09:41,  1.28s/it]  4%|▍         | 18/471 [00:21<09:41,  1.28s/it]  4%|▍         | 19/471 [00:22<09:40,  1.28s/it]  4%|▍         | 20/471 [00:24<09:40,  1.29s/it]  4%|▍         | 21/471 [00:25<09:39,  1.29s/it]  5%|▍         | 22/471 [00:26<09:39,  1.29s/it]  5%|▍         | 23/471 [00:28<09:38,  1.29s/it]  5%|▌         | 24/471 [00:29<09:38,  1.29s/it]  5%|▌         | 25/471 [00:30<09:37,  1.29s/it]  6%|▌         | 26/471 [00:32<09:36,  1.30s/it]  6%|▌         | 27/471 [00:33<09:35,  1.30s/it]  6%|▌         | 28/471 [00:34<09:34,  1.30s/it]  6%|▌         | 29/471 [00:35<09:33,  1.30s/it]  6%|▋         | 30/471 [00:37<09:33,  1.30s/it]  7%|▋         | 31/471 [00:38<09:32,  1.30s/it]  7%|▋         | 32/471 [00:39<09:30,  1.30s/it]  7%|▋         | 33/471 [00:41<09:27,  1.30s/it]  7%|▋         | 34/471 [00:42<09:27,  1.30s/it]  7%|▋         | 35/471 [00:43<09:27,  1.30s/it]  8%|▊         | 36/471 [00:45<09:24,  1.30s/it]  8%|▊         | 37/471 [00:46<09:24,  1.30s/it]  8%|▊         | 38/471 [00:47<09:24,  1.30s/it]  8%|▊         | 39/471 [00:48<09:22,  1.30s/it]  8%|▊         | 40/471 [00:50<09:21,  1.30s/it]  9%|▊         | 41/471 [00:51<09:20,  1.30s/it]  9%|▉         | 42/471 [00:52<09:20,  1.31s/it]  9%|▉         | 43/471 [00:54<09:18,  1.31s/it]  9%|▉         | 44/471 [00:55<09:16,  1.30s/it] 10%|▉         | 45/471 [00:56<09:16,  1.31s/it] 10%|▉         | 46/471 [00:58<09:15,  1.31s/it] 10%|▉         | 47/471 [00:59<09:14,  1.31s/it] 10%|█         | 48/471 [01:00<09:14,  1.31s/it] 10%|█         | 49/471 [01:02<09:13,  1.31s/it] 11%|█         | 50/471 [01:03<09:12,  1.31s/it] 11%|█         | 51/471 [01:04<09:11,  1.31s/it] 11%|█         | 52/471 [01:05<09:10,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:09,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:08,  1.32s/it] 12%|█▏        | 55/471 [01:09<09:07,  1.32s/it] 12%|█▏        | 56/471 [01:11<09:06,  1.32s/it] 12%|█▏        | 57/471 [01:12<09:05,  1.32s/it] 12%|█▏        | 58/471 [01:13<09:04,  1.32s/it] 13%|█▎        | 59/471 [01:15<09:03,  1.32s/it] 13%|█▎        | 60/471 [01:16<09:01,  1.32s/it] 13%|█▎        | 61/471 [01:17<09:00,  1.32s/it] 13%|█▎        | 62/471 [01:19<08:59,  1.32s/it] 13%|█▎        | 63/471 [01:20<08:57,  1.32s/it] 14%|█▎        | 64/471 [01:21<08:56,  1.32s/it] 14%|█▍        | 65/471 [01:23<08:55,  1.32s/it] 14%|█▍        | 66/471 [01:24<08:54,  1.32s/it] 14%|█▍        | 67/471 [01:25<08:53,  1.32s/it] 14%|█▍        | 68/471 [01:27<08:51,  1.32s/it] 15%|█▍        | 69/471 [01:28<08:50,  1.32s/it] 15%|█▍        | 70/471 [01:29<08:50,  1.32s/it] 15%|█▌        | 71/471 [01:31<08:48,  1.32s/it] 15%|█▌        | 72/471 [01:32<08:47,  1.32s/it] 15%|█▌        | 73/471 [01:33<08:45,  1.32s/it] 16%|█▌        | 74/471 [01:34<08:43,  1.32s/it] 16%|█▌        | 75/471 [01:36<08:43,  1.32s/it] 16%|█▌        | 76/471 [01:37<08:41,  1.32s/it] 16%|█▋        | 77/471 [01:38<08:40,  1.32s/it] 17%|█▋        | 78/471 [01:40<08:39,  1.32s/it] 17%|█▋        | 79/471 [01:41<08:39,  1.32s/it] 17%|█▋        | 80/471 [01:42<08:38,  1.33s/it] 17%|█▋        | 81/471 [01:44<08:36,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:35,  1.32s/it] 18%|█▊        | 83/471 [01:46<08:34,  1.33s/it] 18%|█▊        | 84/471 [01:48<08:33,  1.33s/it] 18%|█▊        | 85/471 [01:49<08:32,  1.33s/it] 18%|█▊        | 86/471 [01:50<08:30,  1.33s/it] 18%|█▊        | 87/471 [01:52<08:29,  1.33s/it] 19%|█▊        | 88/471 [01:53<08:27,  1.33s/it] 19%|█▉        | 89/471 [01:54<08:26,  1.33s/it] 19%|█▉        | 90/471 [01:56<08:26,  1.33s/it] 19%|█▉        | 91/471 [01:57<08:24,  1.33s/it] 20%|█▉        | 92/471 [01:58<08:22,  1.33s/it] 20%|█▉        | 93/471 [02:00<08:21,  1.33s/it] 20%|█▉        | 94/471 [02:01<08:20,  1.33s/it] 20%|██        | 95/471 [02:02<08:18,  1.33s/it] 20%|██        | 96/471 [02:04<08:16,  1.33s/it] 21%|██        | 97/471 [02:05<08:16,  1.33s/it] 21%|██        | 98/471 [02:06<08:14,  1.33s/it] 21%|██        | 99/471 [02:08<08:13,  1.33s/it] 21%|██        | 100/471 [02:09<08:12,  1.33s/it] 21%|██▏       | 101/471 [02:10<08:11,  1.33s/it] 22%|██▏       | 102/471 [02:12<08:10,  1.33s/it] 22%|██▏       | 103/471 [02:13<08:09,  1.33s/it] 22%|██▏       | 104/471 [02:14<08:07,  1.33s/it] 22%|██▏       | 105/471 [02:16<08:06,  1.33s/it] 23%|██▎       | 106/471 [02:17<08:04,  1.33s/it] 23%|██▎       | 107/471 [02:18<08:02,  1.33s/it] 23%|██▎       | 108/471 [02:20<08:00,  1.32s/it] 23%|██▎       | 109/471 [02:21<07:58,  1.32s/it] 23%|██▎       | 110/471 [02:22<07:56,  1.32s/it] 24%|██▎       | 111/471 [02:24<07:56,  1.32s/it] 24%|██▍       | 112/471 [02:25<07:55,  1.33s/it] 24%|██▍       | 113/471 [02:26<07:53,  1.32s/it] 24%|██▍       | 114/471 [02:28<07:53,  1.33s/it] 24%|██▍       | 115/471 [02:29<07:52,  1.33s/it] 25%|██▍       | 116/471 [02:30<07:51,  1.33s/it] 25%|██▍       | 117/471 [02:32<07:49,  1.33s/it] 25%|██▌       | 118/471 [02:33<07:48,  1.33s/it] 25%|██▌       | 119/471 [02:34<07:47,  1.33s/it] 25%|██▌       | 120/471 [02:36<07:46,  1.33s/it] 26%|██▌       | 121/471 [02:37<07:45,  1.33s/it] 26%|██▌       | 122/471 [02:38<07:43,  1.33s/it] 26%|██▌       | 123/471 [02:39<07:42,  1.33s/it] 26%|██▋       | 124/471 [02:41<07:41,  1.33s/it] 27%|██▋       | 125/471 [02:42<07:40,  1.33s/it] 27%|██▋       | 126/471 [02:43<07:38,  1.33s/it] 27%|██▋       | 127/471 [02:45<07:37,  1.33s/it] 27%|██▋       | 128/471 [02:46<07:35,  1.33s/it] 27%|██▋       | 129/471 [02:47<07:34,  1.33s/it] 28%|██▊       | 130/471 [02:49<07:32,  1.33s/it] 28%|██▊       | 131/471 [02:50<07:31,  1.33s/it] 28%|██▊       | 132/471 [02:51<07:30,  1.33s/it] 28%|██▊       | 133/471 [02:53<07:28,  1.33s/it] 28%|██▊       | 134/471 [02:54<07:28,  1.33s/it] 29%|██▊       | 135/471 [02:55<07:26,  1.33s/it] 29%|██▉       | 136/471 [02:57<07:24,  1.33s/it] 29%|██▉       | 137/471 [02:58<07:23,  1.33s/it] 29%|██▉       | 138/471 [02:59<07:22,  1.33s/it] 30%|██▉       | 139/471 [03:01<07:20,  1.33s/it] 30%|██▉       | 140/471 [03:02<07:19,  1.33s/it] 30%|██▉       | 141/471 [03:03<07:17,  1.33s/it] 30%|███       | 142/471 [03:05<07:16,  1.33s/it] 30%|███       | 143/471 [03:06<07:14,  1.32s/it] 31%|███       | 144/471 [03:07<07:13,  1.33s/it] 31%|███       | 145/471 [03:09<07:11,  1.32s/it] 31%|███       | 146/471 [03:10<07:10,  1.33s/it] 31%|███       | 147/471 [03:11<07:09,  1.33s/it] 31%|███▏      | 148/471 [03:13<07:08,  1.33s/it] 32%|███▏      | 149/471 [03:14<07:07,  1.33s/it] 32%|███▏      | 150/471 [03:15<07:06,  1.33s/it] 32%|███▏      | 151/471 [03:17<07:05,  1.33s/it] 32%|███▏      | 152/471 [03:18<07:03,  1.33s/it] 32%|███▏      | 153/471 [03:19<07:02,  1.33s/it] 33%|███▎      | 154/471 [03:21<07:00,  1.33s/it] 33%|███▎      | 155/471 [03:22<06:59,  1.33s/it] 33%|███▎      | 156/471 [03:23<06:57,  1.33s/it] 33%|███▎      | 157/471 [03:25<06:55,  1.32s/it] 34%|███▎      | 158/471 [03:26<06:54,  1.32s/it] 34%|███▍      | 159/471 [03:27<06:52,  1.32s/it] 34%|███▍      | 160/471 [03:29<06:52,  1.33s/it] 34%|███▍      | 161/471 [03:30<06:51,  1.33s/it] 34%|███▍      | 162/471 [03:31<06:50,  1.33s/it] 35%|███▍      | 163/471 [03:33<06:48,  1.33s/it] 35%|███▍      | 164/471 [03:34<06:46,  1.33s/it] 35%|███▌      | 165/471 [03:35<06:45,  1.33s/it] 35%|███▌      | 166/471 [03:37<06:44,  1.33s/it] 35%|███▌      | 167/471 [03:38<06:43,  1.33s/it] 36%|███▌      | 168/471 [03:39<06:42,  1.33s/it] 36%|███▌      | 169/471 [03:41<06:41,  1.33s/it] 36%|███▌      | 170/471 [03:42<06:39,  1.33s/it] 36%|███▋      | 171/471 [03:43<06:38,  1.33s/it] 37%|███▋      | 172/471 [03:45<06:36,  1.33s/it] 37%|███▋      | 173/471 [03:46<06:35,  1.33s/it] 37%|███▋      | 174/471 [03:47<06:34,  1.33s/it] 37%|███▋      | 175/471 [03:49<06:32,  1.33s/it] 37%|███▋      | 176/471 [03:50<06:30,  1.33s/it] 38%|███▊      | 177/471 [03:51<06:29,  1.33s/it] 38%|███▊      | 178/471 [03:52<06:28,  1.33s/it] 38%|███▊      | 179/471 [03:54<06:26,  1.33s/it] 38%|███▊      | 180/471 [03:55<06:25,  1.33s/it] 38%|███▊      | 181/471 [03:56<06:24,  1.33s/it] 39%|███▊      | 182/471 [03:58<06:23,  1.33s/it] 39%|███▉      | 183/471 [03:59<06:22,  1.33s/it] 39%|███▉      | 184/471 [04:00<06:20,  1.33s/it] 39%|███▉      | 185/471 [04:02<06:19,  1.33s/it] 39%|███▉      | 186/471 [04:03<06:18,  1.33s/it] 40%|███▉      | 187/471 [04:04<06:17,  1.33s/it] 40%|███▉      | 188/471 [04:06<06:16,  1.33s/it] 40%|████      | 189/471 [04:07<06:14,  1.33s/it] 40%|████      | 190/471 [04:08<06:13,  1.33s/it] 41%|████      | 191/471 [04:10<06:12,  1.33s/it] 41%|████      | 192/471 [04:11<06:11,  1.33s/it] 41%|████      | 193/471 [04:12<06:09,  1.33s/it] 41%|████      | 194/471 [04:14<06:08,  1.33s/it] 41%|████▏     | 195/471 [04:15<06:06,  1.33s/it] 42%|████▏     | 196/471 [04:16<06:05,  1.33s/it] 42%|████▏     | 197/471 [04:18<06:03,  1.32s/it] 42%|████▏     | 198/471 [04:19<06:01,  1.32s/it] 42%|████▏     | 199/471 [04:20<06:00,  1.33s/it] 42%|████▏     | 200/471 [04:22<05:59,  1.33s/it] 43%|████▎     | 201/471 [04:23<05:57,  1.32s/it] 43%|████▎     | 202/471 [04:24<05:56,  1.32s/it] 43%|████▎     | 203/471 [04:26<05:54,  1.32s/it] 43%|████▎     | 204/471 [04:27<05:53,  1.32s/it] 44%|████▎     | 205/471 [04:28<05:51,  1.32s/it] 44%|████▎     | 206/471 [04:30<05:50,  1.32s/it] 44%|████▍     | 207/471 [04:31<05:49,  1.32s/it] 44%|████▍     | 208/471 [04:32<05:47,  1.32s/it] 44%|████▍     | 209/471 [04:34<05:46,  1.32s/it] 45%|████▍     | 210/471 [04:35<05:45,  1.32s/it] 45%|████▍     | 211/471 [04:36<05:43,  1.32s/it] 45%|████▌     | 212/471 [04:38<05:42,  1.32s/it] 45%|████▌     | 213/471 [04:39<05:41,  1.33s/it] 45%|████▌     | 214/471 [04:40<05:40,  1.32s/it] 46%|████▌     | 215/471 [04:42<05:38,  1.32s/it] 46%|████▌     | 216/471 [04:43<05:38,  1.33s/it] 46%|████▌     | 217/471 [04:44<05:36,  1.33s/it] 46%|████▋     | 218/471 [04:46<05:35,  1.33s/it] 46%|████▋     | 219/471 [04:47<05:34,  1.33s/it] 47%|████▋     | 220/471 [04:48<05:32,  1.33s/it] 47%|████▋     | 221/471 [04:49<05:31,  1.33s/it] 47%|████▋     | 222/471 [04:51<05:29,  1.32s/it] 47%|████▋     | 223/471 [04:52<05:27,  1.32s/it] 48%|████▊     | 224/471 [04:53<05:26,  1.32s/it] 48%|████▊     | 225/471 [04:55<05:25,  1.32s/it] 48%|████▊     | 226/471 [04:56<05:24,  1.32s/it] 48%|████▊     | 227/471 [04:57<05:22,  1.32s/it] 48%|████▊     | 228/471 [04:59<05:21,  1.32s/it] 49%|████▊     | 229/471 [05:00<05:20,  1.33s/it] 49%|████▉     | 230/471 [05:01<05:19,  1.32s/it] 49%|████▉     | 231/471 [05:03<05:17,  1.32s/it] 49%|████▉     | 232/471 [05:04<05:15,  1.32s/it] 49%|████▉     | 233/471 [05:05<05:14,  1.32s/it] 50%|████▉     | 234/471 [05:07<05:13,  1.32s/it] 50%|████▉     | 235/471 [05:08<05:12,  1.32s/it] 50%|█████     | 236/471 [05:09<05:10,  1.32s/it] 50%|█████     | 237/471 [05:11<05:09,  1.32s/it] 51%|█████     | 238/471 [05:12<05:07,  1.32s/it] 51%|█████     | 239/471 [05:13<05:06,  1.32s/it] 51%|█████     | 240/471 [05:15<05:05,  1.32s/it] 51%|█████     | 241/471 [05:16<05:04,  1.32s/it] 51%|█████▏    | 242/471 [05:17<05:03,  1.32s/it] 52%|█████▏    | 243/471 [05:19<05:01,  1.32s/it] 52%|█████▏    | 244/471 [05:20<05:00,  1.32s/it] 52%|█████▏    | 245/471 [05:21<04:59,  1.32s/it] 52%|█████▏    | 246/471 [05:23<04:57,  1.32s/it] 52%|█████▏    | 247/471 [05:24<04:56,  1.32s/it] 53%|█████▎    | 248/471 [05:25<04:54,  1.32s/it] 53%|█████▎    | 249/471 [05:27<04:53,  1.32s/it] 53%|█████▎    | 250/471 [05:28<04:52,  1.32s/it] 53%|█████▎    | 251/471 [05:29<04:50,  1.32s/it] 54%|█████▎    | 252/471 [05:30<04:49,  1.32s/it] 54%|█████▎    | 253/471 [05:32<04:48,  1.32s/it] 54%|█████▍    | 254/471 [05:33<04:47,  1.32s/it] 54%|█████▍    | 255/471 [05:34<04:45,  1.32s/it] 54%|█████▍    | 256/471 [05:36<04:44,  1.32s/it] 55%|█████▍    | 257/471 [05:37<04:42,  1.32s/it] 55%|█████▍    | 258/471 [05:38<04:41,  1.32s/it] 55%|█████▍    | 259/471 [05:40<04:40,  1.32s/it] 55%|█████▌    | 260/471 [05:41<04:39,  1.32s/it] 55%|█████▌    | 261/471 [05:42<04:37,  1.32s/it] 56%|█████▌    | 262/471 [05:44<04:35,  1.32s/it] 56%|█████▌    | 263/471 [05:45<04:34,  1.32s/it] 56%|█████▌    | 264/471 [05:46<04:33,  1.32s/it] 56%|█████▋    | 265/471 [05:48<04:32,  1.32s/it] 56%|█████▋    | 266/471 [05:49<04:30,  1.32s/it] 57%|█████▋    | 267/471 [05:50<04:29,  1.32s/it] 57%|█████▋    | 268/471 [05:52<04:28,  1.32s/it] 57%|█████▋    | 269/471 [05:53<04:26,  1.32s/it] 57%|█████▋    | 270/471 [05:54<04:25,  1.32s/it] 58%|█████▊    | 271/471 [05:56<04:23,  1.32s/it] 58%|█████▊    | 272/471 [05:57<04:22,  1.32s/it] 58%|█████▊    | 273/471 [05:58<04:20,  1.32s/it] 58%|█████▊    | 274/471 [06:00<04:19,  1.32s/it] 58%|█████▊    | 275/471 [06:01<04:18,  1.32s/it] 59%|█████▊    | 276/471 [06:02<04:16,  1.32s/it] 59%|█████▉    | 277/471 [06:04<04:15,  1.32s/it] 59%|█████▉    | 278/471 [06:05<04:14,  1.32s/it] 59%|█████▉    | 279/471 [06:06<04:13,  1.32s/it] 59%|█████▉    | 280/471 [06:07<04:11,  1.32s/it] 60%|█████▉    | 281/471 [06:09<04:10,  1.32s/it] 60%|█████▉    | 282/471 [06:10<04:09,  1.32s/it] 60%|██████    | 283/471 [06:11<04:08,  1.32s/it] 60%|██████    | 284/471 [06:13<04:06,  1.32s/it] 61%|██████    | 285/471 [06:14<04:05,  1.32s/it] 61%|██████    | 286/471 [06:15<04:04,  1.32s/it] 61%|██████    | 287/471 [06:17<04:03,  1.32s/it] 61%|██████    | 288/471 [06:18<04:02,  1.32s/it] 61%|██████▏   | 289/471 [06:19<04:00,  1.32s/it] 62%|██████▏   | 290/471 [06:21<03:58,  1.32s/it] 62%|██████▏   | 291/471 [06:22<03:57,  1.32s/it] 62%|██████▏   | 292/471 [06:23<03:56,  1.32s/it] 62%|██████▏   | 293/471 [06:25<03:54,  1.32s/it] 62%|██████▏   | 294/471 [06:26<03:53,  1.32s/it] 63%|██████▎   | 295/471 [06:27<03:52,  1.32s/it] 63%|██████▎   | 296/471 [06:29<03:50,  1.32s/it] 63%|██████▎   | 297/471 [06:30<03:49,  1.32s/it] 63%|██████▎   | 298/471 [06:31<03:48,  1.32s/it] 63%|██████▎   | 299/471 [06:33<03:47,  1.32s/it] 64%|██████▎   | 300/471 [06:34<03:46,  1.32s/it] 64%|██████▍   | 301/471 [06:35<03:44,  1.32s/it] 64%|██████▍   | 302/471 [06:37<03:43,  1.32s/it] 64%|██████▍   | 303/471 [06:38<03:42,  1.32s/it] 65%|██████▍   | 304/471 [06:39<03:40,  1.32s/it] 65%|██████▍   | 305/471 [06:40<03:39,  1.32s/it] 65%|██████▍   | 306/471 [06:42<03:38,  1.32s/it] 65%|██████▌   | 307/471 [06:43<03:37,  1.33s/it] 65%|██████▌   | 308/471 [06:44<03:36,  1.33s/it] 66%|██████▌   | 309/471 [06:46<03:34,  1.33s/it] 66%|██████▌   | 310/471 [06:47<03:33,  1.33s/it] 66%|██████▌   | 311/471 [06:48<03:32,  1.33s/it] 66%|██████▌   | 312/471 [06:50<03:30,  1.33s/it] 66%|██████▋   | 313/471 [06:51<03:29,  1.33s/it] 67%|██████▋   | 314/471 [06:52<03:28,  1.32s/it] 67%|██████▋   | 315/471 [06:54<03:26,  1.33s/it] 67%|██████▋   | 316/471 [06:55<03:25,  1.33s/it] 67%|██████▋   | 317/471 [06:56<03:24,  1.33s/it] 68%|██████▊   | 318/471 [06:58<03:23,  1.33s/it] 68%|██████▊   | 319/471 [06:59<03:22,  1.33s/it] 68%|██████▊   | 320/471 [07:00<03:20,  1.33s/it] 68%|██████▊   | 321/471 [07:02<03:19,  1.33s/it] 68%|██████▊   | 322/471 [07:03<03:18,  1.33s/it] 69%|██████▊   | 323/471 [07:04<03:17,  1.33s/it] 69%|██████▉   | 324/471 [07:06<03:15,  1.33s/it] 69%|██████▉   | 325/471 [07:07<03:14,  1.33s/it] 69%|██████▉   | 326/471 [07:08<03:12,  1.33s/it] 69%|██████▉   | 327/471 [07:10<03:11,  1.33s/it] 70%|██████▉   | 328/471 [07:11<03:09,  1.33s/it] 70%|██████▉   | 329/471 [07:12<03:08,  1.33s/it] 70%|███████   | 330/471 [07:14<03:07,  1.33s/it] 70%|███████   | 331/471 [07:15<03:05,  1.33s/it] 70%|███████   | 332/471 [07:16<03:04,  1.33s/it] 71%|███████   | 333/471 [07:18<03:03,  1.33s/it] 71%|███████   | 334/471 [07:19<03:01,  1.33s/it] 71%|███████   | 335/471 [07:20<03:00,  1.33s/it] 71%|███████▏  | 336/471 [07:22<02:59,  1.33s/it] 72%|███████▏  | 337/471 [07:23<02:57,  1.33s/it] 72%|███████▏  | 338/471 [07:24<02:56,  1.33s/it] 72%|███████▏  | 339/471 [07:26<02:55,  1.33s/it] 72%|███████▏  | 340/471 [07:27<02:54,  1.33s/it] 72%|███████▏  | 341/471 [07:28<02:52,  1.33s/it] 73%|███████▎  | 342/471 [07:30<02:51,  1.33s/it] 73%|███████▎  | 343/471 [07:31<02:50,  1.33s/it] 73%|███████▎  | 344/471 [07:32<02:48,  1.33s/it] 73%|███████▎  | 345/471 [07:34<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:35<02:46,  1.33s/it] 74%|███████▎  | 347/471 [07:36<02:44,  1.33s/it] 74%|███████▍  | 348/471 [07:38<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:39<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:40<02:40,  1.33s/it] 75%|███████▍  | 351/471 [07:42<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:43<02:38,  1.33s/it] 75%|███████▍  | 353/471 [07:44<02:36,  1.33s/it] 75%|███████▌  | 354/471 [07:46<02:35,  1.33s/it] 75%|███████▌  | 355/471 [07:47<02:34,  1.33s/it] 76%|███████▌  | 356/471 [07:48<02:33,  1.33s/it] 76%|███████▌  | 357/471 [07:50<02:31,  1.33s/it] 76%|███████▌  | 358/471 [07:51<02:30,  1.33s/it] 76%|███████▌  | 359/471 [07:52<02:29,  1.33s/it] 76%|███████▋  | 360/471 [07:54<02:27,  1.33s/it] 77%|███████▋  | 361/471 [07:55<02:26,  1.33s/it] 77%|███████▋  | 362/471 [07:56<02:24,  1.33s/it] 77%|███████▋  | 363/471 [07:58<02:23,  1.33s/it] 77%|███████▋  | 364/471 [07:59<02:22,  1.33s/it] 77%|███████▋  | 365/471 [08:00<02:21,  1.33s/it] 78%|███████▊  | 366/471 [08:02<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:03<02:18,  1.33s/it] 78%|███████▊  | 368/471 [08:04<02:16,  1.33s/it] 78%|███████▊  | 369/471 [08:06<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:07<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:08<02:13,  1.33s/it] 79%|███████▉  | 372/471 [08:10<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:11<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:12<02:08,  1.33s/it] 80%|███████▉  | 375/471 [08:14<02:07,  1.33s/it] 80%|███████▉  | 376/471 [08:15<02:06,  1.33s/it] 80%|████████  | 377/471 [08:16<02:04,  1.33s/it] 80%|████████  | 378/471 [08:17<02:03,  1.33s/it] 80%|████████  | 379/471 [08:19<02:02,  1.33s/it] 81%|████████  | 380/471 [08:20<02:01,  1.33s/it] 81%|████████  | 381/471 [08:21<01:59,  1.33s/it] 81%|████████  | 382/471 [08:23<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:24<01:57,  1.33s/it] 82%|████████▏ | 384/471 [08:25<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:27<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:28<01:53,  1.33s/it] 82%|████████▏ | 387/471 [08:29<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:31<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:32<01:49,  1.33s/it] 83%|████████▎ | 390/471 [08:33<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:35<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:36<01:45,  1.33s/it] 83%|████████▎ | 393/471 [08:37<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:39<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:40<01:41,  1.33s/it] 84%|████████▍ | 396/471 [08:41<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:43<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:44<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:45<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:47<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:48<01:32,  1.33s/it] 85%|████████▌ | 402/471 [08:49<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:51<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:52<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:53<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:55<01:26,  1.33s/it] 86%|████████▋ | 407/471 [08:56<01:24,  1.33s/it] 87%|████████▋ | 408/471 [08:57<01:23,  1.33s/it] 87%|████████▋ | 409/471 [08:59<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:00<01:21,  1.33s/it] 87%|████████▋ | 411/471 [09:01<01:19,  1.32s/it] 87%|████████▋ | 412/471 [09:03<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:04<01:16,  1.33s/it] 88%|████████▊ | 414/471 [09:05<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:07<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:08<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:09<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:11<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:12<01:08,  1.33s/it] 89%|████████▉ | 420/471 [09:13<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:15<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:16<01:04,  1.32s/it] 90%|████████▉ | 423/471 [09:17<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:19<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:20<01:00,  1.32s/it] 90%|█████████ | 426/471 [09:21<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:23<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:24<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:25<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:27<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:28<00:53,  1.33s/it] 92%|█████████▏| 432/471 [09:29<00:51,  1.33s/it] 92%|█████████▏| 433/471 [09:31<00:50,  1.33s/it] 92%|█████████▏| 434/471 [09:32<00:49,  1.33s/it] 92%|█████████▏| 435/471 [09:33<00:47,  1.33s/it] 93%|█████████▎| 436/471 [09:35<00:46,  1.32s/it] 93%|█████████▎| 437/471 [09:36<00:45,  1.33s/it] 93%|█████████▎| 438/471 [09:37<00:43,  1.33s/it] 93%|█████████▎| 439/471 [09:38<00:42,  1.32s/it] 93%|█████████▎| 440/471 [09:40<00:41,  1.32s/it] 94%|█████████▎| 441/471 [09:41<00:39,  1.32s/it] 94%|█████████▍| 442/471 [09:42<00:38,  1.32s/it] 94%|█████████▍| 443/471 [09:44<00:37,  1.32s/it] 94%|█████████▍| 444/471 [09:45<00:35,  1.32s/it] 94%|█████████▍| 445/471 [09:46<00:34,  1.33s/it] 95%|█████████▍| 446/471 [09:48<00:33,  1.33s/it] 95%|█████████▍| 447/471 [09:49<00:31,  1.33s/it] 95%|█████████▌| 448/471 [09:50<00:30,  1.32s/it] 95%|█████████▌| 449/471 [09:52<00:29,  1.32s/it] 96%|█████████▌| 450/471 [09:53<00:27,  1.33s/it] 96%|█████████▌| 451/471 [09:54<00:26,  1.33s/it] 96%|█████████▌| 452/471 [09:56<00:25,  1.32s/it] 96%|█████████▌| 453/471 [09:57<00:23,  1.33s/it] 96%|█████████▋| 454/471 [09:58<00:22,  1.33s/it] 97%|█████████▋| 455/471 [10:00<00:21,  1.33s/it] 97%|█████████▋| 456/471 [10:01<00:19,  1.33s/it] 97%|█████████▋| 457/471 [10:02<00:18,  1.33s/it] 97%|█████████▋| 458/471 [10:04<00:17,  1.33s/it] 97%|█████████▋| 459/471 [10:05<00:15,  1.32s/it] 98%|█████████▊| 460/471 [10:06<00:14,  1.32s/it] 98%|█████████▊| 461/471 [10:08<00:13,  1.32s/it] 98%|█████████▊| 462/471 [10:09<00:11,  1.32s/it] 98%|█████████▊| 463/471 [10:10<00:10,  1.32s/it] 99%|█████████▊| 464/471 [10:12<00:09,  1.32s/it] 99%|█████████▊| 465/471 [10:13<00:07,  1.32s/it] 99%|█████████▉| 466/471 [10:14<00:06,  1.32s/it] 99%|█████████▉| 467/471 [10:16<00:05,  1.32s/it] 99%|█████████▉| 468/471 [10:17<00:03,  1.32s/it]100%|█████████▉| 469/471 [10:18<00:02,  1.32s/it]100%|█████████▉| 470/471 [10:20<00:01,  1.32s/it]100%|██████████| 471/471 [10:21<00:00,  1.21s/it]100%|██████████| 471/471 [10:21<00:00,  1.32s/it]
{'eval_loss': 5.244710445404053, 'eval_model_preparation_time': 0.0105, 'eval_acc': 0.1692777482740308, 'eval_runtime': 622.2614, 'eval_samples_per_second': 12.104, 'eval_steps_per_second': 0.757}
ROUND:1
CLIENT:26
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.08s/it]                                              {'loss': 5.9091, 'grad_norm': 3.4599852561950684, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.08s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 4.0166, 'grad_norm': 3.8851892948150635, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 5.3252, 'grad_norm': 3.413374185562134, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 3.3842, 'grad_norm': 2.6934285163879395, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 4.0908, 'grad_norm': 2.57003116607666, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 5.6346, 'grad_norm': 7.786350250244141, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 4.8903, 'grad_norm': 5.157903671264648, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.9787, 'grad_norm': 10.710708618164062, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 2.4539, 'grad_norm': 3.5578842163085938, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 2.498, 'grad_norm': 2.7277703285217285, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 2.9936, 'grad_norm': 5.522146701812744, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 1.5142, 'grad_norm': 3.2519242763519287, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 2.6479, 'grad_norm': 34.95732116699219, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 2.4112, 'grad_norm': 8.146293640136719, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.9588, 'grad_norm': 4.127610683441162, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 2.5204, 'grad_norm': 24.768125534057617, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 1.2504, 'grad_norm': 4.564873218536377, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.838, 'grad_norm': 3.778170585632324, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.7635, 'grad_norm': 4.889650344848633, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 1.5841, 'grad_norm': 7.533267974853516, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.733, 'grad_norm': 4.7457098960876465, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 1.4145, 'grad_norm': 7.4123334884643555, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it]                                               {'loss': 1.0411, 'grad_norm': 4.025781631469727, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.4097, 'grad_norm': 10.589755058288574, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it]                                               {'loss': 0.2636, 'grad_norm': 2.3763070106506348, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it]                                               {'loss': 0.5831, 'grad_norm': 3.6794967651367188, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it]                                               {'loss': 0.5235, 'grad_norm': 3.881099224090576, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.8801, 'grad_norm': 6.6586480140686035, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.8634, 'grad_norm': 2.8188822269439697, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.404, 'grad_norm': 2.429197311401367, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 1.1279, 'grad_norm': 7.376138687133789, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0429, 'grad_norm': 1.2729675769805908, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.4204, 'grad_norm': 3.4036026000976562, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.1747, 'grad_norm': 2.3875083923339844, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.3477, 'grad_norm': 4.034962177276611, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.1622, 'grad_norm': 2.27040958404541, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.1524, 'grad_norm': 1.2449134588241577, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.2391, 'grad_norm': 2.1404800415039062, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.3756, 'grad_norm': 3.528693199157715, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 3.938, 'grad_norm': 26.5882568359375, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.571, 'train_samples_per_second': 7.101, 'train_steps_per_second': 0.503, 'train_loss': 1.7940065254457296, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 4.5732, 'grad_norm': 3.1927664279937744, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.3134, 'grad_norm': 3.32588267326355, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 4.1373, 'grad_norm': 3.539745330810547, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.5186, 'grad_norm': 5.7424421310424805, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 2.9284, 'grad_norm': 4.602169990539551, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.9199, 'grad_norm': 7.894107818603516, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 4.1449, 'grad_norm': 20.039886474609375, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 8.8286, 'grad_norm': 24.287384033203125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.7339, 'grad_norm': 10.319247245788574, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 2.5643, 'grad_norm': 11.596064567565918, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 2.754, 'grad_norm': 8.2753267288208, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.9735, 'grad_norm': 29.929149627685547, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 2.3517, 'grad_norm': 10.094276428222656, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.783, 'grad_norm': 5.589310646057129, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 1.9818, 'grad_norm': 15.219182968139648, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 4.1895, 'grad_norm': 16.054237365722656, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 1.1388, 'grad_norm': 2.5556328296661377, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.4869, 'grad_norm': 2.90557861328125, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 2.0435, 'grad_norm': 10.225947380065918, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.875, 'grad_norm': 10.3681058883667, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.8883, 'grad_norm': 6.43882942199707, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 1.5234, 'grad_norm': 25.668289184570312, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 1.6025, 'grad_norm': 21.094690322875977, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0346, 'grad_norm': 1.2692829370498657, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.2875, 'grad_norm': 2.2999820709228516, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.9565, 'grad_norm': 8.621950149536133, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 1.7064, 'grad_norm': 32.519317626953125, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 1.4587, 'grad_norm': 14.518697738647461, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 1.0089, 'grad_norm': 10.064865112304688, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.6114, 'grad_norm': 2.5302741527557373, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 1.117, 'grad_norm': 5.636497974395752, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 1.8158, 'grad_norm': 47.33547592163086, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 1.3261, 'grad_norm': 39.370704650878906, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.4771, 'grad_norm': 4.841562271118164, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.7248, 'grad_norm': 4.548933506011963, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.2026, 'grad_norm': 4.877394676208496, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.7985, 'grad_norm': 16.226577758789062, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.5793, 'grad_norm': 5.216734886169434, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.6096, 'grad_norm': 2.9129984378814697, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0014, 'grad_norm': 0.06917467713356018, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.737, 'train_samples_per_second': 7.176, 'train_steps_per_second': 0.508, 'train_loss': 1.8742594309558627, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.5538, 'grad_norm': 2.2100820541381836, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 3.5811, 'grad_norm': 3.5998215675354004, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 2.7929, 'grad_norm': 6.215721607208252, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 4.3387, 'grad_norm': 6.374972343444824, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 3.6314, 'grad_norm': 5.565541744232178, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 3.4985, 'grad_norm': 4.509212017059326, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:10,  2.15s/it]                                              {'loss': 2.3385, 'grad_norm': 5.301173210144043, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:10,  2.15s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 6.3226, 'grad_norm': 17.916030883789062, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 2.7051, 'grad_norm': 10.430215835571289, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.0295, 'grad_norm': 2.3056914806365967, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.4436, 'grad_norm': 6.99458122253418, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:23<00:56,  2.03s/it]                                               {'loss': 1.1607, 'grad_norm': 6.426948070526123, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.6505, 'grad_norm': 4.498251438140869, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.4502, 'grad_norm': 8.071895599365234, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:52,  2.12s/it]                                               {'loss': 1.5036, 'grad_norm': 6.378688335418701, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:52,  2.12s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 0.8882, 'grad_norm': 25.698509216308594, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it]                                               {'loss': 0.2738, 'grad_norm': 5.59335470199585, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.2871, 'grad_norm': 4.919870376586914, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.8439, 'grad_norm': 8.501100540161133, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.6057, 'grad_norm': 3.346122980117798, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 1.4003, 'grad_norm': 6.232364654541016, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.14s/it]                                               {'loss': 1.7211, 'grad_norm': 12.037751197814941, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it]                                               {'loss': 0.2741, 'grad_norm': 3.2737157344818115, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 0.0141, 'grad_norm': 0.29493921995162964, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.3593, 'grad_norm': 4.043489456176758, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.735, 'grad_norm': 10.543543815612793, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it]                                               {'loss': 0.5038, 'grad_norm': 5.8227620124816895, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.2667, 'grad_norm': 3.332967519760132, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.6846, 'grad_norm': 4.004334926605225, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.6657, 'grad_norm': 5.759568691253662, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it]                                               {'loss': 0.2342, 'grad_norm': 1.287182092666626, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0459, 'grad_norm': 2.1446611881256104, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0718, 'grad_norm': 0.9297243356704712, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.1206, 'grad_norm': 2.003218412399292, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it]                                               {'loss': 0.2401, 'grad_norm': 3.229466438293457, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.2326, 'grad_norm': 2.913386583328247, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0398, 'grad_norm': 0.7278990149497986, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.6054, 'grad_norm': 3.247471570968628, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.5726, 'grad_norm': 5.404077053070068, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.0861, 'grad_norm': 1.9006199836730957, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 78.2389, 'train_samples_per_second': 7.221, 'train_steps_per_second': 0.511, 'train_loss': 1.319334669224918, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 4.1927, 'grad_norm': 2.5315823554992676, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 6.2758, 'grad_norm': 3.398348569869995, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 4.9141, 'grad_norm': 4.741824626922607, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 5.1575, 'grad_norm': 5.33280086517334, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 5.4921, 'grad_norm': 4.800168991088867, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 3.3725, 'grad_norm': 4.736569404602051, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 2.765, 'grad_norm': 6.811940670013428, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 7.4225, 'grad_norm': 23.702850341796875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.7224, 'grad_norm': 19.502714157104492, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 2.5, 'grad_norm': 9.817598342895508, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 2.0179, 'grad_norm': 9.119274139404297, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.3323, 'grad_norm': 4.111127853393555, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.9793, 'grad_norm': 5.658942222595215, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.5329, 'grad_norm': 16.465290069580078, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 1.1509, 'grad_norm': 8.324420928955078, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 3.7787, 'grad_norm': 30.810503005981445, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.5717, 'grad_norm': 5.011023044586182, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.3542, 'grad_norm': 3.412789821624756, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.7367, 'grad_norm': 3.7536959648132324, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 1.0965, 'grad_norm': 3.222869873046875, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.5443, 'grad_norm': 2.582857608795166, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.9703, 'grad_norm': 3.774416923522949, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.8865, 'grad_norm': 5.951217174530029, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.2661, 'grad_norm': 3.8246829509735107, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.3413, 'grad_norm': 3.3553431034088135, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.3956, 'grad_norm': 1.557437777519226, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.0993, 'grad_norm': 1.5163155794143677, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.4083, 'grad_norm': 6.644008159637451, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.4833, 'grad_norm': 3.545661687850952, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.2581, 'grad_norm': 2.7986934185028076, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1627, 'grad_norm': 2.647240161895752, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.029, 'grad_norm': 0.6596764326095581, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.3464, 'grad_norm': 5.279597759246826, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.3831, 'grad_norm': 4.054681777954102, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1622, 'grad_norm': 1.5872066020965576, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.1837, 'grad_norm': 4.437466621398926, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0481, 'grad_norm': 0.7569770812988281, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.0572, 'grad_norm': 0.7635601162910461, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.3908, 'grad_norm': 4.891443729400635, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0079, 'grad_norm': 0.674726128578186, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.204, 'train_samples_per_second': 7.133, 'train_steps_per_second': 0.505, 'train_loss': 1.6197527051903307, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:77
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 5.1786, 'grad_norm': 3.974496603012085, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 4.362, 'grad_norm': 2.691945791244507, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 4.4136, 'grad_norm': 3.621422529220581, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 4.5909, 'grad_norm': 5.558986186981201, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 4.8672, 'grad_norm': 23.026416778564453, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 5.1842, 'grad_norm': 7.556075572967529, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 4.5836, 'grad_norm': 8.588613510131836, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.3548, 'grad_norm': 5.864817142486572, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 3.318, 'grad_norm': 9.722456932067871, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 2.009, 'grad_norm': 14.11921215057373, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 2.914, 'grad_norm': 7.400392055511475, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 1.8689, 'grad_norm': 4.855592250823975, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 2.6711, 'grad_norm': 5.784243583679199, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 2.2161, 'grad_norm': 6.181305408477783, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.312, 'grad_norm': 4.550172328948975, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 2.0494, 'grad_norm': 17.259611129760742, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it]                                               {'loss': 1.0581, 'grad_norm': 7.516716480255127, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.7159, 'grad_norm': 2.567046880722046, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 1.38, 'grad_norm': 12.926522254943848, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 1.5979, 'grad_norm': 9.080781936645508, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 1.4876, 'grad_norm': 11.53571605682373, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 1.3766, 'grad_norm': 11.938655853271484, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.5663, 'grad_norm': 9.468613624572754, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0133, 'grad_norm': 0.7550933957099915, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.6419, 'grad_norm': 7.864877223968506, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.383, 'grad_norm': 5.200563907623291, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.4867, 'grad_norm': 5.244469165802002, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.4644, 'grad_norm': 3.171659469604492, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.8972, 'grad_norm': 4.283585548400879, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.2763, 'grad_norm': 3.125511646270752, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.3513, 'grad_norm': 7.442655563354492, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.8775, 'grad_norm': 34.885990142822266, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.1879, 'grad_norm': 11.719249725341797, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.2193, 'grad_norm': 2.3876774311065674, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.2144, 'grad_norm': 2.713121175765991, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.3292, 'grad_norm': 3.560546398162842, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.8611, 'grad_norm': 8.073161125183105, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.0441, 'grad_norm': 0.7610757946968079, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.2041, 'grad_norm': 3.6891613006591797, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.234, 'grad_norm': 7.879944801330566, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.6987, 'train_samples_per_second': 7.089, 'train_steps_per_second': 0.502, 'train_loss': 1.6690397949656472, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 4.854, 'grad_norm': 3.1794371604919434, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 4.6178, 'grad_norm': 2.9217238426208496, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 4.9605, 'grad_norm': 3.5763862133026123, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 4.5176, 'grad_norm': 3.92021107673645, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 5.0557, 'grad_norm': 3.744208335876465, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:14,  2.18s/it]                                              {'loss': 5.3705, 'grad_norm': 9.97335433959961, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 3.0301, 'grad_norm': 5.032635688781738, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 2.231, 'grad_norm': 12.870685577392578, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.4921, 'grad_norm': 3.4027628898620605, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 2.525, 'grad_norm': 11.479878425598145, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 2.9349, 'grad_norm': 5.988736629486084, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 2.9891, 'grad_norm': 4.3078107833862305, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 2.3703, 'grad_norm': 4.690969467163086, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 3.0757, 'grad_norm': 7.13970422744751, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it]                                               {'loss': 1.1863, 'grad_norm': 5.093059539794922, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:38,  1.58s/it]                                               {'loss': 0.0476, 'grad_norm': 1.6236541271209717, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 1.6162, 'grad_norm': 3.337115526199341, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.8769, 'grad_norm': 8.72016429901123, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 1.3561, 'grad_norm': 4.047817707061768, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.8797, 'grad_norm': 4.397342205047607, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 1.5641, 'grad_norm': 4.739259719848633, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it]                                               {'loss': 0.8807, 'grad_norm': 6.431075572967529, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 1.7429, 'grad_norm': 5.137068271636963, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.1221, 'grad_norm': 4.292813777923584, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.4083, 'grad_norm': 2.679811954498291, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.8622, 'grad_norm': 3.3812806606292725, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 1.0578, 'grad_norm': 2.0312767028808594, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.2543, 'grad_norm': 1.2769404649734497, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.6097, 'grad_norm': 3.0990474224090576, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.4925, 'grad_norm': 5.465334892272949, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.5473, 'grad_norm': 3.235621929168701, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.6669, 'grad_norm': 15.927875518798828, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.5206, 'grad_norm': 2.515779972076416, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0792, 'grad_norm': 1.4123321771621704, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.4091, 'grad_norm': 2.292006015777588, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.2175, 'grad_norm': 1.9448970556259155, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.6074, 'grad_norm': 4.4434661865234375, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.2726, 'grad_norm': 2.9694600105285645, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.5241, 'grad_norm': 3.7599778175354004, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'loss': 0.0525, 'grad_norm': 2.202941417694092, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'train_runtime': 79.2786, 'train_samples_per_second': 7.127, 'train_steps_per_second': 0.505, 'train_loss': 1.6969789865426719, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 5.0684, 'grad_norm': 1.8135417699813843, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 3.7239, 'grad_norm': 2.864055871963501, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 5.4283, 'grad_norm': 3.7114977836608887, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.4961, 'grad_norm': 3.193192481994629, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 4.2995, 'grad_norm': 3.944261074066162, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 3.1059, 'grad_norm': 3.2866716384887695, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 4.0502, 'grad_norm': 6.06524658203125, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.1515, 'grad_norm': 12.855472564697266, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.8082, 'grad_norm': 3.3231372833251953, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 2.6471, 'grad_norm': 4.221217632293701, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.015, 'grad_norm': 2.8222315311431885, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.04s/it]                                               {'loss': 1.1946, 'grad_norm': 2.810699939727783, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 2.8209, 'grad_norm': 4.503874778747559, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.6827, 'grad_norm': 3.734159231185913, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.6082, 'grad_norm': 4.358645915985107, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0472, 'grad_norm': 1.1598533391952515, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.9616, 'grad_norm': 3.7456703186035156, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.6381, 'grad_norm': 5.102766036987305, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.5029, 'grad_norm': 2.038278341293335, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 1.4792, 'grad_norm': 5.759546756744385, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 1.0938, 'grad_norm': 6.43528413772583, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.3233, 'grad_norm': 3.2463839054107666, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.6444, 'grad_norm': 4.295842170715332, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.002, 'grad_norm': 0.08353788405656815, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.993, 'grad_norm': 4.64035177230835, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.4265, 'grad_norm': 5.23198127746582, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.1758, 'grad_norm': 1.6209158897399902, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.12s/it]                                               {'loss': 0.2653, 'grad_norm': 1.8478448390960693, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.17s/it]                                               {'loss': 0.5068, 'grad_norm': 3.7419116497039795, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.17s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.4149, 'grad_norm': 2.3867146968841553, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it]                                               {'loss': 0.277, 'grad_norm': 2.8665478229522705, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it] 80%|████████  | 32/40 [01:02<00:12,  1.61s/it]                                               {'loss': 1.7246, 'grad_norm': 19.150720596313477, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.81s/it]                                               {'loss': 0.143, 'grad_norm': 1.3716912269592285, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.4467, 'grad_norm': 3.6297109127044678, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it]                                               {'loss': 0.1934, 'grad_norm': 1.275525450706482, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.12s/it]                                               {'loss': 0.1656, 'grad_norm': 2.501580238342285, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.16s/it]                                               {'loss': 0.2958, 'grad_norm': 9.711700439453125, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1422, 'grad_norm': 1.5057955980300903, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.1803, 'grad_norm': 2.274960517883301, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0033, 'grad_norm': 0.12269388884305954, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.9131, 'train_samples_per_second': 7.16, 'train_steps_per_second': 0.507, 'train_loss': 1.3786720250209328, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.10s/it]                                              {'loss': 5.3238, 'grad_norm': 2.552889585494995, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.10s/it]  5%|▌         | 2/40 [00:04<01:19,  2.10s/it]                                              {'loss': 4.5024, 'grad_norm': 5.813302040100098, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:19,  2.10s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 4.4972, 'grad_norm': 3.491888999938965, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:16,  2.13s/it]                                              {'loss': 3.8081, 'grad_norm': 9.54377269744873, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.13s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 3.736, 'grad_norm': 4.825305938720703, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 3.6106, 'grad_norm': 3.157069683074951, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 4.4058, 'grad_norm': 5.862205505371094, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 7.4166, 'grad_norm': 9.587352752685547, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 2.1988, 'grad_norm': 6.242278575897217, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 3.0982, 'grad_norm': 4.8415846824646, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.4003, 'grad_norm': 6.175546169281006, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 1.7872, 'grad_norm': 6.93169641494751, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.06s/it]                                               {'loss': 1.3945, 'grad_norm': 3.2774887084960938, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.06s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.3793, 'grad_norm': 5.060966968536377, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 2.2101, 'grad_norm': 4.426427364349365, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:37,  1.54s/it]                                               {'loss': 0.5228, 'grad_norm': 8.913962364196777, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it]                                               {'loss': 0.8737, 'grad_norm': 3.4830729961395264, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it]                                               {'loss': 0.8547, 'grad_norm': 2.5268216133117676, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 1.117, 'grad_norm': 7.325511455535889, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.8251, 'grad_norm': 4.856370449066162, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.6381, 'grad_norm': 15.842035293579102, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.14s/it]                                               {'loss': 1.3464, 'grad_norm': 7.697554588317871, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 1.5878, 'grad_norm': 58.13755416870117, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.342, 'grad_norm': 5.029353618621826, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.8435, 'grad_norm': 15.1426420211792, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 1.1068, 'grad_norm': 34.079383850097656, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it]                                               {'loss': 0.8653, 'grad_norm': 14.648002624511719, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.7431, 'grad_norm': 16.302186965942383, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.4809, 'grad_norm': 20.416549682617188, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it]                                               {'loss': 0.7625, 'grad_norm': 4.3777756690979, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it]                                               {'loss': 1.1341, 'grad_norm': 25.457670211791992, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0084, 'grad_norm': 0.33783113956451416, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.4929, 'grad_norm': 25.52501106262207, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 2.0702, 'grad_norm': 41.61547088623047, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it]                                               {'loss': 0.3789, 'grad_norm': 4.620879173278809, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it]                                               {'loss': 0.6936, 'grad_norm': 5.823836326599121, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.7254, 'grad_norm': 3.922863721847534, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.4908, 'grad_norm': 2.3264400959014893, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]                                               {'loss': 0.2016, 'grad_norm': 4.931493759155273, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]100%|██████████| 40/40 [01:17<00:00,  1.60s/it]                                               {'loss': 0.0209, 'grad_norm': 0.7068964242935181, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.60s/it]                                               {'train_runtime': 78.4474, 'train_samples_per_second': 7.202, 'train_steps_per_second': 0.51, 'train_loss': 1.7473842192208395, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 7.8532, 'grad_norm': 4.144954681396484, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 5.5825, 'grad_norm': 3.366154909133911, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 5.8892, 'grad_norm': 5.344654560089111, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:16,  2.13s/it]                                              {'loss': 4.0973, 'grad_norm': 5.773646831512451, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.13s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it]                                              {'loss': 4.8129, 'grad_norm': 8.644420623779297, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it]                                              {'loss': 3.669, 'grad_norm': 33.74284362792969, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 2.3513, 'grad_norm': 8.666647911071777, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 0.6534, 'grad_norm': 111.00637817382812, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 3.295, 'grad_norm': 82.33423614501953, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it]                                               {'loss': 3.5839, 'grad_norm': 248.92919921875, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it]                                               {'loss': 2.8439, 'grad_norm': 15.564593315124512, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it] 30%|███       | 12/40 [00:23<00:56,  2.03s/it]                                               {'loss': 2.8003, 'grad_norm': 12.054174423217773, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 2.6417, 'grad_norm': 6.570169448852539, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 2.9902, 'grad_norm': 6.043665409088135, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 1.5894, 'grad_norm': 6.1523308753967285, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:37,  1.54s/it]                                               {'loss': 0.0015, 'grad_norm': 0.07144016772508621, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.76s/it]                                               {'loss': 1.097, 'grad_norm': 13.966251373291016, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.89s/it]                                               {'loss': 1.4355, 'grad_norm': 25.7695255279541, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 2.1471, 'grad_norm': 7.410285472869873, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 1.167, 'grad_norm': 4.907970428466797, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 1.4383, 'grad_norm': 13.106101036071777, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it]                                               {'loss': 1.5685, 'grad_norm': 24.559125900268555, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it]                                               {'loss': 2.0118, 'grad_norm': 17.00276756286621, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.0806, 'grad_norm': 4.045341491699219, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.9823, 'grad_norm': 54.52796936035156, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.6815, 'grad_norm': 16.795822143554688, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it]                                               {'loss': 1.3737, 'grad_norm': 11.014764785766602, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it] 70%|███████   | 28/40 [00:54<00:24,  2.05s/it]                                               {'loss': 1.392, 'grad_norm': 7.115647792816162, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 1.4831, 'grad_norm': 7.94576358795166, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.9837, 'grad_norm': 13.238024711608887, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it]                                               {'loss': 2.2446, 'grad_norm': 18.496822357177734, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it] 80%|████████  | 32/40 [01:01<00:12,  1.58s/it]                                               {'loss': 1.6982, 'grad_norm': 81.27415466308594, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.7091, 'grad_norm': 4.807073593139648, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.7373, 'grad_norm': 5.068959712982178, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.6615, 'grad_norm': 5.404699802398682, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.09s/it]                                               {'loss': 0.7187, 'grad_norm': 3.694164991378784, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 1.3905, 'grad_norm': 10.595553398132324, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 1.0646, 'grad_norm': 17.851558685302734, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]                                               {'loss': 0.4626, 'grad_norm': 3.754798650741577, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]100%|██████████| 40/40 [01:17<00:00,  1.59s/it]                                               {'loss': 0.9093, 'grad_norm': 30.083938598632812, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.59s/it]                                               {'train_runtime': 78.026, 'train_samples_per_second': 7.241, 'train_steps_per_second': 0.513, 'train_loss': 2.0773267658194525, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.95s/it]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 6.7454, 'grad_norm': 3.9473817348480225, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 4.4448, 'grad_norm': 2.935239315032959, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 5.0772, 'grad_norm': 4.457331657409668, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 5.6688, 'grad_norm': 5.181726455688477, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 5.4157, 'grad_norm': 3.80523943901062, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 4.0473, 'grad_norm': 3.8437609672546387, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 3.8641, 'grad_norm': 3.21543288230896, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 0.0012, 'grad_norm': 0.017109019681811333, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 2.4873, 'grad_norm': 5.228512763977051, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 2.0543, 'grad_norm': 3.187148332595825, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 2.3077, 'grad_norm': 4.2104620933532715, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:23<00:57,  2.04s/it]                                               {'loss': 1.9904, 'grad_norm': 5.494714736938477, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.9733, 'grad_norm': 6.112873077392578, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.6276, 'grad_norm': 4.310798168182373, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.9355, 'grad_norm': 5.018619060516357, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.0502, 'grad_norm': 0.9565398097038269, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 1.1442, 'grad_norm': 9.172210693359375, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.9556, 'grad_norm': 3.429980993270874, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 1.3304, 'grad_norm': 4.465877532958984, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 1.4165, 'grad_norm': 9.6723051071167, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 1.0779, 'grad_norm': 4.502979278564453, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.7709, 'grad_norm': 6.183954238891602, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.9571, 'grad_norm': 4.3427863121032715, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.2781, 'grad_norm': 9.652848243713379, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.6074, 'grad_norm': 3.7644784450531006, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.2964, 'grad_norm': 2.1240694522857666, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.5058, 'grad_norm': 2.5155084133148193, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.08s/it]                                               {'loss': 0.2202, 'grad_norm': 1.765946865081787, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.7424, 'grad_norm': 3.1666667461395264, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it]                                               {'loss': 0.492, 'grad_norm': 3.8791980743408203, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.3102, 'grad_norm': 2.217460870742798, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 1.9249, 'grad_norm': 9.276022911071777, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1351, 'grad_norm': 3.513791084289551, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.268, 'grad_norm': 3.143254518508911, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.1269, 'grad_norm': 1.6348284482955933, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.1594, 'grad_norm': 2.2145895957946777, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.2571, 'grad_norm': 2.305424928665161, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 0.1362, 'grad_norm': 1.3118945360183716, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.311, 'grad_norm': 2.925445795059204, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0098, 'grad_norm': 0.33649954199790955, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.708, 'train_samples_per_second': 7.178, 'train_steps_per_second': 0.508, 'train_loss': 1.6031105093745281, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:55,  1.59it/s]  1%|          | 3/471 [00:02<07:00,  1.11it/s]  1%|          | 4/471 [00:03<08:03,  1.04s/it]  1%|          | 5/471 [00:05<08:39,  1.12s/it]  1%|▏         | 6/471 [00:06<09:02,  1.17s/it]  1%|▏         | 7/471 [00:07<09:17,  1.20s/it]  2%|▏         | 8/471 [00:08<09:26,  1.22s/it]  2%|▏         | 9/471 [00:10<09:32,  1.24s/it]  2%|▏         | 10/471 [00:11<09:36,  1.25s/it]  2%|▏         | 11/471 [00:12<09:38,  1.26s/it]  3%|▎         | 12/471 [00:13<09:40,  1.26s/it]  3%|▎         | 13/471 [00:15<09:42,  1.27s/it]  3%|▎         | 14/471 [00:16<09:42,  1.27s/it]  3%|▎         | 15/471 [00:17<09:41,  1.28s/it]  3%|▎         | 16/471 [00:19<09:42,  1.28s/it]  4%|▎         | 17/471 [00:20<09:41,  1.28s/it]  4%|▍         | 18/471 [00:21<09:41,  1.28s/it]  4%|▍         | 19/471 [00:22<09:40,  1.28s/it]  4%|▍         | 20/471 [00:24<09:39,  1.29s/it]  4%|▍         | 21/471 [00:25<09:39,  1.29s/it]  5%|▍         | 22/471 [00:26<09:38,  1.29s/it]  5%|▍         | 23/471 [00:28<09:37,  1.29s/it]  5%|▌         | 24/471 [00:29<09:37,  1.29s/it]  5%|▌         | 25/471 [00:30<09:35,  1.29s/it]  6%|▌         | 26/471 [00:32<09:34,  1.29s/it]  6%|▌         | 27/471 [00:33<09:33,  1.29s/it]  6%|▌         | 28/471 [00:34<09:32,  1.29s/it]  6%|▌         | 29/471 [00:35<09:31,  1.29s/it]  6%|▋         | 30/471 [00:37<09:31,  1.30s/it]  7%|▋         | 31/471 [00:38<09:30,  1.30s/it]  7%|▋         | 32/471 [00:39<09:28,  1.30s/it]  7%|▋         | 33/471 [00:41<09:26,  1.29s/it]  7%|▋         | 34/471 [00:42<09:25,  1.29s/it]  7%|▋         | 35/471 [00:43<09:25,  1.30s/it]  8%|▊         | 36/471 [00:44<09:24,  1.30s/it]  8%|▊         | 37/471 [00:46<09:23,  1.30s/it]  8%|▊         | 38/471 [00:47<09:23,  1.30s/it]  8%|▊         | 39/471 [00:48<09:22,  1.30s/it]  8%|▊         | 40/471 [00:50<09:20,  1.30s/it]  9%|▊         | 41/471 [00:51<09:19,  1.30s/it]  9%|▉         | 42/471 [00:52<09:19,  1.30s/it]  9%|▉         | 43/471 [00:54<09:17,  1.30s/it]  9%|▉         | 44/471 [00:55<09:17,  1.31s/it] 10%|▉         | 45/471 [00:56<09:18,  1.31s/it] 10%|▉         | 46/471 [00:58<09:16,  1.31s/it] 10%|▉         | 47/471 [00:59<09:13,  1.31s/it] 10%|█         | 48/471 [01:00<09:13,  1.31s/it] 10%|█         | 49/471 [01:01<09:11,  1.31s/it] 11%|█         | 50/471 [01:03<09:10,  1.31s/it] 11%|█         | 51/471 [01:04<09:09,  1.31s/it] 11%|█         | 52/471 [01:05<09:08,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:08,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:07,  1.31s/it] 12%|█▏        | 55/471 [01:09<09:05,  1.31s/it] 12%|█▏        | 56/471 [01:11<09:05,  1.31s/it] 12%|█▏        | 57/471 [01:12<09:03,  1.31s/it] 12%|█▏        | 58/471 [01:13<09:02,  1.31s/it] 13%|█▎        | 59/471 [01:15<09:00,  1.31s/it] 13%|█▎        | 60/471 [01:16<08:59,  1.31s/it] 13%|█▎        | 61/471 [01:17<08:58,  1.31s/it] 13%|█▎        | 62/471 [01:19<08:56,  1.31s/it] 13%|█▎        | 63/471 [01:20<08:55,  1.31s/it] 14%|█▎        | 64/471 [01:21<08:54,  1.31s/it] 14%|█▍        | 65/471 [01:22<08:52,  1.31s/it] 14%|█▍        | 66/471 [01:24<08:51,  1.31s/it] 14%|█▍        | 67/471 [01:25<08:50,  1.31s/it] 14%|█▍        | 68/471 [01:26<08:48,  1.31s/it] 15%|█▍        | 69/471 [01:28<08:47,  1.31s/it] 15%|█▍        | 70/471 [01:29<08:46,  1.31s/it] 15%|█▌        | 71/471 [01:30<08:45,  1.31s/it] 15%|█▌        | 72/471 [01:32<08:43,  1.31s/it] 15%|█▌        | 73/471 [01:33<08:42,  1.31s/it] 16%|█▌        | 74/471 [01:34<08:39,  1.31s/it] 16%|█▌        | 75/471 [01:36<08:39,  1.31s/it] 16%|█▌        | 76/471 [01:37<08:37,  1.31s/it] 16%|█▋        | 77/471 [01:38<08:37,  1.31s/it] 17%|█▋        | 78/471 [01:40<08:35,  1.31s/it] 17%|█▋        | 79/471 [01:41<08:34,  1.31s/it] 17%|█▋        | 80/471 [01:42<08:33,  1.31s/it] 17%|█▋        | 81/471 [01:43<08:32,  1.31s/it] 17%|█▋        | 82/471 [01:45<08:31,  1.31s/it] 18%|█▊        | 83/471 [01:46<08:30,  1.32s/it] 18%|█▊        | 84/471 [01:47<08:29,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:28,  1.32s/it] 18%|█▊        | 86/471 [01:50<08:27,  1.32s/it] 18%|█▊        | 87/471 [01:51<08:25,  1.32s/it] 19%|█▊        | 88/471 [01:53<08:23,  1.31s/it] 19%|█▉        | 89/471 [01:54<08:22,  1.31s/it] 19%|█▉        | 90/471 [01:55<08:21,  1.32s/it] 19%|█▉        | 91/471 [01:57<08:19,  1.31s/it] 20%|█▉        | 92/471 [01:58<08:18,  1.31s/it] 20%|█▉        | 93/471 [01:59<08:17,  1.32s/it] 20%|█▉        | 94/471 [02:01<08:15,  1.32s/it] 20%|██        | 95/471 [02:02<08:14,  1.32s/it] 20%|██        | 96/471 [02:03<08:13,  1.31s/it] 21%|██        | 97/471 [02:05<08:12,  1.32s/it] 21%|██        | 98/471 [02:06<08:10,  1.31s/it] 21%|██        | 99/471 [02:07<08:08,  1.31s/it] 21%|██        | 100/471 [02:08<08:07,  1.31s/it] 21%|██▏       | 101/471 [02:10<08:06,  1.31s/it] 22%|██▏       | 102/471 [02:11<08:05,  1.32s/it] 22%|██▏       | 103/471 [02:12<08:04,  1.32s/it] 22%|██▏       | 104/471 [02:14<08:03,  1.32s/it] 22%|██▏       | 105/471 [02:15<08:02,  1.32s/it] 23%|██▎       | 106/471 [02:16<08:00,  1.32s/it] 23%|██▎       | 107/471 [02:18<07:58,  1.31s/it] 23%|██▎       | 108/471 [02:19<07:56,  1.31s/it] 23%|██▎       | 109/471 [02:20<07:54,  1.31s/it] 23%|██▎       | 110/471 [02:22<07:52,  1.31s/it] 24%|██▎       | 111/471 [02:23<07:51,  1.31s/it] 24%|██▍       | 112/471 [02:24<07:50,  1.31s/it] 24%|██▍       | 113/471 [02:26<07:49,  1.31s/it] 24%|██▍       | 114/471 [02:27<07:48,  1.31s/it] 24%|██▍       | 115/471 [02:28<07:47,  1.31s/it] 25%|██▍       | 116/471 [02:29<07:45,  1.31s/it] 25%|██▍       | 117/471 [02:31<07:44,  1.31s/it] 25%|██▌       | 118/471 [02:32<07:43,  1.31s/it] 25%|██▌       | 119/471 [02:33<07:42,  1.31s/it] 25%|██▌       | 120/471 [02:35<07:41,  1.32s/it] 26%|██▌       | 121/471 [02:36<07:40,  1.31s/it] 26%|██▌       | 122/471 [02:37<07:38,  1.31s/it] 26%|██▌       | 123/471 [02:39<07:36,  1.31s/it] 26%|██▋       | 124/471 [02:40<07:36,  1.32s/it] 27%|██▋       | 125/471 [02:41<07:35,  1.32s/it] 27%|██▋       | 126/471 [02:43<07:34,  1.32s/it] 27%|██▋       | 127/471 [02:44<07:32,  1.32s/it] 27%|██▋       | 128/471 [02:45<07:30,  1.31s/it] 27%|██▋       | 129/471 [02:47<07:29,  1.31s/it] 28%|██▊       | 130/471 [02:48<07:27,  1.31s/it] 28%|██▊       | 131/471 [02:49<07:26,  1.31s/it] 28%|██▊       | 132/471 [02:51<07:25,  1.31s/it] 28%|██▊       | 133/471 [02:52<07:24,  1.31s/it] 28%|██▊       | 134/471 [02:53<07:23,  1.32s/it] 29%|██▊       | 135/471 [02:54<07:22,  1.32s/it] 29%|██▉       | 136/471 [02:56<07:20,  1.32s/it] 29%|██▉       | 137/471 [02:57<07:19,  1.32s/it] 29%|██▉       | 138/471 [02:58<07:18,  1.32s/it] 30%|██▉       | 139/471 [03:00<07:17,  1.32s/it] 30%|██▉       | 140/471 [03:01<07:16,  1.32s/it] 30%|██▉       | 141/471 [03:02<07:14,  1.32s/it] 30%|███       | 142/471 [03:04<07:13,  1.32s/it] 30%|███       | 143/471 [03:05<07:11,  1.32s/it] 31%|███       | 144/471 [03:06<07:10,  1.32s/it] 31%|███       | 145/471 [03:08<07:08,  1.32s/it] 31%|███       | 146/471 [03:09<07:08,  1.32s/it] 31%|███       | 147/471 [03:10<07:07,  1.32s/it] 31%|███▏      | 148/471 [03:12<07:05,  1.32s/it] 32%|███▏      | 149/471 [03:13<07:05,  1.32s/it] 32%|███▏      | 150/471 [03:14<07:04,  1.32s/it] 32%|███▏      | 151/471 [03:16<07:02,  1.32s/it] 32%|███▏      | 152/471 [03:17<07:01,  1.32s/it] 32%|███▏      | 153/471 [03:18<07:00,  1.32s/it] 33%|███▎      | 154/471 [03:20<06:58,  1.32s/it] 33%|███▎      | 155/471 [03:21<06:56,  1.32s/it] 33%|███▎      | 156/471 [03:22<06:55,  1.32s/it] 33%|███▎      | 157/471 [03:23<06:53,  1.32s/it] 34%|███▎      | 158/471 [03:25<06:51,  1.32s/it] 34%|███▍      | 159/471 [03:26<06:50,  1.32s/it] 34%|███▍      | 160/471 [03:27<06:50,  1.32s/it] 34%|███▍      | 161/471 [03:29<06:48,  1.32s/it] 34%|███▍      | 162/471 [03:30<06:47,  1.32s/it] 35%|███▍      | 163/471 [03:31<06:46,  1.32s/it] 35%|███▍      | 164/471 [03:33<06:45,  1.32s/it] 35%|███▌      | 165/471 [03:34<06:43,  1.32s/it] 35%|███▌      | 166/471 [03:35<06:42,  1.32s/it] 35%|███▌      | 167/471 [03:37<06:41,  1.32s/it] 36%|███▌      | 168/471 [03:38<06:40,  1.32s/it] 36%|███▌      | 169/471 [03:39<06:39,  1.32s/it] 36%|███▌      | 170/471 [03:41<06:37,  1.32s/it] 36%|███▋      | 171/471 [03:42<06:36,  1.32s/it] 37%|███▋      | 172/471 [03:43<06:34,  1.32s/it] 37%|███▋      | 173/471 [03:45<06:33,  1.32s/it] 37%|███▋      | 174/471 [03:46<06:32,  1.32s/it] 37%|███▋      | 175/471 [03:47<06:31,  1.32s/it] 37%|███▋      | 176/471 [03:49<06:29,  1.32s/it] 38%|███▊      | 177/471 [03:50<06:28,  1.32s/it] 38%|███▊      | 178/471 [03:51<06:26,  1.32s/it] 38%|███▊      | 179/471 [03:53<06:25,  1.32s/it] 38%|███▊      | 180/471 [03:54<06:24,  1.32s/it] 38%|███▊      | 181/471 [03:55<06:22,  1.32s/it] 39%|███▊      | 182/471 [03:56<06:21,  1.32s/it] 39%|███▉      | 183/471 [03:58<06:20,  1.32s/it] 39%|███▉      | 184/471 [03:59<06:18,  1.32s/it] 39%|███▉      | 185/471 [04:00<06:17,  1.32s/it] 39%|███▉      | 186/471 [04:02<06:16,  1.32s/it] 40%|███▉      | 187/471 [04:03<06:15,  1.32s/it] 40%|███▉      | 188/471 [04:04<06:14,  1.32s/it] 40%|████      | 189/471 [04:06<06:12,  1.32s/it] 40%|████      | 190/471 [04:07<06:11,  1.32s/it] 41%|████      | 191/471 [04:08<06:10,  1.32s/it] 41%|████      | 192/471 [04:10<06:08,  1.32s/it] 41%|████      | 193/471 [04:11<06:07,  1.32s/it] 41%|████      | 194/471 [04:12<06:06,  1.32s/it] 41%|████▏     | 195/471 [04:14<06:05,  1.32s/it] 42%|████▏     | 196/471 [04:15<06:03,  1.32s/it] 42%|████▏     | 197/471 [04:16<06:01,  1.32s/it] 42%|████▏     | 198/471 [04:18<05:59,  1.32s/it] 42%|████▏     | 199/471 [04:19<05:58,  1.32s/it] 42%|████▏     | 200/471 [04:20<05:58,  1.32s/it] 43%|████▎     | 201/471 [04:22<05:55,  1.32s/it] 43%|████▎     | 202/471 [04:23<05:55,  1.32s/it] 43%|████▎     | 203/471 [04:24<05:53,  1.32s/it] 43%|████▎     | 204/471 [04:26<05:53,  1.32s/it] 44%|████▎     | 205/471 [04:27<05:51,  1.32s/it] 44%|████▎     | 206/471 [04:28<05:49,  1.32s/it] 44%|████▍     | 207/471 [04:29<05:48,  1.32s/it] 44%|████▍     | 208/471 [04:31<05:46,  1.32s/it] 44%|████▍     | 209/471 [04:32<05:45,  1.32s/it] 45%|████▍     | 210/471 [04:33<05:44,  1.32s/it] 45%|████▍     | 211/471 [04:35<05:42,  1.32s/it] 45%|████▌     | 212/471 [04:36<05:41,  1.32s/it] 45%|████▌     | 213/471 [04:37<05:40,  1.32s/it] 45%|████▌     | 214/471 [04:39<05:39,  1.32s/it] 46%|████▌     | 215/471 [04:40<05:38,  1.32s/it] 46%|████▌     | 216/471 [04:41<05:36,  1.32s/it] 46%|████▌     | 217/471 [04:43<05:35,  1.32s/it] 46%|████▋     | 218/471 [04:44<05:34,  1.32s/it] 46%|████▋     | 219/471 [04:45<05:33,  1.32s/it] 47%|████▋     | 220/471 [04:47<05:32,  1.32s/it] 47%|████▋     | 221/471 [04:48<05:30,  1.32s/it] 47%|████▋     | 222/471 [04:49<05:28,  1.32s/it] 47%|████▋     | 223/471 [04:51<05:27,  1.32s/it] 48%|████▊     | 224/471 [04:52<05:26,  1.32s/it] 48%|████▊     | 225/471 [04:53<05:25,  1.32s/it] 48%|████▊     | 226/471 [04:55<05:24,  1.32s/it] 48%|████▊     | 227/471 [04:56<05:22,  1.32s/it] 48%|████▊     | 228/471 [04:57<05:21,  1.32s/it] 49%|████▊     | 229/471 [04:59<05:20,  1.32s/it] 49%|████▉     | 230/471 [05:00<05:18,  1.32s/it] 49%|████▉     | 231/471 [05:01<05:17,  1.32s/it] 49%|████▉     | 232/471 [05:03<05:15,  1.32s/it] 49%|████▉     | 233/471 [05:04<05:14,  1.32s/it] 50%|████▉     | 234/471 [05:05<05:13,  1.32s/it] 50%|████▉     | 235/471 [05:06<05:12,  1.32s/it] 50%|█████     | 236/471 [05:08<05:10,  1.32s/it] 50%|█████     | 237/471 [05:09<05:08,  1.32s/it] 51%|█████     | 238/471 [05:10<05:07,  1.32s/it] 51%|█████     | 239/471 [05:12<05:06,  1.32s/it] 51%|█████     | 240/471 [05:13<05:05,  1.32s/it] 51%|█████     | 241/471 [05:14<05:04,  1.32s/it] 51%|█████▏    | 242/471 [05:16<05:02,  1.32s/it] 52%|█████▏    | 243/471 [05:17<05:00,  1.32s/it] 52%|█████▏    | 244/471 [05:18<04:59,  1.32s/it] 52%|█████▏    | 245/471 [05:20<04:58,  1.32s/it] 52%|█████▏    | 246/471 [05:21<04:56,  1.32s/it] 52%|█████▏    | 247/471 [05:22<04:55,  1.32s/it] 53%|█████▎    | 248/471 [05:24<04:54,  1.32s/it] 53%|█████▎    | 249/471 [05:25<04:53,  1.32s/it] 53%|█████▎    | 250/471 [05:26<04:51,  1.32s/it] 53%|█████▎    | 251/471 [05:28<04:50,  1.32s/it] 54%|█████▎    | 252/471 [05:29<04:49,  1.32s/it] 54%|█████▎    | 253/471 [05:30<04:48,  1.32s/it] 54%|█████▍    | 254/471 [05:32<04:47,  1.32s/it] 54%|█████▍    | 255/471 [05:33<04:45,  1.32s/it] 54%|█████▍    | 256/471 [05:34<04:44,  1.32s/it] 55%|█████▍    | 257/471 [05:36<04:42,  1.32s/it] 55%|█████▍    | 258/471 [05:37<04:41,  1.32s/it] 55%|█████▍    | 259/471 [05:38<04:40,  1.32s/it] 55%|█████▌    | 260/471 [05:40<04:39,  1.32s/it] 55%|█████▌    | 261/471 [05:41<04:37,  1.32s/it] 56%|█████▌    | 262/471 [05:42<04:35,  1.32s/it] 56%|█████▌    | 263/471 [05:43<04:34,  1.32s/it] 56%|█████▌    | 264/471 [05:45<04:33,  1.32s/it] 56%|█████▋    | 265/471 [05:46<04:31,  1.32s/it] 56%|█████▋    | 266/471 [05:47<04:30,  1.32s/it] 57%|█████▋    | 267/471 [05:49<04:29,  1.32s/it] 57%|█████▋    | 268/471 [05:50<04:27,  1.32s/it] 57%|█████▋    | 269/471 [05:51<04:26,  1.32s/it] 57%|█████▋    | 270/471 [05:53<04:24,  1.32s/it] 58%|█████▊    | 271/471 [05:54<04:23,  1.32s/it] 58%|█████▊    | 272/471 [05:55<04:21,  1.32s/it] 58%|█████▊    | 273/471 [05:57<04:20,  1.32s/it] 58%|█████▊    | 274/471 [05:58<04:19,  1.32s/it] 58%|█████▊    | 275/471 [05:59<04:17,  1.32s/it] 59%|█████▊    | 276/471 [06:01<04:16,  1.32s/it] 59%|█████▉    | 277/471 [06:02<04:15,  1.32s/it] 59%|█████▉    | 278/471 [06:03<04:14,  1.32s/it] 59%|█████▉    | 279/471 [06:05<04:12,  1.32s/it] 59%|█████▉    | 280/471 [06:06<04:11,  1.32s/it] 60%|█████▉    | 281/471 [06:07<04:10,  1.32s/it] 60%|█████▉    | 282/471 [06:08<04:08,  1.32s/it] 60%|██████    | 283/471 [06:10<04:07,  1.32s/it] 60%|██████    | 284/471 [06:11<04:05,  1.32s/it] 61%|██████    | 285/471 [06:12<04:04,  1.31s/it] 61%|██████    | 286/471 [06:14<04:03,  1.31s/it] 61%|██████    | 287/471 [06:15<04:01,  1.31s/it] 61%|██████    | 288/471 [06:16<04:00,  1.32s/it] 61%|██████▏   | 289/471 [06:18<03:59,  1.31s/it] 62%|██████▏   | 290/471 [06:19<03:57,  1.31s/it] 62%|██████▏   | 291/471 [06:20<03:56,  1.31s/it] 62%|██████▏   | 292/471 [06:22<03:55,  1.31s/it] 62%|██████▏   | 293/471 [06:23<03:53,  1.31s/it] 62%|██████▏   | 294/471 [06:24<03:52,  1.31s/it] 63%|██████▎   | 295/471 [06:26<03:51,  1.31s/it] 63%|██████▎   | 296/471 [06:27<03:49,  1.31s/it] 63%|██████▎   | 297/471 [06:28<03:48,  1.31s/it] 63%|██████▎   | 298/471 [06:30<03:47,  1.32s/it] 63%|██████▎   | 299/471 [06:31<03:46,  1.32s/it] 64%|██████▎   | 300/471 [06:32<03:45,  1.32s/it] 64%|██████▍   | 301/471 [06:33<03:43,  1.32s/it] 64%|██████▍   | 302/471 [06:35<03:42,  1.32s/it] 64%|██████▍   | 303/471 [06:36<03:40,  1.31s/it] 65%|██████▍   | 304/471 [06:37<03:39,  1.31s/it] 65%|██████▍   | 305/471 [06:39<03:38,  1.32s/it] 65%|██████▍   | 306/471 [06:40<03:37,  1.32s/it] 65%|██████▌   | 307/471 [06:41<03:36,  1.32s/it] 65%|██████▌   | 308/471 [06:43<03:35,  1.32s/it] 66%|██████▌   | 309/471 [06:44<03:33,  1.32s/it] 66%|██████▌   | 310/471 [06:45<03:32,  1.32s/it] 66%|██████▌   | 311/471 [06:47<03:30,  1.32s/it] 66%|██████▌   | 312/471 [06:48<03:29,  1.32s/it] 66%|██████▋   | 313/471 [06:49<03:28,  1.32s/it] 67%|██████▋   | 314/471 [06:51<03:26,  1.32s/it] 67%|██████▋   | 315/471 [06:52<03:25,  1.32s/it] 67%|██████▋   | 316/471 [06:53<03:24,  1.32s/it] 67%|██████▋   | 317/471 [06:55<03:22,  1.32s/it] 68%|██████▊   | 318/471 [06:56<03:21,  1.32s/it] 68%|██████▊   | 319/471 [06:57<03:20,  1.32s/it] 68%|██████▊   | 320/471 [06:59<03:19,  1.32s/it] 68%|██████▊   | 321/471 [07:00<03:18,  1.32s/it] 68%|██████▊   | 322/471 [07:01<03:16,  1.32s/it] 69%|██████▊   | 323/471 [07:02<03:15,  1.32s/it] 69%|██████▉   | 324/471 [07:04<03:14,  1.32s/it] 69%|██████▉   | 325/471 [07:05<03:12,  1.32s/it] 69%|██████▉   | 326/471 [07:06<03:11,  1.32s/it] 69%|██████▉   | 327/471 [07:08<03:09,  1.32s/it] 70%|██████▉   | 328/471 [07:09<03:08,  1.32s/it] 70%|██████▉   | 329/471 [07:10<03:07,  1.32s/it] 70%|███████   | 330/471 [07:12<03:05,  1.32s/it] 70%|███████   | 331/471 [07:13<03:04,  1.32s/it] 70%|███████   | 332/471 [07:14<03:03,  1.32s/it] 71%|███████   | 333/471 [07:16<03:01,  1.32s/it] 71%|███████   | 334/471 [07:17<03:00,  1.32s/it] 71%|███████   | 335/471 [07:18<02:59,  1.32s/it] 71%|███████▏  | 336/471 [07:20<02:57,  1.32s/it] 72%|███████▏  | 337/471 [07:21<02:56,  1.32s/it] 72%|███████▏  | 338/471 [07:22<02:54,  1.32s/it] 72%|███████▏  | 339/471 [07:24<02:53,  1.32s/it] 72%|███████▏  | 340/471 [07:25<02:52,  1.32s/it] 72%|███████▏  | 341/471 [07:26<02:51,  1.32s/it] 73%|███████▎  | 342/471 [07:28<02:49,  1.32s/it] 73%|███████▎  | 343/471 [07:29<02:48,  1.32s/it] 73%|███████▎  | 344/471 [07:30<02:47,  1.32s/it] 73%|███████▎  | 345/471 [07:31<02:45,  1.32s/it] 73%|███████▎  | 346/471 [07:33<02:44,  1.32s/it] 74%|███████▎  | 347/471 [07:34<02:43,  1.32s/it] 74%|███████▍  | 348/471 [07:35<02:41,  1.32s/it] 74%|███████▍  | 349/471 [07:37<02:40,  1.32s/it] 74%|███████▍  | 350/471 [07:38<02:39,  1.32s/it] 75%|███████▍  | 351/471 [07:39<02:37,  1.32s/it] 75%|███████▍  | 352/471 [07:41<02:36,  1.32s/it] 75%|███████▍  | 353/471 [07:42<02:35,  1.32s/it] 75%|███████▌  | 354/471 [07:43<02:34,  1.32s/it] 75%|███████▌  | 355/471 [07:45<02:33,  1.32s/it] 76%|███████▌  | 356/471 [07:46<02:31,  1.32s/it] 76%|███████▌  | 357/471 [07:47<02:30,  1.32s/it] 76%|███████▌  | 358/471 [07:49<02:29,  1.32s/it] 76%|███████▌  | 359/471 [07:50<02:27,  1.32s/it] 76%|███████▋  | 360/471 [07:51<02:26,  1.32s/it] 77%|███████▋  | 361/471 [07:53<02:25,  1.32s/it] 77%|███████▋  | 362/471 [07:54<02:23,  1.32s/it] 77%|███████▋  | 363/471 [07:55<02:22,  1.32s/it] 77%|███████▋  | 364/471 [07:56<02:20,  1.32s/it] 77%|███████▋  | 365/471 [07:58<02:19,  1.32s/it] 78%|███████▊  | 366/471 [07:59<02:18,  1.32s/it] 78%|███████▊  | 367/471 [08:00<02:17,  1.32s/it] 78%|███████▊  | 368/471 [08:02<02:16,  1.32s/it] 78%|███████▊  | 369/471 [08:03<02:14,  1.32s/it] 79%|███████▊  | 370/471 [08:04<02:13,  1.32s/it] 79%|███████▉  | 371/471 [08:06<02:12,  1.32s/it] 79%|███████▉  | 372/471 [08:07<02:10,  1.32s/it] 79%|███████▉  | 373/471 [08:08<02:09,  1.32s/it] 79%|███████▉  | 374/471 [08:10<02:08,  1.32s/it] 80%|███████▉  | 375/471 [08:11<02:06,  1.32s/it] 80%|███████▉  | 376/471 [08:12<02:05,  1.32s/it] 80%|████████  | 377/471 [08:14<02:04,  1.32s/it] 80%|████████  | 378/471 [08:15<02:02,  1.32s/it] 80%|████████  | 379/471 [08:16<02:01,  1.32s/it] 81%|████████  | 380/471 [08:18<02:00,  1.32s/it] 81%|████████  | 381/471 [08:19<01:58,  1.32s/it] 81%|████████  | 382/471 [08:20<01:57,  1.32s/it] 81%|████████▏ | 383/471 [08:22<01:56,  1.32s/it] 82%|████████▏ | 384/471 [08:23<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:24<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:26<01:52,  1.33s/it] 82%|████████▏ | 387/471 [08:27<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:28<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:30<01:48,  1.33s/it] 83%|████████▎ | 390/471 [08:31<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:32<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:34<01:44,  1.33s/it] 83%|████████▎ | 393/471 [08:35<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:36<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:38<01:41,  1.33s/it] 84%|████████▍ | 396/471 [08:39<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:40<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:42<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:43<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:44<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:46<01:33,  1.33s/it] 85%|████████▌ | 402/471 [08:47<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:48<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:50<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:51<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:52<01:26,  1.33s/it] 86%|████████▋ | 407/471 [08:54<01:24,  1.33s/it] 87%|████████▋ | 408/471 [08:55<01:23,  1.33s/it] 87%|████████▋ | 409/471 [08:56<01:22,  1.33s/it] 87%|████████▋ | 410/471 [08:58<01:21,  1.33s/it] 87%|████████▋ | 411/471 [08:59<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:00<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:02<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:03<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:04<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:06<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:07<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:08<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:09<01:09,  1.33s/it] 89%|████████▉ | 420/471 [09:11<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:12<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:13<01:04,  1.33s/it] 90%|████████▉ | 423/471 [09:15<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:16<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:17<01:00,  1.32s/it] 90%|█████████ | 426/471 [09:19<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:20<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:21<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:23<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:24<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:26<00:57,  1.44s/it] 92%|█████████▏| 432/471 [09:27<00:58,  1.51s/it] 92%|█████████▏| 433/471 [09:29<00:56,  1.48s/it] 92%|█████████▏| 434/471 [09:30<00:53,  1.43s/it] 92%|█████████▏| 435/471 [09:31<00:50,  1.40s/it] 93%|█████████▎| 436/471 [09:33<00:48,  1.38s/it] 93%|█████████▎| 437/471 [09:34<00:46,  1.36s/it] 93%|█████████▎| 438/471 [09:35<00:44,  1.35s/it] 93%|█████████▎| 439/471 [09:37<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:38<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:39<00:39,  1.33s/it] 94%|█████████▍| 442/471 [09:41<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:42<00:37,  1.32s/it] 94%|█████████▍| 444/471 [09:43<00:35,  1.32s/it] 94%|█████████▍| 445/471 [09:45<00:34,  1.32s/it] 95%|█████████▍| 446/471 [09:46<00:33,  1.32s/it] 95%|█████████▍| 447/471 [09:47<00:31,  1.32s/it] 95%|█████████▌| 448/471 [09:49<00:30,  1.32s/it] 95%|█████████▌| 449/471 [09:50<00:29,  1.32s/it] 96%|█████████▌| 450/471 [09:51<00:27,  1.32s/it] 96%|█████████▌| 451/471 [09:53<00:26,  1.32s/it] 96%|█████████▌| 452/471 [09:54<00:25,  1.32s/it] 96%|█████████▌| 453/471 [09:55<00:23,  1.32s/it] 96%|█████████▋| 454/471 [09:57<00:22,  1.32s/it] 97%|█████████▋| 455/471 [09:58<00:21,  1.32s/it] 97%|█████████▋| 456/471 [09:59<00:19,  1.32s/it] 97%|█████████▋| 457/471 [10:01<00:18,  1.32s/it] 97%|█████████▋| 458/471 [10:02<00:17,  1.32s/it] 97%|█████████▋| 459/471 [10:03<00:15,  1.32s/it] 98%|█████████▊| 460/471 [10:05<00:14,  1.32s/it] 98%|█████████▊| 461/471 [10:06<00:13,  1.32s/it] 98%|█████████▊| 462/471 [10:07<00:11,  1.32s/it] 98%|█████████▊| 463/471 [10:08<00:10,  1.32s/it] 99%|█████████▊| 464/471 [10:10<00:09,  1.32s/it] 99%|█████████▊| 465/471 [10:11<00:07,  1.32s/it] 99%|█████████▉| 466/471 [10:12<00:06,  1.32s/it] 99%|█████████▉| 467/471 [10:14<00:05,  1.32s/it] 99%|█████████▉| 468/471 [10:15<00:03,  1.32s/it]100%|█████████▉| 469/471 [10:16<00:02,  1.32s/it]100%|█████████▉| 470/471 [10:18<00:01,  1.32s/it]100%|██████████| 471/471 [10:19<00:00,  1.21s/it]100%|██████████| 471/471 [10:19<00:00,  1.31s/it]
{'eval_loss': 5.22731876373291, 'eval_model_preparation_time': 0.0127, 'eval_acc': 0.17087095061072757, 'eval_runtime': 620.374, 'eval_samples_per_second': 12.141, 'eval_steps_per_second': 0.759}
ROUND:2
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 4.3726, 'grad_norm': 4.319502353668213, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 5.4201, 'grad_norm': 3.511300802230835, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.19s/it]                                              {'loss': 6.4442, 'grad_norm': 5.966859817504883, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 4.6749, 'grad_norm': 5.060673713684082, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 4.1096, 'grad_norm': 5.902008533477783, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:16,  2.25s/it]                                              {'loss': 3.9499, 'grad_norm': 8.66948127746582, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:16,  2.25s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.24s/it]                                              {'loss': 2.8765, 'grad_norm': 6.852555751800537, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.24s/it] 20%|██        | 8/40 [00:15<00:50,  1.59s/it]                                              {'loss': 2.9248, 'grad_norm': 15.202659606933594, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.59s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.542, 'grad_norm': 4.237070560455322, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 1.8442, 'grad_norm': 5.168740749359131, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 2.2037, 'grad_norm': 4.012740135192871, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 2.0921, 'grad_norm': 4.656233310699463, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 2.0224, 'grad_norm': 4.2650346755981445, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.3307, 'grad_norm': 4.8827924728393555, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.7121, 'grad_norm': 6.3092851638793945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0467, 'grad_norm': 1.1898205280303955, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.8313, 'grad_norm': 3.362241506576538, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:36<00:43,  1.98s/it]                                               {'loss': 0.3491, 'grad_norm': 1.8629533052444458, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:43,  1.98s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.06s/it]                                               {'loss': 0.6507, 'grad_norm': 6.4415669441223145, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.06s/it] 50%|█████     | 20/40 [00:40<00:42,  2.12s/it]                                               {'loss': 1.3429, 'grad_norm': 5.053155422210693, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.12s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.6615, 'grad_norm': 3.580599784851074, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it]                                               {'loss': 0.6473, 'grad_norm': 4.135426044464111, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.8246, 'grad_norm': 4.0413126945495605, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0006, 'grad_norm': 0.0636545792222023, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.4853, 'grad_norm': 7.261698246002197, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.6198, 'grad_norm': 7.978694438934326, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.4358, 'grad_norm': 2.470651865005493, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:24,  2.06s/it]                                               {'loss': 0.1875, 'grad_norm': 1.45168137550354, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.5631, 'grad_norm': 3.0510942935943604, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0619, 'grad_norm': 1.0222262144088745, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.18s/it]                                               {'loss': 0.183, 'grad_norm': 3.248042583465576, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.18s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.6622, 'grad_norm': 24.142189025878906, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0831, 'grad_norm': 1.0056931972503662, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.0776, 'grad_norm': 1.5922595262527466, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it]                                               {'loss': 0.1544, 'grad_norm': 2.1887664794921875, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.08s/it]                                               {'loss': 0.2816, 'grad_norm': 2.4885306358337402, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.0793, 'grad_norm': 1.2609038352966309, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0927, 'grad_norm': 2.4203197956085205, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.1251, 'grad_norm': 3.7540087699890137, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0032, 'grad_norm': 0.15666607022285461, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.6042, 'train_samples_per_second': 7.098, 'train_steps_per_second': 0.502, 'train_loss': 1.4242466616648017, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 4.7633, 'grad_norm': 3.394618272781372, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 4.0058, 'grad_norm': 3.3841514587402344, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 4.6313, 'grad_norm': 2.716261386871338, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.1106, 'grad_norm': 7.716928482055664, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.8963, 'grad_norm': 3.19785737991333, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.7283, 'grad_norm': 2.5172598361968994, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 3.1394, 'grad_norm': 4.885149955749512, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 4.5301, 'grad_norm': 17.777429580688477, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.0112, 'grad_norm': 3.351562023162842, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 3.0072, 'grad_norm': 4.106442928314209, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.6421, 'grad_norm': 2.315324306488037, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.8756, 'grad_norm': 6.973255634307861, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 1.6902, 'grad_norm': 6.962481498718262, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.7542, 'grad_norm': 6.163025379180908, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 1.7643, 'grad_norm': 9.97425365447998, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 1.8687, 'grad_norm': 42.981563568115234, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 1.05, 'grad_norm': 5.004268169403076, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.6681, 'grad_norm': 5.740501403808594, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.7026, 'grad_norm': 8.835336685180664, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 1.3585, 'grad_norm': 8.804964065551758, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.4986, 'grad_norm': 5.230327606201172, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.6718, 'grad_norm': 3.277855634689331, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.8825, 'grad_norm': 4.29848575592041, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 3.3838, 'grad_norm': 21.30393409729004, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.3197, 'grad_norm': 2.7800827026367188, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 1.0858, 'grad_norm': 6.553210735321045, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.5061, 'grad_norm': 2.7530083656311035, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.1687, 'grad_norm': 1.4109197854995728, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.3741, 'grad_norm': 3.0316503047943115, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.3522, 'grad_norm': 2.0104920864105225, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.2886, 'grad_norm': 4.228264808654785, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.1881, 'grad_norm': 3.307904005050659, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.527, 'grad_norm': 3.863020658493042, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.1364, 'grad_norm': 2.4589924812316895, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it]                                               {'loss': 0.1985, 'grad_norm': 2.6632304191589355, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.12s/it]                                               {'loss': 0.1652, 'grad_norm': 1.3761028051376343, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.1046, 'grad_norm': 0.9985231161117554, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.3616, 'grad_norm': 4.6878814697265625, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.5342, 'grad_norm': 3.634892225265503, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0012, 'grad_norm': 0.02709127590060234, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2786, 'train_samples_per_second': 7.127, 'train_steps_per_second': 0.505, 'train_loss': 1.4486655453103594, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:46
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 5.3104, 'grad_norm': 4.458317756652832, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 4.5249, 'grad_norm': 2.761198043823242, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 4.8916, 'grad_norm': 4.412369251251221, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 4.8987, 'grad_norm': 3.457909345626831, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 4.4798, 'grad_norm': 6.052689075469971, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it]                                              {'loss': 3.5885, 'grad_norm': 9.685916900634766, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 2.8097, 'grad_norm': 5.825867652893066, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 10.6813, 'grad_norm': 25.71489715576172, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.9806, 'grad_norm': 5.033325672149658, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.7902, 'grad_norm': 5.5859503746032715, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.6269, 'grad_norm': 4.5444016456604, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.4222, 'grad_norm': 5.207832336425781, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 2.029, 'grad_norm': 4.8980393409729, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.824, 'grad_norm': 5.772612571716309, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.2568, 'grad_norm': 3.638568162918091, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.5917, 'grad_norm': 11.170624732971191, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.9742, 'grad_norm': 6.5501275062561035, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.9385, 'grad_norm': 4.134509563446045, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.8118, 'grad_norm': 2.205425500869751, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.111, 'grad_norm': 1.2054269313812256, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.6621, 'grad_norm': 3.0732972621917725, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.7598, 'grad_norm': 5.254231929779053, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.5468, 'grad_norm': 3.550387382507324, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0154, 'grad_norm': 0.4846668541431427, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.2165, 'grad_norm': 0.9305142760276794, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.3643, 'grad_norm': 2.4166462421417236, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.2832, 'grad_norm': 1.5121885538101196, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.4526, 'grad_norm': 5.26730489730835, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.6619, 'grad_norm': 4.631895542144775, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0747, 'grad_norm': 1.0494554042816162, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.0883, 'grad_norm': 1.7087737321853638, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.1774, 'grad_norm': 6.569725036621094, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0928, 'grad_norm': 1.634826421737671, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0217, 'grad_norm': 0.46472859382629395, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0595, 'grad_norm': 0.7682294845581055, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1456, 'grad_norm': 1.414852499961853, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0199, 'grad_norm': 0.3035752475261688, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it]                                               {'loss': 0.1649, 'grad_norm': 2.529716968536377, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.17s/it]                                               {'loss': 0.1672, 'grad_norm': 2.366485595703125, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.17s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0056, 'grad_norm': 0.23931996524333954, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.6649, 'train_samples_per_second': 7.182, 'train_steps_per_second': 0.508, 'train_loss': 1.5130548195447773, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]                                              {'loss': 4.1602, 'grad_norm': 2.7898459434509277, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 6.1133, 'grad_norm': 4.122933864593506, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 4.7014, 'grad_norm': 5.306115627288818, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 4.9439, 'grad_norm': 6.722001552581787, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 5.4621, 'grad_norm': 5.272650718688965, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 3.1845, 'grad_norm': 5.01517915725708, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 2.4541, 'grad_norm': 6.696282863616943, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 7.6946, 'grad_norm': 26.823402404785156, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.3783, 'grad_norm': 7.4497785568237305, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 2.1525, 'grad_norm': 16.381267547607422, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.8786, 'grad_norm': 6.180014133453369, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.5267, 'grad_norm': 5.1776275634765625, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.9102, 'grad_norm': 4.924357891082764, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.1597, 'grad_norm': 4.452056407928467, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.0331, 'grad_norm': 4.5296950340271, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 1.8387, 'grad_norm': 26.18114471435547, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.5748, 'grad_norm': 4.8572468757629395, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.5372, 'grad_norm': 16.990827560424805, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 1.0996, 'grad_norm': 13.986918449401855, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.868, 'grad_norm': 3.048800468444824, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.4873, 'grad_norm': 3.4703471660614014, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.6836, 'grad_norm': 1.9672731161117554, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.8964, 'grad_norm': 5.381587505340576, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.275, 'grad_norm': 4.415550231933594, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.5323, 'grad_norm': 4.330841541290283, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.4325, 'grad_norm': 2.2510924339294434, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.2495, 'grad_norm': 4.226151466369629, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.4595, 'grad_norm': 3.675143241882324, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.3611, 'grad_norm': 2.5499110221862793, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.1777, 'grad_norm': 2.306831121444702, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.1478, 'grad_norm': 2.891209840774536, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.1444, 'grad_norm': 3.274324893951416, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.1119, 'grad_norm': 2.018073558807373, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.6017, 'grad_norm': 7.4627275466918945, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it]                                               {'loss': 0.0398, 'grad_norm': 0.7846558690071106, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0919, 'grad_norm': 1.4506421089172363, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0714, 'grad_norm': 1.3677624464035034, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.0398, 'grad_norm': 0.5566874742507935, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.1125, 'grad_norm': 20.719396591186523, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0047, 'grad_norm': 0.22043274343013763, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.4104, 'train_samples_per_second': 7.206, 'train_steps_per_second': 0.51, 'train_loss': 1.5148083120933733, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 5.051, 'grad_norm': 1.9804372787475586, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.6163, 'grad_norm': 3.1328554153442383, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 5.2812, 'grad_norm': 4.041795253753662, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 3.3397, 'grad_norm': 3.399038314819336, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.9104, 'grad_norm': 4.554917335510254, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.0573, 'grad_norm': 3.903519630432129, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 4.0394, 'grad_norm': 6.403553485870361, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.1658, 'grad_norm': 19.20027732849121, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.6898, 'grad_norm': 3.5644733905792236, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 2.5155, 'grad_norm': 4.692173004150391, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.8558, 'grad_norm': 4.068814277648926, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.2633, 'grad_norm': 7.84549617767334, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 2.4298, 'grad_norm': 6.783194065093994, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.778, 'grad_norm': 4.232417583465576, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 1.4658, 'grad_norm': 71.89160919189453, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.033, 'grad_norm': 0.6869964003562927, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 1.0507, 'grad_norm': 15.58645248413086, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.8902, 'grad_norm': 4.5421648025512695, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.7495, 'grad_norm': 11.864591598510742, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 1.9723, 'grad_norm': 28.830163955688477, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 1.3636, 'grad_norm': 11.1173734664917, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.4819, 'grad_norm': 7.807876110076904, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.7822, 'grad_norm': 5.2491350173950195, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0054, 'grad_norm': 0.27421456575393677, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 1.3806, 'grad_norm': 5.124569416046143, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 1.2404, 'grad_norm': 8.14113712310791, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.2966, 'grad_norm': 2.8412060737609863, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.4538, 'grad_norm': 2.374234437942505, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.5113, 'grad_norm': 2.889796733856201, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.727, 'grad_norm': 4.454981327056885, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.5665, 'grad_norm': 8.418439865112305, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.8504, 'grad_norm': 18.78601837158203, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.8624, 'grad_norm': 12.370460510253906, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 1.0976, 'grad_norm': 7.720812797546387, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.4449, 'grad_norm': 3.1029298305511475, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.12s/it]                                               {'loss': 0.3936, 'grad_norm': 8.157150268554688, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.6086, 'grad_norm': 14.44949722290039, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.9602, 'grad_norm': 20.466442108154297, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.8553, 'grad_norm': 6.5831990242004395, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0064, 'grad_norm': 0.2017732709646225, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.5385, 'train_samples_per_second': 7.103, 'train_steps_per_second': 0.503, 'train_loss': 1.50108234831132, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.08s/it]                                              {'loss': 4.4665, 'grad_norm': 3.4646472930908203, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.08s/it]  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]                                              {'loss': 3.4068, 'grad_norm': 3.2649178504943848, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]  8%|▊         | 3/40 [00:06<01:17,  2.10s/it]                                              {'loss': 4.5776, 'grad_norm': 3.991797924041748, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:17,  2.10s/it] 10%|█         | 4/40 [00:08<01:16,  2.12s/it]                                              {'loss': 4.4174, 'grad_norm': 5.004247665405273, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.12s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.13s/it]                                              {'loss': 3.7258, 'grad_norm': 3.506510019302368, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.13s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it]                                              {'loss': 2.4549, 'grad_norm': 8.666192054748535, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.15s/it]                                              {'loss': 3.6769, 'grad_norm': 4.4086174964904785, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.15s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 3.0036, 'grad_norm': 37.29859161376953, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.71s/it]                                              {'loss': 1.3901, 'grad_norm': 3.348876714706421, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.71s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.3402, 'grad_norm': 3.573404550552368, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it]                                               {'loss': 1.5496, 'grad_norm': 6.3697638511657715, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 0.9666, 'grad_norm': 7.130876541137695, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:25<00:55,  2.06s/it]                                               {'loss': 1.5277, 'grad_norm': 9.188074111938477, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:25<00:55,  2.06s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.08s/it]                                               {'loss': 1.0796, 'grad_norm': 4.523995876312256, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.08s/it] 38%|███▊      | 15/40 [00:30<00:52,  2.11s/it]                                               {'loss': 1.9122, 'grad_norm': 3.7483837604522705, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:52,  2.11s/it] 40%|████      | 16/40 [00:30<00:36,  1.53s/it]                                               {'loss': 0.2607, 'grad_norm': 3.147883653640747, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.53s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.71s/it]                                               {'loss': 1.1402, 'grad_norm': 4.191168308258057, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.71s/it] 45%|████▌     | 18/40 [00:34<00:40,  1.86s/it]                                               {'loss': 0.8629, 'grad_norm': 5.795694828033447, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:40,  1.86s/it] 48%|████▊     | 19/40 [00:36<00:40,  1.94s/it]                                               {'loss': 0.8505, 'grad_norm': 6.521531581878662, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:36<00:40,  1.94s/it] 50%|█████     | 20/40 [00:39<00:40,  2.01s/it]                                               {'loss': 0.5216, 'grad_norm': 4.467301368713379, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.01s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it]                                               {'loss': 0.2587, 'grad_norm': 1.7326209545135498, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it]                                               {'loss': 0.3372, 'grad_norm': 3.233189582824707, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.14s/it]                                               {'loss': 0.557, 'grad_norm': 8.415305137634277, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.14s/it] 60%|██████    | 24/40 [00:45<00:24,  1.55s/it]                                               {'loss': 0.0054, 'grad_norm': 0.5298978686332703, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:45<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.6194, 'grad_norm': 7.939402103424072, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.87s/it]                                               {'loss': 0.174, 'grad_norm': 2.518601894378662, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.87s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.96s/it]                                               {'loss': 0.2002, 'grad_norm': 1.5840855836868286, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.96s/it] 70%|███████   | 28/40 [00:54<00:24,  2.05s/it]                                               {'loss': 0.1617, 'grad_norm': 1.083038330078125, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:56<00:23,  2.09s/it]                                               {'loss': 0.0643, 'grad_norm': 1.2073105573654175, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:56<00:23,  2.09s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it]                                               {'loss': 0.1142, 'grad_norm': 1.6245722770690918, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.14s/it]                                               {'loss': 0.2674, 'grad_norm': 1.8674827814102173, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.14s/it] 80%|████████  | 32/40 [01:01<00:12,  1.55s/it]                                               {'loss': 0.1831, 'grad_norm': 5.400198936462402, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.55s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.75s/it]                                               {'loss': 0.056, 'grad_norm': 1.162234902381897, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.75s/it] 85%|████████▌ | 34/40 [01:05<00:11,  1.88s/it]                                               {'loss': 0.1935, 'grad_norm': 5.750776767730713, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:05<00:11,  1.88s/it] 88%|████████▊ | 35/40 [01:08<00:09,  1.98s/it]                                               {'loss': 0.0942, 'grad_norm': 2.125519037246704, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  1.98s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.05s/it]                                               {'loss': 0.0972, 'grad_norm': 2.194931745529175, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.05s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.10s/it]                                               {'loss': 0.0373, 'grad_norm': 0.6140392422676086, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.10s/it] 95%|█████████▌| 38/40 [01:14<00:04,  2.14s/it]                                               {'loss': 0.2129, 'grad_norm': 4.493420124053955, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:14<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:16<00:02,  2.16s/it]                                               {'loss': 0.3904, 'grad_norm': 2.6231889724731445, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:16<00:02,  2.16s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.0002, 'grad_norm': 0.008782299235463142, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 77.3598, 'train_samples_per_second': 7.304, 'train_steps_per_second': 0.517, 'train_loss': 1.178899428639852, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]100%|██████████| 40/40 [01:17<00:00,  1.93s/it]
CLIENT:23
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 5.7432, 'grad_norm': 3.6723833084106445, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 6.2185, 'grad_norm': 4.805140972137451, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 5.5542, 'grad_norm': 4.153676986694336, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 4.5394, 'grad_norm': 2.9795374870300293, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 5.5417, 'grad_norm': 6.951344013214111, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 4.453, 'grad_norm': 5.501753330230713, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 3.4706, 'grad_norm': 5.305789470672607, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 4.0008, 'grad_norm': 23.38846778869629, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 1.2567, 'grad_norm': 9.461613655090332, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 3.1641, 'grad_norm': 6.614999771118164, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 3.406, 'grad_norm': 15.802316665649414, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 2.1957, 'grad_norm': 15.080695152282715, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it]                                               {'loss': 1.7403, 'grad_norm': 5.147090911865234, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.18s/it]                                               {'loss': 1.6269, 'grad_norm': 3.945610523223877, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 2.3119, 'grad_norm': 9.399635314941406, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 2.5474, 'grad_norm': 14.300793647766113, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 2.1828, 'grad_norm': 24.80453872680664, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.94s/it]                                               {'loss': 1.8336, 'grad_norm': 11.085729598999023, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.06s/it]                                               {'loss': 1.8941, 'grad_norm': 11.619490623474121, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.06s/it] 50%|█████     | 20/40 [00:40<00:42,  2.12s/it]                                               {'loss': 1.5304, 'grad_norm': 5.22561502456665, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.12s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.16s/it]                                               {'loss': 1.0213, 'grad_norm': 4.523606777191162, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.16s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 1.3968, 'grad_norm': 22.30866813659668, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 1.1102, 'grad_norm': 14.88127326965332, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 0.7183, 'grad_norm': 9.176854133605957, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it]                                               {'loss': 0.6134, 'grad_norm': 2.5939505100250244, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 1.2621, 'grad_norm': 21.588123321533203, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 1.2339, 'grad_norm': 5.834046840667725, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.7576, 'grad_norm': 3.3722589015960693, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.5615, 'grad_norm': 4.145396709442139, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it]                                               {'loss': 0.6564, 'grad_norm': 3.79502010345459, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.25s/it]                                               {'loss': 0.4274, 'grad_norm': 3.1301791667938232, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.25s/it] 80%|████████  | 32/40 [01:03<00:13,  1.66s/it]                                               {'loss': 0.7975, 'grad_norm': 17.849157333374023, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:13,  1.66s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.84s/it]                                               {'loss': 0.5067, 'grad_norm': 3.3844385147094727, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.84s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it]                                               {'loss': 0.3158, 'grad_norm': 2.1254758834838867, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.5059, 'grad_norm': 6.768980503082275, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.2606, 'grad_norm': 2.116767644882202, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it]                                               {'loss': 0.1725, 'grad_norm': 1.4676960706710815, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.4536, 'grad_norm': 5.626927852630615, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.4515, 'grad_norm': 3.664095640182495, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0895, 'grad_norm': 2.342559814453125, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 80.1333, 'train_samples_per_second': 7.051, 'train_steps_per_second': 0.499, 'train_loss': 1.9630991952493786, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]100%|██████████| 40/40 [01:20<00:00,  2.00s/it]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 7.8213, 'grad_norm': 4.59313440322876, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 5.4434, 'grad_norm': 3.8312795162200928, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 5.6379, 'grad_norm': 5.94086217880249, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.9464, 'grad_norm': 6.287203788757324, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 5.0297, 'grad_norm': 9.633027076721191, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 3.6432, 'grad_norm': 4.720531940460205, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 2.617, 'grad_norm': 7.7131028175354, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:51,  1.60s/it]                                              {'loss': 2.4142, 'grad_norm': 44.59407043457031, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:51,  1.60s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.80s/it]                                              {'loss': 2.2151, 'grad_norm': 3.1379494667053223, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.80s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 1.9244, 'grad_norm': 14.005589485168457, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 1.8526, 'grad_norm': 5.582966327667236, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 1.8899, 'grad_norm': 5.0532426834106445, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.8853, 'grad_norm': 6.329570293426514, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.5099, 'grad_norm': 6.472633361816406, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.913, 'grad_norm': 3.978654623031616, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 0.0026, 'grad_norm': 0.17994439601898193, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it]                                               {'loss': 0.5447, 'grad_norm': 9.009339332580566, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 0.8665, 'grad_norm': 6.2652130126953125, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 1.1046, 'grad_norm': 5.191290378570557, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.4727, 'grad_norm': 3.49865460395813, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.9781, 'grad_norm': 4.062967300415039, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.7317, 'grad_norm': 4.207416534423828, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.7969, 'grad_norm': 3.959895133972168, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.1655, 'grad_norm': 4.603292465209961, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.3969, 'grad_norm': 4.855899333953857, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0809, 'grad_norm': 2.2365336418151855, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.1598, 'grad_norm': 2.874067544937134, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.7296, 'grad_norm': 6.379777908325195, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.5826, 'grad_norm': 4.435510635375977, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.2197, 'grad_norm': 2.099985122680664, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it]                                               {'loss': 0.3595, 'grad_norm': 2.5364181995391846, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it] 80%|████████  | 32/40 [01:03<00:13,  1.66s/it]                                               {'loss': 0.2299, 'grad_norm': 6.507424354553223, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:13,  1.66s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.84s/it]                                               {'loss': 0.3593, 'grad_norm': 1.457364797592163, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.84s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it]                                               {'loss': 0.956, 'grad_norm': 4.60306978225708, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.07s/it]                                               {'loss': 0.1581, 'grad_norm': 1.5776314735412598, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.07s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.14s/it]                                               {'loss': 0.1892, 'grad_norm': 2.878359317779541, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.14s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.18s/it]                                               {'loss': 0.2054, 'grad_norm': 75.17752838134766, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.18s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.1481, 'grad_norm': 1.666588544845581, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0444, 'grad_norm': 0.7580932974815369, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.3014, 'grad_norm': 13.617815971374512, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 80.014, 'train_samples_per_second': 7.061, 'train_steps_per_second': 0.5, 'train_loss': 1.4881884491012898, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.61s/it]100%|██████████| 40/40 [01:20<00:00,  2.00s/it]
CLIENT:70
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 3.4756, 'grad_norm': 2.9963700771331787, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:20,  2.11s/it]                                              {'loss': 3.9358, 'grad_norm': 5.278014659881592, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.11s/it]  8%|▊         | 3/40 [00:06<01:18,  2.12s/it]                                              {'loss': 4.8373, 'grad_norm': 7.643063068389893, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.12s/it] 10%|█         | 4/40 [00:08<01:15,  2.10s/it]                                              {'loss': 4.0009, 'grad_norm': 3.6650402545928955, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:15,  2.10s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it]                                              {'loss': 4.6964, 'grad_norm': 5.105266094207764, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it]                                              {'loss': 2.9179, 'grad_norm': 5.512711524963379, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 4.0039, 'grad_norm': 5.139056205749512, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 0.8984, 'grad_norm': 15.348864555358887, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.71s/it]                                              {'loss': 2.4955, 'grad_norm': 4.41409969329834, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.71s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it]                                               {'loss': 3.1842, 'grad_norm': 17.267148971557617, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it]                                               {'loss': 2.2173, 'grad_norm': 14.344870567321777, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it] 30%|███       | 12/40 [00:23<00:57,  2.04s/it]                                               {'loss': 3.081, 'grad_norm': 46.896671295166016, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.1853, 'grad_norm': 8.222719192504883, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 2.3249, 'grad_norm': 42.53024673461914, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 2.7449, 'grad_norm': 6.76438570022583, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:30<00:39,  1.64s/it]                                               {'loss': 0.3677, 'grad_norm': 5.465068340301514, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:39,  1.64s/it] 42%|████▎     | 17/40 [00:33<00:42,  1.86s/it]                                               {'loss': 1.148, 'grad_norm': 6.000171184539795, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:42,  1.86s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.95s/it]                                               {'loss': 1.1426, 'grad_norm': 2.7583324909210205, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.95s/it] 48%|████▊     | 19/40 [00:37<00:43,  2.05s/it]                                               {'loss': 1.5624, 'grad_norm': 3.941833019256592, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:43,  2.05s/it] 50%|█████     | 20/40 [00:40<00:42,  2.12s/it]                                               {'loss': 1.1469, 'grad_norm': 12.113178253173828, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.12s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.18s/it]                                               {'loss': 1.6604, 'grad_norm': 7.315325736999512, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.18s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.21s/it]                                               {'loss': 2.3936, 'grad_norm': 5.268495082855225, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.21s/it] 57%|█████▊    | 23/40 [00:46<00:38,  2.25s/it]                                               {'loss': 1.2078, 'grad_norm': 7.455238342285156, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:38,  2.25s/it] 60%|██████    | 24/40 [00:47<00:26,  1.64s/it]                                               {'loss': 0.1189, 'grad_norm': 7.309051513671875, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:26,  1.64s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.82s/it]                                               {'loss': 0.5767, 'grad_norm': 11.492647171020508, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.82s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.96s/it]                                               {'loss': 0.5501, 'grad_norm': 1.9832210540771484, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.96s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it]                                               {'loss': 0.6494, 'grad_norm': 5.769369125366211, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 1.673, 'grad_norm': 6.465156555175781, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 1.7098, 'grad_norm': 6.708700656890869, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:00<00:22,  2.21s/it]                                               {'loss': 0.7443, 'grad_norm': 6.094035625457764, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:22,  2.21s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 1.1623, 'grad_norm': 5.196937084197998, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:13,  1.66s/it]                                               {'loss': 0.9609, 'grad_norm': 14.092399597167969, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:13,  1.66s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.85s/it]                                               {'loss': 0.7668, 'grad_norm': 5.6980509757995605, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.85s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.97s/it]                                               {'loss': 1.2483, 'grad_norm': 11.239633560180664, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.97s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 1.0775, 'grad_norm': 9.905622482299805, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.4963, 'grad_norm': 6.35538911819458, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.8761, 'grad_norm': 10.37397575378418, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.4769, 'grad_norm': 5.985278129577637, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.626, 'grad_norm': 5.415775775909424, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 1.0818, 'grad_norm': 37.11496353149414, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.6784, 'train_samples_per_second': 7.091, 'train_steps_per_second': 0.502, 'train_loss': 1.785594480857253, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 4.5132, 'grad_norm': 6.976222991943359, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 5.9997, 'grad_norm': 3.8532183170318604, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 3.382, 'grad_norm': 3.5415878295898438, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 4.8161, 'grad_norm': 5.211139678955078, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 4.6009, 'grad_norm': 8.374615669250488, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 2.9874, 'grad_norm': 6.6037678718566895, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:10,  2.14s/it]                                              {'loss': 2.6469, 'grad_norm': 13.113594055175781, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 0.2713, 'grad_norm': 24.376798629760742, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 1.7453, 'grad_norm': 12.567523002624512, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 3.5247, 'grad_norm': 28.169675827026367, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 3.4768, 'grad_norm': 23.298608779907227, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 4.7399, 'grad_norm': 44.91147994995117, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 1.4994, 'grad_norm': 10.747018814086914, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 2.0975, 'grad_norm': 21.7301025390625, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 2.1076, 'grad_norm': 12.559237480163574, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 4.585, 'grad_norm': 21.27054214477539, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.5713, 'grad_norm': 5.733255863189697, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 1.9175, 'grad_norm': 6.162861347198486, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.6939, 'grad_norm': 3.4957988262176514, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.10s/it]                                               {'loss': 1.4971, 'grad_norm': 8.582220077514648, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.18s/it]                                               {'loss': 1.4578, 'grad_norm': 25.36977767944336, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.18s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.20s/it]                                               {'loss': 1.6495, 'grad_norm': 17.66196632385254, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.20s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 1.2287, 'grad_norm': 18.14605712890625, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:26,  1.64s/it]                                               {'loss': 1.8682, 'grad_norm': 84.21592712402344, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:26,  1.64s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.84s/it]                                               {'loss': 1.2094, 'grad_norm': 7.931085109710693, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.84s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it]                                               {'loss': 0.8405, 'grad_norm': 12.449845314025879, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.01s/it]                                               {'loss': 1.6276, 'grad_norm': 5.671436309814453, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.01s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.8751, 'grad_norm': 6.902829647064209, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.3568, 'grad_norm': 3.51362943649292, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 1.2767, 'grad_norm': 7.105534076690674, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.18s/it]                                               {'loss': 0.9211, 'grad_norm': 9.753125190734863, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.18s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 1.2126, 'grad_norm': 76.49545288085938, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.091, 'grad_norm': 2.1809747219085693, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.4214, 'grad_norm': 9.88918399810791, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.2492, 'grad_norm': 5.156119346618652, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.06s/it]                                               {'loss': 0.535, 'grad_norm': 3.135221481323242, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.11s/it]                                               {'loss': 0.5253, 'grad_norm': 5.4767913818359375, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.11s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.13s/it]                                               {'loss': 0.4457, 'grad_norm': 3.5149054527282715, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.13s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.17s/it]                                               {'loss': 0.9471, 'grad_norm': 6.438640594482422, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.17s/it]100%|██████████| 40/40 [01:19<00:00,  1.58s/it]                                               {'loss': 0.4247, 'grad_norm': 22.293243408203125, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.58s/it]                                               {'train_runtime': 79.3986, 'train_samples_per_second': 7.116, 'train_steps_per_second': 0.504, 'train_loss': 1.8959238726645709, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.58s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:49,  1.62it/s]  1%|          | 3/471 [00:02<06:51,  1.14it/s]  1%|          | 4/471 [00:03<07:54,  1.02s/it]  1%|          | 5/471 [00:04<08:29,  1.09s/it]  1%|▏         | 6/471 [00:06<08:50,  1.14s/it]  1%|▏         | 7/471 [00:07<09:06,  1.18s/it]  2%|▏         | 8/471 [00:08<09:16,  1.20s/it]  2%|▏         | 9/471 [00:09<09:21,  1.22s/it]  2%|▏         | 10/471 [00:11<09:25,  1.23s/it]  2%|▏         | 11/471 [00:12<09:27,  1.23s/it]  3%|▎         | 12/471 [00:13<09:30,  1.24s/it]  3%|▎         | 13/471 [00:14<09:31,  1.25s/it]  3%|▎         | 14/471 [00:16<09:31,  1.25s/it]  3%|▎         | 15/471 [00:17<09:31,  1.25s/it]  3%|▎         | 16/471 [00:18<09:31,  1.26s/it]  4%|▎         | 17/471 [00:20<09:31,  1.26s/it]  4%|▍         | 18/471 [00:21<09:32,  1.26s/it]  4%|▍         | 19/471 [00:22<09:30,  1.26s/it]  4%|▍         | 20/471 [00:23<09:30,  1.27s/it]  4%|▍         | 21/471 [00:25<09:29,  1.27s/it]  5%|▍         | 22/471 [00:26<09:29,  1.27s/it]  5%|▍         | 23/471 [00:27<09:29,  1.27s/it]  5%|▌         | 24/471 [00:28<09:31,  1.28s/it]  5%|▌         | 25/471 [00:30<09:28,  1.27s/it]  6%|▌         | 26/471 [00:31<09:28,  1.28s/it]  6%|▌         | 27/471 [00:32<09:26,  1.28s/it]  6%|▌         | 28/471 [00:34<09:24,  1.27s/it]  6%|▌         | 29/471 [00:35<09:25,  1.28s/it]  6%|▋         | 30/471 [00:36<09:22,  1.27s/it]  7%|▋         | 31/471 [00:37<09:22,  1.28s/it]  7%|▋         | 32/471 [00:39<09:21,  1.28s/it]  7%|▋         | 33/471 [00:40<09:19,  1.28s/it]  7%|▋         | 34/471 [00:41<09:20,  1.28s/it]  7%|▋         | 35/471 [00:43<09:18,  1.28s/it]  8%|▊         | 36/471 [00:44<09:20,  1.29s/it]  8%|▊         | 37/471 [00:45<09:16,  1.28s/it]  8%|▊         | 38/471 [00:46<09:17,  1.29s/it]  8%|▊         | 39/471 [00:48<09:15,  1.29s/it]  8%|▊         | 40/471 [00:49<09:13,  1.29s/it]  9%|▊         | 41/471 [00:50<09:13,  1.29s/it]  9%|▉         | 42/471 [00:52<09:14,  1.29s/it]  9%|▉         | 43/471 [00:53<09:12,  1.29s/it]  9%|▉         | 44/471 [00:54<09:11,  1.29s/it] 10%|▉         | 45/471 [00:55<09:11,  1.30s/it] 10%|▉         | 46/471 [00:57<09:10,  1.29s/it] 10%|▉         | 47/471 [00:58<09:08,  1.29s/it] 10%|█         | 48/471 [00:59<09:06,  1.29s/it] 10%|█         | 49/471 [01:01<09:06,  1.29s/it] 11%|█         | 50/471 [01:02<09:08,  1.30s/it] 11%|█         | 51/471 [01:03<09:05,  1.30s/it] 11%|█         | 52/471 [01:05<09:03,  1.30s/it] 11%|█▏        | 53/471 [01:06<09:01,  1.29s/it] 11%|█▏        | 54/471 [01:07<09:01,  1.30s/it] 12%|█▏        | 55/471 [01:08<09:01,  1.30s/it] 12%|█▏        | 56/471 [01:10<09:00,  1.30s/it] 12%|█▏        | 57/471 [01:11<08:58,  1.30s/it] 12%|█▏        | 58/471 [01:12<08:57,  1.30s/it] 13%|█▎        | 59/471 [01:14<08:55,  1.30s/it] 13%|█▎        | 60/471 [01:15<08:54,  1.30s/it] 13%|█▎        | 61/471 [01:16<08:53,  1.30s/it] 13%|█▎        | 62/471 [01:18<08:51,  1.30s/it] 13%|█▎        | 63/471 [01:19<08:50,  1.30s/it] 14%|█▎        | 64/471 [01:20<08:49,  1.30s/it] 14%|█▍        | 65/471 [01:21<08:48,  1.30s/it] 14%|█▍        | 66/471 [01:23<08:47,  1.30s/it] 14%|█▍        | 67/471 [01:24<08:46,  1.30s/it] 14%|█▍        | 68/471 [01:25<08:45,  1.31s/it] 15%|█▍        | 69/471 [01:27<08:45,  1.31s/it] 15%|█▍        | 70/471 [01:28<08:45,  1.31s/it] 15%|█▌        | 71/471 [01:29<08:44,  1.31s/it] 15%|█▌        | 72/471 [01:31<08:43,  1.31s/it] 15%|█▌        | 73/471 [01:32<08:40,  1.31s/it] 16%|█▌        | 74/471 [01:33<08:37,  1.30s/it] 16%|█▌        | 75/471 [01:35<08:37,  1.31s/it] 16%|█▌        | 76/471 [01:36<08:38,  1.31s/it] 16%|█▋        | 77/471 [01:37<08:38,  1.31s/it] 17%|█▋        | 78/471 [01:38<08:35,  1.31s/it] 17%|█▋        | 79/471 [01:40<08:36,  1.32s/it] 17%|█▋        | 80/471 [01:41<08:35,  1.32s/it] 17%|█▋        | 81/471 [01:42<08:32,  1.31s/it] 17%|█▋        | 82/471 [01:44<08:30,  1.31s/it] 18%|█▊        | 83/471 [01:45<08:30,  1.32s/it] 18%|█▊        | 84/471 [01:46<08:31,  1.32s/it] 18%|█▊        | 85/471 [01:48<08:27,  1.31s/it] 18%|█▊        | 86/471 [01:49<08:26,  1.32s/it] 18%|█▊        | 87/471 [01:50<08:23,  1.31s/it] 19%|█▊        | 88/471 [01:52<08:23,  1.31s/it] 19%|█▉        | 89/471 [01:53<08:22,  1.32s/it] 19%|█▉        | 90/471 [01:54<08:23,  1.32s/it] 19%|█▉        | 91/471 [01:56<08:20,  1.32s/it] 20%|█▉        | 92/471 [01:57<08:19,  1.32s/it] 20%|█▉        | 93/471 [01:58<08:18,  1.32s/it] 20%|█▉        | 94/471 [02:00<08:18,  1.32s/it] 20%|██        | 95/471 [02:01<08:16,  1.32s/it] 20%|██        | 96/471 [02:02<08:14,  1.32s/it] 21%|██        | 97/471 [02:04<08:14,  1.32s/it] 21%|██        | 98/471 [02:05<08:13,  1.32s/it] 21%|██        | 99/471 [02:06<08:10,  1.32s/it] 21%|██        | 100/471 [02:07<08:08,  1.32s/it] 21%|██▏       | 101/471 [02:09<08:07,  1.32s/it] 22%|██▏       | 102/471 [02:10<08:06,  1.32s/it] 22%|██▏       | 103/471 [02:11<08:05,  1.32s/it] 22%|██▏       | 104/471 [02:13<08:04,  1.32s/it] 22%|██▏       | 105/471 [02:14<08:04,  1.32s/it] 23%|██▎       | 106/471 [02:15<08:01,  1.32s/it] 23%|██▎       | 107/471 [02:17<08:00,  1.32s/it] 23%|██▎       | 108/471 [02:18<07:58,  1.32s/it] 23%|██▎       | 109/471 [02:19<07:56,  1.32s/it] 23%|██▎       | 110/471 [02:21<07:54,  1.31s/it] 24%|██▎       | 111/471 [02:22<07:54,  1.32s/it] 24%|██▍       | 112/471 [02:23<07:52,  1.32s/it] 24%|██▍       | 113/471 [02:25<07:51,  1.32s/it] 24%|██▍       | 114/471 [02:26<07:50,  1.32s/it] 24%|██▍       | 115/471 [02:27<07:49,  1.32s/it] 25%|██▍       | 116/471 [02:29<07:48,  1.32s/it] 25%|██▍       | 117/471 [02:30<07:46,  1.32s/it] 25%|██▌       | 118/471 [02:31<07:45,  1.32s/it] 25%|██▌       | 119/471 [02:33<07:44,  1.32s/it] 25%|██▌       | 120/471 [02:34<07:43,  1.32s/it] 26%|██▌       | 121/471 [02:35<07:41,  1.32s/it] 26%|██▌       | 122/471 [02:36<07:40,  1.32s/it] 26%|██▌       | 123/471 [02:38<07:39,  1.32s/it] 26%|██▋       | 124/471 [02:39<07:37,  1.32s/it] 27%|██▋       | 125/471 [02:40<07:37,  1.32s/it] 27%|██▋       | 126/471 [02:42<07:35,  1.32s/it] 27%|██▋       | 127/471 [02:43<07:34,  1.32s/it] 27%|██▋       | 128/471 [02:44<07:32,  1.32s/it] 27%|██▋       | 129/471 [02:46<07:30,  1.32s/it] 28%|██▊       | 130/471 [02:47<07:29,  1.32s/it] 28%|██▊       | 131/471 [02:48<07:29,  1.32s/it] 28%|██▊       | 132/471 [02:50<07:27,  1.32s/it] 28%|██▊       | 133/471 [02:51<07:26,  1.32s/it] 28%|██▊       | 134/471 [02:52<07:25,  1.32s/it] 29%|██▊       | 135/471 [02:54<07:23,  1.32s/it] 29%|██▉       | 136/471 [02:55<07:22,  1.32s/it] 29%|██▉       | 137/471 [02:56<07:20,  1.32s/it] 29%|██▉       | 138/471 [02:58<07:18,  1.32s/it] 30%|██▉       | 139/471 [02:59<07:17,  1.32s/it] 30%|██▉       | 140/471 [03:00<07:16,  1.32s/it] 30%|██▉       | 141/471 [03:02<07:14,  1.32s/it] 30%|███       | 142/471 [03:03<07:13,  1.32s/it] 30%|███       | 143/471 [03:04<07:11,  1.32s/it] 31%|███       | 144/471 [03:05<07:10,  1.32s/it] 31%|███       | 145/471 [03:07<07:08,  1.32s/it] 31%|███       | 146/471 [03:08<07:08,  1.32s/it] 31%|███       | 147/471 [03:09<07:07,  1.32s/it] 31%|███▏      | 148/471 [03:11<07:05,  1.32s/it] 32%|███▏      | 149/471 [03:12<07:04,  1.32s/it] 32%|███▏      | 150/471 [03:13<07:03,  1.32s/it] 32%|███▏      | 151/471 [03:15<07:02,  1.32s/it] 32%|███▏      | 152/471 [03:16<07:00,  1.32s/it] 32%|███▏      | 153/471 [03:17<06:59,  1.32s/it] 33%|███▎      | 154/471 [03:19<06:57,  1.32s/it] 33%|███▎      | 155/471 [03:20<06:56,  1.32s/it] 33%|███▎      | 156/471 [03:21<06:55,  1.32s/it] 33%|███▎      | 157/471 [03:23<06:53,  1.32s/it] 34%|███▎      | 158/471 [03:24<06:51,  1.32s/it] 34%|███▍      | 159/471 [03:25<06:50,  1.31s/it] 34%|███▍      | 160/471 [03:27<06:49,  1.32s/it] 34%|███▍      | 161/471 [03:28<06:48,  1.32s/it] 34%|███▍      | 162/471 [03:29<06:47,  1.32s/it] 35%|███▍      | 163/471 [03:31<06:46,  1.32s/it] 35%|███▍      | 164/471 [03:32<06:44,  1.32s/it] 35%|███▌      | 165/471 [03:33<06:43,  1.32s/it] 35%|███▌      | 166/471 [03:34<06:42,  1.32s/it] 35%|███▌      | 167/471 [03:36<06:41,  1.32s/it] 36%|███▌      | 168/471 [03:37<06:39,  1.32s/it] 36%|███▌      | 169/471 [03:38<06:38,  1.32s/it] 36%|███▌      | 170/471 [03:40<06:37,  1.32s/it] 36%|███▋      | 171/471 [03:41<06:36,  1.32s/it] 37%|███▋      | 172/471 [03:42<06:34,  1.32s/it] 37%|███▋      | 173/471 [03:44<06:32,  1.32s/it] 37%|███▋      | 174/471 [03:45<06:31,  1.32s/it] 37%|███▋      | 175/471 [03:46<06:30,  1.32s/it] 37%|███▋      | 176/471 [03:48<06:28,  1.32s/it] 38%|███▊      | 177/471 [03:49<06:27,  1.32s/it] 38%|███▊      | 178/471 [03:50<06:27,  1.32s/it] 38%|███▊      | 179/471 [03:52<06:25,  1.32s/it] 38%|███▊      | 180/471 [03:53<06:25,  1.32s/it] 38%|███▊      | 181/471 [03:54<06:26,  1.33s/it] 39%|███▊      | 182/471 [03:56<06:23,  1.33s/it] 39%|███▉      | 183/471 [03:57<06:21,  1.33s/it] 39%|███▉      | 184/471 [03:58<06:20,  1.33s/it] 39%|███▉      | 185/471 [04:00<06:18,  1.32s/it] 39%|███▉      | 186/471 [04:01<06:16,  1.32s/it] 40%|███▉      | 187/471 [04:02<06:16,  1.32s/it] 40%|███▉      | 188/471 [04:04<06:15,  1.33s/it] 40%|████      | 189/471 [04:05<06:12,  1.32s/it] 40%|████      | 190/471 [04:06<06:11,  1.32s/it] 41%|████      | 191/471 [04:08<06:11,  1.33s/it] 41%|████      | 192/471 [04:09<06:09,  1.32s/it] 41%|████      | 193/471 [04:10<06:07,  1.32s/it] 41%|████      | 194/471 [04:11<06:05,  1.32s/it] 41%|████▏     | 195/471 [04:13<06:05,  1.32s/it] 42%|████▏     | 196/471 [04:14<06:04,  1.33s/it] 42%|████▏     | 197/471 [04:15<06:01,  1.32s/it] 42%|████▏     | 198/471 [04:17<05:59,  1.32s/it] 42%|████▏     | 199/471 [04:18<06:01,  1.33s/it] 42%|████▏     | 200/471 [04:19<06:00,  1.33s/it] 43%|████▎     | 201/471 [04:21<05:57,  1.32s/it] 43%|████▎     | 202/471 [04:22<05:58,  1.33s/it] 43%|████▎     | 203/471 [04:23<05:57,  1.33s/it] 43%|████▎     | 204/471 [04:25<05:55,  1.33s/it] 44%|████▎     | 205/471 [04:26<05:53,  1.33s/it] 44%|████▎     | 206/471 [04:27<05:52,  1.33s/it] 44%|████▍     | 207/471 [04:29<05:51,  1.33s/it] 44%|████▍     | 208/471 [04:30<05:48,  1.32s/it] 44%|████▍     | 209/471 [04:31<05:46,  1.32s/it] 45%|████▍     | 210/471 [04:33<05:45,  1.32s/it] 45%|████▍     | 211/471 [04:34<05:43,  1.32s/it] 45%|████▌     | 212/471 [04:35<05:43,  1.33s/it] 45%|████▌     | 213/471 [04:37<05:42,  1.33s/it] 45%|████▌     | 214/471 [04:38<05:41,  1.33s/it] 46%|████▌     | 215/471 [04:39<05:40,  1.33s/it] 46%|████▌     | 216/471 [04:41<05:40,  1.34s/it] 46%|████▌     | 217/471 [04:42<05:38,  1.33s/it] 46%|████▋     | 218/471 [04:43<05:37,  1.33s/it] 46%|████▋     | 219/471 [04:45<05:36,  1.33s/it] 47%|████▋     | 220/471 [04:46<05:34,  1.33s/it] 47%|████▋     | 221/471 [04:47<05:33,  1.33s/it] 47%|████▋     | 222/471 [04:49<05:30,  1.33s/it] 47%|████▋     | 223/471 [04:50<05:29,  1.33s/it] 48%|████▊     | 224/471 [04:51<05:28,  1.33s/it] 48%|████▊     | 225/471 [04:53<05:27,  1.33s/it] 48%|████▊     | 226/471 [04:54<05:26,  1.33s/it] 48%|████▊     | 227/471 [04:55<05:24,  1.33s/it] 48%|████▊     | 228/471 [04:57<05:23,  1.33s/it] 49%|████▊     | 229/471 [04:58<05:22,  1.33s/it] 49%|████▉     | 230/471 [04:59<05:21,  1.33s/it] 49%|████▉     | 231/471 [05:01<05:19,  1.33s/it] 49%|████▉     | 232/471 [05:02<05:18,  1.33s/it] 49%|████▉     | 233/471 [05:03<05:16,  1.33s/it] 50%|████▉     | 234/471 [05:05<05:16,  1.33s/it] 50%|████▉     | 235/471 [05:06<05:15,  1.34s/it] 50%|█████     | 236/471 [05:07<05:12,  1.33s/it] 50%|█████     | 237/471 [05:09<05:11,  1.33s/it] 51%|█████     | 238/471 [05:10<05:09,  1.33s/it] 51%|█████     | 239/471 [05:11<05:09,  1.33s/it] 51%|█████     | 240/471 [05:13<05:08,  1.33s/it] 51%|█████     | 241/471 [05:14<05:06,  1.33s/it] 51%|█████▏    | 242/471 [05:15<05:06,  1.34s/it] 52%|█████▏    | 243/471 [05:17<05:05,  1.34s/it] 52%|█████▏    | 244/471 [05:18<05:02,  1.33s/it] 52%|█████▏    | 245/471 [05:19<05:01,  1.34s/it] 52%|█████▏    | 246/471 [05:21<04:59,  1.33s/it] 52%|█████▏    | 247/471 [05:22<04:57,  1.33s/it] 53%|█████▎    | 248/471 [05:23<04:57,  1.33s/it] 53%|█████▎    | 249/471 [05:25<04:56,  1.33s/it] 53%|█████▎    | 250/471 [05:26<04:53,  1.33s/it] 53%|█████▎    | 251/471 [05:27<04:52,  1.33s/it] 54%|█████▎    | 252/471 [05:29<04:51,  1.33s/it] 54%|█████▎    | 253/471 [05:30<04:49,  1.33s/it] 54%|█████▍    | 254/471 [05:31<04:50,  1.34s/it] 54%|█████▍    | 255/471 [05:33<04:48,  1.33s/it] 54%|█████▍    | 256/471 [05:34<04:46,  1.33s/it] 55%|█████▍    | 257/471 [05:35<04:45,  1.33s/it] 55%|█████▍    | 258/471 [05:37<04:43,  1.33s/it] 55%|█████▍    | 259/471 [05:38<04:42,  1.33s/it] 55%|█████▌    | 260/471 [05:39<04:41,  1.34s/it] 55%|█████▌    | 261/471 [05:41<04:39,  1.33s/it] 56%|█████▌    | 262/471 [05:42<04:37,  1.33s/it] 56%|█████▌    | 263/471 [05:43<04:36,  1.33s/it] 56%|█████▌    | 264/471 [05:45<04:35,  1.33s/it] 56%|█████▋    | 265/471 [05:46<04:33,  1.33s/it] 56%|█████▋    | 266/471 [05:47<04:32,  1.33s/it] 57%|█████▋    | 267/471 [05:49<04:31,  1.33s/it] 57%|█████▋    | 268/471 [05:50<04:30,  1.33s/it] 57%|█████▋    | 269/471 [05:51<04:29,  1.33s/it] 57%|█████▋    | 270/471 [05:53<04:28,  1.33s/it] 58%|█████▊    | 271/471 [05:54<04:26,  1.33s/it] 58%|█████▊    | 272/471 [05:56<05:03,  1.52s/it] 58%|█████▊    | 273/471 [05:58<05:07,  1.55s/it] 58%|█████▊    | 274/471 [05:59<04:52,  1.48s/it] 58%|█████▊    | 275/471 [06:00<04:41,  1.44s/it] 59%|█████▊    | 276/471 [06:02<04:34,  1.41s/it] 59%|█████▉    | 277/471 [06:03<04:29,  1.39s/it] 59%|█████▉    | 278/471 [06:04<04:24,  1.37s/it] 59%|█████▉    | 279/471 [06:06<04:21,  1.36s/it] 59%|█████▉    | 280/471 [06:07<04:18,  1.35s/it] 60%|█████▉    | 281/471 [06:08<04:15,  1.34s/it] 60%|█████▉    | 282/471 [06:10<04:16,  1.36s/it] 60%|██████    | 283/471 [06:11<04:13,  1.35s/it] 60%|██████    | 284/471 [06:12<04:10,  1.34s/it] 61%|██████    | 285/471 [06:14<04:09,  1.34s/it] 61%|██████    | 286/471 [06:15<04:08,  1.34s/it] 61%|██████    | 287/471 [06:16<04:06,  1.34s/it] 61%|██████    | 288/471 [06:18<04:04,  1.34s/it] 61%|██████▏   | 289/471 [06:19<04:02,  1.33s/it] 62%|██████▏   | 290/471 [06:20<04:01,  1.33s/it] 62%|██████▏   | 291/471 [06:22<03:59,  1.33s/it] 62%|██████▏   | 292/471 [06:23<03:58,  1.33s/it] 62%|██████▏   | 293/471 [06:24<03:57,  1.33s/it] 62%|██████▏   | 294/471 [06:26<03:56,  1.33s/it] 63%|██████▎   | 295/471 [06:27<03:55,  1.34s/it] 63%|██████▎   | 296/471 [06:28<03:53,  1.33s/it] 63%|██████▎   | 297/471 [06:30<03:51,  1.33s/it] 63%|██████▎   | 298/471 [06:31<03:50,  1.33s/it] 63%|██████▎   | 299/471 [06:32<03:49,  1.33s/it] 64%|██████▎   | 300/471 [06:34<03:47,  1.33s/it] 64%|██████▍   | 301/471 [06:35<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:36<03:45,  1.33s/it] 64%|██████▍   | 303/471 [06:38<03:44,  1.33s/it] 65%|██████▍   | 304/471 [06:39<03:42,  1.33s/it] 65%|██████▍   | 305/471 [06:40<03:41,  1.33s/it] 65%|██████▍   | 306/471 [06:42<03:40,  1.33s/it] 65%|██████▌   | 307/471 [06:43<03:38,  1.33s/it] 65%|██████▌   | 308/471 [06:44<03:37,  1.33s/it] 66%|██████▌   | 309/471 [06:46<03:36,  1.34s/it] 66%|██████▌   | 310/471 [06:47<03:34,  1.33s/it] 66%|██████▌   | 311/471 [06:48<03:33,  1.33s/it] 66%|██████▌   | 312/471 [06:50<03:32,  1.33s/it] 66%|██████▋   | 313/471 [06:51<03:30,  1.33s/it] 67%|██████▋   | 314/471 [06:52<03:29,  1.33s/it] 67%|██████▋   | 315/471 [06:54<03:28,  1.33s/it] 67%|██████▋   | 316/471 [06:55<03:27,  1.34s/it] 67%|██████▋   | 317/471 [06:56<03:26,  1.34s/it] 68%|██████▊   | 318/471 [06:58<03:24,  1.34s/it] 68%|██████▊   | 319/471 [06:59<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:00<03:21,  1.34s/it] 68%|██████▊   | 321/471 [07:02<03:20,  1.34s/it] 68%|██████▊   | 322/471 [07:03<03:18,  1.33s/it] 69%|██████▊   | 323/471 [07:04<03:17,  1.34s/it] 69%|██████▉   | 324/471 [07:06<03:16,  1.34s/it] 69%|██████▉   | 325/471 [07:07<03:15,  1.34s/it] 69%|██████▉   | 326/471 [07:08<03:13,  1.33s/it] 69%|██████▉   | 327/471 [07:10<03:12,  1.34s/it] 70%|██████▉   | 328/471 [07:11<03:10,  1.33s/it] 70%|██████▉   | 329/471 [07:12<03:09,  1.33s/it] 70%|███████   | 330/471 [07:14<03:07,  1.33s/it] 70%|███████   | 331/471 [07:15<03:06,  1.33s/it] 70%|███████   | 332/471 [07:16<03:05,  1.33s/it] 71%|███████   | 333/471 [07:18<03:03,  1.33s/it] 71%|███████   | 334/471 [07:19<03:02,  1.33s/it] 71%|███████   | 335/471 [07:20<03:01,  1.33s/it] 71%|███████▏  | 336/471 [07:22<02:59,  1.33s/it] 72%|███████▏  | 337/471 [07:23<02:57,  1.33s/it] 72%|███████▏  | 338/471 [07:24<02:57,  1.33s/it] 72%|███████▏  | 339/471 [07:26<02:55,  1.33s/it] 72%|███████▏  | 340/471 [07:27<02:54,  1.33s/it] 72%|███████▏  | 341/471 [07:28<02:53,  1.33s/it] 73%|███████▎  | 342/471 [07:30<02:52,  1.34s/it] 73%|███████▎  | 343/471 [07:31<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:32<02:48,  1.33s/it] 73%|███████▎  | 345/471 [07:34<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:35<02:46,  1.33s/it] 74%|███████▎  | 347/471 [07:36<02:44,  1.33s/it] 74%|███████▍  | 348/471 [07:38<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:39<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:40<02:40,  1.33s/it] 75%|███████▍  | 351/471 [07:42<02:38,  1.32s/it] 75%|███████▍  | 352/471 [07:43<02:37,  1.33s/it] 75%|███████▍  | 353/471 [07:44<02:36,  1.33s/it] 75%|███████▌  | 354/471 [07:46<02:35,  1.33s/it] 75%|███████▌  | 355/471 [07:47<02:34,  1.33s/it] 76%|███████▌  | 356/471 [07:48<02:32,  1.33s/it] 76%|███████▌  | 357/471 [07:50<02:31,  1.33s/it] 76%|███████▌  | 358/471 [07:51<02:29,  1.33s/it] 76%|███████▌  | 359/471 [07:52<02:28,  1.33s/it] 76%|███████▋  | 360/471 [07:54<02:27,  1.33s/it] 77%|███████▋  | 361/471 [07:55<02:25,  1.33s/it] 77%|███████▋  | 362/471 [07:56<02:24,  1.33s/it] 77%|███████▋  | 363/471 [07:58<02:22,  1.32s/it] 77%|███████▋  | 364/471 [07:59<02:21,  1.32s/it] 77%|███████▋  | 365/471 [08:00<02:20,  1.33s/it] 78%|███████▊  | 366/471 [08:02<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:03<02:18,  1.33s/it] 78%|███████▊  | 368/471 [08:04<02:16,  1.32s/it] 78%|███████▊  | 369/471 [08:05<02:14,  1.32s/it] 79%|███████▊  | 370/471 [08:07<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:08<02:12,  1.33s/it] 79%|███████▉  | 372/471 [08:09<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:11<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:12<02:08,  1.33s/it] 80%|███████▉  | 375/471 [08:13<02:06,  1.32s/it] 80%|███████▉  | 376/471 [08:15<02:05,  1.32s/it] 80%|████████  | 377/471 [08:16<02:04,  1.32s/it] 80%|████████  | 378/471 [08:17<02:02,  1.32s/it] 80%|████████  | 379/471 [08:19<02:01,  1.32s/it] 81%|████████  | 380/471 [08:20<02:00,  1.32s/it] 81%|████████  | 381/471 [08:21<01:58,  1.32s/it] 81%|████████  | 382/471 [08:23<01:57,  1.32s/it] 81%|████████▏ | 383/471 [08:24<01:56,  1.33s/it] 82%|████████▏ | 384/471 [08:25<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:27<01:53,  1.32s/it] 82%|████████▏ | 386/471 [08:28<01:52,  1.32s/it] 82%|████████▏ | 387/471 [08:29<01:51,  1.32s/it] 82%|████████▏ | 388/471 [08:31<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:32<01:48,  1.32s/it] 83%|████████▎ | 390/471 [08:33<01:47,  1.32s/it] 83%|████████▎ | 391/471 [08:35<01:45,  1.32s/it] 83%|████████▎ | 392/471 [08:36<01:44,  1.32s/it] 83%|████████▎ | 393/471 [08:37<01:43,  1.32s/it] 84%|████████▎ | 394/471 [08:39<01:41,  1.32s/it] 84%|████████▍ | 395/471 [08:40<01:40,  1.33s/it] 84%|████████▍ | 396/471 [08:41<01:39,  1.32s/it] 84%|████████▍ | 397/471 [08:43<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:44<01:36,  1.33s/it] 85%|████████▍ | 399/471 [08:45<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:47<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:48<01:32,  1.33s/it] 85%|████████▌ | 402/471 [08:49<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:51<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:52<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:53<01:27,  1.32s/it] 86%|████████▌ | 406/471 [08:54<01:25,  1.32s/it] 86%|████████▋ | 407/471 [08:56<01:24,  1.32s/it] 87%|████████▋ | 408/471 [08:57<01:23,  1.32s/it] 87%|████████▋ | 409/471 [08:58<01:21,  1.32s/it] 87%|████████▋ | 410/471 [09:00<01:20,  1.32s/it] 87%|████████▋ | 411/471 [09:01<01:19,  1.32s/it] 87%|████████▋ | 412/471 [09:02<01:17,  1.32s/it] 88%|████████▊ | 413/471 [09:04<01:16,  1.33s/it] 88%|████████▊ | 414/471 [09:05<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:06<01:14,  1.32s/it] 88%|████████▊ | 416/471 [09:08<01:12,  1.33s/it] 89%|████████▊ | 417/471 [09:09<01:11,  1.32s/it] 89%|████████▊ | 418/471 [09:10<01:10,  1.34s/it] 89%|████████▉ | 419/471 [09:12<01:09,  1.34s/it] 89%|████████▉ | 420/471 [09:13<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:14<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:16<01:04,  1.33s/it] 90%|████████▉ | 423/471 [09:17<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:18<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:20<01:01,  1.33s/it] 90%|█████████ | 426/471 [09:21<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:22<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:24<00:57,  1.34s/it] 91%|█████████ | 429/471 [09:25<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:26<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:28<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:29<00:52,  1.33s/it] 92%|█████████▏| 433/471 [09:30<00:50,  1.34s/it] 92%|█████████▏| 434/471 [09:32<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:33<00:48,  1.34s/it] 93%|█████████▎| 436/471 [09:34<00:46,  1.34s/it] 93%|█████████▎| 437/471 [09:36<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:37<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:38<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:40<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:41<00:40,  1.34s/it] 94%|█████████▍| 442/471 [09:42<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:44<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:45<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:46<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:48<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:49<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:50<00:30,  1.34s/it] 95%|█████████▌| 449/471 [09:52<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:53<00:28,  1.34s/it] 96%|█████████▌| 451/471 [09:54<00:26,  1.34s/it] 96%|█████████▌| 452/471 [09:56<00:25,  1.34s/it] 96%|█████████▌| 453/471 [09:57<00:24,  1.34s/it] 96%|█████████▋| 454/471 [09:58<00:22,  1.34s/it] 97%|█████████▋| 455/471 [10:00<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:01<00:20,  1.34s/it] 97%|█████████▋| 457/471 [10:03<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:04<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:05<00:16,  1.34s/it] 98%|█████████▊| 460/471 [10:07<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:08<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:09<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:11<00:10,  1.33s/it] 99%|█████████▊| 464/471 [10:12<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:13<00:07,  1.33s/it] 99%|█████████▉| 466/471 [10:15<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:16<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:17<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:19<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:20<00:01,  1.33s/it]100%|██████████| 471/471 [10:21<00:00,  1.22s/it]100%|██████████| 471/471 [10:21<00:00,  1.32s/it]
{'eval_loss': 5.173210144042969, 'eval_model_preparation_time': 0.0162, 'eval_acc': 0.17299522039298992, 'eval_runtime': 622.5326, 'eval_samples_per_second': 12.099, 'eval_steps_per_second': 0.757}
ROUND:3
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:29,  2.29s/it]                                              {'loss': 6.6847, 'grad_norm': 4.644562244415283, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:29,  2.29s/it]  5%|▌         | 2/40 [00:04<01:24,  2.21s/it]                                              {'loss': 4.4294, 'grad_norm': 3.5545008182525635, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.21s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 5.2172, 'grad_norm': 5.338367938995361, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 5.3546, 'grad_norm': 13.577794075012207, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 5.2323, 'grad_norm': 4.371243000030518, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it]                                              {'loss': 3.7932, 'grad_norm': 4.456651210784912, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 3.801, 'grad_norm': 4.066766262054443, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.0026, 'grad_norm': 0.052857063710689545, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 2.0393, 'grad_norm': 5.5340046882629395, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 1.7179, 'grad_norm': 3.073362350463867, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 1.914, 'grad_norm': 4.2363433837890625, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 1.9484, 'grad_norm': 4.7966108322143555, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 1.7292, 'grad_norm': 10.379392623901367, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 1.4589, 'grad_norm': 4.754115104675293, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.16s/it]                                               {'loss': 1.6597, 'grad_norm': 6.494133949279785, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0211, 'grad_norm': 0.549272358417511, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.629, 'grad_norm': 5.398167133331299, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.7737, 'grad_norm': 2.912529468536377, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 1.0385, 'grad_norm': 3.3871452808380127, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.7513, 'grad_norm': 19.137311935424805, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.5422, 'grad_norm': 2.725156307220459, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 0.6563, 'grad_norm': 5.446903705596924, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 1.1566, 'grad_norm': 7.563574314117432, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:26,  1.66s/it]                                               {'loss': 0.2045, 'grad_norm': 6.417880058288574, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:26,  1.66s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.85s/it]                                               {'loss': 0.4404, 'grad_norm': 3.693819999694824, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.85s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.97s/it]                                               {'loss': 0.2865, 'grad_norm': 3.257066488265991, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.97s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.06s/it]                                               {'loss': 0.3609, 'grad_norm': 3.5561485290527344, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.06s/it] 70%|███████   | 28/40 [00:56<00:25,  2.12s/it]                                               {'loss': 0.2017, 'grad_norm': 2.212832450866699, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 1.0561, 'grad_norm': 10.042247772216797, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it]                                               {'loss': 0.2081, 'grad_norm': 1.4983443021774292, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it]                                               {'loss': 0.2729, 'grad_norm': 3.5686182975769043, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 1.2617, 'grad_norm': 11.48909854888916, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.5534, 'grad_norm': 10.023351669311523, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.4837, 'grad_norm': 7.135644435882568, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.02s/it]                                               {'loss': 0.2017, 'grad_norm': 2.425501823425293, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.1344, 'grad_norm': 1.6769130229949951, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.4431, 'grad_norm': 8.19946002960205, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.19s/it]                                               {'loss': 0.2503, 'grad_norm': 1.9252278804779053, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.1748, 'grad_norm': 1.8209447860717773, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:19<00:00,  1.68s/it]                                               {'loss': 0.0414, 'grad_norm': 1.509213924407959, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.68s/it]                                               {'train_runtime': 80.2456, 'train_samples_per_second': 7.041, 'train_steps_per_second': 0.498, 'train_loss': 1.4781676023849286, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.68s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 5.5696, 'grad_norm': 8.421493530273438, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 4.0084, 'grad_norm': 3.1457278728485107, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:20,  2.19s/it]                                              {'loss': 5.488, 'grad_norm': 10.846527099609375, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 4.4329, 'grad_norm': 4.518132209777832, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 2.4485, 'grad_norm': 5.4380693435668945, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.57, 'grad_norm': 6.195242404937744, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 3.8, 'grad_norm': 6.905655860900879, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:51,  1.60s/it]                                              {'loss': 3.7969, 'grad_norm': 22.87015724182129, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:51,  1.60s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.79s/it]                                              {'loss': 2.1163, 'grad_norm': 3.266077995300293, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.79s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 2.3076, 'grad_norm': 4.201104164123535, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 2.516, 'grad_norm': 5.896644592285156, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 2.0701, 'grad_norm': 4.815906524658203, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.9395, 'grad_norm': 5.935783386230469, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it]                                               {'loss': 2.1118, 'grad_norm': 3.6367673873901367, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it]                                               {'loss': 0.7843, 'grad_norm': 6.897114276885986, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it] 40%|████      | 16/40 [00:31<00:40,  1.70s/it]                                               {'loss': 1.262, 'grad_norm': 33.78013610839844, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:40,  1.70s/it] 42%|████▎     | 17/40 [00:34<00:43,  1.88s/it]                                               {'loss': 0.9923, 'grad_norm': 7.634833812713623, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:43,  1.88s/it] 45%|████▌     | 18/40 [00:36<00:43,  1.99s/it]                                               {'loss': 1.1503, 'grad_norm': 8.169600486755371, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:43,  1.99s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.07s/it]                                               {'loss': 1.5171, 'grad_norm': 12.007628440856934, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.07s/it] 50%|█████     | 20/40 [00:40<00:43,  2.15s/it]                                               {'loss': 1.0126, 'grad_norm': 5.3498759269714355, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:43,  2.15s/it] 52%|█████▎    | 21/40 [00:43<00:41,  2.19s/it]                                               {'loss': 0.2525, 'grad_norm': 2.915424346923828, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:41,  2.19s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.21s/it]                                               {'loss': 0.8103, 'grad_norm': 4.259876728057861, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.21s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.9508, 'grad_norm': 4.885960102081299, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 0.0012, 'grad_norm': 0.05576684698462486, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:50<00:27,  1.80s/it]                                               {'loss': 0.4166, 'grad_norm': 2.678450584411621, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:27,  1.80s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it]                                               {'loss': 1.2083, 'grad_norm': 8.205211639404297, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.06s/it]                                               {'loss': 0.6812, 'grad_norm': 4.031055927276611, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.06s/it] 70%|███████   | 28/40 [00:57<00:25,  2.13s/it]                                               {'loss': 0.3499, 'grad_norm': 2.2134203910827637, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:57<00:25,  2.13s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it]                                               {'loss': 0.1288, 'grad_norm': 1.418642282485962, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it]                                               {'loss': 0.1653, 'grad_norm': 1.9692145586013794, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.4187, 'grad_norm': 4.935565948486328, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:04<00:13,  1.63s/it]                                               {'loss': 0.0059, 'grad_norm': 0.30014604330062866, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:04<00:13,  1.63s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it]                                               {'loss': 0.4863, 'grad_norm': 1.9705920219421387, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it]                                               {'loss': 0.3903, 'grad_norm': 5.8357462882995605, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it]                                               {'loss': 0.2177, 'grad_norm': 1.2438178062438965, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.13s/it]                                               {'loss': 0.1944, 'grad_norm': 3.189826488494873, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.13s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it]                                               {'loss': 0.0843, 'grad_norm': 1.9264299869537354, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.1947, 'grad_norm': 1.570652723312378, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:20<00:02,  2.23s/it]                                               {'loss': 0.2635, 'grad_norm': 2.699208974838257, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:20<00:02,  2.23s/it]100%|██████████| 40/40 [01:20<00:00,  1.61s/it]                                               {'loss': 0.1404, 'grad_norm': 7.0391845703125, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.61s/it]                                               {'train_runtime': 80.807, 'train_samples_per_second': 6.992, 'train_steps_per_second': 0.495, 'train_loss': 1.5063817158690653, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.61s/it]100%|██████████| 40/40 [01:20<00:00,  2.02s/it]
CLIENT:76
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 5.2729, 'grad_norm': 3.582273006439209, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 5.4794, 'grad_norm': 4.521277904510498, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 5.6125, 'grad_norm': 6.788729667663574, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.1901, 'grad_norm': 3.812039852142334, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 4.0595, 'grad_norm': 5.697490215301514, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 3.9693, 'grad_norm': 5.181157112121582, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 2.9802, 'grad_norm': 6.585390567779541, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 3.4068, 'grad_norm': 37.378231048583984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.8417, 'grad_norm': 8.319109916687012, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 2.0272, 'grad_norm': 7.67989444732666, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.6693, 'grad_norm': 6.492804050445557, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.1493, 'grad_norm': 6.5290093421936035, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.5067, 'grad_norm': 2.296844959259033, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.1644, 'grad_norm': 4.593478202819824, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.4472, 'grad_norm': 5.662372589111328, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:31<00:37,  1.55s/it]                                               {'loss': 1.1063, 'grad_norm': 28.673999786376953, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it]                                               {'loss': 0.5401, 'grad_norm': 3.3601784706115723, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 0.5152, 'grad_norm': 2.905564546585083, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.5937, 'grad_norm': 3.921184539794922, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 0.7657, 'grad_norm': 5.009661674499512, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 1.1786, 'grad_norm': 10.410767555236816, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.7669, 'grad_norm': 6.2042083740234375, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.2876, 'grad_norm': 2.4506008625030518, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.054, 'grad_norm': 2.195676565170288, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.3548, 'grad_norm': 4.361799716949463, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.469, 'grad_norm': 2.803182363510132, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.2404, 'grad_norm': 2.3574411869049072, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.12s/it]                                               {'loss': 0.3377, 'grad_norm': 2.9248642921447754, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.16s/it]                                               {'loss': 0.2585, 'grad_norm': 2.777496576309204, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.3343, 'grad_norm': 3.0325145721435547, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it]                                               {'loss': 0.1385, 'grad_norm': 1.5316134691238403, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it] 80%|████████  | 32/40 [01:02<00:13,  1.67s/it]                                               {'loss': 0.2557, 'grad_norm': 8.432101249694824, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:13,  1.67s/it] 82%|████████▎ | 33/40 [01:05<00:13,  1.87s/it]                                               {'loss': 0.3264, 'grad_norm': 5.284509181976318, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:13,  1.87s/it] 85%|████████▌ | 34/40 [01:07<00:12,  2.02s/it]                                               {'loss': 0.1927, 'grad_norm': 2.4736039638519287, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:12,  2.02s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.10s/it]                                               {'loss': 0.3265, 'grad_norm': 9.396322250366211, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.10s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.15s/it]                                               {'loss': 0.0545, 'grad_norm': 0.5622568130493164, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.15s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.19s/it]                                               {'loss': 0.0697, 'grad_norm': 0.9674098491668701, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.19s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.21s/it]                                               {'loss': 0.3941, 'grad_norm': 3.5263173580169678, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.21s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.1333, 'grad_norm': 1.632978916168213, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0006, 'grad_norm': 0.03231533244252205, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.5342, 'train_samples_per_second': 7.104, 'train_steps_per_second': 0.503, 'train_loss': 1.3367847453948343, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 4.9995, 'grad_norm': 2.2048497200012207, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.4779, 'grad_norm': 3.609312057495117, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 5.105, 'grad_norm': 4.7308125495910645, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.1705, 'grad_norm': 3.7538328170776367, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 3.5125, 'grad_norm': 5.022064208984375, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 3.0437, 'grad_norm': 4.838954925537109, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 3.978, 'grad_norm': 7.603921413421631, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:54,  1.70s/it]                                              {'loss': 1.4559, 'grad_norm': 19.585357666015625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:54,  1.70s/it] 22%|██▎       | 9/40 [00:18<00:58,  1.90s/it]                                              {'loss': 1.5353, 'grad_norm': 4.606866836547852, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:58,  1.90s/it] 25%|██▌       | 10/40 [00:20<01:00,  2.01s/it]                                               {'loss': 2.0438, 'grad_norm': 7.539920330047607, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<01:00,  2.01s/it] 28%|██▊       | 11/40 [00:22<01:00,  2.09s/it]                                               {'loss': 0.8691, 'grad_norm': 2.7865076065063477, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<01:00,  2.09s/it] 30%|███       | 12/40 [00:25<00:59,  2.13s/it]                                               {'loss': 0.9005, 'grad_norm': 3.4556381702423096, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:25<00:59,  2.13s/it] 32%|███▎      | 13/40 [00:27<00:58,  2.18s/it]                                               {'loss': 2.2643, 'grad_norm': 4.438191890716553, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:58,  2.18s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it]                                               {'loss': 1.5662, 'grad_norm': 4.091907978057861, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it]                                               {'loss': 1.2927, 'grad_norm': 3.911951780319214, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it] 40%|████      | 16/40 [00:32<00:39,  1.64s/it]                                               {'loss': 0.016, 'grad_norm': 0.3791431486606598, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:32<00:39,  1.64s/it] 42%|████▎     | 17/40 [00:34<00:41,  1.81s/it]                                               {'loss': 0.6994, 'grad_norm': 3.419113874435425, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:41,  1.81s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.5909, 'grad_norm': 2.6334967613220215, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.3898, 'grad_norm': 1.306167721748352, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:41<00:41,  2.09s/it]                                               {'loss': 1.0458, 'grad_norm': 3.9220125675201416, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:41<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:43<00:40,  2.13s/it]                                               {'loss': 0.6036, 'grad_norm': 5.865793228149414, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.21s/it]                                               {'loss': 0.2685, 'grad_norm': 3.0050771236419678, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.21s/it] 57%|█████▊    | 23/40 [00:47<00:38,  2.26s/it]                                               {'loss': 0.3884, 'grad_norm': 2.116492748260498, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:38,  2.26s/it] 60%|██████    | 24/40 [00:48<00:28,  1.79s/it]                                               {'loss': 0.0093, 'grad_norm': 0.4378589391708374, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:48<00:28,  1.79s/it] 62%|██████▎   | 25/40 [00:51<00:29,  1.96s/it]                                               {'loss': 0.7028, 'grad_norm': 6.189514636993408, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:51<00:29,  1.96s/it] 65%|██████▌   | 26/40 [00:53<00:29,  2.11s/it]                                               {'loss': 0.3828, 'grad_norm': 5.534521579742432, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:53<00:29,  2.11s/it] 68%|██████▊   | 27/40 [00:55<00:28,  2.18s/it]                                               {'loss': 0.0739, 'grad_norm': 0.5796709060668945, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:55<00:28,  2.18s/it] 70%|███████   | 28/40 [00:58<00:27,  2.26s/it]                                               {'loss': 0.1923, 'grad_norm': 1.3620364665985107, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:58<00:27,  2.26s/it] 72%|███████▎  | 29/40 [01:00<00:25,  2.29s/it]                                               {'loss': 0.3457, 'grad_norm': 2.822404384613037, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [01:00<00:25,  2.29s/it] 75%|███████▌  | 30/40 [01:02<00:22,  2.30s/it]                                               {'loss': 0.2549, 'grad_norm': 1.132413387298584, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:02<00:22,  2.30s/it] 78%|███████▊  | 31/40 [01:05<00:20,  2.31s/it]                                               {'loss': 0.1647, 'grad_norm': 1.8190898895263672, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:05<00:20,  2.31s/it] 80%|████████  | 32/40 [01:05<00:14,  1.76s/it]                                               {'loss': 2.9279, 'grad_norm': 80.43478393554688, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:05<00:14,  1.76s/it] 82%|████████▎ | 33/40 [01:08<00:13,  1.94s/it]                                               {'loss': 0.1192, 'grad_norm': 1.1630544662475586, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:08<00:13,  1.94s/it] 85%|████████▌ | 34/40 [01:10<00:12,  2.02s/it]                                               {'loss': 0.3592, 'grad_norm': 4.2074294090271, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:10<00:12,  2.02s/it] 88%|████████▊ | 35/40 [01:12<00:10,  2.11s/it]                                               {'loss': 0.1428, 'grad_norm': 1.7095890045166016, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:12<00:10,  2.11s/it] 90%|█████████ | 36/40 [01:14<00:08,  2.18s/it]                                               {'loss': 0.0565, 'grad_norm': 0.7202193140983582, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:14<00:08,  2.18s/it] 92%|█████████▎| 37/40 [01:17<00:06,  2.22s/it]                                               {'loss': 0.1472, 'grad_norm': 1.2332873344421387, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:17<00:06,  2.22s/it] 95%|█████████▌| 38/40 [01:19<00:04,  2.24s/it]                                               {'loss': 0.1658, 'grad_norm': 1.5204674005508423, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:19<00:04,  2.24s/it] 98%|█████████▊| 39/40 [01:21<00:02,  2.23s/it]                                               {'loss': 0.1553, 'grad_norm': 2.0235605239868164, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:21<00:02,  2.23s/it]100%|██████████| 40/40 [01:22<00:00,  1.65s/it]                                               {'loss': 0.0008, 'grad_norm': 0.01813185028731823, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:22<00:00,  1.65s/it]                                               {'train_runtime': 83.4278, 'train_samples_per_second': 6.772, 'train_steps_per_second': 0.479, 'train_loss': 1.2354635883908487, 'epoch': 5.0}
100%|██████████| 40/40 [01:23<00:00,  1.65s/it]100%|██████████| 40/40 [01:23<00:00,  2.09s/it]
CLIENT:56
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 4.7623, 'grad_norm': 5.319360256195068, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 5.2608, 'grad_norm': 4.554732799530029, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 5.3933, 'grad_norm': 3.757766008377075, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 4.844, 'grad_norm': 3.608363151550293, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.2794, 'grad_norm': 7.190561771392822, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.6175, 'grad_norm': 11.00168514251709, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 2.3959, 'grad_norm': 5.348692417144775, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.3965, 'grad_norm': 8.225801467895508, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.2808, 'grad_norm': 6.725168228149414, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 0.9589, 'grad_norm': 3.9529497623443604, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 1.2701, 'grad_norm': 5.162408828735352, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.8849, 'grad_norm': 3.661806344985962, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it]                                               {'loss': 1.873, 'grad_norm': 9.327442169189453, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.17s/it]                                               {'loss': 1.6854, 'grad_norm': 10.664249420166016, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.1231, 'grad_norm': 5.835788726806641, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0717, 'grad_norm': 1.5117218494415283, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.9151, 'grad_norm': 8.570856094360352, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.9154, 'grad_norm': 5.747085094451904, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.9053, 'grad_norm': 3.8859241008758545, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 1.0438, 'grad_norm': 5.10267972946167, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.3971, 'grad_norm': 3.477919578552246, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.4411, 'grad_norm': 7.9429121017456055, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 1.0687, 'grad_norm': 5.869061470031738, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0003, 'grad_norm': 0.013152024708688259, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it]                                               {'loss': 0.1972, 'grad_norm': 4.4250335693359375, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.438, 'grad_norm': 3.5273168087005615, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.0692, 'grad_norm': 0.882814347743988, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0573, 'grad_norm': 0.7248666286468506, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.295, 'grad_norm': 3.321953296661377, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.1459, 'grad_norm': 2.2807199954986572, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.2806, 'grad_norm': 3.199665069580078, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0865, 'grad_norm': 4.540554046630859, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.82s/it]                                               {'loss': 0.0924, 'grad_norm': 0.6902273297309875, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.82s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.96s/it]                                               {'loss': 0.025, 'grad_norm': 0.6467536687850952, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.1016, 'grad_norm': 1.9205886125564575, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.208, 'grad_norm': 2.4761881828308105, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.1057, 'grad_norm': 1.3539799451828003, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.079, 'grad_norm': 1.1202775239944458, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.2143, 'grad_norm': 5.654404163360596, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0106, 'grad_norm': 0.45357638597488403, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.6052, 'train_samples_per_second': 7.098, 'train_steps_per_second': 0.502, 'train_loss': 1.1547726207783853, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.23s/it]                                              {'loss': 6.3585, 'grad_norm': 5.289226055145264, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.23s/it]  5%|▌         | 2/40 [00:04<01:23,  2.20s/it]                                              {'loss': 5.0457, 'grad_norm': 10.794339179992676, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.20s/it]  8%|▊         | 3/40 [00:06<01:22,  2.22s/it]                                              {'loss': 4.0704, 'grad_norm': 3.515746593475342, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.22s/it] 10%|█         | 4/40 [00:08<01:19,  2.22s/it]                                              {'loss': 4.1121, 'grad_norm': 7.7923970222473145, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it]                                              {'loss': 3.5662, 'grad_norm': 7.485713005065918, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 3.1827, 'grad_norm': 5.3884124755859375, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it]                                              {'loss': 2.1423, 'grad_norm': 5.984002590179443, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it] 20%|██        | 8/40 [00:15<00:52,  1.63s/it]                                              {'loss': 8.0582, 'grad_norm': 21.502538681030273, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:52,  1.63s/it] 22%|██▎       | 9/40 [00:18<00:55,  1.81s/it]                                              {'loss': 1.3405, 'grad_norm': 5.524209022521973, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:55,  1.81s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 2.2691, 'grad_norm': 5.125092029571533, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it]                                               {'loss': 2.2169, 'grad_norm': 4.9956231117248535, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.9796, 'grad_norm': 3.592454671859741, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:27<00:57,  2.14s/it]                                               {'loss': 1.1796, 'grad_norm': 5.277698516845703, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it]                                               {'loss': 1.9697, 'grad_norm': 7.127559185028076, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.8992, 'grad_norm': 3.628248691558838, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 0.2152, 'grad_norm': 7.642496585845947, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 1.0785, 'grad_norm': 3.3658463954925537, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.6497, 'grad_norm': 2.5447683334350586, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 0.1958, 'grad_norm': 1.4773844480514526, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:41,  2.10s/it]                                               {'loss': 0.6761, 'grad_norm': 3.9056289196014404, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.2954, 'grad_norm': 2.790689706802368, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:45<00:38,  2.16s/it]                                               {'loss': 0.1908, 'grad_norm': 1.679361343383789, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it]                                               {'loss': 0.525, 'grad_norm': 4.941189289093018, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.0847, 'grad_norm': 1.7421848773956299, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.2023, 'grad_norm': 1.9750583171844482, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:52<00:26,  1.90s/it]                                               {'loss': 0.3179, 'grad_norm': 2.604435682296753, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.00s/it]                                               {'loss': 0.3202, 'grad_norm': 6.484722137451172, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.00s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0288, 'grad_norm': 0.9797629714012146, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.1219, 'grad_norm': 2.679649829864502, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it]                                               {'loss': 0.2682, 'grad_norm': 3.2024190425872803, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.5588, 'grad_norm': 3.042952060699463, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 1.2344, 'grad_norm': 9.829338073730469, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.1271, 'grad_norm': 0.9527950286865234, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it]                                               {'loss': 0.2042, 'grad_norm': 2.1092607975006104, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.1345, 'grad_norm': 2.0265896320343018, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0545, 'grad_norm': 1.6077370643615723, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it]                                               {'loss': 0.061, 'grad_norm': 0.9342689514160156, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.285, 'grad_norm': 4.607448577880859, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.0317, 'grad_norm': 0.4929390549659729, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.66s/it]                                               {'loss': 0.0317, 'grad_norm': 1.5242738723754883, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.66s/it]                                               {'train_runtime': 80.2656, 'train_samples_per_second': 7.039, 'train_steps_per_second': 0.498, 'train_loss': 1.382102356571704, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.66s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.7748, 'grad_norm': 3.8158204555511475, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]                                              {'loss': 4.5293, 'grad_norm': 3.2318079471588135, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 4.8366, 'grad_norm': 4.630290508270264, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 4.2366, 'grad_norm': 5.295980453491211, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it]                                              {'loss': 4.8249, 'grad_norm': 6.055127143859863, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it]                                              {'loss': 5.1612, 'grad_norm': 10.424507141113281, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it] 18%|█▊        | 7/40 [00:15<01:14,  2.24s/it]                                              {'loss': 2.425, 'grad_norm': 5.9082441329956055, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:14,  2.24s/it] 20%|██        | 8/40 [00:15<00:52,  1.66s/it]                                              {'loss': 1.5431, 'grad_norm': 17.769939422607422, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:52,  1.66s/it] 22%|██▎       | 9/40 [00:18<00:56,  1.84s/it]                                              {'loss': 1.1897, 'grad_norm': 4.709845066070557, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:56,  1.84s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 2.6831, 'grad_norm': 10.684099197387695, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 2.8388, 'grad_norm': 6.486571311950684, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 3.0895, 'grad_norm': 4.744792461395264, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 2.5534, 'grad_norm': 4.667541027069092, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 3.0045, 'grad_norm': 9.815624237060547, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it]                                               {'loss': 1.062, 'grad_norm': 2.8324058055877686, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.2239, 'grad_norm': 7.44444465637207, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.82s/it]                                               {'loss': 1.7176, 'grad_norm': 3.8018198013305664, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.82s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.8374, 'grad_norm': 8.167981147766113, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.06s/it]                                               {'loss': 0.9833, 'grad_norm': 4.250692367553711, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.06s/it] 50%|█████     | 20/40 [00:40<00:42,  2.11s/it]                                               {'loss': 0.9896, 'grad_norm': 7.665841102600098, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.17s/it]                                               {'loss': 1.6722, 'grad_norm': 15.648418426513672, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.17s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it]                                               {'loss': 0.6378, 'grad_norm': 5.7698564529418945, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 1.6673, 'grad_norm': 6.386066436767578, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 1.0335, 'grad_norm': 38.63256072998047, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.4355, 'grad_norm': 6.208847522735596, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:52<00:26,  1.92s/it]                                               {'loss': 0.734, 'grad_norm': 3.565004348754883, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:54<00:25,  1.99s/it]                                               {'loss': 1.0151, 'grad_norm': 3.0087740421295166, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:25,  1.99s/it] 70%|███████   | 28/40 [00:56<00:24,  2.07s/it]                                               {'loss': 0.1715, 'grad_norm': 1.3879237174987793, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.694, 'grad_norm': 4.5758538246154785, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.2946, 'grad_norm': 2.717951536178589, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.18s/it]                                               {'loss': 0.338, 'grad_norm': 2.0962164402008057, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.18s/it] 80%|████████  | 32/40 [01:03<00:12,  1.58s/it]                                               {'loss': 0.1337, 'grad_norm': 4.500053882598877, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.6812, 'grad_norm': 5.92397928237915, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.1803, 'grad_norm': 5.019591808319092, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.2224, 'grad_norm': 1.6420258283615112, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.1424, 'grad_norm': 2.616588592529297, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.1859, 'grad_norm': 1.7145237922668457, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.2238, 'grad_norm': 1.6779721975326538, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.4881, 'grad_norm': 5.244457244873047, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.65s/it]                                               {'loss': 0.1161, 'grad_norm': 4.482587814331055, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.65s/it]                                               {'train_runtime': 80.098, 'train_samples_per_second': 7.054, 'train_steps_per_second': 0.499, 'train_loss': 1.6142983507364987, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.65s/it]100%|██████████| 40/40 [01:20<00:00,  2.00s/it]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 3.9764, 'grad_norm': 6.335862159729004, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 5.2928, 'grad_norm': 6.069272994995117, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 4.5711, 'grad_norm': 5.031116962432861, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 2.1648, 'grad_norm': 4.684289455413818, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 3.6575, 'grad_norm': 5.212701797485352, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 3.2806, 'grad_norm': 6.8653645515441895, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.15s/it]                                              {'loss': 2.9159, 'grad_norm': 7.503904342651367, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.15s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 0.0713, 'grad_norm': 2.8310179710388184, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:52,  1.70s/it]                                              {'loss': 2.824, 'grad_norm': 28.80400848388672, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:52,  1.70s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it]                                               {'loss': 1.8699, 'grad_norm': 13.072494506835938, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 0.7509, 'grad_norm': 6.3701019287109375, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:23<00:56,  2.03s/it]                                               {'loss': 0.5583, 'grad_norm': 2.720573663711548, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.9006, 'grad_norm': 6.469579219818115, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.1226, 'grad_norm': 4.00570011138916, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 1.6857, 'grad_norm': 5.032705307006836, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:30<00:37,  1.57s/it]                                               {'loss': 0.0151, 'grad_norm': 0.2522393763065338, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 1.4482, 'grad_norm': 5.6400980949401855, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.7395, 'grad_norm': 2.7200841903686523, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it]                                               {'loss': 0.8682, 'grad_norm': 3.1392972469329834, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it] 50%|█████     | 20/40 [00:39<00:42,  2.11s/it]                                               {'loss': 0.6485, 'grad_norm': 2.1355395317077637, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.17s/it]                                               {'loss': 0.2934, 'grad_norm': 35.886627197265625, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.17s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.20s/it]                                               {'loss': 0.8963, 'grad_norm': 3.461604595184326, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.20s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it]                                               {'loss': 0.6245, 'grad_norm': 4.099360466003418, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it] 60%|██████    | 24/40 [00:46<00:25,  1.62s/it]                                               {'loss': 0.0106, 'grad_norm': 0.3893893361091614, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.62s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it]                                               {'loss': 0.7486, 'grad_norm': 4.434229373931885, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.3931, 'grad_norm': 2.531989574432373, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.1588, 'grad_norm': 3.2826695442199707, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.1689, 'grad_norm': 1.3859771490097046, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.2951, 'grad_norm': 2.703989267349243, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.3401, 'grad_norm': 3.358285665512085, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.4009, 'grad_norm': 1.9067845344543457, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.004, 'grad_norm': 0.14280012249946594, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0847, 'grad_norm': 0.6977552771568298, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.3174, 'grad_norm': 3.0055007934570312, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0538, 'grad_norm': 0.7426648736000061, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1362, 'grad_norm': 2.0116772651672363, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.2682, 'grad_norm': 1.4802632331848145, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.2138, 'grad_norm': 3.1316654682159424, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.2071, 'grad_norm': 1.6858230829238892, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0114, 'grad_norm': 0.49774494767189026, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.9496, 'train_samples_per_second': 7.156, 'train_steps_per_second': 0.507, 'train_loss': 1.1497109457966872, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:60
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 3.3737, 'grad_norm': 4.39403772354126, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 4.971, 'grad_norm': 4.827556133270264, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 5.1041, 'grad_norm': 6.4581499099731445, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.8685, 'grad_norm': 4.518529891967773, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 4.3612, 'grad_norm': 5.567331790924072, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 4.1876, 'grad_norm': 6.899661540985107, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:10,  2.15s/it]                                              {'loss': 1.8256, 'grad_norm': 6.193478107452393, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:10,  2.15s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 0.3497, 'grad_norm': 13.017030715942383, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.3778, 'grad_norm': 4.738776683807373, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 0.7932, 'grad_norm': 8.298808097839355, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.1508, 'grad_norm': 6.4706549644470215, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.111, 'grad_norm': 9.590700149536133, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 1.1267, 'grad_norm': 3.4339942932128906, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.0852, 'grad_norm': 4.3035078048706055, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.515, 'grad_norm': 11.89112377166748, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.4045, 'grad_norm': 5.540841579437256, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it]                                               {'loss': 1.3332, 'grad_norm': 7.911341190338135, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.7158, 'grad_norm': 3.6573219299316406, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.3059, 'grad_norm': 3.2302963733673096, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.3824, 'grad_norm': 4.509292125701904, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.2519, 'grad_norm': 3.545867681503296, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.2271, 'grad_norm': 5.630029201507568, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.5786, 'grad_norm': 2.3690624237060547, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.56s/it]                                               {'loss': 4.8932, 'grad_norm': 47.870513916015625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.4286, 'grad_norm': 1.7934707403182983, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.1215, 'grad_norm': 3.9046380519866943, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.1034, 'grad_norm': 10.52143383026123, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.51, 'grad_norm': 5.27138614654541, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.0566, 'grad_norm': 1.1181073188781738, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.1177, 'grad_norm': 1.615048885345459, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it]                                               {'loss': 0.1483, 'grad_norm': 1.3959354162216187, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.001, 'grad_norm': 0.0395612008869648, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0158, 'grad_norm': 0.3344288170337677, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0618, 'grad_norm': 1.0389841794967651, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.0261, 'grad_norm': 0.3217427730560303, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1796, 'grad_norm': 6.991774559020996, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0791, 'grad_norm': 2.507173776626587, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.2611, 'grad_norm': 2.52191162109375, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.0745, 'grad_norm': 0.9139223098754883, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.0055, 'grad_norm': 0.1817380040884018, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 78.2729, 'train_samples_per_second': 7.218, 'train_steps_per_second': 0.511, 'train_loss': 1.1871078648066031, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:67
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.11s/it]                                              {'loss': 6.1125, 'grad_norm': 3.8732542991638184, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.11s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 6.0387, 'grad_norm': 4.208911418914795, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 5.5489, 'grad_norm': 4.2475385665893555, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:17,  2.17s/it]                                              {'loss': 4.733, 'grad_norm': 5.72251033782959, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 4.8315, 'grad_norm': 5.736807346343994, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 2.7726, 'grad_norm': 8.698568344116211, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 3.3352, 'grad_norm': 16.33096694946289, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.0154, 'grad_norm': 0.39892786741256714, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 2.759, 'grad_norm': 11.388199806213379, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 2.4792, 'grad_norm': 7.9674224853515625, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 1.3598, 'grad_norm': 10.628647804260254, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.7811, 'grad_norm': 17.86652183532715, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 2.4728, 'grad_norm': 15.147612571716309, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.8348, 'grad_norm': 16.12229347229004, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.9137, 'grad_norm': 26.820079803466797, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 2.3874, 'grad_norm': 31.936786651611328, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 1.2039, 'grad_norm': 12.701910018920898, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 1.3991, 'grad_norm': 9.412975311279297, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 1.237, 'grad_norm': 6.8016157150268555, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 1.3959, 'grad_norm': 11.936910629272461, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.12s/it]                                               {'loss': 1.2739, 'grad_norm': 10.745438575744629, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.7097, 'grad_norm': 4.47918701171875, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 1.7054, 'grad_norm': 6.838425636291504, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0725, 'grad_norm': 4.301708698272705, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.9229, 'grad_norm': 6.6517109870910645, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.5704, 'grad_norm': 4.571061611175537, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.7254, 'grad_norm': 4.935557842254639, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.5196, 'grad_norm': 3.2290685176849365, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.7643, 'grad_norm': 6.154781818389893, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it]                                               {'loss': 0.9074, 'grad_norm': 5.141357421875, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 2.7016, 'grad_norm': 16.55643653869629, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.2005, 'grad_norm': 8.220382690429688, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.6575, 'grad_norm': 8.203137397766113, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 1.1964, 'grad_norm': 4.419741630554199, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 1.0977, 'grad_norm': 13.139052391052246, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.4494, 'grad_norm': 21.34764289855957, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.8663, 'grad_norm': 31.270252227783203, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.3597, 'grad_norm': 2.5341532230377197, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 1.0347, 'grad_norm': 7.754288196563721, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0165, 'grad_norm': 0.4433354437351227, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.5143, 'train_samples_per_second': 7.196, 'train_steps_per_second': 0.509, 'train_loss': 1.8090775766642764, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:54,  1.59it/s]  1%|          | 3/471 [00:02<06:56,  1.12it/s]  1%|          | 4/471 [00:03<08:02,  1.03s/it]  1%|          | 5/471 [00:05<08:39,  1.11s/it]  1%|▏         | 6/471 [00:06<09:01,  1.16s/it]  1%|▏         | 7/471 [00:07<09:17,  1.20s/it]  2%|▏         | 8/471 [00:08<09:26,  1.22s/it]  2%|▏         | 9/471 [00:10<09:32,  1.24s/it]  2%|▏         | 10/471 [00:11<09:36,  1.25s/it]  2%|▏         | 11/471 [00:12<09:38,  1.26s/it]  3%|▎         | 12/471 [00:13<09:40,  1.26s/it]  3%|▎         | 13/471 [00:15<09:42,  1.27s/it]  3%|▎         | 14/471 [00:16<09:42,  1.27s/it]  3%|▎         | 15/471 [00:17<09:42,  1.28s/it]  3%|▎         | 16/471 [00:19<09:42,  1.28s/it]  4%|▎         | 17/471 [00:20<09:41,  1.28s/it]  4%|▍         | 18/471 [00:21<09:41,  1.28s/it]  4%|▍         | 19/471 [00:22<09:40,  1.28s/it]  4%|▍         | 20/471 [00:24<09:40,  1.29s/it]  4%|▍         | 21/471 [00:25<09:39,  1.29s/it]  5%|▍         | 22/471 [00:26<09:38,  1.29s/it]  5%|▍         | 23/471 [00:28<09:37,  1.29s/it]  5%|▌         | 24/471 [00:29<09:38,  1.29s/it]  5%|▌         | 25/471 [00:30<09:35,  1.29s/it]  6%|▌         | 26/471 [00:32<09:35,  1.29s/it]  6%|▌         | 27/471 [00:33<09:33,  1.29s/it]  6%|▌         | 28/471 [00:34<09:32,  1.29s/it]  6%|▌         | 29/471 [00:35<09:32,  1.29s/it]  6%|▋         | 30/471 [00:37<09:31,  1.30s/it]  7%|▋         | 31/471 [00:38<09:30,  1.30s/it]  7%|▋         | 32/471 [00:39<09:28,  1.29s/it]  7%|▋         | 33/471 [00:41<09:25,  1.29s/it]  7%|▋         | 34/471 [00:42<09:25,  1.29s/it]  7%|▋         | 35/471 [00:43<09:24,  1.30s/it]  8%|▊         | 36/471 [00:44<09:23,  1.30s/it]  8%|▊         | 37/471 [00:46<09:23,  1.30s/it]  8%|▊         | 38/471 [00:47<09:22,  1.30s/it]  8%|▊         | 39/471 [00:48<09:20,  1.30s/it]  8%|▊         | 40/471 [00:50<09:19,  1.30s/it]  9%|▊         | 41/471 [00:51<09:18,  1.30s/it]  9%|▉         | 42/471 [00:52<09:18,  1.30s/it]  9%|▉         | 43/471 [00:54<09:16,  1.30s/it]  9%|▉         | 44/471 [00:55<09:16,  1.30s/it] 10%|▉         | 45/471 [00:56<09:14,  1.30s/it] 10%|▉         | 46/471 [00:57<09:13,  1.30s/it] 10%|▉         | 47/471 [00:59<09:12,  1.30s/it] 10%|█         | 48/471 [01:00<09:11,  1.30s/it] 10%|█         | 49/471 [01:01<09:10,  1.31s/it] 11%|█         | 50/471 [01:03<09:10,  1.31s/it] 11%|█         | 51/471 [01:04<09:08,  1.31s/it] 11%|█         | 52/471 [01:05<09:07,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:07,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:05,  1.31s/it] 12%|█▏        | 55/471 [01:09<09:04,  1.31s/it] 12%|█▏        | 56/471 [01:11<09:03,  1.31s/it] 12%|█▏        | 57/471 [01:12<09:02,  1.31s/it] 12%|█▏        | 58/471 [01:13<09:00,  1.31s/it] 13%|█▎        | 59/471 [01:15<09:00,  1.31s/it] 13%|█▎        | 60/471 [01:16<08:58,  1.31s/it] 13%|█▎        | 61/471 [01:17<08:57,  1.31s/it] 13%|█▎        | 62/471 [01:18<08:56,  1.31s/it] 13%|█▎        | 63/471 [01:20<08:54,  1.31s/it] 14%|█▎        | 64/471 [01:21<08:53,  1.31s/it] 14%|█▍        | 65/471 [01:22<08:51,  1.31s/it] 14%|█▍        | 66/471 [01:24<08:50,  1.31s/it] 14%|█▍        | 67/471 [01:25<08:49,  1.31s/it] 14%|█▍        | 68/471 [01:26<08:48,  1.31s/it] 15%|█▍        | 69/471 [01:28<08:46,  1.31s/it] 15%|█▍        | 70/471 [01:29<08:46,  1.31s/it] 15%|█▌        | 71/471 [01:30<08:45,  1.31s/it] 15%|█▌        | 72/471 [01:32<08:43,  1.31s/it] 15%|█▌        | 73/471 [01:33<08:42,  1.31s/it] 16%|█▌        | 74/471 [01:34<08:39,  1.31s/it] 16%|█▌        | 75/471 [01:35<08:39,  1.31s/it] 16%|█▌        | 76/471 [01:37<08:38,  1.31s/it] 16%|█▋        | 77/471 [01:38<08:37,  1.31s/it] 17%|█▋        | 78/471 [01:39<08:35,  1.31s/it] 17%|█▋        | 79/471 [01:41<08:35,  1.32s/it] 17%|█▋        | 80/471 [01:42<08:34,  1.32s/it] 17%|█▋        | 81/471 [01:43<08:33,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:31,  1.31s/it] 18%|█▊        | 83/471 [01:46<08:32,  1.32s/it] 18%|█▊        | 84/471 [01:47<08:29,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:27,  1.32s/it] 18%|█▊        | 86/471 [01:50<08:27,  1.32s/it] 18%|█▊        | 87/471 [01:51<08:25,  1.32s/it] 19%|█▊        | 88/471 [01:53<08:23,  1.31s/it] 19%|█▉        | 89/471 [01:54<08:22,  1.32s/it] 19%|█▉        | 90/471 [01:55<08:22,  1.32s/it] 19%|█▉        | 91/471 [01:57<08:20,  1.32s/it] 20%|█▉        | 92/471 [01:58<08:19,  1.32s/it] 20%|█▉        | 93/471 [01:59<08:18,  1.32s/it] 20%|█▉        | 94/471 [02:01<08:16,  1.32s/it] 20%|██        | 95/471 [02:02<08:15,  1.32s/it] 20%|██        | 96/471 [02:03<08:13,  1.32s/it] 21%|██        | 97/471 [02:04<08:13,  1.32s/it] 21%|██        | 98/471 [02:06<08:11,  1.32s/it] 21%|██        | 99/471 [02:07<08:09,  1.32s/it] 21%|██        | 100/471 [02:08<08:08,  1.32s/it] 21%|██▏       | 101/471 [02:10<08:07,  1.32s/it] 22%|██▏       | 102/471 [02:11<08:06,  1.32s/it] 22%|██▏       | 103/471 [02:12<08:05,  1.32s/it] 22%|██▏       | 104/471 [02:14<08:04,  1.32s/it] 22%|██▏       | 105/471 [02:15<08:04,  1.32s/it] 23%|██▎       | 106/471 [02:16<08:01,  1.32s/it] 23%|██▎       | 107/471 [02:18<08:00,  1.32s/it] 23%|██▎       | 108/471 [02:19<07:58,  1.32s/it] 23%|██▎       | 109/471 [02:20<07:56,  1.32s/it] 23%|██▎       | 110/471 [02:22<07:54,  1.31s/it] 24%|██▎       | 111/471 [02:23<07:54,  1.32s/it] 24%|██▍       | 112/471 [02:24<07:53,  1.32s/it] 24%|██▍       | 113/471 [02:26<07:51,  1.32s/it] 24%|██▍       | 114/471 [02:27<07:50,  1.32s/it] 24%|██▍       | 115/471 [02:28<07:49,  1.32s/it] 25%|██▍       | 116/471 [02:30<07:48,  1.32s/it] 25%|██▍       | 117/471 [02:31<07:47,  1.32s/it] 25%|██▌       | 118/471 [02:32<07:46,  1.32s/it] 25%|██▌       | 119/471 [02:33<07:44,  1.32s/it] 25%|██▌       | 120/471 [02:35<07:44,  1.32s/it] 26%|██▌       | 121/471 [02:36<07:42,  1.32s/it] 26%|██▌       | 122/471 [02:37<07:41,  1.32s/it] 26%|██▌       | 123/471 [02:39<07:40,  1.32s/it] 26%|██▋       | 124/471 [02:40<07:38,  1.32s/it] 27%|██▋       | 125/471 [02:41<07:37,  1.32s/it] 27%|██▋       | 126/471 [02:43<07:36,  1.32s/it] 27%|██▋       | 127/471 [02:44<07:34,  1.32s/it] 27%|██▋       | 128/471 [02:45<07:33,  1.32s/it] 27%|██▋       | 129/471 [02:47<07:31,  1.32s/it] 28%|██▊       | 130/471 [02:48<07:30,  1.32s/it] 28%|██▊       | 131/471 [02:49<07:29,  1.32s/it] 28%|██▊       | 132/471 [02:51<07:27,  1.32s/it] 28%|██▊       | 133/471 [02:52<07:26,  1.32s/it] 28%|██▊       | 134/471 [02:53<07:25,  1.32s/it] 29%|██▊       | 135/471 [02:55<07:24,  1.32s/it] 29%|██▉       | 136/471 [02:56<07:22,  1.32s/it] 29%|██▉       | 137/471 [02:57<07:21,  1.32s/it] 29%|██▉       | 138/471 [02:59<07:19,  1.32s/it] 30%|██▉       | 139/471 [03:00<07:18,  1.32s/it] 30%|██▉       | 140/471 [03:01<07:17,  1.32s/it] 30%|██▉       | 141/471 [03:03<07:15,  1.32s/it] 30%|███       | 142/471 [03:04<07:14,  1.32s/it] 30%|███       | 143/471 [03:05<07:12,  1.32s/it] 31%|███       | 144/471 [03:07<07:11,  1.32s/it] 31%|███       | 145/471 [03:08<07:10,  1.32s/it] 31%|███       | 146/471 [03:09<07:09,  1.32s/it] 31%|███       | 147/471 [03:10<07:08,  1.32s/it] 31%|███▏      | 148/471 [03:12<07:07,  1.32s/it] 32%|███▏      | 149/471 [03:13<07:06,  1.33s/it] 32%|███▏      | 150/471 [03:14<07:05,  1.33s/it] 32%|███▏      | 151/471 [03:16<07:04,  1.33s/it] 32%|███▏      | 152/471 [03:17<07:02,  1.32s/it] 32%|███▏      | 153/471 [03:18<07:01,  1.33s/it] 33%|███▎      | 154/471 [03:20<06:59,  1.32s/it] 33%|███▎      | 155/471 [03:21<06:58,  1.33s/it] 33%|███▎      | 156/471 [03:22<06:57,  1.33s/it] 33%|███▎      | 157/471 [03:24<06:56,  1.33s/it] 34%|███▎      | 158/471 [03:25<06:54,  1.32s/it] 34%|███▍      | 159/471 [03:26<06:52,  1.32s/it] 34%|███▍      | 160/471 [03:28<06:52,  1.33s/it] 34%|███▍      | 161/471 [03:29<06:50,  1.33s/it] 34%|███▍      | 162/471 [03:30<06:49,  1.33s/it] 35%|███▍      | 163/471 [03:32<06:48,  1.33s/it] 35%|███▍      | 164/471 [03:33<06:46,  1.33s/it] 35%|███▌      | 165/471 [03:34<06:45,  1.33s/it] 35%|███▌      | 166/471 [03:36<06:44,  1.33s/it] 35%|███▌      | 167/471 [03:37<06:43,  1.33s/it] 36%|███▌      | 168/471 [03:38<06:41,  1.33s/it] 36%|███▌      | 169/471 [03:40<06:41,  1.33s/it] 36%|███▌      | 170/471 [03:41<06:39,  1.33s/it] 36%|███▋      | 171/471 [03:42<06:38,  1.33s/it] 37%|███▋      | 172/471 [03:44<06:36,  1.33s/it] 37%|███▋      | 173/471 [03:45<06:35,  1.33s/it] 37%|███▋      | 174/471 [03:46<06:33,  1.33s/it] 37%|███▋      | 175/471 [03:48<06:33,  1.33s/it] 37%|███▋      | 176/471 [03:49<06:31,  1.33s/it] 38%|███▊      | 177/471 [03:50<06:29,  1.33s/it] 38%|███▊      | 178/471 [03:52<06:28,  1.33s/it] 38%|███▊      | 179/471 [03:53<06:26,  1.32s/it] 38%|███▊      | 180/471 [03:54<06:25,  1.33s/it] 38%|███▊      | 181/471 [03:56<06:24,  1.33s/it] 39%|███▊      | 182/471 [03:57<06:23,  1.33s/it] 39%|███▉      | 183/471 [03:58<06:22,  1.33s/it] 39%|███▉      | 184/471 [04:00<06:20,  1.32s/it] 39%|███▉      | 185/471 [04:01<06:19,  1.33s/it] 39%|███▉      | 186/471 [04:02<06:18,  1.33s/it] 40%|███▉      | 187/471 [04:04<06:17,  1.33s/it] 40%|███▉      | 188/471 [04:05<06:16,  1.33s/it] 40%|████      | 189/471 [04:06<06:14,  1.33s/it] 40%|████      | 190/471 [04:08<06:13,  1.33s/it] 41%|████      | 191/471 [04:09<06:12,  1.33s/it] 41%|████      | 192/471 [04:10<06:10,  1.33s/it] 41%|████      | 193/471 [04:11<06:08,  1.33s/it] 41%|████      | 194/471 [04:13<06:07,  1.33s/it] 41%|████▏     | 195/471 [04:14<06:06,  1.33s/it] 42%|████▏     | 196/471 [04:15<06:04,  1.33s/it] 42%|████▏     | 197/471 [04:17<06:02,  1.32s/it] 42%|████▏     | 198/471 [04:18<06:01,  1.32s/it] 42%|████▏     | 199/471 [04:19<06:00,  1.33s/it] 42%|████▏     | 200/471 [04:21<05:59,  1.33s/it] 43%|████▎     | 201/471 [04:22<05:57,  1.32s/it] 43%|████▎     | 202/471 [04:23<05:56,  1.33s/it] 43%|████▎     | 203/471 [04:25<05:55,  1.33s/it] 43%|████▎     | 204/471 [04:26<05:54,  1.33s/it] 44%|████▎     | 205/471 [04:27<05:52,  1.33s/it] 44%|████▎     | 206/471 [04:29<05:51,  1.32s/it] 44%|████▍     | 207/471 [04:30<05:50,  1.33s/it] 44%|████▍     | 208/471 [04:31<05:48,  1.33s/it] 44%|████▍     | 209/471 [04:33<05:46,  1.32s/it] 45%|████▍     | 210/471 [04:34<05:45,  1.32s/it] 45%|████▍     | 211/471 [04:35<05:44,  1.33s/it] 45%|████▌     | 212/471 [04:37<05:43,  1.33s/it] 45%|████▌     | 213/471 [04:38<05:42,  1.33s/it] 45%|████▌     | 214/471 [04:39<05:41,  1.33s/it] 46%|████▌     | 215/471 [04:41<05:39,  1.33s/it] 46%|████▌     | 216/471 [04:42<05:39,  1.33s/it] 46%|████▌     | 217/471 [04:43<05:38,  1.33s/it] 46%|████▋     | 218/471 [04:45<05:36,  1.33s/it] 46%|████▋     | 219/471 [04:46<05:35,  1.33s/it] 47%|████▋     | 220/471 [04:47<05:34,  1.33s/it] 47%|████▋     | 221/471 [04:49<05:33,  1.33s/it] 47%|████▋     | 222/471 [04:50<05:30,  1.33s/it] 47%|████▋     | 223/471 [04:51<05:29,  1.33s/it] 48%|████▊     | 224/471 [04:53<05:28,  1.33s/it] 48%|████▊     | 225/471 [04:54<05:26,  1.33s/it] 48%|████▊     | 226/471 [04:55<05:25,  1.33s/it] 48%|████▊     | 227/471 [04:57<05:24,  1.33s/it] 48%|████▊     | 228/471 [04:58<05:23,  1.33s/it] 49%|████▊     | 229/471 [04:59<05:22,  1.33s/it] 49%|████▉     | 230/471 [05:01<05:20,  1.33s/it] 49%|████▉     | 231/471 [05:02<05:19,  1.33s/it] 49%|████▉     | 232/471 [05:03<05:17,  1.33s/it] 49%|████▉     | 233/471 [05:05<05:15,  1.33s/it] 50%|████▉     | 234/471 [05:06<05:14,  1.33s/it] 50%|████▉     | 235/471 [05:07<05:13,  1.33s/it] 50%|█████     | 236/471 [05:09<05:11,  1.33s/it] 50%|█████     | 237/471 [05:10<05:10,  1.33s/it] 51%|█████     | 238/471 [05:11<05:09,  1.33s/it] 51%|█████     | 239/471 [05:13<05:08,  1.33s/it] 51%|█████     | 240/471 [05:14<05:06,  1.33s/it] 51%|█████     | 241/471 [05:15<05:05,  1.33s/it] 51%|█████▏    | 242/471 [05:17<05:03,  1.33s/it] 52%|█████▏    | 243/471 [05:18<05:02,  1.33s/it] 52%|█████▏    | 244/471 [05:19<05:01,  1.33s/it] 52%|█████▏    | 245/471 [05:21<05:00,  1.33s/it] 52%|█████▏    | 246/471 [05:22<04:58,  1.33s/it] 52%|█████▏    | 247/471 [05:23<04:57,  1.33s/it] 53%|█████▎    | 248/471 [05:25<04:55,  1.33s/it] 53%|█████▎    | 249/471 [05:26<04:54,  1.33s/it] 53%|█████▎    | 250/471 [05:27<04:53,  1.33s/it] 53%|█████▎    | 251/471 [05:29<04:52,  1.33s/it] 54%|█████▎    | 252/471 [05:30<04:51,  1.33s/it] 54%|█████▎    | 253/471 [05:31<04:49,  1.33s/it] 54%|█████▍    | 254/471 [05:32<04:48,  1.33s/it] 54%|█████▍    | 255/471 [05:34<04:46,  1.33s/it] 54%|█████▍    | 256/471 [05:35<04:45,  1.33s/it] 55%|█████▍    | 257/471 [05:36<04:44,  1.33s/it] 55%|█████▍    | 258/471 [05:38<04:42,  1.33s/it] 55%|█████▍    | 259/471 [05:39<04:41,  1.33s/it] 55%|█████▌    | 260/471 [05:40<04:40,  1.33s/it] 55%|█████▌    | 261/471 [05:42<04:38,  1.33s/it] 56%|█████▌    | 262/471 [05:43<04:36,  1.32s/it] 56%|█████▌    | 263/471 [05:44<04:35,  1.33s/it] 56%|█████▌    | 264/471 [05:46<04:34,  1.32s/it] 56%|█████▋    | 265/471 [05:47<04:32,  1.33s/it] 56%|█████▋    | 266/471 [05:48<04:31,  1.33s/it] 57%|█████▋    | 267/471 [05:50<04:30,  1.33s/it] 57%|█████▋    | 268/471 [05:51<04:29,  1.33s/it] 57%|█████▋    | 269/471 [05:52<04:27,  1.33s/it] 57%|█████▋    | 270/471 [05:54<04:26,  1.32s/it] 58%|█████▊    | 271/471 [05:55<04:24,  1.32s/it] 58%|█████▊    | 272/471 [05:56<04:23,  1.32s/it] 58%|█████▊    | 273/471 [05:58<04:21,  1.32s/it] 58%|█████▊    | 274/471 [05:59<04:19,  1.32s/it] 58%|█████▊    | 275/471 [06:00<04:18,  1.32s/it] 59%|█████▊    | 276/471 [06:02<04:17,  1.32s/it] 59%|█████▉    | 277/471 [06:03<04:16,  1.32s/it] 59%|█████▉    | 278/471 [06:04<04:15,  1.32s/it] 59%|█████▉    | 279/471 [06:06<04:13,  1.32s/it] 59%|█████▉    | 280/471 [06:07<04:11,  1.32s/it] 60%|█████▉    | 281/471 [06:08<04:10,  1.32s/it] 60%|█████▉    | 282/471 [06:10<04:09,  1.32s/it] 60%|██████    | 283/471 [06:11<04:08,  1.32s/it] 60%|██████    | 284/471 [06:12<04:07,  1.32s/it] 61%|██████    | 285/471 [06:14<04:05,  1.32s/it] 61%|██████    | 286/471 [06:15<04:04,  1.32s/it] 61%|██████    | 287/471 [06:16<04:03,  1.32s/it] 61%|██████    | 288/471 [06:17<04:01,  1.32s/it] 61%|██████▏   | 289/471 [06:19<04:00,  1.32s/it] 62%|██████▏   | 290/471 [06:20<03:58,  1.32s/it] 62%|██████▏   | 291/471 [06:21<03:57,  1.32s/it] 62%|██████▏   | 292/471 [06:23<03:55,  1.32s/it] 62%|██████▏   | 293/471 [06:24<03:54,  1.32s/it] 62%|██████▏   | 294/471 [06:25<03:53,  1.32s/it] 63%|██████▎   | 295/471 [06:27<03:51,  1.32s/it] 63%|██████▎   | 296/471 [06:28<03:50,  1.32s/it] 63%|██████▎   | 297/471 [06:29<03:49,  1.32s/it] 63%|██████▎   | 298/471 [06:31<03:48,  1.32s/it] 63%|██████▎   | 299/471 [06:32<03:47,  1.32s/it] 64%|██████▎   | 300/471 [06:33<03:46,  1.32s/it] 64%|██████▍   | 301/471 [06:35<03:44,  1.32s/it] 64%|██████▍   | 302/471 [06:36<03:43,  1.32s/it] 64%|██████▍   | 303/471 [06:37<03:41,  1.32s/it] 65%|██████▍   | 304/471 [06:39<03:40,  1.32s/it] 65%|██████▍   | 305/471 [06:40<03:39,  1.32s/it] 65%|██████▍   | 306/471 [06:41<03:38,  1.32s/it] 65%|██████▌   | 307/471 [06:43<03:36,  1.32s/it] 65%|██████▌   | 308/471 [06:44<03:35,  1.32s/it] 66%|██████▌   | 309/471 [06:45<03:33,  1.32s/it] 66%|██████▌   | 310/471 [06:47<03:32,  1.32s/it] 66%|██████▌   | 311/471 [06:48<03:31,  1.32s/it] 66%|██████▌   | 312/471 [06:49<03:29,  1.32s/it] 66%|██████▋   | 313/471 [06:50<03:28,  1.32s/it] 67%|██████▋   | 314/471 [06:52<03:26,  1.32s/it] 67%|██████▋   | 315/471 [06:53<03:25,  1.32s/it] 67%|██████▋   | 316/471 [06:54<03:24,  1.32s/it] 67%|██████▋   | 317/471 [06:56<03:22,  1.32s/it] 68%|██████▊   | 318/471 [06:57<03:22,  1.32s/it] 68%|██████▊   | 319/471 [06:58<03:20,  1.32s/it] 68%|██████▊   | 320/471 [07:00<03:19,  1.32s/it] 68%|██████▊   | 321/471 [07:01<03:18,  1.32s/it] 68%|██████▊   | 322/471 [07:02<03:17,  1.32s/it] 69%|██████▊   | 323/471 [07:04<03:16,  1.33s/it] 69%|██████▉   | 324/471 [07:05<03:15,  1.33s/it] 69%|██████▉   | 325/471 [07:06<03:13,  1.33s/it] 69%|██████▉   | 326/471 [07:08<03:11,  1.32s/it] 69%|██████▉   | 327/471 [07:09<03:10,  1.32s/it] 70%|██████▉   | 328/471 [07:10<03:09,  1.32s/it] 70%|██████▉   | 329/471 [07:12<03:07,  1.32s/it] 70%|███████   | 330/471 [07:13<03:06,  1.32s/it] 70%|███████   | 331/471 [07:14<03:05,  1.32s/it] 70%|███████   | 332/471 [07:16<03:03,  1.32s/it] 71%|███████   | 333/471 [07:17<03:02,  1.32s/it] 71%|███████   | 334/471 [07:18<03:01,  1.32s/it] 71%|███████   | 335/471 [07:20<03:00,  1.33s/it] 71%|███████▏  | 336/471 [07:21<02:58,  1.32s/it] 72%|███████▏  | 337/471 [07:22<02:56,  1.32s/it] 72%|███████▏  | 338/471 [07:24<02:55,  1.32s/it] 72%|███████▏  | 339/471 [07:25<02:54,  1.32s/it] 72%|███████▏  | 340/471 [07:26<02:53,  1.32s/it] 72%|███████▏  | 341/471 [07:28<02:51,  1.32s/it] 73%|███████▎  | 342/471 [07:29<02:50,  1.32s/it] 73%|███████▎  | 343/471 [07:30<02:49,  1.32s/it] 73%|███████▎  | 344/471 [07:31<02:47,  1.32s/it] 73%|███████▎  | 345/471 [07:33<02:46,  1.32s/it] 73%|███████▎  | 346/471 [07:34<02:44,  1.32s/it] 74%|███████▎  | 347/471 [07:35<02:43,  1.32s/it] 74%|███████▍  | 348/471 [07:37<02:42,  1.32s/it] 74%|███████▍  | 349/471 [07:38<02:41,  1.32s/it] 74%|███████▍  | 350/471 [07:39<02:39,  1.32s/it] 75%|███████▍  | 351/471 [07:41<02:38,  1.32s/it] 75%|███████▍  | 352/471 [07:42<02:37,  1.32s/it] 75%|███████▍  | 353/471 [07:43<02:36,  1.32s/it] 75%|███████▌  | 354/471 [07:45<02:34,  1.32s/it] 75%|███████▌  | 355/471 [07:46<02:33,  1.32s/it] 76%|███████▌  | 356/471 [07:47<02:32,  1.32s/it] 76%|███████▌  | 357/471 [07:49<02:30,  1.32s/it] 76%|███████▌  | 358/471 [07:50<02:29,  1.32s/it] 76%|███████▌  | 359/471 [07:51<02:28,  1.32s/it] 76%|███████▋  | 360/471 [07:53<02:26,  1.32s/it] 77%|███████▋  | 361/471 [07:54<02:25,  1.32s/it] 77%|███████▋  | 362/471 [07:55<02:24,  1.32s/it] 77%|███████▋  | 363/471 [07:57<02:22,  1.32s/it] 77%|███████▋  | 364/471 [07:58<02:21,  1.32s/it] 77%|███████▋  | 365/471 [07:59<02:20,  1.32s/it] 78%|███████▊  | 366/471 [08:01<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:02<02:17,  1.33s/it] 78%|███████▊  | 368/471 [08:03<02:16,  1.32s/it] 78%|███████▊  | 369/471 [08:05<02:14,  1.32s/it] 79%|███████▊  | 370/471 [08:06<02:13,  1.32s/it] 79%|███████▉  | 371/471 [08:07<02:12,  1.32s/it] 79%|███████▉  | 372/471 [08:08<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:10<02:09,  1.33s/it] 79%|███████▉  | 374/471 [08:11<02:08,  1.32s/it] 80%|███████▉  | 375/471 [08:12<02:07,  1.32s/it] 80%|███████▉  | 376/471 [08:14<02:05,  1.32s/it] 80%|████████  | 377/471 [08:15<02:04,  1.32s/it] 80%|████████  | 378/471 [08:16<02:02,  1.32s/it] 80%|████████  | 379/471 [08:18<02:01,  1.32s/it] 81%|████████  | 380/471 [08:19<02:00,  1.32s/it] 81%|████████  | 381/471 [08:20<01:59,  1.32s/it] 81%|████████  | 382/471 [08:22<01:57,  1.33s/it] 81%|████████▏ | 383/471 [08:23<01:56,  1.33s/it] 82%|████████▏ | 384/471 [08:24<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:26<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:27<01:52,  1.33s/it] 82%|████████▏ | 387/471 [08:28<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:30<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:31<01:48,  1.32s/it] 83%|████████▎ | 390/471 [08:32<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:34<01:45,  1.32s/it] 83%|████████▎ | 392/471 [08:35<01:44,  1.33s/it] 83%|████████▎ | 393/471 [08:36<01:43,  1.32s/it] 84%|████████▎ | 394/471 [08:38<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:39<01:40,  1.33s/it] 84%|████████▍ | 396/471 [08:40<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:42<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:43<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:44<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:46<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:47<01:32,  1.33s/it] 85%|████████▌ | 402/471 [08:48<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:50<01:30,  1.32s/it] 86%|████████▌ | 404/471 [08:51<01:28,  1.32s/it] 86%|████████▌ | 405/471 [08:52<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:54<01:26,  1.33s/it] 86%|████████▋ | 407/471 [08:55<01:24,  1.33s/it] 87%|████████▋ | 408/471 [08:56<01:23,  1.33s/it] 87%|████████▋ | 409/471 [08:58<01:22,  1.33s/it] 87%|████████▋ | 410/471 [08:59<01:20,  1.33s/it] 87%|████████▋ | 411/471 [09:00<01:19,  1.32s/it] 87%|████████▋ | 412/471 [09:02<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:03<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:04<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:06<01:14,  1.32s/it] 88%|████████▊ | 416/471 [09:07<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:08<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:10<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:11<01:08,  1.32s/it] 89%|████████▉ | 420/471 [09:12<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:13<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:15<01:04,  1.32s/it] 90%|████████▉ | 423/471 [09:16<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:17<01:02,  1.32s/it] 90%|█████████ | 425/471 [09:19<01:00,  1.32s/it] 90%|█████████ | 426/471 [09:20<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:21<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:23<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:24<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:25<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:27<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:28<00:52,  1.34s/it] 92%|█████████▏| 433/471 [09:29<00:50,  1.33s/it] 92%|█████████▏| 434/471 [09:31<00:49,  1.33s/it] 92%|█████████▏| 435/471 [09:32<00:48,  1.33s/it] 93%|█████████▎| 436/471 [09:33<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:35<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:36<00:43,  1.33s/it] 93%|█████████▎| 439/471 [09:37<00:42,  1.33s/it] 93%|█████████▎| 440/471 [09:39<00:41,  1.33s/it] 94%|█████████▎| 441/471 [09:40<00:39,  1.33s/it] 94%|█████████▍| 442/471 [09:41<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:43<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:44<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:45<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:47<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:48<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:49<00:30,  1.34s/it] 95%|█████████▌| 449/471 [09:51<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:52<00:28,  1.34s/it] 96%|█████████▌| 451/471 [09:53<00:26,  1.34s/it] 96%|█████████▌| 452/471 [09:55<00:25,  1.34s/it] 96%|█████████▌| 453/471 [09:56<00:24,  1.34s/it] 96%|█████████▋| 454/471 [09:57<00:22,  1.34s/it] 97%|█████████▋| 455/471 [09:59<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:00<00:20,  1.34s/it] 97%|█████████▋| 457/471 [10:01<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:03<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:04<00:16,  1.34s/it] 98%|█████████▊| 460/471 [10:06<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:07<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:08<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:10<00:10,  1.34s/it] 99%|█████████▊| 464/471 [10:11<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:12<00:08,  1.34s/it] 99%|█████████▉| 466/471 [10:14<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:15<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:16<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:18<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:19<00:01,  1.34s/it]100%|██████████| 471/471 [10:20<00:00,  1.23s/it]100%|██████████| 471/471 [10:20<00:00,  1.32s/it]
{'eval_loss': 5.069931983947754, 'eval_model_preparation_time': 0.0112, 'eval_acc': 0.17883696229421137, 'eval_runtime': 621.617, 'eval_samples_per_second': 12.117, 'eval_steps_per_second': 0.758}
ROUND:4
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 3.0409, 'grad_norm': 3.5180418491363525, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 4.7294, 'grad_norm': 4.1353678703308105, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 5.65, 'grad_norm': 6.582724571228027, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 5.0028, 'grad_norm': 4.976102828979492, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 4.5697, 'grad_norm': 15.053374290466309, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 4.5254, 'grad_norm': 9.845218658447266, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 3.1683, 'grad_norm': 5.678948402404785, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.8806, 'grad_norm': 45.21870803833008, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.2771, 'grad_norm': 4.220341682434082, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.5202, 'grad_norm': 4.337071895599365, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it]                                               {'loss': 1.3934, 'grad_norm': 10.581610679626465, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 2.0525, 'grad_norm': 11.724169731140137, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.8186, 'grad_norm': 10.470571517944336, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.7208, 'grad_norm': 7.338736534118652, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.2948, 'grad_norm': 7.724216461181641, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.0596, 'grad_norm': 2.374119520187378, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it]                                               {'loss': 0.9175, 'grad_norm': 141.77532958984375, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.4995, 'grad_norm': 6.211333274841309, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 1.015, 'grad_norm': 26.419496536254883, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.395, 'grad_norm': 5.639654636383057, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.8596, 'grad_norm': 9.646515846252441, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.9951, 'grad_norm': 9.615779876708984, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.5129, 'grad_norm': 8.096968650817871, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 2.5339, 'grad_norm': 124.02012634277344, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.4171, 'grad_norm': 6.705262660980225, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.4722, 'grad_norm': 42.53010940551758, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 1.2975, 'grad_norm': 11.421817779541016, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.6752, 'grad_norm': 5.239058494567871, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.5684, 'grad_norm': 8.372905731201172, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.669, 'grad_norm': 5.8866496086120605, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.5882, 'grad_norm': 10.360401153564453, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.4247, 'grad_norm': 16.850475311279297, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.80s/it]                                               {'loss': 0.6574, 'grad_norm': 3.4511871337890625, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.1919, 'grad_norm': 7.252060890197754, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.7943, 'grad_norm': 14.474782943725586, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 1.0722, 'grad_norm': 59.836875915527344, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.7163, 'grad_norm': 34.96025085449219, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 1.1101, 'grad_norm': 13.636554718017578, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.8885, 'grad_norm': 13.400810241699219, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.16, 'grad_norm': 4.635435581207275, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.7494, 'train_samples_per_second': 7.175, 'train_steps_per_second': 0.508, 'train_loss': 1.65338538242504, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 5.4017, 'grad_norm': 4.992996692657471, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 3.804, 'grad_norm': 6.040021896362305, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 4.1458, 'grad_norm': 4.0841169357299805, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.6953, 'grad_norm': 30.6737060546875, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.3825, 'grad_norm': 5.871294975280762, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.6088, 'grad_norm': 5.137491703033447, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.9659, 'grad_norm': 6.3023247718811035, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 3.3019, 'grad_norm': 25.395605087280273, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it]                                              {'loss': 2.6417, 'grad_norm': 5.511026859283447, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 1.4085, 'grad_norm': 4.148004055023193, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.6958, 'grad_norm': 4.245643615722656, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.5059, 'grad_norm': 2.2831149101257324, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 1.2692, 'grad_norm': 3.960606098175049, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.8671, 'grad_norm': 3.9907751083374023, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 0.9331, 'grad_norm': 6.19088077545166, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 4.1796, 'grad_norm': 24.25391960144043, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.3078, 'grad_norm': 3.8006958961486816, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.3282, 'grad_norm': 2.2016854286193848, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.6983, 'grad_norm': 5.691768646240234, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.5522, 'grad_norm': 3.7315313816070557, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.4921, 'grad_norm': 2.010805606842041, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.5736, 'grad_norm': 3.8140931129455566, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.4334, 'grad_norm': 2.659280300140381, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.2587, 'grad_norm': 8.176434516906738, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.2781, 'grad_norm': 3.1754066944122314, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.4025, 'grad_norm': 4.836380481719971, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0866, 'grad_norm': 0.5783527493476868, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.3601, 'grad_norm': 1.9786778688430786, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1727, 'grad_norm': 1.852307677268982, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.2162, 'grad_norm': 1.728083610534668, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.2827, 'grad_norm': 1.6911605596542358, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0, 'grad_norm': 0.00010053138976218179, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.2554, 'grad_norm': 1.8453909158706665, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.067, 'grad_norm': 0.6517440676689148, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.218, 'grad_norm': 1.1336138248443604, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0401, 'grad_norm': 0.37934860587120056, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0292, 'grad_norm': 0.31420403718948364, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.0309, 'grad_norm': 0.4787537157535553, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.1007, 'grad_norm': 1.1476715803146362, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0231, 'grad_norm': 1.1913172006607056, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.873, 'train_samples_per_second': 7.163, 'train_steps_per_second': 0.507, 'train_loss': 1.200357599370085, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 4.7102, 'grad_norm': 4.282870769500732, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.9402, 'grad_norm': 4.2104902267456055, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.19s/it]                                              {'loss': 4.8822, 'grad_norm': 5.591556549072266, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 3.6946, 'grad_norm': 7.452023029327393, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it]                                              {'loss': 4.3333, 'grad_norm': 8.077713966369629, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 4.0902, 'grad_norm': 5.913398265838623, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 3.7293, 'grad_norm': 9.193440437316895, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 8.1937, 'grad_norm': 17.69713592529297, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 2.3842, 'grad_norm': 7.528677463531494, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.9797, 'grad_norm': 5.707367897033691, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.3679, 'grad_norm': 4.310178756713867, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.1181, 'grad_norm': 7.491255760192871, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 1.0591, 'grad_norm': 10.723235130310059, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it]                                               {'loss': 1.7078, 'grad_norm': 14.340044021606445, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.4189, 'grad_norm': 5.490458011627197, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0888, 'grad_norm': 2.6154634952545166, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 1.1722, 'grad_norm': 5.63065767288208, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 1.2722, 'grad_norm': 9.954194068908691, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.392, 'grad_norm': 2.4809036254882812, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.10s/it]                                               {'loss': 0.6678, 'grad_norm': 3.6593518257141113, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.4777, 'grad_norm': 3.412958860397339, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.8283, 'grad_norm': 4.196584701538086, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.6123, 'grad_norm': 3.5516178607940674, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.0996, 'grad_norm': 2.613142490386963, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.5003, 'grad_norm': 3.078913688659668, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.5272, 'grad_norm': 2.631085157394409, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.4393, 'grad_norm': 2.434622049331665, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.4066, 'grad_norm': 4.316854953765869, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.0908, 'grad_norm': 1.7632306814193726, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.48, 'grad_norm': 4.400028705596924, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.333, 'grad_norm': 5.100400924682617, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0423, 'grad_norm': 1.7975353002548218, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.2594, 'grad_norm': 1.6995394229888916, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.1261, 'grad_norm': 1.5770026445388794, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.1565, 'grad_norm': 4.498833656311035, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.1842, 'grad_norm': 2.8262782096862793, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.18s/it]                                               {'loss': 0.1936, 'grad_norm': 2.5032308101654053, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.18s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.22s/it]                                               {'loss': 0.2637, 'grad_norm': 1.8804523944854736, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.22s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.598, 'grad_norm': 5.340634346008301, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:19<00:00,  1.66s/it]                                               {'loss': 0.2734, 'grad_norm': 7.969816207885742, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.66s/it]                                               {'train_runtime': 79.7907, 'train_samples_per_second': 7.081, 'train_steps_per_second': 0.501, 'train_loss': 1.4523587547242642, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.66s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.1671, 'grad_norm': 3.9948477745056152, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 3.8501, 'grad_norm': 7.7905802726745605, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 4.8721, 'grad_norm': 5.027095794677734, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 3.8326, 'grad_norm': 10.641334533691406, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 3.2028, 'grad_norm': 7.128726005554199, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.14s/it]                                              {'loss': 2.565, 'grad_norm': 7.2895731925964355, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.14s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.13s/it]                                              {'loss': 3.1863, 'grad_norm': 12.289875984191895, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.13s/it] 20%|██        | 8/40 [00:15<00:48,  1.51s/it]                                              {'loss': 7.2999, 'grad_norm': 34.2016487121582, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.51s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.5514, 'grad_norm': 9.062811851501465, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.84s/it]                                               {'loss': 1.5909, 'grad_norm': 6.867138862609863, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.84s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it]                                               {'loss': 1.8608, 'grad_norm': 6.2928643226623535, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it] 30%|███       | 12/40 [00:23<00:55,  1.99s/it]                                               {'loss': 2.4728, 'grad_norm': 4.954928874969482, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:55,  1.99s/it] 32%|███▎      | 13/40 [00:25<00:55,  2.05s/it]                                               {'loss': 1.3904, 'grad_norm': 5.643788814544678, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:25<00:55,  2.05s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 1.5066, 'grad_norm': 3.8016200065612793, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it]                                               {'loss': 1.0075, 'grad_norm': 10.940705299377441, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 5.555, 'grad_norm': 30.901885986328125, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it]                                               {'loss': 0.6399, 'grad_norm': 2.333151340484619, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it]                                               {'loss': 0.3482, 'grad_norm': 2.942326307296753, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.3578, 'grad_norm': 4.387897968292236, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 1.0049, 'grad_norm': 9.336725234985352, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.12s/it]                                               {'loss': 0.3203, 'grad_norm': 3.8825674057006836, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.14s/it]                                               {'loss': 1.0615, 'grad_norm': 5.208709239959717, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.16s/it]                                               {'loss': 0.4654, 'grad_norm': 3.8031694889068604, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.56s/it]                                               {'loss': 0.0023, 'grad_norm': 0.08095734566450119, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.477, 'grad_norm': 2.0281012058258057, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.7215, 'grad_norm': 4.332139015197754, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it]                                               {'loss': 0.206, 'grad_norm': 2.0766186714172363, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it] 70%|███████   | 28/40 [00:54<00:24,  2.05s/it]                                               {'loss': 0.0899, 'grad_norm': 1.3914602994918823, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:22,  2.09s/it]                                               {'loss': 0.4233, 'grad_norm': 1.8727033138275146, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:22,  2.09s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it]                                               {'loss': 0.2706, 'grad_norm': 2.150479555130005, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it]                                               {'loss': 0.3889, 'grad_norm': 8.376954078674316, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.1441, 'grad_norm': 4.1396589279174805, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.76s/it]                                               {'loss': 0.0756, 'grad_norm': 3.689816951751709, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.1684, 'grad_norm': 2.486191987991333, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it]                                               {'loss': 0.3008, 'grad_norm': 4.094160556793213, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.05s/it]                                               {'loss': 0.6839, 'grad_norm': 2.632079601287842, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.05s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.09s/it]                                               {'loss': 0.2095, 'grad_norm': 4.206355094909668, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.09s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.13s/it]                                               {'loss': 0.3928, 'grad_norm': 5.934438228607178, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.13s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.0798, 'grad_norm': 1.1308823823928833, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.0143, 'grad_norm': 0.47736528515815735, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 77.8357, 'train_samples_per_second': 7.259, 'train_steps_per_second': 0.514, 'train_loss': 1.4689477451785933, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]100%|██████████| 40/40 [01:17<00:00,  1.95s/it]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.09s/it]                                              {'loss': 5.1491, 'grad_norm': 3.5178213119506836, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.09s/it]  5%|▌         | 2/40 [00:04<01:19,  2.09s/it]                                              {'loss': 4.2554, 'grad_norm': 32.84623336791992, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:19,  2.09s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 4.1018, 'grad_norm': 5.020753383636475, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:16,  2.13s/it]                                              {'loss': 3.3318, 'grad_norm': 6.607505798339844, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.13s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 2.9459, 'grad_norm': 6.007301330566406, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 3.9125, 'grad_norm': 8.736489295959473, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 4.7107, 'grad_norm': 14.015661239624023, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 7.7895, 'grad_norm': 15.649435043334961, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 2.2847, 'grad_norm': 6.519591331481934, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 3.2606, 'grad_norm': 4.735135078430176, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.3017, 'grad_norm': 5.387346267700195, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 1.8618, 'grad_norm': 4.038942337036133, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 1.0104, 'grad_norm': 4.536070823669434, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.9552, 'grad_norm': 6.308760166168213, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 1.8089, 'grad_norm': 21.5281982421875, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 0.2136, 'grad_norm': 5.575569152832031, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it]                                               {'loss': 1.2737, 'grad_norm': 13.581989288330078, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it]                                               {'loss': 0.9871, 'grad_norm': 6.663955211639404, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.9868, 'grad_norm': 6.011873722076416, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.7264, 'grad_norm': 6.293917179107666, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.655, 'grad_norm': 5.034938812255859, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.785, 'grad_norm': 4.361973762512207, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it]                                               {'loss': 0.9593, 'grad_norm': 8.713492393493652, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 0.0615, 'grad_norm': 1.082022786140442, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.8559, 'grad_norm': 6.077552318572998, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.6327, 'grad_norm': 10.589661598205566, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:52<00:26,  2.01s/it]                                               {'loss': 0.7089, 'grad_norm': 16.01787757873535, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.5361, 'grad_norm': 3.623974323272705, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.1703, 'grad_norm': 1.884953498840332, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.20s/it]                                               {'loss': 0.5164, 'grad_norm': 4.495467185974121, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.20s/it] 78%|███████▊  | 31/40 [01:02<00:20,  2.24s/it]                                               {'loss': 0.7059, 'grad_norm': 4.750970840454102, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:20,  2.24s/it] 80%|████████  | 32/40 [01:02<00:14,  1.82s/it]                                               {'loss': 0.0605, 'grad_norm': 2.7394444942474365, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:14,  1.82s/it] 82%|████████▎ | 33/40 [01:05<00:14,  2.00s/it]                                               {'loss': 0.0814, 'grad_norm': 1.7725927829742432, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:14,  2.00s/it] 85%|████████▌ | 34/40 [01:07<00:12,  2.08s/it]                                               {'loss': 0.7782, 'grad_norm': 8.97081184387207, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:12,  2.08s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.13s/it]                                               {'loss': 0.6879, 'grad_norm': 14.959606170654297, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.13s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.15s/it]                                               {'loss': 0.2254, 'grad_norm': 3.187558650970459, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.15s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.2721, 'grad_norm': 1.5948681831359863, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.5663, 'grad_norm': 3.4931387901306152, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0421, 'grad_norm': 1.124851107597351, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0242, 'grad_norm': 0.9762550592422485, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.575, 'train_samples_per_second': 7.1, 'train_steps_per_second': 0.503, 'train_loss': 1.55481151426211, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.9013, 'grad_norm': 2.430803060531616, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 3.2695, 'grad_norm': 4.08336877822876, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:18,  2.12s/it]                                              {'loss': 4.8052, 'grad_norm': 5.391204833984375, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.12s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 2.9364, 'grad_norm': 4.466423034667969, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it]                                              {'loss': 3.042, 'grad_norm': 6.786741733551025, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.14s/it]                                              {'loss': 3.1745, 'grad_norm': 7.13435173034668, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.14s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 3.5145, 'grad_norm': 10.023210525512695, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 1.551, 'grad_norm': 24.789409637451172, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.2696, 'grad_norm': 4.425273895263672, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.72, 'grad_norm': 5.112226963043213, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it]                                               {'loss': 1.0369, 'grad_norm': 4.128620147705078, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it] 30%|███       | 12/40 [00:23<00:56,  2.01s/it]                                               {'loss': 0.7899, 'grad_norm': 3.5211853981018066, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.01s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 1.9223, 'grad_norm': 4.990603923797607, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it]                                               {'loss': 1.3253, 'grad_norm': 4.304290771484375, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it]                                               {'loss': 1.1418, 'grad_norm': 3.9210519790649414, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0359, 'grad_norm': 0.9058669209480286, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it]                                               {'loss': 0.6179, 'grad_norm': 3.5861899852752686, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it]                                               {'loss': 0.456, 'grad_norm': 3.8388924598693848, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.3386, 'grad_norm': 1.2143027782440186, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.8496, 'grad_norm': 4.435375213623047, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.5009, 'grad_norm': 2.910290241241455, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.1195, 'grad_norm': 1.17043936252594, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it]                                               {'loss': 0.2801, 'grad_norm': 2.6676461696624756, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.003, 'grad_norm': 0.17004089057445526, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.4574, 'grad_norm': 6.184013366699219, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.1992, 'grad_norm': 1.6525875329971313, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it]                                               {'loss': 0.0906, 'grad_norm': 2.444892644882202, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it] 70%|███████   | 28/40 [00:54<00:24,  2.06s/it]                                               {'loss': 0.2477, 'grad_norm': 3.074252128601074, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.2122, 'grad_norm': 1.9025954008102417, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.266, 'grad_norm': 0.9734654426574707, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it]                                               {'loss': 0.3161, 'grad_norm': 2.1011462211608887, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 3.1245, 'grad_norm': 27.57649803161621, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.2405, 'grad_norm': 2.522672414779663, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.89s/it]                                               {'loss': 0.4504, 'grad_norm': 9.902070999145508, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.89s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it]                                               {'loss': 0.1864, 'grad_norm': 2.656344175338745, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.08s/it]                                               {'loss': 0.0442, 'grad_norm': 0.6620084047317505, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.13s/it]                                               {'loss': 0.1342, 'grad_norm': 2.4469802379608154, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.1345, 'grad_norm': 2.197556257247925, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.1848, 'grad_norm': 2.621936559677124, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:17<00:00,  1.59s/it]                                               {'loss': 0.0189, 'grad_norm': 0.6252678632736206, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.59s/it]                                               {'train_runtime': 78.112, 'train_samples_per_second': 7.233, 'train_steps_per_second': 0.512, 'train_loss': 1.1477297371078747, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.95s/it]
CLIENT:19
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 4.0239, 'grad_norm': 3.760516881942749, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 5.2132, 'grad_norm': 5.431909561157227, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 5.1189, 'grad_norm': 3.658496856689453, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 4.8807, 'grad_norm': 4.89091682434082, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.6264, 'grad_norm': 4.337034225463867, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.1483, 'grad_norm': 5.157728672027588, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 4.8321, 'grad_norm': 6.860960960388184, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 8.285, 'grad_norm': 69.6541748046875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 1.9892, 'grad_norm': 7.502267837524414, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.8976, 'grad_norm': 5.261219024658203, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 2.7545, 'grad_norm': 4.470583438873291, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 2.1475, 'grad_norm': 4.8570685386657715, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.8992, 'grad_norm': 3.064650774002075, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.454, 'grad_norm': 3.8743205070495605, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 3.5751, 'grad_norm': 6.178017616271973, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 1.7047, 'grad_norm': 19.48038101196289, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.9029, 'grad_norm': 3.7079367637634277, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.6384, 'grad_norm': 2.3082735538482666, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.6219, 'grad_norm': 2.7460601329803467, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.7272, 'grad_norm': 3.5140724182128906, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.4692, 'grad_norm': 4.213695526123047, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 1.4194, 'grad_norm': 9.68143367767334, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.8479, 'grad_norm': 5.779311180114746, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0061, 'grad_norm': 0.3555948734283447, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.1651, 'grad_norm': 0.8768338561058044, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.2318, 'grad_norm': 1.560208797454834, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.1033, 'grad_norm': 1.2257248163223267, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.5505, 'grad_norm': 3.7450926303863525, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.7694, 'grad_norm': 3.022948980331421, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.4317, 'grad_norm': 3.9457364082336426, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.5429, 'grad_norm': 3.964776039123535, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.1091, 'grad_norm': 2.0732076168060303, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.3589, 'grad_norm': 6.339954376220703, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.3947, 'grad_norm': 7.473902225494385, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0741, 'grad_norm': 1.0298477411270142, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.6076, 'grad_norm': 2.1473777294158936, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.4656, 'grad_norm': 2.414578437805176, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.1401, 'grad_norm': 1.6042883396148682, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.1047, 'grad_norm': 1.624904751777649, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.4955, 'grad_norm': 29.84607696533203, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.788, 'train_samples_per_second': 7.171, 'train_steps_per_second': 0.508, 'train_loss': 1.6682085067150183, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 5.3739, 'grad_norm': 4.047269821166992, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 3.2296, 'grad_norm': 3.5826025009155273, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 3.803, 'grad_norm': 4.138564109802246, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 2.504, 'grad_norm': 3.7527050971984863, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 3.1689, 'grad_norm': 6.018408298492432, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 3.8587, 'grad_norm': 6.689064025878906, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 3.8716, 'grad_norm': 6.558160781860352, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 4.8948, 'grad_norm': 48.55001449584961, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.8459, 'grad_norm': 3.270484447479248, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.5935, 'grad_norm': 5.74538516998291, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 0.9867, 'grad_norm': 6.705922603607178, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.3074, 'grad_norm': 9.600419044494629, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 1.5037, 'grad_norm': 6.481064796447754, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.12s/it]                                               {'loss': 0.8788, 'grad_norm': 4.466838836669922, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.7577, 'grad_norm': 5.980800628662109, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 3.3279, 'grad_norm': 15.291929244995117, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it]                                               {'loss': 0.3995, 'grad_norm': 2.6180996894836426, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.3063, 'grad_norm': 2.243675947189331, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.8479, 'grad_norm': 9.962592124938965, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.6828, 'grad_norm': 10.051112174987793, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.7448, 'grad_norm': 8.48351764678955, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.8732, 'grad_norm': 3.782352924346924, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.3212, 'grad_norm': 1.6542414426803589, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0926, 'grad_norm': 5.459595203399658, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.3768, 'grad_norm': 2.6322057247161865, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.4741, 'grad_norm': 1.8081550598144531, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0981, 'grad_norm': 1.4005019664764404, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.3324, 'grad_norm': 1.8383684158325195, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.205, 'grad_norm': 1.235783338546753, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it]                                               {'loss': 0.175, 'grad_norm': 1.5874680280685425, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1219, 'grad_norm': 1.9983103275299072, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0071, 'grad_norm': 0.7475449442863464, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.2036, 'grad_norm': 2.398430347442627, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.1409, 'grad_norm': 1.5867466926574707, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0831, 'grad_norm': 0.9943138360977173, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.3486, 'grad_norm': 5.7444868087768555, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.1629, 'grad_norm': 4.269708633422852, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.7787, 'grad_norm': 8.304573059082031, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.2122, 'grad_norm': 2.118752956390381, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0414, 'grad_norm': 2.0453379154205322, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.4471, 'train_samples_per_second': 7.202, 'train_steps_per_second': 0.51, 'train_loss': 1.2483952259644866, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:94
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.952, 'grad_norm': 5.788736820220947, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 4.1688, 'grad_norm': 5.639291286468506, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 3.961, 'grad_norm': 4.365350246429443, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 4.0965, 'grad_norm': 5.46961784362793, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 5.6673, 'grad_norm': 10.775789260864258, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.2796, 'grad_norm': 8.225849151611328, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 3.5301, 'grad_norm': 11.682466506958008, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.8818, 'grad_norm': 15.785761833190918, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 2.2822, 'grad_norm': 7.127303123474121, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.7541, 'grad_norm': 9.103374481201172, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.8518, 'grad_norm': 5.418116569519043, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 2.5042, 'grad_norm': 5.8294148445129395, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 1.4304, 'grad_norm': 4.166724681854248, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.368, 'grad_norm': 6.214361190795898, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.5277, 'grad_norm': 4.9350175857543945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 4.8583, 'grad_norm': 62.357059478759766, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.8496, 'grad_norm': 4.568502426147461, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.5589, 'grad_norm': 3.7687861919403076, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.7976, 'grad_norm': 3.209582805633545, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.4572, 'grad_norm': 2.2338385581970215, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.8971, 'grad_norm': 3.176283359527588, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.4777, 'grad_norm': 2.8723952770233154, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.4417, 'grad_norm': 1.978531002998352, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 1.6573, 'grad_norm': 18.63729476928711, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.6736, 'grad_norm': 3.6817028522491455, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.4734, 'grad_norm': 2.8199026584625244, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.1524, 'grad_norm': 2.3620190620422363, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.5566, 'grad_norm': 4.690680027008057, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.5769, 'grad_norm': 8.4785795211792, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.6695, 'grad_norm': 2.4706428050994873, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1481, 'grad_norm': 1.1695908308029175, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 4.0106, 'grad_norm': 296.50823974609375, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0992, 'grad_norm': 1.0573662519454956, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.1247, 'grad_norm': 0.8618746399879456, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it]                                               {'loss': 0.1068, 'grad_norm': 1.073743462562561, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.2795, 'grad_norm': 1.311710000038147, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.3498, 'grad_norm': 1.4042339324951172, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1239, 'grad_norm': 3.01090931892395, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.1616, 'grad_norm': 1.4746465682983398, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.3596, 'grad_norm': 4.849742889404297, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.9017, 'train_samples_per_second': 7.161, 'train_steps_per_second': 0.507, 'train_loss': 1.5779229303821922, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:25
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 4.5323, 'grad_norm': 4.958126544952393, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 5.1016, 'grad_norm': 7.474628448486328, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.3137, 'grad_norm': 3.4896292686462402, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 5.5122, 'grad_norm': 5.835609436035156, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 4.7616, 'grad_norm': 5.1924238204956055, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.0395, 'grad_norm': 9.79610538482666, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 3.378, 'grad_norm': 7.722476959228516, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.276, 'grad_norm': 17.029741287231445, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.5293, 'grad_norm': 8.928434371948242, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.655, 'grad_norm': 5.940674781799316, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 1.8158, 'grad_norm': 7.938814163208008, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.9733, 'grad_norm': 8.803659439086914, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.7065, 'grad_norm': 6.371064186096191, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.4294, 'grad_norm': 6.629753112792969, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.5685, 'grad_norm': 7.644383430480957, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:31<00:37,  1.55s/it]                                               {'loss': 2.1937, 'grad_norm': 14.75346851348877, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.441, 'grad_norm': 7.983773708343506, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.8735, 'grad_norm': 3.2549190521240234, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.5539, 'grad_norm': 4.599949836730957, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.3901, 'grad_norm': 2.326002359390259, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.7065, 'grad_norm': 4.837855339050293, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.443, 'grad_norm': 5.329647064208984, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.4181, 'grad_norm': 3.590174436569214, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.2435, 'grad_norm': 6.222768783569336, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it]                                               {'loss': 0.1509, 'grad_norm': 2.4892616271972656, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.1795, 'grad_norm': 1.5521225929260254, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.1196, 'grad_norm': 1.1731512546539307, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.197, 'grad_norm': 1.8677194118499756, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.1005, 'grad_norm': 1.534075379371643, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.1231, 'grad_norm': 1.0882648229599, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1198, 'grad_norm': 1.5862078666687012, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 1.8558, 'grad_norm': 34.65860366821289, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0555, 'grad_norm': 0.6674401760101318, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0681, 'grad_norm': 1.1038386821746826, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0377, 'grad_norm': 0.6626986861228943, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0555, 'grad_norm': 1.8858791589736938, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0714, 'grad_norm': 1.8116393089294434, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.0474, 'grad_norm': 1.2316266298294067, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0175, 'grad_norm': 0.21761947870254517, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0212, 'grad_norm': 1.0684336423873901, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.7861, 'train_samples_per_second': 7.171, 'train_steps_per_second': 0.508, 'train_loss': 1.2269083267077803, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:55,  1.59it/s]  1%|          | 3/471 [00:02<06:58,  1.12it/s]  1%|          | 4/471 [00:03<08:03,  1.04s/it]  1%|          | 5/471 [00:05<08:40,  1.12s/it]  1%|▏         | 6/471 [00:06<09:02,  1.17s/it]  1%|▏         | 7/471 [00:07<09:18,  1.20s/it]  2%|▏         | 8/471 [00:08<09:27,  1.23s/it]  2%|▏         | 9/471 [00:10<09:33,  1.24s/it]  2%|▏         | 10/471 [00:11<09:38,  1.25s/it]  2%|▏         | 11/471 [00:12<09:40,  1.26s/it]  3%|▎         | 12/471 [00:14<09:41,  1.27s/it]  3%|▎         | 13/471 [00:15<09:43,  1.27s/it]  3%|▎         | 14/471 [00:16<09:43,  1.28s/it]  3%|▎         | 15/471 [00:17<09:43,  1.28s/it]  3%|▎         | 16/471 [00:19<09:43,  1.28s/it]  4%|▎         | 17/471 [00:20<09:43,  1.29s/it]  4%|▍         | 18/471 [00:21<09:43,  1.29s/it]  4%|▍         | 19/471 [00:23<09:41,  1.29s/it]  4%|▍         | 20/471 [00:24<09:41,  1.29s/it]  4%|▍         | 21/471 [00:25<09:40,  1.29s/it]  5%|▍         | 22/471 [00:26<09:40,  1.29s/it]  5%|▍         | 23/471 [00:28<09:39,  1.29s/it]  5%|▌         | 24/471 [00:29<09:36,  1.29s/it]  5%|▌         | 25/471 [00:30<09:36,  1.29s/it]  6%|▌         | 26/471 [00:32<09:35,  1.29s/it]  6%|▌         | 27/471 [00:33<09:34,  1.29s/it]  6%|▌         | 28/471 [00:34<09:33,  1.30s/it]  6%|▌         | 29/471 [00:35<09:33,  1.30s/it]  6%|▋         | 30/471 [00:37<09:33,  1.30s/it]  7%|▋         | 31/471 [00:38<09:31,  1.30s/it]  7%|▋         | 32/471 [00:39<09:30,  1.30s/it]  7%|▋         | 33/471 [00:41<09:27,  1.30s/it]  7%|▋         | 34/471 [00:42<09:27,  1.30s/it]  7%|▋         | 35/471 [00:43<09:27,  1.30s/it]  8%|▊         | 36/471 [00:45<09:25,  1.30s/it]  8%|▊         | 37/471 [00:46<09:25,  1.30s/it]  8%|▊         | 38/471 [00:47<09:24,  1.30s/it]  8%|▊         | 39/471 [00:48<09:22,  1.30s/it]  8%|▊         | 40/471 [00:50<09:21,  1.30s/it]  9%|▊         | 41/471 [00:51<09:20,  1.30s/it]  9%|▉         | 42/471 [00:52<09:19,  1.31s/it]  9%|▉         | 43/471 [00:54<09:17,  1.30s/it]  9%|▉         | 44/471 [00:55<09:16,  1.30s/it] 10%|▉         | 45/471 [00:56<09:16,  1.31s/it] 10%|▉         | 46/471 [00:58<09:15,  1.31s/it] 10%|▉         | 47/471 [00:59<09:13,  1.31s/it] 10%|█         | 48/471 [01:00<09:13,  1.31s/it] 10%|█         | 49/471 [01:02<09:12,  1.31s/it] 11%|█         | 50/471 [01:03<09:11,  1.31s/it] 11%|█         | 51/471 [01:04<09:10,  1.31s/it] 11%|█         | 52/471 [01:06<09:09,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:08,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:07,  1.31s/it] 12%|█▏        | 55/471 [01:09<09:06,  1.31s/it] 12%|█▏        | 56/471 [01:11<09:06,  1.32s/it] 12%|█▏        | 57/471 [01:12<09:03,  1.31s/it] 12%|█▏        | 58/471 [01:13<09:02,  1.31s/it] 13%|█▎        | 59/471 [01:15<09:01,  1.31s/it] 13%|█▎        | 60/471 [01:16<09:00,  1.32s/it] 13%|█▎        | 61/471 [01:17<08:59,  1.32s/it] 13%|█▎        | 62/471 [01:19<08:57,  1.32s/it] 13%|█▎        | 63/471 [01:20<08:56,  1.32s/it] 14%|█▎        | 64/471 [01:21<08:55,  1.32s/it] 14%|█▍        | 65/471 [01:23<08:54,  1.32s/it] 14%|█▍        | 66/471 [01:24<08:53,  1.32s/it] 14%|█▍        | 67/471 [01:25<08:52,  1.32s/it] 14%|█▍        | 68/471 [01:27<08:50,  1.32s/it] 15%|█▍        | 69/471 [01:28<08:49,  1.32s/it] 15%|█▍        | 70/471 [01:29<08:49,  1.32s/it] 15%|█▌        | 71/471 [01:31<08:48,  1.32s/it] 15%|█▌        | 72/471 [01:32<08:46,  1.32s/it] 15%|█▌        | 73/471 [01:33<08:45,  1.32s/it] 16%|█▌        | 74/471 [01:34<08:43,  1.32s/it] 16%|█▌        | 75/471 [01:36<08:42,  1.32s/it] 16%|█▌        | 76/471 [01:37<08:40,  1.32s/it] 16%|█▋        | 77/471 [01:38<08:39,  1.32s/it] 17%|█▋        | 78/471 [01:40<08:38,  1.32s/it] 17%|█▋        | 79/471 [01:41<08:37,  1.32s/it] 17%|█▋        | 80/471 [01:42<08:36,  1.32s/it] 17%|█▋        | 81/471 [01:44<08:35,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:33,  1.32s/it] 18%|█▊        | 83/471 [01:46<08:32,  1.32s/it] 18%|█▊        | 84/471 [01:48<08:31,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:31,  1.32s/it] 18%|█▊        | 86/471 [01:50<08:30,  1.33s/it] 18%|█▊        | 87/471 [01:52<08:28,  1.33s/it] 19%|█▊        | 88/471 [01:53<08:27,  1.32s/it] 19%|█▉        | 89/471 [01:54<08:25,  1.32s/it] 19%|█▉        | 90/471 [01:56<08:25,  1.33s/it] 19%|█▉        | 91/471 [01:57<08:23,  1.32s/it] 20%|█▉        | 92/471 [01:58<08:21,  1.32s/it] 20%|█▉        | 93/471 [02:00<08:21,  1.33s/it] 20%|█▉        | 94/471 [02:01<08:19,  1.33s/it] 20%|██        | 95/471 [02:02<08:18,  1.33s/it] 20%|██        | 96/471 [02:04<08:16,  1.32s/it] 21%|██        | 97/471 [02:05<08:16,  1.33s/it] 21%|██        | 98/471 [02:06<08:14,  1.33s/it] 21%|██        | 99/471 [02:08<08:13,  1.33s/it] 21%|██        | 100/471 [02:09<08:12,  1.33s/it] 21%|██▏       | 101/471 [02:10<08:10,  1.33s/it] 22%|██▏       | 102/471 [02:12<08:10,  1.33s/it] 22%|██▏       | 103/471 [02:13<08:09,  1.33s/it] 22%|██▏       | 104/471 [02:14<08:08,  1.33s/it] 22%|██▏       | 105/471 [02:16<08:08,  1.33s/it] 23%|██▎       | 106/471 [02:17<08:06,  1.33s/it] 23%|██▎       | 107/471 [02:18<08:04,  1.33s/it] 23%|██▎       | 108/471 [02:20<08:03,  1.33s/it] 23%|██▎       | 109/471 [02:21<08:01,  1.33s/it] 23%|██▎       | 110/471 [02:22<07:59,  1.33s/it] 24%|██▎       | 111/471 [02:24<07:58,  1.33s/it] 24%|██▍       | 112/471 [02:25<07:57,  1.33s/it] 24%|██▍       | 113/471 [02:26<07:56,  1.33s/it] 24%|██▍       | 114/471 [02:28<07:55,  1.33s/it] 24%|██▍       | 115/471 [02:29<07:54,  1.33s/it] 25%|██▍       | 116/471 [02:30<07:53,  1.34s/it] 25%|██▍       | 117/471 [02:32<07:52,  1.34s/it] 25%|██▌       | 118/471 [02:33<07:51,  1.34s/it] 25%|██▌       | 119/471 [02:34<07:49,  1.34s/it] 25%|██▌       | 120/471 [02:36<07:49,  1.34s/it] 26%|██▌       | 121/471 [02:37<07:47,  1.34s/it] 26%|██▌       | 122/471 [02:38<07:46,  1.34s/it] 26%|██▌       | 123/471 [02:40<07:45,  1.34s/it] 26%|██▋       | 124/471 [02:41<07:44,  1.34s/it] 27%|██▋       | 125/471 [02:42<07:42,  1.34s/it] 27%|██▋       | 126/471 [02:44<07:41,  1.34s/it] 27%|██▋       | 127/471 [02:45<07:39,  1.34s/it] 27%|██▋       | 128/471 [02:46<07:37,  1.34s/it] 27%|██▋       | 129/471 [02:48<07:36,  1.33s/it] 28%|██▊       | 130/471 [02:49<07:34,  1.33s/it] 28%|██▊       | 131/471 [02:50<07:33,  1.34s/it] 28%|██▊       | 132/471 [02:52<07:32,  1.34s/it] 28%|██▊       | 133/471 [02:53<07:31,  1.33s/it] 28%|██▊       | 134/471 [02:54<07:30,  1.34s/it] 29%|██▊       | 135/471 [02:56<07:28,  1.34s/it] 29%|██▉       | 136/471 [02:57<07:27,  1.33s/it] 29%|██▉       | 137/471 [02:58<07:25,  1.34s/it] 29%|██▉       | 138/471 [03:00<07:24,  1.33s/it] 30%|██▉       | 139/471 [03:01<07:23,  1.33s/it] 30%|██▉       | 140/471 [03:02<07:22,  1.34s/it] 30%|██▉       | 141/471 [03:04<07:19,  1.33s/it] 30%|███       | 142/471 [03:05<07:18,  1.33s/it] 30%|███       | 143/471 [03:06<07:17,  1.33s/it] 31%|███       | 144/471 [03:08<07:16,  1.34s/it] 31%|███       | 145/471 [03:09<07:15,  1.33s/it] 31%|███       | 146/471 [03:10<07:14,  1.34s/it] 31%|███       | 147/471 [03:12<07:12,  1.34s/it] 31%|███▏      | 148/471 [03:13<07:11,  1.34s/it] 32%|███▏      | 149/471 [03:14<07:11,  1.34s/it] 32%|███▏      | 150/471 [03:16<07:09,  1.34s/it] 32%|███▏      | 151/471 [03:17<07:08,  1.34s/it] 32%|███▏      | 152/471 [03:18<07:06,  1.34s/it] 32%|███▏      | 153/471 [03:20<07:05,  1.34s/it] 33%|███▎      | 154/471 [03:21<07:03,  1.33s/it] 33%|███▎      | 155/471 [03:22<07:02,  1.34s/it] 33%|███▎      | 156/471 [03:24<07:00,  1.33s/it] 33%|███▎      | 157/471 [03:25<06:58,  1.33s/it] 34%|███▎      | 158/471 [03:26<06:56,  1.33s/it] 34%|███▍      | 159/471 [03:28<06:55,  1.33s/it] 34%|███▍      | 160/471 [03:29<06:54,  1.33s/it] 34%|███▍      | 161/471 [03:30<06:53,  1.33s/it] 34%|███▍      | 162/471 [03:32<06:51,  1.33s/it] 35%|███▍      | 163/471 [03:33<06:51,  1.33s/it] 35%|███▍      | 164/471 [03:34<06:49,  1.33s/it] 35%|███▌      | 165/471 [03:36<06:48,  1.33s/it] 35%|███▌      | 166/471 [03:37<06:47,  1.34s/it] 35%|███▌      | 167/471 [03:38<06:46,  1.34s/it] 36%|███▌      | 168/471 [03:40<06:44,  1.34s/it] 36%|███▌      | 169/471 [03:41<06:43,  1.34s/it] 36%|███▌      | 170/471 [03:42<06:41,  1.34s/it] 36%|███▋      | 171/471 [03:44<06:40,  1.33s/it] 37%|███▋      | 172/471 [03:45<06:38,  1.33s/it] 37%|███▋      | 173/471 [03:46<06:37,  1.33s/it] 37%|███▋      | 174/471 [03:48<06:36,  1.33s/it] 37%|███▋      | 175/471 [03:49<06:35,  1.34s/it] 37%|███▋      | 176/471 [03:50<06:33,  1.33s/it] 38%|███▊      | 177/471 [03:52<06:31,  1.33s/it] 38%|███▊      | 178/471 [03:53<06:30,  1.33s/it] 38%|███▊      | 179/471 [03:54<06:28,  1.33s/it] 38%|███▊      | 180/471 [03:56<06:27,  1.33s/it] 38%|███▊      | 181/471 [03:57<06:25,  1.33s/it] 39%|███▊      | 182/471 [03:58<06:24,  1.33s/it] 39%|███▉      | 183/471 [04:00<06:23,  1.33s/it] 39%|███▉      | 184/471 [04:01<06:21,  1.33s/it] 39%|███▉      | 185/471 [04:02<06:20,  1.33s/it] 39%|███▉      | 186/471 [04:04<06:19,  1.33s/it] 40%|███▉      | 187/471 [04:05<06:18,  1.33s/it] 40%|███▉      | 188/471 [04:06<06:17,  1.33s/it] 40%|████      | 189/471 [04:08<06:14,  1.33s/it] 40%|████      | 190/471 [04:09<06:13,  1.33s/it] 41%|████      | 191/471 [04:10<06:12,  1.33s/it] 41%|████      | 192/471 [04:12<06:10,  1.33s/it] 41%|████      | 193/471 [04:13<06:09,  1.33s/it] 41%|████      | 194/471 [04:14<06:08,  1.33s/it] 41%|████▏     | 195/471 [04:16<06:06,  1.33s/it] 42%|████▏     | 196/471 [04:17<06:05,  1.33s/it] 42%|████▏     | 197/471 [04:18<06:02,  1.32s/it] 42%|████▏     | 198/471 [04:20<06:01,  1.32s/it] 42%|████▏     | 199/471 [04:21<06:00,  1.32s/it] 42%|████▏     | 200/471 [04:22<05:58,  1.32s/it] 43%|████▎     | 201/471 [04:24<05:56,  1.32s/it] 43%|████▎     | 202/471 [04:25<05:55,  1.32s/it] 43%|████▎     | 203/471 [04:26<05:54,  1.32s/it] 43%|████▎     | 204/471 [04:27<05:52,  1.32s/it] 44%|████▎     | 205/471 [04:29<05:51,  1.32s/it] 44%|████▎     | 206/471 [04:30<05:49,  1.32s/it] 44%|████▍     | 207/471 [04:31<05:48,  1.32s/it] 44%|████▍     | 208/471 [04:33<05:46,  1.32s/it] 44%|████▍     | 209/471 [04:34<05:45,  1.32s/it] 45%|████▍     | 210/471 [04:35<05:44,  1.32s/it] 45%|████▍     | 211/471 [04:37<05:42,  1.32s/it] 45%|████▌     | 212/471 [04:38<05:41,  1.32s/it] 45%|████▌     | 213/471 [04:39<05:40,  1.32s/it] 45%|████▌     | 214/471 [04:41<05:38,  1.32s/it] 46%|████▌     | 215/471 [04:42<05:36,  1.32s/it] 46%|████▌     | 216/471 [04:43<05:36,  1.32s/it] 46%|████▌     | 217/471 [04:45<05:35,  1.32s/it] 46%|████▋     | 218/471 [04:46<05:34,  1.32s/it] 46%|████▋     | 219/471 [04:47<05:33,  1.32s/it] 47%|████▋     | 220/471 [04:49<05:31,  1.32s/it] 47%|████▋     | 221/471 [04:50<05:30,  1.32s/it] 47%|████▋     | 222/471 [04:51<05:28,  1.32s/it] 47%|████▋     | 223/471 [04:53<05:26,  1.32s/it] 48%|████▊     | 224/471 [04:54<05:25,  1.32s/it] 48%|████▊     | 225/471 [04:55<05:24,  1.32s/it] 48%|████▊     | 226/471 [04:57<05:24,  1.32s/it] 48%|████▊     | 227/471 [04:58<05:22,  1.32s/it] 48%|████▊     | 228/471 [04:59<05:20,  1.32s/it] 49%|████▊     | 229/471 [05:00<05:19,  1.32s/it] 49%|████▉     | 230/471 [05:02<05:18,  1.32s/it] 49%|████▉     | 231/471 [05:03<05:16,  1.32s/it] 49%|████▉     | 232/471 [05:04<05:15,  1.32s/it] 49%|████▉     | 233/471 [05:06<05:13,  1.32s/it] 50%|████▉     | 234/471 [05:07<05:12,  1.32s/it] 50%|████▉     | 235/471 [05:08<05:11,  1.32s/it] 50%|█████     | 236/471 [05:10<05:10,  1.32s/it] 50%|█████     | 237/471 [05:11<05:08,  1.32s/it] 51%|█████     | 238/471 [05:12<05:07,  1.32s/it] 51%|█████     | 239/471 [05:14<05:06,  1.32s/it] 51%|█████     | 240/471 [05:15<05:04,  1.32s/it] 51%|█████     | 241/471 [05:16<05:03,  1.32s/it] 51%|█████▏    | 242/471 [05:18<05:02,  1.32s/it] 52%|█████▏    | 243/471 [05:19<05:01,  1.32s/it] 52%|█████▏    | 244/471 [05:20<05:00,  1.32s/it] 52%|█████▏    | 245/471 [05:22<04:58,  1.32s/it] 52%|█████▏    | 246/471 [05:23<04:57,  1.32s/it] 52%|█████▏    | 247/471 [05:24<04:55,  1.32s/it] 53%|█████▎    | 248/471 [05:26<04:54,  1.32s/it] 53%|█████▎    | 249/471 [05:27<04:53,  1.32s/it] 53%|█████▎    | 250/471 [05:28<04:52,  1.32s/it] 53%|█████▎    | 251/471 [05:30<04:50,  1.32s/it] 54%|█████▎    | 252/471 [05:31<04:49,  1.32s/it] 54%|█████▎    | 253/471 [05:32<04:48,  1.32s/it] 54%|█████▍    | 254/471 [05:33<04:46,  1.32s/it] 54%|█████▍    | 255/471 [05:35<04:45,  1.32s/it] 54%|█████▍    | 256/471 [05:36<04:44,  1.32s/it] 55%|█████▍    | 257/471 [05:37<04:43,  1.32s/it] 55%|█████▍    | 258/471 [05:39<04:42,  1.33s/it] 55%|█████▍    | 259/471 [05:40<04:41,  1.33s/it] 55%|█████▌    | 260/471 [05:41<04:40,  1.33s/it] 55%|█████▌    | 261/471 [05:43<04:38,  1.33s/it] 56%|█████▌    | 262/471 [05:44<04:36,  1.32s/it] 56%|█████▌    | 263/471 [05:45<04:35,  1.33s/it] 56%|█████▌    | 264/471 [05:47<04:34,  1.32s/it] 56%|█████▋    | 265/471 [05:48<04:33,  1.33s/it] 56%|█████▋    | 266/471 [05:49<04:32,  1.33s/it] 57%|█████▋    | 267/471 [05:51<04:30,  1.33s/it] 57%|█████▋    | 268/471 [05:52<04:29,  1.33s/it] 57%|█████▋    | 269/471 [05:53<04:28,  1.33s/it] 57%|█████▋    | 270/471 [05:55<04:27,  1.33s/it] 58%|█████▊    | 271/471 [05:56<04:25,  1.33s/it] 58%|█████▊    | 272/471 [05:57<04:23,  1.33s/it] 58%|█████▊    | 273/471 [05:59<04:22,  1.33s/it] 58%|█████▊    | 274/471 [06:00<04:20,  1.32s/it] 58%|█████▊    | 275/471 [06:01<04:19,  1.32s/it] 59%|█████▊    | 276/471 [06:03<04:18,  1.32s/it] 59%|█████▉    | 277/471 [06:04<04:16,  1.32s/it] 59%|█████▉    | 278/471 [06:05<04:15,  1.33s/it] 59%|█████▉    | 279/471 [06:07<04:14,  1.32s/it] 59%|█████▉    | 280/471 [06:08<04:12,  1.32s/it] 60%|█████▉    | 281/471 [06:09<04:11,  1.32s/it] 60%|█████▉    | 282/471 [06:11<04:10,  1.32s/it] 60%|██████    | 283/471 [06:12<04:08,  1.32s/it] 60%|██████    | 284/471 [06:13<04:07,  1.32s/it] 61%|██████    | 285/471 [06:15<04:06,  1.33s/it] 61%|██████    | 286/471 [06:16<04:05,  1.33s/it] 61%|██████    | 287/471 [06:17<04:03,  1.33s/it] 61%|██████    | 288/471 [06:19<04:02,  1.33s/it] 61%|██████▏   | 289/471 [06:20<04:00,  1.32s/it] 62%|██████▏   | 290/471 [06:21<03:59,  1.32s/it] 62%|██████▏   | 291/471 [06:23<03:58,  1.32s/it] 62%|██████▏   | 292/471 [06:24<03:56,  1.32s/it] 62%|██████▏   | 293/471 [06:25<03:55,  1.32s/it] 62%|██████▏   | 294/471 [06:27<03:54,  1.32s/it] 63%|██████▎   | 295/471 [06:28<03:52,  1.32s/it] 63%|██████▎   | 296/471 [06:29<03:51,  1.32s/it] 63%|██████▎   | 297/471 [06:30<03:50,  1.32s/it] 63%|██████▎   | 298/471 [06:32<03:48,  1.32s/it] 63%|██████▎   | 299/471 [06:33<03:47,  1.32s/it] 64%|██████▎   | 300/471 [06:34<03:46,  1.32s/it] 64%|██████▍   | 301/471 [06:36<03:44,  1.32s/it] 64%|██████▍   | 302/471 [06:37<03:43,  1.32s/it] 64%|██████▍   | 303/471 [06:38<03:41,  1.32s/it] 65%|██████▍   | 304/471 [06:40<03:40,  1.32s/it] 65%|██████▍   | 305/471 [06:41<03:39,  1.32s/it] 65%|██████▍   | 306/471 [06:42<03:38,  1.32s/it] 65%|██████▌   | 307/471 [06:44<03:37,  1.32s/it] 65%|██████▌   | 308/471 [06:45<03:36,  1.33s/it] 66%|██████▌   | 309/471 [06:46<03:34,  1.33s/it] 66%|██████▌   | 310/471 [06:48<03:33,  1.33s/it] 66%|██████▌   | 311/471 [06:49<03:32,  1.33s/it] 66%|██████▌   | 312/471 [06:50<03:30,  1.33s/it] 66%|██████▋   | 313/471 [06:52<03:29,  1.33s/it] 67%|██████▋   | 314/471 [06:53<03:27,  1.32s/it] 67%|██████▋   | 315/471 [06:54<03:26,  1.33s/it] 67%|██████▋   | 316/471 [06:56<03:25,  1.33s/it] 67%|██████▋   | 317/471 [06:57<03:24,  1.33s/it] 68%|██████▊   | 318/471 [06:58<03:23,  1.33s/it] 68%|██████▊   | 319/471 [07:00<03:21,  1.33s/it] 68%|██████▊   | 320/471 [07:01<03:20,  1.33s/it] 68%|██████▊   | 321/471 [07:02<03:19,  1.33s/it] 68%|██████▊   | 322/471 [07:04<03:17,  1.33s/it] 69%|██████▊   | 323/471 [07:05<03:16,  1.33s/it] 69%|██████▉   | 324/471 [07:06<03:15,  1.33s/it] 69%|██████▉   | 325/471 [07:08<03:14,  1.33s/it] 69%|██████▉   | 326/471 [07:09<03:12,  1.33s/it] 69%|██████▉   | 327/471 [07:10<03:11,  1.33s/it] 70%|██████▉   | 328/471 [07:12<03:10,  1.33s/it] 70%|██████▉   | 329/471 [07:13<03:09,  1.33s/it] 70%|███████   | 330/471 [07:14<03:07,  1.33s/it] 70%|███████   | 331/471 [07:16<03:06,  1.33s/it] 70%|███████   | 332/471 [07:17<03:05,  1.33s/it] 71%|███████   | 333/471 [07:18<03:03,  1.33s/it] 71%|███████   | 334/471 [07:20<03:02,  1.33s/it] 71%|███████   | 335/471 [07:21<03:01,  1.33s/it] 71%|███████▏  | 336/471 [07:22<03:00,  1.33s/it] 72%|███████▏  | 337/471 [07:24<02:58,  1.33s/it] 72%|███████▏  | 338/471 [07:25<02:57,  1.33s/it] 72%|███████▏  | 339/471 [07:26<02:56,  1.33s/it] 72%|███████▏  | 340/471 [07:28<02:54,  1.33s/it] 72%|███████▏  | 341/471 [07:29<02:53,  1.33s/it] 73%|███████▎  | 342/471 [07:30<02:51,  1.33s/it] 73%|███████▎  | 343/471 [07:32<02:50,  1.33s/it] 73%|███████▎  | 344/471 [07:33<02:49,  1.33s/it] 73%|███████▎  | 345/471 [07:34<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:36<02:46,  1.33s/it] 74%|███████▎  | 347/471 [07:37<02:45,  1.33s/it] 74%|███████▍  | 348/471 [07:38<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:40<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:41<02:41,  1.33s/it] 75%|███████▍  | 351/471 [07:42<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:44<02:38,  1.33s/it] 75%|███████▍  | 353/471 [07:45<02:37,  1.33s/it] 75%|███████▌  | 354/471 [07:46<02:35,  1.33s/it] 75%|███████▌  | 355/471 [07:48<02:34,  1.33s/it] 76%|███████▌  | 356/471 [07:49<02:33,  1.33s/it] 76%|███████▌  | 357/471 [07:50<02:31,  1.33s/it] 76%|███████▌  | 358/471 [07:52<02:30,  1.33s/it] 76%|███████▌  | 359/471 [07:53<02:29,  1.33s/it] 76%|███████▋  | 360/471 [07:54<02:27,  1.33s/it] 77%|███████▋  | 361/471 [07:56<02:26,  1.33s/it] 77%|███████▋  | 362/471 [07:57<02:25,  1.33s/it] 77%|███████▋  | 363/471 [07:58<02:23,  1.33s/it] 77%|███████▋  | 364/471 [08:00<02:22,  1.33s/it] 77%|███████▋  | 365/471 [08:01<02:21,  1.33s/it] 78%|███████▊  | 366/471 [08:02<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:04<02:18,  1.33s/it] 78%|███████▊  | 368/471 [08:05<02:17,  1.33s/it] 78%|███████▊  | 369/471 [08:06<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:08<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:09<02:13,  1.33s/it] 79%|███████▉  | 372/471 [08:10<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:12<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:13<02:08,  1.33s/it] 80%|███████▉  | 375/471 [08:14<02:07,  1.33s/it] 80%|███████▉  | 376/471 [08:16<02:06,  1.33s/it] 80%|████████  | 377/471 [08:17<02:04,  1.33s/it] 80%|████████  | 378/471 [08:18<02:03,  1.33s/it] 80%|████████  | 379/471 [08:20<02:02,  1.33s/it] 81%|████████  | 380/471 [08:21<02:00,  1.33s/it] 81%|████████  | 381/471 [08:22<01:59,  1.33s/it] 81%|████████  | 382/471 [08:23<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:25<01:56,  1.33s/it] 82%|████████▏ | 384/471 [08:26<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:27<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:29<01:52,  1.33s/it] 82%|████████▏ | 387/471 [08:30<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:31<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:33<01:48,  1.33s/it] 83%|████████▎ | 390/471 [08:34<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:35<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:37<01:44,  1.33s/it] 83%|████████▎ | 393/471 [08:38<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:39<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:41<01:40,  1.33s/it] 84%|████████▍ | 396/471 [08:42<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:43<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:45<01:36,  1.32s/it] 85%|████████▍ | 399/471 [08:46<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:47<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:49<01:32,  1.32s/it] 85%|████████▌ | 402/471 [08:50<01:31,  1.32s/it] 86%|████████▌ | 403/471 [08:51<01:29,  1.32s/it] 86%|████████▌ | 404/471 [08:53<01:28,  1.32s/it] 86%|████████▌ | 405/471 [08:54<01:27,  1.32s/it] 86%|████████▌ | 406/471 [08:55<01:25,  1.32s/it] 86%|████████▋ | 407/471 [08:57<01:24,  1.32s/it] 87%|████████▋ | 408/471 [08:58<01:23,  1.32s/it] 87%|████████▋ | 409/471 [08:59<01:22,  1.32s/it] 87%|████████▋ | 410/471 [09:01<01:20,  1.32s/it] 87%|████████▋ | 411/471 [09:02<01:19,  1.32s/it] 87%|████████▋ | 412/471 [09:03<01:18,  1.32s/it] 88%|████████▊ | 413/471 [09:05<01:16,  1.32s/it] 88%|████████▊ | 414/471 [09:06<01:15,  1.32s/it] 88%|████████▊ | 415/471 [09:07<01:13,  1.32s/it] 88%|████████▊ | 416/471 [09:09<01:12,  1.32s/it] 89%|████████▊ | 417/471 [09:10<01:11,  1.32s/it] 89%|████████▊ | 418/471 [09:11<01:10,  1.32s/it] 89%|████████▉ | 419/471 [09:12<01:08,  1.32s/it] 89%|████████▉ | 420/471 [09:14<01:07,  1.32s/it] 89%|████████▉ | 421/471 [09:15<01:06,  1.32s/it] 90%|████████▉ | 422/471 [09:16<01:04,  1.32s/it] 90%|████████▉ | 423/471 [09:18<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:19<01:02,  1.32s/it] 90%|█████████ | 425/471 [09:20<01:00,  1.32s/it] 90%|█████████ | 426/471 [09:22<00:59,  1.32s/it] 91%|█████████ | 427/471 [09:23<00:58,  1.32s/it] 91%|█████████ | 428/471 [09:24<00:56,  1.32s/it] 91%|█████████ | 429/471 [09:26<00:55,  1.32s/it] 91%|█████████▏| 430/471 [09:27<00:54,  1.32s/it] 92%|█████████▏| 431/471 [09:28<00:52,  1.32s/it] 92%|█████████▏| 432/471 [09:30<00:51,  1.32s/it] 92%|█████████▏| 433/471 [09:31<00:50,  1.32s/it] 92%|█████████▏| 434/471 [09:32<00:49,  1.33s/it] 92%|█████████▏| 435/471 [09:34<00:47,  1.33s/it] 93%|█████████▎| 436/471 [09:35<00:46,  1.32s/it] 93%|█████████▎| 437/471 [09:36<00:45,  1.33s/it] 93%|█████████▎| 438/471 [09:38<00:43,  1.33s/it] 93%|█████████▎| 439/471 [09:39<00:42,  1.32s/it] 93%|█████████▎| 440/471 [09:40<00:41,  1.32s/it] 94%|█████████▎| 441/471 [09:42<00:39,  1.32s/it] 94%|█████████▍| 442/471 [09:43<00:38,  1.32s/it] 94%|█████████▍| 443/471 [09:44<00:36,  1.32s/it] 94%|█████████▍| 444/471 [09:46<00:35,  1.32s/it] 94%|█████████▍| 445/471 [09:47<00:34,  1.32s/it] 95%|█████████▍| 446/471 [09:48<00:33,  1.32s/it] 95%|█████████▍| 447/471 [09:50<00:31,  1.32s/it] 95%|█████████▌| 448/471 [09:51<00:30,  1.32s/it] 95%|█████████▌| 449/471 [09:52<00:29,  1.32s/it] 96%|█████████▌| 450/471 [09:53<00:27,  1.32s/it] 96%|█████████▌| 451/471 [09:55<00:26,  1.32s/it] 96%|█████████▌| 452/471 [09:56<00:25,  1.32s/it] 96%|█████████▌| 453/471 [09:57<00:23,  1.32s/it] 96%|█████████▋| 454/471 [09:59<00:22,  1.32s/it] 97%|█████████▋| 455/471 [10:00<00:21,  1.33s/it] 97%|█████████▋| 456/471 [10:01<00:19,  1.32s/it] 97%|█████████▋| 457/471 [10:03<00:18,  1.33s/it] 97%|█████████▋| 458/471 [10:04<00:17,  1.32s/it] 97%|█████████▋| 459/471 [10:05<00:15,  1.32s/it] 98%|█████████▊| 460/471 [10:07<00:14,  1.32s/it] 98%|█████████▊| 461/471 [10:08<00:13,  1.32s/it] 98%|█████████▊| 462/471 [10:09<00:11,  1.32s/it] 98%|█████████▊| 463/471 [10:11<00:10,  1.32s/it] 99%|█████████▊| 464/471 [10:12<00:09,  1.32s/it] 99%|█████████▊| 465/471 [10:13<00:07,  1.32s/it] 99%|█████████▉| 466/471 [10:15<00:06,  1.32s/it] 99%|█████████▉| 467/471 [10:16<00:05,  1.32s/it] 99%|█████████▉| 468/471 [10:17<00:03,  1.32s/it]100%|█████████▉| 469/471 [10:19<00:02,  1.32s/it]100%|█████████▉| 470/471 [10:20<00:01,  1.32s/it]100%|██████████| 471/471 [10:21<00:00,  1.21s/it]100%|██████████| 471/471 [10:21<00:00,  1.32s/it]
{'eval_loss': 4.926582336425781, 'eval_model_preparation_time': 0.0132, 'eval_acc': 0.1891927774827403, 'eval_runtime': 622.6399, 'eval_samples_per_second': 12.097, 'eval_steps_per_second': 0.756}
ROUND:5
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 4.5548, 'grad_norm': 4.886951446533203, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.7409, 'grad_norm': 4.232279300689697, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.22s/it]                                              {'loss': 4.5692, 'grad_norm': 5.730175971984863, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.22s/it] 10%|█         | 4/40 [00:08<01:20,  2.24s/it]                                              {'loss': 3.4027, 'grad_norm': 9.051369667053223, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:20,  2.24s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it]                                              {'loss': 4.135, 'grad_norm': 10.22277545928955, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 4.1043, 'grad_norm': 10.386468887329102, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it]                                              {'loss': 2.8672, 'grad_norm': 10.673259735107422, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it] 20%|██        | 8/40 [00:16<00:53,  1.67s/it]                                              {'loss': 7.9381, 'grad_norm': 25.66810417175293, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:16<00:53,  1.67s/it] 22%|██▎       | 9/40 [00:18<00:56,  1.82s/it]                                              {'loss': 1.8063, 'grad_norm': 11.305901527404785, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:56,  1.82s/it] 25%|██▌       | 10/40 [00:20<00:58,  1.94s/it]                                               {'loss': 2.5561, 'grad_norm': 87.08525085449219, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:58,  1.94s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it]                                               {'loss': 2.1521, 'grad_norm': 62.4351921081543, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 1.2666, 'grad_norm': 16.95064353942871, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:27<00:57,  2.12s/it]                                               {'loss': 0.5833, 'grad_norm': 7.093086242675781, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.15s/it]                                               {'loss': 1.8162, 'grad_norm': 14.910475730895996, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 1.3414, 'grad_norm': 4.528090953826904, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.1477, 'grad_norm': 3.5152060985565186, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 1.8464, 'grad_norm': 5.9536638259887695, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it]                                               {'loss': 1.0555, 'grad_norm': 6.984691143035889, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it]                                               {'loss': 0.4069, 'grad_norm': 1.3592453002929688, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.8296, 'grad_norm': 4.51447868347168, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.5451, 'grad_norm': 4.140685081481934, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.5951, 'grad_norm': 3.580841064453125, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it]                                               {'loss': 0.4918, 'grad_norm': 3.0870473384857178, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it] 60%|██████    | 24/40 [00:47<00:25,  1.57s/it]                                               {'loss': 0.1432, 'grad_norm': 3.72908616065979, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.6765, 'grad_norm': 6.84475564956665, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.4917, 'grad_norm': 2.4069957733154297, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.00s/it]                                               {'loss': 0.4036, 'grad_norm': 2.0720882415771484, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.00s/it] 70%|███████   | 28/40 [00:56<00:24,  2.07s/it]                                               {'loss': 0.2377, 'grad_norm': 2.0699551105499268, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.0502, 'grad_norm': 0.661173403263092, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1162, 'grad_norm': 1.438134789466858, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.19s/it]                                               {'loss': 0.2573, 'grad_norm': 1.4291102886199951, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.19s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.382, 'grad_norm': 15.90386962890625, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.078, 'grad_norm': 0.931008517742157, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0276, 'grad_norm': 0.41663357615470886, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it]                                               {'loss': 0.0333, 'grad_norm': 0.3919515907764435, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.1054, 'grad_norm': 2.4282751083374023, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.1647, 'grad_norm': 1.58870267868042, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.3791, 'grad_norm': 2.0568079948425293, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]                                               {'loss': 0.3876, 'grad_norm': 4.6276092529296875, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.1345, 'grad_norm': 4.259204864501953, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.6033, 'train_samples_per_second': 7.098, 'train_steps_per_second': 0.502, 'train_loss': 1.3955245051998646, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.23s/it]                                              {'loss': 4.1394, 'grad_norm': 5.354898929595947, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.23s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 4.9288, 'grad_norm': 5.54500675201416, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 5.1422, 'grad_norm': 6.4991679191589355, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 4.6285, 'grad_norm': 7.145516395568848, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 3.7579, 'grad_norm': 11.06190299987793, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 3.6504, 'grad_norm': 8.935887336730957, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 2.4724, 'grad_norm': 8.083096504211426, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 4.0732, 'grad_norm': 29.414962768554688, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.1671, 'grad_norm': 6.131150722503662, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.627, 'grad_norm': 5.845877647399902, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 2.1137, 'grad_norm': 4.987747669219971, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 1.7159, 'grad_norm': 5.7160491943359375, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 1.4434, 'grad_norm': 4.986011505126953, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.1843, 'grad_norm': 6.531274318695068, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.0901, 'grad_norm': 5.0202226638793945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.1772, 'grad_norm': 5.833354949951172, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.7644, 'grad_norm': 3.677358388900757, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.3344, 'grad_norm': 2.0173141956329346, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.2046, 'grad_norm': 4.461577892303467, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:39<00:41,  2.08s/it]                                               {'loss': 0.9023, 'grad_norm': 3.1287660598754883, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.3836, 'grad_norm': 2.6613025665283203, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.3603, 'grad_norm': 4.0006208419799805, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.7385, 'grad_norm': 6.033541202545166, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0006, 'grad_norm': 0.020727897062897682, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it]                                               {'loss': 0.2999, 'grad_norm': 4.256165027618408, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.293, 'grad_norm': 4.676398277282715, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.1782, 'grad_norm': 1.9566047191619873, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.05s/it]                                               {'loss': 0.1404, 'grad_norm': 1.3064602613449097, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.2536, 'grad_norm': 2.561688184738159, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.1051, 'grad_norm': 2.624291181564331, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.1464, 'grad_norm': 2.270444393157959, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0339, 'grad_norm': 1.2804588079452515, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.7014, 'grad_norm': 7.247845649719238, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.1977, 'grad_norm': 3.660954713821411, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.4908, 'grad_norm': 7.400941848754883, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.6671, 'grad_norm': 3.823737382888794, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.0665, 'grad_norm': 0.8383396863937378, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.2144, 'grad_norm': 10.643393516540527, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.11, 'grad_norm': 2.347902297973633, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0083, 'grad_norm': 0.4958015978336334, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.5471, 'train_samples_per_second': 7.193, 'train_steps_per_second': 0.509, 'train_loss': 1.2726749775159987, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.11s/it]                                              {'loss': 3.7736, 'grad_norm': 5.54720401763916, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.11s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 5.1112, 'grad_norm': 8.471736907958984, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 4.9064, 'grad_norm': 7.1470818519592285, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 3.7831, 'grad_norm': 14.209327697753906, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 3.465, 'grad_norm': 6.085882186889648, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it]                                              {'loss': 2.6968, 'grad_norm': 9.74960994720459, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 3.706, 'grad_norm': 12.586116790771484, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 2.4516, 'grad_norm': 40.858646392822266, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.9315, 'grad_norm': 2.9199719429016113, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it]                                               {'loss': 2.0752, 'grad_norm': 6.12451696395874, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it]                                               {'loss': 1.9099, 'grad_norm': 5.573965072631836, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 1.34, 'grad_norm': 4.438877582550049, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 2.111, 'grad_norm': 8.302850723266602, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.6104, 'grad_norm': 4.04573392868042, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.5076, 'grad_norm': 6.159202575683594, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 2.6978, 'grad_norm': 36.10240936279297, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.75s/it]                                               {'loss': 0.4986, 'grad_norm': 4.830921173095703, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.8966, 'grad_norm': 7.140718460083008, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it]                                               {'loss': 1.3205, 'grad_norm': 2.735126495361328, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it] 50%|█████     | 20/40 [00:39<00:40,  2.02s/it]                                               {'loss': 0.4638, 'grad_norm': 1.4669078588485718, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.02s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.4609, 'grad_norm': 1.879788875579834, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it]                                               {'loss': 0.3582, 'grad_norm': 2.4455528259277344, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.4094, 'grad_norm': 2.1246519088745117, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0027, 'grad_norm': 0.10121820122003555, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.7227, 'grad_norm': 5.736276626586914, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.2846, 'grad_norm': 1.797005295753479, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it]                                               {'loss': 0.5291, 'grad_norm': 1.757443904876709, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it] 70%|███████   | 28/40 [00:55<00:24,  2.05s/it]                                               {'loss': 0.1458, 'grad_norm': 2.3694088459014893, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.1669, 'grad_norm': 1.6610887050628662, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.1259, 'grad_norm': 1.095950961112976, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it]                                               {'loss': 0.1691, 'grad_norm': 1.1921645402908325, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.0008, 'grad_norm': 0.03440319746732712, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0407, 'grad_norm': 0.6723849177360535, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0847, 'grad_norm': 1.941558599472046, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.2144, 'grad_norm': 1.909002661705017, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it]                                               {'loss': 1.3389, 'grad_norm': 8.44298267364502, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.11s/it]                                               {'loss': 0.0315, 'grad_norm': 0.4092155992984772, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.11s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.67, 'grad_norm': 4.909014701843262, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.6552, 'grad_norm': 2.234975576400757, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.0225, 'grad_norm': 0.7439193725585938, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 78.006, 'train_samples_per_second': 7.243, 'train_steps_per_second': 0.513, 'train_loss': 1.317265299994324, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.95s/it]
CLIENT:15
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 6.8327, 'grad_norm': 6.413264751434326, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.3887, 'grad_norm': 4.640401840209961, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 3.2996, 'grad_norm': 4.146668434143066, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 3.2685, 'grad_norm': 14.956406593322754, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 3.6305, 'grad_norm': 8.107513427734375, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 3.394, 'grad_norm': 6.889499187469482, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 2.5153, 'grad_norm': 5.305399417877197, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.1704, 'grad_norm': 5.340385913848877, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.3223, 'grad_norm': 3.8656036853790283, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 0.6854, 'grad_norm': 3.444796323776245, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.7306, 'grad_norm': 5.056720733642578, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 1.3325, 'grad_norm': 8.850281715393066, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.9109, 'grad_norm': 11.356001853942871, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.6544, 'grad_norm': 8.274006843566895, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.8804, 'grad_norm': 7.760125637054443, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.006, 'grad_norm': 0.34301334619522095, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.5034, 'grad_norm': 2.6851906776428223, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.8421, 'grad_norm': 5.221607685089111, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.7475, 'grad_norm': 3.0517690181732178, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.9944, 'grad_norm': 5.679266452789307, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.2183, 'grad_norm': 1.3388937711715698, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.2797, 'grad_norm': 2.458735942840576, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 1.0072, 'grad_norm': 18.66609764099121, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.5809, 'grad_norm': 18.357582092285156, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 1.1078, 'grad_norm': 15.861661911010742, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.2052, 'grad_norm': 3.9706079959869385, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.0677, 'grad_norm': 0.7638503313064575, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.1996, 'grad_norm': 34.62065887451172, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.3204, 'grad_norm': 2.2677695751190186, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it]                                               {'loss': 0.505, 'grad_norm': 2.7090845108032227, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it]                                               {'loss': 0.4652, 'grad_norm': 4.997354507446289, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it] 80%|████████  | 32/40 [01:02<00:12,  1.56s/it]                                               {'loss': 0.0011, 'grad_norm': 0.05815233662724495, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.56s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.75s/it]                                               {'loss': 0.0755, 'grad_norm': 0.9334099292755127, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.75s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.89s/it]                                               {'loss': 0.2846, 'grad_norm': 1.961525797843933, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.89s/it] 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it]                                               {'loss': 0.0752, 'grad_norm': 1.3829121589660645, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.388, 'grad_norm': 5.550146579742432, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.11s/it]                                               {'loss': 0.5779, 'grad_norm': 3.219553232192993, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.11s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it]                                               {'loss': 0.3042, 'grad_norm': 20.233856201171875, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.0497, 'grad_norm': 3.7557730674743652, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.1751, 'grad_norm': 15.104830741882324, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 78.1458, 'train_samples_per_second': 7.23, 'train_steps_per_second': 0.512, 'train_loss': 1.1499503356724745, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.57s/it]100%|██████████| 40/40 [01:18<00:00,  1.95s/it]
CLIENT:38
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.9386, 'grad_norm': 5.669912338256836, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 5.1765, 'grad_norm': 5.31846809387207, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 3.2864, 'grad_norm': 4.7126617431640625, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 3.4685, 'grad_norm': 5.055465221405029, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 6.4507, 'grad_norm': 13.679121971130371, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.4439, 'grad_norm': 8.433198928833008, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 2.0568, 'grad_norm': 6.793282508850098, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:51,  1.62s/it]                                              {'loss': 2.7488, 'grad_norm': 16.549129486083984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:51,  1.62s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.80s/it]                                              {'loss': 0.8863, 'grad_norm': 3.684114694595337, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.80s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 1.8041, 'grad_norm': 4.34601354598999, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 1.4464, 'grad_norm': 4.865041255950928, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 1.9434, 'grad_norm': 5.712907791137695, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.15s/it]                                               {'loss': 1.8612, 'grad_norm': 6.438004970550537, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.15s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.19s/it]                                               {'loss': 1.8337, 'grad_norm': 6.391598701477051, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.19s/it] 38%|███▊      | 15/40 [00:31<00:56,  2.26s/it]                                               {'loss': 0.9666, 'grad_norm': 4.045204162597656, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:56,  2.26s/it] 40%|████      | 16/40 [00:32<00:41,  1.74s/it]                                               {'loss': 1.4338, 'grad_norm': 32.9547233581543, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:32<00:41,  1.74s/it] 42%|████▎     | 17/40 [00:34<00:43,  1.87s/it]                                               {'loss': 0.6382, 'grad_norm': 7.591130256652832, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:43,  1.87s/it] 45%|████▌     | 18/40 [00:36<00:43,  1.99s/it]                                               {'loss': 1.0096, 'grad_norm': 7.150545120239258, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:43,  1.99s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.07s/it]                                               {'loss': 0.2688, 'grad_norm': 2.156792163848877, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.07s/it] 50%|█████     | 20/40 [00:41<00:42,  2.13s/it]                                               {'loss': 0.9322, 'grad_norm': 5.915896892547607, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:41<00:42,  2.13s/it] 52%|█████▎    | 21/40 [00:43<00:40,  2.15s/it]                                               {'loss': 0.7693, 'grad_norm': 5.51473331451416, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:40,  2.15s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 0.7579, 'grad_norm': 6.780561923980713, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.2196, 'grad_norm': 2.535158634185791, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:48<00:26,  1.68s/it]                                               {'loss': 0.043, 'grad_norm': 2.09812593460083, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:48<00:26,  1.68s/it] 62%|██████▎   | 25/40 [00:50<00:28,  1.88s/it]                                               {'loss': 0.2929, 'grad_norm': 2.8173816204071045, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:28,  1.88s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.99s/it]                                               {'loss': 0.322, 'grad_norm': 3.4019827842712402, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.99s/it] 68%|██████▊   | 27/40 [00:55<00:27,  2.08s/it]                                               {'loss': 0.1782, 'grad_norm': 3.631260633468628, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:55<00:27,  2.08s/it] 70%|███████   | 28/40 [00:57<00:25,  2.15s/it]                                               {'loss': 0.1545, 'grad_norm': 1.5957248210906982, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:57<00:25,  2.15s/it] 72%|███████▎  | 29/40 [00:59<00:24,  2.19s/it]                                               {'loss': 0.1694, 'grad_norm': 1.9992284774780273, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:24,  2.19s/it] 75%|███████▌  | 30/40 [01:02<00:22,  2.23s/it]                                               {'loss': 0.0976, 'grad_norm': 3.371154546737671, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:02<00:22,  2.23s/it] 78%|███████▊  | 31/40 [01:04<00:20,  2.24s/it]                                               {'loss': 0.0554, 'grad_norm': 0.8543543219566345, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:04<00:20,  2.24s/it] 80%|████████  | 32/40 [01:04<00:13,  1.63s/it]                                               {'loss': 0.7972, 'grad_norm': 29.60779571533203, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:04<00:13,  1.63s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it]                                               {'loss': 0.0702, 'grad_norm': 1.0215177536010742, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.93s/it]                                               {'loss': 0.0393, 'grad_norm': 0.8378026485443115, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:11<00:10,  2.02s/it]                                               {'loss': 0.0904, 'grad_norm': 1.3207041025161743, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:11<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.08s/it]                                               {'loss': 0.4101, 'grad_norm': 7.969498157501221, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.20s/it]                                               {'loss': 0.2574, 'grad_norm': 7.483842372894287, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.20s/it] 95%|█████████▌| 38/40 [01:18<00:04,  2.22s/it]                                               {'loss': 0.0819, 'grad_norm': 1.3108024597167969, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:18<00:04,  2.22s/it] 98%|█████████▊| 39/40 [01:20<00:02,  2.23s/it]                                               {'loss': 0.0306, 'grad_norm': 0.5527642369270325, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:20<00:02,  2.23s/it]100%|██████████| 40/40 [01:20<00:00,  1.62s/it]                                               {'loss': 0.0062, 'grad_norm': 0.35681432485580444, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]                                               {'train_runtime': 80.9505, 'train_samples_per_second': 6.98, 'train_steps_per_second': 0.494, 'train_loss': 1.2859380924608559, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]100%|██████████| 40/40 [01:20<00:00,  2.02s/it]
CLIENT:11
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 4.523, 'grad_norm': 4.662634372711182, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]                                              {'loss': 4.4643, 'grad_norm': 4.442362308502197, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]  8%|▊         | 3/40 [00:06<01:17,  2.10s/it]                                              {'loss': 4.7967, 'grad_norm': 7.1336870193481445, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:17,  2.10s/it] 10%|█         | 4/40 [00:08<01:16,  2.11s/it]                                              {'loss': 3.4966, 'grad_norm': 4.7896881103515625, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.11s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it]                                              {'loss': 2.8536, 'grad_norm': 7.444461345672607, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it]                                              {'loss': 2.6691, 'grad_norm': 6.7518815994262695, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 3.3614, 'grad_norm': 10.07439136505127, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 5.11, 'grad_norm': 83.51002502441406, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:52,  1.71s/it]                                              {'loss': 0.6403, 'grad_norm': 3.9062087535858154, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:52,  1.71s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.8659, 'grad_norm': 5.185937404632568, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:55,  1.93s/it]                                               {'loss': 1.988, 'grad_norm': 11.739226341247559, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:55,  1.93s/it] 30%|███       | 12/40 [00:23<00:55,  1.99s/it]                                               {'loss': 1.2644, 'grad_norm': 7.845151901245117, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:55,  1.99s/it] 32%|███▎      | 13/40 [00:25<00:55,  2.05s/it]                                               {'loss': 0.9173, 'grad_norm': 4.285117149353027, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:25<00:55,  2.05s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 1.4938, 'grad_norm': 7.628273963928223, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:52,  2.11s/it]                                               {'loss': 2.008, 'grad_norm': 11.64892578125, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:52,  2.11s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 0.0, 'grad_norm': 0.0014638007851317525, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.72s/it]                                               {'loss': 0.8969, 'grad_norm': 4.104039669036865, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.72s/it] 45%|████▌     | 18/40 [00:34<00:40,  1.85s/it]                                               {'loss': 0.7012, 'grad_norm': 2.837214946746826, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:40,  1.85s/it] 48%|████▊     | 19/40 [00:36<00:40,  1.95s/it]                                               {'loss': 0.868, 'grad_norm': 13.123783111572266, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:36<00:40,  1.95s/it] 50%|█████     | 20/40 [00:39<00:40,  2.03s/it]                                               {'loss': 0.6845, 'grad_norm': 5.718154430389404, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.03s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 1.1499, 'grad_norm': 20.755666732788086, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.6358, 'grad_norm': 14.828810691833496, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it]                                               {'loss': 0.6299, 'grad_norm': 6.680056095123291, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it] 60%|██████    | 24/40 [00:45<00:24,  1.56s/it]                                               {'loss': 0.3824, 'grad_norm': 6.240126609802246, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:45<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.6805, 'grad_norm': 8.084391593933105, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.8154, 'grad_norm': 7.373332500457764, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it]                                               {'loss': 0.5, 'grad_norm': 6.4312744140625, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it] 70%|███████   | 28/40 [00:54<00:24,  2.06s/it]                                               {'loss': 0.3098, 'grad_norm': 2.914921998977661, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:56<00:23,  2.10s/it]                                               {'loss': 0.4465, 'grad_norm': 3.7244813442230225, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:56<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it]                                               {'loss': 0.5513, 'grad_norm': 3.6742289066314697, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.12s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it]                                               {'loss': 0.1312, 'grad_norm': 2.358478546142578, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it] 80%|████████  | 32/40 [01:01<00:12,  1.56s/it]                                               {'loss': 0.0077, 'grad_norm': 0.35237377882003784, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.56s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.75s/it]                                               {'loss': 0.0603, 'grad_norm': 1.0763587951660156, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.75s/it] 85%|████████▌ | 34/40 [01:05<00:11,  1.89s/it]                                               {'loss': 0.4946, 'grad_norm': 3.6559600830078125, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:05<00:11,  1.89s/it] 88%|████████▊ | 35/40 [01:08<00:09,  1.99s/it]                                               {'loss': 0.5231, 'grad_norm': 6.114195346832275, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  1.99s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.05s/it]                                               {'loss': 0.164, 'grad_norm': 1.870343565940857, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.05s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.10s/it]                                               {'loss': 0.2194, 'grad_norm': 3.5038468837738037, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.10s/it] 95%|█████████▌| 38/40 [01:14<00:04,  2.14s/it]                                               {'loss': 0.4959, 'grad_norm': 3.395637273788452, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:14<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:16<00:02,  2.15s/it]                                               {'loss': 0.7208, 'grad_norm': 8.040884017944336, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:16<00:02,  2.15s/it]100%|██████████| 40/40 [01:17<00:00,  1.56s/it]                                               {'loss': 0.6213, 'grad_norm': 10.71502685546875, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.56s/it]                                               {'train_runtime': 77.465, 'train_samples_per_second': 7.294, 'train_steps_per_second': 0.516, 'train_loss': 1.3535723310798857, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.56s/it]100%|██████████| 40/40 [01:17<00:00,  1.94s/it]
CLIENT:40
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 4.3903, 'grad_norm': 4.013658046722412, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 5.5184, 'grad_norm': 5.928287982940674, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 3.787, 'grad_norm': 6.5135817527771, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.2744, 'grad_norm': 7.898461818695068, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 4.3624, 'grad_norm': 15.430320739746094, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 2.8152, 'grad_norm': 6.117354393005371, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 3.8907, 'grad_norm': 6.430967330932617, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 2.9981, 'grad_norm': 28.286237716674805, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.8907, 'grad_norm': 4.956063747406006, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.0114, 'grad_norm': 4.46850061416626, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.0925, 'grad_norm': 4.87054443359375, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.6703, 'grad_norm': 4.217964172363281, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.7828, 'grad_norm': 3.846592903137207, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.0697, 'grad_norm': 5.065412998199463, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.8252, 'grad_norm': 4.650410175323486, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.1038, 'grad_norm': 2.760080099105835, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.3356, 'grad_norm': 1.274621844291687, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.5507, 'grad_norm': 4.250413417816162, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.5368, 'grad_norm': 1.9565491676330566, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.6733, 'grad_norm': 4.037421226501465, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.5264, 'grad_norm': 3.2574398517608643, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.3203, 'grad_norm': 2.589193105697632, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.3224, 'grad_norm': 2.6136674880981445, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0008, 'grad_norm': 0.02934364043176174, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.1219, 'grad_norm': 1.427935242652893, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.4645, 'grad_norm': 4.7257771492004395, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.4991, 'grad_norm': 3.6147706508636475, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.2222, 'grad_norm': 1.8948352336883545, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.3562, 'grad_norm': 2.6901681423187256, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.0581, 'grad_norm': 0.8035888671875, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.164, 'grad_norm': 1.5070737600326538, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.3021, 'grad_norm': 6.87370491027832, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.2151, 'grad_norm': 2.7393572330474854, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.1699, 'grad_norm': 0.9255126714706421, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it]                                               {'loss': 0.0957, 'grad_norm': 13.472553253173828, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.06s/it]                                               {'loss': 0.3274, 'grad_norm': 1.3167599439620972, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.3578, 'grad_norm': 3.240023374557495, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.3743, 'grad_norm': 2.7483465671539307, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]                                               {'loss': 0.0831, 'grad_norm': 4.219605922698975, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0049, 'grad_norm': 0.23948654532432556, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.4301, 'train_samples_per_second': 7.204, 'train_steps_per_second': 0.51, 'train_loss': 1.139130065064819, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:45
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 3.8178, 'grad_norm': 5.80488395690918, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 4.3517, 'grad_norm': 6.969078063964844, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 3.6713, 'grad_norm': 3.844367027282715, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 1.4597, 'grad_norm': 4.8494181632995605, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.5125, 'grad_norm': 7.63635778427124, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 3.599, 'grad_norm': 15.569787979125977, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 4.1468, 'grad_norm': 15.052007675170898, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 7.0648, 'grad_norm': 43.0806884765625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.4752, 'grad_norm': 4.749885559082031, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.8214, 'grad_norm': 9.141651153564453, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.5113, 'grad_norm': 21.539230346679688, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.7433, 'grad_norm': 5.235266208648682, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.7353, 'grad_norm': 9.781458854675293, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.6845, 'grad_norm': 4.068484306335449, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 1.3473, 'grad_norm': 9.747883796691895, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0196, 'grad_norm': 1.3408535718917847, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.7692, 'grad_norm': 6.803264141082764, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.2702, 'grad_norm': 2.057067632675171, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.4627, 'grad_norm': 4.200984477996826, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.4119, 'grad_norm': 2.886796236038208, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.11s/it]                                               {'loss': 1.0891, 'grad_norm': 5.620352745056152, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.1773, 'grad_norm': 1.3861031532287598, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it]                                               {'loss': 0.3671, 'grad_norm': 3.2049741744995117, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0122, 'grad_norm': 0.6840417385101318, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.3318, 'grad_norm': 2.9476897716522217, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.2387, 'grad_norm': 1.9177074432373047, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.5746, 'grad_norm': 19.572734832763672, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.08s/it]                                               {'loss': 0.4224, 'grad_norm': 5.666098594665527, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.1366, 'grad_norm': 2.050166368484497, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.443, 'grad_norm': 3.9059462547302246, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.4325, 'grad_norm': 4.19996976852417, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.223, 'grad_norm': 9.403637886047363, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0297, 'grad_norm': 0.6811490058898926, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0914, 'grad_norm': 0.9926652908325195, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.1561, 'grad_norm': 2.999370813369751, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.2014, 'grad_norm': 2.7920024394989014, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.1507, 'grad_norm': 1.4415415525436401, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.5723, 'grad_norm': 4.895101547241211, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.3613, 'grad_norm': 5.391615390777588, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.1626, 'grad_norm': 5.034711837768555, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.9334, 'train_samples_per_second': 7.158, 'train_steps_per_second': 0.507, 'train_loss': 1.2012292057508602, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 4.2497, 'grad_norm': 4.6562819480896, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.13s/it]                                              {'loss': 3.0917, 'grad_norm': 4.856112003326416, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.13s/it]  8%|▊         | 3/40 [00:06<01:18,  2.11s/it]                                              {'loss': 4.071, 'grad_norm': 5.147082328796387, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.11s/it] 10%|█         | 4/40 [00:08<01:16,  2.12s/it]                                              {'loss': 4.1898, 'grad_norm': 8.131336212158203, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.12s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.13s/it]                                              {'loss': 3.0792, 'grad_norm': 4.7950921058654785, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.13s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it]                                              {'loss': 1.8106, 'grad_norm': 5.863949775695801, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it] 18%|█▊        | 7/40 [00:14<01:11,  2.16s/it]                                              {'loss': 2.3463, 'grad_norm': 12.32481575012207, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 1.8936, 'grad_norm': 76.66539764404297, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.2393, 'grad_norm': 14.992738723754883, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.1368, 'grad_norm': 30.750656127929688, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it]                                               {'loss': 1.2788, 'grad_norm': 8.035151481628418, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.94s/it] 30%|███       | 12/40 [00:23<00:56,  2.01s/it]                                               {'loss': 0.3578, 'grad_norm': 3.931539535522461, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.01s/it] 32%|███▎      | 13/40 [00:25<00:55,  2.05s/it]                                               {'loss': 1.2339, 'grad_norm': 10.247693061828613, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:25<00:55,  2.05s/it] 35%|███▌      | 14/40 [00:28<00:53,  2.07s/it]                                               {'loss': 0.8956, 'grad_norm': 4.965729713439941, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:53,  2.07s/it] 38%|███▊      | 15/40 [00:30<00:52,  2.10s/it]                                               {'loss': 1.302, 'grad_norm': 3.4278807640075684, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:52,  2.10s/it] 40%|████      | 16/40 [00:30<00:36,  1.52s/it]                                               {'loss': 0.0879, 'grad_norm': 2.0113871097564697, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.52s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.70s/it]                                               {'loss': 0.7301, 'grad_norm': 3.911123275756836, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.70s/it] 45%|████▌     | 18/40 [00:34<00:40,  1.85s/it]                                               {'loss': 0.3655, 'grad_norm': 2.429685592651367, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:40,  1.85s/it] 48%|████▊     | 19/40 [00:36<00:40,  1.93s/it]                                               {'loss': 0.6103, 'grad_norm': 2.93798565864563, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:36<00:40,  1.93s/it] 50%|█████     | 20/40 [00:38<00:40,  2.00s/it]                                               {'loss': 0.3529, 'grad_norm': 3.3184027671813965, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:38<00:40,  2.00s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it]                                               {'loss': 0.8592, 'grad_norm': 13.562665939331055, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.5843, 'grad_norm': 7.206033229827881, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it]                                               {'loss': 0.4642, 'grad_norm': 4.383847713470459, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it] 60%|██████    | 24/40 [00:45<00:24,  1.55s/it]                                               {'loss': 0.0054, 'grad_norm': 0.3274960517883301, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:45<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:47<00:26,  1.74s/it]                                               {'loss': 0.4214, 'grad_norm': 2.5217206478118896, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:47<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.4407, 'grad_norm': 3.905618667602539, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it]                                               {'loss': 0.0786, 'grad_norm': 1.4339995384216309, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it] 70%|███████   | 28/40 [00:54<00:24,  2.06s/it]                                               {'loss': 0.128, 'grad_norm': 2.06758189201355, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:56<00:23,  2.11s/it]                                               {'loss': 0.0428, 'grad_norm': 1.1789765357971191, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:56<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.3177, 'grad_norm': 8.163707733154297, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it]                                               {'loss': 0.2955, 'grad_norm': 5.905917167663574, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it] 80%|████████  | 32/40 [01:01<00:13,  1.63s/it]                                               {'loss': 0.4144, 'grad_norm': 16.660722732543945, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:13,  1.63s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.80s/it]                                               {'loss': 0.0366, 'grad_norm': 1.3395614624023438, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.1368, 'grad_norm': 2.1277101039886475, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it]                                               {'loss': 0.1296, 'grad_norm': 7.019414901733398, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.09s/it]                                               {'loss': 0.046, 'grad_norm': 0.6688177585601807, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.15s/it]                                               {'loss': 0.3082, 'grad_norm': 10.272482872009277, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.19s/it]                                               {'loss': 0.8246, 'grad_norm': 7.627788543701172, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.23s/it]                                               {'loss': 0.3082, 'grad_norm': 2.4703052043914795, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.23s/it]100%|██████████| 40/40 [01:18<00:00,  1.72s/it]                                               {'loss': 0.0006, 'grad_norm': 0.030870378017425537, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.72s/it]                                               {'train_runtime': 78.5904, 'train_samples_per_second': 7.189, 'train_steps_per_second': 0.509, 'train_loss': 1.0041449201482464, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.72s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:62
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 5.5456, 'grad_norm': 6.320042610168457, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 3.9122, 'grad_norm': 8.056248664855957, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 3.5319, 'grad_norm': 5.510392665863037, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 5.094, 'grad_norm': 9.962912559509277, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 3.19, 'grad_norm': 6.981781482696533, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 3.6393, 'grad_norm': 7.332420349121094, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 4.5421, 'grad_norm': 19.063968658447266, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 2.1528, 'grad_norm': 38.31168746948242, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 2.1636, 'grad_norm': 11.077147483825684, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.3173, 'grad_norm': 7.862552165985107, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.8576, 'grad_norm': 29.317646026611328, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.3293, 'grad_norm': 7.399502754211426, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 1.2024, 'grad_norm': 7.295110702514648, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.0934, 'grad_norm': 8.496647834777832, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.9437, 'grad_norm': 6.7458600997924805, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 3.2414, 'grad_norm': 26.432342529296875, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 1.3999, 'grad_norm': 18.638681411743164, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.5156, 'grad_norm': 5.452267646789551, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.6505, 'grad_norm': 3.8784923553466797, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 1.4805, 'grad_norm': 8.484729766845703, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.2604, 'grad_norm': 2.1927430629730225, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.4141, 'grad_norm': 3.581742286682129, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.957, 'grad_norm': 6.66282320022583, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0775, 'grad_norm': 4.852089881896973, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.331, 'grad_norm': 3.094149351119995, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.3649, 'grad_norm': 6.697093963623047, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it]                                               {'loss': 0.4332, 'grad_norm': 7.879762649536133, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.3052, 'grad_norm': 5.037558078765869, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.079, 'grad_norm': 1.3176380395889282, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.3505, 'grad_norm': 5.397746562957764, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.9005, 'grad_norm': 11.625031471252441, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 3.2795, 'grad_norm': 61.77505874633789, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.3671, 'grad_norm': 6.527969837188721, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.5688, 'grad_norm': 11.59819507598877, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.3733, 'grad_norm': 8.03902816772461, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.7053, 'grad_norm': 16.504501342773438, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.2243, 'grad_norm': 4.359306335449219, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.5711, 'grad_norm': 15.127391815185547, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]                                               {'loss': 0.6217, 'grad_norm': 17.382375717163086, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.9737, 'grad_norm': 29.996191024780273, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.4183, 'train_samples_per_second': 7.205, 'train_steps_per_second': 0.51, 'train_loss': 1.54903463460505, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:54,  1.59it/s]  1%|          | 3/471 [00:02<06:56,  1.12it/s]  1%|          | 4/471 [00:03<08:01,  1.03s/it]  1%|          | 5/471 [00:05<08:39,  1.11s/it]  1%|▏         | 6/471 [00:06<09:01,  1.16s/it]  1%|▏         | 7/471 [00:07<09:16,  1.20s/it]  2%|▏         | 8/471 [00:08<09:26,  1.22s/it]  2%|▏         | 9/471 [00:10<09:32,  1.24s/it]  2%|▏         | 10/471 [00:11<09:36,  1.25s/it]  2%|▏         | 11/471 [00:12<09:38,  1.26s/it]  3%|▎         | 12/471 [00:13<09:40,  1.26s/it]  3%|▎         | 13/471 [00:15<09:41,  1.27s/it]  3%|▎         | 14/471 [00:16<09:42,  1.27s/it]  3%|▎         | 15/471 [00:17<09:42,  1.28s/it]  3%|▎         | 16/471 [00:19<09:42,  1.28s/it]  4%|▎         | 17/471 [00:20<09:42,  1.28s/it]  4%|▍         | 18/471 [00:21<09:42,  1.29s/it]  4%|▍         | 19/471 [00:22<09:41,  1.29s/it]  4%|▍         | 20/471 [00:24<09:41,  1.29s/it]  4%|▍         | 21/471 [00:25<09:40,  1.29s/it]  5%|▍         | 22/471 [00:26<09:39,  1.29s/it]  5%|▍         | 23/471 [00:28<09:38,  1.29s/it]  5%|▌         | 24/471 [00:29<09:38,  1.29s/it]  5%|▌         | 25/471 [00:30<09:37,  1.29s/it]  6%|▌         | 26/471 [00:32<09:36,  1.29s/it]  6%|▌         | 27/471 [00:33<09:35,  1.30s/it]  6%|▌         | 28/471 [00:34<09:34,  1.30s/it]  6%|▌         | 29/471 [00:35<09:33,  1.30s/it]  6%|▋         | 30/471 [00:37<09:33,  1.30s/it]  7%|▋         | 31/471 [00:38<09:31,  1.30s/it]  7%|▋         | 32/471 [00:39<09:30,  1.30s/it]  7%|▋         | 33/471 [00:41<09:28,  1.30s/it]  7%|▋         | 34/471 [00:42<09:27,  1.30s/it]  7%|▋         | 35/471 [00:43<09:27,  1.30s/it]  8%|▊         | 36/471 [00:45<09:26,  1.30s/it]  8%|▊         | 37/471 [00:46<09:26,  1.30s/it]  8%|▊         | 38/471 [00:47<09:25,  1.31s/it]  8%|▊         | 39/471 [00:48<09:23,  1.30s/it]  8%|▊         | 40/471 [00:50<09:22,  1.30s/it]  9%|▊         | 41/471 [00:51<09:21,  1.31s/it]  9%|▉         | 42/471 [00:52<09:20,  1.31s/it]  9%|▉         | 43/471 [00:54<09:18,  1.30s/it]  9%|▉         | 44/471 [00:55<09:17,  1.31s/it] 10%|▉         | 45/471 [00:56<09:16,  1.31s/it] 10%|▉         | 46/471 [00:58<09:14,  1.31s/it] 10%|▉         | 47/471 [00:59<09:13,  1.31s/it] 10%|█         | 48/471 [01:00<09:12,  1.31s/it] 10%|█         | 49/471 [01:02<09:11,  1.31s/it] 11%|█         | 50/471 [01:03<09:10,  1.31s/it] 11%|█         | 51/471 [01:04<09:09,  1.31s/it] 11%|█         | 52/471 [01:05<09:08,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:07,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:06,  1.31s/it] 12%|█▏        | 55/471 [01:09<09:05,  1.31s/it] 12%|█▏        | 56/471 [01:11<09:05,  1.31s/it] 12%|█▏        | 57/471 [01:12<09:03,  1.31s/it] 12%|█▏        | 58/471 [01:13<09:02,  1.31s/it] 13%|█▎        | 59/471 [01:15<09:00,  1.31s/it] 13%|█▎        | 60/471 [01:16<08:59,  1.31s/it] 13%|█▎        | 61/471 [01:17<08:58,  1.31s/it] 13%|█▎        | 62/471 [01:19<08:56,  1.31s/it] 13%|█▎        | 63/471 [01:20<08:55,  1.31s/it] 14%|█▎        | 64/471 [01:21<08:54,  1.31s/it] 14%|█▍        | 65/471 [01:23<08:52,  1.31s/it] 14%|█▍        | 66/471 [01:24<08:51,  1.31s/it] 14%|█▍        | 67/471 [01:25<08:50,  1.31s/it] 14%|█▍        | 68/471 [01:26<08:48,  1.31s/it] 15%|█▍        | 69/471 [01:28<08:47,  1.31s/it] 15%|█▍        | 70/471 [01:29<08:47,  1.31s/it] 15%|█▌        | 71/471 [01:30<08:45,  1.31s/it] 15%|█▌        | 72/471 [01:32<08:44,  1.31s/it] 15%|█▌        | 73/471 [01:33<08:42,  1.31s/it] 16%|█▌        | 74/471 [01:34<08:40,  1.31s/it] 16%|█▌        | 75/471 [01:36<08:40,  1.31s/it] 16%|█▌        | 76/471 [01:37<08:39,  1.31s/it] 16%|█▋        | 77/471 [01:38<08:37,  1.31s/it] 17%|█▋        | 78/471 [01:40<08:36,  1.32s/it] 17%|█▋        | 79/471 [01:41<08:36,  1.32s/it] 17%|█▋        | 80/471 [01:42<08:35,  1.32s/it] 17%|█▋        | 81/471 [01:44<08:33,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:32,  1.32s/it] 18%|█▊        | 83/471 [01:46<08:30,  1.32s/it] 18%|█▊        | 84/471 [01:48<08:29,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:28,  1.32s/it] 18%|█▊        | 86/471 [01:50<08:27,  1.32s/it] 18%|█▊        | 87/471 [01:51<08:25,  1.32s/it] 19%|█▊        | 88/471 [01:53<08:24,  1.32s/it] 19%|█▉        | 89/471 [01:54<08:22,  1.32s/it] 19%|█▉        | 90/471 [01:55<08:22,  1.32s/it] 19%|█▉        | 91/471 [01:57<08:20,  1.32s/it] 20%|█▉        | 92/471 [01:58<08:19,  1.32s/it] 20%|█▉        | 93/471 [01:59<08:18,  1.32s/it] 20%|█▉        | 94/471 [02:01<08:17,  1.32s/it] 20%|██        | 95/471 [02:02<08:16,  1.32s/it] 20%|██        | 96/471 [02:03<08:15,  1.32s/it] 21%|██        | 97/471 [02:05<08:14,  1.32s/it] 21%|██        | 98/471 [02:06<08:12,  1.32s/it] 21%|██        | 99/471 [02:07<08:11,  1.32s/it] 21%|██        | 100/471 [02:09<08:09,  1.32s/it] 21%|██▏       | 101/471 [02:10<08:08,  1.32s/it] 22%|██▏       | 102/471 [02:11<08:07,  1.32s/it] 22%|██▏       | 103/471 [02:13<08:06,  1.32s/it] 22%|██▏       | 104/471 [02:14<08:06,  1.33s/it] 22%|██▏       | 105/471 [02:15<08:04,  1.32s/it] 23%|██▎       | 106/471 [02:17<08:02,  1.32s/it] 23%|██▎       | 107/471 [02:18<08:01,  1.32s/it] 23%|██▎       | 108/471 [02:19<07:59,  1.32s/it] 23%|██▎       | 109/471 [02:21<07:57,  1.32s/it] 23%|██▎       | 110/471 [02:22<07:55,  1.32s/it] 24%|██▎       | 111/471 [02:23<07:55,  1.32s/it] 24%|██▍       | 112/471 [02:24<07:54,  1.32s/it] 24%|██▍       | 113/471 [02:26<07:52,  1.32s/it] 24%|██▍       | 114/471 [02:27<07:51,  1.32s/it] 24%|██▍       | 115/471 [02:28<07:50,  1.32s/it] 25%|██▍       | 116/471 [02:30<07:49,  1.32s/it] 25%|██▍       | 117/471 [02:31<07:47,  1.32s/it] 25%|██▌       | 118/471 [02:32<07:46,  1.32s/it] 25%|██▌       | 119/471 [02:34<07:45,  1.32s/it] 25%|██▌       | 120/471 [02:35<07:44,  1.32s/it] 26%|██▌       | 121/471 [02:36<07:43,  1.32s/it] 26%|██▌       | 122/471 [02:38<07:41,  1.32s/it] 26%|██▌       | 123/471 [02:39<07:40,  1.32s/it] 26%|██▋       | 124/471 [02:40<07:39,  1.32s/it] 27%|██▋       | 125/471 [02:42<07:37,  1.32s/it] 27%|██▋       | 126/471 [02:43<07:36,  1.32s/it] 27%|██▋       | 127/471 [02:44<07:35,  1.32s/it] 27%|██▋       | 128/471 [02:46<07:33,  1.32s/it] 27%|██▋       | 129/471 [02:47<07:32,  1.32s/it] 28%|██▊       | 130/471 [02:48<07:29,  1.32s/it] 28%|██▊       | 131/471 [02:50<07:29,  1.32s/it] 28%|██▊       | 132/471 [02:51<07:27,  1.32s/it] 28%|██▊       | 133/471 [02:52<07:26,  1.32s/it] 28%|██▊       | 134/471 [02:54<07:26,  1.32s/it] 29%|██▊       | 135/471 [02:55<07:24,  1.32s/it] 29%|██▉       | 136/471 [02:56<07:23,  1.32s/it] 29%|██▉       | 137/471 [02:58<07:21,  1.32s/it] 29%|██▉       | 138/471 [02:59<07:20,  1.32s/it] 30%|██▉       | 139/471 [03:00<07:19,  1.32s/it] 30%|██▉       | 140/471 [03:02<07:17,  1.32s/it] 30%|██▉       | 141/471 [03:03<07:15,  1.32s/it] 30%|███       | 142/471 [03:04<07:14,  1.32s/it] 30%|███       | 143/471 [03:05<07:12,  1.32s/it] 31%|███       | 144/471 [03:07<07:12,  1.32s/it] 31%|███       | 145/471 [03:08<07:10,  1.32s/it] 31%|███       | 146/471 [03:09<07:09,  1.32s/it] 31%|███       | 147/471 [03:11<07:08,  1.32s/it] 31%|███▏      | 148/471 [03:12<07:07,  1.32s/it] 32%|███▏      | 149/471 [03:13<07:06,  1.32s/it] 32%|███▏      | 150/471 [03:15<07:05,  1.32s/it] 32%|███▏      | 151/471 [03:16<07:03,  1.32s/it] 32%|███▏      | 152/471 [03:17<07:01,  1.32s/it] 32%|███▏      | 153/471 [03:19<07:00,  1.32s/it] 33%|███▎      | 154/471 [03:20<06:58,  1.32s/it] 33%|███▎      | 155/471 [03:21<06:57,  1.32s/it] 33%|███▎      | 156/471 [03:23<06:56,  1.32s/it] 33%|███▎      | 157/471 [03:24<06:54,  1.32s/it] 34%|███▎      | 158/471 [03:25<06:53,  1.32s/it] 34%|███▍      | 159/471 [03:27<06:51,  1.32s/it] 34%|███▍      | 160/471 [03:28<06:51,  1.32s/it] 34%|███▍      | 161/471 [03:29<06:49,  1.32s/it] 34%|███▍      | 162/471 [03:31<06:48,  1.32s/it] 35%|███▍      | 163/471 [03:32<06:48,  1.32s/it] 35%|███▍      | 164/471 [03:33<06:46,  1.32s/it] 35%|███▌      | 165/471 [03:35<06:45,  1.33s/it] 35%|███▌      | 166/471 [03:36<06:44,  1.33s/it] 35%|███▌      | 167/471 [03:37<06:43,  1.33s/it] 36%|███▌      | 168/471 [03:39<06:41,  1.33s/it] 36%|███▌      | 169/471 [03:40<06:40,  1.33s/it] 36%|███▌      | 170/471 [03:41<06:39,  1.33s/it] 36%|███▋      | 171/471 [03:43<06:38,  1.33s/it] 37%|███▋      | 172/471 [03:44<06:36,  1.33s/it] 37%|███▋      | 173/471 [03:45<06:35,  1.33s/it] 37%|███▋      | 174/471 [03:47<06:33,  1.33s/it] 37%|███▋      | 175/471 [03:48<06:32,  1.33s/it] 37%|███▋      | 176/471 [03:49<06:30,  1.32s/it] 38%|███▊      | 177/471 [03:50<06:30,  1.33s/it] 38%|███▊      | 178/471 [03:52<06:28,  1.33s/it] 38%|███▊      | 179/471 [03:53<06:27,  1.33s/it] 38%|███▊      | 180/471 [03:54<06:25,  1.33s/it] 38%|███▊      | 181/471 [03:56<06:24,  1.33s/it] 39%|███▊      | 182/471 [03:57<06:23,  1.33s/it] 39%|███▉      | 183/471 [03:58<06:22,  1.33s/it] 39%|███▉      | 184/471 [04:00<06:21,  1.33s/it] 39%|███▉      | 185/471 [04:01<06:20,  1.33s/it] 39%|███▉      | 186/471 [04:02<06:19,  1.33s/it] 40%|███▉      | 187/471 [04:04<06:19,  1.34s/it] 40%|███▉      | 188/471 [04:05<06:17,  1.33s/it] 40%|████      | 189/471 [04:06<06:15,  1.33s/it] 40%|████      | 190/471 [04:08<06:14,  1.33s/it] 41%|████      | 191/471 [04:09<06:13,  1.33s/it] 41%|████      | 192/471 [04:10<06:12,  1.33s/it] 41%|████      | 193/471 [04:12<06:10,  1.33s/it] 41%|████      | 194/471 [04:13<06:09,  1.33s/it] 41%|████▏     | 195/471 [04:14<06:08,  1.33s/it] 42%|████▏     | 196/471 [04:16<06:06,  1.33s/it] 42%|████▏     | 197/471 [04:17<06:04,  1.33s/it] 42%|████▏     | 198/471 [04:18<06:03,  1.33s/it] 42%|████▏     | 199/471 [04:20<06:03,  1.33s/it] 42%|████▏     | 200/471 [04:21<06:01,  1.33s/it] 43%|████▎     | 201/471 [04:22<05:59,  1.33s/it] 43%|████▎     | 202/471 [04:24<05:59,  1.34s/it] 43%|████▎     | 203/471 [04:25<05:58,  1.34s/it] 43%|████▎     | 204/471 [04:26<05:56,  1.34s/it] 44%|████▎     | 205/471 [04:28<05:55,  1.34s/it] 44%|████▎     | 206/471 [04:29<05:54,  1.34s/it] 44%|████▍     | 207/471 [04:30<05:53,  1.34s/it] 44%|████▍     | 208/471 [04:32<05:51,  1.34s/it] 44%|████▍     | 209/471 [04:33<05:50,  1.34s/it] 45%|████▍     | 210/471 [04:35<05:48,  1.34s/it] 45%|████▍     | 211/471 [04:36<05:47,  1.34s/it] 45%|████▌     | 212/471 [04:37<05:47,  1.34s/it] 45%|████▌     | 213/471 [04:39<05:45,  1.34s/it] 45%|████▌     | 214/471 [04:40<05:43,  1.34s/it] 46%|████▌     | 215/471 [04:41<05:41,  1.34s/it] 46%|████▌     | 216/471 [04:43<05:41,  1.34s/it] 46%|████▌     | 217/471 [04:44<05:40,  1.34s/it] 46%|████▋     | 218/471 [04:45<05:38,  1.34s/it] 46%|████▋     | 219/471 [04:47<05:37,  1.34s/it] 47%|████▋     | 220/471 [04:48<05:36,  1.34s/it] 47%|████▋     | 221/471 [04:49<05:35,  1.34s/it] 47%|████▋     | 222/471 [04:51<05:33,  1.34s/it] 47%|████▋     | 223/471 [04:52<05:31,  1.34s/it] 48%|████▊     | 224/471 [04:53<05:30,  1.34s/it] 48%|████▊     | 225/471 [04:55<05:29,  1.34s/it] 48%|████▊     | 226/471 [04:56<05:28,  1.34s/it] 48%|████▊     | 227/471 [04:57<05:26,  1.34s/it] 48%|████▊     | 228/471 [04:59<05:25,  1.34s/it] 49%|████▊     | 229/471 [05:00<05:23,  1.34s/it] 49%|████▉     | 230/471 [05:01<05:23,  1.34s/it] 49%|████▉     | 231/471 [05:03<05:21,  1.34s/it] 49%|████▉     | 232/471 [05:04<05:19,  1.33s/it] 49%|████▉     | 233/471 [05:05<05:18,  1.34s/it] 50%|████▉     | 234/471 [05:07<05:17,  1.34s/it] 50%|████▉     | 235/471 [05:08<05:16,  1.34s/it] 50%|█████     | 236/471 [05:09<05:13,  1.33s/it] 50%|█████     | 237/471 [05:11<05:11,  1.33s/it] 51%|█████     | 238/471 [05:12<05:10,  1.33s/it] 51%|█████     | 239/471 [05:13<05:11,  1.34s/it] 51%|█████     | 240/471 [05:15<05:09,  1.34s/it] 51%|█████     | 241/471 [05:16<05:07,  1.34s/it] 51%|█████▏    | 242/471 [05:17<05:06,  1.34s/it] 52%|█████▏    | 243/471 [05:19<05:04,  1.33s/it] 52%|█████▏    | 244/471 [05:20<05:02,  1.33s/it] 52%|█████▏    | 245/471 [05:21<05:01,  1.33s/it] 52%|█████▏    | 246/471 [05:23<04:59,  1.33s/it] 52%|█████▏    | 247/471 [05:24<04:57,  1.33s/it] 53%|█████▎    | 248/471 [05:25<04:56,  1.33s/it] 53%|█████▎    | 249/471 [05:27<04:55,  1.33s/it] 53%|█████▎    | 250/471 [05:28<04:53,  1.33s/it] 53%|█████▎    | 251/471 [05:29<04:52,  1.33s/it] 54%|█████▎    | 252/471 [05:31<04:51,  1.33s/it] 54%|█████▎    | 253/471 [05:32<04:50,  1.33s/it] 54%|█████▍    | 254/471 [05:33<04:48,  1.33s/it] 54%|█████▍    | 255/471 [05:35<04:47,  1.33s/it] 54%|█████▍    | 256/471 [05:36<04:45,  1.33s/it] 55%|█████▍    | 257/471 [05:37<04:44,  1.33s/it] 55%|█████▍    | 258/471 [05:39<04:43,  1.33s/it] 55%|█████▍    | 259/471 [05:40<04:41,  1.33s/it] 55%|█████▌    | 260/471 [05:41<04:40,  1.33s/it] 55%|█████▌    | 261/471 [05:43<04:38,  1.33s/it] 56%|█████▌    | 262/471 [05:44<04:37,  1.33s/it] 56%|█████▌    | 263/471 [05:45<04:36,  1.33s/it] 56%|█████▌    | 264/471 [05:47<04:35,  1.33s/it] 56%|█████▋    | 265/471 [05:48<04:33,  1.33s/it] 56%|█████▋    | 266/471 [05:49<04:32,  1.33s/it] 57%|█████▋    | 267/471 [05:51<04:31,  1.33s/it] 57%|█████▋    | 268/471 [05:52<04:29,  1.33s/it] 57%|█████▋    | 269/471 [05:53<04:29,  1.33s/it] 57%|█████▋    | 270/471 [05:55<04:27,  1.33s/it] 58%|█████▊    | 271/471 [05:56<04:25,  1.33s/it] 58%|█████▊    | 272/471 [05:57<04:23,  1.32s/it] 58%|█████▊    | 273/471 [05:59<04:22,  1.33s/it] 58%|█████▊    | 274/471 [06:00<04:20,  1.32s/it] 58%|█████▊    | 275/471 [06:01<04:19,  1.32s/it] 59%|█████▊    | 276/471 [06:03<04:18,  1.32s/it] 59%|█████▉    | 277/471 [06:04<04:17,  1.32s/it] 59%|█████▉    | 278/471 [06:05<04:15,  1.33s/it] 59%|█████▉    | 279/471 [06:06<04:14,  1.32s/it] 59%|█████▉    | 280/471 [06:08<04:12,  1.32s/it] 60%|█████▉    | 281/471 [06:09<04:11,  1.32s/it] 60%|█████▉    | 282/471 [06:10<04:10,  1.32s/it] 60%|██████    | 283/471 [06:12<04:09,  1.33s/it] 60%|██████    | 284/471 [06:13<04:07,  1.32s/it] 61%|██████    | 285/471 [06:14<04:06,  1.33s/it] 61%|██████    | 286/471 [06:16<04:05,  1.33s/it] 61%|██████    | 287/471 [06:17<04:04,  1.33s/it] 61%|██████    | 288/471 [06:18<04:02,  1.33s/it] 61%|██████▏   | 289/471 [06:20<04:00,  1.32s/it] 62%|██████▏   | 290/471 [06:21<03:59,  1.32s/it] 62%|██████▏   | 291/471 [06:22<03:58,  1.32s/it] 62%|██████▏   | 292/471 [06:24<03:56,  1.32s/it] 62%|██████▏   | 293/471 [06:25<03:55,  1.32s/it] 62%|██████▏   | 294/471 [06:26<03:54,  1.32s/it] 63%|██████▎   | 295/471 [06:28<03:52,  1.32s/it] 63%|██████▎   | 296/471 [06:29<03:51,  1.32s/it] 63%|██████▎   | 297/471 [06:30<03:49,  1.32s/it] 63%|██████▎   | 298/471 [06:32<03:48,  1.32s/it] 63%|██████▎   | 299/471 [06:33<03:47,  1.32s/it] 64%|██████▎   | 300/471 [06:34<03:46,  1.33s/it] 64%|██████▍   | 301/471 [06:36<03:45,  1.32s/it] 64%|██████▍   | 302/471 [06:37<03:43,  1.32s/it] 64%|██████▍   | 303/471 [06:38<03:42,  1.32s/it] 65%|██████▍   | 304/471 [06:40<03:40,  1.32s/it] 65%|██████▍   | 305/471 [06:41<03:39,  1.32s/it] 65%|██████▍   | 306/471 [06:42<03:38,  1.32s/it] 65%|██████▌   | 307/471 [06:44<03:37,  1.33s/it] 65%|██████▌   | 308/471 [06:45<03:36,  1.33s/it] 66%|██████▌   | 309/471 [06:46<03:34,  1.33s/it] 66%|██████▌   | 310/471 [06:48<03:33,  1.33s/it] 66%|██████▌   | 311/471 [06:49<03:32,  1.33s/it] 66%|██████▌   | 312/471 [06:50<03:30,  1.33s/it] 66%|██████▋   | 313/471 [06:52<03:29,  1.33s/it] 67%|██████▋   | 314/471 [06:53<03:27,  1.32s/it] 67%|██████▋   | 315/471 [06:54<03:27,  1.33s/it] 67%|██████▋   | 316/471 [06:55<03:25,  1.33s/it] 67%|██████▋   | 317/471 [06:57<03:24,  1.33s/it] 68%|██████▊   | 318/471 [06:58<03:23,  1.33s/it] 68%|██████▊   | 319/471 [06:59<03:22,  1.33s/it] 68%|██████▊   | 320/471 [07:01<03:20,  1.33s/it] 68%|██████▊   | 321/471 [07:02<03:19,  1.33s/it] 68%|██████▊   | 322/471 [07:03<03:18,  1.33s/it] 69%|██████▊   | 323/471 [07:05<03:17,  1.33s/it] 69%|██████▉   | 324/471 [07:06<03:15,  1.33s/it] 69%|██████▉   | 325/471 [07:07<03:14,  1.33s/it] 69%|██████▉   | 326/471 [07:09<03:13,  1.34s/it] 69%|██████▉   | 327/471 [07:10<03:11,  1.33s/it] 70%|██████▉   | 328/471 [07:11<03:10,  1.33s/it] 70%|██████▉   | 329/471 [07:13<03:08,  1.33s/it] 70%|███████   | 330/471 [07:14<03:07,  1.33s/it] 70%|███████   | 331/471 [07:15<03:05,  1.33s/it] 70%|███████   | 332/471 [07:17<03:04,  1.33s/it] 71%|███████   | 333/471 [07:18<03:03,  1.33s/it] 71%|███████   | 334/471 [07:19<03:01,  1.33s/it] 71%|███████   | 335/471 [07:21<03:00,  1.33s/it] 71%|███████▏  | 336/471 [07:22<02:58,  1.33s/it] 72%|███████▏  | 337/471 [07:23<02:57,  1.32s/it] 72%|███████▏  | 338/471 [07:25<02:56,  1.32s/it] 72%|███████▏  | 339/471 [07:26<02:54,  1.33s/it] 72%|███████▏  | 340/471 [07:27<02:53,  1.32s/it] 72%|███████▏  | 341/471 [07:29<02:51,  1.32s/it] 73%|███████▎  | 342/471 [07:30<02:50,  1.32s/it] 73%|███████▎  | 343/471 [07:31<02:49,  1.32s/it] 73%|███████▎  | 344/471 [07:33<02:47,  1.32s/it] 73%|███████▎  | 345/471 [07:34<02:46,  1.32s/it] 73%|███████▎  | 346/471 [07:35<02:45,  1.32s/it] 74%|███████▎  | 347/471 [07:37<02:43,  1.32s/it] 74%|███████▍  | 348/471 [07:38<02:42,  1.32s/it] 74%|███████▍  | 349/471 [07:39<02:41,  1.32s/it] 74%|███████▍  | 350/471 [07:41<02:40,  1.32s/it] 75%|███████▍  | 351/471 [07:42<02:38,  1.32s/it] 75%|███████▍  | 352/471 [07:43<02:37,  1.32s/it] 75%|███████▍  | 353/471 [07:45<02:36,  1.32s/it] 75%|███████▌  | 354/471 [07:46<02:34,  1.32s/it] 75%|███████▌  | 355/471 [07:47<02:33,  1.32s/it] 76%|███████▌  | 356/471 [07:49<02:32,  1.32s/it] 76%|███████▌  | 357/471 [07:50<02:30,  1.32s/it] 76%|███████▌  | 358/471 [07:51<02:29,  1.32s/it] 76%|███████▌  | 359/471 [07:52<02:28,  1.32s/it] 76%|███████▋  | 360/471 [07:54<02:26,  1.32s/it] 77%|███████▋  | 361/471 [07:55<02:25,  1.32s/it] 77%|███████▋  | 362/471 [07:56<02:24,  1.32s/it] 77%|███████▋  | 363/471 [07:58<02:22,  1.32s/it] 77%|███████▋  | 364/471 [07:59<02:21,  1.32s/it] 77%|███████▋  | 365/471 [08:00<02:20,  1.32s/it] 78%|███████▊  | 366/471 [08:02<02:19,  1.32s/it] 78%|███████▊  | 367/471 [08:03<02:17,  1.32s/it] 78%|███████▊  | 368/471 [08:04<02:16,  1.32s/it] 78%|███████▊  | 369/471 [08:06<02:14,  1.32s/it] 79%|███████▊  | 370/471 [08:07<02:13,  1.32s/it] 79%|███████▉  | 371/471 [08:08<02:12,  1.32s/it] 79%|███████▉  | 372/471 [08:10<02:11,  1.32s/it] 79%|███████▉  | 373/471 [08:11<02:09,  1.33s/it] 79%|███████▉  | 374/471 [08:12<02:08,  1.32s/it] 80%|███████▉  | 375/471 [08:14<02:07,  1.32s/it] 80%|███████▉  | 376/471 [08:15<02:05,  1.32s/it] 80%|████████  | 377/471 [08:16<02:04,  1.32s/it] 80%|████████  | 378/471 [08:18<02:02,  1.32s/it] 80%|████████  | 379/471 [08:19<02:01,  1.32s/it] 81%|████████  | 380/471 [08:20<02:00,  1.33s/it] 81%|████████  | 381/471 [08:22<01:59,  1.33s/it] 81%|████████  | 382/471 [08:23<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:24<01:56,  1.33s/it] 82%|████████▏ | 384/471 [08:26<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:27<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:28<01:52,  1.32s/it] 82%|████████▏ | 387/471 [08:30<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:31<01:49,  1.32s/it] 83%|████████▎ | 389/471 [08:32<01:48,  1.32s/it] 83%|████████▎ | 390/471 [08:34<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:35<01:45,  1.32s/it] 83%|████████▎ | 392/471 [08:36<01:44,  1.33s/it] 83%|████████▎ | 393/471 [08:38<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:39<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:40<01:40,  1.33s/it] 84%|████████▍ | 396/471 [08:42<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:43<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:44<01:36,  1.33s/it] 85%|████████▍ | 399/471 [08:46<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:47<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:48<01:33,  1.33s/it] 85%|████████▌ | 402/471 [08:49<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:51<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:52<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:53<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:55<01:26,  1.33s/it] 86%|████████▋ | 407/471 [08:56<01:24,  1.33s/it] 87%|████████▋ | 408/471 [08:57<01:23,  1.33s/it] 87%|████████▋ | 409/471 [08:59<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:00<01:21,  1.33s/it] 87%|████████▋ | 411/471 [09:01<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:03<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:04<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:05<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:07<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:08<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:09<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:11<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:12<01:09,  1.33s/it] 89%|████████▉ | 420/471 [09:13<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:15<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:16<01:05,  1.33s/it] 90%|████████▉ | 423/471 [09:17<01:03,  1.33s/it] 90%|█████████ | 424/471 [09:19<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:20<01:01,  1.33s/it] 90%|█████████ | 426/471 [09:21<01:00,  1.34s/it] 91%|█████████ | 427/471 [09:23<00:58,  1.34s/it] 91%|█████████ | 428/471 [09:24<00:57,  1.34s/it] 91%|█████████ | 429/471 [09:25<00:56,  1.34s/it] 91%|█████████▏| 430/471 [09:27<00:54,  1.34s/it] 92%|█████████▏| 431/471 [09:28<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:29<00:52,  1.34s/it] 92%|█████████▏| 433/471 [09:31<00:50,  1.34s/it] 92%|█████████▏| 434/471 [09:32<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:34<00:48,  1.34s/it] 93%|█████████▎| 436/471 [09:35<00:46,  1.34s/it] 93%|█████████▎| 437/471 [09:36<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:38<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:39<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:40<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:42<00:40,  1.34s/it] 94%|█████████▍| 442/471 [09:43<00:38,  1.34s/it] 94%|█████████▍| 443/471 [09:44<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:46<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:47<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:48<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:50<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:51<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:52<00:29,  1.33s/it] 96%|█████████▌| 450/471 [09:54<00:28,  1.34s/it] 96%|█████████▌| 451/471 [09:55<00:26,  1.33s/it] 96%|█████████▌| 452/471 [09:56<00:25,  1.33s/it] 96%|█████████▌| 453/471 [09:58<00:24,  1.33s/it] 96%|█████████▋| 454/471 [09:59<00:22,  1.33s/it] 97%|█████████▋| 455/471 [10:00<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:02<00:20,  1.33s/it] 97%|█████████▋| 457/471 [10:03<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:04<00:17,  1.33s/it] 97%|█████████▋| 459/471 [10:06<00:15,  1.33s/it] 98%|█████████▊| 460/471 [10:07<00:14,  1.33s/it] 98%|█████████▊| 461/471 [10:08<00:13,  1.33s/it] 98%|█████████▊| 462/471 [10:10<00:11,  1.33s/it] 98%|█████████▊| 463/471 [10:11<00:10,  1.33s/it] 99%|█████████▊| 464/471 [10:12<00:09,  1.33s/it] 99%|█████████▊| 465/471 [10:14<00:07,  1.33s/it] 99%|█████████▉| 466/471 [10:15<00:06,  1.33s/it] 99%|█████████▉| 467/471 [10:16<00:05,  1.33s/it] 99%|█████████▉| 468/471 [10:18<00:03,  1.33s/it]100%|█████████▉| 469/471 [10:19<00:02,  1.33s/it]100%|█████████▉| 470/471 [10:20<00:01,  1.33s/it]100%|██████████| 471/471 [10:21<00:00,  1.22s/it]100%|██████████| 471/471 [10:21<00:00,  1.32s/it]
{'eval_loss': 4.7315897941589355, 'eval_model_preparation_time': 0.0198, 'eval_acc': 0.20007966011683484, 'eval_runtime': 622.9043, 'eval_samples_per_second': 12.092, 'eval_steps_per_second': 0.756}
ROUND:6
CLIENT:69
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]                                              {'loss': 5.5325, 'grad_norm': 5.802302837371826, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 6.4353, 'grad_norm': 6.839670658111572, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 5.4782, 'grad_norm': 7.69342041015625, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 2.1724, 'grad_norm': 7.304840564727783, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 2.0466, 'grad_norm': 8.407978057861328, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.09, 'grad_norm': 10.777490615844727, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 2.7701, 'grad_norm': 8.975424766540527, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 3.7957, 'grad_norm': 20.60204315185547, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.3981, 'grad_norm': 8.52176570892334, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.7757, 'grad_norm': 7.321057319641113, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 0.7958, 'grad_norm': 3.5738365650177, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.2861, 'grad_norm': 6.066904067993164, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.1271, 'grad_norm': 3.8669991493225098, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.59, 'grad_norm': 4.005473613739014, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 1.8352, 'grad_norm': 7.40158224105835, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 1.4068, 'grad_norm': 21.8393497467041, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.5926, 'grad_norm': 3.4475436210632324, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.5172, 'grad_norm': 4.988659381866455, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.381, 'grad_norm': 2.7401483058929443, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.353, 'grad_norm': 3.73644757270813, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.4291, 'grad_norm': 2.1802315711975098, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.5897, 'grad_norm': 3.614553213119507, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.4302, 'grad_norm': 6.335472106933594, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.6806, 'grad_norm': 21.532556533813477, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.2702, 'grad_norm': 2.3793210983276367, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it]                                               {'loss': 0.2193, 'grad_norm': 1.1410002708435059, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it]                                               {'loss': 0.5195, 'grad_norm': 2.1670172214508057, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.1987, 'grad_norm': 2.245678663253784, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.3047, 'grad_norm': 2.478916645050049, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.0947, 'grad_norm': 1.6572203636169434, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0884, 'grad_norm': 1.4570770263671875, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.012, 'grad_norm': 0.34993842244148254, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0548, 'grad_norm': 1.6216562986373901, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.1104, 'grad_norm': 1.3741683959960938, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1327, 'grad_norm': 2.3923585414886475, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1476, 'grad_norm': 1.7676527500152588, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0541, 'grad_norm': 1.9072684049606323, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.2892, 'grad_norm': 2.910374164581299, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.2724, 'grad_norm': 2.7528982162475586, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'loss': 0.0221, 'grad_norm': 0.5608323216438293, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'train_runtime': 79.0504, 'train_samples_per_second': 7.147, 'train_steps_per_second': 0.506, 'train_loss': 1.2074939248384908, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:74
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 4.0963, 'grad_norm': 5.3827924728393555, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.13s/it]                                              {'loss': 5.0892, 'grad_norm': 6.062649726867676, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.13s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.3761, 'grad_norm': 6.558156490325928, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 3.0915, 'grad_norm': 9.216456413269043, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it]                                              {'loss': 2.7922, 'grad_norm': 11.852547645568848, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 1.678, 'grad_norm': 11.702252388000488, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.15s/it]                                              {'loss': 2.1457, 'grad_norm': 16.636930465698242, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.15s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 1.5657, 'grad_norm': 68.75914001464844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.6106, 'grad_norm': 5.450169563293457, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.4923, 'grad_norm': 7.976670742034912, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 1.0858, 'grad_norm': 7.380054473876953, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:23<00:56,  2.01s/it]                                               {'loss': 1.7036, 'grad_norm': 12.657391548156738, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.01s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.05s/it]                                               {'loss': 0.9135, 'grad_norm': 24.46140480041504, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.05s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it]                                               {'loss': 1.1542, 'grad_norm': 15.783656120300293, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it]                                               {'loss': 1.5451, 'grad_norm': 23.503887176513672, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 1.2693, 'grad_norm': 57.15738296508789, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it]                                               {'loss': 0.1427, 'grad_norm': 2.1173832416534424, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 1.0003, 'grad_norm': 3.9496450424194336, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.2674, 'grad_norm': 2.727658987045288, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.03s/it]                                               {'loss': 0.4075, 'grad_norm': 3.756598711013794, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.03s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it]                                               {'loss': 0.8344, 'grad_norm': 6.931135654449463, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.7204, 'grad_norm': 7.916229724884033, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.14s/it]                                               {'loss': 0.4902, 'grad_norm': 12.072919845581055, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.14s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 0.016, 'grad_norm': 0.7892652153968811, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.3223, 'grad_norm': 4.18203592300415, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.2776, 'grad_norm': 8.96498966217041, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it]                                               {'loss': 0.1008, 'grad_norm': 0.9656765460968018, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.99s/it] 70%|███████   | 28/40 [00:54<00:24,  2.05s/it]                                               {'loss': 0.1424, 'grad_norm': 1.614956021308899, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.2935, 'grad_norm': 2.9653480052948, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.4653, 'grad_norm': 9.180520057678223, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it]                                               {'loss': 0.4732, 'grad_norm': 8.795260429382324, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.029, 'grad_norm': 1.340895652770996, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0378, 'grad_norm': 0.6215050220489502, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.1193, 'grad_norm': 3.3187804222106934, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it]                                               {'loss': 0.0929, 'grad_norm': 1.1020499467849731, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it]                                               {'loss': 0.3514, 'grad_norm': 6.94478178024292, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.11s/it]                                               {'loss': 0.2452, 'grad_norm': 4.7316999435424805, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.11s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it]                                               {'loss': 0.2314, 'grad_norm': 1.7247833013534546, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.1793, 'grad_norm': 1.5810272693634033, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.083, 'grad_norm': 1.7647711038589478, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 77.8703, 'train_samples_per_second': 7.256, 'train_steps_per_second': 0.514, 'train_loss': 1.0233105593826621, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]100%|██████████| 40/40 [01:17<00:00,  1.95s/it]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 3.2448, 'grad_norm': 8.049805641174316, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 3.7568, 'grad_norm': 6.411284446716309, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 3.5853, 'grad_norm': 6.677818775177002, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.3168, 'grad_norm': 6.603634357452393, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 1.9321, 'grad_norm': 8.218213081359863, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 2.551, 'grad_norm': 11.833139419555664, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 2.9712, 'grad_norm': 11.707087516784668, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.8355, 'grad_norm': 17.180219650268555, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.0477, 'grad_norm': 3.801481008529663, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.1061, 'grad_norm': 11.016006469726562, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.5465, 'grad_norm': 4.869406700134277, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.6184, 'grad_norm': 3.36879563331604, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.7682, 'grad_norm': 3.994713068008423, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.5847, 'grad_norm': 4.666697025299072, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.6424, 'grad_norm': 4.927273750305176, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.001, 'grad_norm': 0.0383569709956646, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.1546, 'grad_norm': 2.543002128601074, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.2123, 'grad_norm': 2.205296277999878, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.3059, 'grad_norm': 3.0548501014709473, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.1412, 'grad_norm': 2.724396228790283, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.2277, 'grad_norm': 2.141080617904663, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.235, 'grad_norm': 2.1610538959503174, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.3244, 'grad_norm': 10.081321716308594, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0015, 'grad_norm': 0.0702100545167923, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.02, 'grad_norm': 0.41020023822784424, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0959, 'grad_norm': 2.5616862773895264, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0778, 'grad_norm': 1.111794352531433, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.0286, 'grad_norm': 0.38782286643981934, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.0478, 'grad_norm': 0.8240652084350586, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0295, 'grad_norm': 0.5492167472839355, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1715, 'grad_norm': 3.302741765975952, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0001, 'grad_norm': 0.004376741126179695, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0388, 'grad_norm': 0.6319948434829712, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0464, 'grad_norm': 0.8930820226669312, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1648, 'grad_norm': 5.458786487579346, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0585, 'grad_norm': 1.4569530487060547, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.021, 'grad_norm': 0.45380011200904846, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0184, 'grad_norm': 0.9358672499656677, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.0101, 'grad_norm': 0.24229227006435394, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0243, 'grad_norm': 0.9967975616455078, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.75, 'train_samples_per_second': 7.175, 'train_steps_per_second': 0.508, 'train_loss': 0.7491090667428579, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 3.4396, 'grad_norm': 4.2091593742370605, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 4.7405, 'grad_norm': 10.944101333618164, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 4.3272, 'grad_norm': 8.939037322998047, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.8303, 'grad_norm': 9.741056442260742, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 4.4406, 'grad_norm': 11.143977165222168, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.919, 'grad_norm': 6.718240261077881, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.8031, 'grad_norm': 12.894651412963867, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 6.2107, 'grad_norm': 51.358726501464844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.8319, 'grad_norm': 4.3052778244018555, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.6777, 'grad_norm': 7.654612064361572, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 1.2771, 'grad_norm': 6.460472106933594, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.8419, 'grad_norm': 4.508351802825928, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.4651, 'grad_norm': 7.033680438995361, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.6908, 'grad_norm': 4.933780670166016, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.5721, 'grad_norm': 3.682103395462036, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 1.5803, 'grad_norm': 17.805397033691406, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.1748, 'grad_norm': 1.8384060859680176, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.1276, 'grad_norm': 2.615773916244507, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.6172, 'grad_norm': 7.917571544647217, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.5036, 'grad_norm': 2.5402557849884033, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.3439, 'grad_norm': 3.280062198638916, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.7085, 'grad_norm': 4.924754619598389, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.5301, 'grad_norm': 6.5984416007995605, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.636, 'grad_norm': 30.80990219116211, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.1381, 'grad_norm': 1.1145753860473633, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.1974, 'grad_norm': 1.8344306945800781, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.0949, 'grad_norm': 1.9281738996505737, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.43, 'grad_norm': 5.862979412078857, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.1843, 'grad_norm': 2.6291120052337646, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.2196, 'grad_norm': 2.677070379257202, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.07, 'grad_norm': 1.5010854005813599, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0539, 'grad_norm': 1.4938136339187622, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0799, 'grad_norm': 1.1865758895874023, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0758, 'grad_norm': 0.89637291431427, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0329, 'grad_norm': 0.38170501589775085, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.0859, 'grad_norm': 3.198601245880127, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.1299, 'grad_norm': 2.812138319015503, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.0463, 'grad_norm': 0.7072722315788269, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0783, 'grad_norm': 1.3794124126434326, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'loss': 0.0061, 'grad_norm': 0.296132355928421, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'train_runtime': 79.1618, 'train_samples_per_second': 7.137, 'train_steps_per_second': 0.505, 'train_loss': 1.1303213046165184, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.3575, 'grad_norm': 4.789981842041016, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 3.3206, 'grad_norm': 5.668281078338623, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.3311, 'grad_norm': 7.020365238189697, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.8455, 'grad_norm': 4.713624954223633, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.4019, 'grad_norm': 8.165877342224121, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 1.9735, 'grad_norm': 5.981773853302002, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it]                                              {'loss': 1.5347, 'grad_norm': 6.378439903259277, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it] 20%|██        | 8/40 [00:15<00:51,  1.62s/it]                                              {'loss': 1.6041, 'grad_norm': 40.32225799560547, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:51,  1.62s/it] 22%|██▎       | 9/40 [00:18<00:56,  1.83s/it]                                              {'loss': 0.4248, 'grad_norm': 3.270495891571045, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:56,  1.83s/it] 25%|██▌       | 10/40 [00:20<00:59,  1.97s/it]                                               {'loss': 1.7062, 'grad_norm': 7.374398231506348, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:59,  1.97s/it] 28%|██▊       | 11/40 [00:22<00:59,  2.07s/it]                                               {'loss': 0.4015, 'grad_norm': 4.613969802856445, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:59,  2.07s/it] 30%|███       | 12/40 [00:24<00:59,  2.13s/it]                                               {'loss': 1.128, 'grad_norm': 7.750484943389893, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:59,  2.13s/it] 32%|███▎      | 13/40 [00:27<00:58,  2.16s/it]                                               {'loss': 0.846, 'grad_norm': 6.346484661102295, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:58,  2.16s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it]                                               {'loss': 1.1409, 'grad_norm': 5.097361087799072, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it]                                               {'loss': 0.7844, 'grad_norm': 4.663164138793945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it] 40%|████      | 16/40 [00:31<00:39,  1.64s/it]                                               {'loss': 0.0846, 'grad_norm': 2.823805332183838, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:39,  1.64s/it] 42%|████▎     | 17/40 [00:34<00:42,  1.84s/it]                                               {'loss': 0.7154, 'grad_norm': 4.193049430847168, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:42,  1.84s/it] 45%|████▌     | 18/40 [00:36<00:43,  1.96s/it]                                               {'loss': 0.2564, 'grad_norm': 3.5127811431884766, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:43,  1.96s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.05s/it]                                               {'loss': 0.5922, 'grad_norm': 5.452688694000244, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.05s/it] 50%|█████     | 20/40 [00:40<00:42,  2.11s/it]                                               {'loss': 0.6811, 'grad_norm': 6.0509538650512695, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:43<00:40,  2.15s/it]                                               {'loss': 0.1954, 'grad_norm': 3.63334321975708, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:40,  2.15s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it]                                               {'loss': 0.6918, 'grad_norm': 13.747965812683105, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.4936, 'grad_norm': 3.438159465789795, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:48<00:26,  1.64s/it]                                               {'loss': 1.8817, 'grad_norm': 20.961427688598633, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:48<00:26,  1.64s/it] 62%|██████▎   | 25/40 [00:50<00:27,  1.82s/it]                                               {'loss': 0.1786, 'grad_norm': 1.4349619150161743, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:27,  1.82s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.97s/it]                                               {'loss': 0.4717, 'grad_norm': 5.207363128662109, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.97s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.08s/it]                                               {'loss': 0.1739, 'grad_norm': 1.304355502128601, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.08s/it] 70%|███████   | 28/40 [00:57<00:25,  2.15s/it]                                               {'loss': 0.1128, 'grad_norm': 2.710617780685425, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:57<00:25,  2.15s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it]                                               {'loss': 0.1184, 'grad_norm': 1.7939797639846802, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.22s/it]                                               {'loss': 0.2595, 'grad_norm': 1.9214495420455933, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.22s/it] 78%|███████▊  | 31/40 [01:04<00:20,  2.25s/it]                                               {'loss': 0.1277, 'grad_norm': 4.061245918273926, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:04<00:20,  2.25s/it] 80%|████████  | 32/40 [01:04<00:13,  1.65s/it]                                               {'loss': 0.049, 'grad_norm': 1.146987795829773, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:04<00:13,  1.65s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.84s/it]                                               {'loss': 0.3031, 'grad_norm': 2.738100528717041, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.84s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.98s/it]                                               {'loss': 0.0432, 'grad_norm': 0.7259877920150757, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.98s/it] 88%|████████▊ | 35/40 [01:11<00:10,  2.10s/it]                                               {'loss': 0.019, 'grad_norm': 0.49470171332359314, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:11<00:10,  2.10s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.17s/it]                                               {'loss': 0.1579, 'grad_norm': 4.0761399269104, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.17s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.21s/it]                                               {'loss': 0.1248, 'grad_norm': 3.3436172008514404, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.21s/it] 95%|█████████▌| 38/40 [01:18<00:04,  2.23s/it]                                               {'loss': 0.0944, 'grad_norm': 4.1320881843566895, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:18<00:04,  2.23s/it] 98%|█████████▊| 39/40 [01:20<00:02,  2.24s/it]                                               {'loss': 0.3278, 'grad_norm': 3.0824944972991943, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:20<00:02,  2.24s/it]100%|██████████| 40/40 [01:20<00:00,  1.66s/it]                                               {'loss': 0.0089, 'grad_norm': 0.45460155606269836, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.66s/it]                                               {'train_runtime': 81.4145, 'train_samples_per_second': 6.94, 'train_steps_per_second': 0.491, 'train_loss': 0.8740845499094576, 'epoch': 5.0}
100%|██████████| 40/40 [01:21<00:00,  1.66s/it]100%|██████████| 40/40 [01:21<00:00,  2.04s/it]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 5.8179, 'grad_norm': 8.050514221191406, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 4.4457, 'grad_norm': 9.116893768310547, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 3.3715, 'grad_norm': 5.212545871734619, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 2.6281, 'grad_norm': 6.725048542022705, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it]                                              {'loss': 3.464, 'grad_norm': 14.611786842346191, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.5557, 'grad_norm': 7.418166160583496, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.6535, 'grad_norm': 5.551757335662842, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 4.1887, 'grad_norm': 26.84712791442871, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 1.143, 'grad_norm': 8.163578987121582, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.0933, 'grad_norm': 6.029857158660889, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 1.4406, 'grad_norm': 5.636699676513672, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.9524, 'grad_norm': 5.3246660232543945, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.973, 'grad_norm': 6.1137590408325195, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.2329, 'grad_norm': 4.502321720123291, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.7096, 'grad_norm': 4.196592330932617, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.58s/it]                                               {'loss': 0.0496, 'grad_norm': 1.4539014101028442, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.8494, 'grad_norm': 7.598628520965576, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 0.3415, 'grad_norm': 1.5078102350234985, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 0.1554, 'grad_norm': 0.951088011264801, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:42,  2.12s/it]                                               {'loss': 0.3311, 'grad_norm': 1.9934594631195068, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.12s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it]                                               {'loss': 0.4064, 'grad_norm': 17.816137313842773, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 0.1228, 'grad_norm': 4.8378729820251465, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.4439, 'grad_norm': 4.839118003845215, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0574, 'grad_norm': 1.7825772762298584, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.1708, 'grad_norm': 4.49921178817749, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.157, 'grad_norm': 1.6442731618881226, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0783, 'grad_norm': 1.3452506065368652, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0586, 'grad_norm': 1.1057300567626953, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.258, 'grad_norm': 6.466777801513672, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.175, 'grad_norm': 2.081380605697632, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.312, 'grad_norm': 1.8770930767059326, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.8471, 'grad_norm': 12.936016082763672, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0654, 'grad_norm': 0.5193074941635132, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.0908, 'grad_norm': 0.9898756742477417, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.181, 'grad_norm': 5.614375114440918, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0766, 'grad_norm': 2.6263229846954346, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.1679, 'grad_norm': 3.1164727210998535, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.3534, 'grad_norm': 4.65937614440918, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.1173, 'grad_norm': 1.6955446004867554, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.63s/it]                                               {'loss': 0.1381, 'grad_norm': 4.901131629943848, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.63s/it]                                               {'train_runtime': 79.867, 'train_samples_per_second': 7.074, 'train_steps_per_second': 0.501, 'train_loss': 1.0418660129420458, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.63s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
CLIENT:32
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.1647, 'grad_norm': 6.370212554931641, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 4.6581, 'grad_norm': 5.566277980804443, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.3578, 'grad_norm': 8.236518859863281, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 3.5455, 'grad_norm': 9.863127708435059, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 3.0319, 'grad_norm': 8.328594207763672, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 3.9493, 'grad_norm': 15.736327171325684, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 2.6113, 'grad_norm': 13.132651329040527, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 2.9121, 'grad_norm': 40.362518310546875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.2301, 'grad_norm': 8.119680404663086, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.4148, 'grad_norm': 13.7467679977417, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it]                                               {'loss': 1.1478, 'grad_norm': 14.8619966506958, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.7062, 'grad_norm': 4.995691299438477, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 1.3314, 'grad_norm': 8.294677734375, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.3145, 'grad_norm': 5.10854959487915, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.3246, 'grad_norm': 4.115004062652588, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.1872, 'grad_norm': 3.222174644470215, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.4233, 'grad_norm': 3.6376802921295166, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.3792, 'grad_norm': 2.253237247467041, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.631, 'grad_norm': 3.303061008453369, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.5226, 'grad_norm': 5.676604747772217, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.4732, 'grad_norm': 5.961301803588867, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.8599, 'grad_norm': 6.830659866333008, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.5456, 'grad_norm': 4.869743824005127, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 2.5983, 'grad_norm': 11.837320327758789, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.2909, 'grad_norm': 3.8106343746185303, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it]                                               {'loss': 0.7294, 'grad_norm': 6.526782035827637, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.427, 'grad_norm': 3.0265607833862305, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 1.0495, 'grad_norm': 6.037105083465576, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.1165, 'grad_norm': 3.4528136253356934, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0728, 'grad_norm': 1.8605958223342896, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.3304, 'grad_norm': 2.26257061958313, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 1.3073, 'grad_norm': 17.44927215576172, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.1395, 'grad_norm': 2.1650564670562744, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.3172, 'grad_norm': 2.5790650844573975, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.3553, 'grad_norm': 3.07452654838562, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1465, 'grad_norm': 0.8683422803878784, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.1412, 'grad_norm': 3.0890743732452393, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.5422, 'grad_norm': 1.8952593803405762, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0705, 'grad_norm': 0.8750865459442139, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0301, 'grad_norm': 1.3489898443222046, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.6379, 'train_samples_per_second': 7.185, 'train_steps_per_second': 0.509, 'train_loss': 1.2596660047769546, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 2.8503, 'grad_norm': 4.489599227905273, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 4.4055, 'grad_norm': 5.032694339752197, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 5.2943, 'grad_norm': 8.662094116210938, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 4.5028, 'grad_norm': 6.7100982666015625, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.14s/it]                                              {'loss': 3.7283, 'grad_norm': 41.05772018432617, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.14s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.14s/it]                                              {'loss': 3.8947, 'grad_norm': 6.879042625427246, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.14s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 2.8387, 'grad_norm': 9.28980541229248, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 5.1709, 'grad_norm': 53.56940841674805, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.7023, 'grad_norm': 5.522443771362305, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.2789, 'grad_norm': 7.883549213409424, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 1.3937, 'grad_norm': 9.370174407958984, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 1.9215, 'grad_norm': 11.215718269348145, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.06s/it]                                               {'loss': 1.9093, 'grad_norm': 17.20050048828125, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.06s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it]                                               {'loss': 1.7832, 'grad_norm': 16.621612548828125, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.09s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 1.4246, 'grad_norm': 13.384832382202148, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:37,  1.54s/it]                                               {'loss': 0.0501, 'grad_norm': 2.258256196975708, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.72s/it]                                               {'loss': 1.1472, 'grad_norm': 12.562665939331055, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.72s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it]                                               {'loss': 0.4264, 'grad_norm': 4.804386138916016, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it]                                               {'loss': 0.6231, 'grad_norm': 5.628296852111816, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.4426, 'grad_norm': 5.714925765991211, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.6899, 'grad_norm': 6.853579521179199, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it]                                               {'loss': 0.8723, 'grad_norm': 5.187994956970215, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.4208, 'grad_norm': 4.303656101226807, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.4316, 'grad_norm': 19.468564987182617, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.2579, 'grad_norm': 7.751739978790283, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.87s/it]                                               {'loss': 0.2697, 'grad_norm': 2.9413602352142334, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.87s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.96s/it]                                               {'loss': 0.3709, 'grad_norm': 3.617520809173584, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.96s/it] 70%|███████   | 28/40 [00:54<00:24,  2.03s/it]                                               {'loss': 0.3167, 'grad_norm': 4.310719013214111, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.03s/it] 72%|███████▎  | 29/40 [00:57<00:22,  2.08s/it]                                               {'loss': 0.3553, 'grad_norm': 5.715209484100342, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:22,  2.08s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.5263, 'grad_norm': 3.8738162517547607, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it]                                               {'loss': 0.1545, 'grad_norm': 1.5958335399627686, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it] 80%|████████  | 32/40 [01:01<00:12,  1.58s/it]                                               {'loss': 0.184, 'grad_norm': 7.959508419036865, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.2024, 'grad_norm': 3.8574790954589844, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.3127, 'grad_norm': 5.66018533706665, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it]                                               {'loss': 0.3126, 'grad_norm': 5.60622501373291, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it]                                               {'loss': 0.3967, 'grad_norm': 5.809504508972168, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.11s/it]                                               {'loss': 0.2452, 'grad_norm': 4.155155181884766, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.11s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.1721, 'grad_norm': 2.5157225131988525, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.3488, 'grad_norm': 3.941128730773926, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.0323, 'grad_norm': 1.5025461912155151, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 77.9068, 'train_samples_per_second': 7.252, 'train_steps_per_second': 0.513, 'train_loss': 1.3165359148755669, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]100%|██████████| 40/40 [01:17<00:00,  1.95s/it]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 3.5753, 'grad_norm': 7.679913520812988, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 4.7123, 'grad_norm': 8.877693176269531, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 3.5582, 'grad_norm': 7.514642715454102, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:20,  2.24s/it]                                              {'loss': 1.3033, 'grad_norm': 5.027369499206543, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:20,  2.24s/it] 12%|█▎        | 5/40 [00:11<01:18,  2.25s/it]                                              {'loss': 2.1138, 'grad_norm': 7.466125965118408, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:18,  2.25s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it]                                              {'loss': 2.2106, 'grad_norm': 12.551593780517578, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.9085, 'grad_norm': 8.294544219970703, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:51,  1.61s/it]                                              {'loss': 1.5641, 'grad_norm': 49.5133056640625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:51,  1.61s/it] 22%|██▎       | 9/40 [00:18<00:55,  1.79s/it]                                              {'loss': 1.2658, 'grad_norm': 18.930578231811523, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:55,  1.79s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 1.6419, 'grad_norm': 8.206618309020996, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:59,  2.04s/it]                                               {'loss': 0.8826, 'grad_norm': 9.607337951660156, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:59,  2.04s/it] 30%|███       | 12/40 [00:24<00:58,  2.10s/it]                                               {'loss': 0.7643, 'grad_norm': 5.2066240310668945, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.10s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 1.265, 'grad_norm': 7.228833198547363, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it]                                               {'loss': 0.9036, 'grad_norm': 4.874119281768799, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.7008, 'grad_norm': 6.178248405456543, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.58s/it]                                               {'loss': 0.0647, 'grad_norm': 3.809562921524048, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.7582, 'grad_norm': 6.718206882476807, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it]                                               {'loss': 0.3898, 'grad_norm': 3.864135265350342, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.4143, 'grad_norm': 4.496981620788574, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.639, 'grad_norm': 3.4801034927368164, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.4299, 'grad_norm': 7.884268760681152, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it]                                               {'loss': 0.564, 'grad_norm': 5.008127212524414, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.18s/it]                                               {'loss': 0.4691, 'grad_norm': 2.797583818435669, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.271, 'grad_norm': 52.050743103027344, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.7429, 'grad_norm': 12.657925605773926, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:52<00:26,  1.92s/it]                                               {'loss': 0.1351, 'grad_norm': 1.6724122762680054, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.0741, 'grad_norm': 1.1714746952056885, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0775, 'grad_norm': 1.7655223608016968, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.1251, 'grad_norm': 1.716251015663147, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it]                                               {'loss': 0.1999, 'grad_norm': 1.7073065042495728, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it]                                               {'loss': 0.1572, 'grad_norm': 1.3920272588729858, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0022, 'grad_norm': 0.11602706462144852, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0517, 'grad_norm': 1.379270315170288, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it]                                               {'loss': 0.4186, 'grad_norm': 4.28585958480835, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.068, 'grad_norm': 1.351864218711853, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.1431, 'grad_norm': 3.3182497024536133, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.2219, 'grad_norm': 1.7800942659378052, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.22s/it]                                               {'loss': 0.0529, 'grad_norm': 0.9046729803085327, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.22s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.3113, 'grad_norm': 17.69710922241211, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.01, 'grad_norm': 0.9025741219520569, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 80.2099, 'train_samples_per_second': 7.044, 'train_steps_per_second': 0.499, 'train_loss': 0.8790441430173814, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 4.6381, 'grad_norm': 2.9275472164154053, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 2.6952, 'grad_norm': 4.817612171173096, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 3.9801, 'grad_norm': 7.22461462020874, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.3715, 'grad_norm': 6.429153919219971, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 2.6897, 'grad_norm': 10.224936485290527, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it]                                              {'loss': 3.184, 'grad_norm': 11.106380462646484, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.7504, 'grad_norm': 9.022191047668457, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.7035, 'grad_norm': 15.162858009338379, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.3105, 'grad_norm': 3.3855972290039062, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.7133, 'grad_norm': 6.482284069061279, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.079, 'grad_norm': 5.143359184265137, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.4396, 'grad_norm': 2.7270278930664062, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 1.6007, 'grad_norm': 6.408150672912598, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.0482, 'grad_norm': 5.6567769050598145, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 0.8512, 'grad_norm': 4.529970169067383, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0203, 'grad_norm': 0.6415508985519409, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.7738, 'grad_norm': 5.949810028076172, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.3228, 'grad_norm': 2.563265800476074, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.3376, 'grad_norm': 2.455707550048828, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.8668, 'grad_norm': 5.270388126373291, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.3707, 'grad_norm': 2.026919364929199, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.121, 'grad_norm': 1.316787600517273, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.1662, 'grad_norm': 1.9889163970947266, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0146, 'grad_norm': 0.8126114010810852, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.3236, 'grad_norm': 3.2360265254974365, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.2188, 'grad_norm': 3.196662187576294, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0327, 'grad_norm': 0.6451581120491028, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1497, 'grad_norm': 1.1602270603179932, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.1213, 'grad_norm': 0.8757253885269165, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.2038, 'grad_norm': 0.8889923095703125, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.3859, 'grad_norm': 3.011263132095337, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.5753, 'grad_norm': 20.106468200683594, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1422, 'grad_norm': 2.1379354000091553, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.1206, 'grad_norm': 3.0655570030212402, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0852, 'grad_norm': 0.9011629223823547, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.055, 'grad_norm': 1.5617748498916626, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0876, 'grad_norm': 1.3652515411376953, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.1415, 'grad_norm': 2.6203773021698, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.1783, 'grad_norm': 2.0331387519836426, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0602, 'grad_norm': 2.854954481124878, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.7703, 'train_samples_per_second': 7.173, 'train_steps_per_second': 0.508, 'train_loss': 0.9232672511832789, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:54,  1.59it/s]  1%|          | 3/471 [00:02<06:56,  1.12it/s]  1%|          | 4/471 [00:03<08:01,  1.03s/it]  1%|          | 5/471 [00:05<08:38,  1.11s/it]  1%|▏         | 6/471 [00:06<09:00,  1.16s/it]  1%|▏         | 7/471 [00:07<09:16,  1.20s/it]  2%|▏         | 8/471 [00:08<09:25,  1.22s/it]  2%|▏         | 9/471 [00:10<09:31,  1.24s/it]  2%|▏         | 10/471 [00:11<09:35,  1.25s/it]  2%|▏         | 11/471 [00:12<09:38,  1.26s/it]  3%|▎         | 12/471 [00:13<09:40,  1.26s/it]  3%|▎         | 13/471 [00:15<09:42,  1.27s/it]  3%|▎         | 14/471 [00:16<09:41,  1.27s/it]  3%|▎         | 15/471 [00:17<09:41,  1.28s/it]  3%|▎         | 16/471 [00:19<09:41,  1.28s/it]  4%|▎         | 17/471 [00:20<09:41,  1.28s/it]  4%|▍         | 18/471 [00:21<09:41,  1.28s/it]  4%|▍         | 19/471 [00:22<09:39,  1.28s/it]  4%|▍         | 20/471 [00:24<09:39,  1.29s/it]  4%|▍         | 21/471 [00:25<09:38,  1.29s/it]  5%|▍         | 22/471 [00:26<09:38,  1.29s/it]  5%|▍         | 23/471 [00:28<09:36,  1.29s/it]  5%|▌         | 24/471 [00:29<09:36,  1.29s/it]  5%|▌         | 25/471 [00:30<09:35,  1.29s/it]  6%|▌         | 26/471 [00:31<09:35,  1.29s/it]  6%|▌         | 27/471 [00:33<09:34,  1.29s/it]  6%|▌         | 28/471 [00:34<09:33,  1.29s/it]  6%|▌         | 29/471 [00:35<09:32,  1.29s/it]  6%|▋         | 30/471 [00:37<09:32,  1.30s/it]  7%|▋         | 31/471 [00:38<09:31,  1.30s/it]  7%|▋         | 32/471 [00:39<09:30,  1.30s/it]  7%|▋         | 33/471 [00:41<09:27,  1.30s/it]  7%|▋         | 34/471 [00:42<09:27,  1.30s/it]  7%|▋         | 35/471 [00:43<09:26,  1.30s/it]  8%|▊         | 36/471 [00:44<09:25,  1.30s/it]  8%|▊         | 37/471 [00:46<09:25,  1.30s/it]  8%|▊         | 38/471 [00:47<09:24,  1.30s/it]  8%|▊         | 39/471 [00:48<09:22,  1.30s/it]  8%|▊         | 40/471 [00:50<09:21,  1.30s/it]  9%|▊         | 41/471 [00:51<09:20,  1.30s/it]  9%|▉         | 42/471 [00:52<09:20,  1.31s/it]  9%|▉         | 43/471 [00:54<09:18,  1.31s/it]  9%|▉         | 44/471 [00:55<09:17,  1.31s/it] 10%|▉         | 45/471 [00:56<09:16,  1.31s/it] 10%|▉         | 46/471 [00:58<09:15,  1.31s/it] 10%|▉         | 47/471 [00:59<09:13,  1.31s/it] 10%|█         | 48/471 [01:00<09:12,  1.31s/it] 10%|█         | 49/471 [01:01<09:11,  1.31s/it] 11%|█         | 50/471 [01:03<09:10,  1.31s/it] 11%|█         | 51/471 [01:04<09:09,  1.31s/it] 11%|█         | 52/471 [01:05<09:08,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:07,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:06,  1.31s/it] 12%|█▏        | 55/471 [01:09<09:05,  1.31s/it] 12%|█▏        | 56/471 [01:11<09:04,  1.31s/it] 12%|█▏        | 57/471 [01:12<09:03,  1.31s/it] 12%|█▏        | 58/471 [01:13<09:02,  1.31s/it] 13%|█▎        | 59/471 [01:15<09:01,  1.31s/it] 13%|█▎        | 60/471 [01:16<08:59,  1.31s/it] 13%|█▎        | 61/471 [01:17<08:59,  1.31s/it] 13%|█▎        | 62/471 [01:19<08:57,  1.31s/it] 13%|█▎        | 63/471 [01:20<08:56,  1.31s/it] 14%|█▎        | 64/471 [01:21<08:55,  1.32s/it] 14%|█▍        | 65/471 [01:22<08:53,  1.31s/it] 14%|█▍        | 66/471 [01:24<08:52,  1.32s/it] 14%|█▍        | 67/471 [01:25<08:51,  1.32s/it] 14%|█▍        | 68/471 [01:26<08:49,  1.31s/it] 15%|█▍        | 69/471 [01:28<08:48,  1.31s/it] 15%|█▍        | 70/471 [01:29<08:47,  1.32s/it] 15%|█▌        | 71/471 [01:30<08:46,  1.32s/it] 15%|█▌        | 72/471 [01:32<08:44,  1.32s/it] 15%|█▌        | 73/471 [01:33<08:43,  1.32s/it] 16%|█▌        | 74/471 [01:34<08:40,  1.31s/it] 16%|█▌        | 75/471 [01:36<08:41,  1.32s/it] 16%|█▌        | 76/471 [01:37<08:39,  1.31s/it] 16%|█▋        | 77/471 [01:38<08:38,  1.31s/it] 17%|█▋        | 78/471 [01:40<08:36,  1.31s/it] 17%|█▋        | 79/471 [01:41<08:35,  1.32s/it] 17%|█▋        | 80/471 [01:42<08:34,  1.32s/it] 17%|█▋        | 81/471 [01:44<08:33,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:32,  1.32s/it] 18%|█▊        | 83/471 [01:46<08:31,  1.32s/it] 18%|█▊        | 84/471 [01:48<08:30,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:29,  1.32s/it] 18%|█▊        | 86/471 [01:50<08:28,  1.32s/it] 18%|█▊        | 87/471 [01:51<08:26,  1.32s/it] 19%|█▊        | 88/471 [01:53<08:25,  1.32s/it] 19%|█▉        | 89/471 [01:54<08:23,  1.32s/it] 19%|█▉        | 90/471 [01:55<08:23,  1.32s/it] 19%|█▉        | 91/471 [01:57<08:21,  1.32s/it] 20%|█▉        | 92/471 [01:58<08:20,  1.32s/it] 20%|█▉        | 93/471 [01:59<08:19,  1.32s/it] 20%|█▉        | 94/471 [02:01<08:17,  1.32s/it] 20%|██        | 95/471 [02:02<08:16,  1.32s/it] 20%|██        | 96/471 [02:03<08:14,  1.32s/it] 21%|██        | 97/471 [02:05<08:14,  1.32s/it] 21%|██        | 98/471 [02:06<08:12,  1.32s/it] 21%|██        | 99/471 [02:07<08:11,  1.32s/it] 21%|██        | 100/471 [02:09<08:10,  1.32s/it] 21%|██▏       | 101/471 [02:10<08:08,  1.32s/it] 22%|██▏       | 102/471 [02:11<08:07,  1.32s/it] 22%|██▏       | 103/471 [02:13<08:07,  1.32s/it] 22%|██▏       | 104/471 [02:14<08:06,  1.32s/it] 22%|██▏       | 105/471 [02:15<08:05,  1.33s/it] 23%|██▎       | 106/471 [02:17<08:02,  1.32s/it] 23%|██▎       | 107/471 [02:18<08:01,  1.32s/it] 23%|██▎       | 108/471 [02:19<07:59,  1.32s/it] 23%|██▎       | 109/471 [02:21<07:57,  1.32s/it] 23%|██▎       | 110/471 [02:22<07:55,  1.32s/it] 24%|██▎       | 111/471 [02:23<07:55,  1.32s/it] 24%|██▍       | 112/471 [02:24<07:54,  1.32s/it] 24%|██▍       | 113/471 [02:26<07:52,  1.32s/it] 24%|██▍       | 114/471 [02:27<07:51,  1.32s/it] 24%|██▍       | 115/471 [02:28<07:50,  1.32s/it] 25%|██▍       | 116/471 [02:30<07:49,  1.32s/it] 25%|██▍       | 117/471 [02:31<07:48,  1.32s/it] 25%|██▌       | 118/471 [02:32<07:47,  1.32s/it] 25%|██▌       | 119/471 [02:34<07:45,  1.32s/it] 25%|██▌       | 120/471 [02:35<07:45,  1.33s/it] 26%|██▌       | 121/471 [02:36<07:43,  1.32s/it] 26%|██▌       | 122/471 [02:38<07:42,  1.32s/it] 26%|██▌       | 123/471 [02:39<07:41,  1.33s/it] 26%|██▋       | 124/471 [02:40<07:40,  1.33s/it] 27%|██▋       | 125/471 [02:42<07:39,  1.33s/it] 27%|██▋       | 126/471 [02:43<07:38,  1.33s/it] 27%|██▋       | 127/471 [02:44<07:36,  1.33s/it] 27%|██▋       | 128/471 [02:46<07:35,  1.33s/it] 27%|██▋       | 129/471 [02:47<07:33,  1.33s/it] 28%|██▊       | 130/471 [02:48<07:32,  1.33s/it] 28%|██▊       | 131/471 [02:50<07:31,  1.33s/it] 28%|██▊       | 132/471 [02:51<07:30,  1.33s/it] 28%|██▊       | 133/471 [02:52<07:28,  1.33s/it] 28%|██▊       | 134/471 [02:54<07:27,  1.33s/it] 29%|██▊       | 135/471 [02:55<07:26,  1.33s/it] 29%|██▉       | 136/471 [02:56<07:24,  1.33s/it] 29%|██▉       | 137/471 [02:58<07:22,  1.33s/it] 29%|██▉       | 138/471 [02:59<07:21,  1.33s/it] 30%|██▉       | 139/471 [03:00<07:19,  1.32s/it] 30%|██▉       | 140/471 [03:02<07:18,  1.32s/it] 30%|██▉       | 141/471 [03:03<07:16,  1.32s/it] 30%|███       | 142/471 [03:04<07:14,  1.32s/it] 30%|███       | 143/471 [03:06<07:12,  1.32s/it] 31%|███       | 144/471 [03:07<07:12,  1.32s/it] 31%|███       | 145/471 [03:08<07:10,  1.32s/it] 31%|███       | 146/471 [03:10<07:09,  1.32s/it] 31%|███       | 147/471 [03:11<07:08,  1.32s/it] 31%|███▏      | 148/471 [03:12<07:07,  1.32s/it] 32%|███▏      | 149/471 [03:14<07:06,  1.32s/it] 32%|███▏      | 150/471 [03:15<07:05,  1.33s/it] 32%|███▏      | 151/471 [03:16<07:03,  1.32s/it] 32%|███▏      | 152/471 [03:17<07:02,  1.32s/it] 32%|███▏      | 153/471 [03:19<07:00,  1.32s/it] 33%|███▎      | 154/471 [03:20<06:58,  1.32s/it] 33%|███▎      | 155/471 [03:21<06:57,  1.32s/it] 33%|███▎      | 156/471 [03:23<06:56,  1.32s/it] 33%|███▎      | 157/471 [03:24<06:54,  1.32s/it] 34%|███▎      | 158/471 [03:25<06:52,  1.32s/it] 34%|███▍      | 159/471 [03:27<06:51,  1.32s/it] 34%|███▍      | 160/471 [03:28<06:50,  1.32s/it] 34%|███▍      | 161/471 [03:29<06:49,  1.32s/it] 34%|███▍      | 162/471 [03:31<06:48,  1.32s/it] 35%|███▍      | 163/471 [03:32<06:47,  1.32s/it] 35%|███▍      | 164/471 [03:33<06:46,  1.32s/it] 35%|███▌      | 165/471 [03:35<06:44,  1.32s/it] 35%|███▌      | 166/471 [03:36<06:43,  1.32s/it] 35%|███▌      | 167/471 [03:37<06:42,  1.32s/it] 36%|███▌      | 168/471 [03:39<06:40,  1.32s/it] 36%|███▌      | 169/471 [03:40<06:39,  1.32s/it] 36%|███▌      | 170/471 [03:41<06:37,  1.32s/it] 36%|███▋      | 171/471 [03:43<06:36,  1.32s/it] 37%|███▋      | 172/471 [03:44<06:34,  1.32s/it] 37%|███▋      | 173/471 [03:45<06:33,  1.32s/it] 37%|███▋      | 174/471 [03:47<06:32,  1.32s/it] 37%|███▋      | 175/471 [03:48<06:31,  1.32s/it] 37%|███▋      | 176/471 [03:49<06:29,  1.32s/it] 38%|███▊      | 177/471 [03:51<06:28,  1.32s/it] 38%|███▊      | 178/471 [03:52<06:26,  1.32s/it] 38%|███▊      | 179/471 [03:53<06:25,  1.32s/it] 38%|███▊      | 180/471 [03:54<06:24,  1.32s/it] 38%|███▊      | 181/471 [03:56<06:22,  1.32s/it] 39%|███▊      | 182/471 [03:57<06:21,  1.32s/it] 39%|███▉      | 183/471 [03:58<06:20,  1.32s/it] 39%|███▉      | 184/471 [04:00<06:18,  1.32s/it] 39%|███▉      | 185/471 [04:01<06:17,  1.32s/it] 39%|███▉      | 186/471 [04:02<06:16,  1.32s/it] 40%|███▉      | 187/471 [04:04<06:15,  1.32s/it] 40%|███▉      | 188/471 [04:05<06:14,  1.32s/it] 40%|████      | 189/471 [04:06<06:11,  1.32s/it] 40%|████      | 190/471 [04:08<06:10,  1.32s/it] 41%|████      | 191/471 [04:09<06:09,  1.32s/it] 41%|████      | 192/471 [04:10<06:08,  1.32s/it] 41%|████      | 193/471 [04:12<06:06,  1.32s/it] 41%|████      | 194/471 [04:13<06:05,  1.32s/it] 41%|████▏     | 195/471 [04:14<06:04,  1.32s/it] 42%|████▏     | 196/471 [04:16<06:02,  1.32s/it] 42%|████▏     | 197/471 [04:17<06:01,  1.32s/it] 42%|████▏     | 198/471 [04:18<05:59,  1.32s/it] 42%|████▏     | 199/471 [04:20<05:58,  1.32s/it] 42%|████▏     | 200/471 [04:21<05:57,  1.32s/it] 43%|████▎     | 201/471 [04:22<05:56,  1.32s/it] 43%|████▎     | 202/471 [04:23<05:54,  1.32s/it] 43%|████▎     | 203/471 [04:25<05:53,  1.32s/it] 43%|████▎     | 204/471 [04:26<05:52,  1.32s/it] 44%|████▎     | 205/471 [04:27<05:50,  1.32s/it] 44%|████▎     | 206/471 [04:29<05:49,  1.32s/it] 44%|████▍     | 207/471 [04:30<05:48,  1.32s/it] 44%|████▍     | 208/471 [04:31<05:46,  1.32s/it] 44%|████▍     | 209/471 [04:33<05:45,  1.32s/it] 45%|████▍     | 210/471 [04:34<05:44,  1.32s/it] 45%|████▍     | 211/471 [04:35<05:43,  1.32s/it] 45%|████▌     | 212/471 [04:37<05:42,  1.32s/it] 45%|████▌     | 213/471 [04:38<05:41,  1.32s/it] 45%|████▌     | 214/471 [04:39<05:39,  1.32s/it] 46%|████▌     | 215/471 [04:41<05:38,  1.32s/it] 46%|████▌     | 216/471 [04:42<05:37,  1.33s/it] 46%|████▌     | 217/471 [04:43<05:36,  1.33s/it] 46%|████▋     | 218/471 [04:45<05:35,  1.33s/it] 46%|████▋     | 219/471 [04:46<05:33,  1.33s/it] 47%|████▋     | 220/471 [04:47<05:32,  1.33s/it] 47%|████▋     | 221/471 [04:49<05:31,  1.33s/it] 47%|████▋     | 222/471 [04:50<05:29,  1.32s/it] 47%|████▋     | 223/471 [04:51<05:28,  1.32s/it] 48%|████▊     | 224/471 [04:53<05:26,  1.32s/it] 48%|████▊     | 225/471 [04:54<05:25,  1.32s/it] 48%|████▊     | 226/471 [04:55<05:24,  1.32s/it] 48%|████▊     | 227/471 [04:57<05:22,  1.32s/it] 48%|████▊     | 228/471 [04:58<05:21,  1.32s/it] 49%|████▊     | 229/471 [04:59<05:20,  1.32s/it] 49%|████▉     | 230/471 [05:01<05:19,  1.33s/it] 49%|████▉     | 231/471 [05:02<05:18,  1.33s/it] 49%|████▉     | 232/471 [05:03<05:16,  1.32s/it] 49%|████▉     | 233/471 [05:05<05:14,  1.32s/it] 50%|████▉     | 234/471 [05:06<05:13,  1.32s/it] 50%|████▉     | 235/471 [05:07<05:12,  1.33s/it] 50%|█████     | 236/471 [05:08<05:11,  1.32s/it] 50%|█████     | 237/471 [05:10<05:09,  1.32s/it] 51%|█████     | 238/471 [05:11<05:08,  1.32s/it] 51%|█████     | 239/471 [05:12<05:07,  1.32s/it] 51%|█████     | 240/471 [05:14<05:05,  1.32s/it] 51%|█████     | 241/471 [05:15<05:04,  1.33s/it] 51%|█████▏    | 242/471 [05:16<05:03,  1.32s/it] 52%|█████▏    | 243/471 [05:18<05:01,  1.32s/it] 52%|█████▏    | 244/471 [05:19<05:01,  1.33s/it] 52%|█████▏    | 245/471 [05:20<04:58,  1.32s/it] 52%|█████▏    | 246/471 [05:22<04:57,  1.32s/it] 52%|█████▏    | 247/471 [05:23<04:55,  1.32s/it] 53%|█████▎    | 248/471 [05:24<04:55,  1.32s/it] 53%|█████▎    | 249/471 [05:26<04:53,  1.32s/it] 53%|█████▎    | 250/471 [05:27<04:52,  1.32s/it] 53%|█████▎    | 251/471 [05:28<04:50,  1.32s/it] 54%|█████▎    | 252/471 [05:30<04:49,  1.32s/it] 54%|█████▎    | 253/471 [05:31<04:48,  1.32s/it] 54%|█████▍    | 254/471 [05:32<04:47,  1.32s/it] 54%|█████▍    | 255/471 [05:34<04:45,  1.32s/it] 54%|█████▍    | 256/471 [05:35<04:44,  1.32s/it] 55%|█████▍    | 257/471 [05:36<04:43,  1.32s/it] 55%|█████▍    | 258/471 [05:38<04:42,  1.33s/it] 55%|█████▍    | 259/471 [05:39<04:41,  1.33s/it] 55%|█████▌    | 260/471 [05:40<04:39,  1.33s/it] 55%|█████▌    | 261/471 [05:42<04:38,  1.33s/it] 56%|█████▌    | 262/471 [05:43<04:36,  1.32s/it] 56%|█████▌    | 263/471 [05:44<04:35,  1.33s/it] 56%|█████▌    | 264/471 [05:46<04:34,  1.32s/it] 56%|█████▋    | 265/471 [05:47<04:33,  1.33s/it] 56%|█████▋    | 266/471 [05:48<04:32,  1.33s/it] 57%|█████▋    | 267/471 [05:50<04:30,  1.33s/it] 57%|█████▋    | 268/471 [05:51<04:29,  1.33s/it] 57%|█████▋    | 269/471 [05:52<04:28,  1.33s/it] 57%|█████▋    | 270/471 [05:54<04:27,  1.33s/it] 58%|█████▊    | 271/471 [05:55<04:25,  1.33s/it] 58%|█████▊    | 272/471 [05:56<04:23,  1.33s/it] 58%|█████▊    | 273/471 [05:58<04:22,  1.33s/it] 58%|█████▊    | 274/471 [05:59<04:21,  1.33s/it] 58%|█████▊    | 275/471 [06:00<04:20,  1.33s/it] 59%|█████▊    | 276/471 [06:01<04:18,  1.33s/it] 59%|█████▉    | 277/471 [06:03<04:17,  1.33s/it] 59%|█████▉    | 278/471 [06:04<04:16,  1.33s/it] 59%|█████▉    | 279/471 [06:05<04:14,  1.33s/it] 59%|█████▉    | 280/471 [06:07<04:13,  1.33s/it] 60%|█████▉    | 281/471 [06:08<04:12,  1.33s/it] 60%|█████▉    | 282/471 [06:09<04:10,  1.33s/it] 60%|██████    | 283/471 [06:11<04:09,  1.33s/it] 60%|██████    | 284/471 [06:12<04:08,  1.33s/it] 61%|██████    | 285/471 [06:13<04:06,  1.33s/it] 61%|██████    | 286/471 [06:15<04:05,  1.33s/it] 61%|██████    | 287/471 [06:16<04:04,  1.33s/it] 61%|██████    | 288/471 [06:17<04:03,  1.33s/it] 61%|██████▏   | 289/471 [06:19<04:01,  1.33s/it] 62%|██████▏   | 290/471 [06:20<04:00,  1.33s/it] 62%|██████▏   | 291/471 [06:21<03:59,  1.33s/it] 62%|██████▏   | 292/471 [06:23<03:58,  1.33s/it] 62%|██████▏   | 293/471 [06:24<03:56,  1.33s/it] 62%|██████▏   | 294/471 [06:25<03:55,  1.33s/it] 63%|██████▎   | 295/471 [06:27<03:53,  1.33s/it] 63%|██████▎   | 296/471 [06:28<03:52,  1.33s/it] 63%|██████▎   | 297/471 [06:29<03:51,  1.33s/it] 63%|██████▎   | 298/471 [06:31<03:50,  1.33s/it] 63%|██████▎   | 299/471 [06:32<03:49,  1.33s/it] 64%|██████▎   | 300/471 [06:33<03:48,  1.33s/it] 64%|██████▍   | 301/471 [06:35<03:46,  1.33s/it] 64%|██████▍   | 302/471 [06:36<03:45,  1.33s/it] 64%|██████▍   | 303/471 [06:37<03:43,  1.33s/it] 65%|██████▍   | 304/471 [06:39<03:42,  1.33s/it] 65%|██████▍   | 305/471 [06:40<03:41,  1.33s/it] 65%|██████▍   | 306/471 [06:41<03:40,  1.33s/it] 65%|██████▌   | 307/471 [06:43<03:38,  1.33s/it] 65%|██████▌   | 308/471 [06:44<03:37,  1.34s/it] 66%|██████▌   | 309/471 [06:45<03:36,  1.34s/it] 66%|██████▌   | 310/471 [06:47<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:48<03:33,  1.34s/it] 66%|██████▌   | 312/471 [06:49<03:32,  1.34s/it] 66%|██████▋   | 313/471 [06:51<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:52<03:29,  1.34s/it] 67%|██████▋   | 315/471 [06:53<03:28,  1.34s/it] 67%|██████▋   | 316/471 [06:55<03:27,  1.34s/it] 67%|██████▋   | 317/471 [06:56<03:25,  1.34s/it] 68%|██████▊   | 318/471 [06:57<03:25,  1.34s/it] 68%|██████▊   | 319/471 [06:59<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:00<03:22,  1.34s/it] 68%|██████▊   | 321/471 [07:01<03:21,  1.34s/it] 68%|██████▊   | 322/471 [07:03<03:20,  1.34s/it] 69%|██████▊   | 323/471 [07:04<03:19,  1.34s/it] 69%|██████▉   | 324/471 [07:06<03:17,  1.35s/it] 69%|██████▉   | 325/471 [07:07<03:16,  1.35s/it] 69%|██████▉   | 326/471 [07:08<03:14,  1.34s/it] 69%|██████▉   | 327/471 [07:10<03:13,  1.34s/it] 70%|██████▉   | 328/471 [07:11<03:11,  1.34s/it] 70%|██████▉   | 329/471 [07:12<03:10,  1.34s/it] 70%|███████   | 330/471 [07:14<03:08,  1.34s/it] 70%|███████   | 331/471 [07:15<03:07,  1.34s/it] 70%|███████   | 332/471 [07:16<03:06,  1.34s/it] 71%|███████   | 333/471 [07:18<03:04,  1.34s/it] 71%|███████   | 334/471 [07:19<03:03,  1.34s/it] 71%|███████   | 335/471 [07:20<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:22<03:01,  1.34s/it] 72%|███████▏  | 337/471 [07:23<02:59,  1.34s/it] 72%|███████▏  | 338/471 [07:24<02:58,  1.34s/it] 72%|███████▏  | 339/471 [07:26<02:56,  1.34s/it] 72%|███████▏  | 340/471 [07:27<02:55,  1.34s/it] 72%|███████▏  | 341/471 [07:28<02:53,  1.34s/it] 73%|███████▎  | 342/471 [07:30<02:52,  1.33s/it] 73%|███████▎  | 343/471 [07:31<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:32<02:49,  1.33s/it] 73%|███████▎  | 345/471 [07:34<02:48,  1.34s/it] 73%|███████▎  | 346/471 [07:35<02:47,  1.34s/it] 74%|███████▎  | 347/471 [07:36<02:45,  1.33s/it] 74%|███████▍  | 348/471 [07:38<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:39<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:40<02:41,  1.34s/it] 75%|███████▍  | 351/471 [07:42<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:43<02:38,  1.33s/it] 75%|███████▍  | 353/471 [07:44<02:37,  1.34s/it] 75%|███████▌  | 354/471 [07:46<02:36,  1.34s/it] 75%|███████▌  | 355/471 [07:47<02:34,  1.33s/it] 76%|███████▌  | 356/471 [07:48<02:33,  1.33s/it] 76%|███████▌  | 357/471 [07:50<02:31,  1.33s/it] 76%|███████▌  | 358/471 [07:51<02:30,  1.33s/it] 76%|███████▌  | 359/471 [07:52<02:29,  1.33s/it] 76%|███████▋  | 360/471 [07:54<02:27,  1.33s/it] 77%|███████▋  | 361/471 [07:55<02:26,  1.33s/it] 77%|███████▋  | 362/471 [07:56<02:24,  1.33s/it] 77%|███████▋  | 363/471 [07:58<02:23,  1.33s/it] 77%|███████▋  | 364/471 [07:59<02:22,  1.33s/it] 77%|███████▋  | 365/471 [08:00<02:21,  1.33s/it] 78%|███████▊  | 366/471 [08:02<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:03<02:18,  1.33s/it] 78%|███████▊  | 368/471 [08:04<02:16,  1.33s/it] 78%|███████▊  | 369/471 [08:06<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:07<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:08<02:12,  1.33s/it] 79%|███████▉  | 372/471 [08:10<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:11<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:12<02:08,  1.33s/it] 80%|███████▉  | 375/471 [08:14<02:07,  1.33s/it] 80%|███████▉  | 376/471 [08:15<02:06,  1.33s/it] 80%|████████  | 377/471 [08:16<02:04,  1.33s/it] 80%|████████  | 378/471 [08:18<02:03,  1.33s/it] 80%|████████  | 379/471 [08:19<02:02,  1.33s/it] 81%|████████  | 380/471 [08:20<02:01,  1.33s/it] 81%|████████  | 381/471 [08:22<01:59,  1.33s/it] 81%|████████  | 382/471 [08:23<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:24<01:57,  1.33s/it] 82%|████████▏ | 384/471 [08:26<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:27<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:28<01:53,  1.33s/it] 82%|████████▏ | 387/471 [08:30<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:31<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:32<01:48,  1.33s/it] 83%|████████▎ | 390/471 [08:34<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:35<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:36<01:45,  1.33s/it] 83%|████████▎ | 393/471 [08:38<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:39<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:40<01:41,  1.33s/it] 84%|████████▍ | 396/471 [08:42<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:43<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:44<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:46<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:47<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:48<01:33,  1.33s/it] 85%|████████▌ | 402/471 [08:49<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:51<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:52<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:53<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:55<01:26,  1.33s/it] 86%|████████▋ | 407/471 [08:56<01:24,  1.33s/it] 87%|████████▋ | 408/471 [08:57<01:23,  1.33s/it] 87%|████████▋ | 409/471 [08:59<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:00<01:20,  1.33s/it] 87%|████████▋ | 411/471 [09:01<01:19,  1.32s/it] 87%|████████▋ | 412/471 [09:03<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:04<01:16,  1.33s/it] 88%|████████▊ | 414/471 [09:05<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:07<01:14,  1.32s/it] 88%|████████▊ | 416/471 [09:08<01:12,  1.33s/it] 89%|████████▊ | 417/471 [09:09<01:11,  1.32s/it] 89%|████████▊ | 418/471 [09:11<01:10,  1.32s/it] 89%|████████▉ | 419/471 [09:12<01:08,  1.32s/it] 89%|████████▉ | 420/471 [09:13<01:07,  1.32s/it] 89%|████████▉ | 421/471 [09:15<01:06,  1.32s/it] 90%|████████▉ | 422/471 [09:16<01:04,  1.32s/it] 90%|████████▉ | 423/471 [09:17<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:19<01:02,  1.32s/it] 90%|█████████ | 425/471 [09:20<01:00,  1.32s/it] 90%|█████████ | 426/471 [09:21<00:59,  1.32s/it] 91%|█████████ | 427/471 [09:23<00:58,  1.32s/it] 91%|█████████ | 428/471 [09:24<00:56,  1.32s/it] 91%|█████████ | 429/471 [09:25<00:55,  1.32s/it] 91%|█████████▏| 430/471 [09:27<00:54,  1.32s/it] 92%|█████████▏| 431/471 [09:28<00:52,  1.32s/it] 92%|█████████▏| 432/471 [09:29<00:51,  1.32s/it] 92%|█████████▏| 433/471 [09:31<00:50,  1.32s/it] 92%|█████████▏| 434/471 [09:32<00:48,  1.32s/it] 92%|█████████▏| 435/471 [09:33<00:47,  1.32s/it] 93%|█████████▎| 436/471 [09:34<00:46,  1.32s/it] 93%|█████████▎| 437/471 [09:36<00:44,  1.32s/it] 93%|█████████▎| 438/471 [09:37<00:43,  1.32s/it] 93%|█████████▎| 439/471 [09:38<00:42,  1.32s/it] 93%|█████████▎| 440/471 [09:40<00:40,  1.32s/it] 94%|█████████▎| 441/471 [09:41<00:39,  1.32s/it] 94%|█████████▍| 442/471 [09:42<00:38,  1.32s/it] 94%|█████████▍| 443/471 [09:44<00:36,  1.32s/it] 94%|█████████▍| 444/471 [09:45<00:35,  1.32s/it] 94%|█████████▍| 445/471 [09:46<00:34,  1.32s/it] 95%|█████████▍| 446/471 [09:48<00:33,  1.32s/it] 95%|█████████▍| 447/471 [09:49<00:31,  1.32s/it] 95%|█████████▌| 448/471 [09:50<00:30,  1.32s/it] 95%|█████████▌| 449/471 [09:52<00:29,  1.32s/it] 96%|█████████▌| 450/471 [09:53<00:27,  1.32s/it] 96%|█████████▌| 451/471 [09:54<00:26,  1.32s/it] 96%|█████████▌| 452/471 [09:56<00:25,  1.32s/it] 96%|█████████▌| 453/471 [09:57<00:23,  1.33s/it] 96%|█████████▋| 454/471 [09:58<00:22,  1.33s/it] 97%|█████████▋| 455/471 [10:00<00:21,  1.33s/it] 97%|█████████▋| 456/471 [10:01<00:19,  1.33s/it] 97%|█████████▋| 457/471 [10:02<00:18,  1.33s/it] 97%|█████████▋| 458/471 [10:04<00:17,  1.33s/it] 97%|█████████▋| 459/471 [10:05<00:15,  1.32s/it] 98%|█████████▊| 460/471 [10:06<00:14,  1.32s/it] 98%|█████████▊| 461/471 [10:08<00:13,  1.33s/it] 98%|█████████▊| 462/471 [10:09<00:11,  1.32s/it] 98%|█████████▊| 463/471 [10:10<00:10,  1.32s/it] 99%|█████████▊| 464/471 [10:12<00:09,  1.32s/it] 99%|█████████▊| 465/471 [10:13<00:07,  1.32s/it] 99%|█████████▉| 466/471 [10:14<00:06,  1.32s/it] 99%|█████████▉| 467/471 [10:16<00:05,  1.32s/it] 99%|█████████▉| 468/471 [10:17<00:03,  1.33s/it]100%|█████████▉| 469/471 [10:18<00:02,  1.33s/it]100%|█████████▉| 470/471 [10:20<00:01,  1.33s/it]100%|██████████| 471/471 [10:20<00:00,  1.22s/it]100%|██████████| 471/471 [10:20<00:00,  1.32s/it]
{'eval_loss': 4.52629280090332, 'eval_model_preparation_time': 0.0111, 'eval_acc': 0.2137546468401487, 'eval_runtime': 622.2164, 'eval_samples_per_second': 12.105, 'eval_steps_per_second': 0.757}
ROUND:7
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]                                              {'loss': 4.9918, 'grad_norm': 6.917294979095459, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 5.3898, 'grad_norm': 6.844494819641113, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.9426, 'grad_norm': 7.715857982635498, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.7479, 'grad_norm': 12.052873611450195, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 1.8568, 'grad_norm': 9.814265251159668, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it]                                              {'loss': 2.9985, 'grad_norm': 12.249344825744629, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.8643, 'grad_norm': 10.722746849060059, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.8948, 'grad_norm': 99.65691375732422, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.3048, 'grad_norm': 6.2888689041137695, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 0.7295, 'grad_norm': 5.836287975311279, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 0.5469, 'grad_norm': 5.342133522033691, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.1867, 'grad_norm': 4.7199177742004395, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 1.0395, 'grad_norm': 7.265676498413086, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.7775, 'grad_norm': 10.642402648925781, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.6461, 'grad_norm': 5.139126777648926, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.0045, 'grad_norm': 0.4223875105381012, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.5921, 'grad_norm': 2.7437796592712402, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.0835, 'grad_norm': 1.1744738817214966, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.1353, 'grad_norm': 1.7403501272201538, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.6113, 'grad_norm': 5.218225955963135, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.1316, 'grad_norm': 2.8304522037506104, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.1171, 'grad_norm': 1.797741413116455, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.3039, 'grad_norm': 2.196744203567505, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0958, 'grad_norm': 6.015673637390137, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.0869, 'grad_norm': 0.9215787649154663, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.1238, 'grad_norm': 0.9821053147315979, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0661, 'grad_norm': 2.1146576404571533, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.022, 'grad_norm': 0.2894686758518219, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.1377, 'grad_norm': 1.0335845947265625, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1407, 'grad_norm': 13.249262809753418, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0848, 'grad_norm': 2.196993827819824, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0318, 'grad_norm': 0.6912575364112854, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0145, 'grad_norm': 0.2333807647228241, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0106, 'grad_norm': 0.16034770011901855, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0475, 'grad_norm': 0.6275236010551453, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.0176, 'grad_norm': 0.3181370794773102, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.16s/it]                                               {'loss': 0.0336, 'grad_norm': 0.7384914755821228, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.0698, 'grad_norm': 3.661726236343384, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0492, 'grad_norm': 1.1527767181396484, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.64s/it]                                               {'loss': 0.0142, 'grad_norm': 0.4005904197692871, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.64s/it]                                               {'train_runtime': 78.9459, 'train_samples_per_second': 7.157, 'train_steps_per_second': 0.507, 'train_loss': 0.9485859476961196, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.64s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 5.0119, 'grad_norm': 8.071023941040039, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 3.4782, 'grad_norm': 5.160885810852051, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 4.1997, 'grad_norm': 11.551742553710938, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 2.6784, 'grad_norm': 10.515586853027344, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 2.1723, 'grad_norm': 13.798052787780762, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:16,  2.24s/it]                                              {'loss': 3.4705, 'grad_norm': 19.114805221557617, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:16,  2.24s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.24s/it]                                              {'loss': 2.6065, 'grad_norm': 19.424102783203125, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.24s/it] 20%|██        | 8/40 [00:15<00:52,  1.64s/it]                                              {'loss': 2.5058, 'grad_norm': 32.133628845214844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:52,  1.64s/it] 22%|██▎       | 9/40 [00:18<00:57,  1.85s/it]                                              {'loss': 1.7435, 'grad_norm': 8.650711059570312, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:57,  1.85s/it] 25%|██▌       | 10/40 [00:20<00:58,  1.97s/it]                                               {'loss': 1.9746, 'grad_norm': 8.534859657287598, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:58,  1.97s/it] 28%|██▊       | 11/40 [00:22<00:59,  2.05s/it]                                               {'loss': 1.4903, 'grad_norm': 9.581421852111816, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:59,  2.05s/it] 30%|███       | 12/40 [00:24<00:58,  2.10s/it]                                               {'loss': 1.4844, 'grad_norm': 7.658321857452393, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.10s/it] 32%|███▎      | 13/40 [00:27<00:57,  2.13s/it]                                               {'loss': 1.3737, 'grad_norm': 13.632689476013184, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it]                                               {'loss': 0.9744, 'grad_norm': 5.982036590576172, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 1.2787, 'grad_norm': 61.887943267822266, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.0527, 'grad_norm': 2.9553754329681396, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:34<00:41,  1.79s/it]                                               {'loss': 1.4613, 'grad_norm': 61.27225112915039, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.91s/it]                                               {'loss': 1.6192, 'grad_norm': 18.004915237426758, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it]                                               {'loss': 1.5585, 'grad_norm': 31.42919921875, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.9428, 'grad_norm': 12.026503562927246, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.6468, 'grad_norm': 35.34381866455078, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it]                                               {'loss': 0.6673, 'grad_norm': 5.7113142013549805, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.7107, 'grad_norm': 4.559808254241943, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.4776, 'grad_norm': 21.806060791015625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.2628, 'grad_norm': 1.6082342863082886, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.93s/it]                                               {'loss': 0.7564, 'grad_norm': 4.211722373962402, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.5307, 'grad_norm': 3.3860411643981934, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.2396, 'grad_norm': 1.7413800954818726, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.16s/it]                                               {'loss': 0.1359, 'grad_norm': 2.3570828437805176, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it]                                               {'loss': 0.6019, 'grad_norm': 3.4152309894561768, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it]                                               {'loss': 0.2985, 'grad_norm': 4.8221917152404785, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it] 80%|████████  | 32/40 [01:04<00:13,  1.70s/it]                                               {'loss': 0.0036, 'grad_norm': 0.2766871154308319, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:04<00:13,  1.70s/it] 82%|████████▎ | 33/40 [01:06<00:13,  1.91s/it]                                               {'loss': 0.2396, 'grad_norm': 6.624119758605957, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:13,  1.91s/it] 85%|████████▌ | 34/40 [01:08<00:12,  2.02s/it]                                               {'loss': 0.1304, 'grad_norm': 3.485154390335083, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:12,  2.02s/it] 88%|████████▊ | 35/40 [01:11<00:10,  2.11s/it]                                               {'loss': 0.2713, 'grad_norm': 3.8934197425842285, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:11<00:10,  2.11s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.17s/it]                                               {'loss': 1.2794, 'grad_norm': 17.4780330657959, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.17s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.24s/it]                                               {'loss': 2.3509, 'grad_norm': 12.59732723236084, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.24s/it] 95%|█████████▌| 38/40 [01:18<00:04,  2.30s/it]                                               {'loss': 3.095, 'grad_norm': 35.261173248291016, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:18<00:04,  2.30s/it] 98%|█████████▊| 39/40 [01:20<00:02,  2.33s/it]                                               {'loss': 1.5359, 'grad_norm': 13.075033187866211, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:20<00:02,  2.33s/it]100%|██████████| 40/40 [01:21<00:00,  1.79s/it]                                               {'loss': 2.241, 'grad_norm': 14.719748497009277, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:21<00:00,  1.79s/it]                                               {'train_runtime': 81.9134, 'train_samples_per_second': 6.898, 'train_steps_per_second': 0.488, 'train_loss': 1.4638162802788428, 'epoch': 5.0}
100%|██████████| 40/40 [01:21<00:00,  1.79s/it]100%|██████████| 40/40 [01:21<00:00,  2.05s/it]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.09s/it]                                              {'loss': 4.1275, 'grad_norm': 5.965890407562256, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.09s/it]  5%|▌         | 2/40 [00:04<01:19,  2.10s/it]                                              {'loss': 3.99, 'grad_norm': 4.78824520111084, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:19,  2.10s/it]  8%|▊         | 3/40 [00:06<01:18,  2.12s/it]                                              {'loss': 4.1093, 'grad_norm': 9.413263320922852, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.12s/it] 10%|█         | 4/40 [00:08<01:16,  2.13s/it]                                              {'loss': 2.9951, 'grad_norm': 9.56750202178955, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.13s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it]                                              {'loss': 4.2196, 'grad_norm': 19.632009506225586, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it]                                              {'loss': 2.9039, 'grad_norm': 10.7239351272583, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it] 18%|█▊        | 7/40 [00:14<01:11,  2.16s/it]                                              {'loss': 1.7094, 'grad_norm': 9.9186429977417, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 6.2609, 'grad_norm': 86.87952423095703, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 0.5919, 'grad_norm': 7.139227867126465, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it]                                               {'loss': 1.9462, 'grad_norm': 10.042240142822266, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it]                                               {'loss': 2.1133, 'grad_norm': 8.097491264343262, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 1.7924, 'grad_norm': 5.699028015136719, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:25<00:55,  2.07s/it]                                               {'loss': 1.1471, 'grad_norm': 5.298960208892822, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:25<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.7597, 'grad_norm': 10.721874237060547, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 0.6587, 'grad_norm': 4.430054664611816, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:30<00:38,  1.61s/it]                                               {'loss': 0.4, 'grad_norm': 21.495990753173828, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:38,  1.61s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it]                                               {'loss': 0.6936, 'grad_norm': 4.29170560836792, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.4532, 'grad_norm': 7.774423599243164, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.2973, 'grad_norm': 2.9924347400665283, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.2075, 'grad_norm': 2.3649704456329346, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.12s/it]                                               {'loss': 0.8243, 'grad_norm': 7.947341442108154, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.6448, 'grad_norm': 6.2446112632751465, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 1.0864, 'grad_norm': 10.680623054504395, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.61s/it]                                               {'loss': 0.196, 'grad_norm': 7.102501392364502, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:48<00:27,  1.82s/it]                                               {'loss': 0.0797, 'grad_norm': 1.0421522855758667, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:27,  1.82s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it]                                               {'loss': 0.5931, 'grad_norm': 3.400449752807617, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it]                                               {'loss': 0.6788, 'grad_norm': 2.238460063934326, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it] 70%|███████   | 28/40 [00:55<00:25,  2.12s/it]                                               {'loss': 0.1269, 'grad_norm': 1.2572920322418213, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.16s/it]                                               {'loss': 0.2563, 'grad_norm': 2.9049410820007324, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.235, 'grad_norm': 8.451273918151855, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1333, 'grad_norm': 2.7772018909454346, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.1179, 'grad_norm': 3.9611499309539795, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.3113, 'grad_norm': 3.3850631713867188, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0257, 'grad_norm': 1.3158389329910278, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it]                                               {'loss': 0.1406, 'grad_norm': 2.616041421890259, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.6374, 'grad_norm': 2.744244337081909, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.17s/it]                                               {'loss': 0.5112, 'grad_norm': 4.937047481536865, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.2847, 'grad_norm': 2.5360541343688965, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.24s/it]                                               {'loss': 0.4326, 'grad_norm': 1.5039423704147339, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.24s/it]100%|██████████| 40/40 [01:18<00:00,  1.68s/it]                                               {'loss': 0.0003, 'grad_norm': 0.016705650836229324, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.68s/it]                                               {'train_runtime': 80.6144, 'train_samples_per_second': 7.009, 'train_steps_per_second': 0.496, 'train_loss': 1.242317686026945, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.68s/it]100%|██████████| 40/40 [01:20<00:00,  2.02s/it]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.10s/it]                                              {'loss': 5.0192, 'grad_norm': 6.424674987792969, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.10s/it]  5%|▌         | 2/40 [00:04<01:20,  2.11s/it]                                              {'loss': 2.0861, 'grad_norm': 5.579705238342285, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.11s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 3.2467, 'grad_norm': 7.012333393096924, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:16,  2.13s/it]                                              {'loss': 3.4284, 'grad_norm': 11.107611656188965, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.13s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it]                                              {'loss': 3.9283, 'grad_norm': 16.969038009643555, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.12s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it]                                              {'loss': 3.1591, 'grad_norm': 16.476917266845703, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.15s/it]                                              {'loss': 2.52, 'grad_norm': 20.955350875854492, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.15s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 0.7016, 'grad_norm': 34.91558837890625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 1.6547, 'grad_norm': 14.171806335449219, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.83s/it]                                               {'loss': 1.3862, 'grad_norm': 9.619466781616211, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.83s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it]                                               {'loss': 1.8251, 'grad_norm': 5.766705513000488, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it] 30%|███       | 12/40 [00:23<00:56,  2.01s/it]                                               {'loss': 0.7826, 'grad_norm': 6.843429088592529, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.01s/it] 32%|███▎      | 13/40 [00:25<00:55,  2.07s/it]                                               {'loss': 1.0921, 'grad_norm': 6.681116580963135, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:25<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 0.7644, 'grad_norm': 24.607261657714844, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 1.6289, 'grad_norm': 10.48497486114502, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 5.0804, 'grad_norm': 378.9209289550781, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it]                                               {'loss': 0.6941, 'grad_norm': 7.9106292724609375, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:34<00:40,  1.86s/it]                                               {'loss': 1.2924, 'grad_norm': 7.28348445892334, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:40,  1.86s/it] 48%|████▊     | 19/40 [00:36<00:41,  1.96s/it]                                               {'loss': 0.8868, 'grad_norm': 4.209726333618164, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:36<00:41,  1.96s/it] 50%|█████     | 20/40 [00:39<00:40,  2.03s/it]                                               {'loss': 1.0702, 'grad_norm': 7.494724273681641, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.03s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it]                                               {'loss': 0.6882, 'grad_norm': 9.085519790649414, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it] 55%|█████▌    | 22/40 [00:43<00:37,  2.11s/it]                                               {'loss': 0.8139, 'grad_norm': 8.069028854370117, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:37,  2.11s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it]                                               {'loss': 0.6718, 'grad_norm': 8.937387466430664, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.15s/it] 60%|██████    | 24/40 [00:45<00:24,  1.56s/it]                                               {'loss': 0.0402, 'grad_norm': 2.166043519973755, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:45<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.9383, 'grad_norm': 5.3325114250183105, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.7317, 'grad_norm': 5.29717493057251, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it]                                               {'loss': 0.9602, 'grad_norm': 7.765038013458252, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it] 70%|███████   | 28/40 [00:54<00:24,  2.05s/it]                                               {'loss': 0.2999, 'grad_norm': 5.200369834899902, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.4208, 'grad_norm': 1.558449387550354, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.4676, 'grad_norm': 3.249927520751953, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it]                                               {'loss': 0.4592, 'grad_norm': 4.8014116287231445, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.1851, 'grad_norm': 13.415680885314941, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.76s/it]                                               {'loss': 0.1715, 'grad_norm': 2.0279159545898438, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.101, 'grad_norm': 1.4171470403671265, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it]                                               {'loss': 0.5174, 'grad_norm': 2.548963785171509, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it]                                               {'loss': 0.5477, 'grad_norm': 34.71812057495117, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.11s/it]                                               {'loss': 0.2896, 'grad_norm': 5.78776216506958, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.11s/it] 95%|█████████▌| 38/40 [01:14<00:04,  2.15s/it]                                               {'loss': 0.4435, 'grad_norm': 5.515240669250488, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:14<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.5449, 'grad_norm': 17.562437057495117, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.043, 'grad_norm': 1.5413881540298462, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 77.6485, 'train_samples_per_second': 7.276, 'train_steps_per_second': 0.515, 'train_loss': 1.2895760223269463, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]100%|██████████| 40/40 [01:17<00:00,  1.94s/it]
CLIENT:44
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 5.0343, 'grad_norm': 6.526285648345947, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 4.3952, 'grad_norm': 10.95781421661377, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 4.3631, 'grad_norm': 7.173907279968262, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.1268, 'grad_norm': 13.192547798156738, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 3.8632, 'grad_norm': 17.546424865722656, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.15s/it]                                              {'loss': 4.0284, 'grad_norm': 29.028398513793945, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.15s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 3.4767, 'grad_norm': 46.28232192993164, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 3.6817, 'grad_norm': 91.53179168701172, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 2.9352, 'grad_norm': 25.72739601135254, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 2.5628, 'grad_norm': 19.264802932739258, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 3.4253, 'grad_norm': 23.80760955810547, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 2.7085, 'grad_norm': 42.265499114990234, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 2.6099, 'grad_norm': 67.8560562133789, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 4.2651, 'grad_norm': 22.57939910888672, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 3.1317, 'grad_norm': 96.80702209472656, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.1918, 'grad_norm': 33.12710952758789, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it]                                               {'loss': 1.5932, 'grad_norm': 19.65660858154297, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 2.0525, 'grad_norm': 20.94080924987793, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 1.6929, 'grad_norm': 11.800843238830566, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 1.5948, 'grad_norm': 22.039981842041016, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 1.124, 'grad_norm': 7.171100616455078, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 1.3247, 'grad_norm': 15.308272361755371, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 1.4324, 'grad_norm': 8.49581241607666, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 3.5088, 'grad_norm': 404.416748046875, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.3121, 'grad_norm': 5.4695258140563965, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 1.3889, 'grad_norm': 9.194744110107422, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.8118, 'grad_norm': 15.13853931427002, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.753, 'grad_norm': 10.052103996276855, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.8901, 'grad_norm': 5.697894096374512, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.17s/it]                                               {'loss': 1.5687, 'grad_norm': 16.99559211730957, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 1.0917, 'grad_norm': 9.652362823486328, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 2.7723, 'grad_norm': 38.926513671875, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1404, 'grad_norm': 2.2750988006591797, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.93s/it]                                               {'loss': 0.8164, 'grad_norm': 6.548494338989258, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.3275, 'grad_norm': 9.129911422729492, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.5816, 'grad_norm': 7.453182697296143, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.8193, 'grad_norm': 22.927505493164062, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 0.2305, 'grad_norm': 10.611581802368164, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.775, 'grad_norm': 12.9806489944458, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.5418, 'grad_norm': 17.76039695739746, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.4989, 'train_samples_per_second': 7.198, 'train_steps_per_second': 0.51, 'train_loss': 2.0486005555838345, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 2.9578, 'grad_norm': 7.00584077835083, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 3.5496, 'grad_norm': 7.371005535125732, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.0841, 'grad_norm': 8.609286308288574, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 2.6989, 'grad_norm': 9.485876083374023, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.9023, 'grad_norm': 12.15727710723877, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.2057, 'grad_norm': 15.489944458007812, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 2.2308, 'grad_norm': 15.363091468811035, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.4812, 'grad_norm': 19.753393173217773, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.1219, 'grad_norm': 15.983534812927246, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 0.5532, 'grad_norm': 10.242453575134277, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.4942, 'grad_norm': 5.602583885192871, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.8369, 'grad_norm': 6.0321478843688965, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.7145, 'grad_norm': 5.063701152801514, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.307, 'grad_norm': 3.510617971420288, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.5546, 'grad_norm': 5.915682792663574, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0007, 'grad_norm': 0.03459039703011513, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.2929, 'grad_norm': 3.326422929763794, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.2433, 'grad_norm': 2.554476737976074, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.2475, 'grad_norm': 2.5083768367767334, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.0645, 'grad_norm': 0.9500585794448853, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.0792, 'grad_norm': 1.3451586961746216, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.2563, 'grad_norm': 1.8832772970199585, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.4123, 'grad_norm': 3.5200083255767822, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.0223, 'grad_norm': 1.3043335676193237, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.0728, 'grad_norm': 1.5438991785049438, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.028, 'grad_norm': 0.47760826349258423, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.1391, 'grad_norm': 4.930640697479248, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.1417, 'grad_norm': 10.930957794189453, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1145, 'grad_norm': 4.113610744476318, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0275, 'grad_norm': 0.504214346408844, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0591, 'grad_norm': 0.8729799389839172, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.3916, 'grad_norm': 38.5328483581543, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0402, 'grad_norm': 0.817041277885437, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.048, 'grad_norm': 1.9710943698883057, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.0377, 'grad_norm': 0.8096141815185547, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0325, 'grad_norm': 0.4739155173301697, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0359, 'grad_norm': 0.783079981803894, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.025, 'grad_norm': 0.9166547060012817, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0369, 'grad_norm': 1.5007362365722656, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'loss': 0.0052, 'grad_norm': 0.20372191071510315, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'train_runtime': 79.305, 'train_samples_per_second': 7.124, 'train_steps_per_second': 0.504, 'train_loss': 0.6636872048547957, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:24
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]                                              {'loss': 4.7642, 'grad_norm': 5.7736496925354, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]  5%|▌         | 2/40 [00:04<01:23,  2.21s/it]                                              {'loss': 4.5859, 'grad_norm': 6.868086338043213, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.21s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 4.5105, 'grad_norm': 9.815649032592773, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 2.3204, 'grad_norm': 8.040358543395996, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.5102, 'grad_norm': 13.786028861999512, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 2.9929, 'grad_norm': 12.950715065002441, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 3.1716, 'grad_norm': 10.315729141235352, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 8.0398, 'grad_norm': 21.079166412353516, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.1772, 'grad_norm': 5.62272310256958, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 1.9005, 'grad_norm': 8.377902030944824, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 2.2407, 'grad_norm': 9.436659812927246, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.3216, 'grad_norm': 11.175176620483398, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.4686, 'grad_norm': 7.236147403717041, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.9865, 'grad_norm': 7.996870994567871, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.932, 'grad_norm': 4.672520637512207, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0271, 'grad_norm': 0.799415647983551, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.8574, 'grad_norm': 3.3842945098876953, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 0.7594, 'grad_norm': 5.939474105834961, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.6476, 'grad_norm': 5.5243754386901855, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.6592, 'grad_norm': 6.829084396362305, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.09s/it]                                               {'loss': 0.6385, 'grad_norm': 3.771761417388916, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.1874, 'grad_norm': 2.022312879562378, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.4021, 'grad_norm': 2.3573780059814453, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 1.0654, 'grad_norm': 27.30440330505371, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.2516, 'grad_norm': 2.3985211849212646, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.6053, 'grad_norm': 4.7815327644348145, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.5089, 'grad_norm': 5.668494701385498, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.2525, 'grad_norm': 3.8146369457244873, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.3093, 'grad_norm': 3.2489099502563477, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.3361, 'grad_norm': 5.409786701202393, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.401, 'grad_norm': 5.5453267097473145, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.8985, 'grad_norm': 9.459516525268555, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.2528, 'grad_norm': 2.1751716136932373, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.1002, 'grad_norm': 1.613303303718567, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0902, 'grad_norm': 1.1721150875091553, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.6075, 'grad_norm': 5.299849033355713, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.26, 'grad_norm': 7.780580520629883, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.2386, 'grad_norm': 2.7142727375030518, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.4422, 'grad_norm': 1.23674476146698, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.1652, 'grad_norm': 9.455347061157227, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.7609, 'train_samples_per_second': 7.174, 'train_steps_per_second': 0.508, 'train_loss': 1.3971686290577054, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:98
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 6.3227, 'grad_norm': 9.172285079956055, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 3.0543, 'grad_norm': 5.543833255767822, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 2.8111, 'grad_norm': 11.13241195678711, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:16,  2.14s/it]                                              {'loss': 2.7236, 'grad_norm': 10.359736442565918, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it]                                              {'loss': 3.3018, 'grad_norm': 11.142797470092773, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 1.4028, 'grad_norm': 6.249959945678711, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.6526, 'grad_norm': 10.599422454833984, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 9.0694, 'grad_norm': 50.268882751464844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.2476, 'grad_norm': 5.501626014709473, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.6894, 'grad_norm': 13.019073486328125, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 0.5089, 'grad_norm': 3.915372133255005, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:23<00:56,  2.03s/it]                                               {'loss': 0.6323, 'grad_norm': 4.6342973709106445, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 1.4445, 'grad_norm': 6.6024675369262695, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.621, 'grad_norm': 3.585508346557617, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.4894, 'grad_norm': 3.8234047889709473, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0188, 'grad_norm': 1.27456796169281, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it]                                               {'loss': 0.4337, 'grad_norm': 9.362956047058105, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.3069, 'grad_norm': 6.7350358963012695, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 1.2818, 'grad_norm': 56.35356903076172, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.6685, 'grad_norm': 5.342668533325195, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.1021, 'grad_norm': 1.5278775691986084, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.3338, 'grad_norm': 4.509291172027588, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.7599, 'grad_norm': 5.732954978942871, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0197, 'grad_norm': 0.8803707957267761, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.2896, 'grad_norm': 2.415910005569458, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.1114, 'grad_norm': 3.8388991355895996, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.3191, 'grad_norm': 2.4722721576690674, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.1791, 'grad_norm': 2.4184374809265137, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.3871, 'grad_norm': 13.582386016845703, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.18s/it]                                               {'loss': 0.1437, 'grad_norm': 2.3605995178222656, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.4565, 'grad_norm': 7.073991775512695, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.18, 'grad_norm': 7.896647930145264, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.6516, 'grad_norm': 5.878889560699463, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.045, 'grad_norm': 0.8278828263282776, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0292, 'grad_norm': 0.6960681080818176, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0857, 'grad_norm': 2.7942028045654297, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0608, 'grad_norm': 0.8053913712501526, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.1167, 'grad_norm': 1.7375967502593994, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0784, 'grad_norm': 2.073418617248535, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.008, 'grad_norm': 0.2761326730251312, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.4665, 'train_samples_per_second': 7.201, 'train_steps_per_second': 0.51, 'train_loss': 1.12596667886246, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 3.7456, 'grad_norm': 7.210831642150879, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 4.3214, 'grad_norm': 6.739349842071533, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.0675, 'grad_norm': 7.444908618927002, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.7312, 'grad_norm': 9.12520694732666, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 2.5694, 'grad_norm': 9.296878814697266, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it]                                              {'loss': 1.9426, 'grad_norm': 8.582511901855469, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 2.1807, 'grad_norm': 14.705424308776855, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 0.226, 'grad_norm': 9.520429611206055, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.3466, 'grad_norm': 4.2826080322265625, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.8778, 'grad_norm': 7.9398884773254395, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it]                                               {'loss': 0.6396, 'grad_norm': 5.037116050720215, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.6063, 'grad_norm': 3.336760997772217, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.2227, 'grad_norm': 2.3844921588897705, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 0.5406, 'grad_norm': 4.2930216789245605, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 1.2081, 'grad_norm': 8.077831268310547, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 3.2189, 'grad_norm': 14.573456764221191, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it]                                               {'loss': 0.1073, 'grad_norm': 1.1930149793624878, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.388, 'grad_norm': 2.1504721641540527, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.2006, 'grad_norm': 1.191782832145691, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.2628, 'grad_norm': 1.2781543731689453, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.4399, 'grad_norm': 4.224893093109131, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.2835, 'grad_norm': 6.5906291007995605, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 1.2705, 'grad_norm': 15.019311904907227, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 1.1238, 'grad_norm': 39.72881317138672, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.1375, 'grad_norm': 5.779610633850098, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.0204, 'grad_norm': 0.3888527452945709, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.1812, 'grad_norm': 2.768986940383911, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.2046, 'grad_norm': 3.4804062843322754, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.4706, 'grad_norm': 3.7469937801361084, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.1388, 'grad_norm': 1.8539342880249023, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.2727, 'grad_norm': 1.226988434791565, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.1389, 'grad_norm': 7.697062969207764, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0179, 'grad_norm': 0.5636441111564636, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.0247, 'grad_norm': 0.5547378063201904, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it]                                               {'loss': 0.1713, 'grad_norm': 0.5770089626312256, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.0319, 'grad_norm': 0.8234863877296448, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.11s/it]                                               {'loss': 0.1101, 'grad_norm': 1.4666390419006348, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.11s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.0929, 'grad_norm': 1.4192931652069092, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.3551, 'grad_norm': 4.262034893035889, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0001, 'grad_norm': 0.005682341288775206, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.3073, 'train_samples_per_second': 7.215, 'train_steps_per_second': 0.511, 'train_loss': 0.9222537731780903, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:95
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 5.1459, 'grad_norm': 7.190282821655273, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 4.2019, 'grad_norm': 9.615036964416504, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.6668, 'grad_norm': 7.287322521209717, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 2.4615, 'grad_norm': 11.340475082397461, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 1.9617, 'grad_norm': 12.947019577026367, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 5.0672, 'grad_norm': 20.056720733642578, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 2.3408, 'grad_norm': 14.949117660522461, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 3.8737, 'grad_norm': 94.10408020019531, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 2.2669, 'grad_norm': 33.09749221801758, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 2.3, 'grad_norm': 24.97752571105957, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 2.7438, 'grad_norm': 16.212581634521484, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 2.6312, 'grad_norm': 22.90830421447754, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.2968, 'grad_norm': 8.889710426330566, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.2167, 'grad_norm': 8.397492408752441, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.488, 'grad_norm': 8.70798397064209, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 1.5934, 'grad_norm': 33.67055130004883, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.5769, 'grad_norm': 5.388692855834961, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.6758, 'grad_norm': 16.53764533996582, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 1.0717, 'grad_norm': 33.918426513671875, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 1.5329, 'grad_norm': 8.479811668395996, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 1.0278, 'grad_norm': 5.98816442489624, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.7015, 'grad_norm': 8.299494743347168, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.9397, 'grad_norm': 7.96402645111084, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 2.7962, 'grad_norm': 22.86138343811035, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.6212, 'grad_norm': 6.1042656898498535, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.88s/it]                                               {'loss': 0.4764, 'grad_norm': 4.967103481292725, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.6523, 'grad_norm': 6.1546406745910645, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.4582, 'grad_norm': 5.180520534515381, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.7705, 'grad_norm': 6.164645671844482, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.3388, 'grad_norm': 4.675374984741211, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.826, 'grad_norm': 6.207249641418457, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.2525, 'grad_norm': 7.454899311065674, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.227, 'grad_norm': 2.557044744491577, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.288, 'grad_norm': 6.686066150665283, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.3952, 'grad_norm': 6.100607872009277, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.3465, 'grad_norm': 12.094730377197266, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.6141, 'grad_norm': 9.100502014160156, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.8469, 'grad_norm': 6.2220964431762695, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.2316, 'grad_norm': 2.9295945167541504, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0545, 'grad_norm': 2.2968504428863525, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.6524, 'train_samples_per_second': 7.184, 'train_steps_per_second': 0.509, 'train_loss': 1.4994525234214962, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:50,  1.61it/s]  1%|          | 3/471 [00:02<06:51,  1.14it/s]  1%|          | 4/471 [00:03<07:54,  1.02s/it]  1%|          | 5/471 [00:04<08:31,  1.10s/it]  1%|▏         | 6/471 [00:06<08:54,  1.15s/it]  1%|▏         | 7/471 [00:07<09:09,  1.18s/it]  2%|▏         | 8/471 [00:08<09:19,  1.21s/it]  2%|▏         | 9/471 [00:10<09:24,  1.22s/it]  2%|▏         | 10/471 [00:11<09:28,  1.23s/it]  2%|▏         | 11/471 [00:12<09:30,  1.24s/it]  3%|▎         | 12/471 [00:13<09:32,  1.25s/it]  3%|▎         | 13/471 [00:15<09:34,  1.25s/it]  3%|▎         | 14/471 [00:16<09:34,  1.26s/it]  3%|▎         | 15/471 [00:17<09:34,  1.26s/it]  3%|▎         | 16/471 [00:18<09:34,  1.26s/it]  4%|▎         | 17/471 [00:20<09:34,  1.27s/it]  4%|▍         | 18/471 [00:21<09:34,  1.27s/it]  4%|▍         | 19/471 [00:22<09:33,  1.27s/it]  4%|▍         | 20/471 [00:23<09:33,  1.27s/it]  4%|▍         | 21/471 [00:25<09:32,  1.27s/it]  5%|▍         | 22/471 [00:26<09:32,  1.27s/it]  5%|▍         | 23/471 [00:27<09:31,  1.28s/it]  5%|▌         | 24/471 [00:29<09:30,  1.28s/it]  5%|▌         | 25/471 [00:30<09:29,  1.28s/it]  6%|▌         | 26/471 [00:31<09:29,  1.28s/it]  6%|▌         | 27/471 [00:32<09:28,  1.28s/it]  6%|▌         | 28/471 [00:34<09:27,  1.28s/it]  6%|▌         | 29/471 [00:35<09:26,  1.28s/it]  6%|▋         | 30/471 [00:36<09:26,  1.28s/it]  7%|▋         | 31/471 [00:38<09:26,  1.29s/it]  7%|▋         | 32/471 [00:39<09:24,  1.29s/it]  7%|▋         | 33/471 [00:40<09:21,  1.28s/it]  7%|▋         | 34/471 [00:41<09:21,  1.28s/it]  7%|▋         | 35/471 [00:43<09:20,  1.29s/it]  8%|▊         | 36/471 [00:44<09:19,  1.29s/it]  8%|▊         | 37/471 [00:45<09:19,  1.29s/it]  8%|▊         | 38/471 [00:47<09:18,  1.29s/it]  8%|▊         | 39/471 [00:48<09:17,  1.29s/it]  8%|▊         | 40/471 [00:49<09:16,  1.29s/it]  9%|▊         | 41/471 [00:50<09:15,  1.29s/it]  9%|▉         | 42/471 [00:52<09:15,  1.29s/it]  9%|▉         | 43/471 [00:53<09:13,  1.29s/it]  9%|▉         | 44/471 [00:54<09:11,  1.29s/it] 10%|▉         | 45/471 [00:56<09:12,  1.30s/it] 10%|▉         | 46/471 [00:57<09:10,  1.30s/it] 10%|▉         | 47/471 [00:58<09:08,  1.29s/it] 10%|█         | 48/471 [01:00<09:07,  1.30s/it] 10%|█         | 49/471 [01:01<09:07,  1.30s/it] 11%|█         | 50/471 [01:02<09:06,  1.30s/it] 11%|█         | 51/471 [01:03<09:05,  1.30s/it] 11%|█         | 52/471 [01:05<09:03,  1.30s/it] 11%|█▏        | 53/471 [01:06<09:02,  1.30s/it] 11%|█▏        | 54/471 [01:07<09:02,  1.30s/it] 12%|█▏        | 55/471 [01:09<09:01,  1.30s/it] 12%|█▏        | 56/471 [01:10<09:00,  1.30s/it] 12%|█▏        | 57/471 [01:11<08:59,  1.30s/it] 12%|█▏        | 58/471 [01:13<08:58,  1.30s/it] 13%|█▎        | 59/471 [01:14<08:58,  1.31s/it] 13%|█▎        | 60/471 [01:15<08:56,  1.31s/it] 13%|█▎        | 61/471 [01:16<08:55,  1.31s/it] 13%|█▎        | 62/471 [01:18<08:54,  1.31s/it] 13%|█▎        | 63/471 [01:19<08:52,  1.31s/it] 14%|█▎        | 64/471 [01:20<08:51,  1.31s/it] 14%|█▍        | 65/471 [01:22<08:49,  1.30s/it] 14%|█▍        | 66/471 [01:23<08:48,  1.31s/it] 14%|█▍        | 67/471 [01:24<08:48,  1.31s/it] 14%|█▍        | 68/471 [01:26<08:46,  1.31s/it] 15%|█▍        | 69/471 [01:27<08:44,  1.31s/it] 15%|█▍        | 70/471 [01:28<08:44,  1.31s/it] 15%|█▌        | 71/471 [01:30<08:43,  1.31s/it] 15%|█▌        | 72/471 [01:31<08:41,  1.31s/it] 15%|█▌        | 73/471 [01:32<08:40,  1.31s/it] 16%|█▌        | 74/471 [01:33<08:38,  1.31s/it] 16%|█▌        | 75/471 [01:35<08:37,  1.31s/it] 16%|█▌        | 76/471 [01:36<08:36,  1.31s/it] 16%|█▋        | 77/471 [01:37<08:35,  1.31s/it] 17%|█▋        | 78/471 [01:39<08:33,  1.31s/it] 17%|█▋        | 79/471 [01:40<08:33,  1.31s/it] 17%|█▋        | 80/471 [01:41<08:32,  1.31s/it] 17%|█▋        | 81/471 [01:43<08:30,  1.31s/it] 17%|█▋        | 82/471 [01:44<08:28,  1.31s/it] 18%|█▊        | 83/471 [01:45<08:28,  1.31s/it] 18%|█▊        | 84/471 [01:47<08:26,  1.31s/it] 18%|█▊        | 85/471 [01:48<08:26,  1.31s/it] 18%|█▊        | 86/471 [01:49<08:25,  1.31s/it] 18%|█▊        | 87/471 [01:50<08:23,  1.31s/it] 19%|█▊        | 88/471 [01:52<08:22,  1.31s/it] 19%|█▉        | 89/471 [01:53<08:20,  1.31s/it] 19%|█▉        | 90/471 [01:54<08:20,  1.31s/it] 19%|█▉        | 91/471 [01:56<08:18,  1.31s/it] 20%|█▉        | 92/471 [01:57<08:17,  1.31s/it] 20%|█▉        | 93/471 [01:58<08:15,  1.31s/it] 20%|█▉        | 94/471 [02:00<08:14,  1.31s/it] 20%|██        | 95/471 [02:01<08:13,  1.31s/it] 20%|██        | 96/471 [02:02<08:11,  1.31s/it] 21%|██        | 97/471 [02:04<08:11,  1.31s/it] 21%|██        | 98/471 [02:05<08:09,  1.31s/it] 21%|██        | 99/471 [02:06<08:08,  1.31s/it] 21%|██        | 100/471 [02:08<08:06,  1.31s/it] 21%|██▏       | 101/471 [02:09<08:05,  1.31s/it] 22%|██▏       | 102/471 [02:10<08:05,  1.31s/it] 22%|██▏       | 103/471 [02:11<08:05,  1.32s/it] 22%|██▏       | 104/471 [02:13<08:02,  1.32s/it] 22%|██▏       | 105/471 [02:14<08:02,  1.32s/it] 23%|██▎       | 106/471 [02:15<07:59,  1.31s/it] 23%|██▎       | 107/471 [02:17<07:58,  1.31s/it] 23%|██▎       | 108/471 [02:18<07:56,  1.31s/it] 23%|██▎       | 109/471 [02:19<07:54,  1.31s/it] 23%|██▎       | 110/471 [02:21<07:53,  1.31s/it] 24%|██▎       | 111/471 [02:22<07:52,  1.31s/it] 24%|██▍       | 112/471 [02:23<07:51,  1.31s/it] 24%|██▍       | 113/471 [02:25<07:50,  1.31s/it] 24%|██▍       | 114/471 [02:26<07:49,  1.31s/it] 24%|██▍       | 115/471 [02:27<07:48,  1.32s/it] 25%|██▍       | 116/471 [02:29<07:47,  1.32s/it] 25%|██▍       | 117/471 [02:30<07:46,  1.32s/it] 25%|██▌       | 118/471 [02:31<07:44,  1.32s/it] 25%|██▌       | 119/471 [02:33<07:43,  1.32s/it] 25%|██▌       | 120/471 [02:34<07:42,  1.32s/it] 26%|██▌       | 121/471 [02:35<07:41,  1.32s/it] 26%|██▌       | 122/471 [02:36<07:40,  1.32s/it] 26%|██▌       | 123/471 [02:38<07:39,  1.32s/it] 26%|██▋       | 124/471 [02:39<07:38,  1.32s/it] 27%|██▋       | 125/471 [02:40<07:37,  1.32s/it] 27%|██▋       | 126/471 [02:42<07:35,  1.32s/it] 27%|██▋       | 127/471 [02:43<07:34,  1.32s/it] 27%|██▋       | 128/471 [02:44<07:32,  1.32s/it] 27%|██▋       | 129/471 [02:46<07:31,  1.32s/it] 28%|██▊       | 130/471 [02:47<07:29,  1.32s/it] 28%|██▊       | 131/471 [02:48<07:28,  1.32s/it] 28%|██▊       | 132/471 [02:50<07:27,  1.32s/it] 28%|██▊       | 133/471 [02:51<07:26,  1.32s/it] 28%|██▊       | 134/471 [02:52<07:25,  1.32s/it] 29%|██▊       | 135/471 [02:54<07:23,  1.32s/it] 29%|██▉       | 136/471 [02:55<07:21,  1.32s/it] 29%|██▉       | 137/471 [02:56<07:20,  1.32s/it] 29%|██▉       | 138/471 [02:58<07:20,  1.32s/it] 30%|██▉       | 139/471 [02:59<07:18,  1.32s/it] 30%|██▉       | 140/471 [03:00<07:17,  1.32s/it] 30%|██▉       | 141/471 [03:02<07:15,  1.32s/it] 30%|███       | 142/471 [03:03<07:14,  1.32s/it] 30%|███       | 143/471 [03:04<07:13,  1.32s/it] 31%|███       | 144/471 [03:06<07:11,  1.32s/it] 31%|███       | 145/471 [03:07<07:10,  1.32s/it] 31%|███       | 146/471 [03:08<07:09,  1.32s/it] 31%|███       | 147/471 [03:09<07:08,  1.32s/it] 31%|███▏      | 148/471 [03:11<07:06,  1.32s/it] 32%|███▏      | 149/471 [03:12<07:06,  1.32s/it] 32%|███▏      | 150/471 [03:13<07:04,  1.32s/it] 32%|███▏      | 151/471 [03:15<07:03,  1.32s/it] 32%|███▏      | 152/471 [03:16<07:01,  1.32s/it] 32%|███▏      | 153/471 [03:17<07:01,  1.32s/it] 33%|███▎      | 154/471 [03:19<06:58,  1.32s/it] 33%|███▎      | 155/471 [03:20<06:57,  1.32s/it] 33%|███▎      | 156/471 [03:21<06:56,  1.32s/it] 33%|███▎      | 157/471 [03:23<06:54,  1.32s/it] 34%|███▎      | 158/471 [03:24<06:52,  1.32s/it] 34%|███▍      | 159/471 [03:25<06:51,  1.32s/it] 34%|███▍      | 160/471 [03:27<06:51,  1.32s/it] 34%|███▍      | 161/471 [03:28<06:49,  1.32s/it] 34%|███▍      | 162/471 [03:29<06:48,  1.32s/it] 35%|███▍      | 163/471 [03:31<06:47,  1.32s/it] 35%|███▍      | 164/471 [03:32<06:45,  1.32s/it] 35%|███▌      | 165/471 [03:33<06:44,  1.32s/it] 35%|███▌      | 166/471 [03:35<06:43,  1.32s/it] 35%|███▌      | 167/471 [03:36<06:42,  1.32s/it] 36%|███▌      | 168/471 [03:37<06:40,  1.32s/it] 36%|███▌      | 169/471 [03:39<06:40,  1.32s/it] 36%|███▌      | 170/471 [03:40<06:38,  1.32s/it] 36%|███▋      | 171/471 [03:41<06:37,  1.32s/it] 37%|███▋      | 172/471 [03:43<06:35,  1.32s/it] 37%|███▋      | 173/471 [03:44<06:34,  1.32s/it] 37%|███▋      | 174/471 [03:45<06:33,  1.33s/it] 37%|███▋      | 175/471 [03:47<06:32,  1.33s/it] 37%|███▋      | 176/471 [03:48<06:30,  1.32s/it] 38%|███▊      | 177/471 [03:49<06:29,  1.33s/it] 38%|███▊      | 178/471 [03:51<06:28,  1.33s/it] 38%|███▊      | 179/471 [03:52<06:27,  1.33s/it] 38%|███▊      | 180/471 [03:53<06:26,  1.33s/it] 38%|███▊      | 181/471 [03:54<06:24,  1.33s/it] 39%|███▊      | 182/471 [03:56<06:24,  1.33s/it] 39%|███▉      | 183/471 [03:57<06:23,  1.33s/it] 39%|███▉      | 184/471 [03:58<06:21,  1.33s/it] 39%|███▉      | 185/471 [04:00<06:20,  1.33s/it] 39%|███▉      | 186/471 [04:01<06:19,  1.33s/it] 40%|███▉      | 187/471 [04:02<06:18,  1.33s/it] 40%|███▉      | 188/471 [04:04<06:17,  1.33s/it] 40%|████      | 189/471 [04:05<06:15,  1.33s/it] 40%|████      | 190/471 [04:06<06:14,  1.33s/it] 41%|████      | 191/471 [04:08<06:13,  1.34s/it] 41%|████      | 192/471 [04:09<06:12,  1.34s/it] 41%|████      | 193/471 [04:10<06:10,  1.33s/it] 41%|████      | 194/471 [04:12<06:09,  1.34s/it] 41%|████▏     | 195/471 [04:13<06:09,  1.34s/it] 42%|████▏     | 196/471 [04:15<06:07,  1.34s/it] 42%|████▏     | 197/471 [04:16<06:05,  1.34s/it] 42%|████▏     | 198/471 [04:17<06:04,  1.34s/it] 42%|████▏     | 199/471 [04:19<06:03,  1.34s/it] 42%|████▏     | 200/471 [04:20<06:02,  1.34s/it] 43%|████▎     | 201/471 [04:21<06:00,  1.33s/it] 43%|████▎     | 202/471 [04:23<05:59,  1.34s/it] 43%|████▎     | 203/471 [04:24<05:58,  1.34s/it] 43%|████▎     | 204/471 [04:25<05:57,  1.34s/it] 44%|████▎     | 205/471 [04:27<05:55,  1.34s/it] 44%|████▎     | 206/471 [04:28<05:54,  1.34s/it] 44%|████▍     | 207/471 [04:29<05:53,  1.34s/it] 44%|████▍     | 208/471 [04:31<05:51,  1.34s/it] 44%|████▍     | 209/471 [04:32<05:49,  1.34s/it] 45%|████▍     | 210/471 [04:33<05:48,  1.34s/it] 45%|████▍     | 211/471 [04:35<05:47,  1.34s/it] 45%|████▌     | 212/471 [04:36<05:46,  1.34s/it] 45%|████▌     | 213/471 [04:37<05:45,  1.34s/it] 45%|████▌     | 214/471 [04:39<05:43,  1.34s/it] 46%|████▌     | 215/471 [04:40<05:42,  1.34s/it] 46%|████▌     | 216/471 [04:41<05:41,  1.34s/it] 46%|████▌     | 217/471 [04:43<05:40,  1.34s/it] 46%|████▋     | 218/471 [04:44<05:39,  1.34s/it] 46%|████▋     | 219/471 [04:45<05:37,  1.34s/it] 47%|████▋     | 220/471 [04:47<05:36,  1.34s/it] 47%|████▋     | 221/471 [04:48<05:35,  1.34s/it] 47%|████▋     | 222/471 [04:49<05:33,  1.34s/it] 47%|████▋     | 223/471 [04:51<05:31,  1.34s/it] 48%|████▊     | 224/471 [04:52<05:30,  1.34s/it] 48%|████▊     | 225/471 [04:53<05:29,  1.34s/it] 48%|████▊     | 226/471 [04:55<05:27,  1.34s/it] 48%|████▊     | 227/471 [04:56<05:26,  1.34s/it] 48%|████▊     | 228/471 [04:57<05:24,  1.34s/it] 49%|████▊     | 229/471 [04:59<05:23,  1.34s/it] 49%|████▉     | 230/471 [05:00<05:22,  1.34s/it] 49%|████▉     | 231/471 [05:01<05:20,  1.34s/it] 49%|████▉     | 232/471 [05:03<05:18,  1.33s/it] 49%|████▉     | 233/471 [05:04<05:17,  1.33s/it] 50%|████▉     | 234/471 [05:05<05:15,  1.33s/it] 50%|████▉     | 235/471 [05:07<05:14,  1.33s/it] 50%|█████     | 236/471 [05:08<05:12,  1.33s/it] 50%|█████     | 237/471 [05:09<05:11,  1.33s/it] 51%|█████     | 238/471 [05:11<05:10,  1.33s/it] 51%|█████     | 239/471 [05:12<05:08,  1.33s/it] 51%|█████     | 240/471 [05:13<05:07,  1.33s/it] 51%|█████     | 241/471 [05:15<05:06,  1.33s/it] 51%|█████▏    | 242/471 [05:16<05:04,  1.33s/it] 52%|█████▏    | 243/471 [05:17<05:03,  1.33s/it] 52%|█████▏    | 244/471 [05:19<05:02,  1.33s/it] 52%|█████▏    | 245/471 [05:20<05:01,  1.33s/it] 52%|█████▏    | 246/471 [05:21<04:59,  1.33s/it] 52%|█████▏    | 247/471 [05:23<04:57,  1.33s/it] 53%|█████▎    | 248/471 [05:24<04:56,  1.33s/it] 53%|█████▎    | 249/471 [05:25<04:55,  1.33s/it] 53%|█████▎    | 250/471 [05:27<04:54,  1.33s/it] 53%|█████▎    | 251/471 [05:28<04:52,  1.33s/it] 54%|█████▎    | 252/471 [05:29<04:51,  1.33s/it] 54%|█████▎    | 253/471 [05:31<04:49,  1.33s/it] 54%|█████▍    | 254/471 [05:32<04:48,  1.33s/it] 54%|█████▍    | 255/471 [05:33<04:46,  1.33s/it] 54%|█████▍    | 256/471 [05:35<04:45,  1.33s/it] 55%|█████▍    | 257/471 [05:36<04:44,  1.33s/it] 55%|█████▍    | 258/471 [05:37<04:43,  1.33s/it] 55%|█████▍    | 259/471 [05:39<04:41,  1.33s/it] 55%|█████▌    | 260/471 [05:40<04:40,  1.33s/it] 55%|█████▌    | 261/471 [05:41<04:38,  1.33s/it] 56%|█████▌    | 262/471 [05:43<04:37,  1.33s/it] 56%|█████▌    | 263/471 [05:44<04:36,  1.33s/it] 56%|█████▌    | 264/471 [05:45<04:34,  1.33s/it] 56%|█████▋    | 265/471 [05:47<04:33,  1.33s/it] 56%|█████▋    | 266/471 [05:48<04:32,  1.33s/it] 57%|█████▋    | 267/471 [05:49<04:31,  1.33s/it] 57%|█████▋    | 268/471 [05:51<04:29,  1.33s/it] 57%|█████▋    | 269/471 [05:52<04:28,  1.33s/it] 57%|█████▋    | 270/471 [05:53<04:27,  1.33s/it] 58%|█████▊    | 271/471 [05:55<04:25,  1.33s/it] 58%|█████▊    | 272/471 [05:56<04:24,  1.33s/it] 58%|█████▊    | 273/471 [05:57<04:22,  1.33s/it] 58%|█████▊    | 274/471 [05:58<04:21,  1.33s/it] 58%|█████▊    | 275/471 [06:00<04:20,  1.33s/it] 59%|█████▊    | 276/471 [06:01<04:18,  1.33s/it] 59%|█████▉    | 277/471 [06:02<04:17,  1.33s/it] 59%|█████▉    | 278/471 [06:04<04:16,  1.33s/it] 59%|█████▉    | 279/471 [06:05<04:14,  1.33s/it] 59%|█████▉    | 280/471 [06:06<04:13,  1.33s/it] 60%|█████▉    | 281/471 [06:08<04:12,  1.33s/it] 60%|█████▉    | 282/471 [06:09<04:11,  1.33s/it] 60%|██████    | 283/471 [06:10<04:09,  1.33s/it] 60%|██████    | 284/471 [06:12<04:08,  1.33s/it] 61%|██████    | 285/471 [06:13<04:07,  1.33s/it] 61%|██████    | 286/471 [06:14<04:06,  1.33s/it] 61%|██████    | 287/471 [06:16<04:04,  1.33s/it] 61%|██████    | 288/471 [06:17<04:03,  1.33s/it] 61%|██████▏   | 289/471 [06:18<04:01,  1.33s/it] 62%|██████▏   | 290/471 [06:20<04:00,  1.33s/it] 62%|██████▏   | 291/471 [06:21<03:58,  1.33s/it] 62%|██████▏   | 292/471 [06:22<03:57,  1.33s/it] 62%|██████▏   | 293/471 [06:24<03:55,  1.33s/it] 62%|██████▏   | 294/471 [06:25<03:54,  1.32s/it] 63%|██████▎   | 295/471 [06:26<03:53,  1.32s/it] 63%|██████▎   | 296/471 [06:28<03:51,  1.32s/it] 63%|██████▎   | 297/471 [06:29<03:50,  1.32s/it] 63%|██████▎   | 298/471 [06:30<03:49,  1.33s/it] 63%|██████▎   | 299/471 [06:32<03:48,  1.33s/it] 64%|██████▎   | 300/471 [06:33<03:46,  1.33s/it] 64%|██████▍   | 301/471 [06:34<03:45,  1.33s/it] 64%|██████▍   | 302/471 [06:36<03:43,  1.33s/it] 64%|██████▍   | 303/471 [06:37<03:42,  1.32s/it] 65%|██████▍   | 304/471 [06:38<03:40,  1.32s/it] 65%|██████▍   | 305/471 [06:40<03:39,  1.32s/it] 65%|██████▍   | 306/471 [06:41<03:38,  1.32s/it] 65%|██████▌   | 307/471 [06:42<03:37,  1.33s/it] 65%|██████▌   | 308/471 [06:44<03:36,  1.33s/it] 66%|██████▌   | 309/471 [06:45<03:34,  1.33s/it] 66%|██████▌   | 310/471 [06:46<03:33,  1.33s/it] 66%|██████▌   | 311/471 [06:48<03:32,  1.33s/it] 66%|██████▌   | 312/471 [06:49<03:30,  1.32s/it] 66%|██████▋   | 313/471 [06:50<03:29,  1.32s/it] 67%|██████▋   | 314/471 [06:52<03:27,  1.32s/it] 67%|██████▋   | 315/471 [06:53<03:26,  1.32s/it] 67%|██████▋   | 316/471 [06:54<03:25,  1.32s/it] 67%|██████▋   | 317/471 [06:56<03:23,  1.32s/it] 68%|██████▊   | 318/471 [06:57<03:22,  1.32s/it] 68%|██████▊   | 319/471 [06:58<03:21,  1.32s/it] 68%|██████▊   | 320/471 [06:59<03:19,  1.32s/it] 68%|██████▊   | 321/471 [07:01<03:18,  1.32s/it] 68%|██████▊   | 322/471 [07:02<03:17,  1.32s/it] 69%|██████▊   | 323/471 [07:03<03:16,  1.33s/it] 69%|██████▉   | 324/471 [07:05<03:15,  1.33s/it] 69%|██████▉   | 325/471 [07:06<03:13,  1.33s/it] 69%|██████▉   | 326/471 [07:07<03:11,  1.32s/it] 69%|██████▉   | 327/471 [07:09<03:10,  1.32s/it] 70%|██████▉   | 328/471 [07:10<03:09,  1.32s/it] 70%|██████▉   | 329/471 [07:11<03:08,  1.32s/it] 70%|███████   | 330/471 [07:13<03:06,  1.32s/it] 70%|███████   | 331/471 [07:14<03:05,  1.32s/it] 70%|███████   | 332/471 [07:15<03:04,  1.32s/it] 71%|███████   | 333/471 [07:17<03:02,  1.32s/it] 71%|███████   | 334/471 [07:18<03:01,  1.32s/it] 71%|███████   | 335/471 [07:19<03:00,  1.33s/it] 71%|███████▏  | 336/471 [07:21<02:58,  1.32s/it] 72%|███████▏  | 337/471 [07:22<02:57,  1.32s/it] 72%|███████▏  | 338/471 [07:23<02:55,  1.32s/it] 72%|███████▏  | 339/471 [07:25<02:54,  1.33s/it] 72%|███████▏  | 340/471 [07:26<02:53,  1.33s/it] 72%|███████▏  | 341/471 [07:27<02:52,  1.32s/it] 73%|███████▎  | 342/471 [07:29<02:50,  1.32s/it] 73%|███████▎  | 343/471 [07:30<02:49,  1.32s/it] 73%|███████▎  | 344/471 [07:31<02:48,  1.32s/it] 73%|███████▎  | 345/471 [07:33<02:46,  1.32s/it] 73%|███████▎  | 346/471 [07:34<02:45,  1.33s/it] 74%|███████▎  | 347/471 [07:35<02:44,  1.32s/it] 74%|███████▍  | 348/471 [07:37<02:42,  1.32s/it] 74%|███████▍  | 349/471 [07:38<02:41,  1.33s/it] 74%|███████▍  | 350/471 [07:39<02:40,  1.33s/it] 75%|███████▍  | 351/471 [07:41<02:38,  1.32s/it] 75%|███████▍  | 352/471 [07:42<02:37,  1.32s/it] 75%|███████▍  | 353/471 [07:43<02:36,  1.33s/it] 75%|███████▌  | 354/471 [07:45<02:35,  1.33s/it] 75%|███████▌  | 355/471 [07:46<02:33,  1.33s/it] 76%|███████▌  | 356/471 [07:47<02:32,  1.33s/it] 76%|███████▌  | 357/471 [07:49<02:31,  1.33s/it] 76%|███████▌  | 358/471 [07:50<02:29,  1.33s/it] 76%|███████▌  | 359/471 [07:51<02:28,  1.33s/it] 76%|███████▋  | 360/471 [07:52<02:27,  1.33s/it] 77%|███████▋  | 361/471 [07:54<02:25,  1.33s/it] 77%|███████▋  | 362/471 [07:55<02:24,  1.33s/it] 77%|███████▋  | 363/471 [07:56<02:23,  1.33s/it] 77%|███████▋  | 364/471 [07:58<02:21,  1.33s/it] 77%|███████▋  | 365/471 [07:59<02:20,  1.33s/it] 78%|███████▊  | 366/471 [08:00<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:02<02:18,  1.33s/it] 78%|███████▊  | 368/471 [08:03<02:16,  1.33s/it] 78%|███████▊  | 369/471 [08:04<02:14,  1.32s/it] 79%|███████▊  | 370/471 [08:06<02:13,  1.33s/it] 79%|███████▉  | 371/471 [08:07<02:12,  1.33s/it] 79%|███████▉  | 372/471 [08:08<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:10<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:11<02:08,  1.33s/it] 80%|███████▉  | 375/471 [08:12<02:07,  1.33s/it] 80%|███████▉  | 376/471 [08:14<02:06,  1.33s/it] 80%|████████  | 377/471 [08:15<02:04,  1.33s/it] 80%|████████  | 378/471 [08:16<02:03,  1.33s/it] 80%|████████  | 379/471 [08:18<02:02,  1.33s/it] 81%|████████  | 380/471 [08:19<02:01,  1.33s/it] 81%|████████  | 381/471 [08:20<01:59,  1.33s/it] 81%|████████  | 382/471 [08:22<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:23<01:57,  1.33s/it] 82%|████████▏ | 384/471 [08:24<01:56,  1.33s/it] 82%|████████▏ | 385/471 [08:26<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:27<01:53,  1.33s/it] 82%|████████▏ | 387/471 [08:28<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:30<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:31<01:49,  1.33s/it] 83%|████████▎ | 390/471 [08:32<01:48,  1.33s/it] 83%|████████▎ | 391/471 [08:34<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:35<01:45,  1.33s/it] 83%|████████▎ | 393/471 [08:36<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:38<01:42,  1.34s/it] 84%|████████▍ | 395/471 [08:39<01:41,  1.34s/it] 84%|████████▍ | 396/471 [08:40<01:40,  1.34s/it] 84%|████████▍ | 397/471 [08:42<01:38,  1.34s/it] 85%|████████▍ | 398/471 [08:43<01:37,  1.34s/it] 85%|████████▍ | 399/471 [08:44<01:36,  1.34s/it] 85%|████████▍ | 400/471 [08:46<01:34,  1.34s/it] 85%|████████▌ | 401/471 [08:47<01:33,  1.34s/it] 85%|████████▌ | 402/471 [08:48<01:32,  1.34s/it] 86%|████████▌ | 403/471 [08:50<01:30,  1.34s/it] 86%|████████▌ | 404/471 [08:51<01:29,  1.33s/it] 86%|████████▌ | 405/471 [08:52<01:28,  1.34s/it] 86%|████████▌ | 406/471 [08:54<01:26,  1.34s/it] 86%|████████▋ | 407/471 [08:55<01:25,  1.34s/it] 87%|████████▋ | 408/471 [08:56<01:24,  1.34s/it] 87%|████████▋ | 409/471 [08:58<01:23,  1.34s/it] 87%|████████▋ | 410/471 [08:59<01:21,  1.34s/it] 87%|████████▋ | 411/471 [09:00<01:20,  1.34s/it] 87%|████████▋ | 412/471 [09:02<01:18,  1.34s/it] 88%|████████▊ | 413/471 [09:03<01:17,  1.34s/it] 88%|████████▊ | 414/471 [09:04<01:16,  1.34s/it] 88%|████████▊ | 415/471 [09:06<01:14,  1.34s/it] 88%|████████▊ | 416/471 [09:07<01:13,  1.34s/it] 89%|████████▊ | 417/471 [09:08<01:12,  1.34s/it] 89%|████████▊ | 418/471 [09:10<01:11,  1.34s/it] 89%|████████▉ | 419/471 [09:11<01:09,  1.34s/it] 89%|████████▉ | 420/471 [09:13<01:08,  1.34s/it] 89%|████████▉ | 421/471 [09:14<01:07,  1.34s/it] 90%|████████▉ | 422/471 [09:15<01:05,  1.34s/it] 90%|████████▉ | 423/471 [09:17<01:04,  1.34s/it] 90%|█████████ | 424/471 [09:18<01:03,  1.34s/it] 90%|█████████ | 425/471 [09:19<01:01,  1.34s/it] 90%|█████████ | 426/471 [09:21<01:00,  1.35s/it] 91%|█████████ | 427/471 [09:22<00:59,  1.35s/it] 91%|█████████ | 428/471 [09:23<00:57,  1.35s/it] 91%|█████████ | 429/471 [09:25<00:56,  1.34s/it] 91%|█████████▏| 430/471 [09:26<00:55,  1.35s/it] 92%|█████████▏| 431/471 [09:27<00:54,  1.35s/it] 92%|█████████▏| 432/471 [09:29<00:52,  1.35s/it] 92%|█████████▏| 433/471 [09:30<00:51,  1.35s/it] 92%|█████████▏| 434/471 [09:31<00:49,  1.35s/it] 92%|█████████▏| 435/471 [09:33<00:48,  1.35s/it] 93%|█████████▎| 436/471 [09:34<00:47,  1.35s/it] 93%|█████████▎| 437/471 [09:35<00:45,  1.35s/it] 93%|█████████▎| 438/471 [09:37<00:44,  1.35s/it] 93%|█████████▎| 439/471 [09:38<00:43,  1.34s/it] 93%|█████████▎| 440/471 [09:39<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:41<00:40,  1.34s/it] 94%|█████████▍| 442/471 [09:42<00:38,  1.34s/it] 94%|█████████▍| 443/471 [09:43<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:45<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:46<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:48<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:49<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:50<00:30,  1.34s/it] 95%|█████████▌| 449/471 [09:52<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:53<00:28,  1.34s/it] 96%|█████████▌| 451/471 [09:54<00:26,  1.34s/it] 96%|█████████▌| 452/471 [09:56<00:25,  1.34s/it] 96%|█████████▌| 453/471 [09:57<00:24,  1.34s/it] 96%|█████████▋| 454/471 [09:58<00:22,  1.34s/it] 97%|█████████▋| 455/471 [10:00<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:01<00:20,  1.34s/it] 97%|█████████▋| 457/471 [10:02<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:04<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:05<00:16,  1.34s/it] 98%|█████████▊| 460/471 [10:06<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:08<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:09<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:10<00:10,  1.34s/it] 99%|█████████▊| 464/471 [10:12<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:13<00:08,  1.34s/it] 99%|█████████▉| 466/471 [10:14<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:16<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:17<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:18<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:20<00:01,  1.34s/it]100%|██████████| 471/471 [10:21<00:00,  1.22s/it]100%|██████████| 471/471 [10:21<00:00,  1.32s/it]
{'eval_loss': 4.324887752532959, 'eval_model_preparation_time': 0.0111, 'eval_acc': 0.22703133297928837, 'eval_runtime': 622.2974, 'eval_samples_per_second': 12.104, 'eval_steps_per_second': 0.757}
ROUND:8
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 5.1517, 'grad_norm': 7.53873348236084, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 3.8584, 'grad_norm': 7.424469947814941, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 3.5926, 'grad_norm': 8.290155410766602, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 2.9363, 'grad_norm': 7.457624435424805, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.7687, 'grad_norm': 10.756525993347168, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 3.2262, 'grad_norm': 12.956613540649414, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 3.045, 'grad_norm': 15.538710594177246, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 4.7244, 'grad_norm': 54.716033935546875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 2.1919, 'grad_norm': 23.204519271850586, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 2.5229, 'grad_norm': 14.623702049255371, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.6524, 'grad_norm': 17.253509521484375, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.9577, 'grad_norm': 11.653850555419922, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 2.0684, 'grad_norm': 9.76396656036377, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.0515, 'grad_norm': 8.693368911743164, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.2453, 'grad_norm': 10.622889518737793, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0414, 'grad_norm': 1.9433166980743408, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it]                                               {'loss': 1.1697, 'grad_norm': 10.079798698425293, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 1.0622, 'grad_norm': 9.305521965026855, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.4451, 'grad_norm': 2.9001688957214355, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.8578, 'grad_norm': 6.967253684997559, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.7471, 'grad_norm': 4.076644420623779, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.8671, 'grad_norm': 11.319168090820312, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.9331, 'grad_norm': 5.251482009887695, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.6692, 'grad_norm': 22.851869583129883, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.3, 'grad_norm': 3.954230308532715, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.4671, 'grad_norm': 2.5364630222320557, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.474, 'grad_norm': 6.338400840759277, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.4379, 'grad_norm': 3.387850046157837, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.9408, 'grad_norm': 8.513809204101562, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.8658, 'grad_norm': 4.743965148925781, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.6328, 'grad_norm': 3.4867517948150635, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0109, 'grad_norm': 0.6776280999183655, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.4818, 'grad_norm': 7.402329921722412, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.1779, 'grad_norm': 3.4288783073425293, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.4108, 'grad_norm': 2.670140266418457, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1371, 'grad_norm': 1.5985933542251587, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.7044, 'grad_norm': 1.4675501585006714, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.18s/it]                                               {'loss': 0.2712, 'grad_norm': 6.985666751861572, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.4702, 'grad_norm': 5.05045747756958, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]                                               {'loss': 0.0378, 'grad_norm': 1.116892695426941, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.98s/it]                                               {'train_runtime': 80.76, 'train_samples_per_second': 6.996, 'train_steps_per_second': 0.495, 'train_loss': 1.3651661690790207, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.98s/it]100%|██████████| 40/40 [01:20<00:00,  2.02s/it]
CLIENT:49
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.09s/it]                                              {'loss': 4.6436, 'grad_norm': 8.04603099822998, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.09s/it]  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]                                              {'loss': 4.4176, 'grad_norm': 8.668152809143066, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 2.5762, 'grad_norm': 9.897212982177734, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 2.0533, 'grad_norm': 8.96623706817627, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.14s/it]                                              {'loss': 3.9736, 'grad_norm': 12.502378463745117, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.14s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it]                                              {'loss': 3.5844, 'grad_norm': 13.77618408203125, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 2.3384, 'grad_norm': 13.335713386535645, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 3.4531, 'grad_norm': 70.23637390136719, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:52,  1.70s/it]                                              {'loss': 0.8374, 'grad_norm': 7.008130073547363, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:52,  1.70s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.83s/it]                                               {'loss': 1.3028, 'grad_norm': 6.276794910430908, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.83s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it]                                               {'loss': 1.3643, 'grad_norm': 6.530251979827881, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it] 30%|███       | 12/40 [00:23<00:55,  2.00s/it]                                               {'loss': 1.111, 'grad_norm': 5.625489234924316, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:55,  2.00s/it] 32%|███▎      | 13/40 [00:25<00:55,  2.06s/it]                                               {'loss': 0.8086, 'grad_norm': 4.072005748748779, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:25<00:55,  2.06s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 0.7896, 'grad_norm': 3.7431349754333496, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.8358, 'grad_norm': 5.673736572265625, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.3249, 'grad_norm': 9.077414512634277, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it]                                               {'loss': 0.3395, 'grad_norm': 2.17096209526062, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.88s/it]                                               {'loss': 0.2571, 'grad_norm': 2.1192660331726074, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.521, 'grad_norm': 5.697743892669678, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.3265, 'grad_norm': 4.08200216293335, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it]                                               {'loss': 0.5923, 'grad_norm': 4.302068710327148, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.11s/it]                                               {'loss': 0.8009, 'grad_norm': 7.418993949890137, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.11s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it]                                               {'loss': 0.5257, 'grad_norm': 6.438651084899902, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it] 60%|██████    | 24/40 [00:46<00:24,  1.54s/it]                                               {'loss': 0.0209, 'grad_norm': 0.9866863489151001, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.54s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.374, 'grad_norm': 3.051328182220459, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.2068, 'grad_norm': 1.5878236293792725, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it]                                               {'loss': 0.3689, 'grad_norm': 3.4926223754882812, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.98s/it] 70%|███████   | 28/40 [00:54<00:24,  2.06s/it]                                               {'loss': 0.1107, 'grad_norm': 2.4095919132232666, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.09s/it]                                               {'loss': 0.2774, 'grad_norm': 3.933173656463623, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.09s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.1161, 'grad_norm': 3.228426694869995, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it]                                               {'loss': 0.2246, 'grad_norm': 2.217451572418213, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it] 80%|████████  | 32/40 [01:01<00:12,  1.56s/it]                                               {'loss': 0.02, 'grad_norm': 1.0089890956878662, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.56s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.75s/it]                                               {'loss': 0.1783, 'grad_norm': 1.351399540901184, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.75s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.0731, 'grad_norm': 2.4001100063323975, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:09,  1.99s/it]                                               {'loss': 0.0685, 'grad_norm': 1.046471118927002, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  1.99s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it]                                               {'loss': 0.149, 'grad_norm': 1.2536828517913818, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.10s/it]                                               {'loss': 0.4155, 'grad_norm': 1.2737014293670654, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.10s/it] 95%|█████████▌| 38/40 [01:14<00:04,  2.15s/it]                                               {'loss': 0.0604, 'grad_norm': 0.9658768773078918, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:14<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.0362, 'grad_norm': 0.8918619751930237, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.0401, 'grad_norm': 1.5799905061721802, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 77.7932, 'train_samples_per_second': 7.263, 'train_steps_per_second': 0.514, 'train_loss': 1.0129450242500753, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]100%|██████████| 40/40 [01:17<00:00,  1.94s/it]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 3.5715, 'grad_norm': 6.038488388061523, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.1328, 'grad_norm': 6.92965841293335, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 1.9095, 'grad_norm': 12.150032997131348, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:16,  2.13s/it]                                              {'loss': 3.0915, 'grad_norm': 11.259161949157715, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.13s/it] 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it]                                              {'loss': 2.0412, 'grad_norm': 11.04198169708252, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:14,  2.14s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.15s/it]                                              {'loss': 2.2737, 'grad_norm': 12.64286994934082, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.15s/it] 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it]                                              {'loss': 1.8639, 'grad_norm': 64.06793212890625, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:14<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.51s/it]                                              {'loss': 4.0674, 'grad_norm': 45.77465057373047, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.51s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.71s/it]                                              {'loss': 0.8743, 'grad_norm': 8.999088287353516, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.71s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it]                                               {'loss': 0.4396, 'grad_norm': 4.493343353271484, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 1.1012, 'grad_norm': 12.20466423034668, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 1.0587, 'grad_norm': 22.32635498046875, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 1.2037, 'grad_norm': 67.70977783203125, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.1148, 'grad_norm': 10.641841888427734, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:52,  2.11s/it]                                               {'loss': 1.2022, 'grad_norm': 17.844127655029297, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:52,  2.11s/it] 40%|████      | 16/40 [00:30<00:36,  1.53s/it]                                               {'loss': 3.1505, 'grad_norm': 117.19419860839844, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.53s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.72s/it]                                               {'loss': 0.6408, 'grad_norm': 7.2470221519470215, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.72s/it] 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it]                                               {'loss': 0.4871, 'grad_norm': 41.73094177246094, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:34<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it]                                               {'loss': 1.3018, 'grad_norm': 48.80636978149414, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it] 50%|█████     | 20/40 [00:39<00:40,  2.03s/it]                                               {'loss': 1.6199, 'grad_norm': 508.5576477050781, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.03s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it]                                               {'loss': 1.2822, 'grad_norm': 131.8467254638672, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.08s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it]                                               {'loss': 2.9198, 'grad_norm': 223.74740600585938, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it]                                               {'loss': 1.5761, 'grad_norm': 124.50846099853516, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.13s/it] 60%|██████    | 24/40 [00:46<00:24,  1.54s/it]                                               {'loss': 1.5143, 'grad_norm': 47.53057098388672, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.54s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.5722, 'grad_norm': 8.526098251342773, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.3363, 'grad_norm': 7.090175628662109, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it]                                               {'loss': 0.7085, 'grad_norm': 17.843692779541016, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it] 70%|███████   | 28/40 [00:54<00:24,  2.04s/it]                                               {'loss': 0.2864, 'grad_norm': 4.377370357513428, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.04s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.4341, 'grad_norm': 5.520399570465088, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.11s/it]                                               {'loss': 0.8168, 'grad_norm': 6.217055320739746, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.11s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it]                                               {'loss': 0.2258, 'grad_norm': 2.4605660438537598, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.0119, 'grad_norm': 0.5741713643074036, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.77s/it]                                               {'loss': 0.0813, 'grad_norm': 1.9396872520446777, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.3771, 'grad_norm': 11.03253173828125, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it]                                               {'loss': 0.2896, 'grad_norm': 5.109320640563965, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it]                                               {'loss': 0.3086, 'grad_norm': 5.266251087188721, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.13s/it]                                               {'loss': 0.3584, 'grad_norm': 16.522014617919922, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 1.1546, 'grad_norm': 173.5443572998047, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 1.6428, 'grad_norm': 32.18426513671875, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.5382, 'grad_norm': 11.464126586914062, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 77.7262, 'train_samples_per_second': 7.269, 'train_steps_per_second': 0.515, 'train_loss': 1.2645238095428795, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]100%|██████████| 40/40 [01:17<00:00,  1.94s/it]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 5.411, 'grad_norm': 8.723672866821289, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 3.8175, 'grad_norm': 6.895017623901367, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 3.4188, 'grad_norm': 8.163090705871582, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 3.2451, 'grad_norm': 14.366996765136719, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.2695, 'grad_norm': 11.424184799194336, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 3.1177, 'grad_norm': 15.760043144226074, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.6222, 'grad_norm': 10.284022331237793, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.1115, 'grad_norm': 57.055946350097656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.5234, 'grad_norm': 13.461739540100098, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.1612, 'grad_norm': 8.353060722351074, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 0.8163, 'grad_norm': 5.28177547454834, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.5728, 'grad_norm': 4.812535285949707, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 1.1712, 'grad_norm': 6.940120697021484, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.2439, 'grad_norm': 5.187317371368408, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.0491, 'grad_norm': 6.097818374633789, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 1.0215, 'grad_norm': 29.718210220336914, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it]                                               {'loss': 0.7021, 'grad_norm': 5.607908248901367, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.3089, 'grad_norm': 3.3773069381713867, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.1847, 'grad_norm': 2.3482258319854736, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.5096, 'grad_norm': 3.8430428504943848, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.3698, 'grad_norm': 3.851642608642578, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.2529, 'grad_norm': 2.762127637863159, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it]                                               {'loss': 0.6175, 'grad_norm': 4.498085975646973, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0974, 'grad_norm': 3.374891519546509, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.79s/it]                                               {'loss': 0.0308, 'grad_norm': 0.4096064865589142, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.3163, 'grad_norm': 3.0832715034484863, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.1812, 'grad_norm': 1.771136999130249, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1233, 'grad_norm': 3.4612677097320557, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.1683, 'grad_norm': 1.2303544282913208, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0512, 'grad_norm': 0.7298208475112915, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.2123, 'grad_norm': 7.359587669372559, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0027, 'grad_norm': 0.08680814504623413, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.1862, 'grad_norm': 4.849562168121338, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.1043, 'grad_norm': 3.9119255542755127, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it]                                               {'loss': 0.0643, 'grad_norm': 1.7376011610031128, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0239, 'grad_norm': 0.4072967767715454, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0456, 'grad_norm': 0.7254522442817688, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.1764, 'grad_norm': 3.421206474304199, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0257, 'grad_norm': 0.28758126497268677, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.1982, 'grad_norm': 8.471128463745117, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.6127, 'train_samples_per_second': 7.187, 'train_steps_per_second': 0.509, 'train_loss': 0.9381506310950499, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]                                              {'loss': 3.8574, 'grad_norm': 6.577338695526123, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.7403, 'grad_norm': 5.780591011047363, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 3.7027, 'grad_norm': 10.57571792602539, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.0858, 'grad_norm': 9.82932186126709, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 4.0564, 'grad_norm': 19.931983947753906, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 3.0257, 'grad_norm': 15.803810119628906, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 1.4666, 'grad_norm': 11.367898941040039, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 1.5952, 'grad_norm': 61.79560852050781, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.6308, 'grad_norm': 8.482213020324707, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it]                                               {'loss': 2.5542, 'grad_norm': 16.914976119995117, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.85s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it]                                               {'loss': 2.3324, 'grad_norm': 14.957276344299316, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.93s/it] 30%|███       | 12/40 [00:23<00:56,  2.01s/it]                                               {'loss': 1.8371, 'grad_norm': 9.470953941345215, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.01s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.05s/it]                                               {'loss': 1.329, 'grad_norm': 19.5131778717041, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.05s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 2.1131, 'grad_norm': 16.444000244140625, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.8399, 'grad_norm': 8.321377754211426, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.1093, 'grad_norm': 8.288675308227539, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.75s/it]                                               {'loss': 0.584, 'grad_norm': 5.047976970672607, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 0.4398, 'grad_norm': 5.611638069152832, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it]                                               {'loss': 0.6334, 'grad_norm': 6.913928031921387, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it] 50%|█████     | 20/40 [00:39<00:40,  2.03s/it]                                               {'loss': 0.3608, 'grad_norm': 4.538346767425537, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.03s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.7495, 'grad_norm': 5.996735572814941, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.6578, 'grad_norm': 7.812798023223877, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.7597, 'grad_norm': 3.1976466178894043, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.0257, 'grad_norm': 1.6022305488586426, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.0794, 'grad_norm': 1.5335026979446411, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.5962, 'grad_norm': 5.497848033905029, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it]                                               {'loss': 0.6779, 'grad_norm': 3.3598577976226807, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it] 70%|███████   | 28/40 [00:55<00:24,  2.05s/it]                                               {'loss': 0.1094, 'grad_norm': 1.5867632627487183, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.1597, 'grad_norm': 2.408863067626953, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.0734, 'grad_norm': 4.3947601318359375, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it]                                               {'loss': 0.0904, 'grad_norm': 1.1457067728042603, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.17s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.1403, 'grad_norm': 5.481496334075928, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.399, 'grad_norm': 3.267122983932495, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.0114, 'grad_norm': 0.24501416087150574, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.1075, 'grad_norm': 2.0559399127960205, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it]                                               {'loss': 0.5856, 'grad_norm': 7.812248229980469, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.186, 'grad_norm': 2.334428310394287, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.3273, 'grad_norm': 8.192506790161133, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.5103, 'grad_norm': 2.413355827331543, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'loss': 0.0258, 'grad_norm': 1.6468617916107178, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.58s/it]                                               {'train_runtime': 78.0549, 'train_samples_per_second': 7.238, 'train_steps_per_second': 0.512, 'train_loss': 1.0891606989316642, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.95s/it]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.9869, 'grad_norm': 5.2583208084106445, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 3.1558, 'grad_norm': 8.205825805664062, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 2.5229, 'grad_norm': 8.957513809204102, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 2.1157, 'grad_norm': 11.46688461303711, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 2.134, 'grad_norm': 12.4464750289917, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 1.7322, 'grad_norm': 8.814260482788086, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 2.8994, 'grad_norm': 16.814483642578125, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 4.362, 'grad_norm': 51.34994888305664, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 1.734, 'grad_norm': 17.241880416870117, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 0.5773, 'grad_norm': 5.989083766937256, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.0424, 'grad_norm': 9.828720092773438, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.8459, 'grad_norm': 9.270315170288086, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.7495, 'grad_norm': 6.71173620223999, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.0277, 'grad_norm': 4.253551483154297, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.5679, 'grad_norm': 5.004716396331787, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 5.2757, 'grad_norm': 64.69635009765625, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.78s/it]                                               {'loss': 1.8452, 'grad_norm': 20.90471649169922, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.9422, 'grad_norm': 43.77544403076172, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 1.3425, 'grad_norm': 44.10279083251953, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 3.8189, 'grad_norm': 133.64796447753906, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 3.4719, 'grad_norm': 35.89741897583008, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it]                                               {'loss': 3.8072, 'grad_norm': 23.144737243652344, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it]                                               {'loss': 3.5397, 'grad_norm': 61.219688415527344, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 5.957, 'grad_norm': 13.443655014038086, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:25,  1.73s/it]                                               {'loss': 3.4165, 'grad_norm': 10.086984634399414, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:25,  1.73s/it] 65%|██████▌   | 26/40 [00:50<00:25,  1.86s/it]                                               {'loss': 2.9622, 'grad_norm': 8.191200256347656, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:25,  1.86s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.96s/it]                                               {'loss': 3.7733, 'grad_norm': 5.529415130615234, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.96s/it] 70%|███████   | 28/40 [00:55<00:24,  2.01s/it]                                               {'loss': 3.0132, 'grad_norm': 19.388580322265625, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.01s/it] 72%|███████▎  | 29/40 [00:57<00:22,  2.08s/it]                                               {'loss': 5.197, 'grad_norm': 71.6322021484375, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:22,  2.08s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.11s/it]                                               {'loss': 4.7395, 'grad_norm': 14.162392616271973, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.11s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.14s/it]                                               {'loss': 2.7543, 'grad_norm': 12.347940444946289, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.14s/it] 80%|████████  | 32/40 [01:02<00:12,  1.55s/it]                                               {'loss': 4.7205, 'grad_norm': 9.155442237854004, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.55s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.74s/it]                                               {'loss': 2.8056, 'grad_norm': 4.431138038635254, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.74s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.88s/it]                                               {'loss': 2.6475, 'grad_norm': 2.5744431018829346, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.88s/it] 88%|████████▊ | 35/40 [01:08<00:09,  1.97s/it]                                               {'loss': 2.7502, 'grad_norm': 4.764316082000732, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  1.97s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.03s/it]                                               {'loss': 3.0222, 'grad_norm': 5.882359027862549, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.03s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.10s/it]                                               {'loss': 3.3118, 'grad_norm': 10.81961727142334, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.10s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it]                                               {'loss': 3.4906, 'grad_norm': 7.1483259201049805, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.15s/it]                                               {'loss': 3.0881, 'grad_norm': 9.487845420837402, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.15s/it]100%|██████████| 40/40 [01:17<00:00,  1.56s/it]                                               {'loss': 2.0582, 'grad_norm': 9.436325073242188, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.56s/it]                                               {'train_runtime': 77.9502, 'train_samples_per_second': 7.248, 'train_steps_per_second': 0.513, 'train_loss': 2.8051134765148165, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.56s/it]100%|██████████| 40/40 [01:17<00:00,  1.95s/it]
CLIENT:87
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 5.2406, 'grad_norm': 10.415574073791504, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 3.2348, 'grad_norm': 8.871166229248047, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 1.9586, 'grad_norm': 8.493202209472656, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 1.8341, 'grad_norm': 11.583452224731445, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 2.3994, 'grad_norm': 10.893697738647461, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 2.1335, 'grad_norm': 10.365242004394531, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 1.4279, 'grad_norm': 10.422417640686035, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 0.4106, 'grad_norm': 18.406166076660156, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.8636, 'grad_norm': 11.646463394165039, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.0447, 'grad_norm': 7.826616287231445, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.0601, 'grad_norm': 5.8081207275390625, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.446, 'grad_norm': 4.409191608428955, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.812, 'grad_norm': 4.407569885253906, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 0.9783, 'grad_norm': 6.525284290313721, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 0.3677, 'grad_norm': 4.130215644836426, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.1109, 'grad_norm': 5.5665974617004395, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.2302, 'grad_norm': 2.227721929550171, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.3397, 'grad_norm': 2.376641035079956, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.1936, 'grad_norm': 1.203157901763916, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 0.3114, 'grad_norm': 3.5150084495544434, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.1499, 'grad_norm': 1.3148802518844604, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.2044, 'grad_norm': 1.2078633308410645, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.2822, 'grad_norm': 4.249978542327881, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0125, 'grad_norm': 0.3822421431541443, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.0702, 'grad_norm': 0.7391101121902466, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.4589, 'grad_norm': 4.675223350524902, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0986, 'grad_norm': 2.8007607460021973, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.04s/it]                                               {'loss': 0.0607, 'grad_norm': 1.4720615148544312, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.04s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.0628, 'grad_norm': 1.1807910203933716, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.0752, 'grad_norm': 1.6883634328842163, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it]                                               {'loss': 0.0675, 'grad_norm': 1.1818896532058716, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.0078, 'grad_norm': 0.3301127552986145, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.2234, 'grad_norm': 1.878009557723999, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0346, 'grad_norm': 0.892826497554779, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it]                                               {'loss': 0.0684, 'grad_norm': 1.9177509546279907, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0969, 'grad_norm': 2.510408401489258, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0871, 'grad_norm': 3.3116650581359863, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.4939, 'grad_norm': 8.639214515686035, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.2414, 'grad_norm': 1.5981568098068237, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0104, 'grad_norm': 0.4104554355144501, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.2543, 'train_samples_per_second': 7.22, 'train_steps_per_second': 0.511, 'train_loss': 0.7051118428236804, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.15s/it]                                              {'loss': 3.9093, 'grad_norm': 5.892354488372803, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.15s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 2.7384, 'grad_norm': 12.543583869934082, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 2.1125, 'grad_norm': 8.446318626403809, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 2.1297, 'grad_norm': 11.057716369628906, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 1.9871, 'grad_norm': 10.020216941833496, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.18s/it]                                              {'loss': 1.7359, 'grad_norm': 17.893695831298828, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 1.2833, 'grad_norm': 10.095345497131348, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.0804, 'grad_norm': 46.61457443237305, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.0125, 'grad_norm': 8.250706672668457, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.7507, 'grad_norm': 8.80517578125, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 0.1088, 'grad_norm': 1.9748246669769287, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.1419, 'grad_norm': 8.48572063446045, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.6853, 'grad_norm': 6.883682727813721, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 0.9907, 'grad_norm': 5.53139591217041, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.8573, 'grad_norm': 7.115433692932129, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:38,  1.59s/it]                                               {'loss': 0.0476, 'grad_norm': 2.089226007461548, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.3925, 'grad_norm': 2.895298719406128, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.2804, 'grad_norm': 3.4204323291778564, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.4596, 'grad_norm': 6.916263580322266, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.1597, 'grad_norm': 1.8058311939239502, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.1582, 'grad_norm': 1.5413367748260498, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.4814, 'grad_norm': 4.685455322265625, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.3439, 'grad_norm': 2.7359869480133057, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.5656, 'grad_norm': 16.242380142211914, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.1821, 'grad_norm': 4.200511455535889, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.2373, 'grad_norm': 3.766214370727539, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0853, 'grad_norm': 1.4475841522216797, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.0806, 'grad_norm': 1.118972897529602, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.0925, 'grad_norm': 1.8422513008117676, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.15, 'grad_norm': 1.9909989833831787, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0332, 'grad_norm': 1.3944451808929443, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0217, 'grad_norm': 0.8427407145500183, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1481, 'grad_norm': 1.9178879261016846, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.0313, 'grad_norm': 1.0850765705108643, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0676, 'grad_norm': 1.5773530006408691, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0653, 'grad_norm': 1.4875602722167969, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it]                                               {'loss': 0.0824, 'grad_norm': 1.0970566272735596, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.0503, 'grad_norm': 1.2384910583496094, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0666, 'grad_norm': 0.9163804054260254, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0258, 'grad_norm': 1.8336137533187866, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.9137, 'train_samples_per_second': 7.16, 'train_steps_per_second': 0.507, 'train_loss': 0.6958245237357914, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:99
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 4.969, 'grad_norm': 7.8357062339782715, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.9966, 'grad_norm': 5.728850841522217, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.4648, 'grad_norm': 10.304529190063477, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.1544, 'grad_norm': 12.606093406677246, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 1.5324, 'grad_norm': 14.263863563537598, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 1.4866, 'grad_norm': 8.504739761352539, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.2201, 'grad_norm': 12.872572898864746, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:17<01:08,  2.13s/it]                                              {'loss': 1.2317, 'grad_norm': 10.510379791259766, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:17<01:08,  2.13s/it] 22%|██▎       | 9/40 [00:19<01:06,  2.16s/it]                                              {'loss': 0.9999, 'grad_norm': 29.157550811767578, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:19<01:06,  2.16s/it] 25%|██▌       | 10/40 [00:21<01:05,  2.17s/it]                                               {'loss': 0.8544, 'grad_norm': 9.939037322998047, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:21<01:05,  2.17s/it] 28%|██▊       | 11/40 [00:23<01:02,  2.17s/it]                                               {'loss': 0.4535, 'grad_norm': 8.615174293518066, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:23<01:02,  2.17s/it] 30%|███       | 12/40 [00:26<01:00,  2.17s/it]                                               {'loss': 0.4288, 'grad_norm': 16.535755157470703, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:26<01:00,  2.17s/it] 32%|███▎      | 13/40 [00:28<00:58,  2.18s/it]                                               {'loss': 0.6246, 'grad_norm': 5.285254001617432, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:28<00:58,  2.18s/it] 35%|███▌      | 14/40 [00:30<00:57,  2.20s/it]                                               {'loss': 0.3425, 'grad_norm': 2.4786367416381836, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:30<00:57,  2.20s/it] 38%|███▊      | 15/40 [00:32<00:55,  2.21s/it]                                               {'loss': 0.187, 'grad_norm': 1.8746525049209595, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:32<00:55,  2.21s/it] 40%|████      | 16/40 [00:34<00:52,  2.18s/it]                                               {'loss': 0.3298, 'grad_norm': 2.2855687141418457, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:34<00:52,  2.18s/it] 42%|████▎     | 17/40 [00:37<00:50,  2.21s/it]                                               {'loss': 0.2266, 'grad_norm': 2.900953769683838, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:37<00:50,  2.21s/it] 45%|████▌     | 18/40 [00:39<00:48,  2.21s/it]                                               {'loss': 0.5233, 'grad_norm': 9.61236572265625, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:39<00:48,  2.21s/it] 48%|████▊     | 19/40 [00:41<00:46,  2.22s/it]                                               {'loss': 0.3784, 'grad_norm': 4.370232105255127, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:41<00:46,  2.22s/it] 50%|█████     | 20/40 [00:43<00:44,  2.22s/it]                                               {'loss': 0.2502, 'grad_norm': 5.894580841064453, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:43<00:44,  2.22s/it] 52%|█████▎    | 21/40 [00:46<00:42,  2.23s/it]                                               {'loss': 0.2568, 'grad_norm': 3.45405650138855, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:46<00:42,  2.23s/it] 55%|█████▌    | 22/40 [00:48<00:39,  2.22s/it]                                               {'loss': 0.1855, 'grad_norm': 2.1053006649017334, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:48<00:39,  2.22s/it] 57%|█████▊    | 23/40 [00:50<00:37,  2.22s/it]                                               {'loss': 0.171, 'grad_norm': 2.915583610534668, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:50<00:37,  2.22s/it] 60%|██████    | 24/40 [00:52<00:34,  2.18s/it]                                               {'loss': 0.3419, 'grad_norm': 5.482499122619629, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:52<00:34,  2.18s/it] 62%|██████▎   | 25/40 [00:54<00:33,  2.20s/it]                                               {'loss': 0.2802, 'grad_norm': 3.2149136066436768, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:54<00:33,  2.20s/it] 65%|██████▌   | 26/40 [00:57<00:30,  2.21s/it]                                               {'loss': 0.3699, 'grad_norm': 4.709538459777832, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:57<00:30,  2.21s/it] 68%|██████▊   | 27/40 [00:59<00:28,  2.20s/it]                                               {'loss': 0.2136, 'grad_norm': 0.9738577008247375, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:59<00:28,  2.20s/it] 70%|███████   | 28/40 [01:01<00:26,  2.23s/it]                                               {'loss': 0.2695, 'grad_norm': 1.579332947731018, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [01:01<00:26,  2.23s/it] 72%|███████▎  | 29/40 [01:03<00:24,  2.23s/it]                                               {'loss': 0.2092, 'grad_norm': 8.898303985595703, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [01:03<00:24,  2.23s/it] 75%|███████▌  | 30/40 [01:05<00:22,  2.24s/it]                                               {'loss': 0.2438, 'grad_norm': 2.882934808731079, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:05<00:22,  2.24s/it] 78%|███████▊  | 31/40 [01:08<00:20,  2.24s/it]                                               {'loss': 0.0352, 'grad_norm': 0.5669223666191101, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:08<00:20,  2.24s/it] 80%|████████  | 32/40 [01:10<00:17,  2.21s/it]                                               {'loss': 0.1518, 'grad_norm': 1.4982755184173584, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:10<00:17,  2.21s/it] 82%|████████▎ | 33/40 [01:12<00:15,  2.21s/it]                                               {'loss': 0.1441, 'grad_norm': 1.28019118309021, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:12<00:15,  2.21s/it] 85%|████████▌ | 34/40 [01:14<00:13,  2.23s/it]                                               {'loss': 0.0227, 'grad_norm': 0.6327703595161438, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:14<00:13,  2.23s/it] 88%|████████▊ | 35/40 [01:17<00:11,  2.24s/it]                                               {'loss': 0.1176, 'grad_norm': 29.949542999267578, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:17<00:11,  2.24s/it] 90%|█████████ | 36/40 [01:19<00:08,  2.23s/it]                                               {'loss': 0.5148, 'grad_norm': 5.3278422355651855, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:19<00:08,  2.23s/it] 92%|█████████▎| 37/40 [01:21<00:06,  2.25s/it]                                               {'loss': 0.0688, 'grad_norm': 1.7358598709106445, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:21<00:06,  2.25s/it] 95%|█████████▌| 38/40 [01:23<00:04,  2.24s/it]                                               {'loss': 0.2721, 'grad_norm': 8.41512393951416, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:23<00:04,  2.24s/it] 98%|█████████▊| 39/40 [01:26<00:02,  2.24s/it]                                               {'loss': 0.1174, 'grad_norm': 9.015737533569336, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:26<00:02,  2.24s/it]100%|██████████| 40/40 [01:28<00:00,  2.21s/it]                                               {'loss': 0.0788, 'grad_norm': 2.614739418029785, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:28<00:00,  2.21s/it]                                               {'train_runtime': 88.5332, 'train_samples_per_second': 7.172, 'train_steps_per_second': 0.452, 'train_loss': 0.7179802653379739, 'epoch': 5.0}
100%|██████████| 40/40 [01:28<00:00,  2.21s/it]100%|██████████| 40/40 [01:28<00:00,  2.21s/it]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 0.0013, 'grad_norm': 0.019622547551989555, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 0.003, 'grad_norm': 0.08834666758775711, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 0.0088, 'grad_norm': 0.18302728235721588, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 0.0046, 'grad_norm': 0.0376187227666378, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 0.01, 'grad_norm': 0.16127720475196838, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 0.0056, 'grad_norm': 0.08357307314872742, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 0.0033, 'grad_norm': 0.056022416800260544, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.0016, 'grad_norm': 0.07735320180654526, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.0005, 'grad_norm': 0.003702538786455989, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.0007, 'grad_norm': 0.007443253416568041, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 0.0013, 'grad_norm': 0.013080641627311707, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.0026, 'grad_norm': 0.05231019854545593, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.0017, 'grad_norm': 0.012276668101549149, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.0032, 'grad_norm': 0.033570755273103714, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 0.0035, 'grad_norm': 0.036864958703517914, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.0, 'grad_norm': 0.0007534890319220722, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.0022, 'grad_norm': 0.019607752561569214, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.0017, 'grad_norm': 0.009772313758730888, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.0029, 'grad_norm': 0.047801002860069275, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.0049, 'grad_norm': 0.04549318179488182, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.0047, 'grad_norm': 0.04408977925777435, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.0045, 'grad_norm': 0.05489081144332886, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.0016, 'grad_norm': 0.015694959089159966, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0, 'grad_norm': 5.361052535590716e-05, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.0069, 'grad_norm': 0.1121748611330986, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0012, 'grad_norm': 0.013188057579100132, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.0029, 'grad_norm': 0.028414180502295494, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.0034, 'grad_norm': 0.057827211916446686, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.0014, 'grad_norm': 0.014346672222018242, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.002, 'grad_norm': 0.024904459714889526, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0025, 'grad_norm': 0.019883450120687485, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 0.00039749068673700094, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0022, 'grad_norm': 0.03958140313625336, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0028, 'grad_norm': 0.04703223705291748, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0024, 'grad_norm': 0.021900149062275887, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0016, 'grad_norm': 0.017621150240302086, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0054, 'grad_norm': 0.042181484401226044, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0072, 'grad_norm': 0.13678032159805298, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0036, 'grad_norm': 0.04300275817513466, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0001, 'grad_norm': 0.0031497031450271606, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.6597, 'train_samples_per_second': 7.183, 'train_steps_per_second': 0.509, 'train_loss': 0.002997503010476521, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:54,  1.59it/s]  1%|          | 3/471 [00:02<06:56,  1.12it/s]  1%|          | 4/471 [00:03<08:01,  1.03s/it]  1%|          | 5/471 [00:05<08:37,  1.11s/it]  1%|▏         | 6/471 [00:06<09:00,  1.16s/it]  1%|▏         | 7/471 [00:07<09:15,  1.20s/it]  2%|▏         | 8/471 [00:08<09:24,  1.22s/it]  2%|▏         | 9/471 [00:10<09:31,  1.24s/it]  2%|▏         | 10/471 [00:11<09:34,  1.25s/it]  2%|▏         | 11/471 [00:12<09:36,  1.25s/it]  3%|▎         | 12/471 [00:13<09:39,  1.26s/it]  3%|▎         | 13/471 [00:15<09:40,  1.27s/it]  3%|▎         | 14/471 [00:16<09:40,  1.27s/it]  3%|▎         | 15/471 [00:17<09:40,  1.27s/it]  3%|▎         | 16/471 [00:19<09:41,  1.28s/it]  4%|▎         | 17/471 [00:20<09:40,  1.28s/it]  4%|▍         | 18/471 [00:21<09:40,  1.28s/it]  4%|▍         | 19/471 [00:22<09:39,  1.28s/it]  4%|▍         | 20/471 [00:24<09:39,  1.28s/it]  4%|▍         | 21/471 [00:25<09:37,  1.28s/it]  5%|▍         | 22/471 [00:26<09:37,  1.29s/it]  5%|▍         | 23/471 [00:28<09:36,  1.29s/it]  5%|▌         | 24/471 [00:29<09:36,  1.29s/it]  5%|▌         | 25/471 [00:30<09:34,  1.29s/it]  6%|▌         | 26/471 [00:31<09:33,  1.29s/it]  6%|▌         | 27/471 [00:33<09:32,  1.29s/it]  6%|▌         | 28/471 [00:34<09:32,  1.29s/it]  6%|▌         | 29/471 [00:35<09:31,  1.29s/it]  6%|▋         | 30/471 [00:37<09:31,  1.30s/it]  7%|▋         | 31/471 [00:38<09:30,  1.30s/it]  7%|▋         | 32/471 [00:39<09:28,  1.30s/it]  7%|▋         | 33/471 [00:41<09:25,  1.29s/it]  7%|▋         | 34/471 [00:42<09:25,  1.29s/it]  7%|▋         | 35/471 [00:43<09:25,  1.30s/it]  8%|▊         | 36/471 [00:44<09:23,  1.30s/it]  8%|▊         | 37/471 [00:46<09:23,  1.30s/it]  8%|▊         | 38/471 [00:47<09:23,  1.30s/it]  8%|▊         | 39/471 [00:48<09:21,  1.30s/it]  8%|▊         | 40/471 [00:50<09:20,  1.30s/it]  9%|▊         | 41/471 [00:51<09:19,  1.30s/it]  9%|▉         | 42/471 [00:52<09:19,  1.30s/it]  9%|▉         | 43/471 [00:54<09:17,  1.30s/it]  9%|▉         | 44/471 [00:55<09:16,  1.30s/it] 10%|▉         | 45/471 [00:56<09:15,  1.30s/it] 10%|▉         | 46/471 [00:57<09:14,  1.30s/it] 10%|▉         | 47/471 [00:59<09:12,  1.30s/it] 10%|█         | 48/471 [01:00<09:12,  1.31s/it] 10%|█         | 49/471 [01:01<09:10,  1.31s/it] 11%|█         | 50/471 [01:03<09:09,  1.31s/it] 11%|█         | 51/471 [01:04<09:09,  1.31s/it] 11%|█         | 52/471 [01:05<09:08,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:07,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:07,  1.31s/it] 12%|█▏        | 55/471 [01:09<09:05,  1.31s/it] 12%|█▏        | 56/471 [01:11<09:05,  1.31s/it] 12%|█▏        | 57/471 [01:12<09:03,  1.31s/it] 12%|█▏        | 58/471 [01:13<09:02,  1.31s/it] 13%|█▎        | 59/471 [01:14<09:01,  1.31s/it] 13%|█▎        | 60/471 [01:16<08:59,  1.31s/it] 13%|█▎        | 61/471 [01:17<08:58,  1.31s/it] 13%|█▎        | 62/471 [01:18<08:57,  1.31s/it] 13%|█▎        | 63/471 [01:20<08:55,  1.31s/it] 14%|█▎        | 64/471 [01:21<08:54,  1.31s/it] 14%|█▍        | 65/471 [01:22<08:53,  1.31s/it] 14%|█▍        | 66/471 [01:24<08:52,  1.31s/it] 14%|█▍        | 67/471 [01:25<08:50,  1.31s/it] 14%|█▍        | 68/471 [01:26<08:49,  1.31s/it] 15%|█▍        | 69/471 [01:28<08:47,  1.31s/it] 15%|█▍        | 70/471 [01:29<08:47,  1.32s/it] 15%|█▌        | 71/471 [01:30<08:46,  1.32s/it] 15%|█▌        | 72/471 [01:32<08:45,  1.32s/it] 15%|█▌        | 73/471 [01:33<08:44,  1.32s/it] 16%|█▌        | 74/471 [01:34<08:42,  1.32s/it] 16%|█▌        | 75/471 [01:36<08:41,  1.32s/it] 16%|█▌        | 76/471 [01:37<08:40,  1.32s/it] 16%|█▋        | 77/471 [01:38<08:39,  1.32s/it] 17%|█▋        | 78/471 [01:39<08:37,  1.32s/it] 17%|█▋        | 79/471 [01:41<08:37,  1.32s/it] 17%|█▋        | 80/471 [01:42<08:37,  1.32s/it] 17%|█▋        | 81/471 [01:43<08:34,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:32,  1.32s/it] 18%|█▊        | 83/471 [01:46<08:32,  1.32s/it] 18%|█▊        | 84/471 [01:47<08:31,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:30,  1.32s/it] 18%|█▊        | 86/471 [01:50<08:28,  1.32s/it] 18%|█▊        | 87/471 [01:51<08:26,  1.32s/it] 19%|█▊        | 88/471 [01:53<08:24,  1.32s/it] 19%|█▉        | 89/471 [01:54<08:23,  1.32s/it] 19%|█▉        | 90/471 [01:55<08:23,  1.32s/it] 19%|█▉        | 91/471 [01:57<08:20,  1.32s/it] 20%|█▉        | 92/471 [01:58<08:19,  1.32s/it] 20%|█▉        | 93/471 [01:59<08:18,  1.32s/it] 20%|█▉        | 94/471 [02:01<08:17,  1.32s/it] 20%|██        | 95/471 [02:02<08:16,  1.32s/it] 20%|██        | 96/471 [02:03<08:13,  1.32s/it] 21%|██        | 97/471 [02:05<08:13,  1.32s/it] 21%|██        | 98/471 [02:06<08:11,  1.32s/it] 21%|██        | 99/471 [02:07<08:10,  1.32s/it] 21%|██        | 100/471 [02:09<08:09,  1.32s/it] 21%|██▏       | 101/471 [02:10<08:07,  1.32s/it] 22%|██▏       | 102/471 [02:11<08:07,  1.32s/it] 22%|██▏       | 103/471 [02:12<08:06,  1.32s/it] 22%|██▏       | 104/471 [02:14<08:05,  1.32s/it] 22%|██▏       | 105/471 [02:15<08:05,  1.33s/it] 23%|██▎       | 106/471 [02:16<08:03,  1.33s/it] 23%|██▎       | 107/471 [02:18<08:01,  1.32s/it] 23%|██▎       | 108/471 [02:19<08:00,  1.32s/it] 23%|██▎       | 109/471 [02:20<07:58,  1.32s/it] 23%|██▎       | 110/471 [02:22<07:56,  1.32s/it] 24%|██▎       | 111/471 [02:23<07:55,  1.32s/it] 24%|██▍       | 112/471 [02:24<07:54,  1.32s/it] 24%|██▍       | 113/471 [02:26<07:52,  1.32s/it] 24%|██▍       | 114/471 [02:27<07:52,  1.32s/it] 24%|██▍       | 115/471 [02:28<07:51,  1.32s/it] 25%|██▍       | 116/471 [02:30<07:49,  1.32s/it] 25%|██▍       | 117/471 [02:31<07:48,  1.32s/it] 25%|██▌       | 118/471 [02:32<07:47,  1.32s/it] 25%|██▌       | 119/471 [02:34<07:45,  1.32s/it] 25%|██▌       | 120/471 [02:35<07:44,  1.32s/it] 26%|██▌       | 121/471 [02:36<07:43,  1.32s/it] 26%|██▌       | 122/471 [02:38<07:41,  1.32s/it] 26%|██▌       | 123/471 [02:39<07:40,  1.32s/it] 26%|██▋       | 124/471 [02:40<07:39,  1.33s/it] 27%|██▋       | 125/471 [02:42<07:38,  1.33s/it] 27%|██▋       | 126/471 [02:43<07:37,  1.33s/it] 27%|██▋       | 127/471 [02:44<07:35,  1.33s/it] 27%|██▋       | 128/471 [02:46<07:34,  1.32s/it] 27%|██▋       | 129/471 [02:47<07:32,  1.32s/it] 28%|██▊       | 130/471 [02:48<07:31,  1.32s/it] 28%|██▊       | 131/471 [02:50<07:29,  1.32s/it] 28%|██▊       | 132/471 [02:51<07:28,  1.32s/it] 28%|██▊       | 133/471 [02:52<07:27,  1.32s/it] 28%|██▊       | 134/471 [02:54<07:26,  1.33s/it] 29%|██▊       | 135/471 [02:55<07:25,  1.32s/it] 29%|██▉       | 136/471 [02:56<07:23,  1.32s/it] 29%|██▉       | 137/471 [02:57<07:22,  1.32s/it] 29%|██▉       | 138/471 [02:59<07:21,  1.32s/it] 30%|██▉       | 139/471 [03:00<07:19,  1.32s/it] 30%|██▉       | 140/471 [03:01<07:18,  1.32s/it] 30%|██▉       | 141/471 [03:03<07:16,  1.32s/it] 30%|███       | 142/471 [03:04<07:15,  1.32s/it] 30%|███       | 143/471 [03:05<07:13,  1.32s/it] 31%|███       | 144/471 [03:07<07:12,  1.32s/it] 31%|███       | 145/471 [03:08<07:11,  1.32s/it] 31%|███       | 146/471 [03:09<07:10,  1.32s/it] 31%|███       | 147/471 [03:11<07:09,  1.32s/it] 31%|███▏      | 148/471 [03:12<07:07,  1.32s/it] 32%|███▏      | 149/471 [03:13<07:06,  1.33s/it] 32%|███▏      | 150/471 [03:15<07:05,  1.33s/it] 32%|███▏      | 151/471 [03:16<07:04,  1.33s/it] 32%|███▏      | 152/471 [03:17<07:02,  1.32s/it] 32%|███▏      | 153/471 [03:19<07:01,  1.32s/it] 33%|███▎      | 154/471 [03:20<06:59,  1.32s/it] 33%|███▎      | 155/471 [03:21<06:58,  1.32s/it] 33%|███▎      | 156/471 [03:23<06:56,  1.32s/it] 33%|███▎      | 157/471 [03:24<06:54,  1.32s/it] 34%|███▎      | 158/471 [03:25<06:53,  1.32s/it] 34%|███▍      | 159/471 [03:27<06:51,  1.32s/it] 34%|███▍      | 160/471 [03:28<06:51,  1.32s/it] 34%|███▍      | 161/471 [03:29<06:49,  1.32s/it] 34%|███▍      | 162/471 [03:31<06:48,  1.32s/it] 35%|███▍      | 163/471 [03:32<06:47,  1.32s/it] 35%|███▍      | 164/471 [03:33<06:46,  1.32s/it] 35%|███▌      | 165/471 [03:35<06:45,  1.32s/it] 35%|███▌      | 166/471 [03:36<06:43,  1.32s/it] 35%|███▌      | 167/471 [03:37<06:42,  1.32s/it] 36%|███▌      | 168/471 [03:39<06:41,  1.32s/it] 36%|███▌      | 169/471 [03:40<06:40,  1.33s/it] 36%|███▌      | 170/471 [03:41<06:38,  1.32s/it] 36%|███▋      | 171/471 [03:42<06:37,  1.32s/it] 37%|███▋      | 172/471 [03:44<06:35,  1.32s/it] 37%|███▋      | 173/471 [03:45<06:33,  1.32s/it] 37%|███▋      | 174/471 [03:46<06:32,  1.32s/it] 37%|███▋      | 175/471 [03:48<06:31,  1.32s/it] 37%|███▋      | 176/471 [03:49<06:29,  1.32s/it] 38%|███▊      | 177/471 [03:50<06:28,  1.32s/it] 38%|███▊      | 178/471 [03:52<06:27,  1.32s/it] 38%|███▊      | 179/471 [03:53<06:26,  1.32s/it] 38%|███▊      | 180/471 [03:54<06:25,  1.32s/it] 38%|███▊      | 181/471 [03:56<06:23,  1.32s/it] 39%|███▊      | 182/471 [03:57<06:22,  1.32s/it] 39%|███▉      | 183/471 [03:58<06:21,  1.32s/it] 39%|███▉      | 184/471 [04:00<06:19,  1.32s/it] 39%|███▉      | 185/471 [04:01<06:18,  1.32s/it] 39%|███▉      | 186/471 [04:02<06:17,  1.33s/it] 40%|███▉      | 187/471 [04:04<06:16,  1.33s/it] 40%|███▉      | 188/471 [04:05<06:15,  1.33s/it] 40%|████      | 189/471 [04:06<06:13,  1.32s/it] 40%|████      | 190/471 [04:08<06:12,  1.33s/it] 41%|████      | 191/471 [04:09<06:11,  1.33s/it] 41%|████      | 192/471 [04:10<06:10,  1.33s/it] 41%|████      | 193/471 [04:12<06:08,  1.32s/it] 41%|████      | 194/471 [04:13<06:07,  1.33s/it] 41%|████▏     | 195/471 [04:14<06:06,  1.33s/it] 42%|████▏     | 196/471 [04:16<06:04,  1.33s/it] 42%|████▏     | 197/471 [04:17<06:02,  1.32s/it] 42%|████▏     | 198/471 [04:18<06:01,  1.32s/it] 42%|████▏     | 199/471 [04:20<06:00,  1.33s/it] 42%|████▏     | 200/471 [04:21<05:59,  1.33s/it] 43%|████▎     | 201/471 [04:22<05:57,  1.32s/it] 43%|████▎     | 202/471 [04:24<05:56,  1.32s/it] 43%|████▎     | 203/471 [04:25<05:55,  1.33s/it] 43%|████▎     | 204/471 [04:26<05:54,  1.33s/it] 44%|████▎     | 205/471 [04:28<05:52,  1.33s/it] 44%|████▎     | 206/471 [04:29<05:51,  1.33s/it] 44%|████▍     | 207/471 [04:30<05:50,  1.33s/it] 44%|████▍     | 208/471 [04:31<05:48,  1.32s/it] 44%|████▍     | 209/471 [04:33<05:47,  1.32s/it] 45%|████▍     | 210/471 [04:34<05:45,  1.32s/it] 45%|████▍     | 211/471 [04:35<05:44,  1.33s/it] 45%|████▌     | 212/471 [04:37<05:43,  1.33s/it] 45%|████▌     | 213/471 [04:38<05:42,  1.33s/it] 45%|████▌     | 214/471 [04:39<05:41,  1.33s/it] 46%|████▌     | 215/471 [04:41<05:39,  1.33s/it] 46%|████▌     | 216/471 [04:42<05:38,  1.33s/it] 46%|████▌     | 217/471 [04:43<05:38,  1.33s/it] 46%|████▋     | 218/471 [04:45<05:36,  1.33s/it] 46%|████▋     | 219/471 [04:46<05:35,  1.33s/it] 47%|████▋     | 220/471 [04:47<05:34,  1.33s/it] 47%|████▋     | 221/471 [04:49<05:33,  1.33s/it] 47%|████▋     | 222/471 [04:50<05:31,  1.33s/it] 47%|████▋     | 223/471 [04:51<05:30,  1.33s/it] 48%|████▊     | 224/471 [04:53<05:29,  1.33s/it] 48%|████▊     | 225/471 [04:54<05:27,  1.33s/it] 48%|████▊     | 226/471 [04:55<05:26,  1.33s/it] 48%|████▊     | 227/471 [04:57<05:25,  1.33s/it] 48%|████▊     | 228/471 [04:58<05:24,  1.33s/it] 49%|████▊     | 229/471 [04:59<05:23,  1.34s/it] 49%|████▉     | 230/471 [05:01<05:21,  1.34s/it] 49%|████▉     | 231/471 [05:02<05:20,  1.34s/it] 49%|████▉     | 232/471 [05:03<05:18,  1.33s/it] 49%|████▉     | 233/471 [05:05<05:17,  1.34s/it] 50%|████▉     | 234/471 [05:06<05:16,  1.34s/it] 50%|████▉     | 235/471 [05:07<05:15,  1.34s/it] 50%|█████     | 236/471 [05:09<05:13,  1.34s/it] 50%|█████     | 237/471 [05:10<05:12,  1.34s/it] 51%|█████     | 238/471 [05:11<05:11,  1.34s/it] 51%|█████     | 239/471 [05:13<05:10,  1.34s/it] 51%|█████     | 240/471 [05:14<05:09,  1.34s/it] 51%|█████     | 241/471 [05:15<05:08,  1.34s/it] 51%|█████▏    | 242/471 [05:17<05:06,  1.34s/it] 52%|█████▏    | 243/471 [05:18<05:05,  1.34s/it] 52%|█████▏    | 244/471 [05:20<05:04,  1.34s/it] 52%|█████▏    | 245/471 [05:21<05:02,  1.34s/it] 52%|█████▏    | 246/471 [05:22<05:00,  1.34s/it] 52%|█████▏    | 247/471 [05:24<04:59,  1.34s/it] 53%|█████▎    | 248/471 [05:25<04:58,  1.34s/it] 53%|█████▎    | 249/471 [05:26<04:57,  1.34s/it] 53%|█████▎    | 250/471 [05:28<04:55,  1.34s/it] 53%|█████▎    | 251/471 [05:29<04:53,  1.33s/it] 54%|█████▎    | 252/471 [05:30<04:52,  1.34s/it] 54%|█████▎    | 253/471 [05:32<04:51,  1.34s/it] 54%|█████▍    | 254/471 [05:33<04:50,  1.34s/it] 54%|█████▍    | 255/471 [05:34<04:48,  1.34s/it] 54%|█████▍    | 256/471 [05:36<04:47,  1.34s/it] 55%|█████▍    | 257/471 [05:37<04:45,  1.34s/it] 55%|█████▍    | 258/471 [05:38<04:44,  1.34s/it] 55%|█████▍    | 259/471 [05:40<04:43,  1.34s/it] 55%|█████▌    | 260/471 [05:41<04:41,  1.34s/it] 55%|█████▌    | 261/471 [05:42<04:40,  1.33s/it] 56%|█████▌    | 262/471 [05:44<04:38,  1.33s/it] 56%|█████▌    | 263/471 [05:45<04:37,  1.33s/it] 56%|█████▌    | 264/471 [05:46<04:35,  1.33s/it] 56%|█████▋    | 265/471 [05:48<04:34,  1.33s/it] 56%|█████▋    | 266/471 [05:49<04:33,  1.33s/it] 57%|█████▋    | 267/471 [05:50<04:31,  1.33s/it] 57%|█████▋    | 268/471 [05:52<04:30,  1.33s/it] 57%|█████▋    | 269/471 [05:53<04:29,  1.33s/it] 57%|█████▋    | 270/471 [05:54<04:27,  1.33s/it] 58%|█████▊    | 271/471 [05:56<04:26,  1.33s/it] 58%|█████▊    | 272/471 [05:57<04:24,  1.33s/it] 58%|█████▊    | 273/471 [05:58<04:23,  1.33s/it] 58%|█████▊    | 274/471 [06:00<04:21,  1.33s/it] 58%|█████▊    | 275/471 [06:01<04:20,  1.33s/it] 59%|█████▊    | 276/471 [06:02<04:18,  1.33s/it] 59%|█████▉    | 277/471 [06:03<04:17,  1.33s/it] 59%|█████▉    | 278/471 [06:05<04:16,  1.33s/it] 59%|█████▉    | 279/471 [06:06<04:15,  1.33s/it] 59%|█████▉    | 280/471 [06:07<04:13,  1.33s/it] 60%|█████▉    | 281/471 [06:09<04:12,  1.33s/it] 60%|█████▉    | 282/471 [06:10<04:11,  1.33s/it] 60%|██████    | 283/471 [06:11<04:10,  1.33s/it] 60%|██████    | 284/471 [06:13<04:08,  1.33s/it] 61%|██████    | 285/471 [06:14<04:07,  1.33s/it] 61%|██████    | 286/471 [06:15<04:06,  1.33s/it] 61%|██████    | 287/471 [06:17<04:04,  1.33s/it] 61%|██████    | 288/471 [06:18<04:03,  1.33s/it] 61%|██████▏   | 289/471 [06:19<04:01,  1.33s/it] 62%|██████▏   | 290/471 [06:21<04:00,  1.33s/it] 62%|██████▏   | 291/471 [06:22<03:58,  1.33s/it] 62%|██████▏   | 292/471 [06:23<03:57,  1.33s/it] 62%|██████▏   | 293/471 [06:25<03:55,  1.32s/it] 62%|██████▏   | 294/471 [06:26<03:54,  1.32s/it] 63%|██████▎   | 295/471 [06:27<03:53,  1.32s/it] 63%|██████▎   | 296/471 [06:29<03:51,  1.32s/it] 63%|██████▎   | 297/471 [06:30<03:50,  1.32s/it] 63%|██████▎   | 298/471 [06:31<03:49,  1.33s/it] 63%|██████▎   | 299/471 [06:33<03:47,  1.32s/it] 64%|██████▎   | 300/471 [06:34<03:46,  1.33s/it] 64%|██████▍   | 301/471 [06:35<03:45,  1.33s/it] 64%|██████▍   | 302/471 [06:37<03:43,  1.32s/it] 64%|██████▍   | 303/471 [06:38<03:42,  1.32s/it] 65%|██████▍   | 304/471 [06:39<03:40,  1.32s/it] 65%|██████▍   | 305/471 [06:41<03:39,  1.32s/it] 65%|██████▍   | 306/471 [06:42<03:38,  1.32s/it] 65%|██████▌   | 307/471 [06:43<03:37,  1.33s/it] 65%|██████▌   | 308/471 [06:45<03:36,  1.33s/it] 66%|██████▌   | 309/471 [06:46<03:34,  1.33s/it] 66%|██████▌   | 310/471 [06:47<03:33,  1.33s/it] 66%|██████▌   | 311/471 [06:49<03:32,  1.33s/it] 66%|██████▌   | 312/471 [06:50<03:30,  1.32s/it] 66%|██████▋   | 313/471 [06:51<03:29,  1.32s/it] 67%|██████▋   | 314/471 [06:53<03:27,  1.32s/it] 67%|██████▋   | 315/471 [06:54<03:26,  1.32s/it] 67%|██████▋   | 316/471 [06:55<03:25,  1.32s/it] 67%|██████▋   | 317/471 [06:57<03:24,  1.33s/it] 68%|██████▊   | 318/471 [06:58<03:22,  1.33s/it] 68%|██████▊   | 319/471 [06:59<03:21,  1.33s/it] 68%|██████▊   | 320/471 [07:01<03:20,  1.33s/it] 68%|██████▊   | 321/471 [07:02<03:18,  1.33s/it] 68%|██████▊   | 322/471 [07:03<03:17,  1.33s/it] 69%|██████▊   | 323/471 [07:04<03:16,  1.33s/it] 69%|██████▉   | 324/471 [07:06<03:15,  1.33s/it] 69%|██████▉   | 325/471 [07:07<03:13,  1.33s/it] 69%|██████▉   | 326/471 [07:08<03:12,  1.33s/it] 69%|██████▉   | 327/471 [07:10<03:10,  1.32s/it] 70%|██████▉   | 328/471 [07:11<03:09,  1.32s/it] 70%|██████▉   | 329/471 [07:12<03:08,  1.33s/it] 70%|███████   | 330/471 [07:14<03:06,  1.32s/it] 70%|███████   | 331/471 [07:15<03:05,  1.32s/it] 70%|███████   | 332/471 [07:16<03:04,  1.32s/it] 71%|███████   | 333/471 [07:18<03:02,  1.32s/it] 71%|███████   | 334/471 [07:19<03:01,  1.32s/it] 71%|███████   | 335/471 [07:20<03:00,  1.33s/it] 71%|███████▏  | 336/471 [07:22<02:58,  1.33s/it] 72%|███████▏  | 337/471 [07:23<02:57,  1.33s/it] 72%|███████▏  | 338/471 [07:24<02:56,  1.32s/it] 72%|███████▏  | 339/471 [07:26<02:55,  1.33s/it] 72%|███████▏  | 340/471 [07:27<02:53,  1.33s/it] 72%|███████▏  | 341/471 [07:28<02:52,  1.33s/it] 73%|███████▎  | 342/471 [07:30<02:51,  1.33s/it] 73%|███████▎  | 343/471 [07:31<02:50,  1.33s/it] 73%|███████▎  | 344/471 [07:32<02:48,  1.33s/it] 73%|███████▎  | 345/471 [07:34<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:35<02:46,  1.33s/it] 74%|███████▎  | 347/471 [07:36<02:44,  1.33s/it] 74%|███████▍  | 348/471 [07:38<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:39<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:40<02:40,  1.33s/it] 75%|███████▍  | 351/471 [07:42<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:43<02:37,  1.33s/it] 75%|███████▍  | 353/471 [07:44<02:36,  1.33s/it] 75%|███████▌  | 354/471 [07:46<02:35,  1.33s/it] 75%|███████▌  | 355/471 [07:47<02:34,  1.33s/it] 76%|███████▌  | 356/471 [07:48<02:32,  1.33s/it] 76%|███████▌  | 357/471 [07:50<02:31,  1.33s/it] 76%|███████▌  | 358/471 [07:51<02:30,  1.33s/it] 76%|███████▌  | 359/471 [07:52<02:28,  1.33s/it] 76%|███████▋  | 360/471 [07:54<02:27,  1.33s/it] 77%|███████▋  | 361/471 [07:55<02:26,  1.33s/it] 77%|███████▋  | 362/471 [07:56<02:24,  1.33s/it] 77%|███████▋  | 363/471 [07:58<02:23,  1.33s/it] 77%|███████▋  | 364/471 [07:59<02:21,  1.33s/it] 77%|███████▋  | 365/471 [08:00<02:20,  1.33s/it] 78%|███████▊  | 366/471 [08:02<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:03<02:18,  1.33s/it] 78%|███████▊  | 368/471 [08:04<02:16,  1.33s/it] 78%|███████▊  | 369/471 [08:06<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:07<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:08<02:12,  1.33s/it] 79%|███████▉  | 372/471 [08:10<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:11<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:12<02:08,  1.33s/it] 80%|███████▉  | 375/471 [08:13<02:07,  1.33s/it] 80%|███████▉  | 376/471 [08:15<02:06,  1.33s/it] 80%|████████  | 377/471 [08:16<02:04,  1.33s/it] 80%|████████  | 378/471 [08:17<02:03,  1.33s/it] 80%|████████  | 379/471 [08:19<02:02,  1.33s/it] 81%|████████  | 380/471 [08:20<02:00,  1.33s/it] 81%|████████  | 381/471 [08:21<01:59,  1.33s/it] 81%|████████  | 382/471 [08:23<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:24<01:57,  1.33s/it] 82%|████████▏ | 384/471 [08:25<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:27<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:28<01:53,  1.33s/it] 82%|████████▏ | 387/471 [08:29<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:31<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:32<01:48,  1.33s/it] 83%|████████▎ | 390/471 [08:33<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:35<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:36<01:44,  1.33s/it] 83%|████████▎ | 393/471 [08:37<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:39<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:40<01:40,  1.33s/it] 84%|████████▍ | 396/471 [08:41<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:43<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:44<01:36,  1.33s/it] 85%|████████▍ | 399/471 [08:45<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:47<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:48<01:32,  1.33s/it] 85%|████████▌ | 402/471 [08:49<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:51<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:52<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:53<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:55<01:26,  1.33s/it] 86%|████████▋ | 407/471 [08:56<01:24,  1.33s/it] 87%|████████▋ | 408/471 [08:57<01:23,  1.33s/it] 87%|████████▋ | 409/471 [08:59<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:00<01:21,  1.33s/it] 87%|████████▋ | 411/471 [09:01<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:03<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:04<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:05<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:07<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:08<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:09<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:11<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:12<01:09,  1.33s/it] 89%|████████▉ | 420/471 [09:13<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:15<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:16<01:05,  1.33s/it] 90%|████████▉ | 423/471 [09:17<01:03,  1.33s/it] 90%|█████████ | 424/471 [09:19<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:20<01:01,  1.33s/it] 90%|█████████ | 426/471 [09:21<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:23<00:58,  1.34s/it] 91%|█████████ | 428/471 [09:24<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:25<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:27<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:28<00:53,  1.33s/it] 92%|█████████▏| 432/471 [09:29<00:52,  1.33s/it] 92%|█████████▏| 433/471 [09:31<00:50,  1.34s/it] 92%|█████████▏| 434/471 [09:32<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:33<00:48,  1.33s/it] 93%|█████████▎| 436/471 [09:35<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:36<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:37<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:39<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:40<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:41<00:40,  1.34s/it] 94%|█████████▍| 442/471 [09:43<00:38,  1.34s/it] 94%|█████████▍| 443/471 [09:44<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:45<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:47<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:48<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:49<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:51<00:30,  1.34s/it] 95%|█████████▌| 449/471 [09:52<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:53<00:28,  1.34s/it] 96%|█████████▌| 451/471 [09:55<00:26,  1.34s/it] 96%|█████████▌| 452/471 [09:56<00:25,  1.34s/it] 96%|█████████▌| 453/471 [09:57<00:24,  1.35s/it] 96%|█████████▋| 454/471 [09:59<00:22,  1.35s/it] 97%|█████████▋| 455/471 [10:00<00:21,  1.35s/it] 97%|█████████▋| 456/471 [10:02<00:20,  1.35s/it] 97%|█████████▋| 457/471 [10:03<00:18,  1.35s/it] 97%|█████████▋| 458/471 [10:04<00:17,  1.35s/it] 97%|█████████▋| 459/471 [10:06<00:16,  1.35s/it] 98%|█████████▊| 460/471 [10:07<00:14,  1.35s/it] 98%|█████████▊| 461/471 [10:08<00:13,  1.35s/it] 98%|█████████▊| 462/471 [10:10<00:12,  1.35s/it] 98%|█████████▊| 463/471 [10:11<00:10,  1.35s/it] 99%|█████████▊| 464/471 [10:12<00:09,  1.35s/it] 99%|█████████▊| 465/471 [10:14<00:08,  1.35s/it] 99%|█████████▉| 466/471 [10:15<00:06,  1.35s/it] 99%|█████████▉| 467/471 [10:16<00:05,  1.35s/it] 99%|█████████▉| 468/471 [10:18<00:04,  1.35s/it]100%|█████████▉| 469/471 [10:19<00:02,  1.35s/it]100%|█████████▉| 470/471 [10:20<00:01,  1.35s/it]100%|██████████| 471/471 [10:21<00:00,  1.24s/it]100%|██████████| 471/471 [10:21<00:00,  1.32s/it]
{'eval_loss': 4.170910358428955, 'eval_model_preparation_time': 0.0108, 'eval_acc': 0.23698884758364314, 'eval_runtime': 623.1146, 'eval_samples_per_second': 12.088, 'eval_steps_per_second': 0.756}
ROUND:9
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.23s/it]                                              {'loss': 3.0353, 'grad_norm': 7.5341596603393555, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.23s/it]  5%|▌         | 2/40 [00:04<01:25,  2.26s/it]                                              {'loss': 3.8771, 'grad_norm': 11.562177658081055, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:25,  2.26s/it]  8%|▊         | 3/40 [00:06<01:23,  2.24s/it]                                              {'loss': 2.0147, 'grad_norm': 8.873174667358398, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.24s/it] 10%|█         | 4/40 [00:09<01:21,  2.27s/it]                                              {'loss': 2.4632, 'grad_norm': 24.1126766204834, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:21,  2.27s/it] 12%|█▎        | 5/40 [00:11<01:18,  2.26s/it]                                              {'loss': 1.8124, 'grad_norm': 11.29350471496582, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:18,  2.26s/it] 15%|█▌        | 6/40 [00:13<01:16,  2.26s/it]                                              {'loss': 1.9183, 'grad_norm': 8.637687683105469, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:16,  2.26s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it]                                              {'loss': 2.2409, 'grad_norm': 11.625906944274902, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 0.3449, 'grad_norm': 14.277205467224121, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it]                                              {'loss': 1.2484, 'grad_norm': 5.380290985107422, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 0.9065, 'grad_norm': 7.241910934448242, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it]                                               {'loss': 0.8431, 'grad_norm': 4.22379207611084, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it] 30%|███       | 12/40 [00:24<00:58,  2.10s/it]                                               {'loss': 0.5609, 'grad_norm': 4.3521013259887695, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.10s/it] 32%|███▎      | 13/40 [00:27<00:57,  2.14s/it]                                               {'loss': 0.687, 'grad_norm': 6.281558513641357, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it]                                               {'loss': 0.449, 'grad_norm': 4.697924613952637, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.21s/it]                                               {'loss': 0.6461, 'grad_norm': 5.947938919067383, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.21s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 0.0612, 'grad_norm': 2.500335931777954, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:34<00:41,  1.79s/it]                                               {'loss': 0.4833, 'grad_norm': 2.5581705570220947, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it]                                               {'loss': 0.0608, 'grad_norm': 0.9364613890647888, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 0.1638, 'grad_norm': 3.9205944538116455, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:42,  2.10s/it]                                               {'loss': 0.126, 'grad_norm': 1.789017677307129, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.10s/it] 52%|█████▎    | 21/40 [00:43<00:40,  2.14s/it]                                               {'loss': 0.179, 'grad_norm': 4.0586676597595215, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.20s/it]                                               {'loss': 0.465, 'grad_norm': 5.646897792816162, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.20s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.5391, 'grad_norm': 3.5013179779052734, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 0.0095, 'grad_norm': 0.669339120388031, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:50<00:26,  1.80s/it]                                               {'loss': 0.6229, 'grad_norm': 5.10507869720459, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it]                                               {'loss': 0.2151, 'grad_norm': 4.12686014175415, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it]                                               {'loss': 0.1354, 'grad_norm': 3.144972562789917, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it] 70%|███████   | 28/40 [00:57<00:25,  2.14s/it]                                               {'loss': 0.0797, 'grad_norm': 2.6207275390625, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:57<00:25,  2.14s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it]                                               {'loss': 0.0859, 'grad_norm': 1.65264892578125, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it]                                               {'loss': 0.2127, 'grad_norm': 1.296727180480957, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it]                                               {'loss': 0.4797, 'grad_norm': 2.6287901401519775, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it] 80%|████████  | 32/40 [01:04<00:13,  1.63s/it]                                               {'loss': 0.0, 'grad_norm': 0.0018517404096201062, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:04<00:13,  1.63s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.82s/it]                                               {'loss': 0.0952, 'grad_norm': 2.531576633453369, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.82s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.97s/it]                                               {'loss': 0.1596, 'grad_norm': 3.0434374809265137, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.97s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it]                                               {'loss': 0.0433, 'grad_norm': 0.7898485064506531, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.15s/it]                                               {'loss': 0.0269, 'grad_norm': 0.542730987071991, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.15s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.20s/it]                                               {'loss': 0.1063, 'grad_norm': 1.3682513236999512, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.20s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.23s/it]                                               {'loss': 0.0169, 'grad_norm': 0.2575875222682953, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.23s/it] 98%|█████████▊| 39/40 [01:20<00:02,  2.25s/it]                                               {'loss': 0.1356, 'grad_norm': 1.5401535034179688, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:20<00:02,  2.25s/it]100%|██████████| 40/40 [01:20<00:00,  1.63s/it]                                               {'loss': 0.049, 'grad_norm': 3.5110244750976562, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.63s/it]                                               {'train_runtime': 80.8065, 'train_samples_per_second': 6.992, 'train_steps_per_second': 0.495, 'train_loss': 0.6899914835672462, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.63s/it]100%|██████████| 40/40 [01:20<00:00,  2.02s/it]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 5.8762, 'grad_norm': 7.799028396606445, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 3.5476, 'grad_norm': 9.523151397705078, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 3.5687, 'grad_norm': 9.781917572021484, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 2.7582, 'grad_norm': 13.46104621887207, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.7152, 'grad_norm': 15.119105339050293, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 1.9263, 'grad_norm': 15.947698593139648, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 1.0832, 'grad_norm': 11.671085357666016, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 1.9001, 'grad_norm': 59.086097717285156, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 0.8409, 'grad_norm': 6.322973728179932, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 0.6731, 'grad_norm': 6.312934398651123, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.5213, 'grad_norm': 10.147908210754395, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.9358, 'grad_norm': 6.441622734069824, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.7684, 'grad_norm': 5.8261237144470215, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.961, 'grad_norm': 6.6199049949646, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 1.014, 'grad_norm': 7.106052398681641, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 2.3592, 'grad_norm': 41.30318832397461, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.5252, 'grad_norm': 4.151496410369873, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.4476, 'grad_norm': 2.9719789028167725, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.5257, 'grad_norm': 3.4861996173858643, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.6261, 'grad_norm': 5.411280632019043, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.2611, 'grad_norm': 3.1804158687591553, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.165, 'grad_norm': 3.224435806274414, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.4111, 'grad_norm': 4.082499027252197, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:25,  1.56s/it]                                               {'loss': 0.0114, 'grad_norm': 0.5741499066352844, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.2886, 'grad_norm': 2.2004756927490234, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.221, 'grad_norm': 2.4426794052124023, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.1317, 'grad_norm': 2.2171292304992676, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.0943, 'grad_norm': 1.0772254467010498, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.3416, 'grad_norm': 2.1219639778137207, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.3286, 'grad_norm': 2.3744256496429443, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.1592, 'grad_norm': 2.0451860427856445, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.483, 'grad_norm': 28.102991104125977, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0489, 'grad_norm': 1.1568714380264282, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.1919, 'grad_norm': 2.540512800216675, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0529, 'grad_norm': 1.0711935758590698, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0321, 'grad_norm': 0.832008421421051, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0677, 'grad_norm': 1.5338491201400757, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 0.256, 'grad_norm': 2.286583185195923, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.2756, 'grad_norm': 1.7643338441848755, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0008, 'grad_norm': 0.0377153642475605, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.7654, 'train_samples_per_second': 7.173, 'train_steps_per_second': 0.508, 'train_loss': 0.9599035004168399, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 4.131, 'grad_norm': 9.487096786499023, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 2.0392, 'grad_norm': 9.079503059387207, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 2.2589, 'grad_norm': 10.096070289611816, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.0287, 'grad_norm': 9.976858139038086, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.3893, 'grad_norm': 22.428752899169922, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.0556, 'grad_norm': 8.488566398620605, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 3.617, 'grad_norm': 16.438249588012695, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.4887, 'grad_norm': 21.547056198120117, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.4077, 'grad_norm': 8.677960395812988, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 1.0209, 'grad_norm': 6.06422758102417, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.463, 'grad_norm': 5.215925693511963, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.5767, 'grad_norm': 6.7545976638793945, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 0.8318, 'grad_norm': 5.199300289154053, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.7338, 'grad_norm': 5.5365376472473145, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it]                                               {'loss': 0.645, 'grad_norm': 6.17041540145874, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.412, 'grad_norm': 9.68169116973877, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 1.438, 'grad_norm': 16.334802627563477, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.5319, 'grad_norm': 8.349235534667969, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.5923, 'grad_norm': 3.711721897125244, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.0912, 'grad_norm': 1.9650382995605469, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.4857, 'grad_norm': 2.435903310775757, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.6985, 'grad_norm': 19.24869155883789, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.4729, 'grad_norm': 3.498072385787964, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0573, 'grad_norm': 2.199342966079712, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.2116, 'grad_norm': 1.2326114177703857, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.1113, 'grad_norm': 1.7676526308059692, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.1826, 'grad_norm': 4.542879581451416, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.2763, 'grad_norm': 4.225785732269287, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.2905, 'grad_norm': 5.362212181091309, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0911, 'grad_norm': 1.2616262435913086, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.2193, 'grad_norm': 1.515676498413086, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 7.769133662804961e-05, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it]                                               {'loss': 0.2336, 'grad_norm': 0.9288179278373718, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0419, 'grad_norm': 0.5486077666282654, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.1968, 'grad_norm': 1.284653902053833, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0651, 'grad_norm': 0.9862284064292908, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.0342, 'grad_norm': 0.6749750971794128, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0357, 'grad_norm': 0.8260211944580078, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]                                               {'loss': 0.0531, 'grad_norm': 0.8474991321563721, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'loss': 0.0073, 'grad_norm': 0.31599658727645874, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'train_runtime': 79.3304, 'train_samples_per_second': 7.122, 'train_steps_per_second': 0.504, 'train_loss': 0.7629327313973988, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:5
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 5.8277, 'grad_norm': 8.049110412597656, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 3.6084, 'grad_norm': 8.584038734436035, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.651, 'grad_norm': 10.554760932922363, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 2.0073, 'grad_norm': 20.391447067260742, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.9987, 'grad_norm': 12.201125144958496, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 0.9362, 'grad_norm': 10.010581970214844, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 1.5272, 'grad_norm': 11.142991065979004, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.074, 'grad_norm': 4.033220291137695, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 2.4787, 'grad_norm': 25.559724807739258, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.4252, 'grad_norm': 13.579278945922852, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 0.6443, 'grad_norm': 6.32320499420166, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.4869, 'grad_norm': 7.628712177276611, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.8514, 'grad_norm': 7.115572929382324, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.9595, 'grad_norm': 5.973169326782227, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 1.4621, 'grad_norm': 8.407373428344727, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 5.0076, 'grad_norm': 46.0380744934082, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.909, 'grad_norm': 17.221759796142578, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.4318, 'grad_norm': 4.5857157707214355, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.4198, 'grad_norm': 4.3928422927856445, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.6958, 'grad_norm': 7.797155857086182, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.7662, 'grad_norm': 10.134944915771484, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.9405, 'grad_norm': 7.679423809051514, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.9426, 'grad_norm': 5.739687919616699, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 1.4974, 'grad_norm': 84.63075256347656, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it]                                               {'loss': 0.3226, 'grad_norm': 17.286474227905273, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.7692, 'grad_norm': 13.010808944702148, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.2292, 'grad_norm': 7.290314674377441, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.1465, 'grad_norm': 2.211904287338257, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.3635, 'grad_norm': 4.965546607971191, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.6223, 'grad_norm': 6.02399206161499, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.2737, 'grad_norm': 2.4968903064727783, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0005, 'grad_norm': 0.023276831954717636, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.2429, 'grad_norm': 2.811427354812622, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.8126, 'grad_norm': 8.031121253967285, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.6336, 'grad_norm': 7.495808124542236, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.3869, 'grad_norm': 5.73921012878418, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it]                                               {'loss': 0.3334, 'grad_norm': 4.912177562713623, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.7115, 'grad_norm': 9.956803321838379, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.4658, 'grad_norm': 4.134146690368652, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'loss': 0.0004, 'grad_norm': 0.025295164436101913, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'train_runtime': 78.9043, 'train_samples_per_second': 7.161, 'train_steps_per_second': 0.507, 'train_loss': 1.1465933894498448, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.61s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:52
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.5362, 'grad_norm': 6.489325523376465, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.5648, 'grad_norm': 8.70491886138916, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 4.3428, 'grad_norm': 14.710694313049316, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.28, 'grad_norm': 8.053844451904297, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.2713, 'grad_norm': 10.713949203491211, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.0638, 'grad_norm': 12.387572288513184, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 3.1505, 'grad_norm': 23.67930030822754, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 6.198, 'grad_norm': 53.22220993041992, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.8765, 'grad_norm': 14.912446975708008, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.5255, 'grad_norm': 10.505940437316895, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 0.7884, 'grad_norm': 11.4176664352417, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.539, 'grad_norm': 5.535506248474121, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.074, 'grad_norm': 8.551322937011719, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.9098, 'grad_norm': 4.950675010681152, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.2973, 'grad_norm': 7.446134090423584, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.5379, 'grad_norm': 15.289238929748535, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 1.1136, 'grad_norm': 11.021194458007812, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.5464, 'grad_norm': 3.609673261642456, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.5493, 'grad_norm': 3.538322687149048, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.3572, 'grad_norm': 2.6614491939544678, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 1.1493, 'grad_norm': 8.30892276763916, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.9507, 'grad_norm': 5.305154323577881, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it]                                               {'loss': 0.4294, 'grad_norm': 4.855867862701416, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.617, 'grad_norm': 10.225571632385254, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.3696, 'grad_norm': 6.5211358070373535, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.3431, 'grad_norm': 2.556838035583496, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.3703, 'grad_norm': 8.963787078857422, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.2319, 'grad_norm': 2.352447032928467, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.1034, 'grad_norm': 1.4456371068954468, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0605, 'grad_norm': 2.49600887298584, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.1961, 'grad_norm': 6.108098983764648, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.233, 'grad_norm': 9.343704223632812, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.1752, 'grad_norm': 1.8650546073913574, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.068, 'grad_norm': 0.939469575881958, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it]                                               {'loss': 0.6889, 'grad_norm': 11.129083633422852, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.1242, 'grad_norm': 4.97393274307251, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.083, 'grad_norm': 1.1493115425109863, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.0551, 'grad_norm': 1.5763076543807983, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0931, 'grad_norm': 1.828610897064209, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.305, 'grad_norm': 10.900693893432617, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.4526, 'train_samples_per_second': 7.111, 'train_steps_per_second': 0.503, 'train_loss': 1.1792365377768874, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:41
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:20,  2.08s/it]                                              {'loss': 4.4609, 'grad_norm': 5.314558506011963, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:20,  2.08s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 2.2861, 'grad_norm': 5.085967063903809, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 3.0225, 'grad_norm': 11.995132446289062, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:17,  2.14s/it]                                              {'loss': 1.6537, 'grad_norm': 15.445638656616211, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.14s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.0402, 'grad_norm': 8.223722457885742, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 2.2697, 'grad_norm': 10.444244384765625, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 1.8486, 'grad_norm': 9.831016540527344, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 5.7712, 'grad_norm': 70.36555480957031, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.9382, 'grad_norm': 12.705411911010742, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.6972, 'grad_norm': 6.31248664855957, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it]                                               {'loss': 1.8325, 'grad_norm': 8.326959609985352, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 0.8641, 'grad_norm': 6.311605453491211, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.06s/it]                                               {'loss': 1.1478, 'grad_norm': 5.264804840087891, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.06s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.8487, 'grad_norm': 4.638849258422852, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.6545, 'grad_norm': 4.437869071960449, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0197, 'grad_norm': 1.323427677154541, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.75s/it]                                               {'loss': 0.381, 'grad_norm': 2.795316219329834, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.362, 'grad_norm': 1.587105631828308, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it]                                               {'loss': 0.7482, 'grad_norm': 3.01399827003479, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it] 50%|█████     | 20/40 [00:39<00:40,  2.02s/it]                                               {'loss': 0.416, 'grad_norm': 4.743344783782959, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.02s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it]                                               {'loss': 0.6651, 'grad_norm': 5.246273994445801, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.3842, 'grad_norm': 2.753262519836426, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.2113, 'grad_norm': 1.6361178159713745, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.5912, 'grad_norm': 8.494894981384277, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.4623, 'grad_norm': 2.7568819522857666, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.1078, 'grad_norm': 2.9604241847991943, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it]                                               {'loss': 0.4628, 'grad_norm': 2.0722293853759766, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.0788, 'grad_norm': 1.4686980247497559, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.3158, 'grad_norm': 1.4975472688674927, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.0838, 'grad_norm': 1.049256682395935, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it]                                               {'loss': 0.138, 'grad_norm': 2.168759822845459, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it] 80%|████████  | 32/40 [01:01<00:12,  1.57s/it]                                               {'loss': 0.0072, 'grad_norm': 0.3175097405910492, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.0356, 'grad_norm': 0.5465847849845886, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0401, 'grad_norm': 0.5832734704017639, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it]                                               {'loss': 0.0182, 'grad_norm': 0.2676793932914734, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it]                                               {'loss': 0.5523, 'grad_norm': 1.7300019264221191, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0307, 'grad_norm': 0.5602419376373291, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.2263, 'grad_norm': 4.115614891052246, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.15s/it]                                               {'loss': 0.3855, 'grad_norm': 4.098814487457275, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.15s/it]100%|██████████| 40/40 [01:17<00:00,  1.56s/it]                                               {'loss': 0.0013, 'grad_norm': 0.06879456341266632, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.56s/it]                                               {'train_runtime': 77.8922, 'train_samples_per_second': 7.254, 'train_steps_per_second': 0.514, 'train_loss': 0.926521369171678, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.56s/it]100%|██████████| 40/40 [01:17<00:00,  1.95s/it]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 5.228, 'grad_norm': 11.995524406433105, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 3.8762, 'grad_norm': 11.444113731384277, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 2.6366, 'grad_norm': 6.606461524963379, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:19,  2.21s/it]                                              {'loss': 1.2091, 'grad_norm': 9.433911323547363, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 3.026, 'grad_norm': 21.333465576171875, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.4606, 'grad_norm': 7.043447971343994, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.4451, 'grad_norm': 8.668109893798828, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.56s/it]                                              {'loss': 1.2799, 'grad_norm': 26.47623634338379, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.806, 'grad_norm': 9.433354377746582, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 0.352, 'grad_norm': 4.141020774841309, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.8082, 'grad_norm': 4.412131309509277, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.5447, 'grad_norm': 3.5827431678771973, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.7778, 'grad_norm': 6.119998455047607, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it]                                               {'loss': 0.7983, 'grad_norm': 5.7296671867370605, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.432, 'grad_norm': 5.115890026092529, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0063, 'grad_norm': 0.20913012325763702, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.3805, 'grad_norm': 4.329606056213379, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 0.2586, 'grad_norm': 2.185324192047119, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.19, 'grad_norm': 6.477964878082275, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.10s/it]                                               {'loss': 0.3873, 'grad_norm': 7.1571502685546875, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.1192, 'grad_norm': 5.225560665130615, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.0853, 'grad_norm': 1.194332242012024, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.1001, 'grad_norm': 2.122849702835083, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0563, 'grad_norm': 1.4851778745651245, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.0761, 'grad_norm': 1.294159173965454, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0932, 'grad_norm': 1.1421873569488525, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.01s/it]                                               {'loss': 0.1466, 'grad_norm': 3.1491799354553223, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.01s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0188, 'grad_norm': 0.6771570444107056, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.1005, 'grad_norm': 2.3536391258239746, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.055, 'grad_norm': 0.8964310884475708, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.1529, 'grad_norm': 1.835367202758789, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.5452, 'grad_norm': 10.945207595825195, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0477, 'grad_norm': 0.6727921366691589, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.0436, 'grad_norm': 0.6529116034507751, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.0575, 'grad_norm': 0.9263671636581421, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0269, 'grad_norm': 0.657265305519104, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0171, 'grad_norm': 0.8375887870788574, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.0349, 'grad_norm': 0.562337338924408, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0178, 'grad_norm': 0.49483099579811096, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0144, 'grad_norm': 0.7662329077720642, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.665, 'train_samples_per_second': 7.092, 'train_steps_per_second': 0.502, 'train_loss': 0.6928025959059596, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 3.221, 'grad_norm': 8.175414085388184, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.7515, 'grad_norm': 7.679754257202148, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.7681, 'grad_norm': 11.677840232849121, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.7947, 'grad_norm': 10.228598594665527, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.8588, 'grad_norm': 9.372467994689941, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 1.7799, 'grad_norm': 8.807268142700195, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 1.8614, 'grad_norm': 11.423445701599121, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 0.0549, 'grad_norm': 2.47100567817688, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.1197, 'grad_norm': 5.462677955627441, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.7333, 'grad_norm': 7.4430155754089355, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.5176, 'grad_norm': 5.683028221130371, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.3619, 'grad_norm': 3.628551483154297, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.403, 'grad_norm': 11.45412826538086, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 0.5353, 'grad_norm': 7.6899733543396, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 0.8471, 'grad_norm': 3.6891212463378906, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 2.8354, 'grad_norm': 18.72043800354004, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.1126, 'grad_norm': 2.5135486125946045, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.1764, 'grad_norm': 1.845526099205017, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.183, 'grad_norm': 3.91410231590271, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.2339, 'grad_norm': 1.2118571996688843, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.5365, 'grad_norm': 7.5028395652771, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.2362, 'grad_norm': 4.334965229034424, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.3562, 'grad_norm': 2.3844738006591797, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 2.6726, 'grad_norm': 52.0461311340332, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.0804, 'grad_norm': 3.352053642272949, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0497, 'grad_norm': 1.4704904556274414, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0438, 'grad_norm': 0.8024060726165771, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.0418, 'grad_norm': 0.7621126174926758, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.1022, 'grad_norm': 2.191305160522461, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.7655, 'grad_norm': 3.9218997955322266, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.2426, 'grad_norm': 1.2156932353973389, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0659, 'grad_norm': 3.668602228164673, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0157, 'grad_norm': 0.7830473780632019, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.0145, 'grad_norm': 0.4433087110519409, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.2197, 'grad_norm': 0.4073644280433655, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0129, 'grad_norm': 0.2599775791168213, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.3982, 'grad_norm': 4.891011714935303, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.3408, 'grad_norm': 13.716462135314941, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.1671, 'grad_norm': 1.1968610286712646, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0197, 'grad_norm': 1.2329866886138916, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.4368, 'train_samples_per_second': 7.203, 'train_steps_per_second': 0.51, 'train_loss': 0.8132871466455981, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.5941, 'grad_norm': 5.50918436050415, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]                                              {'loss': 4.0104, 'grad_norm': 5.537449836730957, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 4.8591, 'grad_norm': 11.815027236938477, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.5767, 'grad_norm': 12.744322776794434, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 2.8954, 'grad_norm': 10.907217979431152, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it]                                              {'loss': 2.8733, 'grad_norm': 8.752199172973633, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 2.2844, 'grad_norm': 8.459885597229004, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.0451, 'grad_norm': 51.220890045166016, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it]                                              {'loss': 2.183, 'grad_norm': 16.427698135375977, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.2846, 'grad_norm': 13.608343124389648, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.7167, 'grad_norm': 19.17447853088379, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 1.1872, 'grad_norm': 24.951486587524414, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.07s/it]                                               {'loss': 1.5723, 'grad_norm': 10.397356033325195, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 1.2948, 'grad_norm': 15.666646957397461, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.1075, 'grad_norm': 5.318631172180176, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.388, 'grad_norm': 10.852157592773438, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it]                                               {'loss': 1.0402, 'grad_norm': 28.183176040649414, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 0.5153, 'grad_norm': 5.175846576690674, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.7055, 'grad_norm': 9.679825782775879, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.4911, 'grad_norm': 5.823432922363281, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.6761, 'grad_norm': 4.277158737182617, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.8944, 'grad_norm': 5.495151042938232, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 1.1018, 'grad_norm': 9.388360023498535, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.56s/it]                                               {'loss': 1.4003, 'grad_norm': 53.613887786865234, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.2194, 'grad_norm': 3.295919895172119, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.3793, 'grad_norm': 3.6630687713623047, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it]                                               {'loss': 0.8145, 'grad_norm': 7.929713249206543, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.97s/it] 70%|███████   | 28/40 [00:55<00:24,  2.04s/it]                                               {'loss': 0.4415, 'grad_norm': 3.6081674098968506, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.04s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.4209, 'grad_norm': 4.372557163238525, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.4456, 'grad_norm': 2.1818270683288574, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it]                                               {'loss': 0.1939, 'grad_norm': 2.4801013469696045, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.3444, 'grad_norm': 10.80517864227295, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.3299, 'grad_norm': 3.4570529460906982, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.1513, 'grad_norm': 3.1300599575042725, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it]                                               {'loss': 0.3852, 'grad_norm': 8.646838188171387, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 1.2659, 'grad_norm': 31.387901306152344, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.8876, 'grad_norm': 52.73494338989258, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.8251, 'grad_norm': 15.870737075805664, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.9209, 'grad_norm': 13.094446182250977, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.2644, 'grad_norm': 71.4149398803711, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 78.1813, 'train_samples_per_second': 7.227, 'train_steps_per_second': 0.512, 'train_loss': 1.349676476046443, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.57s/it]100%|██████████| 40/40 [01:18<00:00,  1.95s/it]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.7711, 'grad_norm': 6.2138237953186035, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 3.2095, 'grad_norm': 15.66326904296875, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 3.3951, 'grad_norm': 11.65244197845459, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 2.055, 'grad_norm': 11.653973579406738, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 3.4662, 'grad_norm': 17.77657127380371, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.7874, 'grad_norm': 10.454252243041992, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 2.0599, 'grad_norm': 14.567580223083496, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 3.7126, 'grad_norm': 63.94647979736328, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.9227, 'grad_norm': 6.342011451721191, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 1.7476, 'grad_norm': 7.822750091552734, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 1.2332, 'grad_norm': 7.624660968780518, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 1.2118, 'grad_norm': 6.6955952644348145, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 0.9412, 'grad_norm': 5.619222640991211, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.8936, 'grad_norm': 8.071124076843262, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 0.5564, 'grad_norm': 4.187943458557129, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 1.0506, 'grad_norm': 20.99268341064453, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.3297, 'grad_norm': 6.005308151245117, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.4753, 'grad_norm': 8.342584609985352, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.6373, 'grad_norm': 5.445551872253418, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.4891, 'grad_norm': 3.3836092948913574, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.3503, 'grad_norm': 4.6453962326049805, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.4466, 'grad_norm': 5.8704705238342285, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.2838, 'grad_norm': 3.733484983444214, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.0603, 'grad_norm': 2.4358646869659424, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.4684, 'grad_norm': 5.898180961608887, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.3699, 'grad_norm': 4.625401020050049, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.1078, 'grad_norm': 2.0591142177581787, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.2447, 'grad_norm': 3.300511598587036, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.136, 'grad_norm': 1.4963597059249878, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.1207, 'grad_norm': 2.5558438301086426, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.0597, 'grad_norm': 1.3225605487823486, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0331, 'grad_norm': 1.0624181032180786, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0204, 'grad_norm': 0.27829793095588684, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.1911, 'grad_norm': 3.846435546875, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1292, 'grad_norm': 2.260897159576416, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.0676, 'grad_norm': 1.2061822414398193, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.0291, 'grad_norm': 0.6167237162590027, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.0531, 'grad_norm': 2.4851796627044678, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]                                               {'loss': 0.1979, 'grad_norm': 2.0611371994018555, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0209, 'grad_norm': 1.0450078248977661, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.3737, 'train_samples_per_second': 7.118, 'train_steps_per_second': 0.504, 'train_loss': 0.9083960406016558, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:56,  1.58it/s]  1%|          | 3/471 [00:02<06:59,  1.12it/s]  1%|          | 4/471 [00:03<08:04,  1.04s/it]  1%|          | 5/471 [00:05<08:41,  1.12s/it]  1%|▏         | 6/471 [00:06<09:03,  1.17s/it]  1%|▏         | 7/471 [00:07<09:19,  1.21s/it]  2%|▏         | 8/471 [00:08<09:28,  1.23s/it]  2%|▏         | 9/471 [00:10<09:34,  1.24s/it]  2%|▏         | 10/471 [00:11<09:38,  1.26s/it]  2%|▏         | 11/471 [00:12<09:40,  1.26s/it]  3%|▎         | 12/471 [00:14<09:42,  1.27s/it]  3%|▎         | 13/471 [00:15<09:44,  1.28s/it]  3%|▎         | 14/471 [00:16<09:44,  1.28s/it]  3%|▎         | 15/471 [00:17<09:43,  1.28s/it]  3%|▎         | 16/471 [00:19<09:44,  1.28s/it]  4%|▎         | 17/471 [00:20<09:43,  1.29s/it]  4%|▍         | 18/471 [00:21<09:43,  1.29s/it]  4%|▍         | 19/471 [00:23<09:42,  1.29s/it]  4%|▍         | 20/471 [00:24<09:42,  1.29s/it]  4%|▍         | 21/471 [00:25<09:41,  1.29s/it]  5%|▍         | 22/471 [00:26<09:40,  1.29s/it]  5%|▍         | 23/471 [00:28<09:39,  1.29s/it]  5%|▌         | 24/471 [00:29<09:38,  1.29s/it]  5%|▌         | 25/471 [00:30<09:37,  1.30s/it]  6%|▌         | 26/471 [00:32<09:36,  1.30s/it]  6%|▌         | 27/471 [00:33<09:35,  1.30s/it]  6%|▌         | 28/471 [00:34<09:34,  1.30s/it]  6%|▌         | 29/471 [00:36<09:33,  1.30s/it]  6%|▋         | 30/471 [00:37<09:33,  1.30s/it]  7%|▋         | 31/471 [00:38<09:31,  1.30s/it]  7%|▋         | 32/471 [00:39<09:30,  1.30s/it]  7%|▋         | 33/471 [00:41<09:27,  1.30s/it]  7%|▋         | 34/471 [00:42<09:27,  1.30s/it]  7%|▋         | 35/471 [00:43<09:27,  1.30s/it]  8%|▊         | 36/471 [00:45<09:25,  1.30s/it]  8%|▊         | 37/471 [00:46<09:25,  1.30s/it]  8%|▊         | 38/471 [00:47<09:24,  1.30s/it]  8%|▊         | 39/471 [00:49<09:22,  1.30s/it]  8%|▊         | 40/471 [00:50<09:21,  1.30s/it]  9%|▊         | 41/471 [00:51<09:21,  1.30s/it]  9%|▉         | 42/471 [00:52<09:20,  1.31s/it]  9%|▉         | 43/471 [00:54<09:18,  1.31s/it]  9%|▉         | 44/471 [00:55<09:17,  1.31s/it] 10%|▉         | 45/471 [00:56<09:16,  1.31s/it] 10%|▉         | 46/471 [00:58<09:15,  1.31s/it] 10%|▉         | 47/471 [00:59<09:14,  1.31s/it] 10%|█         | 48/471 [01:00<09:13,  1.31s/it] 10%|█         | 49/471 [01:02<09:12,  1.31s/it] 11%|█         | 50/471 [01:03<09:11,  1.31s/it] 11%|█         | 51/471 [01:04<09:10,  1.31s/it] 11%|█         | 52/471 [01:06<09:09,  1.31s/it] 11%|█▏        | 53/471 [01:07<09:08,  1.31s/it] 11%|█▏        | 54/471 [01:08<09:07,  1.31s/it] 12%|█▏        | 55/471 [01:09<09:06,  1.31s/it] 12%|█▏        | 56/471 [01:11<09:06,  1.32s/it] 12%|█▏        | 57/471 [01:12<09:04,  1.31s/it] 12%|█▏        | 58/471 [01:13<09:03,  1.32s/it] 13%|█▎        | 59/471 [01:15<09:02,  1.32s/it] 13%|█▎        | 60/471 [01:16<09:00,  1.32s/it] 13%|█▎        | 61/471 [01:17<08:59,  1.32s/it] 13%|█▎        | 62/471 [01:19<08:58,  1.32s/it] 13%|█▎        | 63/471 [01:20<08:57,  1.32s/it] 14%|█▎        | 64/471 [01:21<08:56,  1.32s/it] 14%|█▍        | 65/471 [01:23<08:54,  1.32s/it] 14%|█▍        | 66/471 [01:24<08:53,  1.32s/it] 14%|█▍        | 67/471 [01:25<08:52,  1.32s/it] 14%|█▍        | 68/471 [01:27<08:50,  1.32s/it] 15%|█▍        | 69/471 [01:28<08:49,  1.32s/it] 15%|█▍        | 70/471 [01:29<08:49,  1.32s/it] 15%|█▌        | 71/471 [01:31<08:48,  1.32s/it] 15%|█▌        | 72/471 [01:32<08:47,  1.32s/it] 15%|█▌        | 73/471 [01:33<08:46,  1.32s/it] 16%|█▌        | 74/471 [01:35<08:43,  1.32s/it] 16%|█▌        | 75/471 [01:36<08:43,  1.32s/it] 16%|█▌        | 76/471 [01:37<08:41,  1.32s/it] 16%|█▋        | 77/471 [01:39<08:41,  1.32s/it] 17%|█▋        | 78/471 [01:40<08:39,  1.32s/it] 17%|█▋        | 79/471 [01:41<08:38,  1.32s/it] 17%|█▋        | 80/471 [01:42<08:37,  1.32s/it] 17%|█▋        | 81/471 [01:44<08:35,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:33,  1.32s/it] 18%|█▊        | 83/471 [01:46<08:32,  1.32s/it] 18%|█▊        | 84/471 [01:48<08:31,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:30,  1.32s/it] 18%|█▊        | 86/471 [01:50<08:29,  1.32s/it] 18%|█▊        | 87/471 [01:52<08:27,  1.32s/it] 19%|█▊        | 88/471 [01:53<08:25,  1.32s/it] 19%|█▉        | 89/471 [01:54<08:24,  1.32s/it] 19%|█▉        | 90/471 [01:56<08:23,  1.32s/it] 19%|█▉        | 91/471 [01:57<08:22,  1.32s/it] 20%|█▉        | 92/471 [01:58<08:20,  1.32s/it] 20%|█▉        | 93/471 [02:00<08:19,  1.32s/it] 20%|█▉        | 94/471 [02:01<08:18,  1.32s/it] 20%|██        | 95/471 [02:02<08:17,  1.32s/it] 20%|██        | 96/471 [02:04<08:15,  1.32s/it] 21%|██        | 97/471 [02:05<08:14,  1.32s/it] 21%|██        | 98/471 [02:06<08:12,  1.32s/it] 21%|██        | 99/471 [02:08<08:11,  1.32s/it] 21%|██        | 100/471 [02:09<08:10,  1.32s/it] 21%|██▏       | 101/471 [02:10<08:09,  1.32s/it] 22%|██▏       | 102/471 [02:12<08:08,  1.32s/it] 22%|██▏       | 103/471 [02:13<08:07,  1.33s/it] 22%|██▏       | 104/471 [02:14<08:06,  1.33s/it] 22%|██▏       | 105/471 [02:16<08:06,  1.33s/it] 23%|██▎       | 106/471 [02:17<08:03,  1.33s/it] 23%|██▎       | 107/471 [02:18<08:02,  1.33s/it] 23%|██▎       | 108/471 [02:20<08:00,  1.32s/it] 23%|██▎       | 109/471 [02:21<07:58,  1.32s/it] 23%|██▎       | 110/471 [02:22<07:56,  1.32s/it] 24%|██▎       | 111/471 [02:23<07:56,  1.32s/it] 24%|██▍       | 112/471 [02:25<07:54,  1.32s/it] 24%|██▍       | 113/471 [02:26<07:53,  1.32s/it] 24%|██▍       | 114/471 [02:27<07:52,  1.32s/it] 24%|██▍       | 115/471 [02:29<07:51,  1.33s/it] 25%|██▍       | 116/471 [02:30<07:50,  1.33s/it] 25%|██▍       | 117/471 [02:31<07:49,  1.33s/it] 25%|██▌       | 118/471 [02:33<07:48,  1.33s/it] 25%|██▌       | 119/471 [02:34<07:46,  1.33s/it] 25%|██▌       | 120/471 [02:35<07:45,  1.33s/it] 26%|██▌       | 121/471 [02:37<07:44,  1.33s/it] 26%|██▌       | 122/471 [02:38<07:42,  1.33s/it] 26%|██▌       | 123/471 [02:39<07:41,  1.33s/it] 26%|██▋       | 124/471 [02:41<07:40,  1.33s/it] 27%|██▋       | 125/471 [02:42<07:39,  1.33s/it] 27%|██▋       | 126/471 [02:43<07:38,  1.33s/it] 27%|██▋       | 127/471 [02:45<07:37,  1.33s/it] 27%|██▋       | 128/471 [02:46<07:35,  1.33s/it] 27%|██▋       | 129/471 [02:47<07:34,  1.33s/it] 28%|██▊       | 130/471 [02:49<07:32,  1.33s/it] 28%|██▊       | 131/471 [02:50<07:31,  1.33s/it] 28%|██▊       | 132/471 [02:51<07:30,  1.33s/it] 28%|██▊       | 133/471 [02:53<07:29,  1.33s/it] 28%|██▊       | 134/471 [02:54<07:28,  1.33s/it] 29%|██▊       | 135/471 [02:55<07:27,  1.33s/it] 29%|██▉       | 136/471 [02:57<07:25,  1.33s/it] 29%|██▉       | 137/471 [02:58<07:24,  1.33s/it] 29%|██▉       | 138/471 [02:59<07:23,  1.33s/it] 30%|██▉       | 139/471 [03:01<07:22,  1.33s/it] 30%|██▉       | 140/471 [03:02<07:20,  1.33s/it] 30%|██▉       | 141/471 [03:03<07:19,  1.33s/it] 30%|███       | 142/471 [03:05<07:18,  1.33s/it] 30%|███       | 143/471 [03:06<07:16,  1.33s/it] 31%|███       | 144/471 [03:07<07:15,  1.33s/it] 31%|███       | 145/471 [03:09<07:13,  1.33s/it] 31%|███       | 146/471 [03:10<07:12,  1.33s/it] 31%|███       | 147/471 [03:11<07:11,  1.33s/it] 31%|███▏      | 148/471 [03:13<07:10,  1.33s/it] 32%|███▏      | 149/471 [03:14<07:10,  1.34s/it] 32%|███▏      | 150/471 [03:15<07:09,  1.34s/it] 32%|███▏      | 151/471 [03:17<07:07,  1.34s/it] 32%|███▏      | 152/471 [03:18<07:06,  1.34s/it] 32%|███▏      | 153/471 [03:19<07:05,  1.34s/it] 33%|███▎      | 154/471 [03:21<07:03,  1.34s/it] 33%|███▎      | 155/471 [03:22<07:02,  1.34s/it] 33%|███▎      | 156/471 [03:23<07:01,  1.34s/it] 33%|███▎      | 157/471 [03:25<06:59,  1.34s/it] 34%|███▎      | 158/471 [03:26<06:58,  1.34s/it] 34%|███▍      | 159/471 [03:27<06:57,  1.34s/it] 34%|███▍      | 160/471 [03:29<06:56,  1.34s/it] 34%|███▍      | 161/471 [03:30<06:55,  1.34s/it] 34%|███▍      | 162/471 [03:31<06:54,  1.34s/it] 35%|███▍      | 163/471 [03:33<06:53,  1.34s/it] 35%|███▍      | 164/471 [03:34<06:52,  1.34s/it] 35%|███▌      | 165/471 [03:35<06:50,  1.34s/it] 35%|███▌      | 166/471 [03:37<06:49,  1.34s/it] 35%|███▌      | 167/471 [03:38<06:48,  1.35s/it] 36%|███▌      | 168/471 [03:39<06:47,  1.34s/it] 36%|███▌      | 169/471 [03:41<06:46,  1.35s/it] 36%|███▌      | 170/471 [03:42<06:44,  1.35s/it] 36%|███▋      | 171/471 [03:44<06:43,  1.35s/it] 37%|███▋      | 172/471 [03:45<06:41,  1.34s/it] 37%|███▋      | 173/471 [03:46<06:40,  1.35s/it] 37%|███▋      | 174/471 [03:48<06:40,  1.35s/it] 37%|███▋      | 175/471 [03:49<06:39,  1.35s/it] 37%|███▋      | 176/471 [03:50<06:37,  1.35s/it] 38%|███▊      | 177/471 [03:52<06:36,  1.35s/it] 38%|███▊      | 178/471 [03:53<06:34,  1.35s/it] 38%|███▊      | 179/471 [03:54<06:33,  1.35s/it] 38%|███▊      | 180/471 [03:56<06:31,  1.35s/it] 38%|███▊      | 181/471 [03:57<06:30,  1.35s/it] 39%|███▊      | 182/471 [03:58<06:29,  1.35s/it] 39%|███▉      | 183/471 [04:00<06:28,  1.35s/it] 39%|███▉      | 184/471 [04:01<06:26,  1.35s/it] 39%|███▉      | 185/471 [04:02<06:25,  1.35s/it] 39%|███▉      | 186/471 [04:04<06:24,  1.35s/it] 40%|███▉      | 187/471 [04:05<06:23,  1.35s/it] 40%|███▉      | 188/471 [04:06<06:22,  1.35s/it] 40%|████      | 189/471 [04:08<06:20,  1.35s/it] 40%|████      | 190/471 [04:09<06:19,  1.35s/it] 41%|████      | 191/471 [04:11<06:18,  1.35s/it] 41%|████      | 192/471 [04:12<06:16,  1.35s/it] 41%|████      | 193/471 [04:13<06:14,  1.35s/it] 41%|████      | 194/471 [04:15<06:13,  1.35s/it] 41%|████▏     | 195/471 [04:16<06:12,  1.35s/it] 42%|████▏     | 196/471 [04:17<06:10,  1.35s/it] 42%|████▏     | 197/471 [04:19<06:08,  1.35s/it] 42%|████▏     | 198/471 [04:20<06:07,  1.35s/it] 42%|████▏     | 199/471 [04:21<06:06,  1.35s/it] 42%|████▏     | 200/471 [04:23<06:05,  1.35s/it] 43%|████▎     | 201/471 [04:24<06:02,  1.34s/it] 43%|████▎     | 202/471 [04:25<06:01,  1.34s/it] 43%|████▎     | 203/471 [04:27<06:00,  1.34s/it] 43%|████▎     | 204/471 [04:28<05:59,  1.34s/it] 44%|████▎     | 205/471 [04:29<05:57,  1.34s/it] 44%|████▎     | 206/471 [04:31<05:55,  1.34s/it] 44%|████▍     | 207/471 [04:32<05:54,  1.34s/it] 44%|████▍     | 208/471 [04:33<05:52,  1.34s/it] 44%|████▍     | 209/471 [04:35<05:51,  1.34s/it] 45%|████▍     | 210/471 [04:36<05:50,  1.34s/it] 45%|████▍     | 211/471 [04:37<05:49,  1.34s/it] 45%|████▌     | 212/471 [04:39<05:47,  1.34s/it] 45%|████▌     | 213/471 [04:40<05:47,  1.35s/it] 45%|████▌     | 214/471 [04:41<05:45,  1.34s/it] 46%|████▌     | 215/471 [04:43<05:44,  1.34s/it] 46%|████▌     | 216/471 [04:44<05:43,  1.35s/it] 46%|████▌     | 217/471 [04:45<05:41,  1.35s/it] 46%|████▋     | 218/471 [04:47<05:40,  1.35s/it] 46%|████▋     | 219/471 [04:48<05:39,  1.35s/it] 47%|████▋     | 220/471 [04:50<05:37,  1.35s/it] 47%|████▋     | 221/471 [04:51<05:36,  1.35s/it] 47%|████▋     | 222/471 [04:52<05:34,  1.34s/it] 47%|████▋     | 223/471 [04:54<05:33,  1.34s/it] 48%|████▊     | 224/471 [04:55<05:31,  1.34s/it] 48%|████▊     | 225/471 [04:56<05:30,  1.34s/it] 48%|████▊     | 226/471 [04:58<05:29,  1.34s/it] 48%|████▊     | 227/471 [04:59<05:27,  1.34s/it] 48%|████▊     | 228/471 [05:00<05:26,  1.34s/it] 49%|████▊     | 229/471 [05:02<05:25,  1.35s/it] 49%|████▉     | 230/471 [05:03<05:24,  1.35s/it] 49%|████▉     | 231/471 [05:04<05:22,  1.35s/it] 49%|████▉     | 232/471 [05:06<05:20,  1.34s/it] 49%|████▉     | 233/471 [05:07<05:19,  1.34s/it] 50%|████▉     | 234/471 [05:08<05:18,  1.34s/it] 50%|████▉     | 235/471 [05:10<05:17,  1.34s/it] 50%|█████     | 236/471 [05:11<05:15,  1.34s/it] 50%|█████     | 237/471 [05:12<05:14,  1.34s/it] 51%|█████     | 238/471 [05:14<05:12,  1.34s/it] 51%|█████     | 239/471 [05:15<05:11,  1.34s/it] 51%|█████     | 240/471 [05:16<05:10,  1.34s/it] 51%|█████     | 241/471 [05:18<05:08,  1.34s/it] 51%|█████▏    | 242/471 [05:19<05:07,  1.34s/it] 52%|█████▏    | 243/471 [05:20<05:06,  1.34s/it] 52%|█████▏    | 244/471 [05:22<05:04,  1.34s/it] 52%|█████▏    | 245/471 [05:23<05:03,  1.34s/it] 52%|█████▏    | 246/471 [05:24<05:01,  1.34s/it] 52%|█████▏    | 247/471 [05:26<05:00,  1.34s/it] 53%|█████▎    | 248/471 [05:27<04:59,  1.34s/it] 53%|█████▎    | 249/471 [05:28<04:58,  1.34s/it] 53%|█████▎    | 250/471 [05:30<04:56,  1.34s/it] 53%|█████▎    | 251/471 [05:31<04:55,  1.34s/it] 54%|█████▎    | 252/471 [05:32<04:53,  1.34s/it] 54%|█████▎    | 253/471 [05:34<04:52,  1.34s/it] 54%|█████▍    | 254/471 [05:35<04:51,  1.34s/it] 54%|█████▍    | 255/471 [05:37<04:49,  1.34s/it] 54%|█████▍    | 256/471 [05:38<04:48,  1.34s/it] 55%|█████▍    | 257/471 [05:39<04:47,  1.34s/it] 55%|█████▍    | 258/471 [05:41<04:46,  1.34s/it] 55%|█████▍    | 259/471 [05:42<04:44,  1.34s/it] 55%|█████▌    | 260/471 [05:43<04:43,  1.34s/it] 55%|█████▌    | 261/471 [05:45<04:41,  1.34s/it] 56%|█████▌    | 262/471 [05:46<04:40,  1.34s/it] 56%|█████▌    | 263/471 [05:47<04:39,  1.34s/it] 56%|█████▌    | 264/471 [05:49<04:37,  1.34s/it] 56%|█████▋    | 265/471 [05:50<04:36,  1.34s/it] 56%|█████▋    | 266/471 [05:51<04:35,  1.34s/it] 57%|█████▋    | 267/471 [05:53<04:33,  1.34s/it] 57%|█████▋    | 268/471 [05:54<04:32,  1.34s/it] 57%|█████▋    | 269/471 [05:55<04:31,  1.34s/it] 57%|█████▋    | 270/471 [05:57<04:29,  1.34s/it] 58%|█████▊    | 271/471 [05:58<04:28,  1.34s/it] 58%|█████▊    | 272/471 [05:59<04:26,  1.34s/it] 58%|█████▊    | 273/471 [06:01<04:25,  1.34s/it] 58%|█████▊    | 274/471 [06:02<04:23,  1.34s/it] 58%|█████▊    | 275/471 [06:03<04:21,  1.34s/it] 59%|█████▊    | 276/471 [06:05<04:20,  1.34s/it] 59%|█████▉    | 277/471 [06:06<04:19,  1.34s/it] 59%|█████▉    | 278/471 [06:07<04:18,  1.34s/it] 59%|█████▉    | 279/471 [06:09<04:16,  1.34s/it] 59%|█████▉    | 280/471 [06:10<04:15,  1.34s/it] 60%|█████▉    | 281/471 [06:11<04:14,  1.34s/it] 60%|█████▉    | 282/471 [06:13<04:12,  1.34s/it] 60%|██████    | 283/471 [06:14<04:11,  1.34s/it] 60%|██████    | 284/471 [06:15<04:10,  1.34s/it] 61%|██████    | 285/471 [06:17<04:09,  1.34s/it] 61%|██████    | 286/471 [06:18<04:07,  1.34s/it] 61%|██████    | 287/471 [06:19<04:06,  1.34s/it] 61%|██████    | 288/471 [06:21<04:05,  1.34s/it] 61%|██████▏   | 289/471 [06:22<04:03,  1.34s/it] 62%|██████▏   | 290/471 [06:23<04:01,  1.34s/it] 62%|██████▏   | 291/471 [06:25<04:00,  1.34s/it] 62%|██████▏   | 292/471 [06:26<03:59,  1.34s/it] 62%|██████▏   | 293/471 [06:27<03:57,  1.33s/it] 62%|██████▏   | 294/471 [06:29<03:56,  1.33s/it] 63%|██████▎   | 295/471 [06:30<03:54,  1.33s/it] 63%|██████▎   | 296/471 [06:31<03:53,  1.33s/it] 63%|██████▎   | 297/471 [06:33<03:52,  1.33s/it] 63%|██████▎   | 298/471 [06:34<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:35<03:49,  1.34s/it] 64%|██████▎   | 300/471 [06:37<03:48,  1.34s/it] 64%|██████▍   | 301/471 [06:38<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:39<03:45,  1.34s/it] 64%|██████▍   | 303/471 [06:41<03:44,  1.34s/it] 65%|██████▍   | 304/471 [06:42<03:43,  1.34s/it] 65%|██████▍   | 305/471 [06:43<03:41,  1.34s/it] 65%|██████▍   | 306/471 [06:45<03:40,  1.34s/it] 65%|██████▌   | 307/471 [06:46<03:39,  1.34s/it] 65%|██████▌   | 308/471 [06:47<03:38,  1.34s/it] 66%|██████▌   | 309/471 [06:49<03:37,  1.34s/it] 66%|██████▌   | 310/471 [06:50<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:51<03:34,  1.34s/it] 66%|██████▌   | 312/471 [06:53<03:32,  1.34s/it] 66%|██████▋   | 313/471 [06:54<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:56<03:30,  1.34s/it] 67%|██████▋   | 315/471 [06:57<03:28,  1.34s/it] 67%|██████▋   | 316/471 [06:58<03:27,  1.34s/it] 67%|██████▋   | 317/471 [07:00<03:26,  1.34s/it] 68%|██████▊   | 318/471 [07:01<03:25,  1.34s/it] 68%|██████▊   | 319/471 [07:02<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:04<03:22,  1.34s/it] 68%|██████▊   | 321/471 [07:05<03:21,  1.34s/it] 68%|██████▊   | 322/471 [07:06<03:19,  1.34s/it] 69%|██████▊   | 323/471 [07:08<03:18,  1.34s/it] 69%|██████▉   | 324/471 [07:09<03:17,  1.34s/it] 69%|██████▉   | 325/471 [07:10<03:15,  1.34s/it] 69%|██████▉   | 326/471 [07:12<03:14,  1.34s/it] 69%|██████▉   | 327/471 [07:13<03:12,  1.34s/it] 70%|██████▉   | 328/471 [07:14<03:11,  1.34s/it] 70%|██████▉   | 329/471 [07:16<03:10,  1.34s/it] 70%|███████   | 330/471 [07:17<03:08,  1.34s/it] 70%|███████   | 331/471 [07:18<03:07,  1.34s/it] 70%|███████   | 332/471 [07:20<03:06,  1.34s/it] 71%|███████   | 333/471 [07:21<03:04,  1.34s/it] 71%|███████   | 334/471 [07:22<03:03,  1.34s/it] 71%|███████   | 335/471 [07:24<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:25<03:00,  1.34s/it] 72%|███████▏  | 337/471 [07:26<02:59,  1.34s/it] 72%|███████▏  | 338/471 [07:28<02:57,  1.34s/it] 72%|███████▏  | 339/471 [07:29<02:56,  1.34s/it] 72%|███████▏  | 340/471 [07:30<02:55,  1.34s/it] 72%|███████▏  | 341/471 [07:32<02:53,  1.34s/it] 73%|███████▎  | 342/471 [07:33<02:52,  1.34s/it] 73%|███████▎  | 343/471 [07:34<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:36<02:49,  1.34s/it] 73%|███████▎  | 345/471 [07:37<02:48,  1.34s/it] 73%|███████▎  | 346/471 [07:38<02:47,  1.34s/it] 74%|███████▎  | 347/471 [07:40<02:45,  1.33s/it] 74%|███████▍  | 348/471 [07:41<02:44,  1.34s/it] 74%|███████▍  | 349/471 [07:42<02:43,  1.34s/it] 74%|███████▍  | 350/471 [07:44<02:41,  1.34s/it] 75%|███████▍  | 351/471 [07:45<02:40,  1.34s/it] 75%|███████▍  | 352/471 [07:46<02:39,  1.34s/it] 75%|███████▍  | 353/471 [07:48<02:38,  1.34s/it] 75%|███████▌  | 354/471 [07:49<02:36,  1.34s/it] 75%|███████▌  | 355/471 [07:50<02:35,  1.34s/it] 76%|███████▌  | 356/471 [07:52<02:34,  1.34s/it] 76%|███████▌  | 357/471 [07:53<02:32,  1.34s/it] 76%|███████▌  | 358/471 [07:54<02:31,  1.34s/it] 76%|███████▌  | 359/471 [07:56<02:29,  1.34s/it] 76%|███████▋  | 360/471 [07:57<02:28,  1.34s/it] 77%|███████▋  | 361/471 [07:58<02:27,  1.34s/it] 77%|███████▋  | 362/471 [08:00<02:25,  1.34s/it] 77%|███████▋  | 363/471 [08:01<02:24,  1.34s/it] 77%|███████▋  | 364/471 [08:02<02:23,  1.34s/it] 77%|███████▋  | 365/471 [08:04<02:22,  1.34s/it] 78%|███████▊  | 366/471 [08:05<02:20,  1.34s/it] 78%|███████▊  | 367/471 [08:06<02:19,  1.34s/it] 78%|███████▊  | 368/471 [08:08<02:18,  1.34s/it] 78%|███████▊  | 369/471 [08:09<02:16,  1.34s/it] 79%|███████▊  | 370/471 [08:10<02:15,  1.34s/it] 79%|███████▉  | 371/471 [08:12<02:14,  1.34s/it] 79%|███████▉  | 372/471 [08:13<02:12,  1.34s/it] 79%|███████▉  | 373/471 [08:15<02:11,  1.34s/it] 79%|███████▉  | 374/471 [08:16<02:10,  1.34s/it] 80%|███████▉  | 375/471 [08:17<02:08,  1.34s/it] 80%|███████▉  | 376/471 [08:19<02:07,  1.34s/it] 80%|████████  | 377/471 [08:20<02:06,  1.34s/it] 80%|████████  | 378/471 [08:21<02:04,  1.34s/it] 80%|████████  | 379/471 [08:23<02:03,  1.34s/it] 81%|████████  | 380/471 [08:24<02:02,  1.34s/it] 81%|████████  | 381/471 [08:25<02:01,  1.35s/it] 81%|████████  | 382/471 [08:27<01:59,  1.35s/it] 81%|████████▏ | 383/471 [08:28<01:58,  1.35s/it] 82%|████████▏ | 384/471 [08:29<01:57,  1.35s/it] 82%|████████▏ | 385/471 [08:31<01:56,  1.35s/it] 82%|████████▏ | 386/471 [08:32<01:54,  1.35s/it] 82%|████████▏ | 387/471 [08:33<01:53,  1.35s/it] 82%|████████▏ | 388/471 [08:35<01:51,  1.35s/it] 83%|████████▎ | 389/471 [08:36<01:50,  1.35s/it] 83%|████████▎ | 390/471 [08:37<01:49,  1.35s/it] 83%|████████▎ | 391/471 [08:39<01:47,  1.35s/it] 83%|████████▎ | 392/471 [08:40<01:46,  1.35s/it] 83%|████████▎ | 393/471 [08:41<01:45,  1.35s/it] 84%|████████▎ | 394/471 [08:43<01:44,  1.35s/it] 84%|████████▍ | 395/471 [08:44<01:42,  1.35s/it] 84%|████████▍ | 396/471 [08:46<01:41,  1.35s/it] 84%|████████▍ | 397/471 [08:47<01:40,  1.35s/it] 85%|████████▍ | 398/471 [08:48<01:38,  1.35s/it] 85%|████████▍ | 399/471 [08:50<01:37,  1.36s/it] 85%|████████▍ | 400/471 [08:51<01:36,  1.36s/it] 85%|████████▌ | 401/471 [08:52<01:34,  1.35s/it] 85%|████████▌ | 402/471 [08:54<01:33,  1.35s/it] 86%|████████▌ | 403/471 [08:55<01:32,  1.35s/it] 86%|████████▌ | 404/471 [08:56<01:30,  1.35s/it] 86%|████████▌ | 405/471 [08:58<01:29,  1.35s/it] 86%|████████▌ | 406/471 [08:59<01:27,  1.35s/it] 86%|████████▋ | 407/471 [09:00<01:26,  1.35s/it] 87%|████████▋ | 408/471 [09:02<01:25,  1.35s/it] 87%|████████▋ | 409/471 [09:03<01:24,  1.36s/it] 87%|████████▋ | 410/471 [09:04<01:22,  1.35s/it] 87%|████████▋ | 411/471 [09:06<01:21,  1.35s/it] 87%|████████▋ | 412/471 [09:07<01:19,  1.35s/it] 88%|████████▊ | 413/471 [09:09<01:18,  1.35s/it] 88%|████████▊ | 414/471 [09:10<01:17,  1.35s/it] 88%|████████▊ | 415/471 [09:11<01:15,  1.35s/it] 88%|████████▊ | 416/471 [09:13<01:14,  1.36s/it] 89%|████████▊ | 417/471 [09:14<01:13,  1.35s/it] 89%|████████▊ | 418/471 [09:15<01:11,  1.35s/it] 89%|████████▉ | 419/471 [09:17<01:10,  1.35s/it] 89%|████████▉ | 420/471 [09:18<01:08,  1.35s/it] 89%|████████▉ | 421/471 [09:19<01:07,  1.35s/it] 90%|████████▉ | 422/471 [09:21<01:06,  1.35s/it] 90%|████████▉ | 423/471 [09:22<01:04,  1.35s/it] 90%|█████████ | 424/471 [09:23<01:03,  1.35s/it] 90%|█████████ | 425/471 [09:25<01:02,  1.35s/it] 90%|█████████ | 426/471 [09:26<01:00,  1.35s/it] 91%|█████████ | 427/471 [09:27<00:59,  1.35s/it] 91%|█████████ | 428/471 [09:29<00:58,  1.35s/it] 91%|█████████ | 429/471 [09:30<00:56,  1.35s/it] 91%|█████████▏| 430/471 [09:31<00:55,  1.35s/it] 92%|█████████▏| 431/471 [09:33<00:54,  1.35s/it] 92%|█████████▏| 432/471 [09:34<00:52,  1.35s/it] 92%|█████████▏| 433/471 [09:36<00:51,  1.35s/it] 92%|█████████▏| 434/471 [09:37<00:50,  1.35s/it] 92%|█████████▏| 435/471 [09:38<00:48,  1.35s/it] 93%|█████████▎| 436/471 [09:40<00:47,  1.35s/it] 93%|█████████▎| 437/471 [09:41<00:45,  1.35s/it] 93%|█████████▎| 438/471 [09:42<00:44,  1.35s/it] 93%|█████████▎| 439/471 [09:44<00:43,  1.35s/it] 93%|█████████▎| 440/471 [09:45<00:41,  1.35s/it] 94%|█████████▎| 441/471 [09:46<00:40,  1.35s/it] 94%|█████████▍| 442/471 [09:48<00:39,  1.35s/it] 94%|█████████▍| 443/471 [09:49<00:37,  1.35s/it] 94%|█████████▍| 444/471 [09:50<00:36,  1.35s/it] 94%|█████████▍| 445/471 [09:52<00:35,  1.35s/it] 95%|█████████▍| 446/471 [09:53<00:33,  1.35s/it] 95%|█████████▍| 447/471 [09:54<00:32,  1.35s/it] 95%|█████████▌| 448/471 [09:56<00:30,  1.35s/it] 95%|█████████▌| 449/471 [09:57<00:29,  1.35s/it] 96%|█████████▌| 450/471 [09:58<00:28,  1.35s/it] 96%|█████████▌| 451/471 [10:00<00:26,  1.35s/it] 96%|█████████▌| 452/471 [10:01<00:25,  1.35s/it] 96%|█████████▌| 453/471 [10:03<00:24,  1.35s/it] 96%|█████████▋| 454/471 [10:04<00:22,  1.35s/it] 97%|█████████▋| 455/471 [10:05<00:21,  1.35s/it] 97%|█████████▋| 456/471 [10:07<00:20,  1.35s/it] 97%|█████████▋| 457/471 [10:08<00:18,  1.35s/it] 97%|█████████▋| 458/471 [10:09<00:17,  1.35s/it] 97%|█████████▋| 459/471 [10:11<00:16,  1.34s/it] 98%|█████████▊| 460/471 [10:12<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:13<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:15<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:16<00:10,  1.35s/it] 99%|█████████▊| 464/471 [10:17<00:09,  1.35s/it] 99%|█████████▊| 465/471 [10:19<00:08,  1.34s/it] 99%|█████████▉| 466/471 [10:20<00:06,  1.35s/it] 99%|█████████▉| 467/471 [10:21<00:05,  1.35s/it] 99%|█████████▉| 468/471 [10:23<00:04,  1.35s/it]100%|█████████▉| 469/471 [10:24<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:25<00:01,  1.34s/it]100%|██████████| 471/471 [10:26<00:00,  1.23s/it]100%|██████████| 471/471 [10:26<00:00,  1.33s/it]
{'eval_loss': 3.9306702613830566, 'eval_model_preparation_time': 0.0124, 'eval_acc': 0.24707912904938928, 'eval_runtime': 628.0816, 'eval_samples_per_second': 11.992, 'eval_steps_per_second': 0.75}
ROUND:10
CLIENT:26
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:21,  2.08s/it]                                              {'loss': 4.1907, 'grad_norm': 11.775246620178223, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:21,  2.08s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 2.2402, 'grad_norm': 9.44127082824707, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.9267, 'grad_norm': 10.576902389526367, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 1.7082, 'grad_norm': 14.161078453063965, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it]                                              {'loss': 2.3103, 'grad_norm': 15.914417266845703, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.2415, 'grad_norm': 18.45977210998535, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 3.3036, 'grad_norm': 30.459136962890625, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 2.665, 'grad_norm': 54.897186279296875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 2.168, 'grad_norm': 13.360371589660645, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 1.9529, 'grad_norm': 16.4926815032959, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 1.5286, 'grad_norm': 10.267556190490723, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.6765, 'grad_norm': 3.5504887104034424, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 1.4729, 'grad_norm': 7.670321464538574, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 1.0455, 'grad_norm': 11.489645004272461, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 1.5966, 'grad_norm': 7.794402599334717, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.58s/it]                                               {'loss': 1.154, 'grad_norm': 13.113417625427246, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.6006, 'grad_norm': 4.4191741943359375, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.4938, 'grad_norm': 4.733318328857422, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.3272, 'grad_norm': 6.423335075378418, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 1.2784, 'grad_norm': 9.013619422912598, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.4727, 'grad_norm': 4.701013565063477, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 1.6624, 'grad_norm': 8.191174507141113, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.5864, 'grad_norm': 4.722138404846191, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0205, 'grad_norm': 0.9421802759170532, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it]                                               {'loss': 0.1388, 'grad_norm': 2.9759042263031006, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it]                                               {'loss': 0.5445, 'grad_norm': 7.231618404388428, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.8032, 'grad_norm': 10.62405014038086, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.3877, 'grad_norm': 3.3349852561950684, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.6121, 'grad_norm': 2.6211490631103516, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.268, 'grad_norm': 2.187347888946533, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it]                                               {'loss': 0.5732, 'grad_norm': 12.873764991760254, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0068, 'grad_norm': 0.4320661425590515, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.2698, 'grad_norm': 3.284755229949951, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.0726, 'grad_norm': 1.1376901865005493, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.2236, 'grad_norm': 2.77018141746521, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.2655, 'grad_norm': 3.010347843170166, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0844, 'grad_norm': 0.9114417433738708, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.1575, 'grad_norm': 3.991936683654785, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.1534, 'grad_norm': 2.165921449661255, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.3411, 'grad_norm': 11.337602615356445, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.7215, 'train_samples_per_second': 7.087, 'train_steps_per_second': 0.502, 'train_loss': 1.0631324001355096, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 4.7144, 'grad_norm': 12.08520793914795, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 3.0674, 'grad_norm': 9.755857467651367, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 2.6614, 'grad_norm': 7.646970272064209, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.0383, 'grad_norm': 15.838981628417969, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 2.1228, 'grad_norm': 11.998838424682617, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 2.1176, 'grad_norm': 14.73855972290039, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.328, 'grad_norm': 10.7415132522583, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 1.6417, 'grad_norm': 65.83625030517578, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 0.8822, 'grad_norm': 6.399133682250977, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 0.8045, 'grad_norm': 7.109166622161865, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.5705, 'grad_norm': 4.831491947174072, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.4335, 'grad_norm': 4.526567459106445, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 1.1121, 'grad_norm': 7.528692722320557, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.2335, 'grad_norm': 6.855532646179199, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.1178, 'grad_norm': 10.110026359558105, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.6226, 'grad_norm': 17.056718826293945, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.2246, 'grad_norm': 2.050614356994629, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.8548, 'grad_norm': 9.126749992370605, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.258, 'grad_norm': 3.8610432147979736, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.1863, 'grad_norm': 1.7045797109603882, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.3746, 'grad_norm': 4.27449893951416, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 0.3233, 'grad_norm': 4.540627956390381, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.3705, 'grad_norm': 3.695159912109375, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0986, 'grad_norm': 3.8323380947113037, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it]                                               {'loss': 0.0585, 'grad_norm': 1.8082276582717896, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.1998, 'grad_norm': 38.40128707885742, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it]                                               {'loss': 0.187, 'grad_norm': 2.2906932830810547, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.1084, 'grad_norm': 1.9841358661651611, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.1085, 'grad_norm': 1.3557252883911133, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.09, 'grad_norm': 1.2013407945632935, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.1841, 'grad_norm': 2.4046576023101807, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.01, 'grad_norm': 0.38778001070022583, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0625, 'grad_norm': 0.9694216251373291, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0707, 'grad_norm': 1.3298393487930298, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.0458, 'grad_norm': 0.8453176021575928, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.13s/it]                                               {'loss': 0.0256, 'grad_norm': 0.808783233165741, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.13s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.18s/it]                                               {'loss': 0.1405, 'grad_norm': 3.0125551223754883, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.18s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.2239, 'grad_norm': 5.330729961395264, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.109, 'grad_norm': 1.80111825466156, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0376, 'grad_norm': 2.0063066482543945, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.7896, 'train_samples_per_second': 7.081, 'train_steps_per_second': 0.501, 'train_loss': 0.7955272808670998, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 3.4318, 'grad_norm': 7.6119890213012695, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 3.1774, 'grad_norm': 8.795539855957031, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.19s/it]                                              {'loss': 2.8248, 'grad_norm': 13.279231071472168, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.19s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 1.6024, 'grad_norm': 12.743237495422363, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it]                                              {'loss': 4.0472, 'grad_norm': 22.79263687133789, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it]                                              {'loss': 2.8429, 'grad_norm': 18.799278259277344, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it]                                              {'loss': 1.9586, 'grad_norm': 24.163578033447266, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 6.7542, 'grad_norm': 107.53380584716797, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 0.9971, 'grad_norm': 10.265426635742188, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 1.3222, 'grad_norm': 8.602787971496582, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.9083, 'grad_norm': 11.947518348693848, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 1.4699, 'grad_norm': 8.700677871704102, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 1.0134, 'grad_norm': 7.046513557434082, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it]                                               {'loss': 1.2909, 'grad_norm': 8.336402893066406, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.22s/it]                                               {'loss': 1.177, 'grad_norm': 10.069025993347168, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.22s/it] 40%|████      | 16/40 [00:31<00:38,  1.61s/it]                                               {'loss': 0.0463, 'grad_norm': 2.3196310997009277, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.61s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.82s/it]                                               {'loss': 0.4612, 'grad_norm': 3.93176007270813, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.82s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.201, 'grad_norm': 4.765826225280762, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.2613, 'grad_norm': 3.5102474689483643, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:42,  2.10s/it]                                               {'loss': 0.1459, 'grad_norm': 2.017214059829712, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.16s/it]                                               {'loss': 0.6417, 'grad_norm': 7.8000898361206055, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.16s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it]                                               {'loss': 0.3163, 'grad_norm': 2.408450126647949, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.6466, 'grad_norm': 4.115274429321289, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0467, 'grad_norm': 2.532212257385254, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it]                                               {'loss': 0.168, 'grad_norm': 2.979192018508911, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it]                                               {'loss': 0.2697, 'grad_norm': 1.4271098375320435, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.7479, 'grad_norm': 1.3690133094787598, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.0656, 'grad_norm': 1.3190093040466309, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.16s/it]                                               {'loss': 0.1469, 'grad_norm': 2.95357346534729, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it]                                               {'loss': 0.0979, 'grad_norm': 1.6942652463912964, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it]                                               {'loss': 0.0988, 'grad_norm': 1.714250922203064, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it] 80%|████████  | 32/40 [01:03<00:12,  1.62s/it]                                               {'loss': 0.5472, 'grad_norm': 25.85394859313965, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.62s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it]                                               {'loss': 0.4028, 'grad_norm': 2.024686813354492, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it]                                               {'loss': 0.0139, 'grad_norm': 0.5234175324440002, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it]                                               {'loss': 0.2731, 'grad_norm': 8.106614112854004, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.2221, 'grad_norm': 7.228908061981201, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it]                                               {'loss': 0.0491, 'grad_norm': 0.8942920565605164, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.1045, 'grad_norm': 0.6211760640144348, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.1725, 'grad_norm': 1.0560859441757202, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0272, 'grad_norm': 1.5288609266281128, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 80.2542, 'train_samples_per_second': 7.04, 'train_steps_per_second': 0.498, 'train_loss': 1.049815166601911, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:86
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 4.2232, 'grad_norm': 5.533185005187988, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 4.1688, 'grad_norm': 10.128357887268066, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:21,  2.22s/it]                                              {'loss': 2.0687, 'grad_norm': 11.664005279541016, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.22s/it] 10%|█         | 4/40 [00:08<01:19,  2.22s/it]                                              {'loss': 3.0786, 'grad_norm': 14.841980934143066, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 1.7127, 'grad_norm': 13.061522483825684, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.54, 'grad_norm': 8.766949653625488, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 2.7858, 'grad_norm': 16.5037841796875, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 3.358, 'grad_norm': 100.75579833984375, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 1.425, 'grad_norm': 7.295944690704346, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 0.7456, 'grad_norm': 5.048178672790527, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.8129, 'grad_norm': 34.49081039428711, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.6381, 'grad_norm': 3.5019547939300537, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 1.0597, 'grad_norm': 5.951287269592285, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it]                                               {'loss': 1.1185, 'grad_norm': 14.664782524108887, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it]                                               {'loss': 1.083, 'grad_norm': 8.635096549987793, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.2987, 'grad_norm': 9.830699920654297, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it]                                               {'loss': 0.5112, 'grad_norm': 5.691249370574951, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.3106, 'grad_norm': 2.398080348968506, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 0.7101, 'grad_norm': 11.628597259521484, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:42,  2.10s/it]                                               {'loss': 0.3612, 'grad_norm': 4.774868965148926, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.16s/it]                                               {'loss': 0.572, 'grad_norm': 4.741827487945557, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.16s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 0.2947, 'grad_norm': 3.2530596256256104, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.3161, 'grad_norm': 3.9112045764923096, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.1216, 'grad_norm': 2.1475882530212402, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.1308, 'grad_norm': 1.098056674003601, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it]                                               {'loss': 0.2629, 'grad_norm': 3.5278377532958984, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it]                                               {'loss': 0.0404, 'grad_norm': 0.5844424962997437, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.3379, 'grad_norm': 5.404474258422852, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.1245, 'grad_norm': 2.9443624019622803, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it]                                               {'loss': 0.2759, 'grad_norm': 3.6166913509368896, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.1705, 'grad_norm': 2.3736255168914795, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.3934, 'grad_norm': 8.012445449829102, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.1031, 'grad_norm': 0.9050018787384033, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it]                                               {'loss': 0.124, 'grad_norm': 1.2378861904144287, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.257, 'grad_norm': 4.037891387939453, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.0573, 'grad_norm': 1.412566900253296, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it]                                               {'loss': 0.1285, 'grad_norm': 2.929722547531128, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.18s/it]                                               {'loss': 0.0437, 'grad_norm': 0.9154665470123291, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]                                               {'loss': 0.0712, 'grad_norm': 1.564969778060913, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0051, 'grad_norm': 0.35522180795669556, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.9878, 'train_samples_per_second': 7.064, 'train_steps_per_second': 0.5, 'train_loss': 0.8960299984784796, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
CLIENT:76
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 3.8357, 'grad_norm': 7.695571422576904, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 2.6732, 'grad_norm': 12.134604454040527, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 2.2263, 'grad_norm': 9.30482006072998, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.7748, 'grad_norm': 18.101051330566406, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.4499, 'grad_norm': 12.989039421081543, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.0926, 'grad_norm': 13.266060829162598, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.6754, 'grad_norm': 9.997135162353516, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.3069, 'grad_norm': 13.505941390991211, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.02, 'grad_norm': 9.036635398864746, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.8621, 'grad_norm': 7.28192663192749, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.638, 'grad_norm': 4.082586765289307, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.6255, 'grad_norm': 5.348104953765869, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.4326, 'grad_norm': 3.2093029022216797, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.741, 'grad_norm': 5.659047603607178, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.5743, 'grad_norm': 5.558732032775879, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0111, 'grad_norm': 0.7457326650619507, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.2046, 'grad_norm': 2.372967481613159, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.2327, 'grad_norm': 2.597618818283081, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.2196, 'grad_norm': 2.9088168144226074, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.2744, 'grad_norm': 3.3544254302978516, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.1475, 'grad_norm': 1.8429073095321655, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.2911, 'grad_norm': 4.244494915008545, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.1997, 'grad_norm': 3.9080257415771484, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.111, 'grad_norm': 6.1274309158325195, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.2358, 'grad_norm': 5.718784332275391, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.0776, 'grad_norm': 1.0938047170639038, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.0973, 'grad_norm': 2.461179494857788, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.0528, 'grad_norm': 1.0833696126937866, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.129, 'grad_norm': 4.081858158111572, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0981, 'grad_norm': 1.3523344993591309, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0833, 'grad_norm': 1.616382360458374, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.1558, 'grad_norm': 5.583082675933838, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0233, 'grad_norm': 0.4868152439594269, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.034, 'grad_norm': 0.42723241448402405, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0497, 'grad_norm': 0.8402972221374512, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.0412, 'grad_norm': 0.6315851211547852, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0262, 'grad_norm': 0.600661039352417, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1058, 'grad_norm': 0.7751641869544983, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0212, 'grad_norm': 0.33732128143310547, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0118, 'grad_norm': 1.017350435256958, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2532, 'train_samples_per_second': 7.129, 'train_steps_per_second': 0.505, 'train_loss': 0.6215730709489435, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 3.21, 'grad_norm': 6.5192790031433105, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 3.1443, 'grad_norm': 7.919781684875488, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.6366, 'grad_norm': 8.675027847290039, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.7629, 'grad_norm': 9.835598945617676, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 2.6281, 'grad_norm': 14.389102935791016, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.4136, 'grad_norm': 6.2093915939331055, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.639, 'grad_norm': 14.752914428710938, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.1952, 'grad_norm': 5.718125820159912, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.6798, 'grad_norm': 14.740588188171387, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.0642, 'grad_norm': 8.5111083984375, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.682, 'grad_norm': 27.23621940612793, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:56,  2.04s/it]                                               {'loss': 2.0041, 'grad_norm': 16.801488876342773, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.1395, 'grad_norm': 13.4834566116333, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.3583, 'grad_norm': 60.23025131225586, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.7054, 'grad_norm': 11.409262657165527, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 4.0904, 'grad_norm': 38.205135345458984, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.7964, 'grad_norm': 7.440865516662598, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.7026, 'grad_norm': 6.984756946563721, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.5302, 'grad_norm': 5.84130334854126, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.9231, 'grad_norm': 4.299790859222412, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.5494, 'grad_norm': 4.597537994384766, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.5367, 'grad_norm': 3.3804712295532227, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.515, 'grad_norm': 3.94459867477417, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0093, 'grad_norm': 0.44283291697502136, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.3887, 'grad_norm': 3.50191068649292, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.4899, 'grad_norm': 2.4375033378601074, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.0931, 'grad_norm': 1.4259108304977417, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:25,  2.08s/it]                                               {'loss': 0.0964, 'grad_norm': 1.7050927877426147, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.3293, 'grad_norm': 1.7785035371780396, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.2581, 'grad_norm': 1.8098057508468628, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.7557, 'grad_norm': 8.415727615356445, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 1.6709, 'grad_norm': 35.85023880004883, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0539, 'grad_norm': 0.7670716047286987, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.1324, 'grad_norm': 2.1840498447418213, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1137, 'grad_norm': 1.1847714185714722, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.6274, 'grad_norm': 1.2209702730178833, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.1209, 'grad_norm': 0.7880547642707825, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.2568, 'grad_norm': 5.368390083312988, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.058, 'grad_norm': 1.1892427206039429, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0215, 'grad_norm': 0.8003237843513489, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.9646, 'train_samples_per_second': 7.155, 'train_steps_per_second': 0.507, 'train_loss': 1.1595758020877838, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.4905, 'grad_norm': 6.890817642211914, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.8393, 'grad_norm': 5.723842144012451, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 4.4869, 'grad_norm': 13.599420547485352, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 3.0586, 'grad_norm': 10.7542085647583, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.2513, 'grad_norm': 12.746488571166992, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 2.5849, 'grad_norm': 13.293869018554688, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.6023, 'grad_norm': 11.841647148132324, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 4.7788, 'grad_norm': 50.04269027709961, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it]                                              {'loss': 1.8087, 'grad_norm': 14.286057472229004, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 2.184, 'grad_norm': 14.747249603271484, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.2136, 'grad_norm': 8.716493606567383, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.4645, 'grad_norm': 11.953207969665527, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 1.7843, 'grad_norm': 10.895336151123047, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.597, 'grad_norm': 8.448851585388184, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.6772, 'grad_norm': 6.5209856033325195, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.1544, 'grad_norm': 5.295679092407227, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.8797, 'grad_norm': 7.619442462921143, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.384, 'grad_norm': 2.9997730255126953, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.598, 'grad_norm': 3.7307779788970947, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.4648, 'grad_norm': 3.9415853023529053, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.6683, 'grad_norm': 7.943493843078613, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.8668, 'grad_norm': 4.794866561889648, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.5225, 'grad_norm': 5.307825088500977, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 1.1554, 'grad_norm': 65.38134765625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.1331, 'grad_norm': 2.2014832496643066, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.6926, 'grad_norm': 2.898560047149658, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.4017, 'grad_norm': 7.96398401260376, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.073, 'grad_norm': 1.1234076023101807, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.3928, 'grad_norm': 10.067296981811523, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.3814, 'grad_norm': 2.619965076446533, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1786, 'grad_norm': 2.4341163635253906, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.1657, 'grad_norm': 7.722577095031738, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.2225, 'grad_norm': 4.848052978515625, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.93s/it]                                               {'loss': 0.1814, 'grad_norm': 4.54934549331665, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.2295, 'grad_norm': 4.309553146362305, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.5203, 'grad_norm': 9.046536445617676, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.4144, 'grad_norm': 6.785830974578857, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.2579, 'grad_norm': 2.8847556114196777, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.3152, 'grad_norm': 5.856466293334961, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.1071, 'grad_norm': 6.21000862121582, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.6961, 'train_samples_per_second': 7.18, 'train_steps_per_second': 0.508, 'train_loss': 1.204578791372478, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:48
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]                                              {'loss': 5.282, 'grad_norm': 8.17894172668457, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.0803, 'grad_norm': 7.318484783172607, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.9585, 'grad_norm': 10.623706817626953, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 3.6374, 'grad_norm': 14.995528221130371, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 2.0654, 'grad_norm': 9.67050838470459, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 3.3244, 'grad_norm': 12.219440460205078, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it]                                              {'loss': 2.1697, 'grad_norm': 11.564590454101562, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.56s/it]                                              {'loss': 3.2709, 'grad_norm': 79.0972900390625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 0.6065, 'grad_norm': 5.286433696746826, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 0.5478, 'grad_norm': 5.637032508850098, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.7801, 'grad_norm': 4.977321624755859, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.929, 'grad_norm': 5.164117336273193, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.0413, 'grad_norm': 6.370150566101074, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.1485, 'grad_norm': 5.609539031982422, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.6897, 'grad_norm': 4.537851333618164, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 7.0647, 'grad_norm': 69.70150756835938, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.2129, 'grad_norm': 2.396085500717163, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.4686, 'grad_norm': 3.120603322982788, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.3362, 'grad_norm': 2.389620065689087, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.1674, 'grad_norm': 2.065370798110962, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.2126, 'grad_norm': 3.3329882621765137, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.7893, 'grad_norm': 3.086292028427124, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.2559, 'grad_norm': 1.6006327867507935, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.3524, 'grad_norm': 13.750307083129883, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.1874, 'grad_norm': 2.0363004207611084, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.1704, 'grad_norm': 0.9732434153556824, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.1483, 'grad_norm': 3.1341230869293213, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.0912, 'grad_norm': 2.7934534549713135, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.1093, 'grad_norm': 1.3278805017471313, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.0747, 'grad_norm': 1.8670573234558105, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.3578, 'grad_norm': 1.6987175941467285, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.1383, 'grad_norm': 7.630370140075684, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.2685, 'grad_norm': 3.5052695274353027, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.0265, 'grad_norm': 0.3760761618614197, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it]                                               {'loss': 0.0675, 'grad_norm': 1.1301155090332031, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.0818, 'grad_norm': 1.8096619844436646, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.3008, 'grad_norm': 2.3597586154937744, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.2418, 'grad_norm': 1.876523494720459, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0518, 'grad_norm': 1.089302659034729, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.348, 'grad_norm': 19.288354873657227, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.6013, 'train_samples_per_second': 7.098, 'train_steps_per_second': 0.503, 'train_loss': 1.0513908836990595, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.22s/it]                                              {'loss': 4.145, 'grad_norm': 9.59720230102539, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.22s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 3.9739, 'grad_norm': 10.325895309448242, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.1904, 'grad_norm': 9.595457077026367, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.8151, 'grad_norm': 15.464133262634277, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 1.7016, 'grad_norm': 11.112133026123047, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 3.2606, 'grad_norm': 21.43416976928711, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.5103, 'grad_norm': 10.006263732910156, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 3.8556, 'grad_norm': 70.17172241210938, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.5272, 'grad_norm': 10.774679183959961, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.6098, 'grad_norm': 6.473506450653076, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 0.3939, 'grad_norm': 3.135371208190918, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.1202, 'grad_norm': 6.227105617523193, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.4985, 'grad_norm': 4.998691082000732, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.1629, 'grad_norm': 19.718067169189453, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 0.52, 'grad_norm': 5.572921276092529, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0012, 'grad_norm': 0.09670604020357132, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.3895, 'grad_norm': 4.307367324829102, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.1288, 'grad_norm': 1.9532127380371094, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.3413, 'grad_norm': 5.376235485076904, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.9173, 'grad_norm': 9.385478019714355, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.3489, 'grad_norm': 15.625879287719727, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.2724, 'grad_norm': 3.591326951980591, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.6585, 'grad_norm': 14.478644371032715, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.4616, 'grad_norm': 34.98048400878906, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.3171, 'grad_norm': 4.282694339752197, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.7616, 'grad_norm': 6.005032062530518, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.1108, 'grad_norm': 3.0084140300750732, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1931, 'grad_norm': 3.365809440612793, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.3165, 'grad_norm': 1.9502792358398438, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.2194, 'grad_norm': 4.774015426635742, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1065, 'grad_norm': 2.7162282466888428, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0559, 'grad_norm': 1.0212968587875366, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.2231, 'grad_norm': 9.423056602478027, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0827, 'grad_norm': 2.118170738220215, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.142, 'grad_norm': 2.885899543762207, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.0606, 'grad_norm': 2.297956705093384, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0599, 'grad_norm': 0.7658647298812866, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.1072, 'grad_norm': 1.954914927482605, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.165, 'grad_norm': 3.9019858837127686, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0601, 'grad_norm': 1.5273429155349731, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 79.0207, 'train_samples_per_second': 7.15, 'train_steps_per_second': 0.506, 'train_loss': 0.8696444471454015, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:67
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 5.1232, 'grad_norm': 8.5028715133667, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 4.4704, 'grad_norm': 8.839330673217773, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 3.7513, 'grad_norm': 9.440486907958984, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 3.1461, 'grad_norm': 15.090047836303711, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.7894, 'grad_norm': 16.513385772705078, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 1.495, 'grad_norm': 9.821060180664062, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 2.3496, 'grad_norm': 13.01701545715332, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.0013, 'grad_norm': 0.05385840684175491, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 2.0086, 'grad_norm': 8.589065551757812, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.8227, 'grad_norm': 4.913669586181641, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 0.8376, 'grad_norm': 8.665746688842773, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.6, 'grad_norm': 5.660618305206299, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.8117, 'grad_norm': 5.307404041290283, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.704, 'grad_norm': 4.575521469116211, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 1.2694, 'grad_norm': 8.115234375, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0903, 'grad_norm': 5.2677836418151855, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.236, 'grad_norm': 3.2663941383361816, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.4522, 'grad_norm': 3.8301444053649902, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.3689, 'grad_norm': 3.297654151916504, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.3382, 'grad_norm': 2.298954963684082, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.2384, 'grad_norm': 3.4791338443756104, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.2508, 'grad_norm': 1.8615182638168335, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 1.0148, 'grad_norm': 9.349955558776855, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0021, 'grad_norm': 0.1171208843588829, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.0687, 'grad_norm': 1.1126443147659302, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.272, 'grad_norm': 5.506130695343018, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0768, 'grad_norm': 0.9535531997680664, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.2043, 'grad_norm': 3.833707094192505, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.1703, 'grad_norm': 3.1043686866760254, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.2712, 'grad_norm': 4.576528549194336, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.4576, 'grad_norm': 11.517749786376953, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.4132, 'grad_norm': 17.030282974243164, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0725, 'grad_norm': 2.3133914470672607, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0727, 'grad_norm': 1.7605034112930298, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1726, 'grad_norm': 4.280830383300781, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.0861, 'grad_norm': 1.75053870677948, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.1651, 'grad_norm': 1.730879306793213, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.119, 'grad_norm': 2.5347471237182617, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.4148, 'grad_norm': 1.2848764657974243, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0087, 'grad_norm': 0.4164496958255768, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 79.012, 'train_samples_per_second': 7.151, 'train_steps_per_second': 0.506, 'train_loss': 0.9054399523854955, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:58,  1.57it/s]  1%|          | 3/471 [00:02<07:01,  1.11it/s]  1%|          | 4/471 [00:03<08:07,  1.04s/it]  1%|          | 5/471 [00:05<08:44,  1.13s/it]  1%|▏         | 6/471 [00:06<09:06,  1.18s/it]  1%|▏         | 7/471 [00:07<09:22,  1.21s/it]  2%|▏         | 8/471 [00:08<09:31,  1.23s/it]  2%|▏         | 9/471 [00:10<09:37,  1.25s/it]  2%|▏         | 10/471 [00:11<09:41,  1.26s/it]  2%|▏         | 11/471 [00:12<09:43,  1.27s/it]  3%|▎         | 12/471 [00:14<09:45,  1.28s/it]  3%|▎         | 13/471 [00:15<09:47,  1.28s/it]  3%|▎         | 14/471 [00:16<09:46,  1.28s/it]  3%|▎         | 15/471 [00:17<09:46,  1.29s/it]  3%|▎         | 16/471 [00:19<09:47,  1.29s/it]  4%|▎         | 17/471 [00:20<09:46,  1.29s/it]  4%|▍         | 18/471 [00:21<09:46,  1.29s/it]  4%|▍         | 19/471 [00:23<09:45,  1.30s/it]  4%|▍         | 20/471 [00:24<09:45,  1.30s/it]  4%|▍         | 21/471 [00:25<09:44,  1.30s/it]  5%|▍         | 22/471 [00:27<09:44,  1.30s/it]  5%|▍         | 23/471 [00:28<09:43,  1.30s/it]  5%|▌         | 24/471 [00:29<09:41,  1.30s/it]  5%|▌         | 25/471 [00:30<09:40,  1.30s/it]  6%|▌         | 26/471 [00:32<09:40,  1.30s/it]  6%|▌         | 27/471 [00:33<09:38,  1.30s/it]  6%|▌         | 28/471 [00:34<09:37,  1.30s/it]  6%|▌         | 29/471 [00:36<09:36,  1.30s/it]  6%|▋         | 30/471 [00:37<09:36,  1.31s/it]  7%|▋         | 31/471 [00:38<09:34,  1.31s/it]  7%|▋         | 32/471 [00:40<09:32,  1.31s/it]  7%|▋         | 33/471 [00:41<09:30,  1.30s/it]  7%|▋         | 34/471 [00:42<09:29,  1.30s/it]  7%|▋         | 35/471 [00:44<09:29,  1.31s/it]  8%|▊         | 36/471 [00:45<09:28,  1.31s/it]  8%|▊         | 37/471 [00:46<09:27,  1.31s/it]  8%|▊         | 38/471 [00:47<09:26,  1.31s/it]  8%|▊         | 39/471 [00:49<09:25,  1.31s/it]  8%|▊         | 40/471 [00:50<09:23,  1.31s/it]  9%|▊         | 41/471 [00:51<09:23,  1.31s/it]  9%|▉         | 42/471 [00:53<09:22,  1.31s/it]  9%|▉         | 43/471 [00:54<09:20,  1.31s/it]  9%|▉         | 44/471 [00:55<09:19,  1.31s/it] 10%|▉         | 45/471 [00:57<09:18,  1.31s/it] 10%|▉         | 46/471 [00:58<09:17,  1.31s/it] 10%|▉         | 47/471 [00:59<09:15,  1.31s/it] 10%|█         | 48/471 [01:01<09:14,  1.31s/it] 10%|█         | 49/471 [01:02<09:14,  1.31s/it] 11%|█         | 50/471 [01:03<09:13,  1.31s/it] 11%|█         | 51/471 [01:05<09:12,  1.32s/it] 11%|█         | 52/471 [01:06<09:11,  1.32s/it] 11%|█▏        | 53/471 [01:07<09:10,  1.32s/it] 11%|█▏        | 54/471 [01:08<09:09,  1.32s/it] 12%|█▏        | 55/471 [01:10<09:08,  1.32s/it] 12%|█▏        | 56/471 [01:11<09:07,  1.32s/it] 12%|█▏        | 57/471 [01:12<09:06,  1.32s/it] 12%|█▏        | 58/471 [01:14<09:04,  1.32s/it] 13%|█▎        | 59/471 [01:15<09:03,  1.32s/it] 13%|█▎        | 60/471 [01:16<09:01,  1.32s/it] 13%|█▎        | 61/471 [01:18<09:00,  1.32s/it] 13%|█▎        | 62/471 [01:19<08:59,  1.32s/it] 13%|█▎        | 63/471 [01:20<08:57,  1.32s/it] 14%|█▎        | 64/471 [01:22<08:56,  1.32s/it] 14%|█▍        | 65/471 [01:23<08:55,  1.32s/it] 14%|█▍        | 66/471 [01:24<08:54,  1.32s/it] 14%|█▍        | 67/471 [01:26<08:53,  1.32s/it] 14%|█▍        | 68/471 [01:27<08:51,  1.32s/it] 15%|█▍        | 69/471 [01:28<08:49,  1.32s/it] 15%|█▍        | 70/471 [01:30<08:49,  1.32s/it] 15%|█▌        | 71/471 [01:31<08:48,  1.32s/it] 15%|█▌        | 72/471 [01:32<08:46,  1.32s/it] 15%|█▌        | 73/471 [01:34<08:45,  1.32s/it] 16%|█▌        | 74/471 [01:35<08:42,  1.32s/it] 16%|█▌        | 75/471 [01:36<08:41,  1.32s/it] 16%|█▌        | 76/471 [01:38<08:40,  1.32s/it] 16%|█▋        | 77/471 [01:39<08:39,  1.32s/it] 17%|█▋        | 78/471 [01:40<08:37,  1.32s/it] 17%|█▋        | 79/471 [01:41<08:36,  1.32s/it] 17%|█▋        | 80/471 [01:43<08:35,  1.32s/it] 17%|█▋        | 81/471 [01:44<08:33,  1.32s/it] 17%|█▋        | 82/471 [01:45<08:32,  1.32s/it] 18%|█▊        | 83/471 [01:47<08:31,  1.32s/it] 18%|█▊        | 84/471 [01:48<08:30,  1.32s/it] 18%|█▊        | 85/471 [01:49<08:29,  1.32s/it] 18%|█▊        | 86/471 [01:51<08:27,  1.32s/it] 18%|█▊        | 87/471 [01:52<08:26,  1.32s/it] 19%|█▊        | 88/471 [01:53<08:24,  1.32s/it] 19%|█▉        | 89/471 [01:55<08:23,  1.32s/it] 19%|█▉        | 90/471 [01:56<08:22,  1.32s/it] 19%|█▉        | 91/471 [01:57<08:21,  1.32s/it] 20%|█▉        | 92/471 [01:59<08:19,  1.32s/it] 20%|█▉        | 93/471 [02:00<08:19,  1.32s/it] 20%|█▉        | 94/471 [02:01<08:17,  1.32s/it] 20%|██        | 95/471 [02:03<08:16,  1.32s/it] 20%|██        | 96/471 [02:04<08:14,  1.32s/it] 21%|██        | 97/471 [02:05<08:14,  1.32s/it] 21%|██        | 98/471 [02:07<08:12,  1.32s/it] 21%|██        | 99/471 [02:08<08:11,  1.32s/it] 21%|██        | 100/471 [02:09<08:10,  1.32s/it] 21%|██▏       | 101/471 [02:10<08:09,  1.32s/it] 22%|██▏       | 102/471 [02:12<08:08,  1.32s/it] 22%|██▏       | 103/471 [02:13<08:07,  1.33s/it] 22%|██▏       | 104/471 [02:14<08:07,  1.33s/it] 22%|██▏       | 105/471 [02:16<08:05,  1.33s/it] 23%|██▎       | 106/471 [02:17<08:03,  1.33s/it] 23%|██▎       | 107/471 [02:18<08:02,  1.32s/it] 23%|██▎       | 108/471 [02:20<08:00,  1.32s/it] 23%|██▎       | 109/471 [02:21<07:59,  1.32s/it] 23%|██▎       | 110/471 [02:22<07:56,  1.32s/it] 24%|██▎       | 111/471 [02:24<07:56,  1.32s/it] 24%|██▍       | 112/471 [02:25<07:55,  1.32s/it] 24%|██▍       | 113/471 [02:26<07:53,  1.32s/it] 24%|██▍       | 114/471 [02:28<07:52,  1.32s/it] 24%|██▍       | 115/471 [02:29<07:51,  1.32s/it] 25%|██▍       | 116/471 [02:30<07:50,  1.32s/it] 25%|██▍       | 117/471 [02:32<07:48,  1.32s/it] 25%|██▌       | 118/471 [02:33<07:47,  1.33s/it] 25%|██▌       | 119/471 [02:34<07:46,  1.33s/it] 25%|██▌       | 120/471 [02:36<07:46,  1.33s/it] 26%|██▌       | 121/471 [02:37<07:44,  1.33s/it] 26%|██▌       | 122/471 [02:38<07:42,  1.33s/it] 26%|██▌       | 123/471 [02:40<07:41,  1.33s/it] 26%|██▋       | 124/471 [02:41<07:40,  1.33s/it] 27%|██▋       | 125/471 [02:42<07:39,  1.33s/it] 27%|██▋       | 126/471 [02:44<07:38,  1.33s/it] 27%|██▋       | 127/471 [02:45<07:36,  1.33s/it] 27%|██▋       | 128/471 [02:46<07:35,  1.33s/it] 27%|██▋       | 129/471 [02:48<07:33,  1.33s/it] 28%|██▊       | 130/471 [02:49<07:32,  1.33s/it] 28%|██▊       | 131/471 [02:50<07:30,  1.33s/it] 28%|██▊       | 132/471 [02:52<07:29,  1.33s/it] 28%|██▊       | 133/471 [02:53<07:28,  1.33s/it] 28%|██▊       | 134/471 [02:54<07:27,  1.33s/it] 29%|██▊       | 135/471 [02:56<07:26,  1.33s/it] 29%|██▉       | 136/471 [02:57<07:24,  1.33s/it] 29%|██▉       | 137/471 [02:58<07:23,  1.33s/it] 29%|██▉       | 138/471 [03:00<07:22,  1.33s/it] 30%|██▉       | 139/471 [03:01<07:20,  1.33s/it] 30%|██▉       | 140/471 [03:02<07:19,  1.33s/it] 30%|██▉       | 141/471 [03:04<07:18,  1.33s/it] 30%|███       | 142/471 [03:05<07:16,  1.33s/it] 30%|███       | 143/471 [03:06<07:15,  1.33s/it] 31%|███       | 144/471 [03:08<07:14,  1.33s/it] 31%|███       | 145/471 [03:09<07:12,  1.33s/it] 31%|███       | 146/471 [03:10<07:12,  1.33s/it] 31%|███       | 147/471 [03:12<07:10,  1.33s/it] 31%|███▏      | 148/471 [03:13<07:09,  1.33s/it] 32%|███▏      | 149/471 [03:14<07:08,  1.33s/it] 32%|███▏      | 150/471 [03:16<07:07,  1.33s/it] 32%|███▏      | 151/471 [03:17<07:05,  1.33s/it] 32%|███▏      | 152/471 [03:18<07:03,  1.33s/it] 32%|███▏      | 153/471 [03:20<07:03,  1.33s/it] 33%|███▎      | 154/471 [03:21<07:00,  1.33s/it] 33%|███▎      | 155/471 [03:22<06:59,  1.33s/it] 33%|███▎      | 156/471 [03:23<06:58,  1.33s/it] 33%|███▎      | 157/471 [03:25<06:56,  1.33s/it] 34%|███▎      | 158/471 [03:26<06:54,  1.33s/it] 34%|███▍      | 159/471 [03:27<06:53,  1.32s/it] 34%|███▍      | 160/471 [03:29<06:53,  1.33s/it] 34%|███▍      | 161/471 [03:30<06:51,  1.33s/it] 34%|███▍      | 162/471 [03:31<06:50,  1.33s/it] 35%|███▍      | 163/471 [03:33<06:50,  1.33s/it] 35%|███▍      | 164/471 [03:34<06:48,  1.33s/it] 35%|███▌      | 165/471 [03:35<06:47,  1.33s/it] 35%|███▌      | 166/471 [03:37<06:46,  1.33s/it] 35%|███▌      | 167/471 [03:38<06:45,  1.33s/it] 36%|███▌      | 168/471 [03:39<06:43,  1.33s/it] 36%|███▌      | 169/471 [03:41<06:43,  1.34s/it] 36%|███▌      | 170/471 [03:42<06:42,  1.34s/it] 36%|███▋      | 171/471 [03:43<06:40,  1.34s/it] 37%|███▋      | 172/471 [03:45<06:38,  1.33s/it] 37%|███▋      | 173/471 [03:46<06:37,  1.34s/it] 37%|███▋      | 174/471 [03:47<06:36,  1.34s/it] 37%|███▋      | 175/471 [03:49<06:35,  1.34s/it] 37%|███▋      | 176/471 [03:50<06:34,  1.34s/it] 38%|███▊      | 177/471 [03:51<06:33,  1.34s/it] 38%|███▊      | 178/471 [03:53<06:31,  1.34s/it] 38%|███▊      | 179/471 [03:54<06:30,  1.34s/it] 38%|███▊      | 180/471 [03:56<06:29,  1.34s/it] 38%|███▊      | 181/471 [03:57<06:27,  1.34s/it] 39%|███▊      | 182/471 [03:58<06:27,  1.34s/it] 39%|███▉      | 183/471 [04:00<06:25,  1.34s/it] 39%|███▉      | 184/471 [04:01<06:24,  1.34s/it] 39%|███▉      | 185/471 [04:02<06:22,  1.34s/it] 39%|███▉      | 186/471 [04:04<06:22,  1.34s/it] 40%|███▉      | 187/471 [04:05<06:21,  1.34s/it] 40%|███▉      | 188/471 [04:06<06:20,  1.34s/it] 40%|████      | 189/471 [04:08<06:18,  1.34s/it] 40%|████      | 190/471 [04:09<06:16,  1.34s/it] 41%|████      | 191/471 [04:10<06:15,  1.34s/it] 41%|████      | 192/471 [04:12<06:14,  1.34s/it] 41%|████      | 193/471 [04:13<06:12,  1.34s/it] 41%|████      | 194/471 [04:14<06:11,  1.34s/it] 41%|████▏     | 195/471 [04:16<06:10,  1.34s/it] 42%|████▏     | 196/471 [04:17<06:09,  1.34s/it] 42%|████▏     | 197/471 [04:18<06:07,  1.34s/it] 42%|████▏     | 198/471 [04:20<06:06,  1.34s/it] 42%|████▏     | 199/471 [04:21<06:05,  1.34s/it] 42%|████▏     | 200/471 [04:22<06:04,  1.35s/it] 43%|████▎     | 201/471 [04:24<06:02,  1.34s/it] 43%|████▎     | 202/471 [04:25<06:02,  1.35s/it] 43%|████▎     | 203/471 [04:26<06:01,  1.35s/it] 43%|████▎     | 204/471 [04:28<06:00,  1.35s/it] 44%|████▎     | 205/471 [04:29<05:58,  1.35s/it] 44%|████▎     | 206/471 [04:30<05:56,  1.35s/it] 44%|████▍     | 207/471 [04:32<05:55,  1.35s/it] 44%|████▍     | 208/471 [04:33<05:53,  1.35s/it] 44%|████▍     | 209/471 [04:34<05:52,  1.35s/it] 45%|████▍     | 210/471 [04:36<05:51,  1.35s/it] 45%|████▍     | 211/471 [04:37<05:50,  1.35s/it] 45%|████▌     | 212/471 [04:39<05:49,  1.35s/it] 45%|████▌     | 213/471 [04:40<05:48,  1.35s/it] 45%|████▌     | 214/471 [04:41<05:46,  1.35s/it] 46%|████▌     | 215/471 [04:43<05:45,  1.35s/it] 46%|████▌     | 216/471 [04:44<05:44,  1.35s/it] 46%|████▌     | 217/471 [04:45<05:43,  1.35s/it] 46%|████▋     | 218/471 [04:47<05:42,  1.35s/it] 46%|████▋     | 219/471 [04:48<05:40,  1.35s/it] 47%|████▋     | 220/471 [04:49<05:39,  1.35s/it] 47%|████▋     | 221/471 [04:51<05:38,  1.35s/it] 47%|████▋     | 222/471 [04:52<05:36,  1.35s/it] 47%|████▋     | 223/471 [04:53<05:35,  1.35s/it] 48%|████▊     | 224/471 [04:55<05:34,  1.35s/it] 48%|████▊     | 225/471 [04:56<05:32,  1.35s/it] 48%|████▊     | 226/471 [04:57<05:30,  1.35s/it] 48%|████▊     | 227/471 [04:59<05:29,  1.35s/it] 48%|████▊     | 228/471 [05:00<05:28,  1.35s/it] 49%|████▊     | 229/471 [05:01<05:26,  1.35s/it] 49%|████▉     | 230/471 [05:03<05:25,  1.35s/it] 49%|████▉     | 231/471 [05:04<05:23,  1.35s/it] 49%|████▉     | 232/471 [05:06<05:21,  1.35s/it] 49%|████▉     | 233/471 [05:07<05:20,  1.35s/it] 50%|████▉     | 234/471 [05:08<05:19,  1.35s/it] 50%|████▉     | 235/471 [05:10<05:18,  1.35s/it] 50%|█████     | 236/471 [05:11<05:16,  1.35s/it] 50%|█████     | 237/471 [05:12<05:15,  1.35s/it] 51%|█████     | 238/471 [05:14<05:13,  1.35s/it] 51%|█████     | 239/471 [05:15<05:12,  1.35s/it] 51%|█████     | 240/471 [05:16<05:11,  1.35s/it] 51%|█████     | 241/471 [05:18<05:09,  1.35s/it] 51%|█████▏    | 242/471 [05:19<05:08,  1.35s/it] 52%|█████▏    | 243/471 [05:20<05:06,  1.35s/it] 52%|█████▏    | 244/471 [05:22<05:05,  1.35s/it] 52%|█████▏    | 245/471 [05:23<05:04,  1.35s/it] 52%|█████▏    | 246/471 [05:24<05:02,  1.35s/it] 52%|█████▏    | 247/471 [05:26<05:01,  1.34s/it] 53%|█████▎    | 248/471 [05:27<05:00,  1.35s/it] 53%|█████▎    | 249/471 [05:28<04:58,  1.35s/it] 53%|█████▎    | 250/471 [05:30<04:57,  1.35s/it] 53%|█████▎    | 251/471 [05:31<04:55,  1.34s/it] 54%|█████▎    | 252/471 [05:32<04:54,  1.35s/it] 54%|█████▎    | 253/471 [05:34<04:53,  1.35s/it] 54%|█████▍    | 254/471 [05:35<04:52,  1.35s/it] 54%|█████▍    | 255/471 [05:37<04:50,  1.35s/it] 54%|█████▍    | 256/471 [05:38<04:49,  1.35s/it] 55%|█████▍    | 257/471 [05:39<04:48,  1.35s/it] 55%|█████▍    | 258/471 [05:41<04:46,  1.35s/it] 55%|█████▍    | 259/471 [05:42<04:45,  1.35s/it] 55%|█████▌    | 260/471 [05:43<04:44,  1.35s/it] 55%|█████▌    | 261/471 [05:45<04:42,  1.35s/it] 56%|█████▌    | 262/471 [05:46<04:41,  1.35s/it] 56%|█████▌    | 263/471 [05:47<04:40,  1.35s/it] 56%|█████▌    | 264/471 [05:49<04:38,  1.35s/it] 56%|█████▋    | 265/471 [05:50<04:37,  1.35s/it] 56%|█████▋    | 266/471 [05:51<04:36,  1.35s/it] 57%|█████▋    | 267/471 [05:53<04:34,  1.35s/it] 57%|█████▋    | 268/471 [05:54<04:33,  1.35s/it] 57%|█████▋    | 269/471 [05:55<04:32,  1.35s/it] 57%|█████▋    | 270/471 [05:57<04:30,  1.35s/it] 58%|█████▊    | 271/471 [05:58<04:29,  1.35s/it] 58%|█████▊    | 272/471 [05:59<04:27,  1.34s/it] 58%|█████▊    | 273/471 [06:01<04:26,  1.34s/it] 58%|█████▊    | 274/471 [06:02<04:24,  1.34s/it] 58%|█████▊    | 275/471 [06:03<04:23,  1.34s/it] 59%|█████▊    | 276/471 [06:05<04:22,  1.34s/it] 59%|█████▉    | 277/471 [06:06<04:20,  1.34s/it] 59%|█████▉    | 278/471 [06:07<04:19,  1.34s/it] 59%|█████▉    | 279/471 [06:09<04:17,  1.34s/it] 59%|█████▉    | 280/471 [06:10<04:16,  1.34s/it] 60%|█████▉    | 281/471 [06:11<04:14,  1.34s/it] 60%|█████▉    | 282/471 [06:13<04:13,  1.34s/it] 60%|██████    | 283/471 [06:14<04:12,  1.34s/it] 60%|██████    | 284/471 [06:16<04:10,  1.34s/it] 61%|██████    | 285/471 [06:17<04:09,  1.34s/it] 61%|██████    | 286/471 [06:18<04:08,  1.34s/it] 61%|██████    | 287/471 [06:20<04:07,  1.34s/it] 61%|██████    | 288/471 [06:21<04:05,  1.34s/it] 61%|██████▏   | 289/471 [06:22<04:04,  1.34s/it] 62%|██████▏   | 290/471 [06:24<04:02,  1.34s/it] 62%|██████▏   | 291/471 [06:25<04:01,  1.34s/it] 62%|██████▏   | 292/471 [06:26<03:59,  1.34s/it] 62%|██████▏   | 293/471 [06:28<03:58,  1.34s/it] 62%|██████▏   | 294/471 [06:29<03:56,  1.34s/it] 63%|██████▎   | 295/471 [06:30<03:55,  1.34s/it] 63%|██████▎   | 296/471 [06:32<03:54,  1.34s/it] 63%|██████▎   | 297/471 [06:33<03:52,  1.34s/it] 63%|██████▎   | 298/471 [06:34<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:36<03:50,  1.34s/it] 64%|██████▎   | 300/471 [06:37<03:49,  1.34s/it] 64%|██████▍   | 301/471 [06:38<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:40<03:46,  1.34s/it] 64%|██████▍   | 303/471 [06:41<03:44,  1.34s/it] 65%|██████▍   | 304/471 [06:42<03:43,  1.34s/it] 65%|██████▍   | 305/471 [06:44<03:42,  1.34s/it] 65%|██████▍   | 306/471 [06:45<03:40,  1.34s/it] 65%|██████▌   | 307/471 [06:46<03:39,  1.34s/it] 65%|██████▌   | 308/471 [06:48<03:38,  1.34s/it] 66%|██████▌   | 309/471 [06:49<03:37,  1.34s/it] 66%|██████▌   | 310/471 [06:50<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:52<03:34,  1.34s/it] 66%|██████▌   | 312/471 [06:53<03:32,  1.34s/it] 66%|██████▋   | 313/471 [06:54<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:56<03:30,  1.34s/it] 67%|██████▋   | 315/471 [06:57<03:28,  1.34s/it] 67%|██████▋   | 316/471 [06:58<03:27,  1.34s/it] 67%|██████▋   | 317/471 [07:00<03:26,  1.34s/it] 68%|██████▊   | 318/471 [07:01<03:24,  1.34s/it] 68%|██████▊   | 319/471 [07:02<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:04<03:22,  1.34s/it] 68%|██████▊   | 321/471 [07:05<03:20,  1.34s/it] 68%|██████▊   | 322/471 [07:06<03:19,  1.34s/it] 69%|██████▊   | 323/471 [07:08<03:18,  1.34s/it] 69%|██████▉   | 324/471 [07:09<03:17,  1.34s/it] 69%|██████▉   | 325/471 [07:10<03:15,  1.34s/it] 69%|██████▉   | 326/471 [07:12<03:14,  1.34s/it] 69%|██████▉   | 327/471 [07:13<03:12,  1.34s/it] 70%|██████▉   | 328/471 [07:14<03:11,  1.34s/it] 70%|██████▉   | 329/471 [07:16<03:10,  1.34s/it] 70%|███████   | 330/471 [07:17<03:08,  1.34s/it] 70%|███████   | 331/471 [07:18<03:07,  1.34s/it] 70%|███████   | 332/471 [07:20<03:06,  1.34s/it] 71%|███████   | 333/471 [07:21<03:04,  1.34s/it] 71%|███████   | 334/471 [07:22<03:03,  1.34s/it] 71%|███████   | 335/471 [07:24<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:25<03:00,  1.34s/it] 72%|███████▏  | 337/471 [07:26<02:59,  1.34s/it] 72%|███████▏  | 338/471 [07:28<02:57,  1.34s/it] 72%|███████▏  | 339/471 [07:29<02:56,  1.34s/it] 72%|███████▏  | 340/471 [07:30<02:55,  1.34s/it] 72%|███████▏  | 341/471 [07:32<02:53,  1.34s/it] 73%|███████▎  | 342/471 [07:33<02:52,  1.34s/it] 73%|███████▎  | 343/471 [07:34<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:36<02:49,  1.33s/it] 73%|███████▎  | 345/471 [07:37<02:48,  1.34s/it] 73%|███████▎  | 346/471 [07:39<02:47,  1.34s/it] 74%|███████▎  | 347/471 [07:40<02:45,  1.34s/it] 74%|███████▍  | 348/471 [07:41<02:44,  1.34s/it] 74%|███████▍  | 349/471 [07:43<02:43,  1.34s/it] 74%|███████▍  | 350/471 [07:44<02:41,  1.34s/it] 75%|███████▍  | 351/471 [07:45<02:40,  1.33s/it] 75%|███████▍  | 352/471 [07:47<02:39,  1.34s/it] 75%|███████▍  | 353/471 [07:48<02:37,  1.34s/it] 75%|███████▌  | 354/471 [07:49<02:36,  1.34s/it] 75%|███████▌  | 355/471 [07:51<02:35,  1.34s/it] 76%|███████▌  | 356/471 [07:52<02:33,  1.34s/it] 76%|███████▌  | 357/471 [07:53<02:32,  1.34s/it] 76%|███████▌  | 358/471 [07:55<02:30,  1.34s/it] 76%|███████▌  | 359/471 [07:56<02:29,  1.34s/it] 76%|███████▋  | 360/471 [07:57<02:28,  1.34s/it] 77%|███████▋  | 361/471 [07:59<02:26,  1.34s/it] 77%|███████▋  | 362/471 [08:00<02:25,  1.34s/it] 77%|███████▋  | 363/471 [08:01<02:24,  1.34s/it] 77%|███████▋  | 364/471 [08:03<02:22,  1.34s/it] 77%|███████▋  | 365/471 [08:04<02:21,  1.34s/it] 78%|███████▊  | 366/471 [08:05<02:20,  1.34s/it] 78%|███████▊  | 367/471 [08:07<02:19,  1.34s/it] 78%|███████▊  | 368/471 [08:08<02:17,  1.34s/it] 78%|███████▊  | 369/471 [08:09<02:16,  1.33s/it] 79%|███████▊  | 370/471 [08:11<02:14,  1.34s/it] 79%|███████▉  | 371/471 [08:12<02:13,  1.34s/it] 79%|███████▉  | 372/471 [08:13<02:12,  1.34s/it] 79%|███████▉  | 373/471 [08:15<02:11,  1.34s/it] 79%|███████▉  | 374/471 [08:16<02:09,  1.34s/it] 80%|███████▉  | 375/471 [08:17<02:08,  1.34s/it] 80%|███████▉  | 376/471 [08:19<02:06,  1.34s/it] 80%|████████  | 377/471 [08:20<02:05,  1.34s/it] 80%|████████  | 378/471 [08:21<02:04,  1.34s/it] 80%|████████  | 379/471 [08:23<02:03,  1.34s/it] 81%|████████  | 380/471 [08:24<02:01,  1.34s/it] 81%|████████  | 381/471 [08:25<02:00,  1.34s/it] 81%|████████  | 382/471 [08:27<01:58,  1.34s/it] 81%|████████▏ | 383/471 [08:28<01:57,  1.34s/it] 82%|████████▏ | 384/471 [08:29<01:56,  1.34s/it] 82%|████████▏ | 385/471 [08:31<01:55,  1.34s/it] 82%|████████▏ | 386/471 [08:32<01:53,  1.34s/it] 82%|████████▏ | 387/471 [08:33<01:52,  1.34s/it] 82%|████████▏ | 388/471 [08:35<01:51,  1.34s/it] 83%|████████▎ | 389/471 [08:36<01:49,  1.34s/it] 83%|████████▎ | 390/471 [08:37<01:48,  1.34s/it] 83%|████████▎ | 391/471 [08:39<01:46,  1.34s/it] 83%|████████▎ | 392/471 [08:40<01:45,  1.34s/it] 83%|████████▎ | 393/471 [08:41<01:44,  1.34s/it] 84%|████████▎ | 394/471 [08:43<01:43,  1.34s/it] 84%|████████▍ | 395/471 [08:44<01:41,  1.33s/it] 84%|████████▍ | 396/471 [08:45<01:40,  1.34s/it] 84%|████████▍ | 397/471 [08:47<01:38,  1.34s/it] 85%|████████▍ | 398/471 [08:48<01:37,  1.34s/it] 85%|████████▍ | 399/471 [08:49<01:36,  1.34s/it] 85%|████████▍ | 400/471 [08:51<01:35,  1.34s/it] 85%|████████▌ | 401/471 [08:52<01:33,  1.34s/it] 85%|████████▌ | 402/471 [08:53<01:32,  1.34s/it] 86%|████████▌ | 403/471 [08:55<01:30,  1.34s/it] 86%|████████▌ | 404/471 [08:56<01:29,  1.34s/it] 86%|████████▌ | 405/471 [08:57<01:28,  1.34s/it] 86%|████████▌ | 406/471 [08:59<01:26,  1.34s/it] 86%|████████▋ | 407/471 [09:00<01:25,  1.34s/it] 87%|████████▋ | 408/471 [09:01<01:24,  1.34s/it] 87%|████████▋ | 409/471 [09:03<01:23,  1.34s/it] 87%|████████▋ | 410/471 [09:04<01:21,  1.34s/it] 87%|████████▋ | 411/471 [09:05<01:20,  1.34s/it] 87%|████████▋ | 412/471 [09:07<01:19,  1.34s/it] 88%|████████▊ | 413/471 [09:08<01:17,  1.34s/it] 88%|████████▊ | 414/471 [09:09<01:16,  1.34s/it] 88%|████████▊ | 415/471 [09:11<01:15,  1.34s/it] 88%|████████▊ | 416/471 [09:12<01:13,  1.34s/it] 89%|████████▊ | 417/471 [09:13<01:12,  1.34s/it] 89%|████████▊ | 418/471 [09:15<01:11,  1.34s/it] 89%|████████▉ | 419/471 [09:16<01:09,  1.34s/it] 89%|████████▉ | 420/471 [09:17<01:08,  1.34s/it] 89%|████████▉ | 421/471 [09:19<01:07,  1.34s/it] 90%|████████▉ | 422/471 [09:20<01:05,  1.34s/it] 90%|████████▉ | 423/471 [09:22<01:04,  1.34s/it] 90%|█████████ | 424/471 [09:23<01:03,  1.34s/it] 90%|█████████ | 425/471 [09:24<01:01,  1.34s/it] 90%|█████████ | 426/471 [09:26<01:00,  1.35s/it] 91%|█████████ | 427/471 [09:27<00:59,  1.35s/it] 91%|█████████ | 428/471 [09:28<00:57,  1.35s/it] 91%|█████████ | 429/471 [09:30<00:56,  1.35s/it] 91%|█████████▏| 430/471 [09:31<00:55,  1.35s/it] 92%|█████████▏| 431/471 [09:32<00:53,  1.35s/it] 92%|█████████▏| 432/471 [09:34<00:52,  1.35s/it] 92%|█████████▏| 433/471 [09:35<00:51,  1.35s/it] 92%|█████████▏| 434/471 [09:36<00:50,  1.35s/it] 92%|█████████▏| 435/471 [09:38<00:48,  1.35s/it] 93%|█████████▎| 436/471 [09:39<00:47,  1.35s/it] 93%|█████████▎| 437/471 [09:40<00:45,  1.35s/it] 93%|█████████▎| 438/471 [09:42<00:44,  1.35s/it] 93%|█████████▎| 439/471 [09:43<00:43,  1.35s/it] 93%|█████████▎| 440/471 [09:44<00:41,  1.35s/it] 94%|█████████▎| 441/471 [09:46<00:40,  1.35s/it] 94%|█████████▍| 442/471 [09:47<00:39,  1.35s/it] 94%|█████████▍| 443/471 [09:49<00:37,  1.35s/it] 94%|█████████▍| 444/471 [09:50<00:36,  1.35s/it] 94%|█████████▍| 445/471 [09:51<00:35,  1.35s/it] 95%|█████████▍| 446/471 [09:53<00:33,  1.35s/it] 95%|█████████▍| 447/471 [09:54<00:32,  1.35s/it] 95%|█████████▌| 448/471 [09:55<00:30,  1.35s/it] 95%|█████████▌| 449/471 [09:57<00:29,  1.35s/it] 96%|█████████▌| 450/471 [09:58<00:28,  1.35s/it] 96%|█████████▌| 451/471 [09:59<00:26,  1.35s/it] 96%|█████████▌| 452/471 [10:01<00:25,  1.35s/it] 96%|█████████▌| 453/471 [10:02<00:24,  1.35s/it] 96%|█████████▋| 454/471 [10:03<00:22,  1.35s/it] 97%|█████████▋| 455/471 [10:05<00:21,  1.35s/it] 97%|█████████▋| 456/471 [10:06<00:20,  1.35s/it] 97%|█████████▋| 457/471 [10:07<00:18,  1.35s/it] 97%|█████████▋| 458/471 [10:09<00:17,  1.35s/it] 97%|█████████▋| 459/471 [10:10<00:16,  1.34s/it] 98%|█████████▊| 460/471 [10:11<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:13<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:14<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:15<00:10,  1.34s/it] 99%|█████████▊| 464/471 [10:17<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:18<00:08,  1.34s/it] 99%|█████████▉| 466/471 [10:19<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:21<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:22<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:23<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:25<00:01,  1.34s/it]100%|██████████| 471/471 [10:26<00:00,  1.23s/it]100%|██████████| 471/471 [10:26<00:00,  1.33s/it]
{'eval_loss': 3.6774957180023193, 'eval_model_preparation_time': 0.0205, 'eval_acc': 0.2611524163568773, 'eval_runtime': 627.5331, 'eval_samples_per_second': 12.003, 'eval_steps_per_second': 0.751}
ROUND:11
CLIENT:23
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 4.0695, 'grad_norm': 8.88386058807373, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.9733, 'grad_norm': 10.507380485534668, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 3.2125, 'grad_norm': 14.363822937011719, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:19,  2.22s/it]                                              {'loss': 2.7957, 'grad_norm': 12.369203567504883, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:18,  2.23s/it]                                              {'loss': 1.9377, 'grad_norm': 12.289569854736328, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:18,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it]                                              {'loss': 1.5124, 'grad_norm': 9.972785949707031, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it]                                              {'loss': 1.8825, 'grad_norm': 12.096114158630371, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 0.4166, 'grad_norm': 24.461278915405273, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.4591, 'grad_norm': 13.120377540588379, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 1.7675, 'grad_norm': 10.447915077209473, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it]                                               {'loss': 0.8094, 'grad_norm': 5.9968132972717285, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it] 30%|███       | 12/40 [00:24<00:58,  2.10s/it]                                               {'loss': 0.4905, 'grad_norm': 4.137210369110107, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.10s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it]                                               {'loss': 0.7475, 'grad_norm': 4.876108646392822, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it]                                               {'loss': 0.3596, 'grad_norm': 3.158212900161743, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it]                                               {'loss': 0.9085, 'grad_norm': 8.115250587463379, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.4316, 'grad_norm': 6.608669757843018, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.383, 'grad_norm': 4.1565470695495605, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it]                                               {'loss': 0.361, 'grad_norm': 9.452188491821289, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.2683, 'grad_norm': 2.7595105171203613, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:42,  2.10s/it]                                               {'loss': 0.5877, 'grad_norm': 7.240238189697266, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it]                                               {'loss': 0.3579, 'grad_norm': 2.4284324645996094, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 0.1369, 'grad_norm': 1.3918201923370361, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.3845, 'grad_norm': 3.7402186393737793, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 2.044, 'grad_norm': 55.6168327331543, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it]                                               {'loss': 0.0926, 'grad_norm': 1.2231868505477905, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.93s/it]                                               {'loss': 0.3459, 'grad_norm': 4.5071845054626465, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.1699, 'grad_norm': 3.7162725925445557, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.12s/it]                                               {'loss': 0.0489, 'grad_norm': 1.0155647993087769, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.1877, 'grad_norm': 25.614030838012695, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it]                                               {'loss': 0.284, 'grad_norm': 3.1008496284484863, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.084, 'grad_norm': 1.4477630853652954, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0061, 'grad_norm': 0.4107794761657715, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0815, 'grad_norm': 0.932101845741272, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.93s/it]                                               {'loss': 0.1612, 'grad_norm': 2.3066916465759277, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.02s/it]                                               {'loss': 0.2678, 'grad_norm': 2.111361265182495, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.0714, 'grad_norm': 1.3974391222000122, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it]                                               {'loss': 0.1339, 'grad_norm': 4.766350746154785, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.1488, 'grad_norm': 2.5265986919403076, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.0951, 'grad_norm': 1.8017559051513672, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0007, 'grad_norm': 0.026111289858818054, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 80.2109, 'train_samples_per_second': 7.044, 'train_steps_per_second': 0.499, 'train_loss': 0.8119231647098786, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:81
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 2.1978, 'grad_norm': 6.9015302658081055, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 2.1758, 'grad_norm': 11.415037155151367, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 2.3791, 'grad_norm': 12.77659797668457, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.8515, 'grad_norm': 13.53681755065918, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 2.0607, 'grad_norm': 15.034330368041992, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 1.7902, 'grad_norm': 11.482638359069824, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.9564, 'grad_norm': 38.84091567993164, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 6.2243, 'grad_norm': 51.154598236083984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.1089, 'grad_norm': 17.819734573364258, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 0.8889, 'grad_norm': 10.710433959960938, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.4826, 'grad_norm': 9.079488754272461, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.2385, 'grad_norm': 8.050399780273438, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 1.5094, 'grad_norm': 16.286380767822266, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 0.733, 'grad_norm': 9.609983444213867, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.223, 'grad_norm': 4.3328938484191895, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0001, 'grad_norm': 0.00921109039336443, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.647, 'grad_norm': 4.505441188812256, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 1.0328, 'grad_norm': 10.064780235290527, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 0.6515, 'grad_norm': 6.28422212600708, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:42,  2.10s/it]                                               {'loss': 0.0495, 'grad_norm': 0.9243823885917664, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.939, 'grad_norm': 7.9754557609558105, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 0.1804, 'grad_norm': 4.91457986831665, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.4322, 'grad_norm': 5.842118740081787, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0126, 'grad_norm': 0.6214694380760193, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.092, 'grad_norm': 1.6090590953826904, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it]                                               {'loss': 0.1045, 'grad_norm': 2.4576754570007324, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.1248, 'grad_norm': 2.271672010421753, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.4045, 'grad_norm': 6.702793121337891, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.0517, 'grad_norm': 1.5391197204589844, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.1464, 'grad_norm': 1.6307963132858276, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.071, 'grad_norm': 1.802277684211731, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0978, 'grad_norm': 3.545428514480591, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.0109, 'grad_norm': 0.3612135350704193, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.1161, 'grad_norm': 1.7218351364135742, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.0269, 'grad_norm': 0.9477009773254395, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0257, 'grad_norm': 0.6182185411453247, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.1508, 'grad_norm': 7.787690162658691, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.1054, 'grad_norm': 4.878995895385742, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.1466, 'grad_norm': 4.127735137939453, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.1871, 'grad_norm': 7.701221466064453, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.8875, 'train_samples_per_second': 7.072, 'train_steps_per_second': 0.501, 'train_loss': 0.7906810846106964, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 0.0014, 'grad_norm': 0.031020015478134155, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 0.0026, 'grad_norm': 0.0958620011806488, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 0.007, 'grad_norm': 0.18215298652648926, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 0.0051, 'grad_norm': 0.053133826702833176, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 0.0109, 'grad_norm': 0.1859765350818634, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 0.0051, 'grad_norm': 0.10009429603815079, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it]                                              {'loss': 0.0052, 'grad_norm': 0.07977646589279175, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.0013, 'grad_norm': 0.03282688558101654, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 0.0009, 'grad_norm': 0.020680895075201988, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 0.0007, 'grad_norm': 0.008387350477278233, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.0011, 'grad_norm': 0.009968980215489864, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.0012, 'grad_norm': 0.01360746193677187, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it]                                               {'loss': 0.0054, 'grad_norm': 0.08948857337236404, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it]                                               {'loss': 0.0039, 'grad_norm': 0.05593181028962135, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it]                                               {'loss': 0.0029, 'grad_norm': 0.028377164155244827, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 0.0, 'grad_norm': 0.00041290742228738964, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.0018, 'grad_norm': 0.015165461227297783, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.0014, 'grad_norm': 0.009218295104801655, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 0.0023, 'grad_norm': 0.03912975639104843, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:42,  2.12s/it]                                               {'loss': 0.0059, 'grad_norm': 0.059080492705106735, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.12s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it]                                               {'loss': 0.0056, 'grad_norm': 0.07486312091350555, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 0.0033, 'grad_norm': 0.03457581624388695, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.0014, 'grad_norm': 0.01335759274661541, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0, 'grad_norm': 5.967949618934654e-05, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it]                                               {'loss': 0.0044, 'grad_norm': 0.05739066004753113, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it]                                               {'loss': 0.0017, 'grad_norm': 0.035102881491184235, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.0026, 'grad_norm': 0.02573545090854168, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0092, 'grad_norm': 0.2684885263442993, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.0019, 'grad_norm': 0.021577322855591774, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it]                                               {'loss': 0.0027, 'grad_norm': 0.05022083595395088, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it]                                               {'loss': 0.0025, 'grad_norm': 0.02171362191438675, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.23s/it] 80%|████████  | 32/40 [01:03<00:12,  1.62s/it]                                               {'loss': 0.0, 'grad_norm': 0.0001571934117237106, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.62s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.82s/it]                                               {'loss': 0.002, 'grad_norm': 0.02552201971411705, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.82s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it]                                               {'loss': 0.0017, 'grad_norm': 0.018423564732074738, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.0034, 'grad_norm': 0.05782913789153099, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.0013, 'grad_norm': 0.017728660255670547, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it]                                               {'loss': 0.0051, 'grad_norm': 0.04159124195575714, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it]                                               {'loss': 0.0063, 'grad_norm': 0.09879681468009949, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0034, 'grad_norm': 0.04343032464385033, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0001, 'grad_norm': 0.0020789089612662792, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 80.1571, 'train_samples_per_second': 7.049, 'train_steps_per_second': 0.499, 'train_loss': 0.003125492172870281, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.61s/it]100%|██████████| 40/40 [01:20<00:00,  2.00s/it]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 2.4744, 'grad_norm': 6.9676337242126465, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 2.5504, 'grad_norm': 10.435919761657715, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.2669, 'grad_norm': 11.406014442443848, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:19,  2.19s/it]                                              {'loss': 2.0977, 'grad_norm': 10.727557182312012, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 0.6399, 'grad_norm': 7.028598785400391, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.1499, 'grad_norm': 20.988094329833984, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.2779, 'grad_norm': 9.571310043334961, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.0444, 'grad_norm': 1.8045909404754639, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.2149, 'grad_norm': 20.02385902404785, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 0.5138, 'grad_norm': 9.594704627990723, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.3195, 'grad_norm': 4.555554389953613, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.7643, 'grad_norm': 7.887284278869629, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.6912, 'grad_norm': 33.70602798461914, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.4346, 'grad_norm': 3.9882218837738037, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.2944, 'grad_norm': 3.494357109069824, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0266, 'grad_norm': 1.4863783121109009, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.2548, 'grad_norm': 2.204448699951172, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.1073, 'grad_norm': 1.7813676595687866, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.2895, 'grad_norm': 4.773416042327881, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.247, 'grad_norm': 4.9823479652404785, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.0922, 'grad_norm': 1.812501311302185, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.2911, 'grad_norm': 2.6253175735473633, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.4054, 'grad_norm': 22.550586700439453, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0002, 'grad_norm': 0.007814501412212849, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.0378, 'grad_norm': 0.8398149609565735, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.1256, 'grad_norm': 1.575822114944458, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.4454, 'grad_norm': 9.24471378326416, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.2459, 'grad_norm': 4.377457618713379, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1242, 'grad_norm': 2.3118696212768555, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.1259, 'grad_norm': 7.048561096191406, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.1714, 'grad_norm': 2.590988874435425, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0001, 'grad_norm': 0.004386924207210541, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.1364, 'grad_norm': 2.509117364883423, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.1307, 'grad_norm': 4.619976997375488, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.0544, 'grad_norm': 0.8681854605674744, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.13s/it]                                               {'loss': 0.0603, 'grad_norm': 0.9228800535202026, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.13s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0523, 'grad_norm': 1.1759814023971558, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.0079, 'grad_norm': 0.13199526071548462, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0417, 'grad_norm': 1.6344923973083496, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'loss': 0.0375, 'grad_norm': 1.5377424955368042, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'train_runtime': 79.4322, 'train_samples_per_second': 7.113, 'train_steps_per_second': 0.504, 'train_loss': 0.531149675819961, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:62
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.253, 'grad_norm': 9.730232238769531, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]                                              {'loss': 2.0032, 'grad_norm': 9.366880416870117, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.5514, 'grad_norm': 14.000475883483887, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 1.9906, 'grad_norm': 12.578728675842285, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.6647, 'grad_norm': 9.82928466796875, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.8122, 'grad_norm': 16.84050750732422, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 3.3023, 'grad_norm': 19.206321716308594, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.0581, 'grad_norm': 3.154027223587036, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.2515, 'grad_norm': 13.253536224365234, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 0.8831, 'grad_norm': 11.763954162597656, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 1.145, 'grad_norm': 13.793693542480469, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.7809, 'grad_norm': 9.675655364990234, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.795, 'grad_norm': 7.2867817878723145, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.6284, 'grad_norm': 8.521024703979492, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 1.0219, 'grad_norm': 6.730257511138916, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.1077, 'grad_norm': 4.343257427215576, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.5735, 'grad_norm': 9.50633716583252, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.2173, 'grad_norm': 6.8409342765808105, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.162, 'grad_norm': 2.765584945678711, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.6234, 'grad_norm': 5.560924053192139, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.1136, 'grad_norm': 1.7390495538711548, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.2639, 'grad_norm': 3.8775410652160645, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.4924, 'grad_norm': 11.873810768127441, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0021, 'grad_norm': 0.17925997078418732, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.1324, 'grad_norm': 1.7966855764389038, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.2657, 'grad_norm': 3.445719003677368, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.0961, 'grad_norm': 2.7131428718566895, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.3496, 'grad_norm': 7.776310920715332, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.0523, 'grad_norm': 0.8487491607666016, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.2325, 'grad_norm': 5.467153072357178, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.2333, 'grad_norm': 1.9939883947372437, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 2.8426, 'grad_norm': 61.539241790771484, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.1106, 'grad_norm': 1.624316930770874, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.0174, 'grad_norm': 0.26555511355400085, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0649, 'grad_norm': 2.2158899307250977, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.288, 'grad_norm': 0.8563219904899597, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0689, 'grad_norm': 1.975264072418213, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.4846, 'grad_norm': 5.918950080871582, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0327, 'grad_norm': 0.6442278027534485, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.1572, 'grad_norm': 4.558801174163818, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 79.0683, 'train_samples_per_second': 7.146, 'train_steps_per_second': 0.506, 'train_loss': 0.8031488545413594, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:46
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 3.9465, 'grad_norm': 6.922327518463135, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.8573, 'grad_norm': 10.009146690368652, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.733, 'grad_norm': 13.997462272644043, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:17,  2.17s/it]                                              {'loss': 3.5953, 'grad_norm': 16.605417251586914, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 1.4593, 'grad_norm': 10.566380500793457, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it]                                              {'loss': 1.8379, 'grad_norm': 13.109563827514648, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.1393, 'grad_norm': 13.501096725463867, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.9967, 'grad_norm': 55.77178192138672, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.4148, 'grad_norm': 4.9266133308410645, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.0739, 'grad_norm': 8.190390586853027, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.5026, 'grad_norm': 4.1448163986206055, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.8083, 'grad_norm': 4.192523002624512, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.7226, 'grad_norm': 6.283174514770508, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.7449, 'grad_norm': 6.195636749267578, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.0386, 'grad_norm': 8.973222732543945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0107, 'grad_norm': 0.5913122892379761, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it]                                               {'loss': 0.2233, 'grad_norm': 3.2517173290252686, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.1421, 'grad_norm': 1.7475550174713135, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.0956, 'grad_norm': 2.9951536655426025, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.0793, 'grad_norm': 2.8042333126068115, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.1577, 'grad_norm': 2.3988378047943115, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.6754, 'grad_norm': 7.115175724029541, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.6934, 'grad_norm': 6.957054615020752, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0003, 'grad_norm': 0.015687115490436554, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.127, 'grad_norm': 0.9720830321311951, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.066, 'grad_norm': 1.2477078437805176, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.2725, 'grad_norm': 12.39769458770752, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.2499, 'grad_norm': 12.920148849487305, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.1657, 'grad_norm': 3.6403164863586426, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1986, 'grad_norm': 9.95645809173584, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.027, 'grad_norm': 0.7323249578475952, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0484, 'grad_norm': 4.33438777923584, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0191, 'grad_norm': 0.5986526608467102, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0235, 'grad_norm': 2.350055456161499, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1836, 'grad_norm': 4.343601703643799, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0705, 'grad_norm': 1.3673782348632812, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.1013, 'grad_norm': 3.869680643081665, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.3325, 'grad_norm': 21.229021072387695, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.3619, 'grad_norm': 82.65350341796875, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0322, 'grad_norm': 1.4093669652938843, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.7372, 'train_samples_per_second': 7.176, 'train_steps_per_second': 0.508, 'train_loss': 0.7057075972399616, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 3.2949, 'grad_norm': 8.315074920654297, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:23,  2.18s/it]                                              {'loss': 2.2549, 'grad_norm': 10.013035774230957, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.9046, 'grad_norm': 7.93123197555542, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.9789, 'grad_norm': 9.365078926086426, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 1.7129, 'grad_norm': 7.277862071990967, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 1.2008, 'grad_norm': 8.825319290161133, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.076, 'grad_norm': 9.64471435546875, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.8287, 'grad_norm': 57.0612907409668, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.1578, 'grad_norm': 12.179515838623047, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 1.764, 'grad_norm': 8.086944580078125, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.1603, 'grad_norm': 1.6629464626312256, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 0.9271, 'grad_norm': 5.8553266525268555, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 1.0187, 'grad_norm': 7.390068054199219, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.0456, 'grad_norm': 4.911436080932617, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.6726, 'grad_norm': 6.169785022735596, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0093, 'grad_norm': 0.5103582143783569, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.3048, 'grad_norm': 2.807651996612549, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.2679, 'grad_norm': 4.17863655090332, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it]                                               {'loss': 0.659, 'grad_norm': 9.62363338470459, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.3684, 'grad_norm': 4.2544264793396, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.1969, 'grad_norm': 1.2763811349868774, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.4001, 'grad_norm': 3.3635311126708984, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.4721, 'grad_norm': 2.7777178287506104, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 1.2781, 'grad_norm': 54.70155715942383, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.279, 'grad_norm': 5.538240909576416, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.1736, 'grad_norm': 1.6274865865707397, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.248, 'grad_norm': 3.0595057010650635, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.1394, 'grad_norm': 2.960925340652466, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.0371, 'grad_norm': 0.8013143539428711, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.449, 'grad_norm': 10.437817573547363, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.3989, 'grad_norm': 2.290004014968872, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0664, 'grad_norm': 2.5695908069610596, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.1867, 'grad_norm': 2.2046360969543457, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.2001, 'grad_norm': 8.612548828125, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.1818, 'grad_norm': 3.722327470779419, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.3336, 'grad_norm': 3.4759223461151123, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.1795, 'grad_norm': 3.063599109649658, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1633, 'grad_norm': 2.6522727012634277, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0561, 'grad_norm': 0.8791288733482361, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0073, 'grad_norm': 0.25501927733421326, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.4242, 'train_samples_per_second': 7.114, 'train_steps_per_second': 0.504, 'train_loss': 0.7013566459296271, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 4.0984, 'grad_norm': 12.055295944213867, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.6646, 'grad_norm': 11.202173233032227, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 2.4237, 'grad_norm': 8.165068626403809, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.2901, 'grad_norm': 20.838626861572266, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 2.0807, 'grad_norm': 11.368541717529297, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.1794, 'grad_norm': 14.890064239501953, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.3796, 'grad_norm': 10.547944068908691, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 1.4948, 'grad_norm': 71.13854217529297, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 0.6978, 'grad_norm': 7.060062408447266, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it]                                               {'loss': 0.7206, 'grad_norm': 7.871843338012695, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.4504, 'grad_norm': 3.8563380241394043, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.3693, 'grad_norm': 4.330281734466553, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 0.9204, 'grad_norm': 9.105765342712402, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.1371, 'grad_norm': 6.691508769989014, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.7572, 'grad_norm': 7.001309871673584, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.6461, 'grad_norm': 18.09712028503418, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.4417, 'grad_norm': 8.759653091430664, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.947, 'grad_norm': 8.247215270996094, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.261, 'grad_norm': 3.7161853313446045, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.3842, 'grad_norm': 5.020493507385254, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.3477, 'grad_norm': 4.5218634605407715, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 0.2268, 'grad_norm': 3.438920736312866, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it]                                               {'loss': 0.5628, 'grad_norm': 5.662290096282959, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0289, 'grad_norm': 1.0318690538406372, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it]                                               {'loss': 0.1108, 'grad_norm': 1.727236032485962, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.81s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.2642, 'grad_norm': 4.664573669433594, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.05s/it]                                               {'loss': 0.2827, 'grad_norm': 3.2879638671875, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.05s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.1302, 'grad_norm': 3.510352849960327, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.216, 'grad_norm': 3.095069646835327, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.1329, 'grad_norm': 1.9035049676895142, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.6124, 'grad_norm': 7.210862159729004, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0118, 'grad_norm': 0.401481956243515, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.1282, 'grad_norm': 1.9471080303192139, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.1432, 'grad_norm': 3.0755257606506348, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0827, 'grad_norm': 1.6416579484939575, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0454, 'grad_norm': 1.715389370918274, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.0527, 'grad_norm': 0.7621899247169495, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.1743, 'grad_norm': 3.8316609859466553, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]                                               {'loss': 0.0532, 'grad_norm': 0.7764592170715332, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0489, 'grad_norm': 3.7778143882751465, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.4681, 'train_samples_per_second': 7.11, 'train_steps_per_second': 0.503, 'train_loss': 0.7749939487781375, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.9239, 'grad_norm': 11.699727058410645, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.3842, 'grad_norm': 13.615763664245605, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.6878, 'grad_norm': 12.603507995605469, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.0652, 'grad_norm': 12.097795486450195, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.4154, 'grad_norm': 14.074446678161621, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.5191, 'grad_norm': 20.492446899414062, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 1.0651, 'grad_norm': 12.642257690429688, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 3.6854, 'grad_norm': 60.413448333740234, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.8046, 'grad_norm': 7.944715976715088, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.3643, 'grad_norm': 3.8767552375793457, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.2318, 'grad_norm': 7.057577133178711, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.7862, 'grad_norm': 6.779497146606445, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.6242, 'grad_norm': 5.768074035644531, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.9308, 'grad_norm': 9.14184856414795, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.8291, 'grad_norm': 7.143909931182861, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 1.2829, 'grad_norm': 39.90061569213867, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.6805, 'grad_norm': 8.586748123168945, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.5543, 'grad_norm': 5.9020538330078125, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.4589, 'grad_norm': 4.92930269241333, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.6784, 'grad_norm': 5.6417365074157715, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.2494, 'grad_norm': 3.6589725017547607, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.2724, 'grad_norm': 3.946465253829956, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.2907, 'grad_norm': 2.187443256378174, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0299, 'grad_norm': 1.561966896057129, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.3217, 'grad_norm': 15.260557174682617, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.3227, 'grad_norm': 4.233071327209473, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.1202, 'grad_norm': 4.459028244018555, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.0982, 'grad_norm': 1.8254194259643555, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.5674, 'grad_norm': 6.2340545654296875, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.1224, 'grad_norm': 3.8097848892211914, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.4109, 'grad_norm': 5.712765216827393, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0091, 'grad_norm': 0.7509340047836304, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1788, 'grad_norm': 6.836126327514648, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.4863, 'grad_norm': 10.99161148071289, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.2741, 'grad_norm': 10.029949188232422, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0289, 'grad_norm': 0.5497538447380066, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0746, 'grad_norm': 1.457753300666809, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.2847, 'grad_norm': 3.3021767139434814, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.4042, 'grad_norm': 4.112335681915283, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0003, 'grad_norm': 0.01609409600496292, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.8994, 'train_samples_per_second': 7.161, 'train_steps_per_second': 0.507, 'train_loss': 0.887984241272352, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:11
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 3.4132, 'grad_norm': 9.2813720703125, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 3.0695, 'grad_norm': 8.60230541229248, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 3.2409, 'grad_norm': 12.437756538391113, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 2.0859, 'grad_norm': 9.553750991821289, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.1006, 'grad_norm': 11.330183982849121, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 2.0226, 'grad_norm': 10.351539611816406, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.7576, 'grad_norm': 8.98758602142334, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.3313, 'grad_norm': 79.28913879394531, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.7519, 'grad_norm': 6.410549640655518, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.4607, 'grad_norm': 7.903262615203857, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it]                                               {'loss': 1.2837, 'grad_norm': 11.40717601776123, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.96s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.8303, 'grad_norm': 4.157118320465088, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.7392, 'grad_norm': 4.177052974700928, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.0363, 'grad_norm': 7.280560493469238, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 1.1776, 'grad_norm': 7.874871253967285, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.0006, 'grad_norm': 0.030618583783507347, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.8439, 'grad_norm': 5.383040904998779, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.3888, 'grad_norm': 3.0306355953216553, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.9657, 'grad_norm': 5.527940273284912, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.5327, 'grad_norm': 5.414008140563965, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it]                                               {'loss': 0.5477, 'grad_norm': 4.050228595733643, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.1195, 'grad_norm': 4.219060897827148, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.4394, 'grad_norm': 5.115087032318115, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.4965, 'grad_norm': 8.15290355682373, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.4637, 'grad_norm': 11.229752540588379, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.9312, 'grad_norm': 11.909646987915039, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.264, 'grad_norm': 3.076474905014038, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.1212, 'grad_norm': 1.6588406562805176, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.3462, 'grad_norm': 3.7882418632507324, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.3266, 'grad_norm': 1.4640120267868042, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.0671, 'grad_norm': 1.33167564868927, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.0029, 'grad_norm': 0.14469464123249054, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.037, 'grad_norm': 0.6122574210166931, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.4523, 'grad_norm': 2.4432497024536133, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.2242, 'grad_norm': 1.76066255569458, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.2034, 'grad_norm': 2.9686503410339355, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.0963, 'grad_norm': 6.463986396789551, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.3986, 'grad_norm': 2.544207811355591, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.3568, 'grad_norm': 4.686446666717529, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 1.3657, 'grad_norm': 21.183427810668945, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.3584, 'train_samples_per_second': 7.21, 'train_steps_per_second': 0.51, 'train_loss': 1.0323347985802684, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:57,  1.58it/s]  1%|          | 3/471 [00:02<07:00,  1.11it/s]  1%|          | 4/471 [00:03<08:06,  1.04s/it]  1%|          | 5/471 [00:05<08:43,  1.12s/it]  1%|▏         | 6/471 [00:06<09:05,  1.17s/it]  1%|▏         | 7/471 [00:07<09:21,  1.21s/it]  2%|▏         | 8/471 [00:08<09:31,  1.23s/it]  2%|▏         | 9/471 [00:10<09:37,  1.25s/it]  2%|▏         | 10/471 [00:11<09:41,  1.26s/it]  2%|▏         | 11/471 [00:12<09:43,  1.27s/it]  3%|▎         | 12/471 [00:14<09:45,  1.28s/it]  3%|▎         | 13/471 [00:15<09:47,  1.28s/it]  3%|▎         | 14/471 [00:16<09:48,  1.29s/it]  3%|▎         | 15/471 [00:17<09:47,  1.29s/it]  3%|▎         | 16/471 [00:19<09:48,  1.29s/it]  4%|▎         | 17/471 [00:20<09:48,  1.30s/it]  4%|▍         | 18/471 [00:21<09:47,  1.30s/it]  4%|▍         | 19/471 [00:23<09:46,  1.30s/it]  4%|▍         | 20/471 [00:24<09:46,  1.30s/it]  4%|▍         | 21/471 [00:25<09:45,  1.30s/it]  5%|▍         | 22/471 [00:27<09:45,  1.30s/it]  5%|▍         | 23/471 [00:28<09:44,  1.30s/it]  5%|▌         | 24/471 [00:29<09:43,  1.31s/it]  5%|▌         | 25/471 [00:31<09:42,  1.31s/it]  6%|▌         | 26/471 [00:32<09:41,  1.31s/it]  6%|▌         | 27/471 [00:33<09:40,  1.31s/it]  6%|▌         | 28/471 [00:34<09:39,  1.31s/it]  6%|▌         | 29/471 [00:36<09:38,  1.31s/it]  6%|▋         | 30/471 [00:37<09:38,  1.31s/it]  7%|▋         | 31/471 [00:38<09:37,  1.31s/it]  7%|▋         | 32/471 [00:40<09:36,  1.31s/it]  7%|▋         | 33/471 [00:41<09:33,  1.31s/it]  7%|▋         | 34/471 [00:42<09:32,  1.31s/it]  7%|▋         | 35/471 [00:44<09:32,  1.31s/it]  8%|▊         | 36/471 [00:45<09:31,  1.31s/it]  8%|▊         | 37/471 [00:46<09:31,  1.32s/it]  8%|▊         | 38/471 [00:48<09:30,  1.32s/it]  8%|▊         | 39/471 [00:49<09:29,  1.32s/it]  8%|▊         | 40/471 [00:50<09:28,  1.32s/it]  9%|▊         | 41/471 [00:52<09:27,  1.32s/it]  9%|▉         | 42/471 [00:53<09:27,  1.32s/it]  9%|▉         | 43/471 [00:54<09:25,  1.32s/it]  9%|▉         | 44/471 [00:56<09:23,  1.32s/it] 10%|▉         | 45/471 [00:57<09:22,  1.32s/it] 10%|▉         | 46/471 [00:58<09:21,  1.32s/it] 10%|▉         | 47/471 [01:00<09:19,  1.32s/it] 10%|█         | 48/471 [01:01<09:19,  1.32s/it] 10%|█         | 49/471 [01:02<09:18,  1.32s/it] 11%|█         | 50/471 [01:03<09:17,  1.32s/it] 11%|█         | 51/471 [01:05<09:16,  1.33s/it] 11%|█         | 52/471 [01:06<09:16,  1.33s/it] 11%|█▏        | 53/471 [01:07<09:15,  1.33s/it] 11%|█▏        | 54/471 [01:09<09:14,  1.33s/it] 12%|█▏        | 55/471 [01:10<09:13,  1.33s/it] 12%|█▏        | 56/471 [01:11<09:12,  1.33s/it] 12%|█▏        | 57/471 [01:13<09:10,  1.33s/it] 12%|█▏        | 58/471 [01:14<09:09,  1.33s/it] 13%|█▎        | 59/471 [01:15<09:08,  1.33s/it] 13%|█▎        | 60/471 [01:17<09:06,  1.33s/it] 13%|█▎        | 61/471 [01:18<09:05,  1.33s/it] 13%|█▎        | 62/471 [01:19<09:03,  1.33s/it] 13%|█▎        | 63/471 [01:21<09:02,  1.33s/it] 14%|█▎        | 64/471 [01:22<09:01,  1.33s/it] 14%|█▍        | 65/471 [01:23<08:59,  1.33s/it] 14%|█▍        | 66/471 [01:25<08:58,  1.33s/it] 14%|█▍        | 67/471 [01:26<08:57,  1.33s/it] 14%|█▍        | 68/471 [01:27<08:56,  1.33s/it] 15%|█▍        | 69/471 [01:29<08:54,  1.33s/it] 15%|█▍        | 70/471 [01:30<08:54,  1.33s/it] 15%|█▌        | 71/471 [01:31<08:53,  1.33s/it] 15%|█▌        | 72/471 [01:33<08:51,  1.33s/it] 15%|█▌        | 73/471 [01:34<08:49,  1.33s/it] 16%|█▌        | 74/471 [01:35<08:47,  1.33s/it] 16%|█▌        | 75/471 [01:37<08:47,  1.33s/it] 16%|█▌        | 76/471 [01:38<08:45,  1.33s/it] 16%|█▋        | 77/471 [01:39<08:44,  1.33s/it] 17%|█▋        | 78/471 [01:41<08:42,  1.33s/it] 17%|█▋        | 79/471 [01:42<08:42,  1.33s/it] 17%|█▋        | 80/471 [01:43<08:40,  1.33s/it] 17%|█▋        | 81/471 [01:45<08:39,  1.33s/it] 17%|█▋        | 82/471 [01:46<08:37,  1.33s/it] 18%|█▊        | 83/471 [01:47<08:36,  1.33s/it] 18%|█▊        | 84/471 [01:49<08:35,  1.33s/it] 18%|█▊        | 85/471 [01:50<08:34,  1.33s/it] 18%|█▊        | 86/471 [01:51<08:32,  1.33s/it] 18%|█▊        | 87/471 [01:53<08:30,  1.33s/it] 19%|█▊        | 88/471 [01:54<08:29,  1.33s/it] 19%|█▉        | 89/471 [01:55<08:27,  1.33s/it] 19%|█▉        | 90/471 [01:57<08:27,  1.33s/it] 19%|█▉        | 91/471 [01:58<08:25,  1.33s/it] 20%|█▉        | 92/471 [01:59<08:23,  1.33s/it] 20%|█▉        | 93/471 [02:01<08:23,  1.33s/it] 20%|█▉        | 94/471 [02:02<08:21,  1.33s/it] 20%|██        | 95/471 [02:03<08:20,  1.33s/it] 20%|██        | 96/471 [02:05<08:18,  1.33s/it] 21%|██        | 97/471 [02:06<08:18,  1.33s/it] 21%|██        | 98/471 [02:07<08:16,  1.33s/it] 21%|██        | 99/471 [02:09<08:14,  1.33s/it] 21%|██        | 100/471 [02:10<08:13,  1.33s/it] 21%|██▏       | 101/471 [02:11<08:12,  1.33s/it] 22%|██▏       | 102/471 [02:13<08:11,  1.33s/it] 22%|██▏       | 103/471 [02:14<08:10,  1.33s/it] 22%|██▏       | 104/471 [02:15<08:09,  1.33s/it] 22%|██▏       | 105/471 [02:17<08:08,  1.34s/it] 23%|██▎       | 106/471 [02:18<08:06,  1.33s/it] 23%|██▎       | 107/471 [02:19<08:05,  1.33s/it] 23%|██▎       | 108/471 [02:21<08:03,  1.33s/it] 23%|██▎       | 109/471 [02:22<08:01,  1.33s/it] 23%|██▎       | 110/471 [02:23<07:59,  1.33s/it] 24%|██▎       | 111/471 [02:25<07:58,  1.33s/it] 24%|██▍       | 112/471 [02:26<07:58,  1.33s/it] 24%|██▍       | 113/471 [02:27<07:56,  1.33s/it] 24%|██▍       | 114/471 [02:29<07:55,  1.33s/it] 24%|██▍       | 115/471 [02:30<07:54,  1.33s/it] 25%|██▍       | 116/471 [02:31<07:53,  1.33s/it] 25%|██▍       | 117/471 [02:33<07:52,  1.33s/it] 25%|██▌       | 118/471 [02:34<07:50,  1.33s/it] 25%|██▌       | 119/471 [02:35<07:49,  1.33s/it] 25%|██▌       | 120/471 [02:37<07:48,  1.33s/it] 26%|██▌       | 121/471 [02:38<07:47,  1.33s/it] 26%|██▌       | 122/471 [02:39<07:46,  1.34s/it] 26%|██▌       | 123/471 [02:41<07:44,  1.34s/it] 26%|██▋       | 124/471 [02:42<07:43,  1.34s/it] 27%|██▋       | 125/471 [02:43<07:42,  1.34s/it] 27%|██▋       | 126/471 [02:45<07:41,  1.34s/it] 27%|██▋       | 127/471 [02:46<07:40,  1.34s/it] 27%|██▋       | 128/471 [02:47<07:38,  1.34s/it] 27%|██▋       | 129/471 [02:49<07:36,  1.33s/it] 28%|██▊       | 130/471 [02:50<07:35,  1.33s/it] 28%|██▊       | 131/471 [02:51<07:33,  1.33s/it] 28%|██▊       | 132/471 [02:53<07:32,  1.34s/it] 28%|██▊       | 133/471 [02:54<07:31,  1.34s/it] 28%|██▊       | 134/471 [02:55<07:30,  1.34s/it] 29%|██▊       | 135/471 [02:57<07:29,  1.34s/it] 29%|██▉       | 136/471 [02:58<07:27,  1.34s/it] 29%|██▉       | 137/471 [02:59<07:26,  1.34s/it] 29%|██▉       | 138/471 [03:01<07:24,  1.34s/it] 30%|██▉       | 139/471 [03:02<07:23,  1.34s/it] 30%|██▉       | 140/471 [03:03<07:21,  1.34s/it] 30%|██▉       | 141/471 [03:05<07:20,  1.33s/it] 30%|███       | 142/471 [03:06<07:19,  1.33s/it] 30%|███       | 143/471 [03:07<07:17,  1.33s/it] 31%|███       | 144/471 [03:09<07:16,  1.34s/it] 31%|███       | 145/471 [03:10<07:14,  1.33s/it] 31%|███       | 146/471 [03:11<07:14,  1.34s/it] 31%|███       | 147/471 [03:13<07:12,  1.34s/it] 31%|███▏      | 148/471 [03:14<07:11,  1.34s/it] 32%|███▏      | 149/471 [03:15<07:11,  1.34s/it] 32%|███▏      | 150/471 [03:17<07:10,  1.34s/it] 32%|███▏      | 151/471 [03:18<07:08,  1.34s/it] 32%|███▏      | 152/471 [03:19<07:06,  1.34s/it] 32%|███▏      | 153/471 [03:21<07:05,  1.34s/it] 33%|███▎      | 154/471 [03:22<07:03,  1.34s/it] 33%|███▎      | 155/471 [03:23<07:02,  1.34s/it] 33%|███▎      | 156/471 [03:25<07:00,  1.34s/it] 33%|███▎      | 157/471 [03:26<06:59,  1.34s/it] 34%|███▎      | 158/471 [03:27<06:57,  1.33s/it] 34%|███▍      | 159/471 [03:29<06:56,  1.33s/it] 34%|███▍      | 160/471 [03:30<06:55,  1.34s/it] 34%|███▍      | 161/471 [03:31<06:54,  1.34s/it] 34%|███▍      | 162/471 [03:33<06:53,  1.34s/it] 35%|███▍      | 163/471 [03:34<06:52,  1.34s/it] 35%|███▍      | 164/471 [03:35<06:50,  1.34s/it] 35%|███▌      | 165/471 [03:37<06:49,  1.34s/it] 35%|███▌      | 166/471 [03:38<06:48,  1.34s/it] 35%|███▌      | 167/471 [03:39<06:46,  1.34s/it] 36%|███▌      | 168/471 [03:41<06:45,  1.34s/it] 36%|███▌      | 169/471 [03:42<06:44,  1.34s/it] 36%|███▌      | 170/471 [03:43<06:42,  1.34s/it] 36%|███▋      | 171/471 [03:45<06:41,  1.34s/it] 37%|███▋      | 172/471 [03:46<06:39,  1.34s/it] 37%|███▋      | 173/471 [03:48<06:38,  1.34s/it] 37%|███▋      | 174/471 [03:49<06:37,  1.34s/it] 37%|███▋      | 175/471 [03:50<06:36,  1.34s/it] 37%|███▋      | 176/471 [03:52<06:34,  1.34s/it] 38%|███▊      | 177/471 [03:53<06:33,  1.34s/it] 38%|███▊      | 178/471 [03:54<06:31,  1.34s/it] 38%|███▊      | 179/471 [03:56<06:30,  1.34s/it] 38%|███▊      | 180/471 [03:57<06:28,  1.34s/it] 38%|███▊      | 181/471 [03:58<06:27,  1.34s/it] 39%|███▊      | 182/471 [04:00<06:26,  1.34s/it] 39%|███▉      | 183/471 [04:01<06:25,  1.34s/it] 39%|███▉      | 184/471 [04:02<06:23,  1.34s/it] 39%|███▉      | 185/471 [04:04<06:22,  1.34s/it] 39%|███▉      | 186/471 [04:05<06:22,  1.34s/it] 40%|███▉      | 187/471 [04:06<06:21,  1.34s/it] 40%|███▉      | 188/471 [04:08<06:19,  1.34s/it] 40%|████      | 189/471 [04:09<06:17,  1.34s/it] 40%|████      | 190/471 [04:10<06:16,  1.34s/it] 41%|████      | 191/471 [04:12<06:15,  1.34s/it] 41%|████      | 192/471 [04:13<06:14,  1.34s/it] 41%|████      | 193/471 [04:14<06:12,  1.34s/it] 41%|████      | 194/471 [04:16<06:11,  1.34s/it] 41%|████▏     | 195/471 [04:17<06:10,  1.34s/it] 42%|████▏     | 196/471 [04:18<06:08,  1.34s/it] 42%|████▏     | 197/471 [04:20<06:06,  1.34s/it] 42%|████▏     | 198/471 [04:21<06:05,  1.34s/it] 42%|████▏     | 199/471 [04:22<06:04,  1.34s/it] 42%|████▏     | 200/471 [04:24<06:03,  1.34s/it] 43%|████▎     | 201/471 [04:25<06:01,  1.34s/it] 43%|████▎     | 202/471 [04:26<06:00,  1.34s/it] 43%|████▎     | 203/471 [04:28<05:59,  1.34s/it] 43%|████▎     | 204/471 [04:29<05:58,  1.34s/it] 44%|████▎     | 205/471 [04:30<05:56,  1.34s/it] 44%|████▎     | 206/471 [04:32<05:55,  1.34s/it] 44%|████▍     | 207/471 [04:33<05:54,  1.34s/it] 44%|████▍     | 208/471 [04:34<05:52,  1.34s/it] 44%|████▍     | 209/471 [04:36<05:51,  1.34s/it] 45%|████▍     | 210/471 [04:37<05:50,  1.34s/it] 45%|████▍     | 211/471 [04:38<05:49,  1.34s/it] 45%|████▌     | 212/471 [04:40<05:47,  1.34s/it] 45%|████▌     | 213/471 [04:41<05:46,  1.34s/it] 45%|████▌     | 214/471 [04:42<05:45,  1.34s/it] 46%|████▌     | 215/471 [04:44<05:44,  1.34s/it] 46%|████▌     | 216/471 [04:45<05:43,  1.35s/it] 46%|████▌     | 217/471 [04:47<05:42,  1.35s/it] 46%|████▋     | 218/471 [04:48<05:40,  1.35s/it] 46%|████▋     | 219/471 [04:49<05:39,  1.35s/it] 47%|████▋     | 220/471 [04:51<05:38,  1.35s/it] 47%|████▋     | 221/471 [04:52<05:37,  1.35s/it] 47%|████▋     | 222/471 [04:53<05:35,  1.35s/it] 47%|████▋     | 223/471 [04:55<05:33,  1.35s/it] 48%|████▊     | 224/471 [04:56<05:32,  1.35s/it] 48%|████▊     | 225/471 [04:57<05:31,  1.35s/it] 48%|████▊     | 226/471 [04:59<05:30,  1.35s/it] 48%|████▊     | 227/471 [05:00<05:28,  1.35s/it] 48%|████▊     | 228/471 [05:01<05:27,  1.35s/it] 49%|████▊     | 229/471 [05:03<05:26,  1.35s/it] 49%|████▉     | 230/471 [05:04<05:25,  1.35s/it] 49%|████▉     | 231/471 [05:05<05:23,  1.35s/it] 49%|████▉     | 232/471 [05:07<05:22,  1.35s/it] 49%|████▉     | 233/471 [05:08<05:20,  1.35s/it] 50%|████▉     | 234/471 [05:09<05:20,  1.35s/it] 50%|████▉     | 235/471 [05:11<05:19,  1.35s/it] 50%|█████     | 236/471 [05:12<05:17,  1.35s/it] 50%|█████     | 237/471 [05:13<05:16,  1.35s/it] 51%|█████     | 238/471 [05:15<05:14,  1.35s/it] 51%|█████     | 239/471 [05:16<05:13,  1.35s/it] 51%|█████     | 240/471 [05:18<05:12,  1.35s/it] 51%|█████     | 241/471 [05:19<05:10,  1.35s/it] 51%|█████▏    | 242/471 [05:20<05:09,  1.35s/it] 52%|█████▏    | 243/471 [05:22<05:07,  1.35s/it] 52%|█████▏    | 244/471 [05:23<05:06,  1.35s/it] 52%|█████▏    | 245/471 [05:24<05:05,  1.35s/it] 52%|█████▏    | 246/471 [05:26<05:03,  1.35s/it] 52%|█████▏    | 247/471 [05:27<05:02,  1.35s/it] 53%|█████▎    | 248/471 [05:28<05:00,  1.35s/it] 53%|█████▎    | 249/471 [05:30<04:59,  1.35s/it] 53%|█████▎    | 250/471 [05:31<04:58,  1.35s/it] 53%|█████▎    | 251/471 [05:32<04:57,  1.35s/it] 54%|█████▎    | 252/471 [05:34<04:55,  1.35s/it] 54%|█████▎    | 253/471 [05:35<04:54,  1.35s/it] 54%|█████▍    | 254/471 [05:36<04:53,  1.35s/it] 54%|█████▍    | 255/471 [05:38<04:51,  1.35s/it] 54%|█████▍    | 256/471 [05:39<04:50,  1.35s/it] 55%|█████▍    | 257/471 [05:40<04:49,  1.35s/it] 55%|█████▍    | 258/471 [05:42<04:47,  1.35s/it] 55%|█████▍    | 259/471 [05:43<04:46,  1.35s/it] 55%|█████▌    | 260/471 [05:45<04:45,  1.35s/it] 55%|█████▌    | 261/471 [05:46<04:43,  1.35s/it] 56%|█████▌    | 262/471 [05:47<04:41,  1.35s/it] 56%|█████▌    | 263/471 [05:49<04:40,  1.35s/it] 56%|█████▌    | 264/471 [05:50<04:39,  1.35s/it] 56%|█████▋    | 265/471 [05:51<04:37,  1.35s/it] 56%|█████▋    | 266/471 [05:53<04:36,  1.35s/it] 57%|█████▋    | 267/471 [05:54<04:35,  1.35s/it] 57%|█████▋    | 268/471 [05:55<04:33,  1.35s/it] 57%|█████▋    | 269/471 [05:57<04:32,  1.35s/it] 57%|█████▋    | 270/471 [05:58<04:30,  1.35s/it] 58%|█████▊    | 271/471 [05:59<04:29,  1.35s/it] 58%|█████▊    | 272/471 [06:01<04:27,  1.34s/it] 58%|█████▊    | 273/471 [06:02<04:26,  1.34s/it] 58%|█████▊    | 274/471 [06:03<04:24,  1.34s/it] 58%|█████▊    | 275/471 [06:05<04:23,  1.34s/it] 59%|█████▊    | 276/471 [06:06<04:22,  1.35s/it] 59%|█████▉    | 277/471 [06:07<04:21,  1.35s/it] 59%|█████▉    | 278/471 [06:09<04:20,  1.35s/it] 59%|█████▉    | 279/471 [06:10<04:18,  1.35s/it] 59%|█████▉    | 280/471 [06:11<04:16,  1.34s/it] 60%|█████▉    | 281/471 [06:13<04:15,  1.34s/it] 60%|█████▉    | 282/471 [06:14<04:14,  1.34s/it] 60%|██████    | 283/471 [06:16<04:12,  1.34s/it] 60%|██████    | 284/471 [06:17<04:11,  1.34s/it] 61%|██████    | 285/471 [06:18<04:10,  1.34s/it] 61%|██████    | 286/471 [06:20<04:08,  1.35s/it] 61%|██████    | 287/471 [06:21<04:07,  1.35s/it] 61%|██████    | 288/471 [06:22<04:06,  1.35s/it] 61%|██████▏   | 289/471 [06:24<04:04,  1.34s/it] 62%|██████▏   | 290/471 [06:25<04:02,  1.34s/it] 62%|██████▏   | 291/471 [06:26<04:01,  1.34s/it] 62%|██████▏   | 292/471 [06:28<03:59,  1.34s/it] 62%|██████▏   | 293/471 [06:29<03:58,  1.34s/it] 62%|██████▏   | 294/471 [06:30<03:56,  1.34s/it] 63%|██████▎   | 295/471 [06:32<03:55,  1.34s/it] 63%|██████▎   | 296/471 [06:33<03:53,  1.34s/it] 63%|██████▎   | 297/471 [06:34<03:52,  1.34s/it] 63%|██████▎   | 298/471 [06:36<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:37<03:50,  1.34s/it] 64%|██████▎   | 300/471 [06:38<03:49,  1.34s/it] 64%|██████▍   | 301/471 [06:40<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:41<03:45,  1.34s/it] 64%|██████▍   | 303/471 [06:42<03:44,  1.34s/it] 65%|██████▍   | 304/471 [06:44<03:42,  1.33s/it] 65%|██████▍   | 305/471 [06:45<03:41,  1.33s/it] 65%|██████▍   | 306/471 [06:46<03:40,  1.34s/it] 65%|██████▌   | 307/471 [06:48<03:39,  1.34s/it] 65%|██████▌   | 308/471 [06:49<03:38,  1.34s/it] 66%|██████▌   | 309/471 [06:50<03:36,  1.34s/it] 66%|██████▌   | 310/471 [06:52<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:53<03:33,  1.34s/it] 66%|██████▌   | 312/471 [06:54<03:32,  1.34s/it] 66%|██████▋   | 313/471 [06:56<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:57<03:29,  1.33s/it] 67%|██████▋   | 315/471 [06:58<03:28,  1.33s/it] 67%|██████▋   | 316/471 [07:00<03:26,  1.33s/it] 67%|██████▋   | 317/471 [07:01<03:25,  1.33s/it] 68%|██████▊   | 318/471 [07:02<03:24,  1.33s/it] 68%|██████▊   | 319/471 [07:04<03:22,  1.34s/it] 68%|██████▊   | 320/471 [07:05<03:21,  1.33s/it] 68%|██████▊   | 321/471 [07:06<03:20,  1.33s/it] 68%|██████▊   | 322/471 [07:08<03:18,  1.33s/it] 69%|██████▊   | 323/471 [07:09<03:17,  1.34s/it] 69%|██████▉   | 324/471 [07:10<03:16,  1.34s/it] 69%|██████▉   | 325/471 [07:12<03:14,  1.34s/it] 69%|██████▉   | 326/471 [07:13<03:13,  1.33s/it] 69%|██████▉   | 327/471 [07:14<03:11,  1.33s/it] 70%|██████▉   | 328/471 [07:16<03:10,  1.33s/it] 70%|██████▉   | 329/471 [07:17<03:09,  1.33s/it] 70%|███████   | 330/471 [07:18<03:07,  1.33s/it] 70%|███████   | 331/471 [07:20<03:06,  1.33s/it] 70%|███████   | 332/471 [07:21<03:05,  1.33s/it] 71%|███████   | 333/471 [07:22<03:03,  1.33s/it] 71%|███████   | 334/471 [07:24<03:02,  1.33s/it] 71%|███████   | 335/471 [07:25<03:01,  1.33s/it] 71%|███████▏  | 336/471 [07:26<03:00,  1.33s/it] 72%|███████▏  | 337/471 [07:28<02:58,  1.33s/it] 72%|███████▏  | 338/471 [07:29<02:57,  1.33s/it] 72%|███████▏  | 339/471 [07:30<02:56,  1.33s/it] 72%|███████▏  | 340/471 [07:32<02:54,  1.33s/it] 72%|███████▏  | 341/471 [07:33<02:53,  1.33s/it] 73%|███████▎  | 342/471 [07:34<02:51,  1.33s/it] 73%|███████▎  | 343/471 [07:36<02:50,  1.33s/it] 73%|███████▎  | 344/471 [07:37<02:48,  1.33s/it] 73%|███████▎  | 345/471 [07:38<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:40<02:46,  1.33s/it] 74%|███████▎  | 347/471 [07:41<02:44,  1.33s/it] 74%|███████▍  | 348/471 [07:42<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:44<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:45<02:41,  1.33s/it] 75%|███████▍  | 351/471 [07:46<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:48<02:38,  1.33s/it] 75%|███████▍  | 353/471 [07:49<02:37,  1.34s/it] 75%|███████▌  | 354/471 [07:50<02:36,  1.34s/it] 75%|███████▌  | 355/471 [07:52<02:34,  1.34s/it] 76%|███████▌  | 356/471 [07:53<02:33,  1.33s/it] 76%|███████▌  | 357/471 [07:54<02:32,  1.33s/it] 76%|███████▌  | 358/471 [07:56<02:30,  1.34s/it] 76%|███████▌  | 359/471 [07:57<02:29,  1.34s/it] 76%|███████▋  | 360/471 [07:58<02:28,  1.33s/it] 77%|███████▋  | 361/471 [08:00<02:26,  1.33s/it] 77%|███████▋  | 362/471 [08:01<02:25,  1.34s/it] 77%|███████▋  | 363/471 [08:02<02:24,  1.33s/it] 77%|███████▋  | 364/471 [08:04<02:22,  1.33s/it] 77%|███████▋  | 365/471 [08:05<02:21,  1.33s/it] 78%|███████▊  | 366/471 [08:06<02:20,  1.34s/it] 78%|███████▊  | 367/471 [08:08<02:18,  1.34s/it] 78%|███████▊  | 368/471 [08:09<02:17,  1.33s/it] 78%|███████▊  | 369/471 [08:10<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:12<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:13<02:13,  1.33s/it] 79%|███████▉  | 372/471 [08:14<02:12,  1.34s/it] 79%|███████▉  | 373/471 [08:16<02:10,  1.34s/it] 79%|███████▉  | 374/471 [08:17<02:09,  1.33s/it] 80%|███████▉  | 375/471 [08:18<02:08,  1.33s/it] 80%|███████▉  | 376/471 [08:20<02:06,  1.34s/it] 80%|████████  | 377/471 [08:21<02:05,  1.34s/it] 80%|████████  | 378/471 [08:22<02:04,  1.33s/it] 80%|████████  | 379/471 [08:24<02:03,  1.34s/it] 81%|████████  | 380/471 [08:25<02:01,  1.34s/it] 81%|████████  | 381/471 [08:26<02:00,  1.34s/it] 81%|████████  | 382/471 [08:28<01:58,  1.34s/it] 81%|████████▏ | 383/471 [08:29<01:57,  1.34s/it] 82%|████████▏ | 384/471 [08:30<01:56,  1.34s/it] 82%|████████▏ | 385/471 [08:32<01:55,  1.34s/it] 82%|████████▏ | 386/471 [08:33<01:53,  1.34s/it] 82%|████████▏ | 387/471 [08:34<01:52,  1.34s/it] 82%|████████▏ | 388/471 [08:36<01:50,  1.34s/it] 83%|████████▎ | 389/471 [08:37<01:49,  1.34s/it] 83%|████████▎ | 390/471 [08:38<01:48,  1.34s/it] 83%|████████▎ | 391/471 [08:40<01:46,  1.34s/it] 83%|████████▎ | 392/471 [08:41<01:45,  1.34s/it] 83%|████████▎ | 393/471 [08:42<01:44,  1.34s/it] 84%|████████▎ | 394/471 [08:44<01:42,  1.34s/it] 84%|████████▍ | 395/471 [08:45<01:41,  1.34s/it] 84%|████████▍ | 396/471 [08:46<01:40,  1.34s/it] 84%|████████▍ | 397/471 [08:48<01:38,  1.34s/it] 85%|████████▍ | 398/471 [08:49<01:37,  1.34s/it] 85%|████████▍ | 399/471 [08:50<01:36,  1.34s/it] 85%|████████▍ | 400/471 [08:52<01:34,  1.34s/it] 85%|████████▌ | 401/471 [08:53<01:33,  1.34s/it] 85%|████████▌ | 402/471 [08:54<01:32,  1.34s/it] 86%|████████▌ | 403/471 [08:56<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:57<01:29,  1.33s/it] 86%|████████▌ | 405/471 [08:58<01:28,  1.34s/it] 86%|████████▌ | 406/471 [09:00<01:26,  1.33s/it] 86%|████████▋ | 407/471 [09:01<01:25,  1.33s/it] 87%|████████▋ | 408/471 [09:02<01:24,  1.34s/it] 87%|████████▋ | 409/471 [09:04<01:22,  1.34s/it] 87%|████████▋ | 410/471 [09:05<01:21,  1.34s/it] 87%|████████▋ | 411/471 [09:06<01:20,  1.33s/it] 87%|████████▋ | 412/471 [09:08<01:18,  1.34s/it] 88%|████████▊ | 413/471 [09:09<01:17,  1.34s/it] 88%|████████▊ | 414/471 [09:10<01:16,  1.34s/it] 88%|████████▊ | 415/471 [09:12<01:14,  1.34s/it] 88%|████████▊ | 416/471 [09:13<01:13,  1.34s/it] 89%|████████▊ | 417/471 [09:14<01:12,  1.34s/it] 89%|████████▊ | 418/471 [09:16<01:10,  1.34s/it] 89%|████████▉ | 419/471 [09:17<01:09,  1.34s/it] 89%|████████▉ | 420/471 [09:18<01:08,  1.33s/it] 89%|████████▉ | 421/471 [09:20<01:06,  1.34s/it] 90%|████████▉ | 422/471 [09:21<01:05,  1.33s/it] 90%|████████▉ | 423/471 [09:22<01:04,  1.33s/it] 90%|█████████ | 424/471 [09:24<01:02,  1.34s/it] 90%|█████████ | 425/471 [09:25<01:01,  1.33s/it] 90%|█████████ | 426/471 [09:26<01:00,  1.34s/it] 91%|█████████ | 427/471 [09:28<00:58,  1.34s/it] 91%|█████████ | 428/471 [09:29<00:57,  1.34s/it] 91%|█████████ | 429/471 [09:31<00:56,  1.34s/it] 91%|█████████▏| 430/471 [09:32<00:54,  1.34s/it] 92%|█████████▏| 431/471 [09:33<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:35<00:52,  1.34s/it] 92%|█████████▏| 433/471 [09:36<00:50,  1.34s/it] 92%|█████████▏| 434/471 [09:37<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:39<00:48,  1.34s/it] 93%|█████████▎| 436/471 [09:40<00:46,  1.34s/it] 93%|█████████▎| 437/471 [09:41<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:43<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:44<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:45<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:47<00:40,  1.34s/it] 94%|█████████▍| 442/471 [09:48<00:38,  1.34s/it] 94%|█████████▍| 443/471 [09:49<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:51<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:52<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:53<00:33,  1.35s/it] 95%|█████████▍| 447/471 [09:55<00:32,  1.35s/it] 95%|█████████▌| 448/471 [09:56<00:30,  1.34s/it] 95%|█████████▌| 449/471 [09:57<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:59<00:28,  1.35s/it] 96%|█████████▌| 451/471 [10:00<00:26,  1.34s/it] 96%|█████████▌| 452/471 [10:01<00:25,  1.34s/it] 96%|█████████▌| 453/471 [10:03<00:24,  1.35s/it] 96%|█████████▋| 454/471 [10:04<00:22,  1.35s/it] 97%|█████████▋| 455/471 [10:05<00:21,  1.35s/it] 97%|█████████▋| 456/471 [10:07<00:20,  1.35s/it] 97%|█████████▋| 457/471 [10:08<00:18,  1.35s/it] 97%|█████████▋| 458/471 [10:10<00:17,  1.35s/it] 97%|█████████▋| 459/471 [10:11<00:16,  1.35s/it] 98%|█████████▊| 460/471 [10:12<00:14,  1.35s/it] 98%|█████████▊| 461/471 [10:14<00:13,  1.35s/it] 98%|█████████▊| 462/471 [10:15<00:12,  1.35s/it] 98%|█████████▊| 463/471 [10:16<00:10,  1.35s/it] 99%|█████████▊| 464/471 [10:18<00:09,  1.35s/it] 99%|█████████▊| 465/471 [10:19<00:08,  1.35s/it] 99%|█████████▉| 466/471 [10:20<00:06,  1.35s/it] 99%|█████████▉| 467/471 [10:22<00:05,  1.35s/it] 99%|█████████▉| 468/471 [10:23<00:04,  1.35s/it]100%|█████████▉| 469/471 [10:24<00:02,  1.35s/it]100%|█████████▉| 470/471 [10:26<00:01,  1.35s/it]100%|██████████| 471/471 [10:27<00:00,  1.24s/it]100%|██████████| 471/471 [10:27<00:00,  1.33s/it]
{'eval_loss': 3.477860689163208, 'eval_model_preparation_time': 0.0105, 'eval_acc': 0.27124269782262345, 'eval_runtime': 628.4327, 'eval_samples_per_second': 11.985, 'eval_steps_per_second': 0.749}
ROUND:12
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 3.2537, 'grad_norm': 9.662450790405273, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 2.3015, 'grad_norm': 11.044342041015625, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.4043, 'grad_norm': 11.953170776367188, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.4751, 'grad_norm': 17.986024856567383, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 1.3423, 'grad_norm': 6.714181900024414, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 1.7031, 'grad_norm': 13.552754402160645, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 3.5078, 'grad_norm': 21.807750701904297, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 1.7511, 'grad_norm': 63.39830780029297, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 0.6434, 'grad_norm': 31.926563262939453, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 1.1559, 'grad_norm': 11.513822555541992, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 1.7752, 'grad_norm': 10.58142375946045, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 0.1836, 'grad_norm': 3.903499126434326, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.776, 'grad_norm': 21.407596588134766, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 1.6466, 'grad_norm': 8.653316497802734, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 1.6207, 'grad_norm': 8.957242965698242, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 2.0605, 'grad_norm': 46.894893646240234, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.8321, 'grad_norm': 106.81336975097656, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.4789, 'grad_norm': 26.463546752929688, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.00s/it]                                               {'loss': 1.0206, 'grad_norm': 13.432140350341797, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.4877, 'grad_norm': 5.8593597412109375, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.7207, 'grad_norm': 7.374783515930176, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.954, 'grad_norm': 7.17824649810791, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.9318, 'grad_norm': 11.962786674499512, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 0.0017431974411010742, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it]                                               {'loss': 0.5266, 'grad_norm': 6.7247138023376465, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.4918, 'grad_norm': 3.5621225833892822, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it]                                               {'loss': 0.3812, 'grad_norm': 4.552516460418701, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.8326, 'grad_norm': 8.817375183105469, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.7652, 'grad_norm': 8.281660079956055, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.6047, 'grad_norm': 10.50454330444336, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.19s/it]                                               {'loss': 0.8844, 'grad_norm': 8.928540229797363, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.19s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.3824, 'grad_norm': 14.726371765136719, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it]                                               {'loss': 0.5424, 'grad_norm': 13.235549926757812, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.436, 'grad_norm': 5.9886980056762695, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.4322, 'grad_norm': 27.28902816772461, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.6461, 'grad_norm': 8.898148536682129, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.2986, 'grad_norm': 3.8425073623657227, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.3821, 'grad_norm': 4.695107460021973, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.4554, 'grad_norm': 16.58620834350586, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0757, 'grad_norm': 5.801470756530762, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.5654, 'train_samples_per_second': 7.101, 'train_steps_per_second': 0.503, 'train_loss': 1.0290948323789053, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:84
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.56, 'grad_norm': 9.618932723999023, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.3503, 'grad_norm': 7.786559104919434, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 3.086, 'grad_norm': 16.78140640258789, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.4072, 'grad_norm': 10.218055725097656, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 2.1688, 'grad_norm': 13.21450138092041, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 1.4097, 'grad_norm': 17.865522384643555, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.6798, 'grad_norm': 10.621349334716797, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 5.0984, 'grad_norm': 58.154048919677734, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.7105, 'grad_norm': 15.576970100402832, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.0349, 'grad_norm': 4.809249401092529, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.3185, 'grad_norm': 3.7885384559631348, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.0869, 'grad_norm': 7.845069408416748, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.9181, 'grad_norm': 6.03342342376709, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.2263, 'grad_norm': 3.7747550010681152, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 0.6739, 'grad_norm': 5.1053786277771, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0006, 'grad_norm': 0.030781468376517296, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.303, 'grad_norm': 3.137834310531616, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.2043, 'grad_norm': 1.6114546060562134, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.0508, 'grad_norm': 0.8148627877235413, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.7588, 'grad_norm': 2.988741159439087, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.2645, 'grad_norm': 4.565362453460693, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.3659, 'grad_norm': 4.7172932624816895, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.345, 'grad_norm': 2.997896671295166, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0075, 'grad_norm': 0.44788873195648193, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.041, 'grad_norm': 0.45454466342926025, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.2446, 'grad_norm': 1.910993218421936, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.1561, 'grad_norm': 2.3143393993377686, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.6132, 'grad_norm': 5.59411096572876, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.0441, 'grad_norm': 0.9096460342407227, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.3665, 'grad_norm': 1.2457026243209839, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0401, 'grad_norm': 1.2415887117385864, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0092, 'grad_norm': 0.3024388551712036, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0333, 'grad_norm': 0.5278059244155884, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.0204, 'grad_norm': 0.3537454307079315, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it]                                               {'loss': 0.247, 'grad_norm': 4.534672737121582, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.3588, 'grad_norm': 3.671185255050659, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.2015, 'grad_norm': 2.1393442153930664, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1168, 'grad_norm': 1.5824719667434692, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0551, 'grad_norm': 1.2945095300674438, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.5983, 'grad_norm': 22.45265007019043, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2149, 'train_samples_per_second': 7.132, 'train_steps_per_second': 0.505, 'train_loss': 0.75439815553691, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 3.4837, 'grad_norm': 12.803569793701172, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]                                              {'loss': 2.369, 'grad_norm': 12.60406494140625, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 3.0068, 'grad_norm': 15.034688949584961, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:19,  2.21s/it]                                              {'loss': 1.7366, 'grad_norm': 15.06658935546875, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it]                                              {'loss': 1.1117, 'grad_norm': 8.454496383666992, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it]                                              {'loss': 2.3718, 'grad_norm': 15.697539329528809, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.23s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 1.6254, 'grad_norm': 20.798830032348633, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 3.3989, 'grad_norm': 55.693084716796875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 0.9948, 'grad_norm': 8.671814918518066, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 0.978, 'grad_norm': 5.825744152069092, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.8766, 'grad_norm': 6.286004066467285, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.678, 'grad_norm': 5.615018367767334, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 0.5728, 'grad_norm': 6.97574520111084, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it]                                               {'loss': 0.6784, 'grad_norm': 7.339931488037109, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.21s/it]                                               {'loss': 0.1515, 'grad_norm': 2.4476850032806396, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.21s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 0.0004, 'grad_norm': 0.022054411470890045, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it]                                               {'loss': 0.3902, 'grad_norm': 3.72379207611084, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it]                                               {'loss': 0.2382, 'grad_norm': 3.3412845134735107, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.5652, 'grad_norm': 2.8314566612243652, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:42,  2.11s/it]                                               {'loss': 0.2085, 'grad_norm': 1.9655669927597046, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.17s/it]                                               {'loss': 0.1228, 'grad_norm': 2.403635025024414, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.17s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.20s/it]                                               {'loss': 0.4475, 'grad_norm': 2.2446069717407227, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.20s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.22s/it]                                               {'loss': 0.1599, 'grad_norm': 1.8687777519226074, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.22s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 0.0063, 'grad_norm': 0.4756535589694977, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:50<00:27,  1.82s/it]                                               {'loss': 0.058, 'grad_norm': 0.6060548424720764, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:27,  1.82s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.96s/it]                                               {'loss': 0.3875, 'grad_norm': 3.6663572788238525, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.96s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.07s/it]                                               {'loss': 0.0795, 'grad_norm': 1.9304953813552856, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.07s/it] 70%|███████   | 28/40 [00:56<00:25,  2.13s/it]                                               {'loss': 0.1668, 'grad_norm': 2.1514623165130615, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.13s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.17s/it]                                               {'loss': 0.0422, 'grad_norm': 0.5815542936325073, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.17s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it]                                               {'loss': 0.9094, 'grad_norm': 6.474495887756348, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.1132, 'grad_norm': 2.8305232524871826, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.027, 'grad_norm': 1.9004294872283936, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.80s/it]                                               {'loss': 0.0426, 'grad_norm': 0.920911431312561, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it]                                               {'loss': 0.0122, 'grad_norm': 0.19889548420906067, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.3631, 'grad_norm': 4.614684581756592, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.12s/it]                                               {'loss': 0.0436, 'grad_norm': 0.8598599433898926, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it]                                               {'loss': 0.0516, 'grad_norm': 1.206687092781067, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.22s/it]                                               {'loss': 0.0924, 'grad_norm': 1.8866233825683594, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.22s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.25s/it]                                               {'loss': 0.0496, 'grad_norm': 0.9520093202590942, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.25s/it]100%|██████████| 40/40 [01:20<00:00,  1.63s/it]                                               {'loss': 0.025, 'grad_norm': 1.3828433752059937, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.63s/it]                                               {'train_runtime': 80.4117, 'train_samples_per_second': 7.026, 'train_steps_per_second': 0.497, 'train_loss': 0.7159213997401821, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.63s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:81
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 1.9104, 'grad_norm': 7.002825736999512, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 1.7722, 'grad_norm': 12.780929565429688, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 1.9895, 'grad_norm': 11.959782600402832, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.563, 'grad_norm': 10.875164031982422, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it]                                              {'loss': 1.8423, 'grad_norm': 15.544812202453613, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 1.8732, 'grad_norm': 13.297513961791992, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.6991, 'grad_norm': 22.155609130859375, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 6.5493, 'grad_norm': 66.85843658447266, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 4.1147, 'grad_norm': 44.23716735839844, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 0.9913, 'grad_norm': 10.652828216552734, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.6463, 'grad_norm': 10.728306770324707, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.1217, 'grad_norm': 11.322792053222656, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.1377, 'grad_norm': 7.874092102050781, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.9442, 'grad_norm': 18.963064193725586, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.2235, 'grad_norm': 4.887942790985107, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0001, 'grad_norm': 0.011256872676312923, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 1.1509, 'grad_norm': 11.43505573272705, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.7201, 'grad_norm': 13.393620491027832, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.705, 'grad_norm': 6.7165021896362305, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.2269, 'grad_norm': 4.222051620483398, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.6375, 'grad_norm': 8.562490463256836, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it]                                               {'loss': 0.5454, 'grad_norm': 5.9396891593933105, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.18s/it]                                               {'loss': 0.4105, 'grad_norm': 32.127586364746094, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.0071, 'grad_norm': 0.4561725854873657, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.3661, 'grad_norm': 6.690435409545898, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.0612, 'grad_norm': 2.1502628326416016, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.0593, 'grad_norm': 1.2517341375350952, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.3492, 'grad_norm': 2.697530746459961, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.2001, 'grad_norm': 7.686086177825928, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.4099, 'grad_norm': 9.211054801940918, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.3626, 'grad_norm': 26.250253677368164, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0361, 'grad_norm': 1.4896111488342285, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.1504, 'grad_norm': 5.373392105102539, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.3978, 'grad_norm': 3.9319565296173096, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0369, 'grad_norm': 1.084344506263733, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it]                                               {'loss': 0.2115, 'grad_norm': 10.396389961242676, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.5898, 'grad_norm': 15.611246109008789, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0378, 'grad_norm': 0.9044157266616821, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0388, 'grad_norm': 1.364751935005188, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0404, 'grad_norm': 1.9575287103652954, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.4269, 'train_samples_per_second': 7.113, 'train_steps_per_second': 0.504, 'train_loss': 0.8782449324964545, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 4.4546, 'grad_norm': 12.160592079162598, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 1.885, 'grad_norm': 13.573275566101074, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 2.3535, 'grad_norm': 12.874494552612305, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.17s/it]                                              {'loss': 2.0224, 'grad_norm': 12.945921897888184, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.0268, 'grad_norm': 13.626546859741211, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 2.6181, 'grad_norm': 23.442276000976562, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 0.8402, 'grad_norm': 9.942058563232422, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 3.4081, 'grad_norm': 63.8907585144043, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.6874, 'grad_norm': 6.897637367248535, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.4023, 'grad_norm': 4.671366214752197, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.2897, 'grad_norm': 8.063695907592773, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.7042, 'grad_norm': 5.482508659362793, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.7487, 'grad_norm': 7.216925144195557, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.1432, 'grad_norm': 9.02354621887207, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.7231, 'grad_norm': 6.335050582885742, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 3.3765, 'grad_norm': 53.65877151489258, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.91, 'grad_norm': 10.827873229980469, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.2611, 'grad_norm': 2.597879648208618, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.3099, 'grad_norm': 3.105536460876465, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.5049, 'grad_norm': 4.121491432189941, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.1364, 'grad_norm': 2.0477211475372314, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.1538, 'grad_norm': 2.2852320671081543, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.2772, 'grad_norm': 1.8024098873138428, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.045, 'grad_norm': 2.9287185668945312, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.3799, 'grad_norm': 2.980740785598755, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.1627, 'grad_norm': 2.707522392272949, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.0679, 'grad_norm': 1.1911938190460205, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.1039, 'grad_norm': 3.7441599369049072, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.2479, 'grad_norm': 1.8093138933181763, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.1469, 'grad_norm': 1.2662525177001953, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.2935, 'grad_norm': 5.7569169998168945, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0028, 'grad_norm': 0.2195306271314621, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0587, 'grad_norm': 1.9362951517105103, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.289, 'grad_norm': 2.835660696029663, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0199, 'grad_norm': 0.4564468562602997, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0217, 'grad_norm': 0.6742036938667297, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0403, 'grad_norm': 1.0284266471862793, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.1524, 'grad_norm': 0.9894554615020752, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.3354, 'grad_norm': 1.5792933702468872, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0175, 'grad_norm': 1.0296125411987305, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.7461, 'train_samples_per_second': 7.175, 'train_steps_per_second': 0.508, 'train_loss': 0.8405595963879022, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]                                              {'loss': 5.327, 'grad_norm': 14.371784210205078, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.15s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.8865, 'grad_norm': 9.55361270904541, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 3.2688, 'grad_norm': 15.070317268371582, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.3871, 'grad_norm': 8.504100799560547, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 2.5363, 'grad_norm': 20.316951751708984, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.0352, 'grad_norm': 14.648175239562988, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.3985, 'grad_norm': 16.688785552978516, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.0, 'grad_norm': 0.003081308212131262, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.3514, 'grad_norm': 10.850175857543945, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.122, 'grad_norm': 18.27454948425293, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.162, 'grad_norm': 7.950677394866943, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.4044, 'grad_norm': 4.360952854156494, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.4264, 'grad_norm': 3.511186361312866, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it]                                               {'loss': 0.7663, 'grad_norm': 5.606568336486816, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it]                                               {'loss': 0.5814, 'grad_norm': 4.9099907875061035, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0366, 'grad_norm': 2.112797498703003, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.2499, 'grad_norm': 4.2493672370910645, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.3926, 'grad_norm': 7.192902565002441, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it]                                               {'loss': 0.5284, 'grad_norm': 4.8103203773498535, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.3753, 'grad_norm': 3.5788819789886475, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.4083, 'grad_norm': 3.271256446838379, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it]                                               {'loss': 0.173, 'grad_norm': 2.4337191581726074, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.3202, 'grad_norm': 2.6494014263153076, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0025, 'grad_norm': 0.1307576596736908, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.1364, 'grad_norm': 1.5828227996826172, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.076, 'grad_norm': 1.2616310119628906, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0712, 'grad_norm': 0.7146685719490051, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.028, 'grad_norm': 0.6970138549804688, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.104, 'grad_norm': 1.799932837486267, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.1753, 'grad_norm': 2.2517552375793457, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0806, 'grad_norm': 1.9120683670043945, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 1.0753, 'grad_norm': 13.991026878356934, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0185, 'grad_norm': 0.31950047612190247, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.0446, 'grad_norm': 0.8159946799278259, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.1146, 'grad_norm': 4.704747200012207, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0149, 'grad_norm': 0.3114403486251831, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.0619, 'grad_norm': 2.907362222671509, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.02, 'grad_norm': 0.2990054190158844, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.267, 'grad_norm': 8.366625785827637, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0095, 'grad_norm': 0.32071995735168457, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.1439, 'train_samples_per_second': 7.139, 'train_steps_per_second': 0.505, 'train_loss': 0.7609552590531166, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:36
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 3.4377, 'grad_norm': 6.746083736419678, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:23,  2.20s/it]                                              {'loss': 2.549, 'grad_norm': 9.803948402404785, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.20s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 2.3175, 'grad_norm': 10.426448822021484, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.6297, 'grad_norm': 8.500167846679688, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 4.0575, 'grad_norm': 22.227251052856445, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.1902, 'grad_norm': 16.8328857421875, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.8964, 'grad_norm': 9.045291900634766, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.0102, 'grad_norm': 1.2745016813278198, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.2382, 'grad_norm': 7.879964828491211, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.9125, 'grad_norm': 6.028438568115234, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.5004, 'grad_norm': 6.967002868652344, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.7327, 'grad_norm': 3.810873031616211, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 1.163, 'grad_norm': 4.474275588989258, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.3786, 'grad_norm': 4.182486057281494, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it]                                               {'loss': 0.5046, 'grad_norm': 6.109052658081055, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0002, 'grad_norm': 0.008762125857174397, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.1502, 'grad_norm': 2.3921382427215576, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.4865, 'grad_norm': 4.61427116394043, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.9714, 'grad_norm': 7.335755825042725, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.0596, 'grad_norm': 0.6394562721252441, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.1001, 'grad_norm': 1.010757327079773, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.1995, 'grad_norm': 5.922635555267334, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.5113, 'grad_norm': 2.3066482543945312, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.0214, 'grad_norm': 0.9526687860488892, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.1475, 'grad_norm': 1.1372902393341064, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.3854, 'grad_norm': 4.443408012390137, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.2655, 'grad_norm': 5.234164714813232, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1222, 'grad_norm': 1.2277343273162842, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.0598, 'grad_norm': 2.3134095668792725, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0256, 'grad_norm': 0.4648589789867401, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.2121, 'grad_norm': 3.8961427211761475, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 0.0004809046513400972, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.4752, 'grad_norm': 5.43295955657959, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.2233, 'grad_norm': 5.698408603668213, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it]                                               {'loss': 0.215, 'grad_norm': 2.697296142578125, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1083, 'grad_norm': 2.46138596534729, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0853, 'grad_norm': 1.9496169090270996, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.6001, 'grad_norm': 3.4274861812591553, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0654, 'grad_norm': 1.1142433881759644, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0082, 'grad_norm': 0.40835222601890564, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.9127, 'train_samples_per_second': 7.16, 'train_steps_per_second': 0.507, 'train_loss': 0.7504277591930532, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.6544, 'grad_norm': 9.021413803100586, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 1.5347, 'grad_norm': 8.210125923156738, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 1.8907, 'grad_norm': 19.350921630859375, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 2.3253, 'grad_norm': 10.861356735229492, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 1.6893, 'grad_norm': 10.67431926727295, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 2.2196, 'grad_norm': 12.048728942871094, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 1.7423, 'grad_norm': 12.634173393249512, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 6.7241, 'grad_norm': 54.624107360839844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 0.7602, 'grad_norm': 8.186158180236816, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 0.4739, 'grad_norm': 5.121687412261963, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 0.6431, 'grad_norm': 8.01732349395752, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.9505, 'grad_norm': 9.207199096679688, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.4863, 'grad_norm': 6.089340686798096, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.6366, 'grad_norm': 8.002208709716797, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 0.9376, 'grad_norm': 6.1113200187683105, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 0.4249, 'grad_norm': 14.831175804138184, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it]                                               {'loss': 0.2713, 'grad_norm': 4.8079938888549805, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.1204, 'grad_norm': 1.8267180919647217, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.4867, 'grad_norm': 4.48178768157959, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.2367, 'grad_norm': 2.5526349544525146, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.4005, 'grad_norm': 4.635470390319824, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.3163, 'grad_norm': 4.9126386642456055, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.1488, 'grad_norm': 3.306823253631592, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.0902, 'grad_norm': 3.0611202716827393, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.1773, 'grad_norm': 7.178934574127197, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.3878, 'grad_norm': 4.289921760559082, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0915, 'grad_norm': 1.6580299139022827, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.1307, 'grad_norm': 1.16273832321167, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.1422, 'grad_norm': 1.911249041557312, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.5377, 'grad_norm': 5.431942462921143, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.2174, 'grad_norm': 3.1891286373138428, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0185, 'grad_norm': 1.128903865814209, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0228, 'grad_norm': 0.4614889323711395, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.0282, 'grad_norm': 0.7880355715751648, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0531, 'grad_norm': 0.7256063222885132, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0634, 'grad_norm': 1.987329363822937, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0232, 'grad_norm': 0.7091727256774902, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 0.1804, 'grad_norm': 7.69546365737915, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.5833, 'grad_norm': 3.7651453018188477, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0743, 'grad_norm': 2.2437806129455566, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.4538, 'train_samples_per_second': 7.202, 'train_steps_per_second': 0.51, 'train_loss': 0.7724109520670026, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:69
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 4.2308, 'grad_norm': 8.748878479003906, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 3.7353, 'grad_norm': 11.78427791595459, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.1326, 'grad_norm': 8.88305950164795, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 1.7502, 'grad_norm': 11.320600509643555, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it]                                              {'loss': 1.5968, 'grad_norm': 12.216647148132324, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.4285, 'grad_norm': 16.734838485717773, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.939, 'grad_norm': 9.994183540344238, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 3.3115, 'grad_norm': 11.210244178771973, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.0243, 'grad_norm': 7.6115946769714355, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.3029, 'grad_norm': 5.5039167404174805, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.5604, 'grad_norm': 4.2679924964904785, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 1.0203, 'grad_norm': 9.81574535369873, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.0373, 'grad_norm': 5.5864386558532715, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it]                                               {'loss': 0.4265, 'grad_norm': 3.3819565773010254, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.8189, 'grad_norm': 6.361893177032471, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.58s/it]                                               {'loss': 0.3366, 'grad_norm': 9.920571327209473, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.78s/it]                                               {'loss': 0.2818, 'grad_norm': 2.926724672317505, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 0.3058, 'grad_norm': 2.1032066345214844, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.1822, 'grad_norm': 2.1133291721343994, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.1571, 'grad_norm': 2.23923397064209, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.6902, 'grad_norm': 6.7513322830200195, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.5537, 'grad_norm': 4.567004680633545, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.3287, 'grad_norm': 5.789269924163818, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.8755, 'grad_norm': 22.632295608520508, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.2005, 'grad_norm': 1.7228707075119019, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0693, 'grad_norm': 1.6016780138015747, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.5177, 'grad_norm': 5.035914421081543, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:56<00:25,  2.08s/it]                                               {'loss': 0.1376, 'grad_norm': 2.857337713241577, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.1718, 'grad_norm': 15.418510437011719, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0419, 'grad_norm': 0.6350118517875671, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it]                                               {'loss': 0.0501, 'grad_norm': 0.7257047295570374, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0216, 'grad_norm': 0.7374158501625061, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0754, 'grad_norm': 6.189414024353027, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.038, 'grad_norm': 0.6845772862434387, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.1379, 'grad_norm': 5.26295804977417, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it]                                               {'loss': 0.2837, 'grad_norm': 5.881760120391846, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.2732, 'grad_norm': 29.49909019470215, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.18, 'grad_norm': 1.2692009210586548, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.2364, 'grad_norm': 4.4845356941223145, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0251, 'grad_norm': 0.9953800439834595, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.4087, 'train_samples_per_second': 7.115, 'train_steps_per_second': 0.504, 'train_loss': 0.8371796982828528, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:65
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 1.4304, 'grad_norm': 7.993513584136963, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.3346, 'grad_norm': 8.433783531188965, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 2.0679, 'grad_norm': 8.33755111694336, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.6655, 'grad_norm': 8.994199752807617, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 1.086, 'grad_norm': 9.177567481994629, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.3208, 'grad_norm': 16.625436782836914, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 2.6353, 'grad_norm': 20.053476333618164, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 7.0051, 'grad_norm': 95.31791687011719, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.457, 'grad_norm': 5.978849411010742, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.5185, 'grad_norm': 3.278303384780884, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 0.2365, 'grad_norm': 2.784905195236206, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.7158, 'grad_norm': 7.891706943511963, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.7534, 'grad_norm': 2.838253974914551, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.219, 'grad_norm': 2.7578928470611572, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.6383, 'grad_norm': 4.386918544769287, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.1266, 'grad_norm': 6.18839693069458, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.239, 'grad_norm': 4.912318229675293, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.1943, 'grad_norm': 1.8042153120040894, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.522, 'grad_norm': 2.317570209503174, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.3376, 'grad_norm': 3.44523286819458, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.2791, 'grad_norm': 4.296787261962891, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.2398, 'grad_norm': 3.956298828125, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it]                                               {'loss': 0.0824, 'grad_norm': 2.0542776584625244, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.4004, 'grad_norm': 17.003650665283203, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.0868, 'grad_norm': 3.106534957885742, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.6258, 'grad_norm': 7.538017272949219, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0815, 'grad_norm': 1.1179746389389038, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1115, 'grad_norm': 4.165998458862305, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.143, 'grad_norm': 3.048985719680786, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0227, 'grad_norm': 0.4197242856025696, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.067, 'grad_norm': 0.9985871315002441, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0389, 'grad_norm': 0.8530511260032654, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.278, 'grad_norm': 3.2465171813964844, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.1394, 'grad_norm': 3.452821969985962, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0361, 'grad_norm': 1.2311238050460815, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0461, 'grad_norm': 0.634811520576477, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.045, 'grad_norm': 0.8213350176811218, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1841, 'grad_norm': 0.8319764733314514, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.1327, 'grad_norm': 7.666806697845459, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0001, 'grad_norm': 0.005492749623954296, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.8297, 'train_samples_per_second': 7.167, 'train_steps_per_second': 0.507, 'train_loss': 0.713599794624497, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:56,  1.58it/s]  1%|          | 3/471 [00:02<06:58,  1.12it/s]  1%|          | 4/471 [00:03<08:04,  1.04s/it]  1%|          | 5/471 [00:05<08:41,  1.12s/it]  1%|▏         | 6/471 [00:06<09:04,  1.17s/it]  1%|▏         | 7/471 [00:07<09:19,  1.21s/it]  2%|▏         | 8/471 [00:08<09:29,  1.23s/it]  2%|▏         | 9/471 [00:10<09:35,  1.25s/it]  2%|▏         | 10/471 [00:11<09:38,  1.26s/it]  2%|▏         | 11/471 [00:12<09:40,  1.26s/it]  3%|▎         | 12/471 [00:14<09:42,  1.27s/it]  3%|▎         | 13/471 [00:15<09:44,  1.28s/it]  3%|▎         | 14/471 [00:16<09:44,  1.28s/it]  3%|▎         | 15/471 [00:17<09:43,  1.28s/it]  3%|▎         | 16/471 [00:19<09:44,  1.28s/it]  4%|▎         | 17/471 [00:20<09:43,  1.29s/it]  4%|▍         | 18/471 [00:21<09:43,  1.29s/it]  4%|▍         | 19/471 [00:23<09:42,  1.29s/it]  4%|▍         | 20/471 [00:24<09:42,  1.29s/it]  4%|▍         | 21/471 [00:25<09:41,  1.29s/it]  5%|▍         | 22/471 [00:26<09:41,  1.29s/it]  5%|▍         | 23/471 [00:28<09:40,  1.30s/it]  5%|▌         | 24/471 [00:29<09:40,  1.30s/it]  5%|▌         | 25/471 [00:30<09:39,  1.30s/it]  6%|▌         | 26/471 [00:32<09:38,  1.30s/it]  6%|▌         | 27/471 [00:33<09:37,  1.30s/it]  6%|▌         | 28/471 [00:34<09:36,  1.30s/it]  6%|▌         | 29/471 [00:36<09:36,  1.30s/it]  6%|▋         | 30/471 [00:37<09:36,  1.31s/it]  7%|▋         | 31/471 [00:38<09:35,  1.31s/it]  7%|▋         | 32/471 [00:40<09:34,  1.31s/it]  7%|▋         | 33/471 [00:41<09:31,  1.31s/it]  7%|▋         | 34/471 [00:42<09:31,  1.31s/it]  7%|▋         | 35/471 [00:43<09:31,  1.31s/it]  8%|▊         | 36/471 [00:45<09:30,  1.31s/it]  8%|▊         | 37/471 [00:46<09:30,  1.32s/it]  8%|▊         | 38/471 [00:47<09:30,  1.32s/it]  8%|▊         | 39/471 [00:49<09:28,  1.32s/it]  8%|▊         | 40/471 [00:50<09:27,  1.32s/it]  9%|▊         | 41/471 [00:51<09:27,  1.32s/it]  9%|▉         | 42/471 [00:53<09:27,  1.32s/it]  9%|▉         | 43/471 [00:54<09:25,  1.32s/it]  9%|▉         | 44/471 [00:55<09:24,  1.32s/it] 10%|▉         | 45/471 [00:57<09:24,  1.33s/it] 10%|▉         | 46/471 [00:58<09:23,  1.33s/it] 10%|▉         | 47/471 [00:59<09:22,  1.33s/it] 10%|█         | 48/471 [01:01<09:21,  1.33s/it] 10%|█         | 49/471 [01:02<09:21,  1.33s/it] 11%|█         | 50/471 [01:03<09:20,  1.33s/it] 11%|█         | 51/471 [01:05<09:20,  1.33s/it] 11%|█         | 52/471 [01:06<09:19,  1.34s/it] 11%|█▏        | 53/471 [01:07<09:19,  1.34s/it] 11%|█▏        | 54/471 [01:09<09:18,  1.34s/it] 12%|█▏        | 55/471 [01:10<09:17,  1.34s/it] 12%|█▏        | 56/471 [01:11<09:17,  1.34s/it] 12%|█▏        | 57/471 [01:13<09:16,  1.34s/it] 12%|█▏        | 58/471 [01:14<09:15,  1.34s/it] 13%|█▎        | 59/471 [01:15<09:14,  1.35s/it] 13%|█▎        | 60/471 [01:17<09:12,  1.34s/it] 13%|█▎        | 61/471 [01:18<09:11,  1.35s/it] 13%|█▎        | 62/471 [01:19<09:10,  1.35s/it] 13%|█▎        | 63/471 [01:21<09:08,  1.34s/it] 14%|█▎        | 64/471 [01:22<09:07,  1.35s/it] 14%|█▍        | 65/471 [01:23<09:05,  1.34s/it] 14%|█▍        | 66/471 [01:25<09:04,  1.34s/it] 14%|█▍        | 67/471 [01:26<09:03,  1.35s/it] 14%|█▍        | 68/471 [01:28<09:01,  1.34s/it] 15%|█▍        | 69/471 [01:29<09:00,  1.34s/it] 15%|█▍        | 70/471 [01:30<09:00,  1.35s/it] 15%|█▌        | 71/471 [01:32<08:59,  1.35s/it] 15%|█▌        | 72/471 [01:33<08:57,  1.35s/it] 15%|█▌        | 73/471 [01:34<08:56,  1.35s/it] 16%|█▌        | 74/471 [01:36<08:54,  1.35s/it] 16%|█▌        | 75/471 [01:37<08:53,  1.35s/it] 16%|█▌        | 76/471 [01:38<08:51,  1.35s/it] 16%|█▋        | 77/471 [01:40<08:50,  1.35s/it] 17%|█▋        | 78/471 [01:41<08:48,  1.35s/it] 17%|█▋        | 79/471 [01:42<08:48,  1.35s/it] 17%|█▋        | 80/471 [01:44<08:47,  1.35s/it] 17%|█▋        | 81/471 [01:45<08:45,  1.35s/it] 17%|█▋        | 82/471 [01:46<08:43,  1.35s/it] 18%|█▊        | 83/471 [01:48<08:42,  1.35s/it] 18%|█▊        | 84/471 [01:49<08:40,  1.34s/it] 18%|█▊        | 85/471 [01:50<08:39,  1.35s/it] 18%|█▊        | 86/471 [01:52<08:38,  1.35s/it] 18%|█▊        | 87/471 [01:53<08:36,  1.34s/it] 19%|█▊        | 88/471 [01:54<08:34,  1.34s/it] 19%|█▉        | 89/471 [01:56<08:32,  1.34s/it] 19%|█▉        | 90/471 [01:57<08:32,  1.34s/it] 19%|█▉        | 91/471 [01:58<08:30,  1.34s/it] 20%|█▉        | 92/471 [02:00<08:28,  1.34s/it] 20%|█▉        | 93/471 [02:01<08:27,  1.34s/it] 20%|█▉        | 94/471 [02:03<08:26,  1.34s/it] 20%|██        | 95/471 [02:04<08:24,  1.34s/it] 20%|██        | 96/471 [02:05<08:23,  1.34s/it] 21%|██        | 97/471 [02:07<08:23,  1.35s/it] 21%|██        | 98/471 [02:08<08:20,  1.34s/it] 21%|██        | 99/471 [02:09<08:19,  1.34s/it] 21%|██        | 100/471 [02:11<08:18,  1.34s/it] 21%|██▏       | 101/471 [02:12<08:16,  1.34s/it] 22%|██▏       | 102/471 [02:13<08:16,  1.34s/it] 22%|██▏       | 103/471 [02:15<08:14,  1.34s/it] 22%|██▏       | 104/471 [02:16<08:13,  1.35s/it] 22%|██▏       | 105/471 [02:17<08:12,  1.35s/it] 23%|██▎       | 106/471 [02:19<08:10,  1.34s/it] 23%|██▎       | 107/471 [02:20<08:08,  1.34s/it] 23%|██▎       | 108/471 [02:21<08:07,  1.34s/it] 23%|██▎       | 109/471 [02:23<08:04,  1.34s/it] 23%|██▎       | 110/471 [02:24<08:02,  1.34s/it] 24%|██▎       | 111/471 [02:25<08:01,  1.34s/it] 24%|██▍       | 112/471 [02:27<08:00,  1.34s/it] 24%|██▍       | 113/471 [02:28<07:58,  1.34s/it] 24%|██▍       | 114/471 [02:29<07:57,  1.34s/it] 24%|██▍       | 115/471 [02:31<07:56,  1.34s/it] 25%|██▍       | 116/471 [02:32<07:55,  1.34s/it] 25%|██▍       | 117/471 [02:33<07:53,  1.34s/it] 25%|██▌       | 118/471 [02:35<07:52,  1.34s/it] 25%|██▌       | 119/471 [02:36<07:51,  1.34s/it] 25%|██▌       | 120/471 [02:37<07:50,  1.34s/it] 26%|██▌       | 121/471 [02:39<07:48,  1.34s/it] 26%|██▌       | 122/471 [02:40<07:47,  1.34s/it] 26%|██▌       | 123/471 [02:41<07:46,  1.34s/it] 26%|██▋       | 124/471 [02:43<07:44,  1.34s/it] 27%|██▋       | 125/471 [02:44<07:43,  1.34s/it] 27%|██▋       | 126/471 [02:45<07:41,  1.34s/it] 27%|██▋       | 127/471 [02:47<07:40,  1.34s/it] 27%|██▋       | 128/471 [02:48<07:38,  1.34s/it] 27%|██▋       | 129/471 [02:49<07:36,  1.34s/it] 28%|██▊       | 130/471 [02:51<07:35,  1.34s/it] 28%|██▊       | 131/471 [02:52<07:34,  1.34s/it] 28%|██▊       | 132/471 [02:53<07:33,  1.34s/it] 28%|██▊       | 133/471 [02:55<07:31,  1.34s/it] 28%|██▊       | 134/471 [02:56<07:30,  1.34s/it] 29%|██▊       | 135/471 [02:57<07:29,  1.34s/it] 29%|██▉       | 136/471 [02:59<07:27,  1.34s/it] 29%|██▉       | 137/471 [03:00<07:26,  1.34s/it] 29%|██▉       | 138/471 [03:01<07:25,  1.34s/it] 30%|██▉       | 139/471 [03:03<07:23,  1.34s/it] 30%|██▉       | 140/471 [03:04<07:22,  1.34s/it] 30%|██▉       | 141/471 [03:05<07:20,  1.34s/it] 30%|███       | 142/471 [03:07<07:19,  1.33s/it] 30%|███       | 143/471 [03:08<07:17,  1.33s/it] 31%|███       | 144/471 [03:09<07:16,  1.34s/it] 31%|███       | 145/471 [03:11<07:14,  1.33s/it] 31%|███       | 146/471 [03:12<07:14,  1.34s/it] 31%|███       | 147/471 [03:13<07:13,  1.34s/it] 31%|███▏      | 148/471 [03:15<07:12,  1.34s/it] 32%|███▏      | 149/471 [03:16<07:11,  1.34s/it] 32%|███▏      | 150/471 [03:17<07:10,  1.34s/it] 32%|███▏      | 151/471 [03:19<07:08,  1.34s/it] 32%|███▏      | 152/471 [03:20<07:06,  1.34s/it] 32%|███▏      | 153/471 [03:21<07:05,  1.34s/it] 33%|███▎      | 154/471 [03:23<07:03,  1.34s/it] 33%|███▎      | 155/471 [03:24<07:02,  1.34s/it] 33%|███▎      | 156/471 [03:25<07:00,  1.34s/it] 33%|███▎      | 157/471 [03:27<06:59,  1.34s/it] 34%|███▎      | 158/471 [03:28<06:57,  1.33s/it] 34%|███▍      | 159/471 [03:29<06:56,  1.33s/it] 34%|███▍      | 160/471 [03:31<06:55,  1.34s/it] 34%|███▍      | 161/471 [03:32<06:53,  1.34s/it] 34%|███▍      | 162/471 [03:34<06:52,  1.34s/it] 35%|███▍      | 163/471 [03:35<06:51,  1.34s/it] 35%|███▍      | 164/471 [03:36<06:49,  1.34s/it] 35%|███▌      | 165/471 [03:38<06:48,  1.34s/it] 35%|███▌      | 166/471 [03:39<06:47,  1.34s/it] 35%|███▌      | 167/471 [03:40<06:46,  1.34s/it] 36%|███▌      | 168/471 [03:42<06:44,  1.34s/it] 36%|███▌      | 169/471 [03:43<06:43,  1.34s/it] 36%|███▌      | 170/471 [03:44<06:41,  1.33s/it] 36%|███▋      | 171/471 [03:46<06:40,  1.33s/it] 37%|███▋      | 172/471 [03:47<06:38,  1.33s/it] 37%|███▋      | 173/471 [03:48<06:37,  1.33s/it] 37%|███▋      | 174/471 [03:50<06:35,  1.33s/it] 37%|███▋      | 175/471 [03:51<06:34,  1.33s/it] 37%|███▋      | 176/471 [03:52<06:33,  1.33s/it] 38%|███▊      | 177/471 [03:54<06:32,  1.33s/it] 38%|███▊      | 178/471 [03:55<06:30,  1.33s/it] 38%|███▊      | 179/471 [03:56<06:29,  1.33s/it] 38%|███▊      | 180/471 [03:58<06:27,  1.33s/it] 38%|███▊      | 181/471 [03:59<06:26,  1.33s/it] 39%|███▊      | 182/471 [04:00<06:25,  1.33s/it] 39%|███▉      | 183/471 [04:02<06:23,  1.33s/it] 39%|███▉      | 184/471 [04:03<06:22,  1.33s/it] 39%|███▉      | 185/471 [04:04<06:20,  1.33s/it] 39%|███▉      | 186/471 [04:06<06:19,  1.33s/it] 40%|███▉      | 187/471 [04:07<06:18,  1.33s/it] 40%|███▉      | 188/471 [04:08<06:17,  1.34s/it] 40%|████      | 189/471 [04:10<06:15,  1.33s/it] 40%|████      | 190/471 [04:11<06:14,  1.33s/it] 41%|████      | 191/471 [04:12<06:13,  1.33s/it] 41%|████      | 192/471 [04:14<06:12,  1.33s/it] 41%|████      | 193/471 [04:15<06:09,  1.33s/it] 41%|████      | 194/471 [04:16<06:08,  1.33s/it] 41%|████▏     | 195/471 [04:18<06:07,  1.33s/it] 42%|████▏     | 196/471 [04:19<06:06,  1.33s/it] 42%|████▏     | 197/471 [04:20<06:04,  1.33s/it] 42%|████▏     | 198/471 [04:21<06:02,  1.33s/it] 42%|████▏     | 199/471 [04:23<06:01,  1.33s/it] 42%|████▏     | 200/471 [04:24<06:00,  1.33s/it] 43%|████▎     | 201/471 [04:25<05:58,  1.33s/it] 43%|████▎     | 202/471 [04:27<05:57,  1.33s/it] 43%|████▎     | 203/471 [04:28<05:56,  1.33s/it] 43%|████▎     | 204/471 [04:29<05:54,  1.33s/it] 44%|████▎     | 205/471 [04:31<05:53,  1.33s/it] 44%|████▎     | 206/471 [04:32<05:52,  1.33s/it] 44%|████▍     | 207/471 [04:33<05:51,  1.33s/it] 44%|████▍     | 208/471 [04:35<05:49,  1.33s/it] 44%|████▍     | 209/471 [04:36<05:47,  1.33s/it] 45%|████▍     | 210/471 [04:37<05:46,  1.33s/it] 45%|████▍     | 211/471 [04:39<05:45,  1.33s/it] 45%|████▌     | 212/471 [04:40<05:44,  1.33s/it] 45%|████▌     | 213/471 [04:41<05:43,  1.33s/it] 45%|████▌     | 214/471 [04:43<05:41,  1.33s/it] 46%|████▌     | 215/471 [04:44<05:40,  1.33s/it] 46%|████▌     | 216/471 [04:45<05:39,  1.33s/it] 46%|████▌     | 217/471 [04:47<05:38,  1.33s/it] 46%|████▋     | 218/471 [04:48<05:36,  1.33s/it] 46%|████▋     | 219/471 [04:49<05:35,  1.33s/it] 47%|████▋     | 220/471 [04:51<05:34,  1.33s/it] 47%|████▋     | 221/471 [04:52<05:33,  1.33s/it] 47%|████▋     | 222/471 [04:53<05:30,  1.33s/it] 47%|████▋     | 223/471 [04:55<05:29,  1.33s/it] 48%|████▊     | 224/471 [04:56<05:28,  1.33s/it] 48%|████▊     | 225/471 [04:57<05:27,  1.33s/it] 48%|████▊     | 226/471 [04:59<05:26,  1.33s/it] 48%|████▊     | 227/471 [05:00<05:24,  1.33s/it] 48%|████▊     | 228/471 [05:01<05:23,  1.33s/it] 49%|████▊     | 229/471 [05:03<05:22,  1.33s/it] 49%|████▉     | 230/471 [05:04<05:20,  1.33s/it] 49%|████▉     | 231/471 [05:05<05:19,  1.33s/it] 49%|████▉     | 232/471 [05:07<05:17,  1.33s/it] 49%|████▉     | 233/471 [05:08<05:16,  1.33s/it] 50%|████▉     | 234/471 [05:09<05:15,  1.33s/it] 50%|████▉     | 235/471 [05:11<05:14,  1.33s/it] 50%|█████     | 236/471 [05:12<05:12,  1.33s/it] 50%|█████     | 237/471 [05:13<05:11,  1.33s/it] 51%|█████     | 238/471 [05:15<05:10,  1.33s/it] 51%|█████     | 239/471 [05:16<05:08,  1.33s/it] 51%|█████     | 240/471 [05:17<05:07,  1.33s/it] 51%|█████     | 241/471 [05:19<05:06,  1.33s/it] 51%|█████▏    | 242/471 [05:20<05:05,  1.33s/it] 52%|█████▏    | 243/471 [05:21<05:04,  1.33s/it] 52%|█████▏    | 244/471 [05:23<05:02,  1.33s/it] 52%|█████▏    | 245/471 [05:24<05:01,  1.34s/it] 52%|█████▏    | 246/471 [05:25<05:00,  1.33s/it] 52%|█████▏    | 247/471 [05:27<04:58,  1.33s/it] 53%|█████▎    | 248/471 [05:28<04:57,  1.33s/it] 53%|█████▎    | 249/471 [05:29<04:56,  1.34s/it] 53%|█████▎    | 250/471 [05:31<04:54,  1.33s/it] 53%|█████▎    | 251/471 [05:32<04:53,  1.33s/it] 54%|█████▎    | 252/471 [05:33<04:52,  1.33s/it] 54%|█████▎    | 253/471 [05:35<04:51,  1.34s/it] 54%|█████▍    | 254/471 [05:36<04:49,  1.34s/it] 54%|█████▍    | 255/471 [05:37<04:48,  1.34s/it] 54%|█████▍    | 256/471 [05:39<04:47,  1.34s/it] 55%|█████▍    | 257/471 [05:40<04:46,  1.34s/it] 55%|█████▍    | 258/471 [05:41<04:44,  1.34s/it] 55%|█████▍    | 259/471 [05:43<04:43,  1.34s/it] 55%|█████▌    | 260/471 [05:44<04:42,  1.34s/it] 55%|█████▌    | 261/471 [05:45<04:40,  1.34s/it] 56%|█████▌    | 262/471 [05:47<04:39,  1.34s/it] 56%|█████▌    | 263/471 [05:48<04:38,  1.34s/it] 56%|█████▌    | 264/471 [05:49<04:37,  1.34s/it] 56%|█████▋    | 265/471 [05:51<04:36,  1.34s/it] 56%|█████▋    | 266/471 [05:52<04:35,  1.34s/it] 57%|█████▋    | 267/471 [05:53<04:34,  1.34s/it] 57%|█████▋    | 268/471 [05:55<04:33,  1.34s/it] 57%|█████▋    | 269/471 [05:56<04:31,  1.35s/it] 57%|█████▋    | 270/471 [05:58<04:30,  1.34s/it] 58%|█████▊    | 271/471 [05:59<04:28,  1.34s/it] 58%|█████▊    | 272/471 [06:00<04:27,  1.34s/it] 58%|█████▊    | 273/471 [06:02<04:26,  1.34s/it] 58%|█████▊    | 274/471 [06:03<04:24,  1.34s/it] 58%|█████▊    | 275/471 [06:04<04:23,  1.34s/it] 59%|█████▊    | 276/471 [06:06<04:22,  1.34s/it] 59%|█████▉    | 277/471 [06:07<04:20,  1.35s/it] 59%|█████▉    | 278/471 [06:08<04:19,  1.35s/it] 59%|█████▉    | 279/471 [06:10<04:18,  1.34s/it] 59%|█████▉    | 280/471 [06:11<04:16,  1.34s/it] 60%|█████▉    | 281/471 [06:12<04:15,  1.34s/it] 60%|█████▉    | 282/471 [06:14<04:13,  1.34s/it] 60%|██████    | 283/471 [06:15<04:12,  1.34s/it] 60%|██████    | 284/471 [06:16<04:11,  1.34s/it] 61%|██████    | 285/471 [06:18<04:09,  1.34s/it] 61%|██████    | 286/471 [06:19<04:08,  1.34s/it] 61%|██████    | 287/471 [06:20<04:07,  1.34s/it] 61%|██████    | 288/471 [06:22<04:05,  1.34s/it] 61%|██████▏   | 289/471 [06:23<04:04,  1.34s/it] 62%|██████▏   | 290/471 [06:24<04:02,  1.34s/it] 62%|██████▏   | 291/471 [06:26<04:01,  1.34s/it] 62%|██████▏   | 292/471 [06:27<03:59,  1.34s/it] 62%|██████▏   | 293/471 [06:28<03:58,  1.34s/it] 62%|██████▏   | 294/471 [06:30<03:56,  1.34s/it] 63%|██████▎   | 295/471 [06:31<03:55,  1.34s/it] 63%|██████▎   | 296/471 [06:32<03:53,  1.34s/it] 63%|██████▎   | 297/471 [06:34<03:52,  1.34s/it] 63%|██████▎   | 298/471 [06:35<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:36<03:49,  1.34s/it] 64%|██████▎   | 300/471 [06:38<03:48,  1.34s/it] 64%|██████▍   | 301/471 [06:39<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:40<03:45,  1.33s/it] 64%|██████▍   | 303/471 [06:42<03:43,  1.33s/it] 65%|██████▍   | 304/471 [06:43<03:42,  1.33s/it] 65%|██████▍   | 305/471 [06:44<03:41,  1.33s/it] 65%|██████▍   | 306/471 [06:46<03:40,  1.33s/it] 65%|██████▌   | 307/471 [06:47<03:38,  1.33s/it] 65%|██████▌   | 308/471 [06:48<03:37,  1.34s/it] 66%|██████▌   | 309/471 [06:50<03:36,  1.34s/it] 66%|██████▌   | 310/471 [06:51<03:34,  1.34s/it] 66%|██████▌   | 311/471 [06:52<03:33,  1.34s/it] 66%|██████▌   | 312/471 [06:54<03:32,  1.33s/it] 66%|██████▋   | 313/471 [06:55<03:30,  1.33s/it] 67%|██████▋   | 314/471 [06:56<03:29,  1.33s/it] 67%|██████▋   | 315/471 [06:58<03:27,  1.33s/it] 67%|██████▋   | 316/471 [06:59<03:26,  1.33s/it] 67%|██████▋   | 317/471 [07:00<03:25,  1.33s/it] 68%|██████▊   | 318/471 [07:02<03:23,  1.33s/it] 68%|██████▊   | 319/471 [07:03<03:22,  1.33s/it] 68%|██████▊   | 320/471 [07:04<03:21,  1.33s/it] 68%|██████▊   | 321/471 [07:06<03:19,  1.33s/it] 68%|██████▊   | 322/471 [07:07<03:18,  1.33s/it] 69%|██████▊   | 323/471 [07:08<03:17,  1.33s/it] 69%|██████▉   | 324/471 [07:10<03:16,  1.33s/it] 69%|██████▉   | 325/471 [07:11<03:14,  1.33s/it] 69%|██████▉   | 326/471 [07:12<03:13,  1.33s/it] 69%|██████▉   | 327/471 [07:14<03:11,  1.33s/it] 70%|██████▉   | 328/471 [07:15<03:10,  1.33s/it] 70%|██████▉   | 329/471 [07:16<03:09,  1.33s/it] 70%|███████   | 330/471 [07:18<03:07,  1.33s/it] 70%|███████   | 331/471 [07:19<03:06,  1.33s/it] 70%|███████   | 332/471 [07:20<03:04,  1.33s/it] 71%|███████   | 333/471 [07:22<03:03,  1.33s/it] 71%|███████   | 334/471 [07:23<03:02,  1.33s/it] 71%|███████   | 335/471 [07:24<03:00,  1.33s/it] 71%|███████▏  | 336/471 [07:26<02:59,  1.33s/it] 72%|███████▏  | 337/471 [07:27<02:57,  1.33s/it] 72%|███████▏  | 338/471 [07:28<02:56,  1.33s/it] 72%|███████▏  | 339/471 [07:30<02:55,  1.33s/it] 72%|███████▏  | 340/471 [07:31<02:54,  1.33s/it] 72%|███████▏  | 341/471 [07:32<02:52,  1.33s/it] 73%|███████▎  | 342/471 [07:34<02:51,  1.33s/it] 73%|███████▎  | 343/471 [07:35<02:50,  1.33s/it] 73%|███████▎  | 344/471 [07:36<02:48,  1.33s/it] 73%|███████▎  | 345/471 [07:38<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:39<02:46,  1.33s/it] 74%|███████▎  | 347/471 [07:40<02:44,  1.33s/it] 74%|███████▍  | 348/471 [07:42<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:43<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:44<02:40,  1.33s/it] 75%|███████▍  | 351/471 [07:46<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:47<02:38,  1.33s/it] 75%|███████▍  | 353/471 [07:48<02:36,  1.33s/it] 75%|███████▌  | 354/471 [07:50<02:35,  1.33s/it] 75%|███████▌  | 355/471 [07:51<02:34,  1.33s/it] 76%|███████▌  | 356/471 [07:52<02:32,  1.33s/it] 76%|███████▌  | 357/471 [07:54<02:31,  1.33s/it] 76%|███████▌  | 358/471 [07:55<02:30,  1.33s/it] 76%|███████▌  | 359/471 [07:56<02:28,  1.33s/it] 76%|███████▋  | 360/471 [07:58<02:27,  1.33s/it] 77%|███████▋  | 361/471 [07:59<02:26,  1.33s/it] 77%|███████▋  | 362/471 [08:00<02:24,  1.33s/it] 77%|███████▋  | 363/471 [08:02<02:23,  1.33s/it] 77%|███████▋  | 364/471 [08:03<02:22,  1.33s/it] 77%|███████▋  | 365/471 [08:04<02:21,  1.33s/it] 78%|███████▊  | 366/471 [08:06<02:19,  1.33s/it] 78%|███████▊  | 367/471 [08:07<02:18,  1.33s/it] 78%|███████▊  | 368/471 [08:08<02:17,  1.33s/it] 78%|███████▊  | 369/471 [08:10<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:11<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:12<02:13,  1.33s/it] 79%|███████▉  | 372/471 [08:14<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:15<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:16<02:09,  1.33s/it] 80%|███████▉  | 375/471 [08:18<02:07,  1.33s/it] 80%|███████▉  | 376/471 [08:19<02:06,  1.33s/it] 80%|████████  | 377/471 [08:20<02:04,  1.33s/it] 80%|████████  | 378/471 [08:22<02:03,  1.33s/it] 80%|████████  | 379/471 [08:23<02:02,  1.33s/it] 81%|████████  | 380/471 [08:24<02:01,  1.33s/it] 81%|████████  | 381/471 [08:26<01:59,  1.33s/it] 81%|████████  | 382/471 [08:27<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:28<01:57,  1.33s/it] 82%|████████▏ | 384/471 [08:30<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:31<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:32<01:53,  1.33s/it] 82%|████████▏ | 387/471 [08:34<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:35<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:36<01:49,  1.33s/it] 83%|████████▎ | 390/471 [08:38<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:39<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:40<01:45,  1.33s/it] 83%|████████▎ | 393/471 [08:42<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:43<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:44<01:41,  1.33s/it] 84%|████████▍ | 396/471 [08:46<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:47<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:48<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:49<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:51<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:52<01:33,  1.33s/it] 85%|████████▌ | 402/471 [08:53<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:55<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:56<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:57<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:59<01:26,  1.33s/it] 86%|████████▋ | 407/471 [09:00<01:25,  1.33s/it] 87%|████████▋ | 408/471 [09:01<01:23,  1.33s/it] 87%|████████▋ | 409/471 [09:03<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:04<01:21,  1.33s/it] 87%|████████▋ | 411/471 [09:05<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:07<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:08<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:09<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:11<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:12<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:13<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:15<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:16<01:09,  1.33s/it] 89%|████████▉ | 420/471 [09:17<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:19<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:20<01:05,  1.33s/it] 90%|████████▉ | 423/471 [09:21<01:03,  1.33s/it] 90%|█████████ | 424/471 [09:23<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:24<01:01,  1.33s/it] 90%|█████████ | 426/471 [09:25<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:27<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:28<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:29<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:31<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:32<00:53,  1.33s/it] 92%|█████████▏| 432/471 [09:33<00:51,  1.33s/it] 92%|█████████▏| 433/471 [09:35<00:50,  1.33s/it] 92%|█████████▏| 434/471 [09:36<00:49,  1.33s/it] 92%|█████████▏| 435/471 [09:37<00:47,  1.33s/it] 93%|█████████▎| 436/471 [09:39<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:40<00:45,  1.33s/it] 93%|█████████▎| 438/471 [09:41<00:43,  1.33s/it] 93%|█████████▎| 439/471 [09:43<00:42,  1.33s/it] 93%|█████████▎| 440/471 [09:44<00:41,  1.33s/it] 94%|█████████▎| 441/471 [09:45<00:39,  1.33s/it] 94%|█████████▍| 442/471 [09:47<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:48<00:37,  1.33s/it] 94%|█████████▍| 444/471 [09:49<00:35,  1.33s/it] 94%|█████████▍| 445/471 [09:51<00:34,  1.33s/it] 95%|█████████▍| 446/471 [09:52<00:33,  1.33s/it] 95%|█████████▍| 447/471 [09:53<00:31,  1.33s/it] 95%|█████████▌| 448/471 [09:55<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:56<00:29,  1.33s/it] 96%|█████████▌| 450/471 [09:57<00:27,  1.33s/it] 96%|█████████▌| 451/471 [09:59<00:26,  1.33s/it] 96%|█████████▌| 452/471 [10:00<00:25,  1.33s/it] 96%|█████████▌| 453/471 [10:01<00:23,  1.33s/it] 96%|█████████▋| 454/471 [10:03<00:22,  1.33s/it] 97%|█████████▋| 455/471 [10:04<00:21,  1.33s/it] 97%|█████████▋| 456/471 [10:05<00:19,  1.33s/it] 97%|█████████▋| 457/471 [10:07<00:18,  1.33s/it] 97%|█████████▋| 458/471 [10:08<00:17,  1.33s/it] 97%|█████████▋| 459/471 [10:09<00:15,  1.33s/it] 98%|█████████▊| 460/471 [10:11<00:14,  1.33s/it] 98%|█████████▊| 461/471 [10:12<00:13,  1.33s/it] 98%|█████████▊| 462/471 [10:13<00:11,  1.33s/it] 98%|█████████▊| 463/471 [10:15<00:10,  1.33s/it] 99%|█████████▊| 464/471 [10:16<00:09,  1.33s/it] 99%|█████████▊| 465/471 [10:17<00:07,  1.33s/it] 99%|█████████▉| 466/471 [10:19<00:06,  1.33s/it] 99%|█████████▉| 467/471 [10:20<00:05,  1.33s/it] 99%|█████████▉| 468/471 [10:21<00:04,  1.33s/it]100%|█████████▉| 469/471 [10:23<00:02,  1.33s/it]100%|█████████▉| 470/471 [10:24<00:01,  1.33s/it]100%|██████████| 471/471 [10:25<00:00,  1.22s/it]100%|██████████| 471/471 [10:25<00:00,  1.33s/it]
{'eval_loss': 3.2219436168670654, 'eval_model_preparation_time': 0.0108, 'eval_acc': 0.2862453531598513, 'eval_runtime': 626.6392, 'eval_samples_per_second': 12.02, 'eval_steps_per_second': 0.752}
ROUND:13
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.22s/it]                                              {'loss': 2.6675, 'grad_norm': 8.734463691711426, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.22s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 3.067, 'grad_norm': 9.200349807739258, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 2.1776, 'grad_norm': 9.819880485534668, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:19,  2.21s/it]                                              {'loss': 2.6777, 'grad_norm': 11.130091667175293, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 1.9914, 'grad_norm': 14.845930099487305, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 1.2068, 'grad_norm': 6.786875247955322, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 2.4653, 'grad_norm': 14.712084770202637, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 5.2315, 'grad_norm': 6.153926372528076, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 0.5543, 'grad_norm': 8.275501251220703, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it]                                               {'loss': 0.7545, 'grad_norm': 5.203037738800049, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.7956, 'grad_norm': 6.8165669441223145, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.1436, 'grad_norm': 5.423725128173828, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.7024, 'grad_norm': 6.716953277587891, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.17s/it]                                               {'loss': 0.7675, 'grad_norm': 5.638562202453613, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.1849, 'grad_norm': 2.4871625900268555, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 2.9299, 'grad_norm': 44.31565856933594, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.2609, 'grad_norm': 3.1174190044403076, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.1456, 'grad_norm': 1.6792380809783936, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.1945, 'grad_norm': 4.397297382354736, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.8965, 'grad_norm': 19.74974250793457, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it]                                               {'loss': 0.3804, 'grad_norm': 5.422621726989746, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 0.4812, 'grad_norm': 4.908301830291748, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.5921, 'grad_norm': 6.070355415344238, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0772, 'grad_norm': 4.447116374969482, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.1736, 'grad_norm': 2.115004777908325, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.3725, 'grad_norm': 2.134967088699341, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.0264, 'grad_norm': 0.6272125840187073, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.11s/it]                                               {'loss': 0.0226, 'grad_norm': 0.3455290198326111, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.11s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.2866, 'grad_norm': 2.522749185562134, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.1818, 'grad_norm': 0.7196865677833557, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.22s/it]                                               {'loss': 0.1198, 'grad_norm': 1.4003822803497314, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0147, 'grad_norm': 0.8638024926185608, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.82s/it]                                               {'loss': 0.0327, 'grad_norm': 0.7355773448944092, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.82s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.96s/it]                                               {'loss': 0.0295, 'grad_norm': 0.5323125123977661, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it]                                               {'loss': 0.0402, 'grad_norm': 0.5352784395217896, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.5978, 'grad_norm': 1.0524691343307495, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.1328, 'grad_norm': 0.8868610858917236, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.19s/it]                                               {'loss': 0.0322, 'grad_norm': 0.5079721808433533, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.0252, 'grad_norm': 0.3637441396713257, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.003, 'grad_norm': 0.16297829151153564, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.8033, 'train_samples_per_second': 7.08, 'train_steps_per_second': 0.501, 'train_loss': 0.8609332003688905, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
CLIENT:74
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 2.8034, 'grad_norm': 8.489764213562012, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:23,  2.20s/it]                                              {'loss': 2.5544, 'grad_norm': 9.092297554016113, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.20s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 1.1114, 'grad_norm': 10.549859046936035, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:19,  2.21s/it]                                              {'loss': 2.3458, 'grad_norm': 20.954181671142578, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.2582, 'grad_norm': 24.703590393066406, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 0.7402, 'grad_norm': 9.460115432739258, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it]                                              {'loss': 1.8592, 'grad_norm': 19.351730346679688, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.3169, 'grad_norm': 15.624053955078125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 1.4729, 'grad_norm': 17.920656204223633, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 0.9827, 'grad_norm': 11.811238288879395, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.4939, 'grad_norm': 7.343648433685303, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 1.0541, 'grad_norm': 7.773472309112549, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.5397, 'grad_norm': 5.75261116027832, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it]                                               {'loss': 0.5304, 'grad_norm': 5.596414566040039, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.3511, 'grad_norm': 4.871312618255615, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.0103, 'grad_norm': 0.4098757803440094, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.0391, 'grad_norm': 1.1435188055038452, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 0.3624, 'grad_norm': 3.6988167762756348, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.1293, 'grad_norm': 3.964237689971924, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.0769, 'grad_norm': 1.7474275827407837, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.1924, 'grad_norm': 2.4389753341674805, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.2928, 'grad_norm': 2.5767340660095215, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.1623, 'grad_norm': 5.83720588684082, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0234, 'grad_norm': 1.885625958442688, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.1775, 'grad_norm': 3.6546425819396973, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.0194, 'grad_norm': 0.4805983006954193, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.1124, 'grad_norm': 2.056994915008545, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.6604, 'grad_norm': 10.055886268615723, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.1581, 'grad_norm': 2.3175690174102783, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0705, 'grad_norm': 0.8534530997276306, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.3167, 'grad_norm': 6.475698947906494, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.1124, 'grad_norm': 13.325349807739258, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.2856, 'grad_norm': 11.483649253845215, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.9801, 'grad_norm': 36.927085876464844, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.1982, 'grad_norm': 6.030641078948975, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.1041, 'grad_norm': 4.540469646453857, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.1308, 'grad_norm': 7.231975078582764, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.3012, 'grad_norm': 4.652729034423828, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.1544, 'grad_norm': 2.8334710597991943, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.4954, 'grad_norm': 11.213180541992188, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.7508, 'train_samples_per_second': 7.085, 'train_steps_per_second': 0.502, 'train_loss': 0.5995077442377805, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:15
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 3.954, 'grad_norm': 13.073004722595215, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 1.6111, 'grad_norm': 8.928911209106445, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:18,  2.13s/it]                                              {'loss': 2.2561, 'grad_norm': 14.151260375976562, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:18,  2.13s/it] 10%|█         | 4/40 [00:08<01:16,  2.13s/it]                                              {'loss': 1.9673, 'grad_norm': 11.733260154724121, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:16,  2.13s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it]                                              {'loss': 1.7066, 'grad_norm': 9.612529754638672, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.15s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 1.739, 'grad_norm': 11.8279390335083, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 1.5919, 'grad_norm': 13.40262508392334, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 2.4994, 'grad_norm': 67.80496215820312, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it]                                              {'loss': 0.9678, 'grad_norm': 12.393771171569824, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 0.3076, 'grad_norm': 3.549109697341919, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 0.9173, 'grad_norm': 8.416597366333008, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.7817, 'grad_norm': 5.2538557052612305, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.4746, 'grad_norm': 4.011628150939941, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.6984, 'grad_norm': 7.651378154754639, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.631, 'grad_norm': 12.987624168395996, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0579, 'grad_norm': 3.1886656284332275, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it]                                               {'loss': 0.2904, 'grad_norm': 3.4749598503112793, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.164, 'grad_norm': 3.2770841121673584, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.3846, 'grad_norm': 4.035286903381348, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.3992, 'grad_norm': 4.2256340980529785, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.1611, 'grad_norm': 1.919034719467163, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.1404, 'grad_norm': 2.166478157043457, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.4372, 'grad_norm': 9.162577629089355, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.1343, 'grad_norm': 6.561244487762451, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.6942, 'grad_norm': 9.9208984375, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.1123, 'grad_norm': 2.8952722549438477, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0742, 'grad_norm': 2.8219313621520996, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.1263, 'grad_norm': 0.5011388659477234, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.5187, 'grad_norm': 16.356698989868164, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.4753, 'grad_norm': 4.951709270477295, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.5899, 'grad_norm': 8.781867980957031, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.141, 'grad_norm': 9.835862159729004, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.4027, 'grad_norm': 4.299226760864258, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.2341, 'grad_norm': 2.995323657989502, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it]                                               {'loss': 0.0661, 'grad_norm': 1.0546613931655884, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0496, 'grad_norm': 0.9508763551712036, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.8796, 'grad_norm': 5.078173637390137, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.0463, 'grad_norm': 0.6145894527435303, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]                                               {'loss': 0.0382, 'grad_norm': 0.5891794562339783, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.001, 'grad_norm': 0.05754140391945839, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.2893, 'train_samples_per_second': 7.217, 'train_steps_per_second': 0.511, 'train_loss': 0.718053896278434, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 2.8168, 'grad_norm': 10.313456535339355, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 1.7638, 'grad_norm': 13.814497947692871, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 1.7756, 'grad_norm': 10.417704582214355, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.3863, 'grad_norm': 8.928898811340332, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 1.2736, 'grad_norm': 9.124763488769531, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 0.8712, 'grad_norm': 11.08103084564209, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.8939, 'grad_norm': 11.040329933166504, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.1978, 'grad_norm': 11.105609893798828, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.1024, 'grad_norm': 9.830413818359375, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 0.7701, 'grad_norm': 6.111949920654297, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.4136, 'grad_norm': 5.793423175811768, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.3408, 'grad_norm': 4.771281719207764, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 0.7589, 'grad_norm': 5.571582794189453, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.5088, 'grad_norm': 3.297269582748413, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it]                                               {'loss': 0.6119, 'grad_norm': 8.817978858947754, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.1753, 'grad_norm': 5.734254360198975, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.2077, 'grad_norm': 4.301385402679443, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.2031, 'grad_norm': 1.130841612815857, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.4483, 'grad_norm': 2.8946073055267334, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.0444, 'grad_norm': 1.1887120008468628, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.6969, 'grad_norm': 4.798549175262451, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it]                                               {'loss': 0.2496, 'grad_norm': 2.8411571979522705, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.2067, 'grad_norm': 2.030677080154419, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0316, 'grad_norm': 0.9269624948501587, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.1151, 'grad_norm': 1.0554804801940918, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.1079, 'grad_norm': 2.163320302963257, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.3452, 'grad_norm': 5.993681907653809, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.7927, 'grad_norm': 7.150568008422852, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.3122, 'grad_norm': 6.081817150115967, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0381, 'grad_norm': 0.8172199130058289, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.4959, 'grad_norm': 9.996092796325684, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 0.0008077860693447292, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it]                                               {'loss': 0.5728, 'grad_norm': 5.22813606262207, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0799, 'grad_norm': 1.2142921686172485, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.4313, 'grad_norm': 5.403019428253174, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0772, 'grad_norm': 1.024868369102478, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it]                                               {'loss': 0.026, 'grad_norm': 0.522253155708313, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.2243, 'grad_norm': 5.023624897003174, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0686, 'grad_norm': 1.0067167282104492, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.2496, 'grad_norm': 13.76458740234375, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.0764, 'train_samples_per_second': 7.145, 'train_steps_per_second': 0.506, 'train_loss': 0.5671518084086073, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:32
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.7561, 'grad_norm': 8.863079071044922, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:23,  2.18s/it]                                              {'loss': 2.9283, 'grad_norm': 11.311223030090332, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.1261, 'grad_norm': 15.765844345092773, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.5918, 'grad_norm': 15.005228042602539, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 2.4869, 'grad_norm': 11.157051086425781, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it]                                              {'loss': 1.619, 'grad_norm': 12.928322792053223, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 3.4353, 'grad_norm': 24.122365951538086, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.53s/it]                                              {'loss': 0.0496, 'grad_norm': 2.359901189804077, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.0012, 'grad_norm': 8.339126586914062, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.0244, 'grad_norm': 6.243351459503174, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it]                                               {'loss': 0.9527, 'grad_norm': 7.6193766593933105, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.6194, 'grad_norm': 8.304104804992676, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.8992, 'grad_norm': 8.303495407104492, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.7997, 'grad_norm': 3.93985652923584, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.4731, 'grad_norm': 6.494380474090576, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.6125, 'grad_norm': 14.730594635009766, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.3398, 'grad_norm': 4.530961036682129, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.2771, 'grad_norm': 5.929738521575928, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.4897, 'grad_norm': 3.8938026428222656, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.5734, 'grad_norm': 3.007620096206665, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.5085, 'grad_norm': 3.532297134399414, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it]                                               {'loss': 0.9078, 'grad_norm': 4.416442394256592, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.2856, 'grad_norm': 1.7270234823226929, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 2.5177, 'grad_norm': 7.180911064147949, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.3919, 'grad_norm': 1.1579334735870361, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it]                                               {'loss': 0.4069, 'grad_norm': 2.488435983657837, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it]                                               {'loss': 0.2759, 'grad_norm': 1.454332709312439, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it] 70%|███████   | 28/40 [00:55<00:24,  2.05s/it]                                               {'loss': 0.6563, 'grad_norm': 4.6252312660217285, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.0807, 'grad_norm': 1.587937831878662, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.039, 'grad_norm': 0.5727608799934387, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.2302, 'grad_norm': 1.9444290399551392, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.2635, 'grad_norm': 4.265637397766113, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0843, 'grad_norm': 1.1160876750946045, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.2071, 'grad_norm': 3.0800628662109375, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.2443, 'grad_norm': 1.6069517135620117, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1047, 'grad_norm': 1.263965129852295, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.2136, 'grad_norm': 4.3606061935424805, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.4461, 'grad_norm': 1.814160943031311, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.1143, 'grad_norm': 5.554921627044678, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0559, 'grad_norm': 2.8728182315826416, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.6217, 'train_samples_per_second': 7.186, 'train_steps_per_second': 0.509, 'train_loss': 0.9022338752634823, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:59
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 2.986, 'grad_norm': 10.991488456726074, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.2262, 'grad_norm': 11.603144645690918, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.0961, 'grad_norm': 10.272476196289062, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.3118, 'grad_norm': 15.939563751220703, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 1.4886, 'grad_norm': 16.949365615844727, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 1.3634, 'grad_norm': 13.87353515625, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.8791, 'grad_norm': 11.16932201385498, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.5236, 'grad_norm': 71.6412124633789, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it]                                              {'loss': 1.1997, 'grad_norm': 10.530522346496582, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.9807, 'grad_norm': 10.079139709472656, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.6986, 'grad_norm': 7.483623504638672, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 1.288, 'grad_norm': 7.966507434844971, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 0.6252, 'grad_norm': 6.123119831085205, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.9035, 'grad_norm': 9.417952537536621, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.7529, 'grad_norm': 6.531416416168213, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 1.9793, 'grad_norm': 18.304088592529297, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.4676, 'grad_norm': 7.623217582702637, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.2574, 'grad_norm': 6.285417079925537, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.2053, 'grad_norm': 2.853372573852539, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.463, 'grad_norm': 3.6826424598693848, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.3141, 'grad_norm': 2.0709755420684814, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.2554, 'grad_norm': 2.3661561012268066, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.4583, 'grad_norm': 3.7550342082977295, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 1.1258, 'grad_norm': 11.493626594543457, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.2588, 'grad_norm': 3.9304094314575195, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.2867, 'grad_norm': 2.6696434020996094, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.0774, 'grad_norm': 1.0084155797958374, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.2007, 'grad_norm': 2.5528054237365723, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.1878, 'grad_norm': 2.5601747035980225, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.3393, 'grad_norm': 5.512042999267578, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it]                                               {'loss': 0.5813, 'grad_norm': 6.57138204574585, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.21s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.0058, 'grad_norm': 0.27734771370887756, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0862, 'grad_norm': 1.8616572618484497, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.3321, 'grad_norm': 4.544682025909424, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0354, 'grad_norm': 1.3457515239715576, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.1888, 'grad_norm': 2.0070853233337402, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0457, 'grad_norm': 0.7234271168708801, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.1316, 'grad_norm': 2.9381964206695557, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]                                               {'loss': 0.1684, 'grad_norm': 2.3785147666931152, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0002, 'grad_norm': 0.01126929186284542, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2502, 'train_samples_per_second': 7.129, 'train_steps_per_second': 0.505, 'train_loss': 0.8194010715338663, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:91
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.13s/it]                                              {'loss': 2.6679, 'grad_norm': 7.358426570892334, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.13s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 2.4288, 'grad_norm': 11.215171813964844, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 3.2404, 'grad_norm': 15.660382270812988, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.545, 'grad_norm': 9.891117095947266, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 3.4444, 'grad_norm': 13.068364143371582, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 1.0937, 'grad_norm': 14.372386932373047, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.1876, 'grad_norm': 9.938824653625488, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.5357, 'grad_norm': 59.62278366088867, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it]                                              {'loss': 0.8744, 'grad_norm': 5.4543280601501465, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.6968, 'grad_norm': 6.977177143096924, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.0399, 'grad_norm': 7.396864891052246, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.5739, 'grad_norm': 5.707247734069824, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.9196, 'grad_norm': 5.760174751281738, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.1672, 'grad_norm': 14.221535682678223, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.9255, 'grad_norm': 6.640276908874512, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.4427, 'grad_norm': 15.693740844726562, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.1976, 'grad_norm': 1.5831283330917358, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.551, 'grad_norm': 3.564744710922241, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.1971, 'grad_norm': 2.8596739768981934, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.6216, 'grad_norm': 4.541500568389893, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.3201, 'grad_norm': 6.404664516448975, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.5317, 'grad_norm': 4.54306173324585, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.3933, 'grad_norm': 4.496545314788818, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0003, 'grad_norm': 0.018663911148905754, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.3566, 'grad_norm': 25.66968536376953, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.0961, 'grad_norm': 3.2952029705047607, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.0607, 'grad_norm': 0.9204694032669067, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.0859, 'grad_norm': 1.5165785551071167, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.3789, 'grad_norm': 2.3303327560424805, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.1313, 'grad_norm': 1.532429814338684, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.3205, 'grad_norm': 5.9183430671691895, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.3825, 'grad_norm': 8.07219409942627, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0832, 'grad_norm': 1.3724135160446167, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.1341, 'grad_norm': 1.4383572340011597, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0709, 'grad_norm': 0.9310077428817749, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.0637, 'grad_norm': 0.8356954455375671, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.3106, 'grad_norm': 5.72988224029541, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.2087, 'grad_norm': 1.8950716257095337, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.1525, 'grad_norm': 2.892315626144409, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.2328, 'grad_norm': 12.529943466186523, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.6272, 'train_samples_per_second': 7.186, 'train_steps_per_second': 0.509, 'train_loss': 0.8666295802700915, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 3.6676, 'grad_norm': 11.460783004760742, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]                                              {'loss': 1.3901, 'grad_norm': 9.503318786621094, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.9284, 'grad_norm': 8.892398834228516, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 2.2232, 'grad_norm': 17.62888526916504, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 3.3766, 'grad_norm': 17.281217575073242, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 2.9089, 'grad_norm': 20.207290649414062, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 2.4171, 'grad_norm': 13.616687774658203, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.3792, 'grad_norm': 18.410905838012695, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.7607, 'grad_norm': 7.2924628257751465, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.0579, 'grad_norm': 4.753783702850342, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.386, 'grad_norm': 6.36301326751709, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.614, 'grad_norm': 7.320733070373535, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 0.9425, 'grad_norm': 6.729303359985352, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.7036, 'grad_norm': 5.3390374183654785, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 1.0652, 'grad_norm': 8.578397750854492, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 3.4886, 'grad_norm': 21.27391242980957, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.4207, 'grad_norm': 4.633473873138428, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.3966, 'grad_norm': 2.987326145172119, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.608, 'grad_norm': 2.5694286823272705, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.3946, 'grad_norm': 11.543416023254395, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.539, 'grad_norm': 18.99872398376465, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.3457, 'grad_norm': 3.572794198989868, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.1985, 'grad_norm': 3.5098013877868652, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0868, 'grad_norm': 4.674733638763428, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.576, 'grad_norm': 2.837200880050659, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.5765, 'grad_norm': 4.673224449157715, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.2715, 'grad_norm': 3.232746124267578, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.0835, 'grad_norm': 2.0684170722961426, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.293, 'grad_norm': 1.4089677333831787, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1407, 'grad_norm': 3.1979925632476807, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1205, 'grad_norm': 2.157491683959961, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.1805, 'grad_norm': 14.708847045898438, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.1973, 'grad_norm': 3.1349995136260986, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0707, 'grad_norm': 2.302140235900879, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.3062, 'grad_norm': 1.7889312505722046, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.327, 'grad_norm': 11.699549674987793, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0805, 'grad_norm': 1.06333327293396, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.1093, 'grad_norm': 1.9157713651657104, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.5173, 'grad_norm': 11.274812698364258, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0095, 'grad_norm': 0.4624890685081482, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.8323, 'train_samples_per_second': 7.167, 'train_steps_per_second': 0.507, 'train_loss': 0.8789857133291662, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:50
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 3.0527, 'grad_norm': 10.585869789123535, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]                                              {'loss': 3.1159, 'grad_norm': 11.78759765625, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 2.5987, 'grad_norm': 11.53088092803955, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.7248, 'grad_norm': 12.51028060913086, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 1.9981, 'grad_norm': 10.559835433959961, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.9419, 'grad_norm': 23.935855865478516, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.1493, 'grad_norm': 10.186549186706543, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 5.8712, 'grad_norm': 73.88077545166016, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.147, 'grad_norm': 8.14990234375, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 0.6788, 'grad_norm': 4.889902114868164, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.5414, 'grad_norm': 9.398727416992188, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.64, 'grad_norm': 3.967833995819092, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.8542, 'grad_norm': 6.394105434417725, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.8897, 'grad_norm': 7.630172252655029, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.7205, 'grad_norm': 6.286919593811035, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.1801, 'grad_norm': 5.019238471984863, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.2072, 'grad_norm': 2.5846145153045654, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.3083, 'grad_norm': 2.214265823364258, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.2225, 'grad_norm': 2.37845516204834, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.3794, 'grad_norm': 3.7400264739990234, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.3582, 'grad_norm': 1.5094841718673706, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.2581, 'grad_norm': 1.186854362487793, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.2648, 'grad_norm': 2.2004096508026123, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0014, 'grad_norm': 0.16116100549697876, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.2116, 'grad_norm': 3.3655307292938232, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.1342, 'grad_norm': 3.082282304763794, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.101, 'grad_norm': 1.6374517679214478, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.036, 'grad_norm': 0.8074883222579956, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.0452, 'grad_norm': 1.0316627025604248, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.1568, 'grad_norm': 1.8198416233062744, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it]                                               {'loss': 0.3334, 'grad_norm': 2.1075594425201416, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.0138, 'grad_norm': 0.45275115966796875, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.1259, 'grad_norm': 0.742577314376831, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.066, 'grad_norm': 1.8564223051071167, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.2035, 'grad_norm': 12.214966773986816, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.05, 'grad_norm': 0.928514838218689, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.6721, 'grad_norm': 5.000509262084961, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.3793, 'grad_norm': 1.2913546562194824, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.0146, 'grad_norm': 0.21573325991630554, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0123, 'grad_norm': 0.6216161251068115, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.5012, 'train_samples_per_second': 7.107, 'train_steps_per_second': 0.503, 'train_loss': 0.7914909849932883, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:53
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 3.0358, 'grad_norm': 7.628317832946777, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 1.5852, 'grad_norm': 10.757604598999023, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:19,  2.14s/it]                                              {'loss': 4.1027, 'grad_norm': 14.936403274536133, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.14s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.9989, 'grad_norm': 14.373421669006348, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.0525, 'grad_norm': 16.77835464477539, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:12<01:14,  2.18s/it]                                              {'loss': 3.2567, 'grad_norm': 38.61175537109375, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.8189, 'grad_norm': 20.311689376831055, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 2.9361, 'grad_norm': 45.77837371826172, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 1.9052, 'grad_norm': 11.817301750183105, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.5612, 'grad_norm': 9.928556442260742, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.2204, 'grad_norm': 14.610424995422363, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 1.1988, 'grad_norm': 6.123716354370117, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.0797, 'grad_norm': 6.523894309997559, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.4011, 'grad_norm': 19.661535263061523, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.0641, 'grad_norm': 7.643404960632324, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.7697, 'grad_norm': 17.4617919921875, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.7722, 'grad_norm': 14.889623641967773, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.6195, 'grad_norm': 8.997089385986328, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.6862, 'grad_norm': 7.033158302307129, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.6313, 'grad_norm': 5.330300807952881, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.519, 'grad_norm': 5.313236713409424, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.3567, 'grad_norm': 3.568039894104004, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.3393, 'grad_norm': 3.4352245330810547, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.56s/it]                                               {'loss': 2.8462, 'grad_norm': 27.789749145507812, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.4544, 'grad_norm': 11.937337875366211, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it]                                               {'loss': 0.3748, 'grad_norm': 5.799980163574219, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.4581, 'grad_norm': 5.676880359649658, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.4471, 'grad_norm': 5.813942909240723, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.2537, 'grad_norm': 3.4254684448242188, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.2379, 'grad_norm': 3.6632251739501953, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.4441, 'grad_norm': 22.89521598815918, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0076, 'grad_norm': 0.4593033492565155, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.3493, 'grad_norm': 3.456901788711548, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.303, 'grad_norm': 5.697908878326416, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.1271, 'grad_norm': 2.6129343509674072, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1444, 'grad_norm': 2.2508597373962402, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.2389, 'grad_norm': 44.14616394042969, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.4795, 'grad_norm': 4.413783550262451, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]                                               {'loss': 0.2693, 'grad_norm': 3.8349239826202393, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0425, 'grad_norm': 2.2409069538116455, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.4395, 'train_samples_per_second': 7.203, 'train_steps_per_second': 0.51, 'train_loss': 1.13471676701447, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:56,  1.58it/s]  1%|          | 3/471 [00:02<06:58,  1.12it/s]  1%|          | 4/471 [00:03<08:04,  1.04s/it]  1%|          | 5/471 [00:05<08:41,  1.12s/it]  1%|▏         | 6/471 [00:06<09:04,  1.17s/it]  1%|▏         | 7/471 [00:07<09:19,  1.21s/it]  2%|▏         | 8/471 [00:08<09:29,  1.23s/it]  2%|▏         | 9/471 [00:10<09:35,  1.24s/it]  2%|▏         | 10/471 [00:11<09:38,  1.26s/it]  2%|▏         | 11/471 [00:12<09:40,  1.26s/it]  3%|▎         | 12/471 [00:14<09:42,  1.27s/it]  3%|▎         | 13/471 [00:15<09:43,  1.28s/it]  3%|▎         | 14/471 [00:16<09:43,  1.28s/it]  3%|▎         | 15/471 [00:17<09:43,  1.28s/it]  3%|▎         | 16/471 [00:19<09:43,  1.28s/it]  4%|▎         | 17/471 [00:20<09:43,  1.28s/it]  4%|▍         | 18/471 [00:21<09:42,  1.29s/it]  4%|▍         | 19/471 [00:23<09:41,  1.29s/it]  4%|▍         | 20/471 [00:24<09:41,  1.29s/it]  4%|▍         | 21/471 [00:25<09:41,  1.29s/it]  5%|▍         | 22/471 [00:26<09:41,  1.29s/it]  5%|▍         | 23/471 [00:28<09:40,  1.29s/it]  5%|▌         | 24/471 [00:29<09:39,  1.30s/it]  5%|▌         | 25/471 [00:30<09:38,  1.30s/it]  6%|▌         | 26/471 [00:32<09:37,  1.30s/it]  6%|▌         | 27/471 [00:33<09:36,  1.30s/it]  6%|▌         | 28/471 [00:34<09:36,  1.30s/it]  6%|▌         | 29/471 [00:36<09:35,  1.30s/it]  6%|▋         | 30/471 [00:37<09:34,  1.30s/it]  7%|▋         | 31/471 [00:38<09:33,  1.30s/it]  7%|▋         | 32/471 [00:39<09:31,  1.30s/it]  7%|▋         | 33/471 [00:41<09:28,  1.30s/it]  7%|▋         | 34/471 [00:42<09:28,  1.30s/it]  7%|▋         | 35/471 [00:43<09:27,  1.30s/it]  8%|▊         | 36/471 [00:45<09:26,  1.30s/it]  8%|▊         | 37/471 [00:46<09:26,  1.30s/it]  8%|▊         | 38/471 [00:47<09:25,  1.31s/it]  8%|▊         | 39/471 [00:49<09:24,  1.31s/it]  8%|▊         | 40/471 [00:50<09:23,  1.31s/it]  9%|▊         | 41/471 [00:51<09:22,  1.31s/it]  9%|▉         | 42/471 [00:53<09:21,  1.31s/it]  9%|▉         | 43/471 [00:54<09:20,  1.31s/it]  9%|▉         | 44/471 [00:55<09:18,  1.31s/it] 10%|▉         | 45/471 [00:56<09:18,  1.31s/it] 10%|▉         | 46/471 [00:58<09:17,  1.31s/it] 10%|▉         | 47/471 [00:59<09:16,  1.31s/it] 10%|█         | 48/471 [01:00<09:15,  1.31s/it] 10%|█         | 49/471 [01:02<09:14,  1.31s/it] 11%|█         | 50/471 [01:03<09:13,  1.31s/it] 11%|█         | 51/471 [01:04<09:12,  1.32s/it] 11%|█         | 52/471 [01:06<09:11,  1.32s/it] 11%|█▏        | 53/471 [01:07<09:11,  1.32s/it] 11%|█▏        | 54/471 [01:08<09:10,  1.32s/it] 12%|█▏        | 55/471 [01:10<09:09,  1.32s/it] 12%|█▏        | 56/471 [01:11<09:09,  1.32s/it] 12%|█▏        | 57/471 [01:12<09:07,  1.32s/it] 12%|█▏        | 58/471 [01:14<09:06,  1.32s/it] 13%|█▎        | 59/471 [01:15<09:05,  1.32s/it] 13%|█▎        | 60/471 [01:16<09:04,  1.32s/it] 13%|█▎        | 61/471 [01:18<09:03,  1.33s/it] 13%|█▎        | 62/471 [01:19<09:02,  1.33s/it] 13%|█▎        | 63/471 [01:20<09:00,  1.33s/it] 14%|█▎        | 64/471 [01:22<08:59,  1.33s/it] 14%|█▍        | 65/471 [01:23<08:58,  1.33s/it] 14%|█▍        | 66/471 [01:24<08:57,  1.33s/it] 14%|█▍        | 67/471 [01:26<08:56,  1.33s/it] 14%|█▍        | 68/471 [01:27<08:55,  1.33s/it] 15%|█▍        | 69/471 [01:28<08:54,  1.33s/it] 15%|█▍        | 70/471 [01:30<08:54,  1.33s/it] 15%|█▌        | 71/471 [01:31<08:53,  1.33s/it] 15%|█▌        | 72/471 [01:32<08:51,  1.33s/it] 15%|█▌        | 73/471 [01:34<08:50,  1.33s/it] 16%|█▌        | 74/471 [01:35<08:47,  1.33s/it] 16%|█▌        | 75/471 [01:36<08:47,  1.33s/it] 16%|█▌        | 76/471 [01:38<08:46,  1.33s/it] 16%|█▋        | 77/471 [01:39<08:45,  1.33s/it] 17%|█▋        | 78/471 [01:40<08:44,  1.34s/it] 17%|█▋        | 79/471 [01:42<08:44,  1.34s/it] 17%|█▋        | 80/471 [01:43<08:43,  1.34s/it] 17%|█▋        | 81/471 [01:44<08:41,  1.34s/it] 17%|█▋        | 82/471 [01:46<08:40,  1.34s/it] 18%|█▊        | 83/471 [01:47<08:39,  1.34s/it] 18%|█▊        | 84/471 [01:48<08:38,  1.34s/it] 18%|█▊        | 85/471 [01:50<08:37,  1.34s/it] 18%|█▊        | 86/471 [01:51<08:36,  1.34s/it] 18%|█▊        | 87/471 [01:52<08:34,  1.34s/it] 19%|█▊        | 88/471 [01:54<08:33,  1.34s/it] 19%|█▉        | 89/471 [01:55<08:31,  1.34s/it] 19%|█▉        | 90/471 [01:56<08:30,  1.34s/it] 19%|█▉        | 91/471 [01:58<08:29,  1.34s/it] 20%|█▉        | 92/471 [01:59<08:28,  1.34s/it] 20%|█▉        | 93/471 [02:00<08:27,  1.34s/it] 20%|█▉        | 94/471 [02:02<08:26,  1.34s/it] 20%|██        | 95/471 [02:03<08:25,  1.34s/it] 20%|██        | 96/471 [02:04<08:23,  1.34s/it] 21%|██        | 97/471 [02:06<08:23,  1.35s/it] 21%|██        | 98/471 [02:07<08:21,  1.35s/it] 21%|██        | 99/471 [02:08<08:20,  1.35s/it] 21%|██        | 100/471 [02:10<08:18,  1.34s/it] 21%|██▏       | 101/471 [02:11<08:17,  1.35s/it] 22%|██▏       | 102/471 [02:12<08:16,  1.35s/it] 22%|██▏       | 103/471 [02:14<08:15,  1.35s/it] 22%|██▏       | 104/471 [02:15<08:14,  1.35s/it] 22%|██▏       | 105/471 [02:17<08:13,  1.35s/it] 23%|██▎       | 106/471 [02:18<08:11,  1.35s/it] 23%|██▎       | 107/471 [02:19<08:10,  1.35s/it] 23%|██▎       | 108/471 [02:21<08:08,  1.35s/it] 23%|██▎       | 109/471 [02:22<08:06,  1.34s/it] 23%|██▎       | 110/471 [02:23<08:04,  1.34s/it] 24%|██▎       | 111/471 [02:25<08:03,  1.34s/it] 24%|██▍       | 112/471 [02:26<08:02,  1.34s/it] 24%|██▍       | 113/471 [02:27<08:00,  1.34s/it] 24%|██▍       | 114/471 [02:29<08:00,  1.35s/it] 24%|██▍       | 115/471 [02:30<07:59,  1.35s/it] 25%|██▍       | 116/471 [02:31<07:58,  1.35s/it] 25%|██▍       | 117/471 [02:33<07:56,  1.35s/it] 25%|██▌       | 118/471 [02:34<07:54,  1.35s/it] 25%|██▌       | 119/471 [02:35<07:53,  1.35s/it] 25%|██▌       | 120/471 [02:37<07:52,  1.35s/it] 26%|██▌       | 121/471 [02:38<07:51,  1.35s/it] 26%|██▌       | 122/471 [02:39<07:49,  1.35s/it] 26%|██▌       | 123/471 [02:41<07:48,  1.35s/it] 26%|██▋       | 124/471 [02:42<07:47,  1.35s/it] 27%|██▋       | 125/471 [02:43<07:45,  1.35s/it] 27%|██▋       | 126/471 [02:45<07:44,  1.35s/it] 27%|██▋       | 127/471 [02:46<07:43,  1.35s/it] 27%|██▋       | 128/471 [02:47<07:41,  1.34s/it] 27%|██▋       | 129/471 [02:49<07:39,  1.34s/it] 28%|██▊       | 130/471 [02:50<07:38,  1.34s/it] 28%|██▊       | 131/471 [02:51<07:37,  1.34s/it] 28%|██▊       | 132/471 [02:53<07:36,  1.35s/it] 28%|██▊       | 133/471 [02:54<07:34,  1.34s/it] 28%|██▊       | 134/471 [02:56<07:33,  1.35s/it] 29%|██▊       | 135/471 [02:57<07:32,  1.35s/it] 29%|██▉       | 136/471 [02:58<07:30,  1.34s/it] 29%|██▉       | 137/471 [03:00<07:28,  1.34s/it] 29%|██▉       | 138/471 [03:01<07:27,  1.34s/it] 30%|██▉       | 139/471 [03:02<07:26,  1.34s/it] 30%|██▉       | 140/471 [03:04<07:24,  1.34s/it] 30%|██▉       | 141/471 [03:05<07:22,  1.34s/it] 30%|███       | 142/471 [03:06<07:21,  1.34s/it] 30%|███       | 143/471 [03:08<07:19,  1.34s/it] 31%|███       | 144/471 [03:09<07:18,  1.34s/it] 31%|███       | 145/471 [03:10<07:16,  1.34s/it] 31%|███       | 146/471 [03:12<07:16,  1.34s/it] 31%|███       | 147/471 [03:13<07:15,  1.34s/it] 31%|███▏      | 148/471 [03:14<07:13,  1.34s/it] 32%|███▏      | 149/471 [03:16<07:12,  1.34s/it] 32%|███▏      | 150/471 [03:17<07:11,  1.34s/it] 32%|███▏      | 151/471 [03:18<07:09,  1.34s/it] 32%|███▏      | 152/471 [03:20<07:08,  1.34s/it] 32%|███▏      | 153/471 [03:21<07:07,  1.34s/it] 33%|███▎      | 154/471 [03:22<07:05,  1.34s/it] 33%|███▎      | 155/471 [03:24<07:04,  1.34s/it] 33%|███▎      | 156/471 [03:25<07:02,  1.34s/it] 33%|███▎      | 157/471 [03:26<07:00,  1.34s/it] 34%|███▎      | 158/471 [03:28<06:58,  1.34s/it] 34%|███▍      | 159/471 [03:29<06:57,  1.34s/it] 34%|███▍      | 160/471 [03:30<06:56,  1.34s/it] 34%|███▍      | 161/471 [03:32<06:55,  1.34s/it] 34%|███▍      | 162/471 [03:33<06:54,  1.34s/it] 35%|███▍      | 163/471 [03:34<06:53,  1.34s/it] 35%|███▍      | 164/471 [03:36<06:51,  1.34s/it] 35%|███▌      | 165/471 [03:37<06:50,  1.34s/it] 35%|███▌      | 166/471 [03:38<06:49,  1.34s/it] 35%|███▌      | 167/471 [03:40<06:47,  1.34s/it] 36%|███▌      | 168/471 [03:41<06:46,  1.34s/it] 36%|███▌      | 169/471 [03:42<06:45,  1.34s/it] 36%|███▌      | 170/471 [03:44<06:43,  1.34s/it] 36%|███▋      | 171/471 [03:45<06:42,  1.34s/it] 37%|███▋      | 172/471 [03:46<06:40,  1.34s/it] 37%|███▋      | 173/471 [03:48<06:39,  1.34s/it] 37%|███▋      | 174/471 [03:49<06:38,  1.34s/it] 37%|███▋      | 175/471 [03:51<06:37,  1.34s/it] 37%|███▋      | 176/471 [03:52<06:35,  1.34s/it] 38%|███▊      | 177/471 [03:53<06:34,  1.34s/it] 38%|███▊      | 178/471 [03:55<06:33,  1.34s/it] 38%|███▊      | 179/471 [03:56<06:31,  1.34s/it] 38%|███▊      | 180/471 [03:57<06:30,  1.34s/it] 38%|███▊      | 181/471 [03:59<06:28,  1.34s/it] 39%|███▊      | 182/471 [04:00<06:27,  1.34s/it] 39%|███▉      | 183/471 [04:01<06:26,  1.34s/it] 39%|███▉      | 184/471 [04:03<06:24,  1.34s/it] 39%|███▉      | 185/471 [04:04<06:23,  1.34s/it] 39%|███▉      | 186/471 [04:05<06:22,  1.34s/it] 40%|███▉      | 187/471 [04:07<06:20,  1.34s/it] 40%|███▉      | 188/471 [04:08<06:19,  1.34s/it] 40%|████      | 189/471 [04:09<06:17,  1.34s/it] 40%|████      | 190/471 [04:11<06:16,  1.34s/it] 41%|████      | 191/471 [04:12<06:15,  1.34s/it] 41%|████      | 192/471 [04:13<06:14,  1.34s/it] 41%|████      | 193/471 [04:15<06:12,  1.34s/it] 41%|████      | 194/471 [04:16<06:11,  1.34s/it] 41%|████▏     | 195/471 [04:17<06:10,  1.34s/it] 42%|████▏     | 196/471 [04:19<06:08,  1.34s/it] 42%|████▏     | 197/471 [04:20<06:06,  1.34s/it] 42%|████▏     | 198/471 [04:21<06:05,  1.34s/it] 42%|████▏     | 199/471 [04:23<06:04,  1.34s/it] 42%|████▏     | 200/471 [04:24<06:03,  1.34s/it] 43%|████▎     | 201/471 [04:25<06:01,  1.34s/it] 43%|████▎     | 202/471 [04:27<06:00,  1.34s/it] 43%|████▎     | 203/471 [04:28<05:58,  1.34s/it] 43%|████▎     | 204/471 [04:29<05:57,  1.34s/it] 44%|████▎     | 205/471 [04:31<05:55,  1.34s/it] 44%|████▎     | 206/471 [04:32<05:54,  1.34s/it] 44%|████▍     | 207/471 [04:33<05:53,  1.34s/it] 44%|████▍     | 208/471 [04:35<05:51,  1.34s/it] 44%|████▍     | 209/471 [04:36<05:49,  1.34s/it] 45%|████▍     | 210/471 [04:37<05:48,  1.34s/it] 45%|████▍     | 211/471 [04:39<05:47,  1.34s/it] 45%|████▌     | 212/471 [04:40<05:45,  1.34s/it] 45%|████▌     | 213/471 [04:41<05:44,  1.34s/it] 45%|████▌     | 214/471 [04:43<05:43,  1.34s/it] 46%|████▌     | 215/471 [04:44<05:41,  1.33s/it] 46%|████▌     | 216/471 [04:45<05:40,  1.34s/it] 46%|████▌     | 217/471 [04:47<05:39,  1.34s/it] 46%|████▋     | 218/471 [04:48<05:38,  1.34s/it] 46%|████▋     | 219/471 [04:49<05:37,  1.34s/it] 47%|████▋     | 220/471 [04:51<05:35,  1.34s/it] 47%|████▋     | 221/471 [04:52<05:34,  1.34s/it] 47%|████▋     | 222/471 [04:53<05:32,  1.33s/it] 47%|████▋     | 223/471 [04:55<05:31,  1.34s/it] 48%|████▊     | 224/471 [04:56<05:29,  1.34s/it] 48%|████▊     | 225/471 [04:57<05:28,  1.34s/it] 48%|████▊     | 226/471 [04:59<05:27,  1.34s/it] 48%|████▊     | 227/471 [05:00<05:25,  1.34s/it] 48%|████▊     | 228/471 [05:01<05:24,  1.33s/it] 49%|████▊     | 229/471 [05:03<05:23,  1.34s/it] 49%|████▉     | 230/471 [05:04<05:22,  1.34s/it] 49%|████▉     | 231/471 [05:05<05:20,  1.34s/it] 49%|████▉     | 232/471 [05:07<05:18,  1.33s/it] 49%|████▉     | 233/471 [05:08<05:17,  1.33s/it] 50%|████▉     | 234/471 [05:09<05:16,  1.33s/it] 50%|████▉     | 235/471 [05:11<05:15,  1.34s/it] 50%|█████     | 236/471 [05:12<05:13,  1.33s/it] 50%|█████     | 237/471 [05:13<05:11,  1.33s/it] 51%|█████     | 238/471 [05:15<05:10,  1.33s/it] 51%|█████     | 239/471 [05:16<05:09,  1.33s/it] 51%|█████     | 240/471 [05:17<05:08,  1.33s/it] 51%|█████     | 241/471 [05:19<05:07,  1.33s/it] 51%|█████▏    | 242/471 [05:20<05:05,  1.33s/it] 52%|█████▏    | 243/471 [05:21<05:04,  1.33s/it] 52%|█████▏    | 244/471 [05:23<05:02,  1.33s/it] 52%|█████▏    | 245/471 [05:24<05:01,  1.33s/it] 52%|█████▏    | 246/471 [05:25<05:00,  1.33s/it] 52%|█████▏    | 247/471 [05:27<04:58,  1.33s/it] 53%|█████▎    | 248/471 [05:28<04:57,  1.33s/it] 53%|█████▎    | 249/471 [05:29<04:56,  1.34s/it] 53%|█████▎    | 250/471 [05:31<04:54,  1.33s/it] 53%|█████▎    | 251/471 [05:32<04:53,  1.33s/it] 54%|█████▎    | 252/471 [05:33<04:52,  1.33s/it] 54%|█████▎    | 253/471 [05:35<04:51,  1.34s/it] 54%|█████▍    | 254/471 [05:36<04:50,  1.34s/it] 54%|█████▍    | 255/471 [05:37<04:48,  1.34s/it] 54%|█████▍    | 256/471 [05:39<04:47,  1.34s/it] 55%|█████▍    | 257/471 [05:40<04:46,  1.34s/it] 55%|█████▍    | 258/471 [05:41<04:45,  1.34s/it] 55%|█████▍    | 259/471 [05:43<04:43,  1.34s/it] 55%|█████▌    | 260/471 [05:44<04:42,  1.34s/it] 55%|█████▌    | 261/471 [05:45<04:41,  1.34s/it] 56%|█████▌    | 262/471 [05:47<04:39,  1.34s/it] 56%|█████▌    | 263/471 [05:48<04:38,  1.34s/it] 56%|█████▌    | 264/471 [05:50<04:37,  1.34s/it] 56%|█████▋    | 265/471 [05:51<04:35,  1.34s/it] 56%|█████▋    | 266/471 [05:52<04:34,  1.34s/it] 57%|█████▋    | 267/471 [05:54<04:33,  1.34s/it] 57%|█████▋    | 268/471 [05:55<04:31,  1.34s/it] 57%|█████▋    | 269/471 [05:56<04:30,  1.34s/it] 57%|█████▋    | 270/471 [05:58<04:29,  1.34s/it] 58%|█████▊    | 271/471 [05:59<04:27,  1.34s/it] 58%|█████▊    | 272/471 [06:00<04:26,  1.34s/it] 58%|█████▊    | 273/471 [06:02<04:24,  1.34s/it] 58%|█████▊    | 274/471 [06:03<04:23,  1.34s/it] 58%|█████▊    | 275/471 [06:04<04:21,  1.34s/it] 59%|█████▊    | 276/471 [06:06<04:20,  1.34s/it] 59%|█████▉    | 277/471 [06:07<04:19,  1.34s/it] 59%|█████▉    | 278/471 [06:08<04:18,  1.34s/it] 59%|█████▉    | 279/471 [06:10<04:17,  1.34s/it] 59%|█████▉    | 280/471 [06:11<04:15,  1.34s/it] 60%|█████▉    | 281/471 [06:12<04:14,  1.34s/it] 60%|█████▉    | 282/471 [06:14<04:13,  1.34s/it] 60%|██████    | 283/471 [06:15<04:12,  1.34s/it] 60%|██████    | 284/471 [06:16<04:10,  1.34s/it] 61%|██████    | 285/471 [06:18<04:09,  1.34s/it] 61%|██████    | 286/471 [06:19<04:08,  1.34s/it] 61%|██████    | 287/471 [06:20<04:07,  1.34s/it] 61%|██████    | 288/471 [06:22<04:06,  1.35s/it] 61%|██████▏   | 289/471 [06:23<04:04,  1.34s/it] 62%|██████▏   | 290/471 [06:24<04:03,  1.34s/it] 62%|██████▏   | 291/471 [06:26<04:01,  1.34s/it] 62%|██████▏   | 292/471 [06:27<04:00,  1.34s/it] 62%|██████▏   | 293/471 [06:28<03:59,  1.34s/it] 62%|██████▏   | 294/471 [06:30<03:57,  1.34s/it] 63%|██████▎   | 295/471 [06:31<03:56,  1.34s/it] 63%|██████▎   | 296/471 [06:32<03:55,  1.34s/it] 63%|██████▎   | 297/471 [06:34<03:53,  1.34s/it] 63%|██████▎   | 298/471 [06:35<03:52,  1.35s/it] 63%|██████▎   | 299/471 [06:36<03:51,  1.35s/it] 64%|██████▎   | 300/471 [06:38<03:50,  1.35s/it] 64%|██████▍   | 301/471 [06:39<03:49,  1.35s/it] 64%|██████▍   | 302/471 [06:41<03:47,  1.35s/it] 64%|██████▍   | 303/471 [06:42<03:46,  1.35s/it] 65%|██████▍   | 304/471 [06:43<03:45,  1.35s/it] 65%|██████▍   | 305/471 [06:45<03:43,  1.35s/it] 65%|██████▍   | 306/471 [06:46<03:43,  1.35s/it] 65%|██████▌   | 307/471 [06:47<03:41,  1.35s/it] 65%|██████▌   | 308/471 [06:49<03:40,  1.36s/it] 66%|██████▌   | 309/471 [06:50<03:39,  1.35s/it] 66%|██████▌   | 310/471 [06:51<03:37,  1.35s/it] 66%|██████▌   | 311/471 [06:53<03:36,  1.35s/it] 66%|██████▌   | 312/471 [06:54<03:34,  1.35s/it] 66%|██████▋   | 313/471 [06:55<03:33,  1.35s/it] 67%|██████▋   | 314/471 [06:57<03:32,  1.35s/it] 67%|██████▋   | 315/471 [06:58<03:30,  1.35s/it] 67%|██████▋   | 316/471 [06:59<03:29,  1.35s/it] 67%|██████▋   | 317/471 [07:01<03:28,  1.35s/it] 68%|██████▊   | 318/471 [07:02<03:27,  1.35s/it] 68%|██████▊   | 319/471 [07:04<03:25,  1.35s/it] 68%|██████▊   | 320/471 [07:05<03:24,  1.35s/it] 68%|██████▊   | 321/471 [07:06<03:23,  1.35s/it] 68%|██████▊   | 322/471 [07:08<03:21,  1.35s/it] 69%|██████▊   | 323/471 [07:09<03:20,  1.36s/it] 69%|██████▉   | 324/471 [07:10<03:19,  1.36s/it] 69%|██████▉   | 325/471 [07:12<03:17,  1.36s/it] 69%|██████▉   | 326/471 [07:13<03:16,  1.35s/it] 69%|██████▉   | 327/471 [07:14<03:14,  1.35s/it] 70%|██████▉   | 328/471 [07:16<03:13,  1.35s/it] 70%|██████▉   | 329/471 [07:17<03:12,  1.36s/it] 70%|███████   | 330/471 [07:18<03:10,  1.35s/it] 70%|███████   | 331/471 [07:20<03:09,  1.35s/it] 70%|███████   | 332/471 [07:21<03:08,  1.35s/it] 71%|███████   | 333/471 [07:22<03:06,  1.35s/it] 71%|███████   | 334/471 [07:24<03:05,  1.35s/it] 71%|███████   | 335/471 [07:25<03:04,  1.36s/it] 71%|███████▏  | 336/471 [07:27<03:02,  1.35s/it] 72%|███████▏  | 337/471 [07:28<03:01,  1.35s/it] 72%|███████▏  | 338/471 [07:29<03:00,  1.35s/it] 72%|███████▏  | 339/471 [07:31<02:58,  1.36s/it] 72%|███████▏  | 340/471 [07:32<02:57,  1.35s/it] 72%|███████▏  | 341/471 [07:33<02:55,  1.35s/it] 73%|███████▎  | 342/471 [07:35<02:54,  1.35s/it] 73%|███████▎  | 343/471 [07:36<02:53,  1.35s/it] 73%|███████▎  | 344/471 [07:37<02:51,  1.35s/it] 73%|███████▎  | 345/471 [07:39<02:50,  1.35s/it] 73%|███████▎  | 346/471 [07:40<02:48,  1.35s/it] 74%|███████▎  | 347/471 [07:41<02:47,  1.35s/it] 74%|███████▍  | 348/471 [07:43<02:45,  1.35s/it] 74%|███████▍  | 349/471 [07:44<02:44,  1.35s/it] 74%|███████▍  | 350/471 [07:45<02:43,  1.35s/it] 75%|███████▍  | 351/471 [07:47<02:41,  1.35s/it] 75%|███████▍  | 352/471 [07:48<02:40,  1.35s/it] 75%|███████▍  | 353/471 [07:49<02:39,  1.35s/it] 75%|███████▌  | 354/471 [07:51<02:37,  1.35s/it] 75%|███████▌  | 355/471 [07:52<02:36,  1.35s/it] 76%|███████▌  | 356/471 [07:54<02:34,  1.35s/it] 76%|███████▌  | 357/471 [07:55<02:33,  1.35s/it] 76%|███████▌  | 358/471 [07:56<02:31,  1.34s/it] 76%|███████▌  | 359/471 [07:58<02:30,  1.34s/it] 76%|███████▋  | 360/471 [07:59<02:29,  1.34s/it] 77%|███████▋  | 361/471 [08:00<02:27,  1.34s/it] 77%|███████▋  | 362/471 [08:02<02:26,  1.34s/it] 77%|███████▋  | 363/471 [08:03<02:24,  1.34s/it] 77%|███████▋  | 364/471 [08:04<02:23,  1.34s/it] 77%|███████▋  | 365/471 [08:06<02:22,  1.34s/it] 78%|███████▊  | 366/471 [08:07<02:21,  1.34s/it] 78%|███████▊  | 367/471 [08:08<02:19,  1.34s/it] 78%|███████▊  | 368/471 [08:10<02:18,  1.34s/it] 78%|███████▊  | 369/471 [08:11<02:16,  1.34s/it] 79%|███████▊  | 370/471 [08:12<02:15,  1.34s/it] 79%|███████▉  | 371/471 [08:14<02:13,  1.34s/it] 79%|███████▉  | 372/471 [08:15<02:12,  1.34s/it] 79%|███████▉  | 373/471 [08:16<02:11,  1.34s/it] 79%|███████▉  | 374/471 [08:18<02:09,  1.34s/it] 80%|███████▉  | 375/471 [08:19<02:08,  1.33s/it] 80%|███████▉  | 376/471 [08:20<02:06,  1.33s/it] 80%|████████  | 377/471 [08:22<02:05,  1.33s/it] 80%|████████  | 378/471 [08:23<02:03,  1.33s/it] 80%|████████  | 379/471 [08:24<02:02,  1.33s/it] 81%|████████  | 380/471 [08:26<02:01,  1.34s/it] 81%|████████  | 381/471 [08:27<02:00,  1.34s/it] 81%|████████  | 382/471 [08:28<01:58,  1.34s/it] 81%|████████▏ | 383/471 [08:30<01:57,  1.34s/it] 82%|████████▏ | 384/471 [08:31<01:56,  1.34s/it] 82%|████████▏ | 385/471 [08:32<01:55,  1.34s/it] 82%|████████▏ | 386/471 [08:34<01:53,  1.34s/it] 82%|████████▏ | 387/471 [08:35<01:52,  1.34s/it] 82%|████████▏ | 388/471 [08:36<01:51,  1.34s/it] 83%|████████▎ | 389/471 [08:38<01:49,  1.34s/it] 83%|████████▎ | 390/471 [08:39<01:48,  1.34s/it] 83%|████████▎ | 391/471 [08:40<01:46,  1.34s/it] 83%|████████▎ | 392/471 [08:42<01:45,  1.34s/it] 83%|████████▎ | 393/471 [08:43<01:44,  1.34s/it] 84%|████████▎ | 394/471 [08:44<01:42,  1.34s/it] 84%|████████▍ | 395/471 [08:46<01:41,  1.34s/it] 84%|████████▍ | 396/471 [08:47<01:40,  1.34s/it] 84%|████████▍ | 397/471 [08:48<01:38,  1.34s/it] 85%|████████▍ | 398/471 [08:50<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:51<01:36,  1.34s/it] 85%|████████▍ | 400/471 [08:52<01:34,  1.34s/it] 85%|████████▌ | 401/471 [08:54<01:33,  1.33s/it] 85%|████████▌ | 402/471 [08:55<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:56<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:58<01:29,  1.33s/it] 86%|████████▌ | 405/471 [08:59<01:27,  1.33s/it] 86%|████████▌ | 406/471 [09:00<01:26,  1.33s/it] 86%|████████▋ | 407/471 [09:02<01:25,  1.33s/it] 87%|████████▋ | 408/471 [09:03<01:23,  1.33s/it] 87%|████████▋ | 409/471 [09:04<01:22,  1.34s/it] 87%|████████▋ | 410/471 [09:06<01:21,  1.33s/it] 87%|████████▋ | 411/471 [09:07<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:08<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:10<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:11<01:16,  1.33s/it] 88%|████████▊ | 415/471 [09:12<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:14<01:13,  1.34s/it] 89%|████████▊ | 417/471 [09:15<01:12,  1.34s/it] 89%|████████▊ | 418/471 [09:16<01:10,  1.34s/it] 89%|████████▉ | 419/471 [09:18<01:09,  1.34s/it] 89%|████████▉ | 420/471 [09:19<01:08,  1.34s/it] 89%|████████▉ | 421/471 [09:20<01:06,  1.34s/it] 90%|████████▉ | 422/471 [09:22<01:05,  1.34s/it] 90%|████████▉ | 423/471 [09:23<01:04,  1.34s/it] 90%|█████████ | 424/471 [09:24<01:02,  1.34s/it] 90%|█████████ | 425/471 [09:26<01:01,  1.34s/it] 90%|█████████ | 426/471 [09:27<01:00,  1.34s/it] 91%|█████████ | 427/471 [09:28<00:58,  1.34s/it] 91%|█████████ | 428/471 [09:30<00:57,  1.34s/it] 91%|█████████ | 429/471 [09:31<00:56,  1.34s/it] 91%|█████████▏| 430/471 [09:32<00:54,  1.34s/it] 92%|█████████▏| 431/471 [09:34<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:35<00:52,  1.34s/it] 92%|█████████▏| 433/471 [09:36<00:50,  1.34s/it] 92%|█████████▏| 434/471 [09:38<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:39<00:48,  1.34s/it] 93%|█████████▎| 436/471 [09:40<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:42<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:43<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:44<00:42,  1.33s/it] 93%|█████████▎| 440/471 [09:46<00:41,  1.33s/it] 94%|█████████▎| 441/471 [09:47<00:40,  1.33s/it] 94%|█████████▍| 442/471 [09:48<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:50<00:37,  1.33s/it] 94%|█████████▍| 444/471 [09:51<00:36,  1.33s/it] 94%|█████████▍| 445/471 [09:52<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:54<00:33,  1.33s/it] 95%|█████████▍| 447/471 [09:55<00:32,  1.33s/it] 95%|█████████▌| 448/471 [09:56<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:58<00:29,  1.33s/it] 96%|█████████▌| 450/471 [09:59<00:28,  1.33s/it] 96%|█████████▌| 451/471 [10:00<00:26,  1.33s/it] 96%|█████████▌| 452/471 [10:02<00:25,  1.33s/it] 96%|█████████▌| 453/471 [10:03<00:24,  1.34s/it] 96%|█████████▋| 454/471 [10:04<00:22,  1.34s/it] 97%|█████████▋| 455/471 [10:06<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:07<00:20,  1.34s/it] 97%|█████████▋| 457/471 [10:08<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:10<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:11<00:16,  1.33s/it] 98%|█████████▊| 460/471 [10:12<00:14,  1.33s/it] 98%|█████████▊| 461/471 [10:14<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:15<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:16<00:10,  1.34s/it] 99%|█████████▊| 464/471 [10:18<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:19<00:08,  1.33s/it] 99%|█████████▉| 466/471 [10:21<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:22<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:23<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:25<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:26<00:01,  1.34s/it]100%|██████████| 471/471 [10:27<00:00,  1.23s/it]100%|██████████| 471/471 [10:27<00:00,  1.33s/it]
{'eval_loss': 2.9140102863311768, 'eval_model_preparation_time': 0.0115, 'eval_acc': 0.30523101433882105, 'eval_runtime': 628.5622, 'eval_samples_per_second': 11.983, 'eval_steps_per_second': 0.749}
ROUND:14
CLIENT:72
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 3.9152, 'grad_norm': 10.812385559082031, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.2343, 'grad_norm': 10.510927200317383, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.2899, 'grad_norm': 15.023810386657715, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 2.0907, 'grad_norm': 12.233357429504395, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it]                                              {'loss': 1.3524, 'grad_norm': 11.027915000915527, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:17,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.3429, 'grad_norm': 8.37421989440918, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it]                                              {'loss': 1.9074, 'grad_norm': 9.185513496398926, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 3.554, 'grad_norm': 96.61044311523438, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.0256, 'grad_norm': 8.129728317260742, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.90s/it]                                               {'loss': 0.7731, 'grad_norm': 6.367926120758057, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.3611, 'grad_norm': 2.565072774887085, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.10s/it]                                               {'loss': 0.2492, 'grad_norm': 3.25319766998291, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.10s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it]                                               {'loss': 1.2298, 'grad_norm': 10.443474769592285, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it]                                               {'loss': 0.3146, 'grad_norm': 3.456559658050537, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.4177, 'grad_norm': 1.9681123495101929, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.002, 'grad_norm': 0.1017322689294815, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.1522, 'grad_norm': 2.2551229000091553, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.3876, 'grad_norm': 5.058237552642822, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.3612, 'grad_norm': 1.3427481651306152, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:42,  2.11s/it]                                               {'loss': 0.3793, 'grad_norm': 2.6068716049194336, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:42<00:41,  2.16s/it]                                               {'loss': 0.0537, 'grad_norm': 1.3672113418579102, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:41,  2.16s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.20s/it]                                               {'loss': 0.1439, 'grad_norm': 2.317993640899658, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.20s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.22s/it]                                               {'loss': 0.4803, 'grad_norm': 2.8957674503326416, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.22s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 0.0005, 'grad_norm': 0.03104860708117485, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it]                                               {'loss': 0.1467, 'grad_norm': 1.5193005800247192, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it]                                               {'loss': 0.2278, 'grad_norm': 3.5156729221343994, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it]                                               {'loss': 0.3905, 'grad_norm': 1.2211661338806152, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it] 70%|███████   | 28/40 [00:56<00:25,  2.13s/it]                                               {'loss': 0.2259, 'grad_norm': 2.027543306350708, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.13s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.18s/it]                                               {'loss': 0.2455, 'grad_norm': 1.2857624292373657, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.18s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it]                                               {'loss': 0.0676, 'grad_norm': 1.1879456043243408, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.21s/it] 78%|███████▊  | 31/40 [01:03<00:20,  2.24s/it]                                               {'loss': 0.0722, 'grad_norm': 0.7001367211341858, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:20,  2.24s/it] 80%|████████  | 32/40 [01:03<00:12,  1.62s/it]                                               {'loss': 0.0456, 'grad_norm': 1.7832163572311401, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.62s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.82s/it]                                               {'loss': 0.074, 'grad_norm': 2.1765823364257812, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.82s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it]                                               {'loss': 0.0184, 'grad_norm': 0.24981877207756042, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.5007, 'grad_norm': 3.200061321258545, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.3225, 'grad_norm': 2.074467897415161, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it]                                               {'loss': 0.1057, 'grad_norm': 3.210759401321411, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.22s/it]                                               {'loss': 0.0754, 'grad_norm': 1.722299575805664, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.22s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.0455, 'grad_norm': 1.21616792678833, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:19<00:00,  1.63s/it]                                               {'loss': 0.0171, 'grad_norm': 1.049058198928833, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.63s/it]                                               {'train_runtime': 80.2867, 'train_samples_per_second': 7.037, 'train_steps_per_second': 0.498, 'train_loss': 0.6899966977056465, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.63s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 2.4572, 'grad_norm': 11.664864540100098, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:23,  2.21s/it]                                              {'loss': 2.0207, 'grad_norm': 12.456357955932617, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.21s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 3.0292, 'grad_norm': 18.47384262084961, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:19,  2.22s/it]                                              {'loss': 1.4449, 'grad_norm': 14.262633323669434, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:18,  2.23s/it]                                              {'loss': 0.9373, 'grad_norm': 7.812864303588867, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:18,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:16,  2.24s/it]                                              {'loss': 1.5325, 'grad_norm': 13.468057632446289, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:16,  2.24s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.24s/it]                                              {'loss': 1.7819, 'grad_norm': 17.142885208129883, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.24s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 3.7896, 'grad_norm': 53.237403869628906, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 0.3732, 'grad_norm': 5.620694637298584, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 0.8402, 'grad_norm': 7.3508172035217285, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it]                                               {'loss': 0.7166, 'grad_norm': 5.880251407623291, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it] 30%|███       | 12/40 [00:24<00:58,  2.10s/it]                                               {'loss': 0.6259, 'grad_norm': 6.779991149902344, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.10s/it] 32%|███▎      | 13/40 [00:27<00:57,  2.14s/it]                                               {'loss': 0.3155, 'grad_norm': 5.398532867431641, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it]                                               {'loss': 0.8041, 'grad_norm': 7.622977256774902, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.18s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.21s/it]                                               {'loss': 0.2443, 'grad_norm': 3.458493232727051, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.21s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 0.0002, 'grad_norm': 0.01265990175306797, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:34<00:41,  1.81s/it]                                               {'loss': 0.3305, 'grad_norm': 3.4365386962890625, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:41,  1.81s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.2942, 'grad_norm': 4.4114484786987305, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.3564, 'grad_norm': 2.9302730560302734, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:42,  2.11s/it]                                               {'loss': 0.1762, 'grad_norm': 2.2281861305236816, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:43<00:41,  2.16s/it]                                               {'loss': 0.1244, 'grad_norm': 2.255521059036255, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:41,  2.16s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it]                                               {'loss': 0.1731, 'grad_norm': 1.2794009447097778, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.1322, 'grad_norm': 2.1831204891204834, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 0.0029, 'grad_norm': 0.20989705622196198, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:50<00:27,  1.81s/it]                                               {'loss': 0.0768, 'grad_norm': 1.3624061346054077, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:27,  1.81s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it]                                               {'loss': 0.3474, 'grad_norm': 2.820716381072998, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.06s/it]                                               {'loss': 0.0566, 'grad_norm': 1.0264641046524048, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.06s/it] 70%|███████   | 28/40 [00:56<00:25,  2.12s/it]                                               {'loss': 0.0832, 'grad_norm': 1.8926279544830322, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.17s/it]                                               {'loss': 0.1357, 'grad_norm': 2.5215675830841064, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.17s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.20s/it]                                               {'loss': 0.1409, 'grad_norm': 1.3460891246795654, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.20s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.0182, 'grad_norm': 0.3949112892150879, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0021, 'grad_norm': 0.1720024049282074, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.80s/it]                                               {'loss': 0.2257, 'grad_norm': 1.42814040184021, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it]                                               {'loss': 0.033, 'grad_norm': 1.500251054763794, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.0748, 'grad_norm': 0.8840988278388977, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.12s/it]                                               {'loss': 0.0584, 'grad_norm': 2.392411470413208, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.16s/it]                                               {'loss': 0.0459, 'grad_norm': 1.6331312656402588, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it]                                               {'loss': 0.0581, 'grad_norm': 1.0826627016067505, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.0276, 'grad_norm': 1.2422924041748047, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:20<00:00,  1.62s/it]                                               {'loss': 0.0288, 'grad_norm': 1.7626703977584839, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]                                               {'train_runtime': 80.4156, 'train_samples_per_second': 7.026, 'train_steps_per_second': 0.497, 'train_loss': 0.597908714537698, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:58
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 3.1888, 'grad_norm': 12.453405380249023, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.0442, 'grad_norm': 12.415497779846191, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.7756, 'grad_norm': 11.274947166442871, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.7941, 'grad_norm': 14.952836036682129, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.39, 'grad_norm': 17.846290588378906, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 3.2334, 'grad_norm': 29.735782623291016, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.3943, 'grad_norm': 12.727004051208496, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.1951, 'grad_norm': 8.737439155578613, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.6162, 'grad_norm': 6.42048978805542, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.7084, 'grad_norm': 10.349285125732422, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.7638, 'grad_norm': 6.536066055297852, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.8457, 'grad_norm': 5.612246513366699, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.0045, 'grad_norm': 7.180941581726074, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.8251, 'grad_norm': 7.707040786743164, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 1.1592, 'grad_norm': 8.594789505004883, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0571, 'grad_norm': 1.7807197570800781, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.4007, 'grad_norm': 2.6157000064849854, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.1737, 'grad_norm': 2.1612370014190674, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.2856, 'grad_norm': 2.2362074851989746, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.3978, 'grad_norm': 3.6374900341033936, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.0719, 'grad_norm': 1.2033880949020386, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.7426, 'grad_norm': 9.972034454345703, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.0829, 'grad_norm': 1.5906217098236084, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.134, 'grad_norm': 6.804358959197998, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.0124, 'grad_norm': 0.24680455029010773, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.0952, 'grad_norm': 1.5605082511901855, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.0809, 'grad_norm': 1.2973217964172363, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.0326, 'grad_norm': 0.7513219118118286, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1086, 'grad_norm': 2.491122245788574, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1078, 'grad_norm': 1.4174962043762207, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.3016, 'grad_norm': 3.256300210952759, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0174, 'grad_norm': 0.604854941368103, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.2567, 'grad_norm': 2.11238956451416, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.0326, 'grad_norm': 1.001091480255127, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.024, 'grad_norm': 0.4472463130950928, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0401, 'grad_norm': 0.42528271675109863, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0215, 'grad_norm': 0.45589926838874817, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.11, 'grad_norm': 5.740359783172607, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0318, 'grad_norm': 1.0842399597167969, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.004, 'grad_norm': 0.19754764437675476, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.9394, 'train_samples_per_second': 7.157, 'train_steps_per_second': 0.507, 'train_loss': 0.6390444538905286, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 3.8107, 'grad_norm': 12.264532089233398, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]                                              {'loss': 2.1704, 'grad_norm': 11.796664237976074, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.12s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.1386, 'grad_norm': 11.514215469360352, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.7751, 'grad_norm': 11.165343284606934, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 2.9714, 'grad_norm': 17.460182189941406, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 2.188, 'grad_norm': 11.488855361938477, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 1.6381, 'grad_norm': 12.631622314453125, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.1174, 'grad_norm': 41.183265686035156, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.6412, 'grad_norm': 23.631155014038086, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 2.3607, 'grad_norm': 12.257759094238281, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.2273, 'grad_norm': 9.905757904052734, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.4371, 'grad_norm': 4.360347270965576, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.6189, 'grad_norm': 10.666686058044434, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.114, 'grad_norm': 8.669158935546875, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 1.0615, 'grad_norm': 10.053662300109863, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 1.4535, 'grad_norm': 44.585227966308594, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.7904, 'grad_norm': 6.2391357421875, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.7186, 'grad_norm': 9.274831771850586, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.7052, 'grad_norm': 9.478212356567383, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.683, 'grad_norm': 7.602449893951416, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.5014, 'grad_norm': 1.8139394521713257, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.5653, 'grad_norm': 10.920413970947266, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.5644, 'grad_norm': 5.62560510635376, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.037, 'grad_norm': 1.8368816375732422, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.144, 'grad_norm': 2.0507607460021973, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.652, 'grad_norm': 3.643423318862915, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.1361, 'grad_norm': 4.638355255126953, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.4226, 'grad_norm': 3.2134757041931152, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.6095, 'grad_norm': 3.474923849105835, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.7095, 'grad_norm': 3.9384615421295166, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.549, 'grad_norm': 6.8674235343933105, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0011, 'grad_norm': 0.09494767338037491, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.5368, 'grad_norm': 7.322023391723633, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.2503, 'grad_norm': 4.705233097076416, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.4082, 'grad_norm': 4.637227535247803, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.1558, 'grad_norm': 4.726502418518066, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.3394, 'grad_norm': 3.213026285171509, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.2673, 'grad_norm': 6.169565200805664, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.5273, 'grad_norm': 15.936903953552246, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 1.0789, 'grad_norm': 28.92292594909668, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.9543, 'train_samples_per_second': 7.156, 'train_steps_per_second': 0.507, 'train_loss': 1.0019230773148593, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.13s/it]                                              {'loss': 3.3507, 'grad_norm': 11.044326782226562, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.13s/it]  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]                                              {'loss': 2.5656, 'grad_norm': 12.46282958984375, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:20,  2.13s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.4406, 'grad_norm': 11.27743148803711, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.9052, 'grad_norm': 9.114546775817871, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.3452, 'grad_norm': 10.425087928771973, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.2853, 'grad_norm': 12.228520393371582, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 1.2235, 'grad_norm': 7.563204288482666, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.4593, 'grad_norm': 70.02383422851562, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 2.6803, 'grad_norm': 31.10739517211914, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 1.4036, 'grad_norm': 16.07730484008789, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.0805, 'grad_norm': 2.148912191390991, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.1216, 'grad_norm': 6.498825550079346, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.5552, 'grad_norm': 6.409204006195068, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.3817, 'grad_norm': 4.458773612976074, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.6349, 'grad_norm': 15.681160926818848, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.0, 'grad_norm': 0.001258484786376357, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.4111, 'grad_norm': 2.668631076812744, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.4181, 'grad_norm': 6.104281425476074, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.411, 'grad_norm': 7.303420066833496, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.08s/it]                                               {'loss': 0.4384, 'grad_norm': 5.254772186279297, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.282, 'grad_norm': 2.500279188156128, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.4102, 'grad_norm': 2.498300075531006, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.5277, 'grad_norm': 5.354807376861572, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.0789, 'grad_norm': 2.1735305786132812, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.3225, 'grad_norm': 4.674622535705566, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.0188, 'grad_norm': 0.6083738207817078, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0973, 'grad_norm': 3.243100643157959, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.3143, 'grad_norm': 1.5592769384384155, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.0736, 'grad_norm': 1.6865721940994263, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.3021, 'grad_norm': 4.055081367492676, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.0717, 'grad_norm': 1.210421085357666, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0005, 'grad_norm': 0.02371431142091751, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0063, 'grad_norm': 0.12593454122543335, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.4754, 'grad_norm': 3.622462034225464, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.1066, 'grad_norm': 1.63783860206604, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0416, 'grad_norm': 0.84287029504776, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.2371, 'grad_norm': 18.38443946838379, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.1531, 'grad_norm': 3.96662974357605, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0178, 'grad_norm': 0.5488488078117371, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0261, 'grad_norm': 1.253690242767334, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.7401, 'train_samples_per_second': 7.176, 'train_steps_per_second': 0.508, 'train_loss': 0.6668933062477208, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:84
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 1.9454, 'grad_norm': 9.839556694030762, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 1.789, 'grad_norm': 7.910143852233887, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.4752, 'grad_norm': 19.179332733154297, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.1107, 'grad_norm': 10.407423973083496, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 2.292, 'grad_norm': 13.553747177124023, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it]                                              {'loss': 1.126, 'grad_norm': 11.266231536865234, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.6648, 'grad_norm': 11.172124862670898, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 4.1409, 'grad_norm': 55.01997756958008, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.4078, 'grad_norm': 3.0997159481048584, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.9038, 'grad_norm': 5.443114757537842, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 0.8225, 'grad_norm': 6.88407564163208, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.3799, 'grad_norm': 4.3344011306762695, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.3555, 'grad_norm': 8.071127891540527, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.1103, 'grad_norm': 2.13903546333313, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.5877, 'grad_norm': 4.362604141235352, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.073, 'grad_norm': 4.765362739562988, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.1284, 'grad_norm': 1.918731927871704, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.3919, 'grad_norm': 1.1770414113998413, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.0739, 'grad_norm': 2.017611265182495, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.6168, 'grad_norm': 3.3238022327423096, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.2251, 'grad_norm': 4.661728858947754, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.3792, 'grad_norm': 3.615387439727783, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.0799, 'grad_norm': 1.2630560398101807, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0, 'grad_norm': 0.006083580665290356, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it]                                               {'loss': 0.0862, 'grad_norm': 1.7020152807235718, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.1881, 'grad_norm': 4.599947452545166, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.5718, 'grad_norm': 10.279158592224121, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.1682, 'grad_norm': 2.3261828422546387, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.0434, 'grad_norm': 0.6803955435752869, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.0739, 'grad_norm': 1.1574231386184692, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.0233, 'grad_norm': 0.8161138296127319, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0207, 'grad_norm': 1.0755579471588135, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0101, 'grad_norm': 0.3852623701095581, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.93s/it]                                               {'loss': 0.0092, 'grad_norm': 0.2499457150697708, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1117, 'grad_norm': 1.8411251306533813, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0399, 'grad_norm': 0.6993485689163208, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 1.1905, 'grad_norm': 10.709291458129883, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.0283, 'grad_norm': 0.6645268201828003, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.08, 'grad_norm': 5.986818313598633, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0347, 'grad_norm': 3.7106502056121826, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.5807, 'train_samples_per_second': 7.19, 'train_steps_per_second': 0.509, 'train_loss': 0.6439986386625606, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:54
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 3.596, 'grad_norm': 11.60394287109375, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.2158, 'grad_norm': 9.95107364654541, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.19s/it]                                              {'loss': 1.6074, 'grad_norm': 10.787800788879395, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.19s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 0.9352, 'grad_norm': 8.091043472290039, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 1.9547, 'grad_norm': 15.16950511932373, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 3.7007, 'grad_norm': 20.081148147583008, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 4.1668, 'grad_norm': 47.4698600769043, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.0436, 'grad_norm': 42.78376770019531, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 1.543, 'grad_norm': 12.568161964416504, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.9975, 'grad_norm': 7.642165184020996, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.2072, 'grad_norm': 8.569819450378418, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.2208, 'grad_norm': 8.759017944335938, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.3716, 'grad_norm': 8.50639820098877, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.1136, 'grad_norm': 6.650829315185547, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.3752, 'grad_norm': 10.698355674743652, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.2701, 'grad_norm': 14.875415802001953, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.7788, 'grad_norm': 7.470712184906006, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.4041, 'grad_norm': 2.9767487049102783, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.0932, 'grad_norm': 2.0619394779205322, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.2801, 'grad_norm': 3.4972281455993652, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.4315, 'grad_norm': 2.7094528675079346, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.4236, 'grad_norm': 2.8631997108459473, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it]                                               {'loss': 0.2911, 'grad_norm': 4.4337921142578125, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.0098, 'grad_norm': 0.5243260860443115, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.4764, 'grad_norm': 3.1422688961029053, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.1353, 'grad_norm': 1.5734189748764038, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.1467, 'grad_norm': 1.5082589387893677, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.1018, 'grad_norm': 0.944713830947876, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.0714, 'grad_norm': 0.8299793601036072, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.1307, 'grad_norm': 2.2964868545532227, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.075, 'grad_norm': 1.7818711996078491, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0017, 'grad_norm': 0.1503979116678238, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0654, 'grad_norm': 1.9895579814910889, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.0579, 'grad_norm': 0.7983886003494263, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.0389, 'grad_norm': 0.7943524122238159, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.0558, 'grad_norm': 1.873428463935852, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.0407, 'grad_norm': 0.8869686722755432, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0816, 'grad_norm': 1.63910973072052, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.1621, 'grad_norm': 4.006165504455566, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0552, 'grad_norm': 3.7233800888061523, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2779, 'train_samples_per_second': 7.127, 'train_steps_per_second': 0.505, 'train_loss': 0.8181978834676557, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 2.2989, 'grad_norm': 11.044002532958984, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.102, 'grad_norm': 13.508386611938477, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.1882, 'grad_norm': 17.266164779663086, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 4.0649, 'grad_norm': 20.764949798583984, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.3, 'grad_norm': 18.051517486572266, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.6911, 'grad_norm': 12.818757057189941, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.0891, 'grad_norm': 7.889004707336426, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 3.0677, 'grad_norm': 51.034786224365234, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.6893, 'grad_norm': 7.446308612823486, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.0393, 'grad_norm': 10.800688743591309, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.8294, 'grad_norm': 7.651805877685547, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.2829, 'grad_norm': 11.649455070495605, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.8909, 'grad_norm': 11.9805269241333, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.9876, 'grad_norm': 8.075202941894531, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it]                                               {'loss': 0.7727, 'grad_norm': 5.880417823791504, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 1.4887, 'grad_norm': 32.81158447265625, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.6239, 'grad_norm': 4.683000087738037, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.09, 'grad_norm': 0.9314261674880981, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it]                                               {'loss': 0.6511, 'grad_norm': 9.023085594177246, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.3919, 'grad_norm': 5.365528583526611, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.4747, 'grad_norm': 7.833372592926025, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.1413, 'grad_norm': 3.217282772064209, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.2315, 'grad_norm': 2.2834033966064453, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.0546, 'grad_norm': 2.2915151119232178, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.2238, 'grad_norm': 4.373785972595215, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.5453, 'grad_norm': 7.756280422210693, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.1097, 'grad_norm': 1.730388879776001, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.2671, 'grad_norm': 2.070878744125366, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.0758, 'grad_norm': 1.3630257844924927, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0629, 'grad_norm': 2.1058008670806885, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.077, 'grad_norm': 2.274794101715088, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.078, 'grad_norm': 5.032845973968506, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.013, 'grad_norm': 0.4479290544986725, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0097, 'grad_norm': 0.22882243990898132, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0197, 'grad_norm': 0.31523919105529785, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.1164, 'grad_norm': 1.3293062448501587, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.0536, 'grad_norm': 0.9536006450653076, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0554, 'grad_norm': 1.3615590333938599, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0411, 'grad_norm': 1.2543329000473022, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0009, 'grad_norm': 0.04939768835902214, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2642, 'train_samples_per_second': 7.128, 'train_steps_per_second': 0.505, 'train_loss': 0.8297782048408407, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 3.0939, 'grad_norm': 11.398038864135742, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 1.399, 'grad_norm': 9.631954193115234, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.0053, 'grad_norm': 11.871003150939941, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.671, 'grad_norm': 16.452720642089844, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 1.5021, 'grad_norm': 17.368797302246094, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.8056, 'grad_norm': 11.86736011505127, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.4164, 'grad_norm': 13.57960033416748, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.8347, 'grad_norm': 61.542667388916016, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.0101, 'grad_norm': 5.855334758758545, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.6252, 'grad_norm': 5.8474955558776855, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.5025, 'grad_norm': 4.952969551086426, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.8085, 'grad_norm': 6.5221123695373535, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.363, 'grad_norm': 4.475495338439941, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.3538, 'grad_norm': 4.731290340423584, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.4841, 'grad_norm': 5.66611909866333, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.8768, 'grad_norm': 14.323277473449707, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.1749, 'grad_norm': 3.1691558361053467, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.1008, 'grad_norm': 2.5717086791992188, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.24, 'grad_norm': 2.0982518196105957, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.08s/it]                                               {'loss': 0.367, 'grad_norm': 5.542282581329346, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.1754, 'grad_norm': 2.152223825454712, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.3705, 'grad_norm': 2.77378249168396, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.1465, 'grad_norm': 1.6205103397369385, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0929, 'grad_norm': 4.012402534484863, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.239, 'grad_norm': 3.117753505706787, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it]                                               {'loss': 0.0717, 'grad_norm': 0.9877814054489136, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.0477, 'grad_norm': 0.8362241387367249, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.2365, 'grad_norm': 0.8788010478019714, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.0779, 'grad_norm': 1.4941473007202148, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1753, 'grad_norm': 7.816834449768066, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0329, 'grad_norm': 0.7443879246711731, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0011, 'grad_norm': 0.1083599105477333, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1385, 'grad_norm': 1.0463746786117554, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0868, 'grad_norm': 0.9952514171600342, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.0195, 'grad_norm': 0.37629589438438416, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0314, 'grad_norm': 0.44301483035087585, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.1871, 'grad_norm': 10.329079627990723, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.3099, 'grad_norm': 6.170755863189697, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0533, 'grad_norm': 1.4505544900894165, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0006, 'grad_norm': 0.05684763565659523, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.8982, 'train_samples_per_second': 7.161, 'train_steps_per_second': 0.507, 'train_loss': 0.6032298719583196, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:40
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.8761, 'grad_norm': 11.936030387878418, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.5238, 'grad_norm': 12.287725448608398, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.3027, 'grad_norm': 10.83544635772705, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.9262, 'grad_norm': 12.332962036132812, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.32, 'grad_norm': 8.408900260925293, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.6366, 'grad_norm': 9.032588005065918, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 2.0699, 'grad_norm': 12.191391944885254, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.4151, 'grad_norm': 39.7141227722168, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.7334, 'grad_norm': 8.628661155700684, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.8525, 'grad_norm': 6.2894287109375, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.4967, 'grad_norm': 2.631072759628296, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.2387, 'grad_norm': 2.8495357036590576, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it]                                               {'loss': 0.6733, 'grad_norm': 7.295060157775879, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.4915, 'grad_norm': 4.217018127441406, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.4995, 'grad_norm': 6.000898838043213, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.8293, 'grad_norm': 24.9136962890625, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.1527, 'grad_norm': 0.9974046349525452, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.3292, 'grad_norm': 1.0580761432647705, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.2618, 'grad_norm': 1.8941917419433594, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.2689, 'grad_norm': 4.920902252197266, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.4351, 'grad_norm': 3.0383241176605225, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.1141, 'grad_norm': 1.3271660804748535, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.1363, 'grad_norm': 2.164769172668457, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.0006, 'grad_norm': 0.030324192717671394, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.0766, 'grad_norm': 1.6991262435913086, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.1448, 'grad_norm': 2.398484706878662, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it]                                               {'loss': 1.0368, 'grad_norm': 6.711462020874023, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.6845, 'grad_norm': 10.264923095703125, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.2493, 'grad_norm': 6.410236835479736, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.6386, 'grad_norm': 15.037467002868652, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0718, 'grad_norm': 0.9535685777664185, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0361, 'grad_norm': 0.9909191727638245, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.1771, 'grad_norm': 3.1434903144836426, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.2762, 'grad_norm': 2.334763765335083, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.1119, 'grad_norm': 8.7404146194458, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.2334, 'grad_norm': 2.3161094188690186, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0784, 'grad_norm': 1.9599738121032715, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1314, 'grad_norm': 2.1514341831207275, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0508, 'grad_norm': 1.8256030082702637, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0203, 'grad_norm': 0.819508969783783, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2202, 'train_samples_per_second': 7.132, 'train_steps_per_second': 0.505, 'train_loss': 0.6400446828178247, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:56,  1.58it/s]  1%|          | 3/471 [00:02<06:59,  1.11it/s]  1%|          | 4/471 [00:03<08:06,  1.04s/it]  1%|          | 5/471 [00:05<08:43,  1.12s/it]  1%|▏         | 6/471 [00:06<09:06,  1.18s/it]  1%|▏         | 7/471 [00:07<09:22,  1.21s/it]  2%|▏         | 8/471 [00:08<09:32,  1.24s/it]  2%|▏         | 9/471 [00:10<09:37,  1.25s/it]  2%|▏         | 10/471 [00:11<09:41,  1.26s/it]  2%|▏         | 11/471 [00:12<09:43,  1.27s/it]  3%|▎         | 12/471 [00:14<09:45,  1.28s/it]  3%|▎         | 13/471 [00:15<09:46,  1.28s/it]  3%|▎         | 14/471 [00:16<09:46,  1.28s/it]  3%|▎         | 15/471 [00:17<09:46,  1.29s/it]  3%|▎         | 16/471 [00:19<09:46,  1.29s/it]  4%|▎         | 17/471 [00:20<09:46,  1.29s/it]  4%|▍         | 18/471 [00:21<09:46,  1.29s/it]  4%|▍         | 19/471 [00:23<09:45,  1.30s/it]  4%|▍         | 20/471 [00:24<09:45,  1.30s/it]  4%|▍         | 21/471 [00:25<09:44,  1.30s/it]  5%|▍         | 22/471 [00:27<09:44,  1.30s/it]  5%|▍         | 23/471 [00:28<09:43,  1.30s/it]  5%|▌         | 24/471 [00:29<09:42,  1.30s/it]  5%|▌         | 25/471 [00:30<09:41,  1.30s/it]  6%|▌         | 26/471 [00:32<09:40,  1.31s/it]  6%|▌         | 27/471 [00:33<09:39,  1.31s/it]  6%|▌         | 28/471 [00:34<09:38,  1.31s/it]  6%|▌         | 29/471 [00:36<09:37,  1.31s/it]  6%|▋         | 30/471 [00:37<09:37,  1.31s/it]  7%|▋         | 31/471 [00:38<09:36,  1.31s/it]  7%|▋         | 32/471 [00:40<09:35,  1.31s/it]  7%|▋         | 33/471 [00:41<09:32,  1.31s/it]  7%|▋         | 34/471 [00:42<09:32,  1.31s/it]  7%|▋         | 35/471 [00:44<09:32,  1.31s/it]  8%|▊         | 36/471 [00:45<09:30,  1.31s/it]  8%|▊         | 37/471 [00:46<09:30,  1.31s/it]  8%|▊         | 38/471 [00:48<09:29,  1.32s/it]  8%|▊         | 39/471 [00:49<09:28,  1.32s/it]  8%|▊         | 40/471 [00:50<09:27,  1.32s/it]  9%|▊         | 41/471 [00:52<09:26,  1.32s/it]  9%|▉         | 42/471 [00:53<09:25,  1.32s/it]  9%|▉         | 43/471 [00:54<09:23,  1.32s/it]  9%|▉         | 44/471 [00:55<09:22,  1.32s/it] 10%|▉         | 45/471 [00:57<09:22,  1.32s/it] 10%|▉         | 46/471 [00:58<09:21,  1.32s/it] 10%|▉         | 47/471 [00:59<09:20,  1.32s/it] 10%|█         | 48/471 [01:01<09:19,  1.32s/it] 10%|█         | 49/471 [01:02<09:18,  1.32s/it] 11%|█         | 50/471 [01:03<09:17,  1.32s/it] 11%|█         | 51/471 [01:05<09:16,  1.32s/it] 11%|█         | 52/471 [01:06<09:15,  1.32s/it] 11%|█▏        | 53/471 [01:07<09:14,  1.33s/it] 11%|█▏        | 54/471 [01:09<09:13,  1.33s/it] 12%|█▏        | 55/471 [01:10<09:12,  1.33s/it] 12%|█▏        | 56/471 [01:11<09:11,  1.33s/it] 12%|█▏        | 57/471 [01:13<09:10,  1.33s/it] 12%|█▏        | 58/471 [01:14<09:08,  1.33s/it] 13%|█▎        | 59/471 [01:15<09:07,  1.33s/it] 13%|█▎        | 60/471 [01:17<09:06,  1.33s/it] 13%|█▎        | 61/471 [01:18<09:04,  1.33s/it] 13%|█▎        | 62/471 [01:19<09:03,  1.33s/it] 13%|█▎        | 63/471 [01:21<09:01,  1.33s/it] 14%|█▎        | 64/471 [01:22<09:00,  1.33s/it] 14%|█▍        | 65/471 [01:23<08:59,  1.33s/it] 14%|█▍        | 66/471 [01:25<08:58,  1.33s/it] 14%|█▍        | 67/471 [01:26<08:57,  1.33s/it] 14%|█▍        | 68/471 [01:27<08:55,  1.33s/it] 15%|█▍        | 69/471 [01:29<08:54,  1.33s/it] 15%|█▍        | 70/471 [01:30<08:53,  1.33s/it] 15%|█▌        | 71/471 [01:31<08:52,  1.33s/it] 15%|█▌        | 72/471 [01:33<08:51,  1.33s/it] 15%|█▌        | 73/471 [01:34<08:49,  1.33s/it] 16%|█▌        | 74/471 [01:35<08:47,  1.33s/it] 16%|█▌        | 75/471 [01:37<08:46,  1.33s/it] 16%|█▌        | 76/471 [01:38<08:44,  1.33s/it] 16%|█▋        | 77/471 [01:39<08:43,  1.33s/it] 17%|█▋        | 78/471 [01:41<08:42,  1.33s/it] 17%|█▋        | 79/471 [01:42<08:41,  1.33s/it] 17%|█▋        | 80/471 [01:43<08:40,  1.33s/it] 17%|█▋        | 81/471 [01:45<08:37,  1.33s/it] 17%|█▋        | 82/471 [01:46<08:36,  1.33s/it] 18%|█▊        | 83/471 [01:47<08:35,  1.33s/it] 18%|█▊        | 84/471 [01:49<08:34,  1.33s/it] 18%|█▊        | 85/471 [01:50<08:33,  1.33s/it] 18%|█▊        | 86/471 [01:51<08:31,  1.33s/it] 18%|█▊        | 87/471 [01:53<08:30,  1.33s/it] 19%|█▊        | 88/471 [01:54<08:28,  1.33s/it] 19%|█▉        | 89/471 [01:55<08:27,  1.33s/it] 19%|█▉        | 90/471 [01:57<08:26,  1.33s/it] 19%|█▉        | 91/471 [01:58<08:24,  1.33s/it] 20%|█▉        | 92/471 [01:59<08:24,  1.33s/it] 20%|█▉        | 93/471 [02:01<08:23,  1.33s/it] 20%|█▉        | 94/471 [02:02<08:21,  1.33s/it] 20%|██        | 95/471 [02:03<08:20,  1.33s/it] 20%|██        | 96/471 [02:05<08:19,  1.33s/it] 21%|██        | 97/471 [02:06<08:19,  1.33s/it] 21%|██        | 98/471 [02:07<08:17,  1.33s/it] 21%|██        | 99/471 [02:09<08:16,  1.33s/it] 21%|██        | 100/471 [02:10<08:15,  1.33s/it] 21%|██▏       | 101/471 [02:11<08:14,  1.34s/it] 22%|██▏       | 102/471 [02:13<08:13,  1.34s/it] 22%|██▏       | 103/471 [02:14<08:12,  1.34s/it] 22%|██▏       | 104/471 [02:15<08:12,  1.34s/it] 22%|██▏       | 105/471 [02:17<08:11,  1.34s/it] 23%|██▎       | 106/471 [02:18<08:09,  1.34s/it] 23%|██▎       | 107/471 [02:19<08:08,  1.34s/it] 23%|██▎       | 108/471 [02:21<08:07,  1.34s/it] 23%|██▎       | 109/471 [02:22<08:05,  1.34s/it] 23%|██▎       | 110/471 [02:23<08:02,  1.34s/it] 24%|██▎       | 111/471 [02:25<08:02,  1.34s/it] 24%|██▍       | 112/471 [02:26<08:01,  1.34s/it] 24%|██▍       | 113/471 [02:27<08:00,  1.34s/it] 24%|██▍       | 114/471 [02:29<07:59,  1.34s/it] 24%|██▍       | 115/471 [02:30<07:58,  1.35s/it] 25%|██▍       | 116/471 [02:31<07:57,  1.35s/it] 25%|██▍       | 117/471 [02:33<07:56,  1.35s/it] 25%|██▌       | 118/471 [02:34<07:55,  1.35s/it] 25%|██▌       | 119/471 [02:35<07:54,  1.35s/it] 25%|██▌       | 120/471 [02:37<07:53,  1.35s/it] 26%|██▌       | 121/471 [02:38<07:51,  1.35s/it] 26%|██▌       | 122/471 [02:39<07:50,  1.35s/it] 26%|██▌       | 123/471 [02:41<07:49,  1.35s/it] 26%|██▋       | 124/471 [02:42<07:48,  1.35s/it] 27%|██▋       | 125/471 [02:44<07:47,  1.35s/it] 27%|██▋       | 126/471 [02:45<07:45,  1.35s/it] 27%|██▋       | 127/471 [02:46<07:44,  1.35s/it] 27%|██▋       | 128/471 [02:48<07:42,  1.35s/it] 27%|██▋       | 129/471 [02:49<07:40,  1.35s/it] 28%|██▊       | 130/471 [02:50<07:38,  1.35s/it] 28%|██▊       | 131/471 [02:52<07:37,  1.35s/it] 28%|██▊       | 132/471 [02:53<07:36,  1.35s/it] 28%|██▊       | 133/471 [02:54<07:34,  1.35s/it] 28%|██▊       | 134/471 [02:56<07:33,  1.35s/it] 29%|██▊       | 135/471 [02:57<07:32,  1.35s/it] 29%|██▉       | 136/471 [02:58<07:30,  1.35s/it] 29%|██▉       | 137/471 [03:00<07:29,  1.35s/it] 29%|██▉       | 138/471 [03:01<07:28,  1.35s/it] 30%|██▉       | 139/471 [03:02<07:26,  1.35s/it] 30%|██▉       | 140/471 [03:04<07:25,  1.35s/it] 30%|██▉       | 141/471 [03:05<07:23,  1.34s/it] 30%|███       | 142/471 [03:06<07:21,  1.34s/it] 30%|███       | 143/471 [03:08<07:19,  1.34s/it] 31%|███       | 144/471 [03:09<07:19,  1.34s/it] 31%|███       | 145/471 [03:10<07:17,  1.34s/it] 31%|███       | 146/471 [03:12<07:16,  1.34s/it] 31%|███       | 147/471 [03:13<07:15,  1.34s/it] 31%|███▏      | 148/471 [03:14<07:13,  1.34s/it] 32%|███▏      | 149/471 [03:16<07:13,  1.35s/it] 32%|███▏      | 150/471 [03:17<07:11,  1.35s/it] 32%|███▏      | 151/471 [03:19<07:10,  1.34s/it] 32%|███▏      | 152/471 [03:20<07:08,  1.34s/it] 32%|███▏      | 153/471 [03:21<07:06,  1.34s/it] 33%|███▎      | 154/471 [03:23<07:04,  1.34s/it] 33%|███▎      | 155/471 [03:24<07:03,  1.34s/it] 33%|███▎      | 156/471 [03:25<07:02,  1.34s/it] 33%|███▎      | 157/471 [03:27<07:00,  1.34s/it] 34%|███▎      | 158/471 [03:28<06:59,  1.34s/it] 34%|███▍      | 159/471 [03:29<06:57,  1.34s/it] 34%|███▍      | 160/471 [03:31<06:56,  1.34s/it] 34%|███▍      | 161/471 [03:32<06:55,  1.34s/it] 34%|███▍      | 162/471 [03:33<06:54,  1.34s/it] 35%|███▍      | 163/471 [03:35<06:53,  1.34s/it] 35%|███▍      | 164/471 [03:36<06:51,  1.34s/it] 35%|███▌      | 165/471 [03:37<06:50,  1.34s/it] 35%|███▌      | 166/471 [03:39<06:49,  1.34s/it] 35%|███▌      | 167/471 [03:40<06:47,  1.34s/it] 36%|███▌      | 168/471 [03:41<06:46,  1.34s/it] 36%|███▌      | 169/471 [03:43<06:45,  1.34s/it] 36%|███▌      | 170/471 [03:44<06:43,  1.34s/it] 36%|███▋      | 171/471 [03:45<06:42,  1.34s/it] 37%|███▋      | 172/471 [03:47<06:40,  1.34s/it] 37%|███▋      | 173/471 [03:48<06:39,  1.34s/it] 37%|███▋      | 174/471 [03:49<06:38,  1.34s/it] 37%|███▋      | 175/471 [03:51<06:37,  1.34s/it] 37%|███▋      | 176/471 [03:52<06:35,  1.34s/it] 38%|███▊      | 177/471 [03:53<06:33,  1.34s/it] 38%|███▊      | 178/471 [03:55<06:32,  1.34s/it] 38%|███▊      | 179/471 [03:56<06:31,  1.34s/it] 38%|███▊      | 180/471 [03:57<06:29,  1.34s/it] 38%|███▊      | 181/471 [03:59<06:28,  1.34s/it] 39%|███▊      | 182/471 [04:00<06:27,  1.34s/it] 39%|███▉      | 183/471 [04:01<06:26,  1.34s/it] 39%|███▉      | 184/471 [04:03<06:24,  1.34s/it] 39%|███▉      | 185/471 [04:04<06:23,  1.34s/it] 39%|███▉      | 186/471 [04:05<06:21,  1.34s/it] 40%|███▉      | 187/471 [04:07<06:21,  1.34s/it] 40%|███▉      | 188/471 [04:08<06:20,  1.34s/it] 40%|████      | 189/471 [04:09<06:17,  1.34s/it] 40%|████      | 190/471 [04:11<06:16,  1.34s/it] 41%|████      | 191/471 [04:12<06:15,  1.34s/it] 41%|████      | 192/471 [04:13<06:14,  1.34s/it] 41%|████      | 193/471 [04:15<06:12,  1.34s/it] 41%|████      | 194/471 [04:16<06:11,  1.34s/it] 41%|████▏     | 195/471 [04:17<06:10,  1.34s/it] 42%|████▏     | 196/471 [04:19<06:08,  1.34s/it] 42%|████▏     | 197/471 [04:20<06:06,  1.34s/it] 42%|████▏     | 198/471 [04:21<06:05,  1.34s/it] 42%|████▏     | 199/471 [04:23<06:03,  1.34s/it] 42%|████▏     | 200/471 [04:24<06:02,  1.34s/it] 43%|████▎     | 201/471 [04:25<06:00,  1.34s/it] 43%|████▎     | 202/471 [04:27<05:59,  1.34s/it] 43%|████▎     | 203/471 [04:28<05:58,  1.34s/it] 43%|████▎     | 204/471 [04:30<05:57,  1.34s/it] 44%|████▎     | 205/471 [04:31<05:55,  1.34s/it] 44%|████▎     | 206/471 [04:32<05:54,  1.34s/it] 44%|████▍     | 207/471 [04:34<05:53,  1.34s/it] 44%|████▍     | 208/471 [04:35<05:51,  1.34s/it] 44%|████▍     | 209/471 [04:36<05:49,  1.34s/it] 45%|████▍     | 210/471 [04:38<05:48,  1.34s/it] 45%|████▍     | 211/471 [04:39<05:47,  1.34s/it] 45%|████▌     | 212/471 [04:40<05:46,  1.34s/it] 45%|████▌     | 213/471 [04:42<05:45,  1.34s/it] 45%|████▌     | 214/471 [04:43<05:43,  1.34s/it] 46%|████▌     | 215/471 [04:44<05:42,  1.34s/it] 46%|████▌     | 216/471 [04:46<05:41,  1.34s/it] 46%|████▌     | 217/471 [04:47<05:40,  1.34s/it] 46%|████▋     | 218/471 [04:48<05:39,  1.34s/it] 46%|████▋     | 219/471 [04:50<05:37,  1.34s/it] 47%|████▋     | 220/471 [04:51<05:36,  1.34s/it] 47%|████▋     | 221/471 [04:52<05:35,  1.34s/it] 47%|████▋     | 222/471 [04:54<05:32,  1.34s/it] 47%|████▋     | 223/471 [04:55<05:31,  1.34s/it] 48%|████▊     | 224/471 [04:56<05:30,  1.34s/it] 48%|████▊     | 225/471 [04:58<05:28,  1.34s/it] 48%|████▊     | 226/471 [04:59<05:27,  1.34s/it] 48%|████▊     | 227/471 [05:00<05:26,  1.34s/it] 48%|████▊     | 228/471 [05:02<05:25,  1.34s/it] 49%|████▊     | 229/471 [05:03<05:24,  1.34s/it] 49%|████▉     | 230/471 [05:04<05:22,  1.34s/it] 49%|████▉     | 231/471 [05:06<05:21,  1.34s/it] 49%|████▉     | 232/471 [05:07<05:19,  1.34s/it] 49%|████▉     | 233/471 [05:08<05:17,  1.34s/it] 50%|████▉     | 234/471 [05:10<05:16,  1.34s/it] 50%|████▉     | 235/471 [05:11<05:15,  1.34s/it] 50%|█████     | 236/471 [05:12<05:13,  1.34s/it] 50%|█████     | 237/471 [05:14<05:12,  1.34s/it] 51%|█████     | 238/471 [05:15<05:11,  1.34s/it] 51%|█████     | 239/471 [05:16<05:09,  1.34s/it] 51%|█████     | 240/471 [05:18<05:08,  1.34s/it] 51%|█████     | 241/471 [05:19<05:07,  1.34s/it] 51%|█████▏    | 242/471 [05:20<05:05,  1.34s/it] 52%|█████▏    | 243/471 [05:22<05:04,  1.34s/it] 52%|█████▏    | 244/471 [05:23<05:03,  1.34s/it] 52%|█████▏    | 245/471 [05:24<05:02,  1.34s/it] 52%|█████▏    | 246/471 [05:26<05:00,  1.34s/it] 52%|█████▏    | 247/471 [05:27<04:58,  1.33s/it] 53%|█████▎    | 248/471 [05:28<04:57,  1.34s/it] 53%|█████▎    | 249/471 [05:30<04:56,  1.34s/it] 53%|█████▎    | 250/471 [05:31<04:55,  1.34s/it] 53%|█████▎    | 251/471 [05:32<04:53,  1.34s/it] 54%|█████▎    | 252/471 [05:34<04:52,  1.34s/it] 54%|█████▎    | 253/471 [05:35<04:51,  1.34s/it] 54%|█████▍    | 254/471 [05:36<04:49,  1.34s/it] 54%|█████▍    | 255/471 [05:38<04:48,  1.34s/it] 54%|█████▍    | 256/471 [05:39<04:47,  1.34s/it] 55%|█████▍    | 257/471 [05:40<04:45,  1.34s/it] 55%|█████▍    | 258/471 [05:42<04:44,  1.34s/it] 55%|█████▍    | 259/471 [05:43<04:43,  1.34s/it] 55%|█████▌    | 260/471 [05:44<04:42,  1.34s/it] 55%|█████▌    | 261/471 [05:46<04:40,  1.34s/it] 56%|█████▌    | 262/471 [05:47<04:38,  1.33s/it] 56%|█████▌    | 263/471 [05:48<04:37,  1.34s/it] 56%|█████▌    | 264/471 [05:50<04:36,  1.34s/it] 56%|█████▋    | 265/471 [05:51<04:35,  1.34s/it] 56%|█████▋    | 266/471 [05:52<04:34,  1.34s/it] 57%|█████▋    | 267/471 [05:54<04:32,  1.34s/it] 57%|█████▋    | 268/471 [05:55<04:31,  1.34s/it] 57%|█████▋    | 269/471 [05:56<04:30,  1.34s/it] 57%|█████▋    | 270/471 [05:58<04:29,  1.34s/it] 58%|█████▊    | 271/471 [05:59<04:27,  1.34s/it] 58%|█████▊    | 272/471 [06:00<04:25,  1.34s/it] 58%|█████▊    | 273/471 [06:02<04:24,  1.34s/it] 58%|█████▊    | 274/471 [06:03<04:23,  1.34s/it] 58%|█████▊    | 275/471 [06:04<04:21,  1.34s/it] 59%|█████▊    | 276/471 [06:06<04:20,  1.34s/it] 59%|█████▉    | 277/471 [06:07<04:19,  1.34s/it] 59%|█████▉    | 278/471 [06:08<04:18,  1.34s/it] 59%|█████▉    | 279/471 [06:10<04:16,  1.34s/it] 59%|█████▉    | 280/471 [06:11<04:15,  1.34s/it] 60%|█████▉    | 281/471 [06:12<04:14,  1.34s/it] 60%|█████▉    | 282/471 [06:14<04:13,  1.34s/it] 60%|██████    | 283/471 [06:15<04:11,  1.34s/it] 60%|██████    | 284/471 [06:16<04:10,  1.34s/it] 61%|██████    | 285/471 [06:18<04:09,  1.34s/it] 61%|██████    | 286/471 [06:19<04:08,  1.34s/it] 61%|██████    | 287/471 [06:21<04:06,  1.34s/it] 61%|██████    | 288/471 [06:22<04:05,  1.34s/it] 61%|██████▏   | 289/471 [06:23<04:03,  1.34s/it] 62%|██████▏   | 290/471 [06:25<04:02,  1.34s/it] 62%|██████▏   | 291/471 [06:26<04:00,  1.34s/it] 62%|██████▏   | 292/471 [06:27<03:59,  1.34s/it] 62%|██████▏   | 293/471 [06:29<03:57,  1.34s/it] 62%|██████▏   | 294/471 [06:30<03:56,  1.34s/it] 63%|██████▎   | 295/471 [06:31<03:55,  1.34s/it] 63%|██████▎   | 296/471 [06:33<03:53,  1.34s/it] 63%|██████▎   | 297/471 [06:34<03:52,  1.34s/it] 63%|██████▎   | 298/471 [06:35<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:37<03:49,  1.34s/it] 64%|██████▎   | 300/471 [06:38<03:48,  1.34s/it] 64%|██████▍   | 301/471 [06:39<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:41<03:45,  1.34s/it] 64%|██████▍   | 303/471 [06:42<03:44,  1.34s/it] 65%|██████▍   | 304/471 [06:43<03:42,  1.33s/it] 65%|██████▍   | 305/471 [06:45<03:41,  1.33s/it] 65%|██████▍   | 306/471 [06:46<03:40,  1.34s/it] 65%|██████▌   | 307/471 [06:47<03:39,  1.34s/it] 65%|██████▌   | 308/471 [06:49<03:38,  1.34s/it] 66%|██████▌   | 309/471 [06:50<03:36,  1.34s/it] 66%|██████▌   | 310/471 [06:51<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:53<03:34,  1.34s/it] 66%|██████▌   | 312/471 [06:54<03:32,  1.34s/it] 66%|██████▋   | 313/471 [06:55<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:57<03:29,  1.34s/it] 67%|██████▋   | 315/471 [06:58<03:28,  1.34s/it] 67%|██████▋   | 316/471 [06:59<03:26,  1.34s/it] 67%|██████▋   | 317/471 [07:01<03:25,  1.34s/it] 68%|██████▊   | 318/471 [07:02<03:24,  1.34s/it] 68%|██████▊   | 319/471 [07:03<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:05<03:21,  1.34s/it] 68%|██████▊   | 321/471 [07:06<03:20,  1.34s/it] 68%|██████▊   | 322/471 [07:07<03:19,  1.34s/it] 69%|██████▊   | 323/471 [07:09<03:18,  1.34s/it] 69%|██████▉   | 324/471 [07:10<03:17,  1.34s/it] 69%|██████▉   | 325/471 [07:11<03:15,  1.34s/it] 69%|██████▉   | 326/471 [07:13<03:14,  1.34s/it] 69%|██████▉   | 327/471 [07:14<03:12,  1.34s/it] 70%|██████▉   | 328/471 [07:15<03:11,  1.34s/it] 70%|██████▉   | 329/471 [07:17<03:10,  1.34s/it] 70%|███████   | 330/471 [07:18<03:08,  1.34s/it] 70%|███████   | 331/471 [07:19<03:07,  1.34s/it] 70%|███████   | 332/471 [07:21<03:06,  1.34s/it] 71%|███████   | 333/471 [07:22<03:05,  1.34s/it] 71%|███████   | 334/471 [07:23<03:03,  1.34s/it] 71%|███████   | 335/471 [07:25<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:26<03:01,  1.34s/it] 72%|███████▏  | 337/471 [07:27<02:59,  1.34s/it] 72%|███████▏  | 338/471 [07:29<02:58,  1.34s/it] 72%|███████▏  | 339/471 [07:30<02:57,  1.34s/it] 72%|███████▏  | 340/471 [07:31<02:55,  1.34s/it] 72%|███████▏  | 341/471 [07:33<02:54,  1.34s/it] 73%|███████▎  | 342/471 [07:34<02:52,  1.34s/it] 73%|███████▎  | 343/471 [07:35<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:37<02:50,  1.34s/it] 73%|███████▎  | 345/471 [07:38<02:49,  1.34s/it] 73%|███████▎  | 346/471 [07:39<02:47,  1.34s/it] 74%|███████▎  | 347/471 [07:41<02:46,  1.34s/it] 74%|███████▍  | 348/471 [07:42<02:44,  1.34s/it] 74%|███████▍  | 349/471 [07:44<02:43,  1.34s/it] 74%|███████▍  | 350/471 [07:45<02:42,  1.34s/it] 75%|███████▍  | 351/471 [07:46<02:40,  1.34s/it] 75%|███████▍  | 352/471 [07:48<02:39,  1.34s/it] 75%|███████▍  | 353/471 [07:49<02:38,  1.34s/it] 75%|███████▌  | 354/471 [07:50<02:37,  1.34s/it] 75%|███████▌  | 355/471 [07:52<02:36,  1.35s/it] 76%|███████▌  | 356/471 [07:53<02:34,  1.35s/it] 76%|███████▌  | 357/471 [07:54<02:33,  1.35s/it] 76%|███████▌  | 358/471 [07:56<02:32,  1.35s/it] 76%|███████▌  | 359/471 [07:57<02:30,  1.35s/it] 76%|███████▋  | 360/471 [07:58<02:29,  1.34s/it] 77%|███████▋  | 361/471 [08:00<02:27,  1.35s/it] 77%|███████▋  | 362/471 [08:01<02:26,  1.34s/it] 77%|███████▋  | 363/471 [08:02<02:25,  1.34s/it] 77%|███████▋  | 364/471 [08:04<02:23,  1.34s/it] 77%|███████▋  | 365/471 [08:05<02:22,  1.34s/it] 78%|███████▊  | 366/471 [08:06<02:21,  1.35s/it] 78%|███████▊  | 367/471 [08:08<02:19,  1.35s/it] 78%|███████▊  | 368/471 [08:09<02:18,  1.34s/it] 78%|███████▊  | 369/471 [08:10<02:16,  1.34s/it] 79%|███████▊  | 370/471 [08:12<02:15,  1.34s/it] 79%|███████▉  | 371/471 [08:13<02:14,  1.34s/it] 79%|███████▉  | 372/471 [08:14<02:13,  1.34s/it] 79%|███████▉  | 373/471 [08:16<02:11,  1.34s/it] 79%|███████▉  | 374/471 [08:17<02:10,  1.34s/it] 80%|███████▉  | 375/471 [08:18<02:08,  1.34s/it] 80%|███████▉  | 376/471 [08:20<02:07,  1.34s/it] 80%|████████  | 377/471 [08:21<02:05,  1.34s/it] 80%|████████  | 378/471 [08:22<02:04,  1.34s/it] 80%|████████  | 379/471 [08:24<02:03,  1.34s/it] 81%|████████  | 380/471 [08:25<02:01,  1.34s/it] 81%|████████  | 381/471 [08:26<02:00,  1.34s/it] 81%|████████  | 382/471 [08:28<01:59,  1.34s/it] 81%|████████▏ | 383/471 [08:29<01:57,  1.34s/it] 82%|████████▏ | 384/471 [08:31<01:56,  1.34s/it] 82%|████████▏ | 385/471 [08:32<01:55,  1.34s/it] 82%|████████▏ | 386/471 [08:33<01:53,  1.34s/it] 82%|████████▏ | 387/471 [08:35<01:52,  1.34s/it] 82%|████████▏ | 388/471 [08:36<01:51,  1.34s/it] 83%|████████▎ | 389/471 [08:37<01:49,  1.34s/it] 83%|████████▎ | 390/471 [08:39<01:48,  1.34s/it] 83%|████████▎ | 391/471 [08:40<01:46,  1.34s/it] 83%|████████▎ | 392/471 [08:41<01:45,  1.34s/it] 83%|████████▎ | 393/471 [08:43<01:44,  1.34s/it] 84%|████████▎ | 394/471 [08:44<01:43,  1.34s/it] 84%|████████▍ | 395/471 [08:45<01:41,  1.34s/it] 84%|████████▍ | 396/471 [08:47<01:40,  1.34s/it] 84%|████████▍ | 397/471 [08:48<01:38,  1.34s/it] 85%|████████▍ | 398/471 [08:49<01:37,  1.34s/it] 85%|████████▍ | 399/471 [08:51<01:36,  1.34s/it] 85%|████████▍ | 400/471 [08:52<01:34,  1.34s/it] 85%|████████▌ | 401/471 [08:53<01:33,  1.34s/it] 85%|████████▌ | 402/471 [08:55<01:32,  1.33s/it] 86%|████████▌ | 403/471 [08:56<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:57<01:29,  1.33s/it] 86%|████████▌ | 405/471 [08:59<01:27,  1.33s/it] 86%|████████▌ | 406/471 [09:00<01:26,  1.33s/it] 86%|████████▋ | 407/471 [09:01<01:25,  1.33s/it] 87%|████████▋ | 408/471 [09:03<01:23,  1.33s/it] 87%|████████▋ | 409/471 [09:04<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:05<01:21,  1.33s/it] 87%|████████▋ | 411/471 [09:07<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:08<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:09<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:11<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:12<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:13<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:15<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:16<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:17<01:09,  1.33s/it] 89%|████████▉ | 420/471 [09:19<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:20<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:21<01:05,  1.33s/it] 90%|████████▉ | 423/471 [09:23<01:03,  1.33s/it] 90%|█████████ | 424/471 [09:24<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:25<01:01,  1.33s/it] 90%|█████████ | 426/471 [09:27<01:00,  1.33s/it] 91%|█████████ | 427/471 [09:28<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:29<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:31<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:32<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:33<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:35<00:52,  1.34s/it] 92%|█████████▏| 433/471 [09:36<00:50,  1.33s/it] 92%|█████████▏| 434/471 [09:37<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:39<00:48,  1.34s/it] 93%|█████████▎| 436/471 [09:40<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:41<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:43<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:44<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:45<00:41,  1.33s/it] 94%|█████████▎| 441/471 [09:47<00:40,  1.33s/it] 94%|█████████▍| 442/471 [09:48<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:49<00:37,  1.33s/it] 94%|█████████▍| 444/471 [09:51<00:36,  1.33s/it] 94%|█████████▍| 445/471 [09:52<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:53<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:55<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:56<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:57<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:59<00:28,  1.34s/it] 96%|█████████▌| 451/471 [10:00<00:26,  1.34s/it] 96%|█████████▌| 452/471 [10:01<00:25,  1.33s/it] 96%|█████████▌| 453/471 [10:03<00:24,  1.34s/it] 96%|█████████▋| 454/471 [10:04<00:22,  1.34s/it] 97%|█████████▋| 455/471 [10:05<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:07<00:20,  1.34s/it] 97%|█████████▋| 457/471 [10:08<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:09<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:11<00:16,  1.33s/it] 98%|█████████▊| 460/471 [10:12<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:13<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:15<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:16<00:10,  1.34s/it] 99%|█████████▊| 464/471 [10:17<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:19<00:08,  1.33s/it] 99%|█████████▉| 466/471 [10:20<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:21<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:23<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:24<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:25<00:01,  1.34s/it]100%|██████████| 471/471 [10:26<00:00,  1.23s/it]100%|██████████| 471/471 [10:26<00:00,  1.33s/it]
{'eval_loss': 2.7567079067230225, 'eval_model_preparation_time': 0.0157, 'eval_acc': 0.3235528412108338, 'eval_runtime': 628.0323, 'eval_samples_per_second': 11.993, 'eval_steps_per_second': 0.75}
ROUND:15
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 3.5032, 'grad_norm': 12.861591339111328, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 1.7814, 'grad_norm': 11.010684967041016, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.9538, 'grad_norm': 11.581340789794922, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.5337, 'grad_norm': 9.948817253112793, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it]                                              {'loss': 2.7371, 'grad_norm': 15.997803688049316, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.1348, 'grad_norm': 12.13088321685791, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.3861, 'grad_norm': 11.285300254821777, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:50,  1.56s/it]                                              {'loss': 1.0441, 'grad_norm': 40.03229522705078, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 1.4234, 'grad_norm': 15.486141204833984, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 1.7895, 'grad_norm': 12.542016983032227, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.9411, 'grad_norm': 17.631267547607422, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 0.4184, 'grad_norm': 4.726273536682129, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 1.4532, 'grad_norm': 6.809537410736084, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 1.0496, 'grad_norm': 9.236295700073242, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 1.0892, 'grad_norm': 9.388747215270996, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.7546, 'grad_norm': 31.774982452392578, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.7959, 'grad_norm': 4.793142795562744, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.6874, 'grad_norm': 7.148697853088379, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.9219, 'grad_norm': 16.70445442199707, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.6914, 'grad_norm': 11.534104347229004, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.4805, 'grad_norm': 2.060645341873169, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it]                                               {'loss': 0.6087, 'grad_norm': 7.601866722106934, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.8094, 'grad_norm': 11.416399955749512, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.117, 'grad_norm': 5.931543827056885, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.2014, 'grad_norm': 3.5563321113586426, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.5522, 'grad_norm': 5.428549766540527, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.3147, 'grad_norm': 7.290980339050293, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.2443, 'grad_norm': 2.04929518699646, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.5612, 'grad_norm': 2.892467737197876, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.3162, 'grad_norm': 3.3281970024108887, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.6047, 'grad_norm': 18.950326919555664, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 0.0014117847895249724, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.3109, 'grad_norm': 5.039943218231201, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.1666, 'grad_norm': 4.572653770446777, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.3981, 'grad_norm': 3.980269193649292, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.1729, 'grad_norm': 3.1603615283966064, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.2815, 'grad_norm': 1.875632882118225, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.0365, 'grad_norm': 0.7620059251785278, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.3767, 'grad_norm': 10.016678810119629, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0761, 'grad_norm': 2.5088284015655518, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.2374, 'train_samples_per_second': 7.13, 'train_steps_per_second': 0.505, 'train_loss': 0.8679915391766826, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:49
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]                                              {'loss': 3.1437, 'grad_norm': 10.920016288757324, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:22,  2.12s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.5751, 'grad_norm': 11.422747611999512, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.3927, 'grad_norm': 13.885400772094727, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.2978, 'grad_norm': 10.207245826721191, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 2.8013, 'grad_norm': 18.123262405395508, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.4443, 'grad_norm': 14.100913047790527, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.8664, 'grad_norm': 10.507790565490723, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 8.1597, 'grad_norm': 69.03866577148438, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.4138, 'grad_norm': 3.9336495399475098, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.1112, 'grad_norm': 6.0280866622924805, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 0.6102, 'grad_norm': 3.774421215057373, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.7465, 'grad_norm': 6.002240180969238, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.6948, 'grad_norm': 22.524490356445312, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 0.9768, 'grad_norm': 5.06723690032959, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.2626, 'grad_norm': 2.3569281101226807, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 2.0036, 'grad_norm': 63.115875244140625, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.2791, 'grad_norm': 3.0857396125793457, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.2507, 'grad_norm': 3.134183645248413, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it]                                               {'loss': 0.3849, 'grad_norm': 4.3284735679626465, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.287, 'grad_norm': 3.409762144088745, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.3378, 'grad_norm': 3.908121109008789, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.1559, 'grad_norm': 2.282243251800537, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.5273, 'grad_norm': 3.783421277999878, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0393, 'grad_norm': 2.486948251724243, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.1939, 'grad_norm': 2.448669672012329, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0898, 'grad_norm': 2.7418997287750244, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.2801, 'grad_norm': 2.6843857765197754, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.0629, 'grad_norm': 1.2428522109985352, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.378, 'grad_norm': 3.0521373748779297, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0311, 'grad_norm': 0.5891636610031128, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.0752, 'grad_norm': 1.2880902290344238, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.019, 'grad_norm': 1.1271203756332397, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.2679, 'grad_norm': 1.264378547668457, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0241, 'grad_norm': 0.6485788822174072, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0689, 'grad_norm': 1.5443947315216064, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0925, 'grad_norm': 1.3166420459747314, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.3427, 'grad_norm': 1.8834130764007568, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.045, 'grad_norm': 0.6532156467437744, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0377, 'grad_norm': 1.3882362842559814, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0203, 'grad_norm': 1.338051438331604, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.9244, 'train_samples_per_second': 7.159, 'train_steps_per_second': 0.507, 'train_loss': 0.8948001731652766, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.0073, 'grad_norm': 10.093398094177246, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 1.083, 'grad_norm': 8.572199821472168, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 1.3865, 'grad_norm': 17.60060691833496, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 1.8453, 'grad_norm': 12.856234550476074, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 1.8767, 'grad_norm': 17.362060546875, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it]                                              {'loss': 2.5626, 'grad_norm': 20.59122085571289, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 1.3383, 'grad_norm': 17.073110580444336, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.6113, 'grad_norm': 56.602867126464844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.8679, 'grad_norm': 31.77644157409668, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.7724, 'grad_norm': 10.225309371948242, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it]                                               {'loss': 1.0173, 'grad_norm': 10.61190128326416, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.7392, 'grad_norm': 12.16926383972168, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.5694, 'grad_norm': 7.6952433586120605, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.1024, 'grad_norm': 8.75698184967041, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.8297, 'grad_norm': 6.784425735473633, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0742, 'grad_norm': 2.9684882164001465, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.1553, 'grad_norm': 3.2404134273529053, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.2638, 'grad_norm': 6.4266791343688965, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.4064, 'grad_norm': 3.5770931243896484, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.2005, 'grad_norm': 2.4125428199768066, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.3788, 'grad_norm': 4.484462738037109, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.5069, 'grad_norm': 8.028470039367676, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.153, 'grad_norm': 3.8209383487701416, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.0342, 'grad_norm': 1.347148060798645, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.1987, 'grad_norm': 7.386585235595703, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.4248, 'grad_norm': 6.560094833374023, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.1449, 'grad_norm': 2.4740843772888184, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.1041, 'grad_norm': 1.6571236848831177, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.1825, 'grad_norm': 3.0003175735473633, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.4945, 'grad_norm': 3.8358230590820312, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.1906, 'grad_norm': 4.491751194000244, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.0146, 'grad_norm': 0.7027802467346191, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.0755, 'grad_norm': 1.6561744213104248, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0497, 'grad_norm': 1.0152502059936523, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0943, 'grad_norm': 2.261835813522339, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.106, 'grad_norm': 2.2062761783599854, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0148, 'grad_norm': 0.296570360660553, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.332, 'grad_norm': 3.81203031539917, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.8928, 'grad_norm': 7.529464244842529, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0411, 'grad_norm': 1.6561174392700195, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.4562, 'train_samples_per_second': 7.201, 'train_steps_per_second': 0.51, 'train_loss': 0.7285901891067624, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 2.8179, 'grad_norm': 12.647071838378906, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.3382, 'grad_norm': 11.873894691467285, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 2.3619, 'grad_norm': 10.476044654846191, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 3.0298, 'grad_norm': 21.71035385131836, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 1.7189, 'grad_norm': 13.570207595825195, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.6868, 'grad_norm': 13.234922409057617, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.4617, 'grad_norm': 12.911393165588379, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.4576, 'grad_norm': 31.102676391601562, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.3166, 'grad_norm': 3.503359317779541, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 0.9442, 'grad_norm': 6.8555779457092285, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.6192, 'grad_norm': 5.575793266296387, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.2377, 'grad_norm': 3.5836143493652344, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.4683, 'grad_norm': 5.32710075378418, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.6977, 'grad_norm': 11.093719482421875, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.6494, 'grad_norm': 6.870916843414307, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 2.8822, 'grad_norm': 69.82478332519531, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.1834, 'grad_norm': 3.9240310192108154, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.5433, 'grad_norm': 8.01524829864502, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.2502, 'grad_norm': 4.564604759216309, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.1362, 'grad_norm': 0.9855944514274597, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.1773, 'grad_norm': 1.9217746257781982, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.0829, 'grad_norm': 1.2540816068649292, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.332, 'grad_norm': 6.872305870056152, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.0043, 'grad_norm': 0.21158604323863983, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.0423, 'grad_norm': 0.9110550284385681, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0582, 'grad_norm': 1.1354646682739258, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.0558, 'grad_norm': 0.9299150705337524, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.0265, 'grad_norm': 0.7399978637695312, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.2878, 'grad_norm': 15.994669914245605, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1033, 'grad_norm': 3.075984239578247, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.4755, 'grad_norm': 12.126432418823242, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0435, 'grad_norm': 2.051412343978882, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0893, 'grad_norm': 1.088243007659912, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.0466, 'grad_norm': 1.1386430263519287, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.3161, 'grad_norm': 13.228413581848145, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.214, 'grad_norm': 8.99045181274414, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0687, 'grad_norm': 1.9497631788253784, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1591, 'grad_norm': 3.543335437774658, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.1471, 'grad_norm': 3.1364338397979736, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.006, 'grad_norm': 0.3440116345882416, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.0695, 'train_samples_per_second': 7.146, 'train_steps_per_second': 0.506, 'train_loss': 0.6884444841998629, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.4093, 'grad_norm': 11.244288444519043, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.482, 'grad_norm': 10.139981269836426, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.16s/it]                                              {'loss': 2.9355, 'grad_norm': 14.31529712677002, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.9065, 'grad_norm': 13.631429672241211, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.7731, 'grad_norm': 17.755184173583984, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.7663, 'grad_norm': 14.656168937683105, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.2445, 'grad_norm': 10.552284240722656, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 3.6553, 'grad_norm': 149.86151123046875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.4411, 'grad_norm': 8.895217895507812, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.2808, 'grad_norm': 10.204182624816895, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 1.7739, 'grad_norm': 14.44654369354248, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.3841, 'grad_norm': 12.797659873962402, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.1423, 'grad_norm': 12.622762680053711, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.5703, 'grad_norm': 7.611872673034668, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.5871, 'grad_norm': 7.722360134124756, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.0041, 'grad_norm': 0.23381735384464264, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.6851, 'grad_norm': 7.005023002624512, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.1908, 'grad_norm': 4.938814163208008, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.2628, 'grad_norm': 2.2057456970214844, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.1395, 'grad_norm': 2.5835466384887695, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.3701, 'grad_norm': 2.8761513233184814, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.8281, 'grad_norm': 9.955430030822754, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.5193, 'grad_norm': 2.5695719718933105, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.2211, 'grad_norm': 11.351470947265625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.0962, 'grad_norm': 3.6065948009490967, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.1351, 'grad_norm': 1.343145728111267, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.696, 'grad_norm': 3.243377685546875, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1391, 'grad_norm': 3.257081985473633, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1078, 'grad_norm': 1.7854219675064087, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0907, 'grad_norm': 2.1294589042663574, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1237, 'grad_norm': 7.702600002288818, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0639, 'grad_norm': 3.1731643676757812, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.296, 'grad_norm': 1.311660885810852, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0305, 'grad_norm': 1.2332983016967773, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0302, 'grad_norm': 1.5965973138809204, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.3191, 'grad_norm': 8.881484985351562, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.076, 'grad_norm': 2.071458101272583, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.1804, 'grad_norm': 2.1792051792144775, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.2031, 'grad_norm': 1.6487349271774292, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0073, 'grad_norm': 0.5310168862342834, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.1484, 'train_samples_per_second': 7.138, 'train_steps_per_second': 0.505, 'train_loss': 0.8042062511434779, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 1.898, 'grad_norm': 10.895291328430176, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.0396, 'grad_norm': 11.830978393554688, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.7449, 'grad_norm': 12.252860069274902, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:17,  2.17s/it]                                              {'loss': 1.7299, 'grad_norm': 16.067039489746094, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 0.8709, 'grad_norm': 9.036136627197266, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.5858, 'grad_norm': 8.9098482131958, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.7024, 'grad_norm': 20.17048454284668, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 2.4923, 'grad_norm': 62.39872741699219, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it]                                              {'loss': 1.1874, 'grad_norm': 9.105669021606445, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.4582, 'grad_norm': 7.86317253112793, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.7163, 'grad_norm': 5.50516939163208, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.7695, 'grad_norm': 7.003021717071533, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.7281, 'grad_norm': 7.1694841384887695, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.5283, 'grad_norm': 3.2915117740631104, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it]                                               {'loss': 0.5153, 'grad_norm': 6.79644775390625, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 5.9862, 'grad_norm': 67.70143127441406, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.1313, 'grad_norm': 1.5878392457962036, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.3033, 'grad_norm': 2.6656124591827393, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.1393, 'grad_norm': 6.046821594238281, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.0837, 'grad_norm': 1.1375799179077148, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.7127, 'grad_norm': 3.4234249591827393, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.489, 'grad_norm': 5.8851542472839355, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.1268, 'grad_norm': 1.520727276802063, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0936, 'grad_norm': 3.177696943283081, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.1632, 'grad_norm': 1.6512688398361206, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.3655, 'grad_norm': 3.195242166519165, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.134, 'grad_norm': 4.3946332931518555, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.0474, 'grad_norm': 1.2546944618225098, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.0782, 'grad_norm': 0.9878265857696533, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.3777, 'grad_norm': 7.62448263168335, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0396, 'grad_norm': 1.3376884460449219, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.6725, 'grad_norm': 9.864156723022461, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0232, 'grad_norm': 0.951557993888855, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0289, 'grad_norm': 0.5690451264381409, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.3852, 'grad_norm': 15.698431015014648, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.3151, 'grad_norm': 9.108546257019043, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0679, 'grad_norm': 2.467456817626953, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.0344, 'grad_norm': 0.6341909170150757, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.1446, 'grad_norm': 4.5156426429748535, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0853, 'grad_norm': 2.8363711833953857, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.0614, 'train_samples_per_second': 7.146, 'train_steps_per_second': 0.506, 'train_loss': 0.7498818125110119, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:87
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]                                              {'loss': 2.9135, 'grad_norm': 13.05692195892334, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.14s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.0714, 'grad_norm': 13.524954795837402, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.0106, 'grad_norm': 10.584754943847656, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 1.536, 'grad_norm': 15.928282737731934, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 1.3498, 'grad_norm': 9.953584671020508, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 1.1194, 'grad_norm': 10.099166870117188, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 1.0388, 'grad_norm': 10.84220027923584, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.0272, 'grad_norm': 1.475899338722229, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.0363, 'grad_norm': 13.403868675231934, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.5503, 'grad_norm': 8.438358306884766, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 0.8521, 'grad_norm': 5.858858108520508, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.3737, 'grad_norm': 5.386185646057129, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.623, 'grad_norm': 5.385531902313232, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.6485, 'grad_norm': 9.7464017868042, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.4886, 'grad_norm': 5.459531307220459, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.57s/it]                                               {'loss': 0.1972, 'grad_norm': 8.579434394836426, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.3411, 'grad_norm': 4.570750713348389, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.2408, 'grad_norm': 3.1846954822540283, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.1498, 'grad_norm': 2.570956230163574, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.5699, 'grad_norm': 2.6472854614257812, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.1572, 'grad_norm': 1.5604087114334106, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.2308, 'grad_norm': 1.8151614665985107, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.1196, 'grad_norm': 3.5325677394866943, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0066, 'grad_norm': 0.22192572057247162, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it]                                               {'loss': 0.7221, 'grad_norm': 86.19137573242188, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.2083, 'grad_norm': 3.796874761581421, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.077, 'grad_norm': 1.5009942054748535, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.2006, 'grad_norm': 5.549909591674805, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.0507, 'grad_norm': 1.4248509407043457, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.036, 'grad_norm': 0.8399214148521423, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0937, 'grad_norm': 2.0481021404266357, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.60s/it]                                               {'loss': 0.0021, 'grad_norm': 0.07714061439037323, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1866, 'grad_norm': 3.058971405029297, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0319, 'grad_norm': 0.5106974840164185, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.0115, 'grad_norm': 0.2415742129087448, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.0178, 'grad_norm': 0.5040549039840698, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.2835, 'grad_norm': 1.0816535949707031, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.338, 'grad_norm': 160.41458129882812, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.2287, 'grad_norm': 1.0734323263168335, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0081, 'grad_norm': 0.4769060015678406, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.881, 'train_samples_per_second': 7.163, 'train_steps_per_second': 0.507, 'train_loss': 0.5037177501246333, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 2.3589, 'grad_norm': 11.922279357910156, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 1.9186, 'grad_norm': 10.762502670288086, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.8827, 'grad_norm': 11.163522720336914, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.0993, 'grad_norm': 8.267723083496094, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.0483, 'grad_norm': 15.23507308959961, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.3686, 'grad_norm': 16.241357803344727, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 0.8201, 'grad_norm': 8.612853050231934, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.7747, 'grad_norm': 37.8057746887207, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.6985, 'grad_norm': 8.04909896850586, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.23, 'grad_norm': 7.918149948120117, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.1469, 'grad_norm': 2.662498712539673, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.535, 'grad_norm': 6.533212184906006, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.273, 'grad_norm': 4.308093070983887, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.8628, 'grad_norm': 6.3733134269714355, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.6474, 'grad_norm': 7.216089725494385, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.2291, 'grad_norm': 13.232096672058105, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.1301, 'grad_norm': 1.656522512435913, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.0866, 'grad_norm': 2.1548244953155518, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.1406, 'grad_norm': 4.855952262878418, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.1735, 'grad_norm': 1.3707256317138672, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.1621, 'grad_norm': 1.488365888595581, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.1466, 'grad_norm': 2.900031328201294, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.1667, 'grad_norm': 2.7764108180999756, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.409, 'grad_norm': 19.321327209472656, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.0764, 'grad_norm': 2.9101927280426025, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.28, 'grad_norm': 7.2738938331604, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.0595, 'grad_norm': 1.4421958923339844, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.0519, 'grad_norm': 0.7349808216094971, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.0239, 'grad_norm': 0.418391615152359, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0861, 'grad_norm': 2.0178275108337402, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.014, 'grad_norm': 0.3266561031341553, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0557, 'grad_norm': 2.420696496963501, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.1281, 'grad_norm': 3.977010488510132, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0109, 'grad_norm': 0.3494945764541626, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.065, 'grad_norm': 1.4781653881072998, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it]                                               {'loss': 0.0484, 'grad_norm': 0.8316786289215088, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.1453, 'grad_norm': 2.956865072250366, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0429, 'grad_norm': 1.0997482538223267, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0879, 'grad_norm': 3.2054665088653564, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0213, 'grad_norm': 1.0171699523925781, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 79.1653, 'train_samples_per_second': 7.137, 'train_steps_per_second': 0.505, 'train_loss': 0.48766674131620674, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:99
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 3.2505, 'grad_norm': 15.337922096252441, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:23,  2.18s/it]                                              {'loss': 1.8721, 'grad_norm': 11.019427299499512, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.639, 'grad_norm': 13.496213912963867, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.4232, 'grad_norm': 14.467211723327637, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.0741, 'grad_norm': 12.237920761108398, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 1.3177, 'grad_norm': 8.511338233947754, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 0.7345, 'grad_norm': 26.909048080444336, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:17<01:08,  2.14s/it]                                              {'loss': 1.1878, 'grad_norm': 10.26101016998291, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:17<01:08,  2.14s/it] 22%|██▎       | 9/40 [00:19<01:07,  2.17s/it]                                              {'loss': 0.666, 'grad_norm': 4.719576835632324, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:19<01:07,  2.17s/it] 25%|██▌       | 10/40 [00:21<01:05,  2.17s/it]                                               {'loss': 0.2964, 'grad_norm': 3.6793954372406006, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:21<01:05,  2.17s/it] 28%|██▊       | 11/40 [00:23<01:02,  2.17s/it]                                               {'loss': 0.8391, 'grad_norm': 8.829468727111816, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:23<01:02,  2.17s/it] 30%|███       | 12/40 [00:26<01:00,  2.17s/it]                                               {'loss': 0.6156, 'grad_norm': 15.558077812194824, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:26<01:00,  2.17s/it] 32%|███▎      | 13/40 [00:28<00:58,  2.18s/it]                                               {'loss': 0.4865, 'grad_norm': 6.768676280975342, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:28<00:58,  2.18s/it] 35%|███▌      | 14/40 [00:30<00:57,  2.20s/it]                                               {'loss': 0.4416, 'grad_norm': 6.491127014160156, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:30<00:57,  2.20s/it] 38%|███▊      | 15/40 [00:32<00:55,  2.21s/it]                                               {'loss': 0.7192, 'grad_norm': 9.661931037902832, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:32<00:55,  2.21s/it] 40%|████      | 16/40 [00:34<00:52,  2.19s/it]                                               {'loss': 0.2572, 'grad_norm': 4.807498455047607, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:34<00:52,  2.19s/it] 42%|████▎     | 17/40 [00:37<00:50,  2.22s/it]                                               {'loss': 0.1741, 'grad_norm': 3.4329371452331543, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:37<00:50,  2.22s/it] 45%|████▌     | 18/40 [00:39<00:48,  2.21s/it]                                               {'loss': 0.4254, 'grad_norm': 6.431241512298584, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:39<00:48,  2.21s/it] 48%|████▊     | 19/40 [00:41<00:46,  2.22s/it]                                               {'loss': 0.9335, 'grad_norm': 17.51785659790039, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:41<00:46,  2.22s/it] 50%|█████     | 20/40 [00:43<00:44,  2.23s/it]                                               {'loss': 0.0437, 'grad_norm': 12.304400444030762, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:43<00:44,  2.23s/it] 52%|█████▎    | 21/40 [00:46<00:42,  2.24s/it]                                               {'loss': 0.1394, 'grad_norm': 4.25457763671875, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:46<00:42,  2.24s/it] 55%|█████▌    | 22/40 [00:48<00:40,  2.22s/it]                                               {'loss': 0.3001, 'grad_norm': 3.1197307109832764, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:48<00:40,  2.22s/it] 57%|█████▊    | 23/40 [00:50<00:37,  2.22s/it]                                               {'loss': 0.4902, 'grad_norm': 8.257210731506348, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:50<00:37,  2.22s/it] 60%|██████    | 24/40 [00:52<00:34,  2.19s/it]                                               {'loss': 0.2473, 'grad_norm': 4.620542049407959, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:52<00:34,  2.19s/it] 62%|██████▎   | 25/40 [00:54<00:33,  2.21s/it]                                               {'loss': 0.2662, 'grad_norm': 9.221036911010742, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:54<00:33,  2.21s/it] 65%|██████▌   | 26/40 [00:57<00:30,  2.21s/it]                                               {'loss': 0.0667, 'grad_norm': 1.2818049192428589, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:57<00:30,  2.21s/it] 68%|██████▊   | 27/40 [00:59<00:28,  2.21s/it]                                               {'loss': 0.1975, 'grad_norm': 1.8299545049667358, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:59<00:28,  2.21s/it] 70%|███████   | 28/40 [01:01<00:26,  2.23s/it]                                               {'loss': 0.2317, 'grad_norm': 2.0264997482299805, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [01:01<00:26,  2.23s/it] 72%|███████▎  | 29/40 [01:03<00:24,  2.23s/it]                                               {'loss': 0.1618, 'grad_norm': 4.882665634155273, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [01:03<00:24,  2.23s/it] 75%|███████▌  | 30/40 [01:06<00:22,  2.24s/it]                                               {'loss': 0.1274, 'grad_norm': 1.4319041967391968, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:06<00:22,  2.24s/it] 78%|███████▊  | 31/40 [01:08<00:20,  2.25s/it]                                               {'loss': 0.0309, 'grad_norm': 0.4857243597507477, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:08<00:20,  2.25s/it] 80%|████████  | 32/40 [01:10<00:17,  2.23s/it]                                               {'loss': 0.1617, 'grad_norm': 2.8350331783294678, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:10<00:17,  2.23s/it] 82%|████████▎ | 33/40 [01:12<00:15,  2.22s/it]                                               {'loss': 0.0516, 'grad_norm': 0.9933315515518188, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:12<00:15,  2.22s/it] 85%|████████▌ | 34/40 [01:15<00:13,  2.25s/it]                                               {'loss': 0.015, 'grad_norm': 0.44600990414619446, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:15<00:13,  2.25s/it] 88%|████████▊ | 35/40 [01:17<00:11,  2.25s/it]                                               {'loss': 0.1467, 'grad_norm': 9.195351600646973, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:17<00:11,  2.25s/it] 90%|█████████ | 36/40 [01:19<00:08,  2.25s/it]                                               {'loss': 0.9428, 'grad_norm': 4.44720458984375, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:19<00:08,  2.25s/it] 92%|█████████▎| 37/40 [01:21<00:06,  2.26s/it]                                               {'loss': 0.0443, 'grad_norm': 0.6224152445793152, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:21<00:06,  2.26s/it] 95%|█████████▌| 38/40 [01:24<00:04,  2.25s/it]                                               {'loss': 0.0255, 'grad_norm': 0.836122453212738, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:24<00:04,  2.25s/it] 98%|█████████▊| 39/40 [01:26<00:02,  2.25s/it]                                               {'loss': 0.0051, 'grad_norm': 0.10987839102745056, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:26<00:02,  2.25s/it]100%|██████████| 40/40 [01:28<00:00,  2.23s/it]                                               {'loss': 0.0368, 'grad_norm': 1.291326642036438, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:28<00:00,  2.23s/it]                                               {'train_runtime': 88.801, 'train_samples_per_second': 7.151, 'train_steps_per_second': 0.45, 'train_loss': 0.5771479078452103, 'epoch': 5.0}
100%|██████████| 40/40 [01:28<00:00,  2.23s/it]100%|██████████| 40/40 [01:28<00:00,  2.22s/it]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 0.0083, 'grad_norm': 0.3882291913032532, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]                                              {'loss': 0.0045, 'grad_norm': 0.13634692132472992, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.14s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 0.0112, 'grad_norm': 0.35276511311531067, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 0.0031, 'grad_norm': 0.029864903539419174, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 0.0071, 'grad_norm': 0.0869494304060936, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 0.0122, 'grad_norm': 0.300424724817276, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it]                                              {'loss': 0.212, 'grad_norm': 1.4493300914764404, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.56s/it]                                              {'loss': 0.0009, 'grad_norm': 0.016551917418837547, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.0018, 'grad_norm': 0.04026550427079201, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 0.0107, 'grad_norm': 0.20661965012550354, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.002, 'grad_norm': 0.018803881481289864, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.0011, 'grad_norm': 0.01006148848682642, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.0103, 'grad_norm': 0.2412988245487213, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 0.0031, 'grad_norm': 0.042400091886520386, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.0043, 'grad_norm': 0.050217822194099426, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.58s/it]                                               {'loss': 0.0, 'grad_norm': 0.0005977473338134587, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.0017, 'grad_norm': 0.031645938754081726, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it]                                               {'loss': 0.0017, 'grad_norm': 0.05282910540699959, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.0009, 'grad_norm': 0.016130879521369934, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.10s/it]                                               {'loss': 0.0031, 'grad_norm': 0.2211524099111557, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.10s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.0029, 'grad_norm': 0.0662418007850647, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.0032, 'grad_norm': 0.037946917116642, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.0011, 'grad_norm': 0.009477539919316769, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 6.399761332431808e-05, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.0031, 'grad_norm': 0.030230874195694923, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.0019, 'grad_norm': 0.029741747304797173, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it]                                               {'loss': 0.0018, 'grad_norm': 0.014885674230754375, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0023, 'grad_norm': 0.01819480024278164, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.0015, 'grad_norm': 0.016549937427043915, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0031, 'grad_norm': 0.03429602086544037, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.0021, 'grad_norm': 0.01258126925677061, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0, 'grad_norm': 0.0003953835985157639, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.002, 'grad_norm': 0.023746676743030548, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.0023, 'grad_norm': 0.018071025609970093, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.0047, 'grad_norm': 0.08790874481201172, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.0026, 'grad_norm': 0.046321768313646317, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.0055, 'grad_norm': 0.06297312676906586, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it]                                               {'loss': 0.0048, 'grad_norm': 0.06296037137508392, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0021, 'grad_norm': 0.02136928401887417, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0001, 'grad_norm': 0.001390288583934307, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.7191, 'train_samples_per_second': 7.087, 'train_steps_per_second': 0.502, 'train_loss': 0.008677351567104096, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:58,  1.57it/s]  1%|          | 3/471 [00:02<07:02,  1.11it/s]  1%|          | 4/471 [00:03<08:07,  1.04s/it]  1%|          | 5/471 [00:05<08:45,  1.13s/it]  1%|▏         | 6/471 [00:06<09:07,  1.18s/it]  1%|▏         | 7/471 [00:07<09:23,  1.21s/it]  2%|▏         | 8/471 [00:08<09:32,  1.24s/it]  2%|▏         | 9/471 [00:10<09:38,  1.25s/it]  2%|▏         | 10/471 [00:11<09:42,  1.26s/it]  2%|▏         | 11/471 [00:12<09:44,  1.27s/it]  3%|▎         | 12/471 [00:14<09:46,  1.28s/it]  3%|▎         | 13/471 [00:15<09:48,  1.29s/it]  3%|▎         | 14/471 [00:16<09:48,  1.29s/it]  3%|▎         | 15/471 [00:18<09:48,  1.29s/it]  3%|▎         | 16/471 [00:19<09:48,  1.29s/it]  4%|▎         | 17/471 [00:20<09:48,  1.30s/it]  4%|▍         | 18/471 [00:21<09:47,  1.30s/it]  4%|▍         | 19/471 [00:23<09:46,  1.30s/it]  4%|▍         | 20/471 [00:24<09:46,  1.30s/it]  4%|▍         | 21/471 [00:25<09:45,  1.30s/it]  5%|▍         | 22/471 [00:27<09:45,  1.30s/it]  5%|▍         | 23/471 [00:28<09:44,  1.30s/it]  5%|▌         | 24/471 [00:29<09:43,  1.31s/it]  5%|▌         | 25/471 [00:31<09:42,  1.31s/it]  6%|▌         | 26/471 [00:32<09:41,  1.31s/it]  6%|▌         | 27/471 [00:33<09:40,  1.31s/it]  6%|▌         | 28/471 [00:34<09:40,  1.31s/it]  6%|▌         | 29/471 [00:36<09:39,  1.31s/it]  6%|▋         | 30/471 [00:37<09:38,  1.31s/it]  7%|▋         | 31/471 [00:38<09:37,  1.31s/it]  7%|▋         | 32/471 [00:40<09:36,  1.31s/it]  7%|▋         | 33/471 [00:41<09:33,  1.31s/it]  7%|▋         | 34/471 [00:42<09:33,  1.31s/it]  7%|▋         | 35/471 [00:44<09:32,  1.31s/it]  8%|▊         | 36/471 [00:45<09:31,  1.31s/it]  8%|▊         | 37/471 [00:46<09:31,  1.32s/it]  8%|▊         | 38/471 [00:48<09:31,  1.32s/it]  8%|▊         | 39/471 [00:49<09:28,  1.32s/it]  8%|▊         | 40/471 [00:50<09:28,  1.32s/it]  9%|▊         | 41/471 [00:52<09:27,  1.32s/it]  9%|▉         | 42/471 [00:53<09:27,  1.32s/it]  9%|▉         | 43/471 [00:54<09:25,  1.32s/it]  9%|▉         | 44/471 [00:56<09:24,  1.32s/it] 10%|▉         | 45/471 [00:57<09:23,  1.32s/it] 10%|▉         | 46/471 [00:58<09:22,  1.32s/it] 10%|▉         | 47/471 [01:00<09:20,  1.32s/it] 10%|█         | 48/471 [01:01<09:19,  1.32s/it] 10%|█         | 49/471 [01:02<09:18,  1.32s/it] 11%|█         | 50/471 [01:04<09:18,  1.33s/it] 11%|█         | 51/471 [01:05<09:17,  1.33s/it] 11%|█         | 52/471 [01:06<09:16,  1.33s/it] 11%|█▏        | 53/471 [01:08<09:15,  1.33s/it] 11%|█▏        | 54/471 [01:09<09:14,  1.33s/it] 12%|█▏        | 55/471 [01:10<09:13,  1.33s/it] 12%|█▏        | 56/471 [01:12<09:12,  1.33s/it] 12%|█▏        | 57/471 [01:13<09:11,  1.33s/it] 12%|█▏        | 58/471 [01:14<09:09,  1.33s/it] 13%|█▎        | 59/471 [01:16<09:08,  1.33s/it] 13%|█▎        | 60/471 [01:17<09:06,  1.33s/it] 13%|█▎        | 61/471 [01:18<09:06,  1.33s/it] 13%|█▎        | 62/471 [01:20<09:04,  1.33s/it] 13%|█▎        | 63/471 [01:21<09:03,  1.33s/it] 14%|█▎        | 64/471 [01:22<09:01,  1.33s/it] 14%|█▍        | 65/471 [01:23<09:00,  1.33s/it] 14%|█▍        | 66/471 [01:25<08:59,  1.33s/it] 14%|█▍        | 67/471 [01:26<08:58,  1.33s/it] 14%|█▍        | 68/471 [01:27<08:56,  1.33s/it] 15%|█▍        | 69/471 [01:29<08:54,  1.33s/it] 15%|█▍        | 70/471 [01:30<08:54,  1.33s/it] 15%|█▌        | 71/471 [01:31<08:53,  1.33s/it] 15%|█▌        | 72/471 [01:33<08:52,  1.33s/it] 15%|█▌        | 73/471 [01:34<08:50,  1.33s/it] 16%|█▌        | 74/471 [01:35<08:48,  1.33s/it] 16%|█▌        | 75/471 [01:37<08:47,  1.33s/it] 16%|█▌        | 76/471 [01:38<08:46,  1.33s/it] 16%|█▋        | 77/471 [01:39<08:45,  1.33s/it] 17%|█▋        | 78/471 [01:41<08:43,  1.33s/it] 17%|█▋        | 79/471 [01:42<08:42,  1.33s/it] 17%|█▋        | 80/471 [01:43<08:41,  1.33s/it] 17%|█▋        | 81/471 [01:45<08:39,  1.33s/it] 17%|█▋        | 82/471 [01:46<08:38,  1.33s/it] 18%|█▊        | 83/471 [01:47<08:37,  1.33s/it] 18%|█▊        | 84/471 [01:49<08:35,  1.33s/it] 18%|█▊        | 85/471 [01:50<08:35,  1.33s/it] 18%|█▊        | 86/471 [01:51<08:33,  1.34s/it] 18%|█▊        | 87/471 [01:53<08:32,  1.33s/it] 19%|█▊        | 88/471 [01:54<08:30,  1.33s/it] 19%|█▉        | 89/471 [01:55<08:28,  1.33s/it] 19%|█▉        | 90/471 [01:57<08:28,  1.33s/it] 19%|█▉        | 91/471 [01:58<08:25,  1.33s/it] 20%|█▉        | 92/471 [01:59<08:24,  1.33s/it] 20%|█▉        | 93/471 [02:01<08:23,  1.33s/it] 20%|█▉        | 94/471 [02:02<08:22,  1.33s/it] 20%|██        | 95/471 [02:03<08:21,  1.33s/it] 20%|██        | 96/471 [02:05<08:19,  1.33s/it] 21%|██        | 97/471 [02:06<08:19,  1.34s/it] 21%|██        | 98/471 [02:07<08:17,  1.33s/it] 21%|██        | 99/471 [02:09<08:15,  1.33s/it] 21%|██        | 100/471 [02:10<08:14,  1.33s/it] 21%|██▏       | 101/471 [02:11<08:13,  1.33s/it] 22%|██▏       | 102/471 [02:13<08:12,  1.34s/it] 22%|██▏       | 103/471 [02:14<08:11,  1.34s/it] 22%|██▏       | 104/471 [02:16<08:10,  1.34s/it] 22%|██▏       | 105/471 [02:17<08:09,  1.34s/it] 23%|██▎       | 106/471 [02:18<08:07,  1.34s/it] 23%|██▎       | 107/471 [02:20<08:05,  1.33s/it] 23%|██▎       | 108/471 [02:21<08:04,  1.34s/it] 23%|██▎       | 109/471 [02:22<08:02,  1.33s/it] 23%|██▎       | 110/471 [02:23<08:00,  1.33s/it] 24%|██▎       | 111/471 [02:25<08:00,  1.33s/it] 24%|██▍       | 112/471 [02:26<07:59,  1.33s/it] 24%|██▍       | 113/471 [02:28<07:57,  1.33s/it] 24%|██▍       | 114/471 [02:29<07:56,  1.34s/it] 24%|██▍       | 115/471 [02:30<07:55,  1.34s/it] 25%|██▍       | 116/471 [02:32<07:54,  1.34s/it] 25%|██▍       | 117/471 [02:33<07:52,  1.34s/it] 25%|██▌       | 118/471 [02:34<07:51,  1.34s/it] 25%|██▌       | 119/471 [02:36<07:50,  1.34s/it] 25%|██▌       | 120/471 [02:37<07:49,  1.34s/it] 26%|██▌       | 121/471 [02:38<07:47,  1.34s/it] 26%|██▌       | 122/471 [02:40<07:46,  1.34s/it] 26%|██▌       | 123/471 [02:41<07:45,  1.34s/it] 26%|██▋       | 124/471 [02:42<07:44,  1.34s/it] 27%|██▋       | 125/471 [02:44<07:43,  1.34s/it] 27%|██▋       | 126/471 [02:45<07:42,  1.34s/it] 27%|██▋       | 127/471 [02:46<07:40,  1.34s/it] 27%|██▋       | 128/471 [02:48<07:39,  1.34s/it] 27%|██▋       | 129/471 [02:49<07:37,  1.34s/it] 28%|██▊       | 130/471 [02:50<07:36,  1.34s/it] 28%|██▊       | 131/471 [02:52<07:35,  1.34s/it] 28%|██▊       | 132/471 [02:53<07:34,  1.34s/it] 28%|██▊       | 133/471 [02:54<07:32,  1.34s/it] 28%|██▊       | 134/471 [02:56<07:31,  1.34s/it] 29%|██▊       | 135/471 [02:57<07:30,  1.34s/it] 29%|██▉       | 136/471 [02:58<07:28,  1.34s/it] 29%|██▉       | 137/471 [03:00<07:27,  1.34s/it] 29%|██▉       | 138/471 [03:01<07:26,  1.34s/it] 30%|██▉       | 139/471 [03:02<07:25,  1.34s/it] 30%|██▉       | 140/471 [03:04<07:23,  1.34s/it] 30%|██▉       | 141/471 [03:05<07:21,  1.34s/it] 30%|███       | 142/471 [03:06<07:20,  1.34s/it] 30%|███       | 143/471 [03:08<07:19,  1.34s/it] 31%|███       | 144/471 [03:09<07:18,  1.34s/it] 31%|███       | 145/471 [03:10<07:16,  1.34s/it] 31%|███       | 146/471 [03:12<07:16,  1.34s/it] 31%|███       | 147/471 [03:13<07:14,  1.34s/it] 31%|███▏      | 148/471 [03:14<07:13,  1.34s/it] 32%|███▏      | 149/471 [03:16<07:12,  1.34s/it] 32%|███▏      | 150/471 [03:17<07:12,  1.35s/it] 32%|███▏      | 151/471 [03:18<07:10,  1.35s/it] 32%|███▏      | 152/471 [03:20<07:08,  1.34s/it] 32%|███▏      | 153/471 [03:21<07:08,  1.35s/it] 33%|███▎      | 154/471 [03:22<07:06,  1.35s/it] 33%|███▎      | 155/471 [03:24<07:05,  1.35s/it] 33%|███▎      | 156/471 [03:25<07:03,  1.35s/it] 33%|███▎      | 157/471 [03:27<07:02,  1.35s/it] 34%|███▎      | 158/471 [03:28<07:00,  1.34s/it] 34%|███▍      | 159/471 [03:29<06:59,  1.34s/it] 34%|███▍      | 160/471 [03:31<06:58,  1.35s/it] 34%|███▍      | 161/471 [03:32<06:57,  1.35s/it] 34%|███▍      | 162/471 [03:33<06:56,  1.35s/it] 35%|███▍      | 163/471 [03:35<06:55,  1.35s/it] 35%|███▍      | 164/471 [03:36<06:53,  1.35s/it] 35%|███▌      | 165/471 [03:37<06:52,  1.35s/it] 35%|███▌      | 166/471 [03:39<06:51,  1.35s/it] 35%|███▌      | 167/471 [03:40<06:50,  1.35s/it] 36%|███▌      | 168/471 [03:41<06:49,  1.35s/it] 36%|███▌      | 169/471 [03:43<06:48,  1.35s/it] 36%|███▌      | 170/471 [03:44<06:46,  1.35s/it] 36%|███▋      | 171/471 [03:45<06:45,  1.35s/it] 37%|███▋      | 172/471 [03:47<06:43,  1.35s/it] 37%|███▋      | 173/471 [03:48<06:42,  1.35s/it] 37%|███▋      | 174/471 [03:49<06:40,  1.35s/it] 37%|███▋      | 175/471 [03:51<06:39,  1.35s/it] 37%|███▋      | 176/471 [03:52<06:38,  1.35s/it] 38%|███▊      | 177/471 [03:53<06:36,  1.35s/it] 38%|███▊      | 178/471 [03:55<06:35,  1.35s/it] 38%|███▊      | 179/471 [03:56<06:33,  1.35s/it] 38%|███▊      | 180/471 [03:58<06:32,  1.35s/it] 38%|███▊      | 181/471 [03:59<06:31,  1.35s/it] 39%|███▊      | 182/471 [04:00<06:29,  1.35s/it] 39%|███▉      | 183/471 [04:02<06:28,  1.35s/it] 39%|███▉      | 184/471 [04:03<06:26,  1.35s/it] 39%|███▉      | 185/471 [04:04<06:25,  1.35s/it] 39%|███▉      | 186/471 [04:06<06:24,  1.35s/it] 40%|███▉      | 187/471 [04:07<06:23,  1.35s/it] 40%|███▉      | 188/471 [04:08<06:22,  1.35s/it] 40%|████      | 189/471 [04:10<06:20,  1.35s/it] 40%|████      | 190/471 [04:11<06:19,  1.35s/it] 41%|████      | 191/471 [04:12<06:18,  1.35s/it] 41%|████      | 192/471 [04:14<06:16,  1.35s/it] 41%|████      | 193/471 [04:15<06:14,  1.35s/it] 41%|████      | 194/471 [04:16<06:13,  1.35s/it] 41%|████▏     | 195/471 [04:18<06:12,  1.35s/it] 42%|████▏     | 196/471 [04:19<06:10,  1.35s/it] 42%|████▏     | 197/471 [04:20<06:07,  1.34s/it] 42%|████▏     | 198/471 [04:22<06:06,  1.34s/it] 42%|████▏     | 199/471 [04:23<06:05,  1.34s/it] 42%|████▏     | 200/471 [04:24<06:04,  1.34s/it] 43%|████▎     | 201/471 [04:26<06:01,  1.34s/it] 43%|████▎     | 202/471 [04:27<06:01,  1.34s/it] 43%|████▎     | 203/471 [04:28<05:59,  1.34s/it] 43%|████▎     | 204/471 [04:30<05:58,  1.34s/it] 44%|████▎     | 205/471 [04:31<05:56,  1.34s/it] 44%|████▎     | 206/471 [04:32<05:54,  1.34s/it] 44%|████▍     | 207/471 [04:34<05:53,  1.34s/it] 44%|████▍     | 208/471 [04:35<05:51,  1.34s/it] 44%|████▍     | 209/471 [04:37<05:50,  1.34s/it] 45%|████▍     | 210/471 [04:38<05:49,  1.34s/it] 45%|████▍     | 211/471 [04:39<05:47,  1.34s/it] 45%|████▌     | 212/471 [04:41<05:46,  1.34s/it] 45%|████▌     | 213/471 [04:42<05:45,  1.34s/it] 45%|████▌     | 214/471 [04:43<05:43,  1.34s/it] 46%|████▌     | 215/471 [04:45<05:42,  1.34s/it] 46%|████▌     | 216/471 [04:46<05:41,  1.34s/it] 46%|████▌     | 217/471 [04:47<05:40,  1.34s/it] 46%|████▋     | 218/471 [04:49<05:39,  1.34s/it] 46%|████▋     | 219/471 [04:50<05:37,  1.34s/it] 47%|████▋     | 220/471 [04:51<05:36,  1.34s/it] 47%|████▋     | 221/471 [04:53<05:35,  1.34s/it] 47%|████▋     | 222/471 [04:54<05:33,  1.34s/it] 47%|████▋     | 223/471 [04:55<05:31,  1.34s/it] 48%|████▊     | 224/471 [04:57<05:30,  1.34s/it] 48%|████▊     | 225/471 [04:58<05:29,  1.34s/it] 48%|████▊     | 226/471 [04:59<05:27,  1.34s/it] 48%|████▊     | 227/471 [05:01<05:26,  1.34s/it] 48%|████▊     | 228/471 [05:02<05:24,  1.34s/it] 49%|████▊     | 229/471 [05:03<05:23,  1.34s/it] 49%|████▉     | 230/471 [05:05<05:22,  1.34s/it] 49%|████▉     | 231/471 [05:06<05:21,  1.34s/it] 49%|████▉     | 232/471 [05:07<05:19,  1.33s/it] 49%|████▉     | 233/471 [05:09<05:17,  1.34s/it] 50%|████▉     | 234/471 [05:10<05:16,  1.34s/it] 50%|████▉     | 235/471 [05:11<05:15,  1.34s/it] 50%|█████     | 236/471 [05:13<05:13,  1.34s/it] 50%|█████     | 237/471 [05:14<05:12,  1.33s/it] 51%|█████     | 238/471 [05:15<05:10,  1.33s/it] 51%|█████     | 239/471 [05:17<05:09,  1.33s/it] 51%|█████     | 240/471 [05:18<05:08,  1.33s/it] 51%|█████     | 241/471 [05:19<05:07,  1.34s/it] 51%|█████▏    | 242/471 [05:21<05:05,  1.33s/it] 52%|█████▏    | 243/471 [05:22<05:04,  1.33s/it] 52%|█████▏    | 244/471 [05:23<05:02,  1.33s/it] 52%|█████▏    | 245/471 [05:25<05:01,  1.33s/it] 52%|█████▏    | 246/471 [05:26<04:59,  1.33s/it] 52%|█████▏    | 247/471 [05:27<04:58,  1.33s/it] 53%|█████▎    | 248/471 [05:29<04:57,  1.33s/it] 53%|█████▎    | 249/471 [05:30<04:56,  1.33s/it] 53%|█████▎    | 250/471 [05:31<04:54,  1.33s/it] 53%|█████▎    | 251/471 [05:33<04:52,  1.33s/it] 54%|█████▎    | 252/471 [05:34<04:51,  1.33s/it] 54%|█████▎    | 253/471 [05:35<04:50,  1.33s/it] 54%|█████▍    | 254/471 [05:37<04:49,  1.33s/it] 54%|█████▍    | 255/471 [05:38<04:47,  1.33s/it] 54%|█████▍    | 256/471 [05:39<04:46,  1.33s/it] 55%|█████▍    | 257/471 [05:41<04:45,  1.33s/it] 55%|█████▍    | 258/471 [05:42<04:44,  1.33s/it] 55%|█████▍    | 259/471 [05:43<04:42,  1.33s/it] 55%|█████▌    | 260/471 [05:45<04:41,  1.33s/it] 55%|█████▌    | 261/471 [05:46<04:39,  1.33s/it] 56%|█████▌    | 262/471 [05:47<04:38,  1.33s/it] 56%|█████▌    | 263/471 [05:49<04:37,  1.33s/it] 56%|█████▌    | 264/471 [05:50<04:35,  1.33s/it] 56%|█████▋    | 265/471 [05:51<04:34,  1.33s/it] 56%|█████▋    | 266/471 [05:53<04:33,  1.33s/it] 57%|█████▋    | 267/471 [05:54<04:31,  1.33s/it] 57%|█████▋    | 268/471 [05:55<04:30,  1.33s/it] 57%|█████▋    | 269/471 [05:57<04:29,  1.33s/it] 57%|█████▋    | 270/471 [05:58<04:27,  1.33s/it] 58%|█████▊    | 271/471 [05:59<04:26,  1.33s/it] 58%|█████▊    | 272/471 [06:01<04:24,  1.33s/it] 58%|█████▊    | 273/471 [06:02<04:23,  1.33s/it] 58%|█████▊    | 274/471 [06:03<04:22,  1.33s/it] 58%|█████▊    | 275/471 [06:05<04:20,  1.33s/it] 59%|█████▊    | 276/471 [06:06<04:19,  1.33s/it] 59%|█████▉    | 277/471 [06:07<04:18,  1.33s/it] 59%|█████▉    | 278/471 [06:09<04:17,  1.33s/it] 59%|█████▉    | 279/471 [06:10<04:15,  1.33s/it] 59%|█████▉    | 280/471 [06:11<04:14,  1.33s/it] 60%|█████▉    | 281/471 [06:13<04:13,  1.33s/it] 60%|█████▉    | 282/471 [06:14<04:11,  1.33s/it] 60%|██████    | 283/471 [06:15<04:10,  1.33s/it] 60%|██████    | 284/471 [06:17<04:09,  1.33s/it] 61%|██████    | 285/471 [06:18<04:08,  1.33s/it] 61%|██████    | 286/471 [06:19<04:06,  1.33s/it] 61%|██████    | 287/471 [06:21<04:05,  1.33s/it] 61%|██████    | 288/471 [06:22<04:04,  1.33s/it] 61%|██████▏   | 289/471 [06:23<04:02,  1.33s/it] 62%|██████▏   | 290/471 [06:25<04:00,  1.33s/it] 62%|██████▏   | 291/471 [06:26<03:59,  1.33s/it] 62%|██████▏   | 292/471 [06:27<03:58,  1.33s/it] 62%|██████▏   | 293/471 [06:29<03:56,  1.33s/it] 62%|██████▏   | 294/471 [06:30<03:55,  1.33s/it] 63%|██████▎   | 295/471 [06:31<03:53,  1.33s/it] 63%|██████▎   | 296/471 [06:33<03:52,  1.33s/it] 63%|██████▎   | 297/471 [06:34<03:51,  1.33s/it] 63%|██████▎   | 298/471 [06:35<03:50,  1.33s/it] 63%|██████▎   | 299/471 [06:37<03:48,  1.33s/it] 64%|██████▎   | 300/471 [06:38<03:47,  1.33s/it] 64%|██████▍   | 301/471 [06:39<03:46,  1.33s/it] 64%|██████▍   | 302/471 [06:41<03:45,  1.33s/it] 64%|██████▍   | 303/471 [06:42<03:43,  1.33s/it] 65%|██████▍   | 304/471 [06:43<03:41,  1.33s/it] 65%|██████▍   | 305/471 [06:45<03:40,  1.33s/it] 65%|██████▍   | 306/471 [06:46<03:39,  1.33s/it] 65%|██████▌   | 307/471 [06:47<03:38,  1.33s/it] 65%|██████▌   | 308/471 [06:49<03:37,  1.34s/it] 66%|██████▌   | 309/471 [06:50<03:36,  1.33s/it] 66%|██████▌   | 310/471 [06:51<03:34,  1.33s/it] 66%|██████▌   | 311/471 [06:53<03:33,  1.33s/it] 66%|██████▌   | 312/471 [06:54<03:31,  1.33s/it] 66%|██████▋   | 313/471 [06:55<03:30,  1.33s/it] 67%|██████▋   | 314/471 [06:57<03:29,  1.33s/it] 67%|██████▋   | 315/471 [06:58<03:27,  1.33s/it] 67%|██████▋   | 316/471 [06:59<03:26,  1.33s/it] 67%|██████▋   | 317/471 [07:01<03:25,  1.33s/it] 68%|██████▊   | 318/471 [07:02<03:23,  1.33s/it] 68%|██████▊   | 319/471 [07:03<03:22,  1.33s/it] 68%|██████▊   | 320/471 [07:05<03:21,  1.33s/it] 68%|██████▊   | 321/471 [07:06<03:20,  1.33s/it] 68%|██████▊   | 322/471 [07:07<03:18,  1.33s/it] 69%|██████▊   | 323/471 [07:09<03:17,  1.34s/it] 69%|██████▉   | 324/471 [07:10<03:16,  1.34s/it] 69%|██████▉   | 325/471 [07:11<03:15,  1.34s/it] 69%|██████▉   | 326/471 [07:13<03:13,  1.34s/it] 69%|██████▉   | 327/471 [07:14<03:11,  1.33s/it] 70%|██████▉   | 328/471 [07:15<03:10,  1.33s/it] 70%|██████▉   | 329/471 [07:17<03:09,  1.33s/it] 70%|███████   | 330/471 [07:18<03:07,  1.33s/it] 70%|███████   | 331/471 [07:19<03:06,  1.33s/it] 70%|███████   | 332/471 [07:21<03:05,  1.33s/it] 71%|███████   | 333/471 [07:22<03:03,  1.33s/it] 71%|███████   | 334/471 [07:23<03:02,  1.33s/it] 71%|███████   | 335/471 [07:25<03:01,  1.33s/it] 71%|███████▏  | 336/471 [07:26<02:59,  1.33s/it] 72%|███████▏  | 337/471 [07:27<02:58,  1.33s/it] 72%|███████▏  | 338/471 [07:29<02:57,  1.33s/it] 72%|███████▏  | 339/471 [07:30<02:55,  1.33s/it] 72%|███████▏  | 340/471 [07:31<02:54,  1.33s/it] 72%|███████▏  | 341/471 [07:33<02:53,  1.33s/it] 73%|███████▎  | 342/471 [07:34<02:51,  1.33s/it] 73%|███████▎  | 343/471 [07:35<02:50,  1.33s/it] 73%|███████▎  | 344/471 [07:37<02:48,  1.33s/it] 73%|███████▎  | 345/471 [07:38<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:39<02:46,  1.33s/it] 74%|███████▎  | 347/471 [07:41<02:45,  1.33s/it] 74%|███████▍  | 348/471 [07:42<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:43<02:42,  1.33s/it] 74%|███████▍  | 350/471 [07:45<02:41,  1.33s/it] 75%|███████▍  | 351/471 [07:46<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:47<02:38,  1.33s/it] 75%|███████▍  | 353/471 [07:49<02:37,  1.34s/it] 75%|███████▌  | 354/471 [07:50<02:36,  1.33s/it] 75%|███████▌  | 355/471 [07:51<02:34,  1.34s/it] 76%|███████▌  | 356/471 [07:53<02:33,  1.34s/it] 76%|███████▌  | 357/471 [07:54<02:32,  1.34s/it] 76%|███████▌  | 358/471 [07:55<02:30,  1.34s/it] 76%|███████▌  | 359/471 [07:57<02:29,  1.34s/it] 76%|███████▋  | 360/471 [07:58<02:28,  1.34s/it] 77%|███████▋  | 361/471 [07:59<02:26,  1.34s/it] 77%|███████▋  | 362/471 [08:01<02:25,  1.34s/it] 77%|███████▋  | 363/471 [08:02<02:24,  1.34s/it] 77%|███████▋  | 364/471 [08:03<02:23,  1.34s/it] 77%|███████▋  | 365/471 [08:05<02:22,  1.34s/it] 78%|███████▊  | 366/471 [08:06<02:20,  1.34s/it] 78%|███████▊  | 367/471 [08:07<02:19,  1.34s/it] 78%|███████▊  | 368/471 [08:09<02:18,  1.34s/it] 78%|███████▊  | 369/471 [08:10<02:16,  1.34s/it] 79%|███████▊  | 370/471 [08:11<02:15,  1.34s/it] 79%|███████▉  | 371/471 [08:13<02:14,  1.34s/it] 79%|███████▉  | 372/471 [08:14<02:12,  1.34s/it] 79%|███████▉  | 373/471 [08:15<02:11,  1.34s/it] 79%|███████▉  | 374/471 [08:17<02:10,  1.34s/it] 80%|███████▉  | 375/471 [08:18<02:09,  1.34s/it] 80%|███████▉  | 376/471 [08:19<02:07,  1.34s/it] 80%|████████  | 377/471 [08:21<02:06,  1.34s/it] 80%|████████  | 378/471 [08:22<02:04,  1.34s/it] 80%|████████  | 379/471 [08:23<02:03,  1.35s/it] 81%|████████  | 380/471 [08:25<02:02,  1.35s/it] 81%|████████  | 381/471 [08:26<02:01,  1.35s/it] 81%|████████  | 382/471 [08:27<01:59,  1.35s/it] 81%|████████▏ | 383/471 [08:29<01:58,  1.35s/it] 82%|████████▏ | 384/471 [08:30<01:57,  1.35s/it] 82%|████████▏ | 385/471 [08:31<01:56,  1.35s/it] 82%|████████▏ | 386/471 [08:33<01:54,  1.35s/it] 82%|████████▏ | 387/471 [08:34<01:53,  1.35s/it] 82%|████████▏ | 388/471 [08:36<01:52,  1.35s/it] 83%|████████▎ | 389/471 [08:37<01:50,  1.35s/it] 83%|████████▎ | 390/471 [08:38<01:49,  1.35s/it] 83%|████████▎ | 391/471 [08:40<01:47,  1.35s/it] 83%|████████▎ | 392/471 [08:41<01:46,  1.35s/it] 83%|████████▎ | 393/471 [08:42<01:45,  1.35s/it] 84%|████████▎ | 394/471 [08:44<01:43,  1.35s/it] 84%|████████▍ | 395/471 [08:45<01:42,  1.35s/it] 84%|████████▍ | 396/471 [08:46<01:41,  1.35s/it] 84%|████████▍ | 397/471 [08:48<01:39,  1.35s/it] 85%|████████▍ | 398/471 [08:49<01:38,  1.35s/it] 85%|████████▍ | 399/471 [08:50<01:37,  1.35s/it] 85%|████████▍ | 400/471 [08:52<01:35,  1.35s/it] 85%|████████▌ | 401/471 [08:53<01:34,  1.35s/it] 85%|████████▌ | 402/471 [08:54<01:32,  1.34s/it] 86%|████████▌ | 403/471 [08:56<01:31,  1.34s/it] 86%|████████▌ | 404/471 [08:57<01:29,  1.34s/it] 86%|████████▌ | 405/471 [08:58<01:28,  1.34s/it] 86%|████████▌ | 406/471 [09:00<01:27,  1.34s/it] 86%|████████▋ | 407/471 [09:01<01:25,  1.34s/it] 87%|████████▋ | 408/471 [09:02<01:24,  1.34s/it] 87%|████████▋ | 409/471 [09:04<01:23,  1.34s/it] 87%|████████▋ | 410/471 [09:05<01:21,  1.34s/it] 87%|████████▋ | 411/471 [09:06<01:20,  1.34s/it] 87%|████████▋ | 412/471 [09:08<01:19,  1.34s/it] 88%|████████▊ | 413/471 [09:09<01:17,  1.34s/it] 88%|████████▊ | 414/471 [09:11<01:16,  1.34s/it] 88%|████████▊ | 415/471 [09:12<01:15,  1.34s/it] 88%|████████▊ | 416/471 [09:13<01:13,  1.34s/it] 89%|████████▊ | 417/471 [09:15<01:12,  1.34s/it] 89%|████████▊ | 418/471 [09:16<01:11,  1.34s/it] 89%|████████▉ | 419/471 [09:17<01:09,  1.34s/it] 89%|████████▉ | 420/471 [09:19<01:08,  1.34s/it] 89%|████████▉ | 421/471 [09:20<01:07,  1.34s/it] 90%|████████▉ | 422/471 [09:21<01:05,  1.34s/it] 90%|████████▉ | 423/471 [09:23<01:04,  1.34s/it] 90%|█████████ | 424/471 [09:24<01:03,  1.34s/it] 90%|█████████ | 425/471 [09:25<01:01,  1.34s/it] 90%|█████████ | 426/471 [09:27<01:00,  1.34s/it] 91%|█████████ | 427/471 [09:28<00:59,  1.34s/it] 91%|█████████ | 428/471 [09:29<00:57,  1.34s/it] 91%|█████████ | 429/471 [09:31<00:56,  1.34s/it] 91%|█████████▏| 430/471 [09:32<00:54,  1.34s/it] 92%|█████████▏| 431/471 [09:33<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:35<00:52,  1.34s/it] 92%|█████████▏| 433/471 [09:36<00:50,  1.34s/it] 92%|█████████▏| 434/471 [09:37<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:39<00:48,  1.34s/it] 93%|█████████▎| 436/471 [09:40<00:46,  1.34s/it] 93%|█████████▎| 437/471 [09:41<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:43<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:44<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:45<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:47<00:40,  1.34s/it] 94%|█████████▍| 442/471 [09:48<00:38,  1.34s/it] 94%|█████████▍| 443/471 [09:49<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:51<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:52<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:53<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:55<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:56<00:30,  1.34s/it] 95%|█████████▌| 449/471 [09:57<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:59<00:28,  1.34s/it] 96%|█████████▌| 451/471 [10:00<00:26,  1.34s/it] 96%|█████████▌| 452/471 [10:01<00:25,  1.34s/it] 96%|█████████▌| 453/471 [10:03<00:24,  1.34s/it] 96%|█████████▋| 454/471 [10:04<00:22,  1.34s/it] 97%|█████████▋| 455/471 [10:05<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:07<00:20,  1.34s/it] 97%|█████████▋| 457/471 [10:08<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:09<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:11<00:16,  1.34s/it] 98%|█████████▊| 460/471 [10:12<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:13<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:15<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:16<00:10,  1.34s/it] 99%|█████████▊| 464/471 [10:17<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:19<00:08,  1.34s/it] 99%|█████████▉| 466/471 [10:20<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:21<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:23<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:24<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:26<00:01,  1.34s/it]100%|██████████| 471/471 [10:26<00:00,  1.23s/it]100%|██████████| 471/471 [10:26<00:00,  1.33s/it]
{'eval_loss': 2.718427896499634, 'eval_model_preparation_time': 0.0108, 'eval_acc': 0.3267392458842273, 'eval_runtime': 628.2347, 'eval_samples_per_second': 11.989, 'eval_steps_per_second': 0.75}
ROUND:16
CLIENT:7
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]                                              {'loss': 2.337, 'grad_norm': 12.14643669128418, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.18s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 1.7163, 'grad_norm': 7.7853684425354, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 2.1593, 'grad_norm': 11.825695037841797, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 2.1239, 'grad_norm': 17.607736587524414, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 1.5331, 'grad_norm': 10.910701751708984, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 2.0479, 'grad_norm': 11.188626289367676, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 1.1213, 'grad_norm': 9.751511573791504, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 4.1703, 'grad_norm': 61.66416931152344, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.79s/it]                                              {'loss': 0.6736, 'grad_norm': 6.211094856262207, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.79s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 0.445, 'grad_norm': 6.255490779876709, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it]                                               {'loss': 0.9743, 'grad_norm': 8.273442268371582, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.4676, 'grad_norm': 4.753673553466797, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.7152, 'grad_norm': 5.806920051574707, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:29<00:55,  2.15s/it]                                               {'loss': 1.265, 'grad_norm': 21.677200317382812, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.9516, 'grad_norm': 9.592865943908691, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.3313, 'grad_norm': 15.508749961853027, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.669, 'grad_norm': 3.8820340633392334, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.2091, 'grad_norm': 1.8822892904281616, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it]                                               {'loss': 0.3197, 'grad_norm': 3.2881085872650146, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.3238, 'grad_norm': 4.996423244476318, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.6024, 'grad_norm': 3.8134937286376953, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.5893, 'grad_norm': 4.9914984703063965, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.1639, 'grad_norm': 3.131469964981079, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.7261, 'grad_norm': 27.188865661621094, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.3411, 'grad_norm': 4.808914661407471, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.2781, 'grad_norm': 4.663536071777344, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it]                                               {'loss': 0.1868, 'grad_norm': 1.7529908418655396, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.0831, 'grad_norm': 1.7577227354049683, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.2469, 'grad_norm': 2.4537956714630127, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.1047, 'grad_norm': 2.285038709640503, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.0538, 'grad_norm': 0.7669750452041626, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0517, 'grad_norm': 1.9527931213378906, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0865, 'grad_norm': 1.68746817111969, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.142, 'grad_norm': 4.902585506439209, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it]                                               {'loss': 0.4054, 'grad_norm': 6.709690093994141, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.4544, 'grad_norm': 3.87160325050354, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0664, 'grad_norm': 1.49679696559906, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1262, 'grad_norm': 2.705972671508789, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.089, 'grad_norm': 1.101353406906128, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0154, 'grad_norm': 0.36652565002441406, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.7064, 'train_samples_per_second': 7.089, 'train_steps_per_second': 0.502, 'train_loss': 0.7341899121413007, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:25
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 2.8085, 'grad_norm': 9.581375122070312, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 2.207, 'grad_norm': 13.991881370544434, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 1.8349, 'grad_norm': 9.37757396697998, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 2.7986, 'grad_norm': 10.330305099487305, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 3.5129, 'grad_norm': 20.66881561279297, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.6143, 'grad_norm': 21.664060592651367, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 2.552, 'grad_norm': 12.513833045959473, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.0136, 'grad_norm': 1.1356979608535767, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.1522, 'grad_norm': 7.423183917999268, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it]                                               {'loss': 0.3956, 'grad_norm': 5.034331321716309, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 1.4016, 'grad_norm': 8.17640209197998, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 0.9817, 'grad_norm': 6.483603477478027, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.1511, 'grad_norm': 6.539963245391846, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 1.2149, 'grad_norm': 7.738187789916992, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 1.3289, 'grad_norm': 12.140725135803223, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 1.8874, 'grad_norm': 21.07145118713379, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.2312, 'grad_norm': 4.894247055053711, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.8386, 'grad_norm': 4.878597736358643, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.5646, 'grad_norm': 4.207704544067383, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.2383, 'grad_norm': 3.0954596996307373, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.6447, 'grad_norm': 5.517625331878662, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it]                                               {'loss': 0.174, 'grad_norm': 1.8797448873519897, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.22s/it]                                               {'loss': 0.2155, 'grad_norm': 2.7089617252349854, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.22s/it] 60%|██████    | 24/40 [00:47<00:25,  1.61s/it]                                               {'loss': 0.0205, 'grad_norm': 0.5434147715568542, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.61s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it]                                               {'loss': 0.1139, 'grad_norm': 2.5774269104003906, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.0436, 'grad_norm': 1.0206725597381592, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it]                                               {'loss': 0.2755, 'grad_norm': 2.6436984539031982, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.04s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0893, 'grad_norm': 1.9785945415496826, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.0419, 'grad_norm': 0.7233194708824158, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.0637, 'grad_norm': 0.6431748867034912, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.1141, 'grad_norm': 1.1783604621887207, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 2.1055, 'grad_norm': 16.245237350463867, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.0337, 'grad_norm': 0.3775363266468048, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it]                                               {'loss': 0.1107, 'grad_norm': 0.7928896546363831, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.95s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it]                                               {'loss': 0.0673, 'grad_norm': 2.7325003147125244, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0555, 'grad_norm': 1.2429184913635254, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0138, 'grad_norm': 0.41706040501594543, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it]                                               {'loss': 0.1921, 'grad_norm': 4.791417121887207, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0228, 'grad_norm': 0.43994176387786865, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0003, 'grad_norm': 0.02731298841536045, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.6284, 'train_samples_per_second': 7.095, 'train_steps_per_second': 0.502, 'train_loss': 0.8281550643463561, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]                                              {'loss': 2.3313, 'grad_norm': 11.138066291809082, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.21s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.6822, 'grad_norm': 11.23253059387207, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.2585, 'grad_norm': 11.314160346984863, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 2.357, 'grad_norm': 18.173370361328125, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 1.6619, 'grad_norm': 12.49686336517334, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it]                                              {'loss': 3.7883, 'grad_norm': 34.93540954589844, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 1.0769, 'grad_norm': 18.1190185546875, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.011, 'grad_norm': 54.35007858276367, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.44, 'grad_norm': 11.780266761779785, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.5643, 'grad_norm': 7.090653419494629, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 1.1987, 'grad_norm': 15.108379364013672, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 1.1036, 'grad_norm': 7.144833564758301, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.3662, 'grad_norm': 4.822608947753906, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.058, 'grad_norm': 7.592442512512207, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.5699, 'grad_norm': 5.201930046081543, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0014, 'grad_norm': 0.10684248805046082, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.6284, 'grad_norm': 7.0379767417907715, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.1819, 'grad_norm': 2.8732948303222656, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.4516, 'grad_norm': 11.309123039245605, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 1.692, 'grad_norm': 13.538723945617676, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.2505, 'grad_norm': 4.659954071044922, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.2826, 'grad_norm': 4.416008949279785, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.4965, 'grad_norm': 5.906361103057861, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 3.5125, 'grad_norm': 100.03227996826172, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.286, 'grad_norm': 2.5450539588928223, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.2451, 'grad_norm': 8.037403106689453, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.0917, 'grad_norm': 2.6152827739715576, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.0664, 'grad_norm': 2.407637596130371, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 1.0669, 'grad_norm': 22.463298797607422, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.3514, 'grad_norm': 7.493575572967529, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.4446, 'grad_norm': 11.45655345916748, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.037, 'grad_norm': 0.9435873031616211, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.4281, 'grad_norm': 1.6537842750549316, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.06, 'grad_norm': 1.9501919746398926, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0583, 'grad_norm': 1.2485617399215698, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0474, 'grad_norm': 1.0107924938201904, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it]                                               {'loss': 0.3442, 'grad_norm': 3.362233877182007, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it]                                               {'loss': 0.1168, 'grad_norm': 1.7473095655441284, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.1459, 'grad_norm': 1.7182531356811523, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0506, 'grad_norm': 1.6025482416152954, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.6823, 'train_samples_per_second': 7.181, 'train_steps_per_second': 0.508, 'train_loss': 0.8451401098165661, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]                                              {'loss': 2.1314, 'grad_norm': 12.23354434967041, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.17s/it]  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]                                              {'loss': 1.6932, 'grad_norm': 10.552617073059082, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.19s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.7363, 'grad_norm': 12.097043991088867, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 0.9205, 'grad_norm': 7.745895862579346, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 2.2111, 'grad_norm': 17.793781280517578, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 1.4602, 'grad_norm': 19.324562072753906, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 0.7638, 'grad_norm': 9.140331268310547, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.56s/it]                                              {'loss': 0.2879, 'grad_norm': 18.257362365722656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 0.5537, 'grad_norm': 7.324130058288574, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 1.2118, 'grad_norm': 9.001107215881348, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.1414, 'grad_norm': 3.0720479488372803, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 0.4854, 'grad_norm': 6.523779392242432, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 0.2368, 'grad_norm': 4.408620357513428, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.62, 'grad_norm': 6.678224086761475, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.4904, 'grad_norm': 7.667403697967529, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.1379, 'grad_norm': 9.431798934936523, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.1283, 'grad_norm': 1.8479206562042236, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.0842, 'grad_norm': 2.054142475128174, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it]                                               {'loss': 0.1285, 'grad_norm': 2.3757381439208984, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.1754, 'grad_norm': 1.4332636594772339, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.1181, 'grad_norm': 1.3070411682128906, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.1224, 'grad_norm': 2.345773458480835, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.1778, 'grad_norm': 3.7898855209350586, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.3336, 'grad_norm': 16.92188835144043, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.1278, 'grad_norm': 4.903105735778809, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.1496, 'grad_norm': 5.887342929840088, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.0288, 'grad_norm': 0.456836074590683, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.0322, 'grad_norm': 0.5362460017204285, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1207, 'grad_norm': 6.003066062927246, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0399, 'grad_norm': 0.6951936483383179, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0088, 'grad_norm': 0.30075353384017944, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.0228, 'grad_norm': 1.0971001386642456, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0979, 'grad_norm': 3.0231473445892334, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0166, 'grad_norm': 0.3806227147579193, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.0253, 'grad_norm': 0.7001860737800598, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0385, 'grad_norm': 0.864560604095459, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0355, 'grad_norm': 1.210397720336914, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0236, 'grad_norm': 0.5949021577835083, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0397, 'grad_norm': 0.7825931310653687, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'loss': 0.0061, 'grad_norm': 0.2462211549282074, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'train_runtime': 79.3844, 'train_samples_per_second': 7.117, 'train_steps_per_second': 0.504, 'train_loss': 0.4290959044243209, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:47
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]                                              {'loss': 3.1838, 'grad_norm': 10.520566940307617, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.19s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.1376, 'grad_norm': 12.241262435913086, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.2712, 'grad_norm': 12.648665428161621, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.0268, 'grad_norm': 7.757485389709473, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 3.6916, 'grad_norm': 14.81981372833252, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 3.2923, 'grad_norm': 16.890525817871094, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 1.5175, 'grad_norm': 11.789617538452148, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.4368, 'grad_norm': 35.68256759643555, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.0816, 'grad_norm': 7.842936038970947, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.3239, 'grad_norm': 10.79317569732666, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.0342, 'grad_norm': 7.044759273529053, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.8191, 'grad_norm': 8.267605781555176, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.9336, 'grad_norm': 6.238595962524414, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 1.0113, 'grad_norm': 6.607922554016113, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 0.6784, 'grad_norm': 7.5233354568481445, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0001, 'grad_norm': 0.005887693725526333, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.3323, 'grad_norm': 3.0343971252441406, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.183, 'grad_norm': 3.7834362983703613, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.2408, 'grad_norm': 2.9797134399414062, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.1366, 'grad_norm': 2.6235134601593018, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.1132, 'grad_norm': 1.3579236268997192, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.3151, 'grad_norm': 3.407153844833374, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.1999, 'grad_norm': 1.9450695514678955, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0424, 'grad_norm': 2.2980403900146484, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.126, 'grad_norm': 4.45539665222168, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.0451, 'grad_norm': 0.6881102323532104, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.0283, 'grad_norm': 0.38626036047935486, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.0832, 'grad_norm': 2.16455340385437, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.1182, 'grad_norm': 1.0629597902297974, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0717, 'grad_norm': 2.2683725357055664, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0394, 'grad_norm': 0.9717651009559631, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0994, 'grad_norm': 3.176877498626709, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.1519, 'grad_norm': 4.989661693572998, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.2063, 'grad_norm': 15.7533597946167, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0546, 'grad_norm': 1.1568528413772583, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0225, 'grad_norm': 0.525702178478241, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.0604, 'grad_norm': 1.564985752105713, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0318, 'grad_norm': 0.5437638759613037, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0711, 'grad_norm': 1.8837002515792847, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.7531, 'grad_norm': 44.70710754394531, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.9541, 'train_samples_per_second': 7.156, 'train_steps_per_second': 0.507, 'train_loss': 0.7241517504529839, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:29
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 3.2167, 'grad_norm': 12.706863403320312, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]                                              {'loss': 2.0901, 'grad_norm': 12.344755172729492, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:21,  2.15s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 1.8969, 'grad_norm': 12.325643539428711, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.16s/it]                                              {'loss': 2.3277, 'grad_norm': 15.457517623901367, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.16s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 2.4976, 'grad_norm': 27.45026969909668, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 2.2101, 'grad_norm': 17.220123291015625, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.1973, 'grad_norm': 11.28120231628418, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 2.496, 'grad_norm': 54.48894500732422, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 1.1939, 'grad_norm': 12.676928520202637, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 0.8925, 'grad_norm': 14.248973846435547, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.4599, 'grad_norm': 9.860372543334961, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.7145, 'grad_norm': 14.530817031860352, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.0477, 'grad_norm': 39.49561309814453, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.9421, 'grad_norm': 7.222933292388916, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 0.8816, 'grad_norm': 5.209342956542969, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 0.0057, 'grad_norm': 0.4315014183521271, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.4814, 'grad_norm': 2.948025941848755, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 1.0348, 'grad_norm': 6.887415409088135, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.336, 'grad_norm': 3.2957611083984375, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 0.3239, 'grad_norm': 3.3860068321228027, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it]                                               {'loss': 0.4641, 'grad_norm': 4.8699235916137695, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.3762, 'grad_norm': 4.771909713745117, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.1343, 'grad_norm': 2.8106489181518555, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0865, 'grad_norm': 2.535886287689209, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.0947, 'grad_norm': 1.5831232070922852, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it]                                               {'loss': 0.1977, 'grad_norm': 3.754145622253418, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.1925, 'grad_norm': 1.6540333032608032, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1892, 'grad_norm': 2.320359468460083, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.229, 'grad_norm': 4.909890174865723, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.17s/it]                                               {'loss': 0.1443, 'grad_norm': 3.885793924331665, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 1.0938, 'grad_norm': 10.580950736999512, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.5443, 'grad_norm': 15.967012405395508, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.75s/it]                                               {'loss': 0.8639, 'grad_norm': 3.0705666542053223, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.75s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it]                                               {'loss': 0.0699, 'grad_norm': 0.947359025478363, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.90s/it] 88%|████████▊ | 35/40 [01:08<00:09,  1.98s/it]                                               {'loss': 0.1422, 'grad_norm': 2.193260669708252, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  1.98s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.0991, 'grad_norm': 5.541996955871582, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.0934, 'grad_norm': 2.787768602371216, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 0.0741, 'grad_norm': 1.3788771629333496, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]                                               {'loss': 0.1267, 'grad_norm': 0.8043856024742126, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0004, 'grad_norm': 0.04409773275256157, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.4652, 'train_samples_per_second': 7.201, 'train_steps_per_second': 0.51, 'train_loss': 0.8115630355256144, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 2.0441, 'grad_norm': 9.017610549926758, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.2442, 'grad_norm': 11.177022933959961, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 2.8882, 'grad_norm': 12.237018585205078, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 2.1658, 'grad_norm': 18.100143432617188, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 1.1781, 'grad_norm': 11.092264175415039, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it]                                              {'loss': 2.1769, 'grad_norm': 15.29598331451416, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 1.2999, 'grad_norm': 13.441187858581543, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 5.6099, 'grad_norm': 60.319664001464844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.2705, 'grad_norm': 4.782490253448486, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 0.9735, 'grad_norm': 6.546184062957764, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it]                                               {'loss': 0.9553, 'grad_norm': 3.4193661212921143, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.1864, 'grad_norm': 3.694836378097534, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.136, 'grad_norm': 6.0291242599487305, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.1848, 'grad_norm': 4.622758388519287, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.3646, 'grad_norm': 3.560608148574829, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:30<00:37,  1.57s/it]                                               {'loss': 0.6095, 'grad_norm': 24.462675094604492, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.4647, 'grad_norm': 3.8213720321655273, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.987, 'grad_norm': 24.584814071655273, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 1.2046, 'grad_norm': 6.994253635406494, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.03s/it]                                               {'loss': 0.7245, 'grad_norm': 4.689151287078857, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.03s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.11s/it]                                               {'loss': 0.3184, 'grad_norm': 2.2516112327575684, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.1213, 'grad_norm': 1.2127693891525269, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.5856, 'grad_norm': 21.957653045654297, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0216, 'grad_norm': 0.9136509895324707, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 1.0761, 'grad_norm': 88.27899932861328, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.4282, 'grad_norm': 25.860490798950195, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.7938, 'grad_norm': 55.776920318603516, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 1.0456, 'grad_norm': 104.47791290283203, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it]                                               {'loss': 0.1733, 'grad_norm': 7.245502948760986, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.12s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.3723, 'grad_norm': 1.665878415107727, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1077, 'grad_norm': 1.3035988807678223, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 1.9512, 'grad_norm': 63.211021423339844, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.047, 'grad_norm': 1.1227773427963257, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it]                                               {'loss': 0.0285, 'grad_norm': 0.6198957562446594, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.3646, 'grad_norm': 13.624773979187012, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 1.4974, 'grad_norm': 15.17041015625, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.0255, 'grad_norm': 0.6259452700614929, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 0.3835, 'grad_norm': 3.839433193206787, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.6531, 'grad_norm': 9.271515846252441, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0422, 'grad_norm': 1.2551958560943604, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.6258, 'train_samples_per_second': 7.186, 'train_steps_per_second': 0.509, 'train_loss': 0.9426366570405662, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]                                              {'loss': 2.2535, 'grad_norm': 11.437601089477539, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.18s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 3.1461, 'grad_norm': 11.115523338317871, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.1112, 'grad_norm': 12.160828590393066, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.3568, 'grad_norm': 10.203716278076172, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 2.1897, 'grad_norm': 14.451272964477539, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it]                                              {'loss': 1.9294, 'grad_norm': 11.256534576416016, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it]                                              {'loss': 2.6506, 'grad_norm': 13.128161430358887, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 6.518, 'grad_norm': 37.14970779418945, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.9967, 'grad_norm': 13.98829174041748, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it]                                               {'loss': 1.0475, 'grad_norm': 15.26909065246582, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 0.4295, 'grad_norm': 5.264078617095947, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.937, 'grad_norm': 6.864588260650635, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 1.2675, 'grad_norm': 7.615788459777832, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.1438, 'grad_norm': 8.63129997253418, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.76, 'grad_norm': 5.9221577644348145, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:30<00:37,  1.56s/it]                                               {'loss': 0.1769, 'grad_norm': 10.119418144226074, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.5434, 'grad_norm': 5.679713726043701, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.5929, 'grad_norm': 6.923853397369385, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.2859, 'grad_norm': 4.702523708343506, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.07s/it]                                               {'loss': 0.2813, 'grad_norm': 3.652844190597534, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.3719, 'grad_norm': 12.767351150512695, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 1.2055, 'grad_norm': 132.44093322753906, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.7344, 'grad_norm': 88.99616241455078, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0656, 'grad_norm': 18.646615982055664, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.3386, 'grad_norm': 21.87759780883789, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.0949, 'grad_norm': 1.17485511302948, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.2913, 'grad_norm': 4.324941635131836, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.0339, 'grad_norm': 0.6158996224403381, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.2649, 'grad_norm': 6.382653713226318, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.4342, 'grad_norm': 5.499831676483154, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1442, 'grad_norm': 3.2272720336914062, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.1558, 'grad_norm': 8.28952693939209, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.135, 'grad_norm': 3.0706794261932373, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.1029, 'grad_norm': 2.6690971851348877, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.2961, 'grad_norm': 7.866055488586426, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.5739, 'grad_norm': 3.7587082386016846, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.6472, 'grad_norm': 2.661815881729126, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.1941, 'grad_norm': 2.581995964050293, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.367, 'grad_norm': 7.01548433303833, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0232, 'grad_norm': 1.2606016397476196, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 78.7038, 'train_samples_per_second': 7.179, 'train_steps_per_second': 0.508, 'train_loss': 0.9523117943201214, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:50
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 2.3238, 'grad_norm': 9.730250358581543, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]                                              {'loss': 2.9835, 'grad_norm': 12.310826301574707, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.17s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 1.8107, 'grad_norm': 12.23630142211914, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.145, 'grad_norm': 12.861490249633789, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 2.1497, 'grad_norm': 12.116519927978516, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.6099, 'grad_norm': 13.510231018066406, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.0616, 'grad_norm': 10.062896728515625, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.56s/it]                                              {'loss': 0.7131, 'grad_norm': 33.556976318359375, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 0.6338, 'grad_norm': 3.935106039047241, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 0.5907, 'grad_norm': 7.162816524505615, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.4494, 'grad_norm': 4.393702507019043, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.5449, 'grad_norm': 5.726611137390137, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.6381, 'grad_norm': 5.0871477127075195, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.609, 'grad_norm': 4.740655899047852, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.564, 'grad_norm': 6.818385601043701, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.1013, 'grad_norm': 2.562131404876709, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.78s/it]                                               {'loss': 0.0771, 'grad_norm': 1.300087571144104, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.4268, 'grad_norm': 4.3085761070251465, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it]                                               {'loss': 0.2282, 'grad_norm': 2.454880714416504, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.2426, 'grad_norm': 2.5599522590637207, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.36, 'grad_norm': 1.4019019603729248, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.2627, 'grad_norm': 5.334062099456787, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it]                                               {'loss': 0.2716, 'grad_norm': 1.483201026916504, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0192, 'grad_norm': 1.538177728652954, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it]                                               {'loss': 0.1469, 'grad_norm': 0.6116700172424316, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:27,  1.80s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it]                                               {'loss': 0.0487, 'grad_norm': 0.7371871471405029, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it]                                               {'loss': 0.111, 'grad_norm': 1.6345926523208618, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.2098, 'grad_norm': 5.985951900482178, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.0419, 'grad_norm': 0.6989260911941528, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.2511, 'grad_norm': 2.354875326156616, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it]                                               {'loss': 0.3654, 'grad_norm': 2.161179780960083, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.032, 'grad_norm': 0.8388699293136597, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.2585, 'grad_norm': 2.435206174850464, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.195, 'grad_norm': 6.050259590148926, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it]                                               {'loss': 0.1985, 'grad_norm': 6.362894535064697, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.0508, 'grad_norm': 1.0266122817993164, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.2622, 'grad_norm': 1.5317426919937134, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.1057, 'grad_norm': 0.9470627307891846, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.0232, 'grad_norm': 0.42532795667648315, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0376, 'grad_norm': 1.9295867681503296, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.5959, 'train_samples_per_second': 7.098, 'train_steps_per_second': 0.503, 'train_loss': 0.5538722441066056, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:9
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:26,  2.22s/it]                                              {'loss': 1.287, 'grad_norm': 9.846084594726562, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:26,  2.22s/it]  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]                                              {'loss': 2.4295, 'grad_norm': 11.889286041259766, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 1.2089, 'grad_norm': 8.532058715820312, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:20,  2.23s/it]                                              {'loss': 1.7, 'grad_norm': 11.908038139343262, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:20,  2.23s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 1.5889, 'grad_norm': 9.609906196594238, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 3.002, 'grad_norm': 12.961496353149414, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 2.2611, 'grad_norm': 16.99201202392578, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.233, 'grad_norm': 12.3023099899292, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it]                                              {'loss': 0.4721, 'grad_norm': 6.30396842956543, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 0.7293, 'grad_norm': 10.584627151489258, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.1986, 'grad_norm': 3.1288464069366455, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 0.3218, 'grad_norm': 5.47337532043457, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 0.7296, 'grad_norm': 6.166291236877441, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it]                                               {'loss': 1.1622, 'grad_norm': 9.243155479431152, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.2314, 'grad_norm': 2.9821417331695557, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 2.4265, 'grad_norm': 19.40619659423828, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.3266, 'grad_norm': 3.6434311866760254, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.256, 'grad_norm': 4.0105061531066895, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.1559, 'grad_norm': 2.6060643196105957, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.121, 'grad_norm': 2.1832926273345947, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.0674, 'grad_norm': 1.6036986112594604, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it]                                               {'loss': 0.2369, 'grad_norm': 8.775540351867676, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it]                                               {'loss': 0.3369, 'grad_norm': 4.5657548904418945, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.21s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0132, 'grad_norm': 0.7765554189682007, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.078, 'grad_norm': 3.1253671646118164, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it]                                               {'loss': 0.2195, 'grad_norm': 3.9993677139282227, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it]                                               {'loss': 0.2095, 'grad_norm': 4.757603168487549, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it] 70%|███████   | 28/40 [00:56<00:25,  2.13s/it]                                               {'loss': 0.1933, 'grad_norm': 4.205923557281494, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.13s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.18s/it]                                               {'loss': 0.2474, 'grad_norm': 5.760438919067383, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.18s/it] 75%|███████▌  | 30/40 [01:01<00:22,  2.22s/it]                                               {'loss': 0.2807, 'grad_norm': 3.667651891708374, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:22,  2.22s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.0478, 'grad_norm': 1.0206924676895142, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0032, 'grad_norm': 0.18624131381511688, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.1027, 'grad_norm': 2.503162384033203, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it]                                               {'loss': 0.04, 'grad_norm': 1.0326329469680786, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.07s/it]                                               {'loss': 0.2605, 'grad_norm': 5.50788688659668, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.07s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.13s/it]                                               {'loss': 0.2277, 'grad_norm': 128.1441192626953, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.13s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it]                                               {'loss': 0.0922, 'grad_norm': 1.8141822814941406, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it]                                               {'loss': 0.0338, 'grad_norm': 0.6723474264144897, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]                                               {'loss': 0.0299, 'grad_norm': 0.4990004003047943, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.24s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0021, 'grad_norm': 0.13153685629367828, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 80.1768, 'train_samples_per_second': 7.047, 'train_steps_per_second': 0.499, 'train_loss': 0.5891044945456088, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.62s/it]100%|██████████| 40/40 [01:20<00:00,  2.00s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:58,  1.57it/s]  1%|          | 3/471 [00:02<07:01,  1.11it/s]  1%|          | 4/471 [00:03<08:07,  1.04s/it]  1%|          | 5/471 [00:05<08:45,  1.13s/it]  1%|▏         | 6/471 [00:06<09:08,  1.18s/it]  1%|▏         | 7/471 [00:07<09:23,  1.21s/it]  2%|▏         | 8/471 [00:08<09:33,  1.24s/it]  2%|▏         | 9/471 [00:10<09:39,  1.25s/it]  2%|▏         | 10/471 [00:11<09:43,  1.27s/it]  2%|▏         | 11/471 [00:12<09:45,  1.27s/it]  3%|▎         | 12/471 [00:14<09:47,  1.28s/it]  3%|▎         | 13/471 [00:15<09:49,  1.29s/it]  3%|▎         | 14/471 [00:16<09:49,  1.29s/it]  3%|▎         | 15/471 [00:18<09:48,  1.29s/it]  3%|▎         | 16/471 [00:19<09:49,  1.30s/it]  4%|▎         | 17/471 [00:20<09:48,  1.30s/it]  4%|▍         | 18/471 [00:21<09:48,  1.30s/it]  4%|▍         | 19/471 [00:23<09:47,  1.30s/it]  4%|▍         | 20/471 [00:24<09:47,  1.30s/it]  4%|▍         | 21/471 [00:25<09:46,  1.30s/it]  5%|▍         | 22/471 [00:27<09:45,  1.30s/it]  5%|▍         | 23/471 [00:28<09:44,  1.31s/it]  5%|▌         | 24/471 [00:29<09:44,  1.31s/it]  5%|▌         | 25/471 [00:31<09:43,  1.31s/it]  6%|▌         | 26/471 [00:32<09:42,  1.31s/it]  6%|▌         | 27/471 [00:33<09:41,  1.31s/it]  6%|▌         | 28/471 [00:35<09:39,  1.31s/it]  6%|▌         | 29/471 [00:36<09:39,  1.31s/it]  6%|▋         | 30/471 [00:37<09:39,  1.31s/it]  7%|▋         | 31/471 [00:38<09:37,  1.31s/it]  7%|▋         | 32/471 [00:40<09:35,  1.31s/it]  7%|▋         | 33/471 [00:41<09:33,  1.31s/it]  7%|▋         | 34/471 [00:42<09:32,  1.31s/it]  7%|▋         | 35/471 [00:44<09:32,  1.31s/it]  8%|▊         | 36/471 [00:45<09:30,  1.31s/it]  8%|▊         | 37/471 [00:46<09:30,  1.31s/it]  8%|▊         | 38/471 [00:48<09:30,  1.32s/it]  8%|▊         | 39/471 [00:49<09:28,  1.32s/it]  8%|▊         | 40/471 [00:50<09:27,  1.32s/it]  9%|▊         | 41/471 [00:52<09:26,  1.32s/it]  9%|▉         | 42/471 [00:53<09:26,  1.32s/it]  9%|▉         | 43/471 [00:54<09:24,  1.32s/it]  9%|▉         | 44/471 [00:56<09:22,  1.32s/it] 10%|▉         | 45/471 [00:57<09:22,  1.32s/it] 10%|▉         | 46/471 [00:58<09:21,  1.32s/it] 10%|▉         | 47/471 [01:00<09:19,  1.32s/it] 10%|█         | 48/471 [01:01<09:19,  1.32s/it] 10%|█         | 49/471 [01:02<09:18,  1.32s/it] 11%|█         | 50/471 [01:04<09:17,  1.33s/it] 11%|█         | 51/471 [01:05<09:17,  1.33s/it] 11%|█         | 52/471 [01:06<09:15,  1.33s/it] 11%|█▏        | 53/471 [01:08<09:14,  1.33s/it] 11%|█▏        | 54/471 [01:09<09:13,  1.33s/it] 12%|█▏        | 55/471 [01:10<09:12,  1.33s/it] 12%|█▏        | 56/471 [01:11<09:11,  1.33s/it] 12%|█▏        | 57/471 [01:13<09:10,  1.33s/it] 12%|█▏        | 58/471 [01:14<09:08,  1.33s/it] 13%|█▎        | 59/471 [01:15<09:07,  1.33s/it] 13%|█▎        | 60/471 [01:17<09:05,  1.33s/it] 13%|█▎        | 61/471 [01:18<09:04,  1.33s/it] 13%|█▎        | 62/471 [01:19<09:03,  1.33s/it] 13%|█▎        | 63/471 [01:21<09:01,  1.33s/it] 14%|█▎        | 64/471 [01:22<09:00,  1.33s/it] 14%|█▍        | 65/471 [01:23<08:59,  1.33s/it] 14%|█▍        | 66/471 [01:25<08:58,  1.33s/it] 14%|█▍        | 67/471 [01:26<08:57,  1.33s/it] 14%|█▍        | 68/471 [01:27<08:55,  1.33s/it] 15%|█▍        | 69/471 [01:29<08:54,  1.33s/it] 15%|█▍        | 70/471 [01:30<08:54,  1.33s/it] 15%|█▌        | 71/471 [01:31<08:53,  1.33s/it] 15%|█▌        | 72/471 [01:33<08:52,  1.33s/it] 15%|█▌        | 73/471 [01:34<08:50,  1.33s/it] 16%|█▌        | 74/471 [01:35<08:48,  1.33s/it] 16%|█▌        | 75/471 [01:37<08:47,  1.33s/it] 16%|█▌        | 76/471 [01:38<08:45,  1.33s/it] 16%|█▋        | 77/471 [01:39<08:44,  1.33s/it] 17%|█▋        | 78/471 [01:41<08:43,  1.33s/it] 17%|█▋        | 79/471 [01:42<08:42,  1.33s/it] 17%|█▋        | 80/471 [01:43<08:41,  1.33s/it] 17%|█▋        | 81/471 [01:45<08:39,  1.33s/it] 17%|█▋        | 82/471 [01:46<08:38,  1.33s/it] 18%|█▊        | 83/471 [01:47<08:36,  1.33s/it] 18%|█▊        | 84/471 [01:49<08:35,  1.33s/it] 18%|█▊        | 85/471 [01:50<08:34,  1.33s/it] 18%|█▊        | 86/471 [01:51<08:33,  1.33s/it] 18%|█▊        | 87/471 [01:53<08:31,  1.33s/it] 19%|█▊        | 88/471 [01:54<08:29,  1.33s/it] 19%|█▉        | 89/471 [01:55<08:28,  1.33s/it] 19%|█▉        | 90/471 [01:57<08:28,  1.33s/it] 19%|█▉        | 91/471 [01:58<08:26,  1.33s/it] 20%|█▉        | 92/471 [01:59<08:25,  1.33s/it] 20%|█▉        | 93/471 [02:01<08:24,  1.33s/it] 20%|█▉        | 94/471 [02:02<08:22,  1.33s/it] 20%|██        | 95/471 [02:03<08:21,  1.33s/it] 20%|██        | 96/471 [02:05<08:20,  1.33s/it] 21%|██        | 97/471 [02:06<08:19,  1.34s/it] 21%|██        | 98/471 [02:07<08:18,  1.34s/it] 21%|██        | 99/471 [02:09<08:16,  1.34s/it] 21%|██        | 100/471 [02:10<08:15,  1.34s/it] 21%|██▏       | 101/471 [02:11<08:14,  1.34s/it] 22%|██▏       | 102/471 [02:13<08:13,  1.34s/it] 22%|██▏       | 103/471 [02:14<08:12,  1.34s/it] 22%|██▏       | 104/471 [02:15<08:11,  1.34s/it] 22%|██▏       | 105/471 [02:17<08:10,  1.34s/it] 23%|██▎       | 106/471 [02:18<08:08,  1.34s/it] 23%|██▎       | 107/471 [02:19<08:07,  1.34s/it] 23%|██▎       | 108/471 [02:21<08:05,  1.34s/it] 23%|██▎       | 109/471 [02:22<08:03,  1.34s/it] 23%|██▎       | 110/471 [02:23<08:01,  1.33s/it] 24%|██▎       | 111/471 [02:25<08:00,  1.34s/it] 24%|██▍       | 112/471 [02:26<07:59,  1.34s/it] 24%|██▍       | 113/471 [02:27<07:57,  1.33s/it] 24%|██▍       | 114/471 [02:29<07:57,  1.34s/it] 24%|██▍       | 115/471 [02:30<07:55,  1.34s/it] 25%|██▍       | 116/471 [02:32<07:54,  1.34s/it] 25%|██▍       | 117/471 [02:33<07:53,  1.34s/it] 25%|██▌       | 118/471 [02:34<07:52,  1.34s/it] 25%|██▌       | 119/471 [02:36<07:50,  1.34s/it] 25%|██▌       | 120/471 [02:37<07:50,  1.34s/it] 26%|██▌       | 121/471 [02:38<07:48,  1.34s/it] 26%|██▌       | 122/471 [02:40<07:47,  1.34s/it] 26%|██▌       | 123/471 [02:41<07:46,  1.34s/it] 26%|██▋       | 124/471 [02:42<07:45,  1.34s/it] 27%|██▋       | 125/471 [02:44<07:43,  1.34s/it] 27%|██▋       | 126/471 [02:45<07:42,  1.34s/it] 27%|██▋       | 127/471 [02:46<07:41,  1.34s/it] 27%|██▋       | 128/471 [02:48<07:39,  1.34s/it] 27%|██▋       | 129/471 [02:49<07:37,  1.34s/it] 28%|██▊       | 130/471 [02:50<07:35,  1.34s/it] 28%|██▊       | 131/471 [02:52<07:34,  1.34s/it] 28%|██▊       | 132/471 [02:53<07:33,  1.34s/it] 28%|██▊       | 133/471 [02:54<07:31,  1.34s/it] 28%|██▊       | 134/471 [02:56<07:31,  1.34s/it] 29%|██▊       | 135/471 [02:57<07:30,  1.34s/it] 29%|██▉       | 136/471 [02:58<07:28,  1.34s/it] 29%|██▉       | 137/471 [03:00<07:27,  1.34s/it] 29%|██▉       | 138/471 [03:01<07:25,  1.34s/it] 30%|██▉       | 139/471 [03:02<07:24,  1.34s/it] 30%|██▉       | 140/471 [03:04<07:23,  1.34s/it] 30%|██▉       | 141/471 [03:05<07:21,  1.34s/it] 30%|███       | 142/471 [03:06<07:19,  1.34s/it] 30%|███       | 143/471 [03:08<07:17,  1.34s/it] 31%|███       | 144/471 [03:09<07:17,  1.34s/it] 31%|███       | 145/471 [03:10<07:15,  1.34s/it] 31%|███       | 146/471 [03:12<07:14,  1.34s/it] 31%|███       | 147/471 [03:13<07:13,  1.34s/it] 31%|███▏      | 148/471 [03:14<07:11,  1.34s/it] 32%|███▏      | 149/471 [03:16<07:11,  1.34s/it] 32%|███▏      | 150/471 [03:17<07:10,  1.34s/it] 32%|███▏      | 151/471 [03:18<07:08,  1.34s/it] 32%|███▏      | 152/471 [03:20<07:06,  1.34s/it] 32%|███▏      | 153/471 [03:21<07:05,  1.34s/it] 33%|███▎      | 154/471 [03:22<07:03,  1.34s/it] 33%|███▎      | 155/471 [03:24<07:02,  1.34s/it] 33%|███▎      | 156/471 [03:25<07:01,  1.34s/it] 33%|███▎      | 157/471 [03:26<07:00,  1.34s/it] 34%|███▎      | 158/471 [03:28<06:57,  1.34s/it] 34%|███▍      | 159/471 [03:29<06:56,  1.33s/it] 34%|███▍      | 160/471 [03:30<06:55,  1.34s/it] 34%|███▍      | 161/471 [03:32<06:54,  1.34s/it] 34%|███▍      | 162/471 [03:33<06:53,  1.34s/it] 35%|███▍      | 163/471 [03:34<06:52,  1.34s/it] 35%|███▍      | 164/471 [03:36<06:50,  1.34s/it] 35%|███▌      | 165/471 [03:37<06:49,  1.34s/it] 35%|███▌      | 166/471 [03:38<06:48,  1.34s/it] 35%|███▌      | 167/471 [03:40<06:47,  1.34s/it] 36%|███▌      | 168/471 [03:41<06:45,  1.34s/it] 36%|███▌      | 169/471 [03:42<06:44,  1.34s/it] 36%|███▌      | 170/471 [03:44<06:43,  1.34s/it] 36%|███▋      | 171/471 [03:45<06:41,  1.34s/it] 37%|███▋      | 172/471 [03:46<06:40,  1.34s/it] 37%|███▋      | 173/471 [03:48<06:39,  1.34s/it] 37%|███▋      | 174/471 [03:49<06:38,  1.34s/it] 37%|███▋      | 175/471 [03:50<06:37,  1.34s/it] 37%|███▋      | 176/471 [03:52<06:35,  1.34s/it] 38%|███▊      | 177/471 [03:53<06:34,  1.34s/it] 38%|███▊      | 178/471 [03:55<06:33,  1.34s/it] 38%|███▊      | 179/471 [03:56<06:32,  1.34s/it] 38%|███▊      | 180/471 [03:57<06:30,  1.34s/it] 38%|███▊      | 181/471 [03:59<06:29,  1.34s/it] 39%|███▊      | 182/471 [04:00<06:28,  1.34s/it] 39%|███▉      | 183/471 [04:01<06:27,  1.34s/it] 39%|███▉      | 184/471 [04:03<06:25,  1.34s/it] 39%|███▉      | 185/471 [04:04<06:24,  1.34s/it] 39%|███▉      | 186/471 [04:05<06:23,  1.35s/it] 40%|███▉      | 187/471 [04:07<06:22,  1.35s/it] 40%|███▉      | 188/471 [04:08<06:21,  1.35s/it] 40%|████      | 189/471 [04:09<06:19,  1.35s/it] 40%|████      | 190/471 [04:11<06:18,  1.35s/it] 41%|████      | 191/471 [04:12<06:17,  1.35s/it] 41%|████      | 192/471 [04:13<06:16,  1.35s/it] 41%|████      | 193/471 [04:15<06:14,  1.35s/it] 41%|████      | 194/471 [04:16<06:13,  1.35s/it] 41%|████▏     | 195/471 [04:17<06:12,  1.35s/it] 42%|████▏     | 196/471 [04:19<06:11,  1.35s/it] 42%|████▏     | 197/471 [04:20<06:08,  1.35s/it] 42%|████▏     | 198/471 [04:21<06:07,  1.35s/it] 42%|████▏     | 199/471 [04:23<06:06,  1.35s/it] 42%|████▏     | 200/471 [04:24<06:05,  1.35s/it] 43%|████▎     | 201/471 [04:25<06:03,  1.35s/it] 43%|████▎     | 202/471 [04:27<06:02,  1.35s/it] 43%|████▎     | 203/471 [04:28<06:01,  1.35s/it] 43%|████▎     | 204/471 [04:30<05:59,  1.35s/it] 44%|████▎     | 205/471 [04:31<05:57,  1.35s/it] 44%|████▎     | 206/471 [04:32<05:56,  1.34s/it] 44%|████▍     | 207/471 [04:34<05:55,  1.35s/it] 44%|████▍     | 208/471 [04:35<05:53,  1.34s/it] 44%|████▍     | 209/471 [04:36<05:51,  1.34s/it] 45%|████▍     | 210/471 [04:38<05:50,  1.34s/it] 45%|████▍     | 211/471 [04:39<05:49,  1.34s/it] 45%|████▌     | 212/471 [04:40<05:48,  1.34s/it] 45%|████▌     | 213/471 [04:42<05:46,  1.34s/it] 45%|████▌     | 214/471 [04:43<05:45,  1.34s/it] 46%|████▌     | 215/471 [04:44<05:43,  1.34s/it] 46%|████▌     | 216/471 [04:46<05:42,  1.34s/it] 46%|████▌     | 217/471 [04:47<05:41,  1.35s/it] 46%|████▋     | 218/471 [04:48<05:40,  1.35s/it] 46%|████▋     | 219/471 [04:50<05:39,  1.35s/it] 47%|████▋     | 220/471 [04:51<05:37,  1.35s/it] 47%|████▋     | 221/471 [04:52<05:36,  1.35s/it] 47%|████▋     | 222/471 [04:54<05:34,  1.34s/it] 47%|████▋     | 223/471 [04:55<05:33,  1.34s/it] 48%|████▊     | 224/471 [04:56<05:32,  1.35s/it] 48%|████▊     | 225/471 [04:58<05:30,  1.35s/it] 48%|████▊     | 226/471 [04:59<05:29,  1.35s/it] 48%|████▊     | 227/471 [05:00<05:28,  1.35s/it] 48%|████▊     | 228/471 [05:02<05:26,  1.34s/it] 49%|████▊     | 229/471 [05:03<05:25,  1.34s/it] 49%|████▉     | 230/471 [05:04<05:24,  1.35s/it] 49%|████▉     | 231/471 [05:06<05:22,  1.34s/it] 49%|████▉     | 232/471 [05:07<05:20,  1.34s/it] 49%|████▉     | 233/471 [05:09<05:19,  1.34s/it] 50%|████▉     | 234/471 [05:10<05:18,  1.34s/it] 50%|████▉     | 235/471 [05:11<05:17,  1.35s/it] 50%|█████     | 236/471 [05:13<05:15,  1.34s/it] 50%|█████     | 237/471 [05:14<05:14,  1.34s/it] 51%|█████     | 238/471 [05:15<05:12,  1.34s/it] 51%|█████     | 239/471 [05:17<05:11,  1.34s/it] 51%|█████     | 240/471 [05:18<05:10,  1.34s/it] 51%|█████     | 241/471 [05:19<05:09,  1.34s/it] 51%|█████▏    | 242/471 [05:21<05:07,  1.34s/it] 52%|█████▏    | 243/471 [05:22<05:06,  1.34s/it] 52%|█████▏    | 244/471 [05:23<05:04,  1.34s/it] 52%|█████▏    | 245/471 [05:25<05:03,  1.34s/it] 52%|█████▏    | 246/471 [05:26<05:01,  1.34s/it] 52%|█████▏    | 247/471 [05:27<05:00,  1.34s/it] 53%|█████▎    | 248/471 [05:29<04:59,  1.34s/it] 53%|█████▎    | 249/471 [05:30<04:57,  1.34s/it] 53%|█████▎    | 250/471 [05:31<04:56,  1.34s/it] 53%|█████▎    | 251/471 [05:33<04:54,  1.34s/it] 54%|█████▎    | 252/471 [05:34<04:53,  1.34s/it] 54%|█████▎    | 253/471 [05:35<04:52,  1.34s/it] 54%|█████▍    | 254/471 [05:37<04:51,  1.34s/it] 54%|█████▍    | 255/471 [05:38<04:49,  1.34s/it] 54%|█████▍    | 256/471 [05:39<04:48,  1.34s/it] 55%|█████▍    | 257/471 [05:41<04:47,  1.34s/it] 55%|█████▍    | 258/471 [05:42<04:45,  1.34s/it] 55%|█████▍    | 259/471 [05:43<04:44,  1.34s/it] 55%|█████▌    | 260/471 [05:45<04:43,  1.34s/it] 55%|█████▌    | 261/471 [05:46<04:41,  1.34s/it] 56%|█████▌    | 262/471 [05:47<04:39,  1.34s/it] 56%|█████▌    | 263/471 [05:49<04:38,  1.34s/it] 56%|█████▌    | 264/471 [05:50<04:36,  1.34s/it] 56%|█████▋    | 265/471 [05:51<04:35,  1.34s/it] 56%|█████▋    | 266/471 [05:53<04:34,  1.34s/it] 57%|█████▋    | 267/471 [05:54<04:33,  1.34s/it] 57%|█████▋    | 268/471 [05:55<04:32,  1.34s/it] 57%|█████▋    | 269/471 [05:57<04:30,  1.34s/it] 57%|█████▋    | 270/471 [05:58<04:29,  1.34s/it] 58%|█████▊    | 271/471 [05:59<04:27,  1.34s/it] 58%|█████▊    | 272/471 [06:01<04:26,  1.34s/it] 58%|█████▊    | 273/471 [06:02<04:25,  1.34s/it] 58%|█████▊    | 274/471 [06:04<04:23,  1.34s/it] 58%|█████▊    | 275/471 [06:05<04:22,  1.34s/it] 59%|█████▊    | 276/471 [06:06<04:21,  1.34s/it] 59%|█████▉    | 277/471 [06:08<04:19,  1.34s/it] 59%|█████▉    | 278/471 [06:09<04:18,  1.34s/it] 59%|█████▉    | 279/471 [06:10<04:17,  1.34s/it] 59%|█████▉    | 280/471 [06:12<04:15,  1.34s/it] 60%|█████▉    | 281/471 [06:13<04:14,  1.34s/it] 60%|█████▉    | 282/471 [06:14<04:13,  1.34s/it] 60%|██████    | 283/471 [06:16<04:11,  1.34s/it] 60%|██████    | 284/471 [06:17<04:10,  1.34s/it] 61%|██████    | 285/471 [06:18<04:09,  1.34s/it] 61%|██████    | 286/471 [06:20<04:07,  1.34s/it] 61%|██████    | 287/471 [06:21<04:06,  1.34s/it] 61%|██████    | 288/471 [06:22<04:05,  1.34s/it] 61%|██████▏   | 289/471 [06:24<04:03,  1.34s/it] 62%|██████▏   | 290/471 [06:25<04:02,  1.34s/it] 62%|██████▏   | 291/471 [06:26<04:01,  1.34s/it] 62%|██████▏   | 292/471 [06:28<03:59,  1.34s/it] 62%|██████▏   | 293/471 [06:29<03:57,  1.34s/it] 62%|██████▏   | 294/471 [06:30<03:56,  1.34s/it] 63%|██████▎   | 295/471 [06:32<03:55,  1.34s/it] 63%|██████▎   | 296/471 [06:33<03:53,  1.34s/it] 63%|██████▎   | 297/471 [06:34<03:52,  1.34s/it] 63%|██████▎   | 298/471 [06:36<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:37<03:50,  1.34s/it] 64%|██████▎   | 300/471 [06:38<03:48,  1.34s/it] 64%|██████▍   | 301/471 [06:40<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:41<03:45,  1.34s/it] 64%|██████▍   | 303/471 [06:42<03:44,  1.34s/it] 65%|██████▍   | 304/471 [06:44<03:42,  1.34s/it] 65%|██████▍   | 305/471 [06:45<03:41,  1.34s/it] 65%|██████▍   | 306/471 [06:46<03:40,  1.34s/it] 65%|██████▌   | 307/471 [06:48<03:39,  1.34s/it] 65%|██████▌   | 308/471 [06:49<03:38,  1.34s/it] 66%|██████▌   | 309/471 [06:50<03:36,  1.34s/it] 66%|██████▌   | 310/471 [06:52<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:53<03:34,  1.34s/it] 66%|██████▌   | 312/471 [06:54<03:32,  1.34s/it] 66%|██████▋   | 313/471 [06:56<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:57<03:29,  1.34s/it] 67%|██████▋   | 315/471 [06:58<03:28,  1.34s/it] 67%|██████▋   | 316/471 [07:00<03:27,  1.34s/it] 67%|██████▋   | 317/471 [07:01<03:25,  1.34s/it] 68%|██████▊   | 318/471 [07:02<03:24,  1.34s/it] 68%|██████▊   | 319/471 [07:04<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:05<03:22,  1.34s/it] 68%|██████▊   | 321/471 [07:06<03:20,  1.34s/it] 68%|██████▊   | 322/471 [07:08<03:19,  1.34s/it] 69%|██████▊   | 323/471 [07:09<03:18,  1.34s/it] 69%|██████▉   | 324/471 [07:10<03:17,  1.34s/it] 69%|██████▉   | 325/471 [07:12<03:15,  1.34s/it] 69%|██████▉   | 326/471 [07:13<03:14,  1.34s/it] 69%|██████▉   | 327/471 [07:14<03:12,  1.34s/it] 70%|██████▉   | 328/471 [07:16<03:11,  1.34s/it] 70%|██████▉   | 329/471 [07:17<03:10,  1.34s/it] 70%|███████   | 330/471 [07:18<03:08,  1.34s/it] 70%|███████   | 331/471 [07:20<03:07,  1.34s/it] 70%|███████   | 332/471 [07:21<03:06,  1.34s/it] 71%|███████   | 333/471 [07:22<03:04,  1.34s/it] 71%|███████   | 334/471 [07:24<03:03,  1.34s/it] 71%|███████   | 335/471 [07:25<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:27<03:00,  1.34s/it] 72%|███████▏  | 337/471 [07:28<02:59,  1.34s/it] 72%|███████▏  | 338/471 [07:29<02:58,  1.34s/it] 72%|███████▏  | 339/471 [07:31<02:57,  1.34s/it] 72%|███████▏  | 340/471 [07:32<02:55,  1.34s/it] 72%|███████▏  | 341/471 [07:33<02:54,  1.34s/it] 73%|███████▎  | 342/471 [07:35<02:52,  1.34s/it] 73%|███████▎  | 343/471 [07:36<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:37<02:50,  1.34s/it] 73%|███████▎  | 345/471 [07:39<02:48,  1.34s/it] 73%|███████▎  | 346/471 [07:40<02:47,  1.34s/it] 74%|███████▎  | 347/471 [07:41<02:46,  1.34s/it] 74%|███████▍  | 348/471 [07:43<02:44,  1.34s/it] 74%|███████▍  | 349/471 [07:44<02:43,  1.34s/it] 74%|███████▍  | 350/471 [07:45<02:42,  1.34s/it] 75%|███████▍  | 351/471 [07:47<02:40,  1.34s/it] 75%|███████▍  | 352/471 [07:48<02:39,  1.34s/it] 75%|███████▍  | 353/471 [07:49<02:38,  1.34s/it] 75%|███████▌  | 354/471 [07:51<02:36,  1.34s/it] 75%|███████▌  | 355/471 [07:52<02:35,  1.34s/it] 76%|███████▌  | 356/471 [07:53<02:34,  1.34s/it] 76%|███████▌  | 357/471 [07:55<02:32,  1.34s/it] 76%|███████▌  | 358/471 [07:56<02:31,  1.34s/it] 76%|███████▌  | 359/471 [07:57<02:30,  1.34s/it] 76%|███████▋  | 360/471 [07:59<02:28,  1.34s/it] 77%|███████▋  | 361/471 [08:00<02:27,  1.34s/it] 77%|███████▋  | 362/471 [08:01<02:25,  1.34s/it] 77%|███████▋  | 363/471 [08:03<02:24,  1.34s/it] 77%|███████▋  | 364/471 [08:04<02:23,  1.34s/it] 77%|███████▋  | 365/471 [08:05<02:22,  1.34s/it] 78%|███████▊  | 366/471 [08:07<02:20,  1.34s/it] 78%|███████▊  | 367/471 [08:08<02:19,  1.34s/it] 78%|███████▊  | 368/471 [08:09<02:17,  1.34s/it] 78%|███████▊  | 369/471 [08:11<02:16,  1.34s/it] 79%|███████▊  | 370/471 [08:12<02:15,  1.34s/it] 79%|███████▉  | 371/471 [08:13<02:13,  1.34s/it] 79%|███████▉  | 372/471 [08:15<02:12,  1.34s/it] 79%|███████▉  | 373/471 [08:16<02:11,  1.34s/it] 79%|███████▉  | 374/471 [08:17<02:09,  1.34s/it] 80%|███████▉  | 375/471 [08:19<02:08,  1.34s/it] 80%|███████▉  | 376/471 [08:20<02:07,  1.34s/it] 80%|████████  | 377/471 [08:21<02:05,  1.34s/it] 80%|████████  | 378/471 [08:23<02:04,  1.34s/it] 80%|████████  | 379/471 [08:24<02:03,  1.34s/it] 81%|████████  | 380/471 [08:25<02:01,  1.34s/it] 81%|████████  | 381/471 [08:27<02:00,  1.34s/it] 81%|████████  | 382/471 [08:28<01:59,  1.34s/it] 81%|████████▏ | 383/471 [08:29<01:58,  1.34s/it] 82%|████████▏ | 384/471 [08:31<01:56,  1.34s/it] 82%|████████▏ | 385/471 [08:32<01:55,  1.34s/it] 82%|████████▏ | 386/471 [08:33<01:54,  1.34s/it] 82%|████████▏ | 387/471 [08:35<01:52,  1.34s/it] 82%|████████▏ | 388/471 [08:36<01:51,  1.34s/it] 83%|████████▎ | 389/471 [08:38<01:50,  1.34s/it] 83%|████████▎ | 390/471 [08:39<01:48,  1.34s/it] 83%|████████▎ | 391/471 [08:40<01:47,  1.34s/it] 83%|████████▎ | 392/471 [08:42<01:46,  1.34s/it] 83%|████████▎ | 393/471 [08:43<01:44,  1.34s/it] 84%|████████▎ | 394/471 [08:44<01:43,  1.34s/it] 84%|████████▍ | 395/471 [08:46<01:41,  1.34s/it] 84%|████████▍ | 396/471 [08:47<01:40,  1.34s/it] 84%|████████▍ | 397/471 [08:48<01:39,  1.34s/it] 85%|████████▍ | 398/471 [08:50<01:37,  1.34s/it] 85%|████████▍ | 399/471 [08:51<01:36,  1.34s/it] 85%|████████▍ | 400/471 [08:52<01:35,  1.34s/it] 85%|████████▌ | 401/471 [08:54<01:33,  1.34s/it] 85%|████████▌ | 402/471 [08:55<01:32,  1.34s/it] 86%|████████▌ | 403/471 [08:56<01:30,  1.34s/it] 86%|████████▌ | 404/471 [08:58<01:29,  1.34s/it] 86%|████████▌ | 405/471 [08:59<01:28,  1.34s/it] 86%|████████▌ | 406/471 [09:00<01:27,  1.34s/it] 86%|████████▋ | 407/471 [09:02<01:25,  1.34s/it] 87%|████████▋ | 408/471 [09:03<01:24,  1.34s/it] 87%|████████▋ | 409/471 [09:04<01:23,  1.34s/it] 87%|████████▋ | 410/471 [09:06<01:21,  1.34s/it] 87%|████████▋ | 411/471 [09:07<01:20,  1.34s/it] 87%|████████▋ | 412/471 [09:08<01:18,  1.34s/it] 88%|████████▊ | 413/471 [09:10<01:17,  1.34s/it] 88%|████████▊ | 414/471 [09:11<01:16,  1.34s/it] 88%|████████▊ | 415/471 [09:12<01:14,  1.34s/it] 88%|████████▊ | 416/471 [09:14<01:13,  1.34s/it] 89%|████████▊ | 417/471 [09:15<01:12,  1.34s/it] 89%|████████▊ | 418/471 [09:16<01:11,  1.34s/it] 89%|████████▉ | 419/471 [09:18<01:09,  1.34s/it] 89%|████████▉ | 420/471 [09:19<01:08,  1.34s/it] 89%|████████▉ | 421/471 [09:20<01:07,  1.34s/it] 90%|████████▉ | 422/471 [09:22<01:05,  1.34s/it] 90%|████████▉ | 423/471 [09:23<01:04,  1.34s/it] 90%|█████████ | 424/471 [09:24<01:02,  1.34s/it] 90%|█████████ | 425/471 [09:26<01:01,  1.34s/it] 90%|█████████ | 426/471 [09:27<01:00,  1.34s/it] 91%|█████████ | 427/471 [09:28<00:58,  1.34s/it] 91%|█████████ | 428/471 [09:30<00:57,  1.34s/it] 91%|█████████ | 429/471 [09:31<00:56,  1.34s/it] 91%|█████████▏| 430/471 [09:32<00:54,  1.34s/it] 92%|█████████▏| 431/471 [09:34<00:53,  1.34s/it] 92%|█████████▏| 432/471 [09:35<00:52,  1.34s/it] 92%|█████████▏| 433/471 [09:36<00:50,  1.34s/it] 92%|█████████▏| 434/471 [09:38<00:49,  1.34s/it] 92%|█████████▏| 435/471 [09:39<00:48,  1.34s/it] 93%|█████████▎| 436/471 [09:40<00:46,  1.34s/it] 93%|█████████▎| 437/471 [09:42<00:45,  1.34s/it] 93%|█████████▎| 438/471 [09:43<00:44,  1.34s/it] 93%|█████████▎| 439/471 [09:45<00:42,  1.34s/it] 93%|█████████▎| 440/471 [09:46<00:41,  1.34s/it] 94%|█████████▎| 441/471 [09:47<00:40,  1.34s/it] 94%|█████████▍| 442/471 [09:49<00:38,  1.34s/it] 94%|█████████▍| 443/471 [09:50<00:37,  1.34s/it] 94%|█████████▍| 444/471 [09:51<00:36,  1.34s/it] 94%|█████████▍| 445/471 [09:53<00:34,  1.34s/it] 95%|█████████▍| 446/471 [09:54<00:33,  1.34s/it] 95%|█████████▍| 447/471 [09:55<00:32,  1.34s/it] 95%|█████████▌| 448/471 [09:57<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:58<00:29,  1.33s/it] 96%|█████████▌| 450/471 [09:59<00:28,  1.33s/it] 96%|█████████▌| 451/471 [10:01<00:26,  1.33s/it] 96%|█████████▌| 452/471 [10:02<00:25,  1.33s/it] 96%|█████████▌| 453/471 [10:03<00:24,  1.33s/it] 96%|█████████▋| 454/471 [10:05<00:22,  1.33s/it] 97%|█████████▋| 455/471 [10:06<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:07<00:20,  1.33s/it] 97%|█████████▋| 457/471 [10:09<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:10<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:11<00:15,  1.33s/it] 98%|█████████▊| 460/471 [10:13<00:14,  1.33s/it] 98%|█████████▊| 461/471 [10:14<00:13,  1.33s/it] 98%|█████████▊| 462/471 [10:15<00:11,  1.33s/it] 98%|█████████▊| 463/471 [10:17<00:10,  1.33s/it] 99%|█████████▊| 464/471 [10:18<00:09,  1.33s/it] 99%|█████████▊| 465/471 [10:19<00:07,  1.33s/it] 99%|█████████▉| 466/471 [10:21<00:06,  1.33s/it] 99%|█████████▉| 467/471 [10:22<00:05,  1.33s/it] 99%|█████████▉| 468/471 [10:23<00:04,  1.33s/it]100%|█████████▉| 469/471 [10:25<00:02,  1.33s/it]100%|█████████▉| 470/471 [10:26<00:01,  1.33s/it]100%|██████████| 471/471 [10:27<00:00,  1.22s/it]100%|██████████| 471/471 [10:27<00:00,  1.33s/it]
{'eval_loss': 2.5499908924102783, 'eval_model_preparation_time': 0.0194, 'eval_acc': 0.34851301115241634, 'eval_runtime': 628.5851, 'eval_samples_per_second': 11.982, 'eval_steps_per_second': 0.749}
ROUND:17
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:28,  2.27s/it]                                              {'loss': 3.182, 'grad_norm': 15.242159843444824, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:28,  2.27s/it]  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]                                              {'loss': 1.5943, 'grad_norm': 12.565651893615723, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]  8%|▊         | 3/40 [00:06<01:22,  2.22s/it]                                              {'loss': 3.043, 'grad_norm': 14.985737800598145, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.22s/it] 10%|█         | 4/40 [00:08<01:19,  2.21s/it]                                              {'loss': 2.5278, 'grad_norm': 14.341174125671387, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:11<01:16,  2.20s/it]                                              {'loss': 2.8273, 'grad_norm': 15.919035911560059, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:16,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.21s/it]                                              {'loss': 1.5267, 'grad_norm': 13.122232437133789, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 1.0175, 'grad_norm': 13.194584846496582, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.1617, 'grad_norm': 14.530709266662598, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it]                                              {'loss': 0.2787, 'grad_norm': 3.4379844665527344, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it]                                               {'loss': 0.6101, 'grad_norm': 10.020286560058594, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.6968, 'grad_norm': 5.95736026763916, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.445, 'grad_norm': 5.253494739532471, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 0.7342, 'grad_norm': 9.373597145080566, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it]                                               {'loss': 0.8305, 'grad_norm': 8.566344261169434, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.3052, 'grad_norm': 3.6962716579437256, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.0004, 'grad_norm': 0.03007095865905285, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it]                                               {'loss': 0.1508, 'grad_norm': 3.482504367828369, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it]                                               {'loss': 0.2829, 'grad_norm': 4.974004745483398, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.2413, 'grad_norm': 2.457615613937378, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.1844, 'grad_norm': 4.471371173858643, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.4817, 'grad_norm': 2.8400700092315674, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 0.065, 'grad_norm': 1.015608310699463, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.3471, 'grad_norm': 5.849142074584961, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0036, 'grad_norm': 0.21072418987751007, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.2752, 'grad_norm': 3.805938243865967, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.3682, 'grad_norm': 4.50778341293335, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.00s/it]                                               {'loss': 0.0289, 'grad_norm': 0.9165032505989075, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.00s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.0323, 'grad_norm': 0.6154861450195312, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.1017, 'grad_norm': 3.6914844512939453, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0528, 'grad_norm': 1.7654457092285156, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.0831, 'grad_norm': 1.5465689897537231, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0256, 'grad_norm': 1.6427843570709229, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0248, 'grad_norm': 0.3910699188709259, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.2508, 'grad_norm': 1.7508370876312256, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.0124, 'grad_norm': 0.31789425015449524, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.0262, 'grad_norm': 0.7898299694061279, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0158, 'grad_norm': 0.8446741104125977, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.18s/it]                                               {'loss': 0.5804, 'grad_norm': 5.262808322906494, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.0431, 'grad_norm': 1.4497753381729126, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0812, 'grad_norm': 9.632914543151855, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.803, 'train_samples_per_second': 7.08, 'train_steps_per_second': 0.501, 'train_loss': 0.5885089483665069, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:27,  2.26s/it]                                              {'loss': 2.9199, 'grad_norm': 12.278450965881348, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:27,  2.26s/it]  5%|▌         | 2/40 [00:04<01:23,  2.21s/it]                                              {'loss': 1.2681, 'grad_norm': 9.13467788696289, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:23,  2.21s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 1.477, 'grad_norm': 8.197711944580078, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:18,  2.19s/it]                                              {'loss': 1.7799, 'grad_norm': 14.530056953430176, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.19s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it]                                              {'loss': 3.387, 'grad_norm': 22.422426223754883, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.5085, 'grad_norm': 19.916746139526367, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 2.0645, 'grad_norm': 12.320487976074219, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.033, 'grad_norm': 1.613394856452942, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.7674, 'grad_norm': 14.19272232055664, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it]                                               {'loss': 1.1041, 'grad_norm': 6.718780994415283, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 1.3137, 'grad_norm': 8.62453842163086, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.7096, 'grad_norm': 16.139589309692383, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.5676, 'grad_norm': 4.92142915725708, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.6433, 'grad_norm': 7.226437091827393, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.6505, 'grad_norm': 5.217083930969238, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 2.9414, 'grad_norm': 42.36004638671875, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:42,  1.86s/it]                                               {'loss': 0.3679, 'grad_norm': 2.933032512664795, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:42,  1.86s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.95s/it]                                               {'loss': 0.435, 'grad_norm': 5.731716156005859, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.95s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it]                                               {'loss': 0.4606, 'grad_norm': 1.7297794818878174, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.03s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.4072, 'grad_norm': 6.9347100257873535, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it]                                               {'loss': 0.5062, 'grad_norm': 11.848610877990723, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.14s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it]                                               {'loss': 0.3165, 'grad_norm': 4.456681251525879, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.2008, 'grad_norm': 2.733635187149048, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.1697, 'grad_norm': 8.76065731048584, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.4133, 'grad_norm': 2.6084864139556885, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.3351, 'grad_norm': 2.940077066421509, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.1859, 'grad_norm': 3.388324737548828, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.0638, 'grad_norm': 1.3570679426193237, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.2766, 'grad_norm': 1.5305759906768799, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0731, 'grad_norm': 1.5991120338439941, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it]                                               {'loss': 0.1807, 'grad_norm': 4.158156871795654, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.0065, 'grad_norm': 0.6458484530448914, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0988, 'grad_norm': 2.0742626190185547, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0493, 'grad_norm': 0.9537078142166138, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.02s/it]                                               {'loss': 0.3343, 'grad_norm': 1.4812661409378052, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.0821, 'grad_norm': 0.8464797139167786, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.086, 'grad_norm': 3.4271597862243652, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1577, 'grad_norm': 1.199959635734558, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]                                               {'loss': 0.2886, 'grad_norm': 2.10830020904541, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0166, 'grad_norm': 1.0666908025741577, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.5108, 'train_samples_per_second': 7.106, 'train_steps_per_second': 0.503, 'train_loss': 0.7411900425795466, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:96
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:32,  2.37s/it]                                              {'loss': 2.3782, 'grad_norm': 11.512895584106445, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:32,  2.37s/it]  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]                                              {'loss': 1.9417, 'grad_norm': 10.212360382080078, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 1.4432, 'grad_norm': 14.727434158325195, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:19,  2.22s/it]                                              {'loss': 1.1, 'grad_norm': 13.562015533447266, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 2.1917, 'grad_norm': 12.905203819274902, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.1405, 'grad_norm': 14.093094825744629, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.311, 'grad_norm': 13.156412124633789, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.3488, 'grad_norm': 17.11931037902832, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.8014, 'grad_norm': 28.418346405029297, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.88s/it]                                               {'loss': 1.2607, 'grad_norm': 12.425335884094238, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 0.8271, 'grad_norm': 5.436425685882568, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.3857, 'grad_norm': 7.177957057952881, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 0.2621, 'grad_norm': 1.9504159688949585, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 0.4267, 'grad_norm': 7.95320987701416, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it]                                               {'loss': 0.3485, 'grad_norm': 5.529917240142822, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.2179, 'grad_norm': 8.902942657470703, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.3431, 'grad_norm': 3.6621947288513184, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.3293, 'grad_norm': 3.5678465366363525, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.00s/it]                                               {'loss': 0.1588, 'grad_norm': 1.9287277460098267, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.2094, 'grad_norm': 2.044271945953369, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.4759, 'grad_norm': 6.246135711669922, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it]                                               {'loss': 0.5455, 'grad_norm': 6.8366007804870605, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.2706, 'grad_norm': 5.237199306488037, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.58s/it]                                               {'loss': 0.0023, 'grad_norm': 0.2198849320411682, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.1302, 'grad_norm': 1.6653258800506592, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.1196, 'grad_norm': 1.6637624502182007, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.1199, 'grad_norm': 2.0183699131011963, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.051, 'grad_norm': 0.8693346977233887, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.2534, 'grad_norm': 3.036716938018799, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.1292, 'grad_norm': 1.6861025094985962, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1393, 'grad_norm': 2.399789333343506, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 1.0774, 'grad_norm': 37.141597747802734, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0186, 'grad_norm': 0.6437365412712097, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.0369, 'grad_norm': 0.4552336633205414, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0389, 'grad_norm': 0.5937779545783997, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0694, 'grad_norm': 4.31690788269043, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it]                                               {'loss': 0.045, 'grad_norm': 0.8705188035964966, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.0334, 'grad_norm': 0.5289618968963623, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0324, 'grad_norm': 1.449972152709961, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.0154, 'grad_norm': 0.49950242042541504, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 79.1685, 'train_samples_per_second': 7.137, 'train_steps_per_second': 0.505, 'train_loss': 0.5507506154070143, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:16
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]                                              {'loss': 1.827, 'grad_norm': 10.869218826293945, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:25,  2.20s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 2.3984, 'grad_norm': 11.737720489501953, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 2.0867, 'grad_norm': 17.103679656982422, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 2.3272, 'grad_norm': 20.353866577148438, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 1.2564, 'grad_norm': 10.192424774169922, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it]                                              {'loss': 1.5127, 'grad_norm': 13.086941719055176, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:13,  2.15s/it] 18%|█▊        | 7/40 [00:15<01:10,  2.14s/it]                                              {'loss': 1.633, 'grad_norm': 9.95968246459961, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:10,  2.14s/it] 20%|██        | 8/40 [00:15<00:48,  1.52s/it]                                              {'loss': 0.8262, 'grad_norm': 44.62339782714844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.52s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it]                                              {'loss': 0.7366, 'grad_norm': 7.678997993469238, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.72s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.0047, 'grad_norm': 9.41662311553955, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it]                                               {'loss': 0.4712, 'grad_norm': 9.23188304901123, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.4977, 'grad_norm': 6.718189239501953, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 0.2409, 'grad_norm': 3.2860007286071777, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 0.416, 'grad_norm': 5.684157371520996, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it]                                               {'loss': 1.0073, 'grad_norm': 8.33323860168457, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.14s/it] 40%|████      | 16/40 [00:30<00:37,  1.55s/it]                                               {'loss': 4.6875, 'grad_norm': 89.00508880615234, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it]                                               {'loss': 0.0927, 'grad_norm': 0.8847697377204895, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.2623, 'grad_norm': 2.4497411251068115, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.0396, 'grad_norm': 0.6829400062561035, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.4038, 'grad_norm': 3.9445176124572754, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it]                                               {'loss': 0.4636, 'grad_norm': 2.7371418476104736, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.2316, 'grad_norm': 1.3169623613357544, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.6963, 'grad_norm': 7.5068864822387695, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.0148, 'grad_norm': 2.9410400390625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.1089, 'grad_norm': 2.3503596782684326, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.1193, 'grad_norm': 2.4987213611602783, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.2636, 'grad_norm': 1.710780143737793, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.1443, 'grad_norm': 1.022315263748169, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.0236, 'grad_norm': 0.32520002126693726, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it]                                               {'loss': 0.3072, 'grad_norm': 2.2765612602233887, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it]                                               {'loss': 0.2181, 'grad_norm': 0.7017310857772827, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.16s/it] 80%|████████  | 32/40 [01:02<00:12,  1.56s/it]                                               {'loss': 0.0002, 'grad_norm': 0.011689441278576851, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.56s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.0834, 'grad_norm': 2.7192628383636475, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0199, 'grad_norm': 1.5772377252578735, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:09,  1.99s/it]                                               {'loss': 0.2702, 'grad_norm': 3.8965494632720947, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  1.99s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it]                                               {'loss': 0.0073, 'grad_norm': 0.19671359658241272, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.06s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it]                                               {'loss': 0.0628, 'grad_norm': 1.7719917297363281, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.9541, 'grad_norm': 12.907123565673828, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.1921, 'grad_norm': 2.611927032470703, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.0003, 'grad_norm': 0.01868504285812378, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 78.0737, 'train_samples_per_second': 7.237, 'train_steps_per_second': 0.512, 'train_loss': 0.6977341290676122, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.57s/it]100%|██████████| 40/40 [01:18<00:00,  1.95s/it]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:36,  2.46s/it]                                              {'loss': 1.7499, 'grad_norm': 8.852239608764648, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:36,  2.46s/it]  5%|▌         | 2/40 [00:04<01:27,  2.30s/it]                                              {'loss': 1.9392, 'grad_norm': 11.378928184509277, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:27,  2.30s/it]  8%|▊         | 3/40 [00:06<01:22,  2.22s/it]                                              {'loss': 2.5501, 'grad_norm': 12.25644588470459, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.22s/it] 10%|█         | 4/40 [00:08<01:20,  2.22s/it]                                              {'loss': 2.16, 'grad_norm': 19.851417541503906, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:20,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 0.8131, 'grad_norm': 8.07243537902832, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.3928, 'grad_norm': 23.72785186767578, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 1.2921, 'grad_norm': 11.758757591247559, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 6.2603, 'grad_norm': 61.288612365722656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.2921, 'grad_norm': 6.010723114013672, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.88s/it]                                               {'loss': 0.7602, 'grad_norm': 4.225403785705566, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:56,  1.96s/it]                                               {'loss': 1.0697, 'grad_norm': 4.056035995483398, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:56,  1.96s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.1037, 'grad_norm': 2.1519992351531982, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.9642, 'grad_norm': 8.869465827941895, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.2675, 'grad_norm': 6.27461576461792, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.3695, 'grad_norm': 5.821920871734619, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.6718, 'grad_norm': 30.798357009887695, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.5669, 'grad_norm': 2.4707887172698975, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.8394, 'grad_norm': 12.373297691345215, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 1.1788, 'grad_norm': 10.261157035827637, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:40<00:41,  2.05s/it]                                               {'loss': 0.5996, 'grad_norm': 15.495768547058105, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.4597, 'grad_norm': 31.636247634887695, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.4488, 'grad_norm': 10.335326194763184, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it]                                               {'loss': 0.7201, 'grad_norm': 29.60611343383789, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0014, 'grad_norm': 0.11697734892368317, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.4476, 'grad_norm': 26.58162498474121, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it]                                               {'loss': 0.268, 'grad_norm': 5.894098281860352, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:27,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.5424, 'grad_norm': 4.097843647003174, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.08s/it]                                               {'loss': 0.7183, 'grad_norm': 24.79081153869629, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.8964, 'grad_norm': 13.341606140136719, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.3833, 'grad_norm': 8.349884986877441, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1987, 'grad_norm': 3.263396978378296, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.8188, 'grad_norm': 48.2057991027832, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.1146, 'grad_norm': 5.882213115692139, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.6742, 'grad_norm': 14.99549388885498, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.4494, 'grad_norm': 16.677776336669922, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it]                                               {'loss': 0.8432, 'grad_norm': 3.9067904949188232, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.092, 'grad_norm': 24.5320987701416, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.3166, 'grad_norm': 2.5737619400024414, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.5385, 'grad_norm': 3.165421485900879, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0534, 'grad_norm': 1.8695863485336304, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.3371, 'train_samples_per_second': 7.122, 'train_steps_per_second': 0.504, 'train_loss': 0.8956617898191326, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:24
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:31,  2.36s/it]                                              {'loss': 2.3727, 'grad_norm': 10.776122093200684, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:31,  2.36s/it]  5%|▌         | 2/40 [00:04<01:26,  2.27s/it]                                              {'loss': 2.9397, 'grad_norm': 13.3966703414917, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:26,  2.27s/it]  8%|▊         | 3/40 [00:06<01:22,  2.23s/it]                                              {'loss': 2.2858, 'grad_norm': 14.031109809875488, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.23s/it] 10%|█         | 4/40 [00:08<01:20,  2.23s/it]                                              {'loss': 1.816, 'grad_norm': 11.944342613220215, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:20,  2.23s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 3.6936, 'grad_norm': 21.553621292114258, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.0985, 'grad_norm': 13.915783882141113, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 2.6872, 'grad_norm': 13.375818252563477, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 9.4338, 'grad_norm': 36.222450256347656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.9761, 'grad_norm': 8.279373168945312, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it]                                               {'loss': 1.3891, 'grad_norm': 7.382961273193359, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.884, 'grad_norm': 13.148088455200195, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.7386, 'grad_norm': 8.197004318237305, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 1.0102, 'grad_norm': 13.150166511535645, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 1.457, 'grad_norm': 7.752353668212891, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.664, 'grad_norm': 7.119128704071045, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0728, 'grad_norm': 3.6326098442077637, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.3952, 'grad_norm': 3.0407791137695312, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.4795, 'grad_norm': 3.2977511882781982, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it]                                               {'loss': 0.2633, 'grad_norm': 2.293189764022827, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.3368, 'grad_norm': 2.642469882965088, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.5828, 'grad_norm': 3.159959554672241, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.4364, 'grad_norm': 6.264403820037842, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.392, 'grad_norm': 2.9426584243774414, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.6781, 'grad_norm': 18.03130531311035, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.2596, 'grad_norm': 3.7350590229034424, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.311, 'grad_norm': 2.5694925785064697, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.2468, 'grad_norm': 3.126427173614502, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.0688, 'grad_norm': 0.9234679937362671, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1526, 'grad_norm': 1.5318785905838013, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1501, 'grad_norm': 2.7673943042755127, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0783, 'grad_norm': 1.1076607704162598, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.0895, 'grad_norm': 2.0356485843658447, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0644, 'grad_norm': 1.1369132995605469, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.0573, 'grad_norm': 1.7052417993545532, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.019, 'grad_norm': 0.24568888545036316, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it]                                               {'loss': 0.3402, 'grad_norm': 3.856398820877075, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it]                                               {'loss': 0.1011, 'grad_norm': 4.1951212882995605, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.157, 'grad_norm': 2.287235975265503, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.1306, 'grad_norm': 1.1383051872253418, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'loss': 0.0241, 'grad_norm': 1.16971755027771, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'train_runtime': 79.2926, 'train_samples_per_second': 7.126, 'train_steps_per_second': 0.504, 'train_loss': 1.0333392727188766, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:53
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:40,  2.57s/it]                                              {'loss': 2.4197, 'grad_norm': 9.131282806396484, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:40,  2.57s/it]  5%|▌         | 2/40 [00:04<01:27,  2.31s/it]                                              {'loss': 1.2341, 'grad_norm': 13.298545837402344, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:27,  2.31s/it]  8%|▊         | 3/40 [00:06<01:22,  2.24s/it]                                              {'loss': 3.3216, 'grad_norm': 15.30051040649414, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.24s/it] 10%|█         | 4/40 [00:09<01:20,  2.22s/it]                                              {'loss': 3.1943, 'grad_norm': 16.13062858581543, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:20,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 1.3167, 'grad_norm': 11.321889877319336, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 5.6897, 'grad_norm': 45.65042495727539, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 2.4568, 'grad_norm': 18.096420288085938, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.5765, 'grad_norm': 43.663795471191406, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.6503, 'grad_norm': 17.290685653686523, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it]                                               {'loss': 0.639, 'grad_norm': 8.498942375183105, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 1.0347, 'grad_norm': 8.461713790893555, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.4989, 'grad_norm': 8.967071533203125, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.4218, 'grad_norm': 8.319334030151367, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:29<00:55,  2.13s/it]                                               {'loss': 1.1307, 'grad_norm': 11.881241798400879, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it]                                               {'loss': 1.0903, 'grad_norm': 9.332332611083984, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.2244, 'grad_norm': 8.390466690063477, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.4919, 'grad_norm': 7.590288162231445, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.7175, 'grad_norm': 7.746816158294678, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it]                                               {'loss': 0.4899, 'grad_norm': 6.1572265625, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.5125, 'grad_norm': 4.723540782928467, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.09s/it]                                               {'loss': 0.5082, 'grad_norm': 9.299721717834473, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.4779, 'grad_norm': 5.0169525146484375, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.7024, 'grad_norm': 14.416383743286133, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:47<00:24,  1.56s/it]                                               {'loss': 3.75, 'grad_norm': 33.2573356628418, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.75s/it]                                               {'loss': 0.2576, 'grad_norm': 2.646085500717163, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it]                                               {'loss': 0.2297, 'grad_norm': 2.236910581588745, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.1522, 'grad_norm': 2.25236439704895, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.2578, 'grad_norm': 2.1692166328430176, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.11s/it]                                               {'loss': 0.0923, 'grad_norm': 1.2271560430526733, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.2342, 'grad_norm': 4.210758686065674, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 1.3792, 'grad_norm': 7.508955478668213, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0006, 'grad_norm': 0.038565609604120255, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.1664, 'grad_norm': 3.0912225246429443, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.5221, 'grad_norm': 15.001609802246094, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.157, 'grad_norm': 4.898819923400879, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.2659, 'grad_norm': 11.550358772277832, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it]                                               {'loss': 0.2264, 'grad_norm': 16.929443359375, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.15s/it]                                               {'loss': 0.3636, 'grad_norm': 5.185921669006348, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.179, 'grad_norm': 4.093789100646973, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0126, 'grad_norm': 0.5408754348754883, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.966, 'train_samples_per_second': 7.155, 'train_steps_per_second': 0.507, 'train_loss': 1.0511603665116127, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:97
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:27,  2.25s/it]                                              {'loss': 2.6429, 'grad_norm': 11.359195709228516, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:27,  2.25s/it]  5%|▌         | 2/40 [00:04<01:24,  2.21s/it]                                              {'loss': 1.4377, 'grad_norm': 9.588223457336426, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.21s/it]  8%|▊         | 3/40 [00:06<01:20,  2.17s/it]                                              {'loss': 2.1012, 'grad_norm': 19.395580291748047, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.17s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.947, 'grad_norm': 14.158462524414062, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it]                                              {'loss': 1.7882, 'grad_norm': 10.884467124938965, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it]                                              {'loss': 2.4375, 'grad_norm': 13.78139591217041, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.18s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 2.0814, 'grad_norm': 13.905943870544434, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 2.2959, 'grad_norm': 51.89109802246094, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.357, 'grad_norm': 5.980700492858887, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.1053, 'grad_norm': 7.80674934387207, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.4642, 'grad_norm': 2.9443600177764893, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.6403, 'grad_norm': 4.332196235656738, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.0513, 'grad_norm': 8.050765037536621, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.5112, 'grad_norm': 5.426955699920654, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.5421, 'grad_norm': 5.5176615715026855, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.5393, 'grad_norm': 9.802738189697266, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.1437, 'grad_norm': 2.836632013320923, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.1106, 'grad_norm': 2.3922367095947266, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it]                                               {'loss': 0.5656, 'grad_norm': 5.023776531219482, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.2881, 'grad_norm': 5.16876745223999, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.3051, 'grad_norm': 2.4818739891052246, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.3177, 'grad_norm': 3.7843267917633057, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it]                                               {'loss': 0.1164, 'grad_norm': 1.7447961568832397, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 1.3495, 'grad_norm': 13.768220901489258, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.1911, 'grad_norm': 4.348903179168701, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.0979, 'grad_norm': 1.6838018894195557, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it]                                               {'loss': 0.2239, 'grad_norm': 0.7292299270629883, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.2764, 'grad_norm': 1.5914901494979858, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.2682, 'grad_norm': 4.608546733856201, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.0291, 'grad_norm': 0.34662532806396484, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.1788, 'grad_norm': 0.7454475164413452, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.299, 'grad_norm': 12.709808349609375, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it]                                               {'loss': 0.0475, 'grad_norm': 0.8788972496986389, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0646, 'grad_norm': 1.3521989583969116, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it]                                               {'loss': 0.0319, 'grad_norm': 0.6855475306510925, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.3707, 'grad_norm': 4.939281463623047, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it]                                               {'loss': 0.0949, 'grad_norm': 1.1519029140472412, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.17s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.0235, 'grad_norm': 0.5143887996673584, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.3297, 'grad_norm': 2.618980884552002, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0561, 'grad_norm': 3.7886545658111572, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.2864, 'train_samples_per_second': 7.126, 'train_steps_per_second': 0.504, 'train_loss': 0.6930542070418596, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:41
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]                                              {'loss': 3.1938, 'grad_norm': 11.357542991638184, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:23,  2.13s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 1.4917, 'grad_norm': 10.482664108276367, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 1.9895, 'grad_norm': 10.833874702453613, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 3.0137, 'grad_norm': 20.462366104125977, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.6727, 'grad_norm': 9.791549682617188, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.6519, 'grad_norm': 10.001199722290039, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 0.9136, 'grad_norm': 7.425558090209961, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 2.5981, 'grad_norm': 67.85908508300781, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 0.318, 'grad_norm': 7.657681941986084, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it]                                               {'loss': 0.3912, 'grad_norm': 6.615200996398926, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 1.0736, 'grad_norm': 5.181393623352051, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.05s/it]                                               {'loss': 0.7386, 'grad_norm': 5.152497291564941, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.05s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.9123, 'grad_norm': 6.41001033782959, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.464, 'grad_norm': 4.336939334869385, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it]                                               {'loss': 0.1692, 'grad_norm': 2.259934902191162, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0096, 'grad_norm': 0.864976167678833, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.1822, 'grad_norm': 1.3896112442016602, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it]                                               {'loss': 0.3444, 'grad_norm': 2.9267868995666504, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.5766, 'grad_norm': 2.060122489929199, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.1322, 'grad_norm': 2.9191298484802246, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.08s/it]                                               {'loss': 0.6384, 'grad_norm': 6.539124011993408, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.08s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.1365, 'grad_norm': 2.3712475299835205, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.1721, 'grad_norm': 2.3502416610717773, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.1661, 'grad_norm': 12.113672256469727, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.4429, 'grad_norm': 1.7299374341964722, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.0388, 'grad_norm': 1.6628354787826538, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it]                                               {'loss': 0.3688, 'grad_norm': 0.9663115739822388, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.00s/it] 70%|███████   | 28/40 [00:55<00:25,  2.09s/it]                                               {'loss': 0.0189, 'grad_norm': 0.4462721049785614, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.3049, 'grad_norm': 8.536377906799316, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0606, 'grad_norm': 1.2590991258621216, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0674, 'grad_norm': 1.3142069578170776, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0008, 'grad_norm': 0.042336173355579376, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it]                                               {'loss': 0.0124, 'grad_norm': 0.2343229502439499, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.79s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0208, 'grad_norm': 0.4484488070011139, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it]                                               {'loss': 0.0093, 'grad_norm': 0.23543784022331238, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.48, 'grad_norm': 1.1185683012008667, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0321, 'grad_norm': 0.6875870227813721, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.2359, 'grad_norm': 1.7858812808990479, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.3108, 'grad_norm': 2.49997878074646, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0009, 'grad_norm': 0.0587722584605217, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.9288, 'train_samples_per_second': 7.158, 'train_steps_per_second': 0.507, 'train_loss': 0.6338883600590635, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:47
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:30,  2.32s/it]                                              {'loss': 2.8196, 'grad_norm': 11.23741340637207, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:30,  2.32s/it]  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]                                              {'loss': 1.6099, 'grad_norm': 11.298290252685547, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]  8%|▊         | 3/40 [00:06<01:21,  2.21s/it]                                              {'loss': 2.0388, 'grad_norm': 12.114415168762207, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.21s/it] 10%|█         | 4/40 [00:08<01:19,  2.19s/it]                                              {'loss': 1.1544, 'grad_norm': 10.57456111907959, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.19s/it] 12%|█▎        | 5/40 [00:11<01:16,  2.19s/it]                                              {'loss': 3.4112, 'grad_norm': 15.847908020019531, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 2.391, 'grad_norm': 13.50145435333252, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.2374, 'grad_norm': 11.42371940612793, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.857, 'grad_norm': 29.916540145874023, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.6234, 'grad_norm': 6.857776641845703, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.90s/it]                                               {'loss': 0.9267, 'grad_norm': 11.373540878295898, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.8305, 'grad_norm': 6.977294921875, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.7372, 'grad_norm': 9.203449249267578, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.6109, 'grad_norm': 5.205627918243408, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.7587, 'grad_norm': 6.095073699951172, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.3837, 'grad_norm': 6.3885040283203125, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.0077, 'grad_norm': 0.5922214984893799, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:42,  1.84s/it]                                               {'loss': 0.4961, 'grad_norm': 10.180191040039062, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:42,  1.84s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.95s/it]                                               {'loss': 0.1703, 'grad_norm': 4.169806957244873, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.95s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.05s/it]                                               {'loss': 0.172, 'grad_norm': 2.6212692260742188, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.05s/it] 50%|█████     | 20/40 [00:40<00:42,  2.11s/it]                                               {'loss': 0.0983, 'grad_norm': 2.5040855407714844, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it]                                               {'loss': 0.0756, 'grad_norm': 1.001975417137146, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.15s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it]                                               {'loss': 0.1606, 'grad_norm': 3.0671236515045166, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.2046, 'grad_norm': 2.1021883487701416, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.1007, 'grad_norm': 6.54086446762085, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.0641, 'grad_norm': 2.378579616546631, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.0954, 'grad_norm': 2.342214345932007, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.0367, 'grad_norm': 0.6111435294151306, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.1844, 'grad_norm': 5.7935791015625, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.0607, 'grad_norm': 1.8570969104766846, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it]                                               {'loss': 0.13, 'grad_norm': 3.152111291885376, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it]                                               {'loss': 0.0261, 'grad_norm': 0.40683481097221375, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.1292, 'grad_norm': 3.873103618621826, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0337, 'grad_norm': 0.6734890341758728, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0778, 'grad_norm': 2.4719371795654297, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.1009, 'grad_norm': 4.63134765625, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it]                                               {'loss': 0.0963, 'grad_norm': 2.967557907104492, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.12s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0492, 'grad_norm': 0.9037002921104431, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it]                                               {'loss': 0.0506, 'grad_norm': 1.2898480892181396, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]                                               {'loss': 0.0385, 'grad_norm': 0.9484770894050598, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.23s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.0501, 'grad_norm': 2.253929615020752, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.8719, 'train_samples_per_second': 7.074, 'train_steps_per_second': 0.501, 'train_loss': 0.5774947715573944, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:59,  1.56it/s]  1%|          | 3/471 [00:02<07:04,  1.10it/s]  1%|          | 4/471 [00:03<08:10,  1.05s/it]  1%|          | 5/471 [00:05<08:48,  1.13s/it]  1%|▏         | 6/471 [00:06<09:11,  1.19s/it]  1%|▏         | 7/471 [00:07<09:26,  1.22s/it]  2%|▏         | 8/471 [00:09<09:36,  1.25s/it]  2%|▏         | 9/471 [00:10<09:42,  1.26s/it]  2%|▏         | 10/471 [00:11<09:46,  1.27s/it]  2%|▏         | 11/471 [00:12<09:48,  1.28s/it]  3%|▎         | 12/471 [00:14<09:50,  1.29s/it]  3%|▎         | 13/471 [00:15<09:52,  1.29s/it]  3%|▎         | 14/471 [00:16<09:52,  1.30s/it]  3%|▎         | 15/471 [00:18<09:52,  1.30s/it]  3%|▎         | 16/471 [00:19<09:52,  1.30s/it]  4%|▎         | 17/471 [00:20<09:52,  1.30s/it]  4%|▍         | 18/471 [00:22<09:52,  1.31s/it]  4%|▍         | 19/471 [00:23<09:51,  1.31s/it]  4%|▍         | 20/471 [00:24<09:51,  1.31s/it]  4%|▍         | 21/471 [00:26<09:50,  1.31s/it]  5%|▍         | 22/471 [00:27<09:50,  1.31s/it]  5%|▍         | 23/471 [00:28<09:49,  1.32s/it]  5%|▌         | 24/471 [00:29<09:48,  1.32s/it]  5%|▌         | 25/471 [00:31<09:47,  1.32s/it]  6%|▌         | 26/471 [00:32<09:46,  1.32s/it]  6%|▌         | 27/471 [00:33<09:45,  1.32s/it]  6%|▌         | 28/471 [00:35<09:44,  1.32s/it]  6%|▌         | 29/471 [00:36<09:42,  1.32s/it]  6%|▋         | 30/471 [00:37<09:42,  1.32s/it]  7%|▋         | 31/471 [00:39<09:40,  1.32s/it]  7%|▋         | 32/471 [00:40<09:39,  1.32s/it]  7%|▋         | 33/471 [00:41<09:36,  1.32s/it]  7%|▋         | 34/471 [00:43<09:36,  1.32s/it]  7%|▋         | 35/471 [00:44<09:36,  1.32s/it]  8%|▊         | 36/471 [00:45<09:34,  1.32s/it]  8%|▊         | 37/471 [00:47<09:34,  1.32s/it]  8%|▊         | 38/471 [00:48<09:33,  1.33s/it]  8%|▊         | 39/471 [00:49<09:32,  1.32s/it]  8%|▊         | 40/471 [00:51<09:31,  1.33s/it]  9%|▊         | 41/471 [00:52<09:30,  1.33s/it]  9%|▉         | 42/471 [00:53<09:29,  1.33s/it]  9%|▉         | 43/471 [00:55<09:27,  1.33s/it]  9%|▉         | 44/471 [00:56<09:26,  1.33s/it] 10%|▉         | 45/471 [00:57<09:26,  1.33s/it] 10%|▉         | 46/471 [00:59<09:24,  1.33s/it] 10%|▉         | 47/471 [01:00<09:23,  1.33s/it] 10%|█         | 48/471 [01:01<09:22,  1.33s/it] 10%|█         | 49/471 [01:03<09:21,  1.33s/it] 11%|█         | 50/471 [01:04<09:20,  1.33s/it] 11%|█         | 51/471 [01:05<09:19,  1.33s/it] 11%|█         | 52/471 [01:07<09:18,  1.33s/it] 11%|█▏        | 53/471 [01:08<09:17,  1.33s/it] 11%|█▏        | 54/471 [01:09<09:16,  1.33s/it] 12%|█▏        | 55/471 [01:11<09:15,  1.33s/it] 12%|█▏        | 56/471 [01:12<09:14,  1.34s/it] 12%|█▏        | 57/471 [01:13<09:12,  1.34s/it] 12%|█▏        | 58/471 [01:15<09:11,  1.34s/it] 13%|█▎        | 59/471 [01:16<09:10,  1.34s/it] 13%|█▎        | 60/471 [01:17<09:09,  1.34s/it] 13%|█▎        | 61/471 [01:19<09:07,  1.34s/it] 13%|█▎        | 62/471 [01:20<09:06,  1.34s/it] 13%|█▎        | 63/471 [01:21<09:04,  1.33s/it] 14%|█▎        | 64/471 [01:23<09:03,  1.34s/it] 14%|█▍        | 65/471 [01:24<09:02,  1.34s/it] 14%|█▍        | 66/471 [01:25<09:00,  1.34s/it] 14%|█▍        | 67/471 [01:27<08:59,  1.34s/it] 14%|█▍        | 68/471 [01:28<08:57,  1.33s/it] 15%|█▍        | 69/471 [01:29<08:56,  1.33s/it] 15%|█▍        | 70/471 [01:31<08:56,  1.34s/it] 15%|█▌        | 71/471 [01:32<08:54,  1.34s/it] 15%|█▌        | 72/471 [01:33<08:53,  1.34s/it] 15%|█▌        | 73/471 [01:35<08:51,  1.34s/it] 16%|█▌        | 74/471 [01:36<08:49,  1.33s/it] 16%|█▌        | 75/471 [01:37<08:48,  1.34s/it] 16%|█▌        | 76/471 [01:39<08:47,  1.33s/it] 16%|█▋        | 77/471 [01:40<08:46,  1.34s/it] 17%|█▋        | 78/471 [01:41<08:44,  1.34s/it] 17%|█▋        | 79/471 [01:43<08:44,  1.34s/it] 17%|█▋        | 80/471 [01:44<08:42,  1.34s/it] 17%|█▋        | 81/471 [01:45<08:41,  1.34s/it] 17%|█▋        | 82/471 [01:47<08:39,  1.34s/it] 18%|█▊        | 83/471 [01:48<08:38,  1.34s/it] 18%|█▊        | 84/471 [01:49<08:36,  1.34s/it] 18%|█▊        | 85/471 [01:51<08:35,  1.34s/it] 18%|█▊        | 86/471 [01:52<08:34,  1.34s/it] 18%|█▊        | 87/471 [01:53<08:32,  1.33s/it] 19%|█▊        | 88/471 [01:55<08:30,  1.33s/it] 19%|█▉        | 89/471 [01:56<08:29,  1.33s/it] 19%|█▉        | 90/471 [01:57<08:28,  1.33s/it] 19%|█▉        | 91/471 [01:59<08:26,  1.33s/it] 20%|█▉        | 92/471 [02:00<08:25,  1.33s/it] 20%|█▉        | 93/471 [02:01<08:24,  1.33s/it] 20%|█▉        | 94/471 [02:03<08:23,  1.33s/it] 20%|██        | 95/471 [02:04<08:22,  1.34s/it] 20%|██        | 96/471 [02:05<08:20,  1.33s/it] 21%|██        | 97/471 [02:07<08:20,  1.34s/it] 21%|██        | 98/471 [02:08<08:18,  1.34s/it] 21%|██        | 99/471 [02:09<08:16,  1.34s/it] 21%|██        | 100/471 [02:11<08:15,  1.34s/it] 21%|██▏       | 101/471 [02:12<08:13,  1.33s/it] 22%|██▏       | 102/471 [02:13<08:12,  1.34s/it] 22%|██▏       | 103/471 [02:15<08:11,  1.34s/it] 22%|██▏       | 104/471 [02:16<08:11,  1.34s/it] 22%|██▏       | 105/471 [02:17<08:10,  1.34s/it] 23%|██▎       | 106/471 [02:19<08:07,  1.34s/it] 23%|██▎       | 107/471 [02:20<08:05,  1.34s/it] 23%|██▎       | 108/471 [02:21<08:04,  1.33s/it] 23%|██▎       | 109/471 [02:23<08:01,  1.33s/it] 23%|██▎       | 110/471 [02:24<07:59,  1.33s/it] 24%|██▎       | 111/471 [02:25<07:59,  1.33s/it] 24%|██▍       | 112/471 [02:27<07:58,  1.33s/it] 24%|██▍       | 113/471 [02:28<07:57,  1.33s/it] 24%|██▍       | 114/471 [02:29<07:56,  1.34s/it] 24%|██▍       | 115/471 [02:31<07:55,  1.34s/it] 25%|██▍       | 116/471 [02:32<07:54,  1.34s/it] 25%|██▍       | 117/471 [02:33<07:52,  1.34s/it] 25%|██▌       | 118/471 [02:35<07:51,  1.34s/it] 25%|██▌       | 119/471 [02:36<07:50,  1.34s/it] 25%|██▌       | 120/471 [02:37<07:49,  1.34s/it] 26%|██▌       | 121/471 [02:39<07:48,  1.34s/it] 26%|██▌       | 122/471 [02:40<07:46,  1.34s/it] 26%|██▌       | 123/471 [02:41<07:45,  1.34s/it] 26%|██▋       | 124/471 [02:43<07:44,  1.34s/it] 27%|██▋       | 125/471 [02:44<07:43,  1.34s/it] 27%|██▋       | 126/471 [02:45<07:42,  1.34s/it] 27%|██▋       | 127/471 [02:47<07:40,  1.34s/it] 27%|██▋       | 128/471 [02:48<07:38,  1.34s/it] 27%|██▋       | 129/471 [02:49<07:37,  1.34s/it] 28%|██▊       | 130/471 [02:51<07:35,  1.34s/it] 28%|██▊       | 131/471 [02:52<07:34,  1.34s/it] 28%|██▊       | 132/471 [02:53<07:33,  1.34s/it] 28%|██▊       | 133/471 [02:55<07:32,  1.34s/it] 28%|██▊       | 134/471 [02:56<07:31,  1.34s/it] 29%|██▊       | 135/471 [02:57<07:30,  1.34s/it] 29%|██▉       | 136/471 [02:59<07:28,  1.34s/it] 29%|██▉       | 137/471 [03:00<07:27,  1.34s/it] 29%|██▉       | 138/471 [03:01<07:26,  1.34s/it] 30%|██▉       | 139/471 [03:03<07:24,  1.34s/it] 30%|██▉       | 140/471 [03:04<07:23,  1.34s/it] 30%|██▉       | 141/471 [03:06<07:21,  1.34s/it] 30%|███       | 142/471 [03:07<07:20,  1.34s/it] 30%|███       | 143/471 [03:08<07:18,  1.34s/it] 31%|███       | 144/471 [03:10<07:18,  1.34s/it] 31%|███       | 145/471 [03:11<07:16,  1.34s/it] 31%|███       | 146/471 [03:12<07:15,  1.34s/it] 31%|███       | 147/471 [03:14<07:13,  1.34s/it] 31%|███▏      | 148/471 [03:15<07:12,  1.34s/it] 32%|███▏      | 149/471 [03:16<07:12,  1.34s/it] 32%|███▏      | 150/471 [03:18<07:10,  1.34s/it] 32%|███▏      | 151/471 [03:19<07:09,  1.34s/it] 32%|███▏      | 152/471 [03:20<07:07,  1.34s/it] 32%|███▏      | 153/471 [03:22<07:06,  1.34s/it] 33%|███▎      | 154/471 [03:23<07:04,  1.34s/it] 33%|███▎      | 155/471 [03:24<07:03,  1.34s/it] 33%|███▎      | 156/471 [03:26<07:01,  1.34s/it] 33%|███▎      | 157/471 [03:27<07:00,  1.34s/it] 34%|███▎      | 158/471 [03:28<06:58,  1.34s/it] 34%|███▍      | 159/471 [03:30<06:57,  1.34s/it] 34%|███▍      | 160/471 [03:31<06:56,  1.34s/it] 34%|███▍      | 161/471 [03:32<06:54,  1.34s/it] 34%|███▍      | 162/471 [03:34<06:53,  1.34s/it] 35%|███▍      | 163/471 [03:35<06:52,  1.34s/it] 35%|███▍      | 164/471 [03:36<06:50,  1.34s/it] 35%|███▌      | 165/471 [03:38<06:49,  1.34s/it] 35%|███▌      | 166/471 [03:39<06:48,  1.34s/it] 35%|███▌      | 167/471 [03:40<06:46,  1.34s/it] 36%|███▌      | 168/471 [03:42<06:45,  1.34s/it] 36%|███▌      | 169/471 [03:43<06:44,  1.34s/it] 36%|███▌      | 170/471 [03:44<06:43,  1.34s/it] 36%|███▋      | 171/471 [03:46<06:41,  1.34s/it] 37%|███▋      | 172/471 [03:47<06:39,  1.34s/it] 37%|███▋      | 173/471 [03:48<06:38,  1.34s/it] 37%|███▋      | 174/471 [03:50<06:37,  1.34s/it] 37%|███▋      | 175/471 [03:51<06:36,  1.34s/it] 37%|███▋      | 176/471 [03:52<06:34,  1.34s/it] 38%|███▊      | 177/471 [03:54<06:33,  1.34s/it] 38%|███▊      | 178/471 [03:55<06:31,  1.34s/it] 38%|███▊      | 179/471 [03:56<06:30,  1.34s/it] 38%|███▊      | 180/471 [03:58<06:29,  1.34s/it] 38%|███▊      | 181/471 [03:59<06:28,  1.34s/it] 39%|███▊      | 182/471 [04:00<06:26,  1.34s/it] 39%|███▉      | 183/471 [04:02<06:25,  1.34s/it] 39%|███▉      | 184/471 [04:03<06:24,  1.34s/it] 39%|███▉      | 185/471 [04:04<06:22,  1.34s/it] 39%|███▉      | 186/471 [04:06<06:21,  1.34s/it] 40%|███▉      | 187/471 [04:07<06:20,  1.34s/it] 40%|███▉      | 188/471 [04:08<06:19,  1.34s/it] 40%|████      | 189/471 [04:10<06:17,  1.34s/it] 40%|████      | 190/471 [04:11<06:16,  1.34s/it] 41%|████      | 191/471 [04:12<06:15,  1.34s/it] 41%|████      | 192/471 [04:14<06:14,  1.34s/it] 41%|████      | 193/471 [04:15<06:12,  1.34s/it] 41%|████      | 194/471 [04:16<06:11,  1.34s/it] 41%|████▏     | 195/471 [04:18<06:10,  1.34s/it] 42%|████▏     | 196/471 [04:19<06:08,  1.34s/it] 42%|████▏     | 197/471 [04:21<06:06,  1.34s/it] 42%|████▏     | 198/471 [04:22<06:05,  1.34s/it] 42%|████▏     | 199/471 [04:23<06:04,  1.34s/it] 42%|████▏     | 200/471 [04:25<06:03,  1.34s/it] 43%|████▎     | 201/471 [04:26<06:01,  1.34s/it] 43%|████▎     | 202/471 [04:27<06:00,  1.34s/it] 43%|████▎     | 203/471 [04:29<05:59,  1.34s/it] 43%|████▎     | 204/471 [04:30<05:58,  1.34s/it] 44%|████▎     | 205/471 [04:31<05:56,  1.34s/it] 44%|████▎     | 206/471 [04:33<05:55,  1.34s/it] 44%|████▍     | 207/471 [04:34<05:54,  1.34s/it] 44%|████▍     | 208/471 [04:35<05:52,  1.34s/it] 44%|████▍     | 209/471 [04:37<05:51,  1.34s/it] 45%|████▍     | 210/471 [04:38<05:50,  1.34s/it] 45%|████▍     | 211/471 [04:39<05:49,  1.34s/it] 45%|████▌     | 212/471 [04:41<05:48,  1.34s/it] 45%|████▌     | 213/471 [04:42<05:47,  1.35s/it] 45%|████▌     | 214/471 [04:43<05:46,  1.35s/it] 46%|████▌     | 215/471 [04:45<05:44,  1.35s/it] 46%|████▌     | 216/471 [04:46<05:43,  1.35s/it] 46%|████▌     | 217/471 [04:47<05:42,  1.35s/it] 46%|████▋     | 218/471 [04:49<05:41,  1.35s/it] 46%|████▋     | 219/471 [04:50<05:39,  1.35s/it] 47%|████▋     | 220/471 [04:51<05:38,  1.35s/it] 47%|████▋     | 221/471 [04:53<05:37,  1.35s/it] 47%|████▋     | 222/471 [04:54<05:35,  1.35s/it] 47%|████▋     | 223/471 [04:55<05:33,  1.35s/it] 48%|████▊     | 224/471 [04:57<05:32,  1.35s/it] 48%|████▊     | 225/471 [04:58<05:31,  1.35s/it] 48%|████▊     | 226/471 [05:00<05:29,  1.35s/it] 48%|████▊     | 227/471 [05:01<05:28,  1.35s/it] 48%|████▊     | 228/471 [05:02<05:27,  1.35s/it] 49%|████▊     | 229/471 [05:04<05:26,  1.35s/it] 49%|████▉     | 230/471 [05:05<05:24,  1.35s/it] 49%|████▉     | 231/471 [05:06<05:23,  1.35s/it] 49%|████▉     | 232/471 [05:08<05:21,  1.34s/it] 49%|████▉     | 233/471 [05:09<05:20,  1.35s/it] 50%|████▉     | 234/471 [05:10<05:18,  1.35s/it] 50%|████▉     | 235/471 [05:12<05:17,  1.35s/it] 50%|█████     | 236/471 [05:13<05:16,  1.35s/it] 50%|█████     | 237/471 [05:14<05:14,  1.34s/it] 51%|█████     | 238/471 [05:16<05:13,  1.34s/it] 51%|█████     | 239/471 [05:17<05:11,  1.34s/it] 51%|█████     | 240/471 [05:18<05:10,  1.34s/it] 51%|█████     | 241/471 [05:20<05:09,  1.35s/it] 51%|█████▏    | 242/471 [05:21<05:07,  1.34s/it] 52%|█████▏    | 243/471 [05:22<05:06,  1.34s/it] 52%|█████▏    | 244/471 [05:24<05:05,  1.35s/it] 52%|█████▏    | 245/471 [05:25<05:03,  1.34s/it] 52%|█████▏    | 246/471 [05:26<05:02,  1.34s/it] 52%|█████▏    | 247/471 [05:28<05:00,  1.34s/it] 53%|█████▎    | 248/471 [05:29<04:59,  1.34s/it] 53%|█████▎    | 249/471 [05:30<04:58,  1.34s/it] 53%|█████▎    | 250/471 [05:32<04:56,  1.34s/it] 53%|█████▎    | 251/471 [05:33<04:55,  1.34s/it] 54%|█████▎    | 252/471 [05:34<04:53,  1.34s/it] 54%|█████▎    | 253/471 [05:36<04:52,  1.34s/it] 54%|█████▍    | 254/471 [05:37<04:51,  1.34s/it] 54%|█████▍    | 255/471 [05:38<04:49,  1.34s/it] 54%|█████▍    | 256/471 [05:40<04:48,  1.34s/it] 55%|█████▍    | 257/471 [05:41<04:47,  1.34s/it] 55%|█████▍    | 258/471 [05:43<04:46,  1.34s/it] 55%|█████▍    | 259/471 [05:44<04:44,  1.34s/it] 55%|█████▌    | 260/471 [05:45<04:43,  1.34s/it] 55%|█████▌    | 261/471 [05:47<04:42,  1.34s/it] 56%|█████▌    | 262/471 [05:48<04:40,  1.34s/it] 56%|█████▌    | 263/471 [05:49<04:39,  1.34s/it] 56%|█████▌    | 264/471 [05:51<04:37,  1.34s/it] 56%|█████▋    | 265/471 [05:52<04:36,  1.34s/it] 56%|█████▋    | 266/471 [05:53<04:35,  1.34s/it] 57%|█████▋    | 267/471 [05:55<04:33,  1.34s/it] 57%|█████▋    | 268/471 [05:56<04:32,  1.34s/it] 57%|█████▋    | 269/471 [05:57<04:30,  1.34s/it] 57%|█████▋    | 270/471 [05:59<04:29,  1.34s/it] 58%|█████▊    | 271/471 [06:00<04:28,  1.34s/it] 58%|█████▊    | 272/471 [06:01<04:26,  1.34s/it] 58%|█████▊    | 273/471 [06:03<04:25,  1.34s/it] 58%|█████▊    | 274/471 [06:04<04:23,  1.34s/it] 58%|█████▊    | 275/471 [06:05<04:22,  1.34s/it] 59%|█████▊    | 276/471 [06:07<04:21,  1.34s/it] 59%|█████▉    | 277/471 [06:08<04:20,  1.34s/it] 59%|█████▉    | 278/471 [06:09<04:19,  1.34s/it] 59%|█████▉    | 279/471 [06:11<04:17,  1.34s/it] 59%|█████▉    | 280/471 [06:12<04:16,  1.34s/it] 60%|█████▉    | 281/471 [06:13<04:14,  1.34s/it] 60%|█████▉    | 282/471 [06:15<04:13,  1.34s/it] 60%|██████    | 283/471 [06:16<04:12,  1.34s/it] 60%|██████    | 284/471 [06:17<04:10,  1.34s/it] 61%|██████    | 285/471 [06:19<04:09,  1.34s/it] 61%|██████    | 286/471 [06:20<04:08,  1.34s/it] 61%|██████    | 287/471 [06:21<04:07,  1.34s/it] 61%|██████    | 288/471 [06:23<04:05,  1.34s/it] 61%|██████▏   | 289/471 [06:24<04:04,  1.34s/it] 62%|██████▏   | 290/471 [06:25<04:02,  1.34s/it] 62%|██████▏   | 291/471 [06:27<04:01,  1.34s/it] 62%|██████▏   | 292/471 [06:28<03:59,  1.34s/it] 62%|██████▏   | 293/471 [06:29<03:58,  1.34s/it] 62%|██████▏   | 294/471 [06:31<03:56,  1.34s/it] 63%|██████▎   | 295/471 [06:32<03:55,  1.34s/it] 63%|██████▎   | 296/471 [06:33<03:54,  1.34s/it] 63%|██████▎   | 297/471 [06:35<03:53,  1.34s/it] 63%|██████▎   | 298/471 [06:36<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:37<03:50,  1.34s/it] 64%|██████▎   | 300/471 [06:39<03:49,  1.34s/it] 64%|██████▍   | 301/471 [06:40<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:42<03:46,  1.34s/it] 64%|██████▍   | 303/471 [06:43<03:44,  1.34s/it] 65%|██████▍   | 304/471 [06:44<03:43,  1.34s/it] 65%|██████▍   | 305/471 [06:46<03:42,  1.34s/it] 65%|██████▍   | 306/471 [06:47<03:41,  1.34s/it] 65%|██████▌   | 307/471 [06:48<03:39,  1.34s/it] 65%|██████▌   | 308/471 [06:50<03:38,  1.34s/it] 66%|██████▌   | 309/471 [06:51<03:37,  1.34s/it] 66%|██████▌   | 310/471 [06:52<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:54<03:34,  1.34s/it] 66%|██████▌   | 312/471 [06:55<03:33,  1.34s/it] 66%|██████▋   | 313/471 [06:56<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:58<03:30,  1.34s/it] 67%|██████▋   | 315/471 [06:59<03:28,  1.34s/it] 67%|██████▋   | 316/471 [07:00<03:27,  1.34s/it] 67%|██████▋   | 317/471 [07:02<03:26,  1.34s/it] 68%|██████▊   | 318/471 [07:03<03:25,  1.34s/it] 68%|██████▊   | 319/471 [07:04<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:06<03:22,  1.34s/it] 68%|██████▊   | 321/471 [07:07<03:21,  1.34s/it] 68%|██████▊   | 322/471 [07:08<03:19,  1.34s/it] 69%|██████▊   | 323/471 [07:10<03:18,  1.34s/it] 69%|██████▉   | 324/471 [07:11<03:17,  1.34s/it] 69%|██████▉   | 325/471 [07:12<03:16,  1.34s/it] 69%|██████▉   | 326/471 [07:14<03:14,  1.34s/it] 69%|██████▉   | 327/471 [07:15<03:13,  1.34s/it] 70%|██████▉   | 328/471 [07:16<03:11,  1.34s/it] 70%|██████▉   | 329/471 [07:18<03:10,  1.34s/it] 70%|███████   | 330/471 [07:19<03:09,  1.34s/it] 70%|███████   | 331/471 [07:20<03:07,  1.34s/it] 70%|███████   | 332/471 [07:22<03:06,  1.34s/it] 71%|███████   | 333/471 [07:23<03:05,  1.34s/it] 71%|███████   | 334/471 [07:24<03:03,  1.34s/it] 71%|███████   | 335/471 [07:26<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:27<03:00,  1.34s/it] 72%|███████▏  | 337/471 [07:28<02:59,  1.34s/it] 72%|███████▏  | 338/471 [07:30<02:57,  1.34s/it] 72%|███████▏  | 339/471 [07:31<02:56,  1.34s/it] 72%|███████▏  | 340/471 [07:32<02:55,  1.34s/it] 72%|███████▏  | 341/471 [07:34<02:53,  1.34s/it] 73%|███████▎  | 342/471 [07:35<02:52,  1.34s/it] 73%|███████▎  | 343/471 [07:36<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:38<02:49,  1.34s/it] 73%|███████▎  | 345/471 [07:39<02:48,  1.34s/it] 73%|███████▎  | 346/471 [07:40<02:47,  1.34s/it] 74%|███████▎  | 347/471 [07:42<02:45,  1.34s/it] 74%|███████▍  | 348/471 [07:43<02:44,  1.34s/it] 74%|███████▍  | 349/471 [07:45<02:43,  1.34s/it] 74%|███████▍  | 350/471 [07:46<02:42,  1.34s/it] 75%|███████▍  | 351/471 [07:47<02:40,  1.34s/it] 75%|███████▍  | 352/471 [07:49<02:39,  1.34s/it] 75%|███████▍  | 353/471 [07:50<02:38,  1.34s/it] 75%|███████▌  | 354/471 [07:51<02:36,  1.34s/it] 75%|███████▌  | 355/471 [07:53<02:35,  1.34s/it] 76%|███████▌  | 356/471 [07:54<02:33,  1.34s/it] 76%|███████▌  | 357/471 [07:55<02:32,  1.34s/it] 76%|███████▌  | 358/471 [07:57<02:31,  1.34s/it] 76%|███████▌  | 359/471 [07:58<02:29,  1.34s/it] 76%|███████▋  | 360/471 [07:59<02:28,  1.34s/it] 77%|███████▋  | 361/471 [08:01<02:26,  1.34s/it] 77%|███████▋  | 362/471 [08:02<02:25,  1.34s/it] 77%|███████▋  | 363/471 [08:03<02:24,  1.33s/it] 77%|███████▋  | 364/471 [08:05<02:22,  1.33s/it] 77%|███████▋  | 365/471 [08:06<02:21,  1.34s/it] 78%|███████▊  | 366/471 [08:07<02:20,  1.34s/it] 78%|███████▊  | 367/471 [08:09<02:19,  1.34s/it] 78%|███████▊  | 368/471 [08:10<02:17,  1.34s/it] 78%|███████▊  | 369/471 [08:11<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:13<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:14<02:13,  1.34s/it] 79%|███████▉  | 372/471 [08:15<02:12,  1.34s/it] 79%|███████▉  | 373/471 [08:17<02:11,  1.34s/it] 79%|███████▉  | 374/471 [08:18<02:09,  1.34s/it] 80%|███████▉  | 375/471 [08:19<02:08,  1.34s/it] 80%|███████▉  | 376/471 [08:21<02:06,  1.33s/it] 80%|████████  | 377/471 [08:22<02:05,  1.33s/it] 80%|████████  | 378/471 [08:23<02:03,  1.33s/it] 80%|████████  | 379/471 [08:25<02:02,  1.33s/it] 81%|████████  | 380/471 [08:26<02:01,  1.33s/it] 81%|████████  | 381/471 [08:27<01:59,  1.33s/it] 81%|████████  | 382/471 [08:29<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:30<01:57,  1.33s/it] 82%|████████▏ | 384/471 [08:31<01:56,  1.34s/it] 82%|████████▏ | 385/471 [08:33<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:34<01:53,  1.33s/it] 82%|████████▏ | 387/471 [08:35<01:52,  1.33s/it] 82%|████████▏ | 388/471 [08:37<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:38<01:49,  1.33s/it] 83%|████████▎ | 390/471 [08:39<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:41<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:42<01:45,  1.33s/it] 83%|████████▎ | 393/471 [08:43<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:45<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:46<01:41,  1.33s/it] 84%|████████▍ | 396/471 [08:47<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:49<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:50<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:51<01:36,  1.33s/it] 85%|████████▍ | 400/471 [08:53<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:54<01:33,  1.33s/it] 85%|████████▌ | 402/471 [08:55<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:57<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:58<01:29,  1.33s/it] 86%|████████▌ | 405/471 [08:59<01:27,  1.33s/it] 86%|████████▌ | 406/471 [09:01<01:26,  1.33s/it] 86%|████████▋ | 407/471 [09:02<01:25,  1.33s/it] 87%|████████▋ | 408/471 [09:03<01:23,  1.33s/it] 87%|████████▋ | 409/471 [09:05<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:06<01:21,  1.33s/it] 87%|████████▋ | 411/471 [09:07<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:09<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:10<01:17,  1.33s/it] 88%|████████▊ | 414/471 [09:11<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:13<01:14,  1.33s/it] 88%|████████▊ | 416/471 [09:14<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:15<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:17<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:18<01:09,  1.33s/it] 89%|████████▉ | 420/471 [09:19<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:21<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:22<01:05,  1.33s/it] 90%|████████▉ | 423/471 [09:23<01:03,  1.33s/it] 90%|█████████ | 424/471 [09:24<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:26<01:01,  1.33s/it] 90%|█████████ | 426/471 [09:27<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:28<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:30<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:31<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:32<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:34<00:53,  1.33s/it] 92%|█████████▏| 432/471 [09:35<00:51,  1.33s/it] 92%|█████████▏| 433/471 [09:36<00:50,  1.33s/it] 92%|█████████▏| 434/471 [09:38<00:49,  1.33s/it] 92%|█████████▏| 435/471 [09:39<00:48,  1.33s/it] 93%|█████████▎| 436/471 [09:40<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:42<00:45,  1.33s/it] 93%|█████████▎| 438/471 [09:43<00:44,  1.33s/it] 93%|█████████▎| 439/471 [09:44<00:42,  1.33s/it] 93%|█████████▎| 440/471 [09:46<00:41,  1.33s/it] 94%|█████████▎| 441/471 [09:47<00:39,  1.33s/it] 94%|█████████▍| 442/471 [09:48<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:50<00:37,  1.33s/it] 94%|█████████▍| 444/471 [09:51<00:35,  1.33s/it] 94%|█████████▍| 445/471 [09:52<00:34,  1.33s/it] 95%|█████████▍| 446/471 [09:54<00:33,  1.33s/it] 95%|█████████▍| 447/471 [09:55<00:32,  1.33s/it] 95%|█████████▌| 448/471 [09:56<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:58<00:29,  1.33s/it] 96%|█████████▌| 450/471 [09:59<00:28,  1.33s/it] 96%|█████████▌| 451/471 [10:00<00:26,  1.33s/it] 96%|█████████▌| 452/471 [10:02<00:25,  1.33s/it] 96%|█████████▌| 453/471 [10:03<00:24,  1.33s/it] 96%|█████████▋| 454/471 [10:04<00:22,  1.33s/it] 97%|█████████▋| 455/471 [10:06<00:21,  1.33s/it] 97%|█████████▋| 456/471 [10:07<00:20,  1.33s/it] 97%|█████████▋| 457/471 [10:08<00:18,  1.33s/it] 97%|█████████▋| 458/471 [10:10<00:17,  1.33s/it] 97%|█████████▋| 459/471 [10:11<00:15,  1.33s/it] 98%|█████████▊| 460/471 [10:12<00:14,  1.33s/it] 98%|█████████▊| 461/471 [10:14<00:13,  1.33s/it] 98%|█████████▊| 462/471 [10:15<00:11,  1.33s/it] 98%|█████████▊| 463/471 [10:16<00:10,  1.33s/it] 99%|█████████▊| 464/471 [10:18<00:09,  1.33s/it] 99%|█████████▊| 465/471 [10:19<00:07,  1.33s/it] 99%|█████████▉| 466/471 [10:20<00:06,  1.33s/it] 99%|█████████▉| 467/471 [10:22<00:05,  1.33s/it] 99%|█████████▉| 468/471 [10:23<00:03,  1.33s/it]100%|█████████▉| 469/471 [10:24<00:02,  1.33s/it]100%|█████████▉| 470/471 [10:26<00:01,  1.33s/it]100%|██████████| 471/471 [10:27<00:00,  1.22s/it]100%|██████████| 471/471 [10:27<00:00,  1.33s/it]
{'eval_loss': 2.42108154296875, 'eval_model_preparation_time': 0.0126, 'eval_acc': 0.3686935740839087, 'eval_runtime': 628.5086, 'eval_samples_per_second': 11.984, 'eval_steps_per_second': 0.749}
ROUND:18
CLIENT:83
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:41,  2.59s/it]                                              {'loss': 2.5427, 'grad_norm': 12.026968955993652, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:41,  2.59s/it]  5%|▌         | 2/40 [00:04<01:28,  2.33s/it]                                              {'loss': 1.9611, 'grad_norm': 11.161422729492188, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:28,  2.33s/it]  8%|▊         | 3/40 [00:06<01:23,  2.25s/it]                                              {'loss': 2.0081, 'grad_norm': 15.893147468566895, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.25s/it] 10%|█         | 4/40 [00:09<01:20,  2.22s/it]                                              {'loss': 2.1019, 'grad_norm': 14.398279190063477, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:20,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 2.0557, 'grad_norm': 18.615575790405273, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 3.4008, 'grad_norm': 22.031660079956055, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 1.4569, 'grad_norm': 10.644026756286621, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 0.5977, 'grad_norm': 36.91064453125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it]                                              {'loss': 1.2741, 'grad_norm': 12.980158805847168, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.88s/it]                                               {'loss': 1.266, 'grad_norm': 5.905819416046143, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.88s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.1787, 'grad_norm': 12.916708946228027, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 1.2974, 'grad_norm': 8.91234302520752, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.7096, 'grad_norm': 19.05615997314453, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:29<00:55,  2.15s/it]                                               {'loss': 1.5105, 'grad_norm': 11.01585578918457, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 1.0536, 'grad_norm': 18.36103057861328, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 0.07, 'grad_norm': 4.985577583312988, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it]                                               {'loss': 0.352, 'grad_norm': 3.9775454998016357, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.77s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it]                                               {'loss': 0.3723, 'grad_norm': 4.760381698608398, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.93s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it]                                               {'loss': 0.3218, 'grad_norm': 4.029656887054443, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.01s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.3789, 'grad_norm': 2.739502429962158, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.4615, 'grad_norm': 4.99562406539917, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.6717, 'grad_norm': 3.817960262298584, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it]                                               {'loss': 0.4875, 'grad_norm': 5.291891574859619, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it] 60%|██████    | 24/40 [00:47<00:25,  1.57s/it]                                               {'loss': 0.0035, 'grad_norm': 0.18526409566402435, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.1831, 'grad_norm': 2.259068489074707, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it]                                               {'loss': 0.3649, 'grad_norm': 4.577081680297852, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:54<00:25,  2.00s/it]                                               {'loss': 0.1887, 'grad_norm': 3.1077122688293457, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:25,  2.00s/it] 70%|███████   | 28/40 [00:56<00:24,  2.07s/it]                                               {'loss': 0.3245, 'grad_norm': 1.5060139894485474, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1734, 'grad_norm': 2.6862270832061768, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.3084, 'grad_norm': 4.372629165649414, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.5162, 'grad_norm': 5.846460819244385, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:03<00:12,  1.58s/it]                                               {'loss': 0.5627, 'grad_norm': 21.39591407775879, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.1573, 'grad_norm': 1.3734067678451538, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0535, 'grad_norm': 0.7288861870765686, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.5213, 'grad_norm': 13.61080265045166, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.08s/it]                                               {'loss': 0.2477, 'grad_norm': 1.302147626876831, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.1992, 'grad_norm': 3.3581836223602295, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.0437, 'grad_norm': 0.6281005144119263, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.5234, 'grad_norm': 1.4411309957504272, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:19<00:00,  1.58s/it]                                               {'loss': 0.0054, 'grad_norm': 0.3468616306781769, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.58s/it]                                               {'train_runtime': 79.3399, 'train_samples_per_second': 7.121, 'train_steps_per_second': 0.504, 'train_loss': 0.7976884589123074, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.58s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:1
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:34,  2.43s/it]                                              {'loss': 3.2257, 'grad_norm': 13.931026458740234, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:34,  2.43s/it]  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]                                              {'loss': 1.945, 'grad_norm': 10.731595039367676, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 2.1275, 'grad_norm': 13.8060302734375, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.972, 'grad_norm': 14.7405366897583, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:11<01:16,  2.19s/it]                                              {'loss': 1.1842, 'grad_norm': 12.439888954162598, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 2.9653, 'grad_norm': 15.317572593688965, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.4082, 'grad_norm': 12.978272438049316, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.0231, 'grad_norm': 1.395202398300171, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 1.1776, 'grad_norm': 12.896098136901855, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 1.4646, 'grad_norm': 12.084729194641113, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 1.0184, 'grad_norm': 7.34743595123291, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.6005, 'grad_norm': 11.667878150939941, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 1.1405, 'grad_norm': 8.556118965148926, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.1008, 'grad_norm': 5.791112899780273, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.978, 'grad_norm': 6.1579203605651855, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.1082, 'grad_norm': 5.84084939956665, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it]                                               {'loss': 0.6221, 'grad_norm': 4.952401638031006, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.5916, 'grad_norm': 7.14878511428833, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.3329, 'grad_norm': 3.6328468322753906, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:40,  2.04s/it]                                               {'loss': 0.4128, 'grad_norm': 12.559310913085938, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.5741, 'grad_norm': 9.651718139648438, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.4645, 'grad_norm': 6.2465667724609375, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.626, 'grad_norm': 6.570220947265625, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.0431, 'grad_norm': 4.051464557647705, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.76s/it]                                               {'loss': 0.3642, 'grad_norm': 3.0368051528930664, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.3185, 'grad_norm': 4.446404933929443, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it]                                               {'loss': 0.2462, 'grad_norm': 4.3860273361206055, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.1653, 'grad_norm': 5.548820972442627, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it]                                               {'loss': 0.2914, 'grad_norm': 4.225499153137207, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it]                                               {'loss': 0.5419, 'grad_norm': 4.726315021514893, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.1961, 'grad_norm': 1.4647084474563599, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.001, 'grad_norm': 0.06742953509092331, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.0883, 'grad_norm': 0.8793565630912781, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0391, 'grad_norm': 0.702012836933136, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.092, 'grad_norm': 1.466977834701538, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0319, 'grad_norm': 0.6369314193725586, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.4431, 'grad_norm': 2.7492573261260986, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it]                                               {'loss': 0.1235, 'grad_norm': 2.2170159816741943, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.17s/it]                                               {'loss': 0.7347, 'grad_norm': 4.3978400230407715, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.17s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0084, 'grad_norm': 0.5853110551834106, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.6239, 'train_samples_per_second': 7.186, 'train_steps_per_second': 0.509, 'train_loss': 0.7698145548682078, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:39,  2.54s/it]                                              {'loss': 2.9094, 'grad_norm': 12.299932479858398, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:39,  2.54s/it]  5%|▌         | 2/40 [00:04<01:27,  2.29s/it]                                              {'loss': 2.3559, 'grad_norm': 15.009989738464355, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:27,  2.29s/it]  8%|▊         | 3/40 [00:06<01:23,  2.27s/it]                                              {'loss': 1.1497, 'grad_norm': 10.440936088562012, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.27s/it] 10%|█         | 4/40 [00:09<01:19,  2.22s/it]                                              {'loss': 1.7337, 'grad_norm': 9.208525657653809, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:19,  2.22s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it]                                              {'loss': 1.4146, 'grad_norm': 12.715238571166992, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 1.4666, 'grad_norm': 18.94547462463379, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.0318, 'grad_norm': 7.283114910125732, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.9131, 'grad_norm': 81.1064682006836, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 3.3529, 'grad_norm': 34.16399383544922, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it]                                               {'loss': 1.9391, 'grad_norm': 17.643735885620117, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 1.4736, 'grad_norm': 15.44578742980957, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.0958, 'grad_norm': 6.854612350463867, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.4803, 'grad_norm': 4.0064616203308105, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.6884, 'grad_norm': 8.30208683013916, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it]                                               {'loss': 0.82, 'grad_norm': 25.784446716308594, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0001, 'grad_norm': 0.011655835434794426, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.4456, 'grad_norm': 4.1931633949279785, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.7635, 'grad_norm': 5.935442924499512, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it]                                               {'loss': 0.0916, 'grad_norm': 1.9709291458129883, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.5567, 'grad_norm': 5.301112651824951, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.3812, 'grad_norm': 6.395047664642334, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.5214, 'grad_norm': 15.193194389343262, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 1.5921, 'grad_norm': 23.880643844604492, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:47<00:25,  1.56s/it]                                               {'loss': 1.3197, 'grad_norm': 366.2304382324219, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.56s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.3057, 'grad_norm': 4.768146514892578, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.0493, 'grad_norm': 1.4048298597335815, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it]                                               {'loss': 0.0758, 'grad_norm': 1.8987298011779785, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.98s/it] 70%|███████   | 28/40 [00:55<00:24,  2.06s/it]                                               {'loss': 0.2547, 'grad_norm': 4.83884859085083, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.06s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it]                                               {'loss': 0.2239, 'grad_norm': 6.160786151885986, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.12s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.3504, 'grad_norm': 2.7724170684814453, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it]                                               {'loss': 0.5136, 'grad_norm': 3.79514741897583, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.18s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0476, 'grad_norm': 2.777397871017456, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0732, 'grad_norm': 3.567309856414795, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.2976, 'grad_norm': 1.9088553190231323, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.1358, 'grad_norm': 2.8397278785705566, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it]                                               {'loss': 0.2524, 'grad_norm': 3.0953195095062256, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it]                                               {'loss': 0.2409, 'grad_norm': 6.392873764038086, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.41, 'grad_norm': 2.185117483139038, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.062, 'grad_norm': 2.1783547401428223, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'loss': 0.009, 'grad_norm': 0.4683303236961365, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.59s/it]                                               {'train_runtime': 79.0077, 'train_samples_per_second': 7.151, 'train_steps_per_second': 0.506, 'train_loss': 0.819972337019135, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:9
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:38,  2.54s/it]                                              {'loss': 0.9434, 'grad_norm': 7.589165687561035, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:38,  2.54s/it]  5%|▌         | 2/40 [00:04<01:29,  2.35s/it]                                              {'loss': 2.1733, 'grad_norm': 12.2212553024292, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:29,  2.35s/it]  8%|▊         | 3/40 [00:06<01:24,  2.27s/it]                                              {'loss': 0.9813, 'grad_norm': 7.532649040222168, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:24,  2.27s/it] 10%|█         | 4/40 [00:09<01:21,  2.26s/it]                                              {'loss': 1.7302, 'grad_norm': 11.800558090209961, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:21,  2.26s/it] 12%|█▎        | 5/40 [00:11<01:18,  2.23s/it]                                              {'loss': 1.6702, 'grad_norm': 9.400163650512695, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:18,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 2.7265, 'grad_norm': 13.45302677154541, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 2.1616, 'grad_norm': 16.308012008666992, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 0.1359, 'grad_norm': 7.651541233062744, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it]                                              {'loss': 0.4276, 'grad_norm': 5.316797256469727, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it]                                               {'loss': 0.673, 'grad_norm': 7.413179397583008, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.1201, 'grad_norm': 2.502920627593994, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.1887, 'grad_norm': 4.79647159576416, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:27<00:57,  2.12s/it]                                               {'loss': 0.3518, 'grad_norm': 26.5685977935791, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:29<00:55,  2.15s/it]                                               {'loss': 1.2748, 'grad_norm': 12.162064552307129, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it]                                               {'loss': 0.1993, 'grad_norm': 3.136458396911621, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.18s/it] 40%|████      | 16/40 [00:31<00:37,  1.58s/it]                                               {'loss': 2.3889, 'grad_norm': 19.1152286529541, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.1547, 'grad_norm': 2.093785047531128, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it]                                               {'loss': 0.4641, 'grad_norm': 6.410638332366943, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it]                                               {'loss': 0.1075, 'grad_norm': 2.248971462249756, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.02s/it] 50%|█████     | 20/40 [00:40<00:41,  2.09s/it]                                               {'loss': 0.0369, 'grad_norm': 1.03736412525177, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.09s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.0158, 'grad_norm': 0.31161829829216003, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 0.0726, 'grad_norm': 1.768766164779663, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.1321, 'grad_norm': 3.0611913204193115, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0014, 'grad_norm': 0.08219920843839645, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.4652, 'grad_norm': 15.778393745422363, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:52<00:26,  1.93s/it]                                               {'loss': 0.197, 'grad_norm': 4.258215427398682, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it]                                               {'loss': 0.053, 'grad_norm': 1.374679446220398, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.0282, 'grad_norm': 0.7719776034355164, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it]                                               {'loss': 0.023, 'grad_norm': 0.6646906137466431, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.16s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it]                                               {'loss': 0.1007, 'grad_norm': 1.6590193510055542, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.20s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.19s/it]                                               {'loss': 0.0338, 'grad_norm': 1.0028717517852783, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.19s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.0003, 'grad_norm': 0.022175494581460953, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0466, 'grad_norm': 1.4079924821853638, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.93s/it]                                               {'loss': 0.0283, 'grad_norm': 0.7061225175857544, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.0322, 'grad_norm': 1.2487131357192993, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it]                                               {'loss': 0.0225, 'grad_norm': 0.5071871280670166, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.11s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0256, 'grad_norm': 3.0918166637420654, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.19s/it]                                               {'loss': 0.0276, 'grad_norm': 0.8665534853935242, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.19s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.0128, 'grad_norm': 0.22858019173145294, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0618, 'grad_norm': 3.9325766563415527, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.897, 'train_samples_per_second': 7.072, 'train_steps_per_second': 0.501, 'train_loss': 0.5072524359784438, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:39,  2.54s/it]                                              {'loss': 2.1911, 'grad_norm': 13.627853393554688, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:39,  2.54s/it]  5%|▌         | 2/40 [00:04<01:28,  2.34s/it]                                              {'loss': 2.0142, 'grad_norm': 11.973577499389648, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:28,  2.34s/it]  8%|▊         | 3/40 [00:06<01:22,  2.23s/it]                                              {'loss': 2.3494, 'grad_norm': 12.157979965209961, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.23s/it] 10%|█         | 4/40 [00:09<01:19,  2.21s/it]                                              {'loss': 2.1676, 'grad_norm': 18.664794921875, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 1.3493, 'grad_norm': 11.547412872314453, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 1.9665, 'grad_norm': 13.522348403930664, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it]                                              {'loss': 1.1733, 'grad_norm': 12.05854606628418, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.21s/it] 20%|██        | 8/40 [00:15<00:50,  1.56s/it]                                              {'loss': 0.422, 'grad_norm': 29.773883819580078, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.56s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it]                                              {'loss': 0.533, 'grad_norm': 7.31887674331665, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it]                                               {'loss': 0.9545, 'grad_norm': 8.994119644165039, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it]                                               {'loss': 0.6786, 'grad_norm': 6.076807975769043, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.99s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.2898, 'grad_norm': 3.98720121383667, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.3816, 'grad_norm': 3.9576399326324463, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:29<00:55,  2.13s/it]                                               {'loss': 1.7669, 'grad_norm': 9.83873462677002, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.8138, 'grad_norm': 7.121006011962891, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 2.9745, 'grad_norm': 62.265438079833984, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.281, 'grad_norm': 5.697690486907959, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it]                                               {'loss': 0.314, 'grad_norm': 4.429069519042969, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.89s/it] 48%|████▊     | 19/40 [00:38<00:41,  1.98s/it]                                               {'loss': 0.1899, 'grad_norm': 3.6420235633850098, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:41,  1.98s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.1659, 'grad_norm': 1.132773756980896, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.2298, 'grad_norm': 2.8492887020111084, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.1783, 'grad_norm': 2.838502883911133, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.18s/it]                                               {'loss': 0.4949, 'grad_norm': 6.814415454864502, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.1055, 'grad_norm': 4.3328471183776855, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.044, 'grad_norm': 1.1322048902511597, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.1459, 'grad_norm': 2.738504648208618, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.1707, 'grad_norm': 2.9552736282348633, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.08s/it]                                               {'loss': 0.0464, 'grad_norm': 1.3502159118652344, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.0885, 'grad_norm': 1.2531814575195312, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0492, 'grad_norm': 1.0438692569732666, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.1495, 'grad_norm': 4.226558685302734, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:03<00:12,  1.58s/it]                                               {'loss': 0.0256, 'grad_norm': 1.2545746564865112, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.76s/it]                                               {'loss': 0.1819, 'grad_norm': 4.963082313537598, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it]                                               {'loss': 0.0615, 'grad_norm': 1.7978266477584839, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it]                                               {'loss': 0.2982, 'grad_norm': 10.406850814819336, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.00s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.3653, 'grad_norm': 10.073385238647461, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0623, 'grad_norm': 1.3053257465362549, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0503, 'grad_norm': 0.9241374135017395, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0781, 'grad_norm': 1.433794617652893, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0041, 'grad_norm': 0.24682283401489258, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.3618, 'train_samples_per_second': 7.119, 'train_steps_per_second': 0.504, 'train_loss': 0.6451670016394928, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:39,  2.55s/it]                                              {'loss': 2.3923, 'grad_norm': 11.004585266113281, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:39,  2.55s/it]  5%|▌         | 2/40 [00:04<01:28,  2.32s/it]                                              {'loss': 1.2215, 'grad_norm': 8.684513092041016, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:28,  2.32s/it]  8%|▊         | 3/40 [00:06<01:23,  2.26s/it]                                              {'loss': 1.496, 'grad_norm': 11.929546356201172, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.26s/it] 10%|█         | 4/40 [00:09<01:20,  2.23s/it]                                              {'loss': 1.9836, 'grad_norm': 21.53575897216797, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:20,  2.23s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 1.613, 'grad_norm': 17.057397842407227, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it]                                              {'loss': 1.9894, 'grad_norm': 16.61615562438965, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.22s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 2.5623, 'grad_norm': 16.13960075378418, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 1.6823, 'grad_norm': 58.94683074951172, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it]                                              {'loss': 1.2363, 'grad_norm': 7.504242420196533, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it]                                               {'loss': 0.8492, 'grad_norm': 8.346931457519531, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.90s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.7956, 'grad_norm': 7.908878326416016, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:57,  2.07s/it]                                               {'loss': 0.6697, 'grad_norm': 4.765530109405518, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.3804, 'grad_norm': 4.943137168884277, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:29<00:55,  2.14s/it]                                               {'loss': 0.3992, 'grad_norm': 8.551737785339355, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it]                                               {'loss': 0.5997, 'grad_norm': 4.665724277496338, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.6977, 'grad_norm': 15.902859687805176, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.2658, 'grad_norm': 5.307523727416992, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.0796, 'grad_norm': 2.7764554023742676, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.00s/it]                                               {'loss': 0.156, 'grad_norm': 1.6791926622390747, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.08s/it]                                               {'loss': 0.358, 'grad_norm': 2.549363374710083, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.08s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.167, 'grad_norm': 2.670905113220215, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.4678, 'grad_norm': 3.984107255935669, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it]                                               {'loss': 0.1406, 'grad_norm': 1.621652364730835, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:36,  2.17s/it] 60%|██████    | 24/40 [00:47<00:25,  1.57s/it]                                               {'loss': 0.0309, 'grad_norm': 1.4278240203857422, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it]                                               {'loss': 0.1562, 'grad_norm': 1.4443072080612183, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.76s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.0775, 'grad_norm': 1.456595778465271, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it]                                               {'loss': 0.026, 'grad_norm': 0.6709238886833191, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  2.00s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.2703, 'grad_norm': 3.7373878955841064, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.1768, 'grad_norm': 24.51435661315918, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it]                                               {'loss': 0.1328, 'grad_norm': 4.562703609466553, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.074, 'grad_norm': 1.7181293964385986, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.0002, 'grad_norm': 0.015253404155373573, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.1672, 'grad_norm': 3.1434202194213867, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0923, 'grad_norm': 2.4561240673065186, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.028, 'grad_norm': 0.8937920331954956, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it]                                               {'loss': 0.0665, 'grad_norm': 1.5160291194915771, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.0269, 'grad_norm': 1.6940596103668213, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.5255, 'grad_norm': 11.24169921875, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]                                               {'loss': 0.0469, 'grad_norm': 2.3788299560546875, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.19s/it]100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'loss': 0.0076, 'grad_norm': 0.758487343788147, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]                                               {'train_runtime': 79.3623, 'train_samples_per_second': 7.119, 'train_steps_per_second': 0.504, 'train_loss': 0.6027140379723278, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.59s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:96
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:32,  2.38s/it]                                              {'loss': 2.0172, 'grad_norm': 11.142282485961914, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:32,  2.38s/it]  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]                                              {'loss': 1.6624, 'grad_norm': 9.832954406738281, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.22s/it]  8%|▊         | 3/40 [00:06<01:21,  2.19s/it]                                              {'loss': 1.1998, 'grad_norm': 14.661653518676758, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.19s/it] 10%|█         | 4/40 [00:08<01:19,  2.20s/it]                                              {'loss': 0.9117, 'grad_norm': 13.245485305786133, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.20s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it]                                              {'loss': 1.9135, 'grad_norm': 13.6442289352417, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.21s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.9792, 'grad_norm': 12.334362983703613, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 1.2771, 'grad_norm': 12.768386840820312, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 0.3139, 'grad_norm': 17.553314208984375, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.5277, 'grad_norm': 7.513183116912842, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 1.08, 'grad_norm': 17.105426788330078, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it]                                               {'loss': 0.7698, 'grad_norm': 19.401893615722656, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.3715, 'grad_norm': 10.348559379577637, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.2379, 'grad_norm': 2.0606789588928223, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it]                                               {'loss': 0.3285, 'grad_norm': 7.922779083251953, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.15s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it]                                               {'loss': 0.2597, 'grad_norm': 3.8488292694091797, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.3096, 'grad_norm': 13.095731735229492, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it]                                               {'loss': 0.7316, 'grad_norm': 8.579922676086426, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.76s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it]                                               {'loss': 0.351, 'grad_norm': 3.659095525741577, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.91s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.0727, 'grad_norm': 0.708145797252655, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.2548, 'grad_norm': 3.605926036834717, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.2426, 'grad_norm': 4.8255391120910645, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it]                                               {'loss': 0.1823, 'grad_norm': 2.99676513671875, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.16s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.1472, 'grad_norm': 2.3787569999694824, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.005, 'grad_norm': 0.5150929093360901, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.1716, 'grad_norm': 2.993210554122925, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it]                                               {'loss': 0.0724, 'grad_norm': 0.9525745511054993, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.90s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0597, 'grad_norm': 0.9558607935905457, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.0247, 'grad_norm': 2.330239772796631, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.0329, 'grad_norm': 0.797781229019165, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.0984, 'grad_norm': 1.4537423849105835, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.0583, 'grad_norm': 1.1303913593292236, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.1442, 'grad_norm': 7.784729957580566, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it]                                               {'loss': 0.0146, 'grad_norm': 0.3777939975261688, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.80s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it]                                               {'loss': 0.0405, 'grad_norm': 1.4461255073547363, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0872, 'grad_norm': 1.7448976039886475, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.0224, 'grad_norm': 0.7369967103004456, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it]                                               {'loss': 0.0524, 'grad_norm': 2.1794869899749756, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it]                                               {'loss': 0.0508, 'grad_norm': 0.8174078464508057, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.17s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0762, 'grad_norm': 2.3188509941101074, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0295, 'grad_norm': 1.0671817064285278, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.079, 'train_samples_per_second': 7.145, 'train_steps_per_second': 0.506, 'train_loss': 0.45456404850119725, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:29
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]                                              {'loss': 2.5592, 'grad_norm': 12.543490409851074, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:24,  2.16s/it]  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]                                              {'loss': 1.9102, 'grad_norm': 12.060599327087402, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.16s/it]  8%|▊         | 3/40 [00:06<01:19,  2.16s/it]                                              {'loss': 1.763, 'grad_norm': 12.497511863708496, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.16s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 2.3658, 'grad_norm': 14.859297752380371, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 2.303, 'grad_norm': 30.416255950927734, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 1.7853, 'grad_norm': 18.380996704101562, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it]                                              {'loss': 0.8805, 'grad_norm': 9.035218238830566, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.18s/it] 20%|██        | 8/40 [00:15<00:49,  1.54s/it]                                              {'loss': 1.8303, 'grad_norm': 23.145519256591797, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.54s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.7375, 'grad_norm': 7.281007289886475, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it]                                               {'loss': 0.689, 'grad_norm': 9.407538414001465, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it]                                               {'loss': 1.2871, 'grad_norm': 9.382092475891113, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:57,  1.98s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.5602, 'grad_norm': 4.934266567230225, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it]                                               {'loss': 0.2158, 'grad_norm': 4.688734531402588, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.11s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it]                                               {'loss': 0.7714, 'grad_norm': 5.22641134262085, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.14s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it]                                               {'loss': 0.6552, 'grad_norm': 5.224649906158447, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0555, 'grad_norm': 4.99670934677124, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.5479, 'grad_norm': 5.656464099884033, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.5311, 'grad_norm': 5.450695037841797, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.2594, 'grad_norm': 2.1535747051239014, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.06s/it]                                               {'loss': 0.172, 'grad_norm': 1.616241455078125, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.2917, 'grad_norm': 3.449732542037964, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.2993, 'grad_norm': 6.791118621826172, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it]                                               {'loss': 0.0458, 'grad_norm': 3.1629831790924072, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.19s/it] 60%|██████    | 24/40 [00:46<00:25,  1.59s/it]                                               {'loss': 0.033, 'grad_norm': 0.7932117581367493, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.2043, 'grad_norm': 2.52274751663208, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it]                                               {'loss': 0.2428, 'grad_norm': 4.936505317687988, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.92s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.3282, 'grad_norm': 24.889328002929688, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:55<00:25,  2.10s/it]                                               {'loss': 1.3041, 'grad_norm': 24.531099319458008, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.2015, 'grad_norm': 6.950074195861816, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.1661, 'grad_norm': 1.7380093336105347, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 2.1702, 'grad_norm': 27.664926528930664, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.313, 'grad_norm': 9.119950294494629, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.7563, 'grad_norm': 6.082477569580078, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.1311, 'grad_norm': 4.384710788726807, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.2546, 'grad_norm': 3.8993754386901855, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it]                                               {'loss': 0.0646, 'grad_norm': 11.088885307312012, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it]                                               {'loss': 0.0415, 'grad_norm': 1.0546245574951172, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.16s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.0287, 'grad_norm': 0.8827216029167175, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]                                               {'loss': 0.1256, 'grad_norm': 0.8324273228645325, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.22s/it]100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'loss': 0.0487, 'grad_norm': 5.2292985916137695, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.61s/it]                                               {'train_runtime': 79.1026, 'train_samples_per_second': 7.143, 'train_steps_per_second': 0.506, 'train_loss': 0.7232680008746684, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:86
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:28,  2.26s/it]                                              {'loss': 2.1852, 'grad_norm': 11.99148941040039, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:28,  2.26s/it]  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]                                              {'loss': 2.6634, 'grad_norm': 14.453598022460938, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]  8%|▊         | 3/40 [00:06<01:22,  2.23s/it]                                              {'loss': 1.6889, 'grad_norm': 13.125057220458984, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.23s/it] 10%|█         | 4/40 [00:08<01:20,  2.23s/it]                                              {'loss': 2.0125, 'grad_norm': 18.270965576171875, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:20,  2.23s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it]                                              {'loss': 1.25, 'grad_norm': 14.381014823913574, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 1.2183, 'grad_norm': 8.693511009216309, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it]                                              {'loss': 1.9923, 'grad_norm': 15.055915832519531, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.23s/it] 20%|██        | 8/40 [00:15<00:50,  1.58s/it]                                              {'loss': 5.3214, 'grad_norm': 92.67426300048828, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.58s/it] 22%|██▎       | 9/40 [00:18<00:55,  1.78s/it]                                              {'loss': 0.7148, 'grad_norm': 5.224804878234863, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:55,  1.78s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 0.224, 'grad_norm': 2.9950690269470215, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it]                                               {'loss': 0.3962, 'grad_norm': 4.378770351409912, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.02s/it] 30%|███       | 12/40 [00:24<00:58,  2.09s/it]                                               {'loss': 0.295, 'grad_norm': 2.7848687171936035, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.09s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it]                                               {'loss': 0.3975, 'grad_norm': 3.555901527404785, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.14s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it]                                               {'loss': 0.3521, 'grad_norm': 5.813437461853027, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.17s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it]                                               {'loss': 0.2972, 'grad_norm': 4.941310405731201, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.20s/it] 40%|████      | 16/40 [00:31<00:38,  1.60s/it]                                               {'loss': 0.035, 'grad_norm': 1.5605989694595337, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.60s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it]                                               {'loss': 0.3338, 'grad_norm': 3.1961867809295654, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.80s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.1264, 'grad_norm': 2.8308849334716797, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:43,  2.05s/it]                                               {'loss': 0.481, 'grad_norm': 7.011538505554199, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:43,  2.05s/it] 50%|█████     | 20/40 [00:40<00:42,  2.12s/it]                                               {'loss': 0.2441, 'grad_norm': 2.7843382358551025, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.12s/it] 52%|█████▎    | 21/40 [00:43<00:41,  2.17s/it]                                               {'loss': 0.1358, 'grad_norm': 1.9904980659484863, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:41,  2.17s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it]                                               {'loss': 0.1438, 'grad_norm': 3.154832601547241, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.1417, 'grad_norm': 2.2790117263793945, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0236, 'grad_norm': 0.5898188948631287, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:50<00:26,  1.80s/it]                                               {'loss': 0.0339, 'grad_norm': 0.5651527643203735, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it]                                               {'loss': 0.0373, 'grad_norm': 0.5500478744506836, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.95s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it]                                               {'loss': 0.0355, 'grad_norm': 1.1512011289596558, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it] 70%|███████   | 28/40 [00:56<00:25,  2.12s/it]                                               {'loss': 0.0229, 'grad_norm': 0.5218320488929749, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.17s/it]                                               {'loss': 0.0167, 'grad_norm': 0.3916352689266205, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.17s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it]                                               {'loss': 0.3647, 'grad_norm': 3.8520660400390625, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.1186, 'grad_norm': 2.337646722793579, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.4488, 'grad_norm': 12.226309776306152, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it]                                               {'loss': 0.0146, 'grad_norm': 0.23707766830921173, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it]                                               {'loss': 0.0356, 'grad_norm': 0.8728398680686951, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it]                                               {'loss': 0.0278, 'grad_norm': 0.7167395949363708, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.14s/it]                                               {'loss': 0.0147, 'grad_norm': 0.7506178617477417, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.14s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.19s/it]                                               {'loss': 0.0312, 'grad_norm': 0.7978438138961792, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.19s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it]                                               {'loss': 0.0569, 'grad_norm': 3.6197431087493896, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.21s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.0319, 'grad_norm': 0.7893535494804382, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:20<00:00,  1.61s/it]                                               {'loss': 0.0014, 'grad_norm': 0.11780872195959091, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.61s/it]                                               {'train_runtime': 80.4092, 'train_samples_per_second': 7.027, 'train_steps_per_second': 0.497, 'train_loss': 0.5991716661839745, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.61s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:40,  2.59s/it]                                              {'loss': 1.487, 'grad_norm': 8.263957977294922, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:40,  2.59s/it]  5%|▌         | 2/40 [00:04<01:29,  2.36s/it]                                              {'loss': 1.6219, 'grad_norm': 10.978133201599121, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:29,  2.36s/it]  8%|▊         | 3/40 [00:06<01:23,  2.27s/it]                                              {'loss': 2.1856, 'grad_norm': 12.15645694732666, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.27s/it] 10%|█         | 4/40 [00:09<01:21,  2.25s/it]                                              {'loss': 2.253, 'grad_norm': 21.550037384033203, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:21,  2.25s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it]                                              {'loss': 0.6624, 'grad_norm': 6.746922492980957, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.23s/it] 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it]                                              {'loss': 2.0992, 'grad_norm': 19.636009216308594, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:15,  2.21s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 1.1101, 'grad_norm': 10.831926345825195, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 4.5099, 'grad_norm': 73.1513671875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.77s/it]                                              {'loss': 0.2062, 'grad_norm': 3.963027000427246, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it]                                               {'loss': 0.6012, 'grad_norm': 3.7360997200012207, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 0.9607, 'grad_norm': 4.212788105010986, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.06s/it]                                               {'loss': 0.1482, 'grad_norm': 3.701845407485962, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.06s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.7726, 'grad_norm': 7.962569236755371, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it]                                               {'loss': 0.1469, 'grad_norm': 3.9529542922973633, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it]                                               {'loss': 0.3589, 'grad_norm': 6.014246463775635, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.19s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 1.2572, 'grad_norm': 48.313682556152344, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.395, 'grad_norm': 19.66979217529297, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it]                                               {'loss': 0.6161, 'grad_norm': 7.55807638168335, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it]                                               {'loss': 0.8361, 'grad_norm': 6.700847148895264, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.5103, 'grad_norm': 6.809421062469482, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.2998, 'grad_norm': 5.08767557144165, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it]                                               {'loss': 0.0933, 'grad_norm': 1.3775629997253418, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.18s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.294, 'grad_norm': 5.099571228027344, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.002, 'grad_norm': 0.11343663930892944, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.6431, 'grad_norm': 23.463123321533203, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it]                                               {'loss': 0.4079, 'grad_norm': 19.596717834472656, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it]                                               {'loss': 0.5679, 'grad_norm': 2.77873158454895, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.02s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.6882, 'grad_norm': 2.316485643386841, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.0642, 'grad_norm': 14.189718246459961, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it]                                               {'loss': 0.1351, 'grad_norm': 3.9548325538635254, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.18s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it]                                               {'loss': 0.3377, 'grad_norm': 24.407207489013672, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.21s/it] 80%|████████  | 32/40 [01:03<00:12,  1.60s/it]                                               {'loss': 0.1744, 'grad_norm': 31.02468490600586, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.60s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it]                                               {'loss': 0.1568, 'grad_norm': 2.8781275749206543, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it]                                               {'loss': 0.0646, 'grad_norm': 2.4759204387664795, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.94s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it]                                               {'loss': 0.1666, 'grad_norm': 2.9559566974639893, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.04s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 0.5828, 'grad_norm': 29.60417366027832, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it]                                               {'loss': 0.2362, 'grad_norm': 2.2027342319488525, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.18s/it]                                               {'loss': 0.4404, 'grad_norm': 5.048710823059082, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]                                               {'loss': 0.6369, 'grad_norm': 9.49815559387207, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.21s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0211, 'grad_norm': 0.7614228129386902, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 79.9437, 'train_samples_per_second': 7.067, 'train_steps_per_second': 0.5, 'train_loss': 0.7187897501629777, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  2.00s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:59,  1.56it/s]  1%|          | 3/471 [00:02<07:03,  1.11it/s]  1%|          | 4/471 [00:03<08:09,  1.05s/it]  1%|          | 5/471 [00:05<08:47,  1.13s/it]  1%|▏         | 6/471 [00:06<09:10,  1.18s/it]  1%|▏         | 7/471 [00:07<09:25,  1.22s/it]  2%|▏         | 8/471 [00:09<09:35,  1.24s/it]  2%|▏         | 9/471 [00:10<09:41,  1.26s/it]  2%|▏         | 10/471 [00:11<09:45,  1.27s/it]  2%|▏         | 11/471 [00:12<09:47,  1.28s/it]  3%|▎         | 12/471 [00:14<09:50,  1.29s/it]  3%|▎         | 13/471 [00:15<09:52,  1.29s/it]  3%|▎         | 14/471 [00:16<09:52,  1.30s/it]  3%|▎         | 15/471 [00:18<09:52,  1.30s/it]  3%|▎         | 16/471 [00:19<09:53,  1.30s/it]  4%|▎         | 17/471 [00:20<09:53,  1.31s/it]  4%|▍         | 18/471 [00:22<09:52,  1.31s/it]  4%|▍         | 19/471 [00:23<09:52,  1.31s/it]  4%|▍         | 20/471 [00:24<09:52,  1.31s/it]  4%|▍         | 21/471 [00:26<09:51,  1.32s/it]  5%|▍         | 22/471 [00:27<09:51,  1.32s/it]  5%|▍         | 23/471 [00:28<09:50,  1.32s/it]  5%|▌         | 24/471 [00:29<09:50,  1.32s/it]  5%|▌         | 25/471 [00:31<09:49,  1.32s/it]  6%|▌         | 26/471 [00:32<09:48,  1.32s/it]  6%|▌         | 27/471 [00:33<09:46,  1.32s/it]  6%|▌         | 28/471 [00:35<09:45,  1.32s/it]  6%|▌         | 29/471 [00:36<09:44,  1.32s/it]  6%|▋         | 30/471 [00:37<09:44,  1.33s/it]  7%|▋         | 31/471 [00:39<09:43,  1.33s/it]  7%|▋         | 32/471 [00:40<09:42,  1.33s/it]  7%|▋         | 33/471 [00:41<09:40,  1.32s/it]  7%|▋         | 34/471 [00:43<09:39,  1.33s/it]  7%|▋         | 35/471 [00:44<09:39,  1.33s/it]  8%|▊         | 36/471 [00:45<09:38,  1.33s/it]  8%|▊         | 37/471 [00:47<09:37,  1.33s/it]  8%|▊         | 38/471 [00:48<09:36,  1.33s/it]  8%|▊         | 39/471 [00:49<09:34,  1.33s/it]  8%|▊         | 40/471 [00:51<09:33,  1.33s/it]  9%|▊         | 41/471 [00:52<09:32,  1.33s/it]  9%|▉         | 42/471 [00:53<09:31,  1.33s/it]  9%|▉         | 43/471 [00:55<09:29,  1.33s/it]  9%|▉         | 44/471 [00:56<09:28,  1.33s/it] 10%|▉         | 45/471 [00:57<09:27,  1.33s/it] 10%|▉         | 46/471 [00:59<09:26,  1.33s/it] 10%|▉         | 47/471 [01:00<09:24,  1.33s/it] 10%|█         | 48/471 [01:01<09:23,  1.33s/it] 10%|█         | 49/471 [01:03<09:23,  1.33s/it] 11%|█         | 50/471 [01:04<09:21,  1.33s/it] 11%|█         | 51/471 [01:05<09:20,  1.34s/it] 11%|█         | 52/471 [01:07<09:19,  1.34s/it] 11%|█▏        | 53/471 [01:08<09:19,  1.34s/it] 11%|█▏        | 54/471 [01:09<09:18,  1.34s/it] 12%|█▏        | 55/471 [01:11<09:16,  1.34s/it] 12%|█▏        | 56/471 [01:12<09:15,  1.34s/it] 12%|█▏        | 57/471 [01:13<09:14,  1.34s/it] 12%|█▏        | 58/471 [01:15<09:13,  1.34s/it] 13%|█▎        | 59/471 [01:16<09:11,  1.34s/it] 13%|█▎        | 60/471 [01:17<09:10,  1.34s/it] 13%|█▎        | 61/471 [01:19<09:09,  1.34s/it] 13%|█▎        | 62/471 [01:20<09:08,  1.34s/it] 13%|█▎        | 63/471 [01:21<09:06,  1.34s/it] 14%|█▎        | 64/471 [01:23<09:05,  1.34s/it] 14%|█▍        | 65/471 [01:24<09:04,  1.34s/it] 14%|█▍        | 66/471 [01:26<09:03,  1.34s/it] 14%|█▍        | 67/471 [01:27<09:01,  1.34s/it] 14%|█▍        | 68/471 [01:28<09:00,  1.34s/it] 15%|█▍        | 69/471 [01:30<08:58,  1.34s/it] 15%|█▍        | 70/471 [01:31<08:57,  1.34s/it] 15%|█▌        | 71/471 [01:32<08:56,  1.34s/it] 15%|█▌        | 72/471 [01:34<08:54,  1.34s/it] 15%|█▌        | 73/471 [01:35<08:53,  1.34s/it] 16%|█▌        | 74/471 [01:36<08:50,  1.34s/it] 16%|█▌        | 75/471 [01:38<08:49,  1.34s/it] 16%|█▌        | 76/471 [01:39<08:47,  1.34s/it] 16%|█▋        | 77/471 [01:40<08:46,  1.34s/it] 17%|█▋        | 78/471 [01:42<08:44,  1.34s/it] 17%|█▋        | 79/471 [01:43<08:44,  1.34s/it] 17%|█▋        | 80/471 [01:44<08:43,  1.34s/it] 17%|█▋        | 81/471 [01:46<08:41,  1.34s/it] 17%|█▋        | 82/471 [01:47<08:39,  1.34s/it] 18%|█▊        | 83/471 [01:48<08:38,  1.34s/it] 18%|█▊        | 84/471 [01:50<08:37,  1.34s/it] 18%|█▊        | 85/471 [01:51<08:36,  1.34s/it] 18%|█▊        | 86/471 [01:52<08:34,  1.34s/it] 18%|█▊        | 87/471 [01:54<08:32,  1.33s/it] 19%|█▊        | 88/471 [01:55<08:30,  1.33s/it] 19%|█▉        | 89/471 [01:56<08:28,  1.33s/it] 19%|█▉        | 90/471 [01:58<08:28,  1.33s/it] 19%|█▉        | 91/471 [01:59<08:26,  1.33s/it] 20%|█▉        | 92/471 [02:00<08:24,  1.33s/it] 20%|█▉        | 93/471 [02:02<08:23,  1.33s/it] 20%|█▉        | 94/471 [02:03<08:22,  1.33s/it] 20%|██        | 95/471 [02:04<08:20,  1.33s/it] 20%|██        | 96/471 [02:06<08:19,  1.33s/it] 21%|██        | 97/471 [02:07<08:19,  1.33s/it] 21%|██        | 98/471 [02:08<08:17,  1.33s/it] 21%|██        | 99/471 [02:10<08:15,  1.33s/it] 21%|██        | 100/471 [02:11<08:14,  1.33s/it] 21%|██▏       | 101/471 [02:12<08:13,  1.33s/it] 22%|██▏       | 102/471 [02:14<08:12,  1.33s/it] 22%|██▏       | 103/471 [02:15<08:10,  1.33s/it] 22%|██▏       | 104/471 [02:16<08:09,  1.33s/it] 22%|██▏       | 105/471 [02:18<08:08,  1.34s/it] 23%|██▎       | 106/471 [02:19<08:06,  1.33s/it] 23%|██▎       | 107/471 [02:20<08:04,  1.33s/it] 23%|██▎       | 108/471 [02:22<08:03,  1.33s/it] 23%|██▎       | 109/471 [02:23<08:00,  1.33s/it] 23%|██▎       | 110/471 [02:24<07:58,  1.33s/it] 24%|██▎       | 111/471 [02:26<07:58,  1.33s/it] 24%|██▍       | 112/471 [02:27<07:57,  1.33s/it] 24%|██▍       | 113/471 [02:28<07:55,  1.33s/it] 24%|██▍       | 114/471 [02:30<07:55,  1.33s/it] 24%|██▍       | 115/471 [02:31<07:54,  1.33s/it] 25%|██▍       | 116/471 [02:32<07:53,  1.33s/it] 25%|██▍       | 117/471 [02:34<07:51,  1.33s/it] 25%|██▌       | 118/471 [02:35<07:50,  1.33s/it] 25%|██▌       | 119/471 [02:36<07:49,  1.33s/it] 25%|██▌       | 120/471 [02:38<07:48,  1.33s/it] 26%|██▌       | 121/471 [02:39<07:47,  1.33s/it] 26%|██▌       | 122/471 [02:40<07:45,  1.33s/it] 26%|██▌       | 123/471 [02:42<07:44,  1.33s/it] 26%|██▋       | 124/471 [02:43<07:43,  1.34s/it] 27%|██▋       | 125/471 [02:44<07:42,  1.34s/it] 27%|██▋       | 126/471 [02:46<07:41,  1.34s/it] 27%|██▋       | 127/471 [02:47<07:39,  1.34s/it] 27%|██▋       | 128/471 [02:48<07:38,  1.34s/it] 27%|██▋       | 129/471 [02:50<07:36,  1.33s/it] 28%|██▊       | 130/471 [02:51<07:34,  1.33s/it] 28%|██▊       | 131/471 [02:52<07:34,  1.34s/it] 28%|██▊       | 132/471 [02:54<07:32,  1.34s/it] 28%|██▊       | 133/471 [02:55<07:31,  1.34s/it] 28%|██▊       | 134/471 [02:56<07:30,  1.34s/it] 29%|██▊       | 135/471 [02:58<07:29,  1.34s/it] 29%|██▉       | 136/471 [02:59<07:27,  1.34s/it] 29%|██▉       | 137/471 [03:00<07:26,  1.34s/it] 29%|██▉       | 138/471 [03:02<07:24,  1.34s/it] 30%|██▉       | 139/471 [03:03<07:23,  1.34s/it] 30%|██▉       | 140/471 [03:04<07:22,  1.34s/it] 30%|██▉       | 141/471 [03:06<07:20,  1.33s/it] 30%|███       | 142/471 [03:07<07:19,  1.33s/it] 30%|███       | 143/471 [03:08<07:17,  1.33s/it] 31%|███       | 144/471 [03:10<07:16,  1.34s/it] 31%|███       | 145/471 [03:11<07:14,  1.33s/it] 31%|███       | 146/471 [03:12<07:13,  1.34s/it] 31%|███       | 147/471 [03:14<07:12,  1.33s/it] 31%|███▏      | 148/471 [03:15<07:11,  1.33s/it] 32%|███▏      | 149/471 [03:16<07:10,  1.34s/it] 32%|███▏      | 150/471 [03:18<07:09,  1.34s/it] 32%|███▏      | 151/471 [03:19<07:08,  1.34s/it] 32%|███▏      | 152/471 [03:20<07:06,  1.34s/it] 32%|███▏      | 153/471 [03:22<07:05,  1.34s/it] 33%|███▎      | 154/471 [03:23<07:03,  1.34s/it] 33%|███▎      | 155/471 [03:24<07:02,  1.34s/it] 33%|███▎      | 156/471 [03:26<07:01,  1.34s/it] 33%|███▎      | 157/471 [03:27<06:59,  1.34s/it] 34%|███▎      | 158/471 [03:28<06:58,  1.34s/it] 34%|███▍      | 159/471 [03:30<06:56,  1.34s/it] 34%|███▍      | 160/471 [03:31<06:56,  1.34s/it] 34%|███▍      | 161/471 [03:32<06:54,  1.34s/it] 34%|███▍      | 162/471 [03:34<06:53,  1.34s/it] 35%|███▍      | 163/471 [03:35<06:52,  1.34s/it] 35%|███▍      | 164/471 [03:36<06:50,  1.34s/it] 35%|███▌      | 165/471 [03:38<06:49,  1.34s/it] 35%|███▌      | 166/471 [03:39<06:47,  1.34s/it] 35%|███▌      | 167/471 [03:40<06:46,  1.34s/it] 36%|███▌      | 168/471 [03:42<06:45,  1.34s/it] 36%|███▌      | 169/471 [03:43<06:44,  1.34s/it] 36%|███▌      | 170/471 [03:44<06:42,  1.34s/it] 36%|███▋      | 171/471 [03:46<06:40,  1.34s/it] 37%|███▋      | 172/471 [03:47<06:39,  1.33s/it] 37%|███▋      | 173/471 [03:48<06:38,  1.34s/it] 37%|███▋      | 174/471 [03:50<06:37,  1.34s/it] 37%|███▋      | 175/471 [03:51<06:36,  1.34s/it] 37%|███▋      | 176/471 [03:52<06:34,  1.34s/it] 38%|███▊      | 177/471 [03:54<06:33,  1.34s/it] 38%|███▊      | 178/471 [03:55<06:31,  1.34s/it] 38%|███▊      | 179/471 [03:56<06:29,  1.34s/it] 38%|███▊      | 180/471 [03:58<06:28,  1.34s/it] 38%|███▊      | 181/471 [03:59<06:27,  1.34s/it] 39%|███▊      | 182/471 [04:00<06:25,  1.34s/it] 39%|███▉      | 183/471 [04:02<06:24,  1.34s/it] 39%|███▉      | 184/471 [04:03<06:22,  1.33s/it] 39%|███▉      | 185/471 [04:04<06:21,  1.33s/it] 39%|███▉      | 186/471 [04:06<06:20,  1.34s/it] 40%|███▉      | 187/471 [04:07<06:19,  1.34s/it] 40%|███▉      | 188/471 [04:08<06:18,  1.34s/it] 40%|████      | 189/471 [04:10<06:16,  1.34s/it] 40%|████      | 190/471 [04:11<06:15,  1.34s/it] 41%|████      | 191/471 [04:12<06:13,  1.34s/it] 41%|████      | 192/471 [04:14<06:12,  1.34s/it] 41%|████      | 193/471 [04:15<06:10,  1.33s/it] 41%|████      | 194/471 [04:16<06:09,  1.33s/it] 41%|████▏     | 195/471 [04:18<06:08,  1.34s/it] 42%|████▏     | 196/471 [04:19<06:06,  1.33s/it] 42%|████▏     | 197/471 [04:20<06:04,  1.33s/it] 42%|████▏     | 198/471 [04:22<06:02,  1.33s/it] 42%|████▏     | 199/471 [04:23<06:02,  1.33s/it] 42%|████▏     | 200/471 [04:24<06:00,  1.33s/it] 43%|████▎     | 201/471 [04:26<05:58,  1.33s/it] 43%|████▎     | 202/471 [04:27<05:57,  1.33s/it] 43%|████▎     | 203/471 [04:28<05:56,  1.33s/it] 43%|████▎     | 204/471 [04:30<05:54,  1.33s/it] 44%|████▎     | 205/471 [04:31<05:53,  1.33s/it] 44%|████▎     | 206/471 [04:32<05:51,  1.33s/it] 44%|████▍     | 207/471 [04:34<05:50,  1.33s/it] 44%|████▍     | 208/471 [04:35<05:48,  1.33s/it] 44%|████▍     | 209/471 [04:36<05:47,  1.33s/it] 45%|████▍     | 210/471 [04:38<05:46,  1.33s/it] 45%|████▍     | 211/471 [04:39<05:44,  1.33s/it] 45%|████▌     | 212/471 [04:40<05:43,  1.33s/it] 45%|████▌     | 213/471 [04:42<05:43,  1.33s/it] 45%|████▌     | 214/471 [04:43<05:41,  1.33s/it] 46%|████▌     | 215/471 [04:44<05:40,  1.33s/it] 46%|████▌     | 216/471 [04:46<05:40,  1.33s/it] 46%|████▌     | 217/471 [04:47<05:40,  1.34s/it] 46%|████▋     | 218/471 [04:48<05:38,  1.34s/it] 46%|████▋     | 219/471 [04:50<05:37,  1.34s/it] 47%|████▋     | 220/471 [04:51<05:35,  1.34s/it] 47%|████▋     | 221/471 [04:52<05:34,  1.34s/it] 47%|████▋     | 222/471 [04:54<05:32,  1.34s/it] 47%|████▋     | 223/471 [04:55<05:31,  1.34s/it] 48%|████▊     | 224/471 [04:56<05:30,  1.34s/it] 48%|████▊     | 225/471 [04:58<05:28,  1.34s/it] 48%|████▊     | 226/471 [04:59<05:27,  1.34s/it] 48%|████▊     | 227/471 [05:00<05:26,  1.34s/it] 48%|████▊     | 228/471 [05:02<05:25,  1.34s/it] 49%|████▊     | 229/471 [05:03<05:24,  1.34s/it] 49%|████▉     | 230/471 [05:04<05:22,  1.34s/it] 49%|████▉     | 231/471 [05:06<05:21,  1.34s/it] 49%|████▉     | 232/471 [05:07<05:19,  1.34s/it] 49%|████▉     | 233/471 [05:08<05:18,  1.34s/it] 50%|████▉     | 234/471 [05:10<05:17,  1.34s/it] 50%|████▉     | 235/471 [05:11<05:16,  1.34s/it] 50%|█████     | 236/471 [05:12<05:15,  1.34s/it] 50%|█████     | 237/471 [05:14<05:14,  1.34s/it] 51%|█████     | 238/471 [05:15<05:13,  1.34s/it] 51%|█████     | 239/471 [05:16<05:10,  1.34s/it] 51%|█████     | 240/471 [05:18<05:10,  1.34s/it] 51%|█████     | 241/471 [05:19<05:08,  1.34s/it] 51%|█████▏    | 242/471 [05:21<05:07,  1.34s/it] 52%|█████▏    | 243/471 [05:22<05:06,  1.34s/it] 52%|█████▏    | 244/471 [05:23<05:04,  1.34s/it] 52%|█████▏    | 245/471 [05:25<05:03,  1.34s/it] 52%|█████▏    | 246/471 [05:26<05:02,  1.34s/it] 52%|█████▏    | 247/471 [05:27<05:00,  1.34s/it] 53%|█████▎    | 248/471 [05:29<04:59,  1.34s/it] 53%|█████▎    | 249/471 [05:30<04:58,  1.35s/it] 53%|█████▎    | 250/471 [05:31<04:56,  1.34s/it] 53%|█████▎    | 251/471 [05:33<04:55,  1.34s/it] 54%|█████▎    | 252/471 [05:34<04:54,  1.34s/it] 54%|█████▎    | 253/471 [05:35<04:52,  1.34s/it] 54%|█████▍    | 254/471 [05:37<04:51,  1.34s/it] 54%|█████▍    | 255/471 [05:38<04:49,  1.34s/it] 54%|█████▍    | 256/471 [05:39<04:48,  1.34s/it] 55%|█████▍    | 257/471 [05:41<04:47,  1.34s/it] 55%|█████▍    | 258/471 [05:42<04:45,  1.34s/it] 55%|█████▍    | 259/471 [05:43<04:44,  1.34s/it] 55%|█████▌    | 260/471 [05:45<04:43,  1.34s/it] 55%|█████▌    | 261/471 [05:46<04:41,  1.34s/it] 56%|█████▌    | 262/471 [05:47<04:40,  1.34s/it] 56%|█████▌    | 263/471 [05:49<04:38,  1.34s/it] 56%|█████▌    | 264/471 [05:50<04:37,  1.34s/it] 56%|█████▋    | 265/471 [05:51<04:36,  1.34s/it] 56%|█████▋    | 266/471 [05:53<04:35,  1.34s/it] 57%|█████▋    | 267/471 [05:54<04:34,  1.34s/it] 57%|█████▋    | 268/471 [05:55<04:32,  1.34s/it] 57%|█████▋    | 269/471 [05:57<04:31,  1.34s/it] 57%|█████▋    | 270/471 [05:58<04:29,  1.34s/it] 58%|█████▊    | 271/471 [05:59<04:28,  1.34s/it] 58%|█████▊    | 272/471 [06:01<04:26,  1.34s/it] 58%|█████▊    | 273/471 [06:02<04:25,  1.34s/it] 58%|█████▊    | 274/471 [06:03<04:23,  1.34s/it] 58%|█████▊    | 275/471 [06:05<04:22,  1.34s/it] 59%|█████▊    | 276/471 [06:06<04:21,  1.34s/it] 59%|█████▉    | 277/471 [06:07<04:19,  1.34s/it] 59%|█████▉    | 278/471 [06:09<04:18,  1.34s/it] 59%|█████▉    | 279/471 [06:10<04:16,  1.34s/it] 59%|█████▉    | 280/471 [06:11<04:14,  1.33s/it] 60%|█████▉    | 281/471 [06:13<04:13,  1.33s/it] 60%|█████▉    | 282/471 [06:14<04:12,  1.34s/it] 60%|██████    | 283/471 [06:15<04:11,  1.34s/it] 60%|██████    | 284/471 [06:17<04:09,  1.34s/it] 61%|██████    | 285/471 [06:18<04:08,  1.34s/it] 61%|██████    | 286/471 [06:19<04:07,  1.34s/it] 61%|██████    | 287/471 [06:21<04:05,  1.34s/it] 61%|██████    | 288/471 [06:22<04:04,  1.34s/it] 61%|██████▏   | 289/471 [06:23<04:03,  1.34s/it] 62%|██████▏   | 290/471 [06:25<04:01,  1.33s/it] 62%|██████▏   | 291/471 [06:26<03:59,  1.33s/it] 62%|██████▏   | 292/471 [06:27<03:58,  1.33s/it] 62%|██████▏   | 293/471 [06:29<03:56,  1.33s/it] 62%|██████▏   | 294/471 [06:30<03:55,  1.33s/it] 63%|██████▎   | 295/471 [06:31<03:54,  1.33s/it] 63%|██████▎   | 296/471 [06:33<03:52,  1.33s/it] 63%|██████▎   | 297/471 [06:34<03:51,  1.33s/it] 63%|██████▎   | 298/471 [06:35<03:50,  1.33s/it] 63%|██████▎   | 299/471 [06:37<03:49,  1.33s/it] 64%|██████▎   | 300/471 [06:38<03:47,  1.33s/it] 64%|██████▍   | 301/471 [06:39<03:46,  1.33s/it] 64%|██████▍   | 302/471 [06:41<03:45,  1.33s/it] 64%|██████▍   | 303/471 [06:42<03:43,  1.33s/it] 65%|██████▍   | 304/471 [06:43<03:42,  1.33s/it] 65%|██████▍   | 305/471 [06:45<03:41,  1.33s/it] 65%|██████▍   | 306/471 [06:46<03:39,  1.33s/it] 65%|██████▌   | 307/471 [06:47<03:38,  1.33s/it] 65%|██████▌   | 308/471 [06:49<03:37,  1.33s/it] 66%|██████▌   | 309/471 [06:50<03:36,  1.34s/it] 66%|██████▌   | 310/471 [06:51<03:34,  1.33s/it] 66%|██████▌   | 311/471 [06:53<03:32,  1.33s/it] 66%|██████▌   | 312/471 [06:54<03:31,  1.33s/it] 66%|██████▋   | 313/471 [06:55<03:30,  1.33s/it] 67%|██████▋   | 314/471 [06:57<03:28,  1.33s/it] 67%|██████▋   | 315/471 [06:58<03:27,  1.33s/it] 67%|██████▋   | 316/471 [06:59<03:26,  1.33s/it] 67%|██████▋   | 317/471 [07:01<03:24,  1.33s/it] 68%|██████▊   | 318/471 [07:02<03:23,  1.33s/it] 68%|██████▊   | 319/471 [07:03<03:22,  1.33s/it] 68%|██████▊   | 320/471 [07:05<03:21,  1.33s/it] 68%|██████▊   | 321/471 [07:06<03:20,  1.34s/it] 68%|██████▊   | 322/471 [07:07<03:18,  1.33s/it] 69%|██████▊   | 323/471 [07:09<03:17,  1.33s/it] 69%|██████▉   | 324/471 [07:10<03:16,  1.34s/it] 69%|██████▉   | 325/471 [07:11<03:14,  1.33s/it] 69%|██████▉   | 326/471 [07:13<03:13,  1.33s/it] 69%|██████▉   | 327/471 [07:14<03:11,  1.33s/it] 70%|██████▉   | 328/471 [07:16<03:25,  1.44s/it] 70%|██████▉   | 329/471 [07:17<03:19,  1.40s/it] 70%|███████   | 330/471 [07:18<03:14,  1.38s/it] 70%|███████   | 331/471 [07:20<03:10,  1.36s/it] 70%|███████   | 332/471 [07:21<03:08,  1.35s/it] 71%|███████   | 333/471 [07:22<03:05,  1.34s/it] 71%|███████   | 334/471 [07:24<03:03,  1.34s/it] 71%|███████   | 335/471 [07:25<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:26<03:00,  1.33s/it] 72%|███████▏  | 337/471 [07:28<02:58,  1.33s/it] 72%|███████▏  | 338/471 [07:29<02:56,  1.33s/it] 72%|███████▏  | 339/471 [07:30<02:55,  1.33s/it] 72%|███████▏  | 340/471 [07:32<02:54,  1.33s/it] 72%|███████▏  | 341/471 [07:33<02:52,  1.33s/it] 73%|███████▎  | 342/471 [07:34<02:51,  1.33s/it] 73%|███████▎  | 343/471 [07:36<02:50,  1.33s/it] 73%|███████▎  | 344/471 [07:37<02:48,  1.33s/it] 73%|███████▎  | 345/471 [07:38<02:47,  1.33s/it] 73%|███████▎  | 346/471 [07:40<02:45,  1.33s/it] 74%|███████▎  | 347/471 [07:41<02:44,  1.33s/it] 74%|███████▍  | 348/471 [07:42<02:43,  1.33s/it] 74%|███████▍  | 349/471 [07:44<02:41,  1.33s/it] 74%|███████▍  | 350/471 [07:45<02:40,  1.33s/it] 75%|███████▍  | 351/471 [07:46<02:39,  1.33s/it] 75%|███████▍  | 352/471 [07:48<02:37,  1.33s/it] 75%|███████▍  | 353/471 [07:49<02:36,  1.33s/it] 75%|███████▌  | 354/471 [07:50<02:35,  1.33s/it] 75%|███████▌  | 355/471 [07:52<02:33,  1.33s/it] 76%|███████▌  | 356/471 [07:53<02:32,  1.32s/it] 76%|███████▌  | 357/471 [07:54<02:30,  1.32s/it] 76%|███████▌  | 358/471 [07:56<02:29,  1.32s/it] 76%|███████▌  | 359/471 [07:57<02:28,  1.32s/it] 76%|███████▋  | 360/471 [07:58<02:26,  1.32s/it] 77%|███████▋  | 361/471 [08:00<02:25,  1.32s/it] 77%|███████▋  | 362/471 [08:01<02:24,  1.32s/it] 77%|███████▋  | 363/471 [08:02<02:22,  1.32s/it] 77%|███████▋  | 364/471 [08:03<02:21,  1.32s/it] 77%|███████▋  | 365/471 [08:05<02:20,  1.32s/it] 78%|███████▊  | 366/471 [08:06<02:19,  1.32s/it] 78%|███████▊  | 367/471 [08:07<02:17,  1.32s/it] 78%|███████▊  | 368/471 [08:09<02:16,  1.32s/it] 78%|███████▊  | 369/471 [08:10<02:14,  1.32s/it] 79%|███████▊  | 370/471 [08:11<02:13,  1.32s/it] 79%|███████▉  | 371/471 [08:13<02:12,  1.32s/it] 79%|███████▉  | 372/471 [08:14<02:10,  1.32s/it] 79%|███████▉  | 373/471 [08:15<02:09,  1.32s/it] 79%|███████▉  | 374/471 [08:17<02:08,  1.32s/it] 80%|███████▉  | 375/471 [08:18<02:06,  1.32s/it] 80%|███████▉  | 376/471 [08:19<02:05,  1.32s/it] 80%|████████  | 377/471 [08:21<02:03,  1.32s/it] 80%|████████  | 378/471 [08:22<02:02,  1.32s/it] 80%|████████  | 379/471 [08:23<02:01,  1.32s/it] 81%|████████  | 380/471 [08:25<02:00,  1.32s/it] 81%|████████  | 381/471 [08:26<01:58,  1.32s/it] 81%|████████  | 382/471 [08:27<01:57,  1.32s/it] 81%|████████▏ | 383/471 [08:29<01:56,  1.32s/it] 82%|████████▏ | 384/471 [08:30<01:55,  1.32s/it] 82%|████████▏ | 385/471 [08:31<01:53,  1.32s/it] 82%|████████▏ | 386/471 [08:33<01:52,  1.32s/it] 82%|████████▏ | 387/471 [08:34<01:51,  1.32s/it] 82%|████████▏ | 388/471 [08:35<01:49,  1.32s/it] 83%|████████▎ | 389/471 [08:37<01:48,  1.32s/it] 83%|████████▎ | 390/471 [08:38<01:47,  1.32s/it] 83%|████████▎ | 391/471 [08:39<01:45,  1.32s/it] 83%|████████▎ | 392/471 [08:40<01:44,  1.32s/it] 83%|████████▎ | 393/471 [08:42<01:43,  1.32s/it] 84%|████████▎ | 394/471 [08:43<01:41,  1.32s/it] 84%|████████▍ | 395/471 [08:44<01:40,  1.32s/it] 84%|████████▍ | 396/471 [08:46<01:39,  1.32s/it] 84%|████████▍ | 397/471 [08:47<01:37,  1.32s/it] 85%|████████▍ | 398/471 [08:48<01:36,  1.32s/it] 85%|████████▍ | 399/471 [08:50<01:35,  1.32s/it] 85%|████████▍ | 400/471 [08:51<01:33,  1.32s/it] 85%|████████▌ | 401/471 [08:52<01:32,  1.32s/it] 85%|████████▌ | 402/471 [08:54<01:31,  1.32s/it] 86%|████████▌ | 403/471 [08:55<01:29,  1.32s/it] 86%|████████▌ | 404/471 [08:56<01:28,  1.32s/it] 86%|████████▌ | 405/471 [08:58<01:27,  1.32s/it] 86%|████████▌ | 406/471 [08:59<01:25,  1.32s/it] 86%|████████▋ | 407/471 [09:00<01:24,  1.32s/it] 87%|████████▋ | 408/471 [09:02<01:23,  1.32s/it] 87%|████████▋ | 409/471 [09:03<01:22,  1.32s/it] 87%|████████▋ | 410/471 [09:04<01:20,  1.32s/it] 87%|████████▋ | 411/471 [09:06<01:19,  1.32s/it] 87%|████████▋ | 412/471 [09:07<01:18,  1.32s/it] 88%|████████▊ | 413/471 [09:08<01:16,  1.32s/it] 88%|████████▊ | 414/471 [09:10<01:15,  1.32s/it] 88%|████████▊ | 415/471 [09:11<01:14,  1.32s/it] 88%|████████▊ | 416/471 [09:12<01:12,  1.33s/it] 89%|████████▊ | 417/471 [09:14<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:15<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:16<01:08,  1.33s/it] 89%|████████▉ | 420/471 [09:18<01:07,  1.33s/it] 89%|████████▉ | 421/471 [09:19<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:20<01:04,  1.32s/it] 90%|████████▉ | 423/471 [09:21<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:23<01:02,  1.33s/it] 90%|█████████ | 425/471 [09:24<01:00,  1.32s/it] 90%|█████████ | 426/471 [09:25<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:27<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:28<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:29<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:31<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:32<00:53,  1.33s/it] 92%|█████████▏| 432/471 [09:33<00:51,  1.33s/it] 92%|█████████▏| 433/471 [09:35<00:50,  1.33s/it] 92%|█████████▏| 434/471 [09:36<00:49,  1.33s/it] 92%|█████████▏| 435/471 [09:37<00:47,  1.33s/it] 93%|█████████▎| 436/471 [09:39<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:40<00:45,  1.33s/it] 93%|█████████▎| 438/471 [09:41<00:43,  1.33s/it] 93%|█████████▎| 439/471 [09:43<00:42,  1.33s/it] 93%|█████████▎| 440/471 [09:44<00:41,  1.33s/it] 94%|█████████▎| 441/471 [09:45<00:39,  1.33s/it] 94%|█████████▍| 442/471 [09:47<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:48<00:37,  1.33s/it] 94%|█████████▍| 444/471 [09:49<00:36,  1.33s/it] 94%|█████████▍| 445/471 [09:51<00:34,  1.33s/it] 95%|█████████▍| 446/471 [09:52<00:33,  1.33s/it] 95%|█████████▍| 447/471 [09:53<00:32,  1.33s/it] 95%|█████████▌| 448/471 [09:55<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:56<00:29,  1.34s/it] 96%|█████████▌| 450/471 [09:57<00:28,  1.34s/it] 96%|█████████▌| 451/471 [09:59<00:26,  1.34s/it] 96%|█████████▌| 452/471 [10:00<00:25,  1.34s/it] 96%|█████████▌| 453/471 [10:01<00:24,  1.34s/it] 96%|█████████▋| 454/471 [10:03<00:22,  1.34s/it] 97%|█████████▋| 455/471 [10:04<00:21,  1.34s/it] 97%|█████████▋| 456/471 [10:05<00:20,  1.34s/it] 97%|█████████▋| 457/471 [10:07<00:18,  1.34s/it] 97%|█████████▋| 458/471 [10:08<00:17,  1.34s/it] 97%|█████████▋| 459/471 [10:09<00:16,  1.34s/it] 98%|█████████▊| 460/471 [10:11<00:14,  1.34s/it] 98%|█████████▊| 461/471 [10:12<00:13,  1.34s/it] 98%|█████████▊| 462/471 [10:14<00:12,  1.34s/it] 98%|█████████▊| 463/471 [10:15<00:10,  1.34s/it] 99%|█████████▊| 464/471 [10:16<00:09,  1.34s/it] 99%|█████████▊| 465/471 [10:18<00:08,  1.34s/it] 99%|█████████▉| 466/471 [10:19<00:06,  1.34s/it] 99%|█████████▉| 467/471 [10:20<00:05,  1.34s/it] 99%|█████████▉| 468/471 [10:22<00:04,  1.34s/it]100%|█████████▉| 469/471 [10:23<00:02,  1.34s/it]100%|█████████▉| 470/471 [10:24<00:01,  1.34s/it]100%|██████████| 471/471 [10:25<00:00,  1.23s/it]100%|██████████| 471/471 [10:25<00:00,  1.33s/it]
{'eval_loss': 2.310819149017334, 'eval_model_preparation_time': 0.0108, 'eval_acc': 0.3827668613913967, 'eval_runtime': 626.9868, 'eval_samples_per_second': 12.013, 'eval_steps_per_second': 0.751}
ROUND:19
CLIENT:83
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:35,  2.45s/it]                                              {'loss': 2.1976, 'grad_norm': 11.73000431060791, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:35,  2.45s/it]  5%|▌         | 2/40 [00:04<01:25,  2.26s/it]                                              {'loss': 1.6074, 'grad_norm': 10.600648880004883, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:25,  2.26s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 1.5955, 'grad_norm': 14.180573463439941, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:18,  2.17s/it]                                              {'loss': 1.8052, 'grad_norm': 13.196605682373047, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.17s/it] 12%|█▎        | 5/40 [00:11<01:16,  2.18s/it]                                              {'loss': 2.1095, 'grad_norm': 19.35112762451172, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:16,  2.18s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 2.3692, 'grad_norm': 16.531631469726562, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.5202, 'grad_norm': 12.223487854003906, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 2.4071, 'grad_norm': 79.50994873046875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it]                                              {'loss': 0.5966, 'grad_norm': 3.5970659255981445, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it]                                               {'loss': 0.875, 'grad_norm': 4.538179874420166, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 0.911, 'grad_norm': 10.415154457092285, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.0847, 'grad_norm': 9.708420753479004, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it]                                               {'loss': 0.4883, 'grad_norm': 12.05201244354248, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.10s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it]                                               {'loss': 0.9177, 'grad_norm': 7.091768264770508, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.13s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it]                                               {'loss': 0.5119, 'grad_norm': 9.378074645996094, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.16s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 0.0115, 'grad_norm': 0.6959697604179382, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.2583, 'grad_norm': 3.5055203437805176, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.1087, 'grad_norm': 1.3577395677566528, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it]                                               {'loss': 0.1266, 'grad_norm': 1.1853712797164917, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  2.00s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.2532, 'grad_norm': 0.8287451863288879, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it]                                               {'loss': 0.2317, 'grad_norm': 2.8782010078430176, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.12s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it]                                               {'loss': 0.6908, 'grad_norm': 20.10907745361328, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.13s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it]                                               {'loss': 0.632, 'grad_norm': 6.371374130249023, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.15s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0019, 'grad_norm': 0.11522866785526276, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it]                                               {'loss': 0.0655, 'grad_norm': 1.2426438331604004, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.79s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.2455, 'grad_norm': 1.5391619205474854, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.0556, 'grad_norm': 1.0718988180160522, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.09s/it]                                               {'loss': 0.4318, 'grad_norm': 2.512552261352539, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.09s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it]                                               {'loss': 0.3541, 'grad_norm': 19.3535213470459, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.14s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.5019, 'grad_norm': 20.09996795654297, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.5559, 'grad_norm': 10.467096328735352, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0502, 'grad_norm': 2.6400153636932373, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.0635, 'grad_norm': 0.4774220287799835, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0366, 'grad_norm': 0.8272113800048828, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.1335, 'grad_norm': 4.039668560028076, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.3203, 'grad_norm': 6.110952854156494, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it]                                               {'loss': 0.3068, 'grad_norm': 4.051517009735107, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it]                                               {'loss': 0.077, 'grad_norm': 1.9397732019424438, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.16s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.4448, 'grad_norm': 1.608171820640564, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0099, 'grad_norm': 0.6899437308311462, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 79.0047, 'train_samples_per_second': 7.151, 'train_steps_per_second': 0.506, 'train_loss': 0.6741152573435102, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.58s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:1
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:31,  2.34s/it]                                              {'loss': 2.7822, 'grad_norm': 13.419177055358887, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:31,  2.34s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 1.4992, 'grad_norm': 10.629066467285156, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:19,  2.15s/it]                                              {'loss': 2.0192, 'grad_norm': 14.066292762756348, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:19,  2.15s/it] 10%|█         | 4/40 [00:08<01:17,  2.15s/it]                                              {'loss': 1.6554, 'grad_norm': 12.827508926391602, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:17,  2.15s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it]                                              {'loss': 0.9777, 'grad_norm': 10.301605224609375, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.16s/it] 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it]                                              {'loss': 2.88, 'grad_norm': 17.117170333862305, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:12<01:12,  2.13s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.15s/it]                                              {'loss': 1.125, 'grad_norm': 12.509660720825195, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.15s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 0.0203, 'grad_norm': 1.3133220672607422, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.945, 'grad_norm': 13.878293991088867, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it]                                               {'loss': 1.4734, 'grad_norm': 14.912952423095703, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it]                                               {'loss': 0.8609, 'grad_norm': 7.932989120483398, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:21<00:56,  1.95s/it] 30%|███       | 12/40 [00:23<00:56,  2.02s/it]                                               {'loss': 1.4471, 'grad_norm': 11.532367706298828, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:23<00:56,  2.02s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 1.1233, 'grad_norm': 9.65954303741455, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it]                                               {'loss': 1.2358, 'grad_norm': 7.175363540649414, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.10s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it]                                               {'loss': 0.9354, 'grad_norm': 6.671111583709717, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it] 40%|████      | 16/40 [00:30<00:36,  1.54s/it]                                               {'loss': 0.0514, 'grad_norm': 2.9517550468444824, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:30<00:36,  1.54s/it] 42%|████▎     | 17/40 [00:32<00:39,  1.71s/it]                                               {'loss': 0.519, 'grad_norm': 1.6174882650375366, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:32<00:39,  1.71s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.86s/it]                                               {'loss': 0.5893, 'grad_norm': 7.257981777191162, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.86s/it] 48%|████▊     | 19/40 [00:37<00:40,  1.95s/it]                                               {'loss': 0.3782, 'grad_norm': 1.3035330772399902, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:40,  1.95s/it] 50%|█████     | 20/40 [00:39<00:40,  2.02s/it]                                               {'loss': 0.0306, 'grad_norm': 0.7459967732429504, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.02s/it] 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it]                                               {'loss': 0.2129, 'grad_norm': 5.359071731567383, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:41<00:39,  2.07s/it] 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it]                                               {'loss': 0.2898, 'grad_norm': 4.511407852172852, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:43<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:45<00:36,  2.14s/it]                                               {'loss': 0.4141, 'grad_norm': 2.7485055923461914, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:45<00:36,  2.14s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 0.0674, 'grad_norm': 6.048463344573975, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.1782, 'grad_norm': 2.9945788383483887, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it]                                               {'loss': 0.087, 'grad_norm': 1.3599178791046143, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:50<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:52<00:25,  1.96s/it]                                               {'loss': 0.2456, 'grad_norm': 5.357609272003174, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:52<00:25,  1.96s/it] 70%|███████   | 28/40 [00:54<00:24,  2.05s/it]                                               {'loss': 0.0855, 'grad_norm': 4.4769744873046875, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:54<00:24,  2.05s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.09s/it]                                               {'loss': 0.4912, 'grad_norm': 9.383255958557129, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.09s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it]                                               {'loss': 0.5255, 'grad_norm': 8.643458366394043, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.13s/it] 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it]                                               {'loss': 0.2656, 'grad_norm': 3.6622583866119385, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:01<00:19,  2.15s/it] 80%|████████  | 32/40 [01:01<00:12,  1.56s/it]                                               {'loss': 0.0006, 'grad_norm': 0.04738329350948334, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:01<00:12,  1.56s/it] 82%|████████▎ | 33/40 [01:03<00:12,  1.74s/it]                                               {'loss': 0.0963, 'grad_norm': 0.867214560508728, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:03<00:12,  1.74s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it]                                               {'loss': 0.0273, 'grad_norm': 0.49925142526626587, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.91s/it] 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it]                                               {'loss': 0.1497, 'grad_norm': 3.6182034015655518, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:08<00:09,  2.00s/it] 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it]                                               {'loss': 0.0281, 'grad_norm': 0.613849937915802, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:10<00:08,  2.07s/it] 92%|█████████▎| 37/40 [01:12<00:06,  2.12s/it]                                               {'loss': 0.341, 'grad_norm': 1.9579815864562988, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:12<00:06,  2.12s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it]                                               {'loss': 0.0818, 'grad_norm': 1.884325385093689, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.15s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.16s/it]                                               {'loss': 0.4493, 'grad_norm': 2.0639233589172363, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.16s/it]100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'loss': 0.0146, 'grad_norm': 1.216043472290039, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]                                               {'train_runtime': 77.7812, 'train_samples_per_second': 7.264, 'train_steps_per_second': 0.514, 'train_loss': 0.665002283208014, 'epoch': 5.0}
100%|██████████| 40/40 [01:17<00:00,  1.57s/it]100%|██████████| 40/40 [01:17<00:00,  1.94s/it]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:29,  2.30s/it]                                              {'loss': 2.3965, 'grad_norm': 12.744512557983398, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:29,  2.30s/it]  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]                                              {'loss': 2.2041, 'grad_norm': 15.915038108825684, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:22,  2.18s/it]  8%|▊         | 3/40 [00:06<01:21,  2.20s/it]                                              {'loss': 0.9901, 'grad_norm': 9.819623947143555, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:21,  2.20s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.4009, 'grad_norm': 35.999122619628906, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it]                                              {'loss': 1.1071, 'grad_norm': 10.277031898498535, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:16,  2.19s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.523, 'grad_norm': 22.105043411254883, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 0.932, 'grad_norm': 7.208893775939941, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:51,  1.60s/it]                                              {'loss': 0.3391, 'grad_norm': 24.55199432373047, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:51,  1.60s/it] 22%|██▎       | 9/40 [00:17<00:55,  1.80s/it]                                              {'loss': 3.7985, 'grad_norm': 25.603925704956055, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:55,  1.80s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 1.8434, 'grad_norm': 13.892781257629395, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 0.4457, 'grad_norm': 8.220746040344238, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 1.1098, 'grad_norm': 5.7954301834106445, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it]                                               {'loss': 0.8353, 'grad_norm': 6.912387847900391, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:55,  2.07s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.6628, 'grad_norm': 11.872102737426758, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it]                                               {'loss': 0.51, 'grad_norm': 9.064336776733398, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.12s/it] 40%|████      | 16/40 [00:31<00:37,  1.54s/it]                                               {'loss': 0.0944, 'grad_norm': 6.317224502563477, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.54s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it]                                               {'loss': 0.3378, 'grad_norm': 1.1503585577011108, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.74s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it]                                               {'loss': 0.0685, 'grad_norm': 4.046327114105225, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.87s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it]                                               {'loss': 0.0711, 'grad_norm': 2.845578193664551, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.97s/it] 50%|█████     | 20/40 [00:39<00:40,  2.05s/it]                                               {'loss': 0.3201, 'grad_norm': 4.628001689910889, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.09s/it]                                               {'loss': 0.4521, 'grad_norm': 5.408022880554199, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.09s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it]                                               {'loss': 0.3727, 'grad_norm': 4.007939338684082, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.13s/it]                                               {'loss': 0.7862, 'grad_norm': 18.87010383605957, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.13s/it] 60%|██████    | 24/40 [00:46<00:24,  1.55s/it]                                               {'loss': 0.102, 'grad_norm': 2.501753091812134, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.55s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it]                                               {'loss': 0.7439, 'grad_norm': 12.75649356842041, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.74s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.88s/it]                                               {'loss': 0.1237, 'grad_norm': 14.060042381286621, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.97s/it]                                               {'loss': 0.1085, 'grad_norm': 3.5355162620544434, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.97s/it] 70%|███████   | 28/40 [00:55<00:24,  2.04s/it]                                               {'loss': 0.2365, 'grad_norm': 3.3075997829437256, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.04s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it]                                               {'loss': 0.7162, 'grad_norm': 43.8568229675293, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.10s/it] 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it]                                               {'loss': 0.4373, 'grad_norm': 3.563060760498047, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:59<00:21,  2.15s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.16s/it]                                               {'loss': 1.0712, 'grad_norm': 6.517241954803467, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.16s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.0409, 'grad_norm': 3.928114652633667, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it]                                               {'loss': 0.0072, 'grad_norm': 0.22113654017448425, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.77s/it] 85%|████████▌ | 34/40 [01:06<00:11,  1.89s/it]                                               {'loss': 0.9753, 'grad_norm': 8.757022857666016, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:06<00:11,  1.89s/it] 88%|████████▊ | 35/40 [01:09<00:09,  2.00s/it]                                               {'loss': 0.1292, 'grad_norm': 5.353809833526611, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:09,  2.00s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.05s/it]                                               {'loss': 1.4135, 'grad_norm': 18.722393035888672, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.05s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.10s/it]                                               {'loss': 0.2619, 'grad_norm': 15.999399185180664, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.10s/it] 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it]                                               {'loss': 0.4639, 'grad_norm': 21.14591407775879, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:15<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]                                               {'loss': 0.3032, 'grad_norm': 26.469850540161133, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:17<00:02,  2.17s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0259, 'grad_norm': 1.2653610706329346, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.3288, 'train_samples_per_second': 7.213, 'train_steps_per_second': 0.511, 'train_loss': 0.7440345842042007, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.96s/it]
CLIENT:9
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:39,  2.56s/it]                                              {'loss': 0.8315, 'grad_norm': 6.871112823486328, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:39,  2.56s/it]  5%|▌         | 2/40 [00:04<01:28,  2.33s/it]                                              {'loss': 1.9745, 'grad_norm': 12.364829063415527, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:28,  2.33s/it]  8%|▊         | 3/40 [00:06<01:23,  2.26s/it]                                              {'loss': 0.8457, 'grad_norm': 6.798303127288818, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.26s/it] 10%|█         | 4/40 [00:09<01:20,  2.24s/it]                                              {'loss': 1.6732, 'grad_norm': 11.949172019958496, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:20,  2.24s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.20s/it]                                              {'loss': 1.5122, 'grad_norm': 10.846175193786621, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it]                                              {'loss': 2.2381, 'grad_norm': 14.507915496826172, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.16s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it]                                              {'loss': 2.1925, 'grad_norm': 20.91937828063965, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.16s/it] 20%|██        | 8/40 [00:15<00:48,  1.53s/it]                                              {'loss': 0.2197, 'grad_norm': 22.7700252532959, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:48,  1.53s/it] 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it]                                              {'loss': 0.3326, 'grad_norm': 5.210521697998047, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:53,  1.73s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.87s/it]                                               {'loss': 0.5833, 'grad_norm': 9.164121627807617, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:22<00:56,  1.96s/it]                                               {'loss': 0.13, 'grad_norm': 2.3120081424713135, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:56,  1.96s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.1133, 'grad_norm': 3.6827712059020996, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.4843, 'grad_norm': 4.4549031257629395, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 1.1681, 'grad_norm': 10.974459648132324, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it]                                               {'loss': 0.2146, 'grad_norm': 3.511887550354004, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.56s/it]                                               {'loss': 2.0378, 'grad_norm': 20.491348266601562, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.56s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it]                                               {'loss': 0.0983, 'grad_norm': 1.8495627641677856, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.75s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.9563, 'grad_norm': 5.438610076904297, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.1635, 'grad_norm': 3.682227849960327, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:41,  2.06s/it]                                               {'loss': 0.0581, 'grad_norm': 1.9447898864746094, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.06s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.0168, 'grad_norm': 0.466159462928772, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.0765, 'grad_norm': 1.656438946723938, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it]                                               {'loss': 0.1966, 'grad_norm': 4.996694087982178, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.17s/it] 60%|██████    | 24/40 [00:46<00:25,  1.58s/it]                                               {'loss': 0.0008, 'grad_norm': 0.2205498218536377, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.58s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.0602, 'grad_norm': 2.726956844329834, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it]                                               {'loss': 0.1158, 'grad_norm': 4.159273624420166, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.91s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.1012, 'grad_norm': 4.568716049194336, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.08s/it]                                               {'loss': 0.1728, 'grad_norm': 15.765308380126953, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.0749, 'grad_norm': 6.588693618774414, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.1624, 'grad_norm': 3.7334413528442383, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it]                                               {'loss': 0.2386, 'grad_norm': 4.79737663269043, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.17s/it] 80%|████████  | 32/40 [01:02<00:12,  1.58s/it]                                               {'loss': 0.0056, 'grad_norm': 0.5017485022544861, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.58s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it]                                               {'loss': 0.1302, 'grad_norm': 1.841614842414856, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.76s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.0302, 'grad_norm': 0.8555461764335632, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it]                                               {'loss': 0.0346, 'grad_norm': 1.5799891948699951, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.02s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.032, 'grad_norm': 0.7799890637397766, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.0562, 'grad_norm': 1.6874531507492065, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.0447, 'grad_norm': 2.010521173477173, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]                                               {'loss': 0.0452, 'grad_norm': 1.323915958404541, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.21s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0099, 'grad_norm': 0.7292196154594421, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 79.1969, 'train_samples_per_second': 7.134, 'train_steps_per_second': 0.505, 'train_loss': 0.48582097205799074, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]100%|██████████| 40/40 [01:19<00:00,  1.98s/it]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:49,  2.82s/it]                                              {'loss': 1.7357, 'grad_norm': 12.795112609863281, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:49,  2.82s/it]  5%|▌         | 2/40 [00:04<01:32,  2.44s/it]                                              {'loss': 1.7594, 'grad_norm': 12.478575706481934, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:32,  2.44s/it]  8%|▊         | 3/40 [00:07<01:24,  2.27s/it]                                              {'loss': 2.1755, 'grad_norm': 12.87319278717041, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:07<01:24,  2.27s/it] 10%|█         | 4/40 [00:09<01:19,  2.21s/it]                                              {'loss': 1.8781, 'grad_norm': 13.31358814239502, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:19,  2.21s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.20s/it]                                              {'loss': 1.1609, 'grad_norm': 10.711060523986816, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.20s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.9286, 'grad_norm': 13.829998970031738, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.1638, 'grad_norm': 12.28625774383545, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 0.6252, 'grad_norm': 44.793907165527344, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.75s/it]                                              {'loss': 0.4169, 'grad_norm': 6.1116557121276855, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.87s/it]                                               {'loss': 0.9491, 'grad_norm': 8.876060485839844, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.87s/it] 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it]                                               {'loss': 0.6256, 'grad_norm': 6.06876277923584, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  1.97s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.3485, 'grad_norm': 4.870906352996826, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it]                                               {'loss': 0.412, 'grad_norm': 4.200110912322998, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.09s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 1.4918, 'grad_norm': 10.503905296325684, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.14s/it]                                               {'loss': 0.686, 'grad_norm': 8.46468734741211, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.14s/it] 40%|████      | 16/40 [00:31<00:37,  1.55s/it]                                               {'loss': 2.8097, 'grad_norm': 60.77640151977539, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.55s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it]                                               {'loss': 0.4636, 'grad_norm': 8.547394752502441, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.86s/it]                                               {'loss': 0.6965, 'grad_norm': 11.197088241577148, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.86s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it]                                               {'loss': 0.1741, 'grad_norm': 3.8961470127105713, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.96s/it] 50%|█████     | 20/40 [00:40<00:40,  2.04s/it]                                               {'loss': 0.2176, 'grad_norm': 2.5205729007720947, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:40,  2.04s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.5053, 'grad_norm': 5.858343601226807, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it]                                               {'loss': 0.3961, 'grad_norm': 3.8178884983062744, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.14s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it]                                               {'loss': 0.5329, 'grad_norm': 14.280692100524902, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.16s/it] 60%|██████    | 24/40 [00:46<00:25,  1.57s/it]                                               {'loss': 0.2506, 'grad_norm': 9.742103576660156, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:25,  1.57s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.0554, 'grad_norm': 0.9764754176139832, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it]                                               {'loss': 0.1177, 'grad_norm': 1.6110074520111084, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.89s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.2192, 'grad_norm': 3.294649839401245, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.0339, 'grad_norm': 0.9189950227737427, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.11s/it]                                               {'loss': 0.1477, 'grad_norm': 1.9131628274917603, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.11s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.14s/it]                                               {'loss': 0.0755, 'grad_norm': 1.3078444004058838, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.14s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.16s/it]                                               {'loss': 0.277, 'grad_norm': 5.9276814460754395, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.16s/it] 80%|████████  | 32/40 [01:02<00:12,  1.57s/it]                                               {'loss': 0.0205, 'grad_norm': 0.9771332144737244, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.57s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.74s/it]                                               {'loss': 0.1567, 'grad_norm': 4.003961086273193, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.74s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.88s/it]                                               {'loss': 0.0379, 'grad_norm': 0.8608739376068115, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.88s/it] 88%|████████▊ | 35/40 [01:09<00:09,  1.99s/it]                                               {'loss': 0.194, 'grad_norm': 11.536230087280273, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:09,  1.99s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it]                                               {'loss': 0.6033, 'grad_norm': 11.301942825317383, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.08s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it]                                               {'loss': 0.1356, 'grad_norm': 4.352599620819092, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.13s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.14s/it]                                               {'loss': 0.0683, 'grad_norm': 1.0759546756744385, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.14s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]                                               {'loss': 0.0862, 'grad_norm': 1.7639683485031128, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.18s/it]100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'loss': 0.0063, 'grad_norm': 0.40401509404182434, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]                                               {'train_runtime': 78.8213, 'train_samples_per_second': 7.168, 'train_steps_per_second': 0.507, 'train_loss': 0.640959191613365, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.58s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:38,  2.52s/it]                                              {'loss': 2.058, 'grad_norm': 10.054213523864746, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:38,  2.52s/it]  5%|▌         | 2/40 [00:04<01:26,  2.27s/it]                                              {'loss': 1.1511, 'grad_norm': 8.629022598266602, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:26,  2.27s/it]  8%|▊         | 3/40 [00:06<01:22,  2.22s/it]                                              {'loss': 1.3175, 'grad_norm': 11.986113548278809, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:22,  2.22s/it] 10%|█         | 4/40 [00:08<01:19,  2.19s/it]                                              {'loss': 1.7122, 'grad_norm': 20.751615524291992, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:19,  2.19s/it] 12%|█▎        | 5/40 [00:11<01:15,  2.17s/it]                                              {'loss': 1.6529, 'grad_norm': 18.162673950195312, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it]                                              {'loss': 2.0357, 'grad_norm': 17.78801155090332, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:13,  2.17s/it] 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it]                                              {'loss': 2.2578, 'grad_norm': 15.424736976623535, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:11,  2.17s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 1.6571, 'grad_norm': 60.969913482666016, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it]                                              {'loss': 1.4351, 'grad_norm': 9.447793960571289, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.76s/it] 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it]                                               {'loss': 0.8963, 'grad_norm': 9.475006103515625, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:56,  1.89s/it] 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it]                                               {'loss': 0.8149, 'grad_norm': 8.508883476257324, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:57,  2.00s/it] 30%|███       | 12/40 [00:24<00:57,  2.04s/it]                                               {'loss': 0.594, 'grad_norm': 4.543751239776611, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:57,  2.04s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.4435, 'grad_norm': 5.526793956756592, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it]                                               {'loss': 0.1771, 'grad_norm': 3.2902560234069824, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:54,  2.11s/it] 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it]                                               {'loss': 0.4514, 'grad_norm': 4.261195659637451, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:30<00:53,  2.13s/it] 40%|████      | 16/40 [00:31<00:37,  1.54s/it]                                               {'loss': 0.5163, 'grad_norm': 9.385038375854492, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.54s/it] 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it]                                               {'loss': 0.3737, 'grad_norm': 7.900332450866699, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:39,  1.73s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it]                                               {'loss': 0.1835, 'grad_norm': 6.78435754776001, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.88s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it]                                               {'loss': 0.1953, 'grad_norm': 4.0761027336120605, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.98s/it] 50%|█████     | 20/40 [00:39<00:41,  2.05s/it]                                               {'loss': 0.3608, 'grad_norm': 5.9857025146484375, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:39<00:41,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it]                                               {'loss': 0.2347, 'grad_norm': 4.695294380187988, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:39,  2.10s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it]                                               {'loss': 0.4705, 'grad_norm': 4.607528209686279, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.12s/it] 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it]                                               {'loss': 0.1863, 'grad_norm': 2.3669328689575195, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:36,  2.14s/it] 60%|██████    | 24/40 [00:46<00:24,  1.56s/it]                                               {'loss': 0.1449, 'grad_norm': 5.864559650421143, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:46<00:24,  1.56s/it] 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it]                                               {'loss': 0.1829, 'grad_norm': 0.9018201231956482, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:48<00:26,  1.75s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.88s/it]                                               {'loss': 0.0952, 'grad_norm': 1.7222332954406738, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.88s/it] 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it]                                               {'loss': 0.0177, 'grad_norm': 0.40957319736480713, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:25,  1.99s/it] 70%|███████   | 28/40 [00:55<00:24,  2.07s/it]                                               {'loss': 0.3375, 'grad_norm': 4.2896881103515625, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:55<00:24,  2.07s/it] 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it]                                               {'loss': 0.0691, 'grad_norm': 1.6751697063446045, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:57<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it]                                               {'loss': 0.0585, 'grad_norm': 0.7890917062759399, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.17s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it]                                               {'loss': 0.0817, 'grad_norm': 1.8796314001083374, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.19s/it] 80%|████████  | 32/40 [01:02<00:12,  1.59s/it]                                               {'loss': 0.0, 'grad_norm': 0.0019828113727271557, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:02<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it]                                               {'loss': 0.4918, 'grad_norm': 4.421058177947998, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:04<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it]                                               {'loss': 0.1885, 'grad_norm': 3.7429568767547607, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.92s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it]                                               {'loss': 0.023, 'grad_norm': 0.7561360001564026, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.03s/it] 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it]                                               {'loss': 0.06, 'grad_norm': 1.0539591312408447, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:11<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it]                                               {'loss': 0.3996, 'grad_norm': 13.619805335998535, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:13<00:06,  2.14s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.1106, 'grad_norm': 0.8874297738075256, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]                                               {'loss': 0.0734, 'grad_norm': 1.6635326147079468, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:18<00:02,  2.20s/it]100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'loss': 0.0066, 'grad_norm': 0.6727840304374695, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]                                               {'train_runtime': 78.8025, 'train_samples_per_second': 7.17, 'train_steps_per_second': 0.508, 'train_loss': 0.5879167498727839, 'epoch': 5.0}
100%|██████████| 40/40 [01:18<00:00,  1.60s/it]100%|██████████| 40/40 [01:18<00:00,  1.97s/it]
CLIENT:96
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:35,  2.44s/it]                                              {'loss': 1.6982, 'grad_norm': 10.296331405639648, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:35,  2.44s/it]  5%|▌         | 2/40 [00:04<01:26,  2.28s/it]                                              {'loss': 1.4988, 'grad_norm': 9.662008285522461, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:26,  2.28s/it]  8%|▊         | 3/40 [00:06<01:23,  2.25s/it]                                              {'loss': 0.941, 'grad_norm': 14.4525146484375, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.25s/it] 10%|█         | 4/40 [00:09<01:21,  2.26s/it]                                              {'loss': 0.8283, 'grad_norm': 12.620841979980469, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:21,  2.26s/it] 12%|█▎        | 5/40 [00:11<01:19,  2.27s/it]                                              {'loss': 1.8178, 'grad_norm': 14.10694408416748, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:19,  2.27s/it] 15%|█▌        | 6/40 [00:13<01:16,  2.25s/it]                                              {'loss': 1.5377, 'grad_norm': 14.314239501953125, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:16,  2.25s/it] 18%|█▊        | 7/40 [00:15<01:14,  2.25s/it]                                              {'loss': 1.535, 'grad_norm': 18.606115341186523, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:14,  2.25s/it] 20%|██        | 8/40 [00:16<00:50,  1.59s/it]                                              {'loss': 0.3375, 'grad_norm': 22.10102653503418, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:16<00:50,  1.59s/it] 22%|██▎       | 9/40 [00:18<00:55,  1.79s/it]                                              {'loss': 0.5328, 'grad_norm': 5.396754264831543, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:55,  1.79s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it]                                               {'loss': 0.8591, 'grad_norm': 10.297873497009277, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.93s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it]                                               {'loss': 0.4917, 'grad_norm': 5.205046653747559, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.03s/it] 30%|███       | 12/40 [00:25<00:59,  2.11s/it]                                               {'loss': 0.1787, 'grad_norm': 2.796926498413086, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:25<00:59,  2.11s/it] 32%|███▎      | 13/40 [00:27<00:58,  2.18s/it]                                               {'loss': 0.2082, 'grad_norm': 4.204192638397217, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:27<00:58,  2.18s/it] 35%|███▌      | 14/40 [00:29<00:57,  2.22s/it]                                               {'loss': 0.2976, 'grad_norm': 10.970913887023926, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:57,  2.22s/it] 38%|███▊      | 15/40 [00:31<00:55,  2.23s/it]                                               {'loss': 0.4112, 'grad_norm': 8.810812950134277, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:55,  2.23s/it] 40%|████      | 16/40 [00:32<00:39,  1.64s/it]                                               {'loss': 0.239, 'grad_norm': 14.140172004699707, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:32<00:39,  1.64s/it] 42%|████▎     | 17/40 [00:34<00:42,  1.83s/it]                                               {'loss': 0.2144, 'grad_norm': 6.541845321655273, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:34<00:42,  1.83s/it] 45%|████▌     | 18/40 [00:36<00:43,  1.98s/it]                                               {'loss': 0.1888, 'grad_norm': 1.9602839946746826, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:43,  1.98s/it] 48%|████▊     | 19/40 [00:39<00:43,  2.07s/it]                                               {'loss': 0.1245, 'grad_norm': 1.3227969408035278, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:39<00:43,  2.07s/it] 50%|█████     | 20/40 [00:41<00:42,  2.13s/it]                                               {'loss': 0.152, 'grad_norm': 2.9442098140716553, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:41<00:42,  2.13s/it] 52%|█████▎    | 21/40 [00:43<00:41,  2.19s/it]                                               {'loss': 0.4253, 'grad_norm': 9.031268119812012, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:41,  2.19s/it] 55%|█████▌    | 22/40 [00:46<00:40,  2.23s/it]                                               {'loss': 0.2552, 'grad_norm': 6.186609268188477, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:46<00:40,  2.23s/it] 57%|█████▊    | 23/40 [00:48<00:38,  2.24s/it]                                               {'loss': 0.0742, 'grad_norm': 0.8748660683631897, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:48<00:38,  2.24s/it] 60%|██████    | 24/40 [00:48<00:26,  1.63s/it]                                               {'loss': 0.0, 'grad_norm': 0.0006997328600846231, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:48<00:26,  1.63s/it] 62%|██████▎   | 25/40 [00:50<00:27,  1.83s/it]                                               {'loss': 0.0943, 'grad_norm': 2.7773306369781494, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:50<00:27,  1.83s/it] 65%|██████▌   | 26/40 [00:53<00:27,  1.97s/it]                                               {'loss': 0.237, 'grad_norm': 3.478142738342285, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:53<00:27,  1.97s/it] 68%|██████▊   | 27/40 [00:55<00:26,  2.06s/it]                                               {'loss': 0.0592, 'grad_norm': 1.2664697170257568, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:55<00:26,  2.06s/it] 70%|███████   | 28/40 [00:57<00:25,  2.15s/it]                                               {'loss': 0.0415, 'grad_norm': 0.858725368976593, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:57<00:25,  2.15s/it] 72%|███████▎  | 29/40 [01:00<00:24,  2.20s/it]                                               {'loss': 0.1955, 'grad_norm': 3.606114149093628, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [01:00<00:24,  2.20s/it] 75%|███████▌  | 30/40 [01:02<00:22,  2.24s/it]                                               {'loss': 0.0895, 'grad_norm': 10.563517570495605, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:02<00:22,  2.24s/it] 78%|███████▊  | 31/40 [01:04<00:20,  2.27s/it]                                               {'loss': 0.1124, 'grad_norm': 2.7027201652526855, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:04<00:20,  2.27s/it] 80%|████████  | 32/40 [01:04<00:13,  1.64s/it]                                               {'loss': 0.269, 'grad_norm': 20.572277069091797, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:04<00:13,  1.64s/it] 82%|████████▎ | 33/40 [01:07<00:13,  1.86s/it]                                               {'loss': 0.0182, 'grad_norm': 0.6395981907844543, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:07<00:13,  1.86s/it] 85%|████████▌ | 34/40 [01:09<00:11,  2.00s/it]                                               {'loss': 0.0917, 'grad_norm': 1.762632131576538, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:09<00:11,  2.00s/it] 88%|████████▊ | 35/40 [01:11<00:10,  2.08s/it]                                               {'loss': 0.0611, 'grad_norm': 1.9879289865493774, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:11<00:10,  2.08s/it] 90%|█████████ | 36/40 [01:14<00:08,  2.15s/it]                                               {'loss': 0.1435, 'grad_norm': 5.03533935546875, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:14<00:08,  2.15s/it] 92%|█████████▎| 37/40 [01:16<00:06,  2.19s/it]                                               {'loss': 0.0339, 'grad_norm': 0.636747419834137, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:16<00:06,  2.19s/it] 95%|█████████▌| 38/40 [01:18<00:04,  2.24s/it]                                               {'loss': 0.0389, 'grad_norm': 0.8916186690330505, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:18<00:04,  2.24s/it] 98%|█████████▊| 39/40 [01:21<00:02,  2.26s/it]                                               {'loss': 0.1974, 'grad_norm': 9.35842514038086, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:21<00:02,  2.26s/it]100%|██████████| 40/40 [01:21<00:00,  1.64s/it]                                               {'loss': 0.026, 'grad_norm': 1.2039512395858765, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:21<00:00,  1.64s/it]                                               {'train_runtime': 81.6846, 'train_samples_per_second': 6.917, 'train_steps_per_second': 0.49, 'train_loss': 0.41390464939102, 'epoch': 5.0}
100%|██████████| 40/40 [01:21<00:00,  1.64s/it]100%|██████████| 40/40 [01:21<00:00,  2.04s/it]
CLIENT:29
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:30,  2.33s/it]                                              {'loss': 2.2122, 'grad_norm': 11.247241020202637, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:30,  2.33s/it]  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]                                              {'loss': 1.6134, 'grad_norm': 11.881474494934082, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:24,  2.23s/it]  8%|▊         | 3/40 [00:06<01:20,  2.18s/it]                                              {'loss': 1.597, 'grad_norm': 12.516461372375488, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:20,  2.18s/it] 10%|█         | 4/40 [00:08<01:18,  2.18s/it]                                              {'loss': 1.9995, 'grad_norm': 14.761773109436035, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:08<01:18,  2.18s/it] 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it]                                              {'loss': 2.234, 'grad_norm': 27.869569778442383, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:10<01:15,  2.17s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.3806, 'grad_norm': 15.795463562011719, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it]                                              {'loss': 0.7259, 'grad_norm': 8.159221649169922, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.20s/it] 20%|██        | 8/40 [00:15<00:49,  1.55s/it]                                              {'loss': 1.2625, 'grad_norm': 23.260501861572266, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.55s/it] 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it]                                              {'loss': 0.8102, 'grad_norm': 15.416165351867676, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:17<00:54,  1.75s/it] 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it]                                               {'loss': 0.6031, 'grad_norm': 11.80128002166748, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:19<00:57,  1.91s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it]                                               {'loss': 1.334, 'grad_norm': 8.261686325073242, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.00s/it] 30%|███       | 12/40 [00:24<00:58,  2.07s/it]                                               {'loss': 0.5305, 'grad_norm': 8.399419784545898, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.07s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it]                                               {'loss': 0.4022, 'grad_norm': 7.127021312713623, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.12s/it] 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it]                                               {'loss': 0.7703, 'grad_norm': 6.197059154510498, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it]                                               {'loss': 0.7797, 'grad_norm': 8.240535736083984, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.17s/it] 40%|████      | 16/40 [00:31<00:38,  1.58s/it]                                               {'loss': 0.0015, 'grad_norm': 0.14374907314777374, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.58s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.5753, 'grad_norm': 7.388337135314941, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it]                                               {'loss': 0.5625, 'grad_norm': 5.30808687210083, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:41,  1.90s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.2242, 'grad_norm': 2.754216432571411, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:41,  2.07s/it]                                               {'loss': 0.2104, 'grad_norm': 2.80466365814209, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:41,  2.07s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it]                                               {'loss': 0.3155, 'grad_norm': 3.4931280612945557, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.13s/it] 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it]                                               {'loss': 0.2835, 'grad_norm': 4.816847324371338, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:39,  2.17s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.0255, 'grad_norm': 0.5921922922134399, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.60s/it]                                               {'loss': 0.0609, 'grad_norm': 1.6701475381851196, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.60s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it]                                               {'loss': 0.1667, 'grad_norm': 3.5711607933044434, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.78s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.2234, 'grad_norm': 2.1719303131103516, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it]                                               {'loss': 0.1503, 'grad_norm': 1.2885860204696655, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.03s/it] 70%|███████   | 28/40 [00:56<00:25,  2.10s/it]                                               {'loss': 0.1575, 'grad_norm': 1.552868366241455, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.10s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it]                                               {'loss': 0.1624, 'grad_norm': 2.896681547164917, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.15s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it]                                               {'loss': 0.0205, 'grad_norm': 0.6700569987297058, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it]                                               {'loss': 0.6948, 'grad_norm': 2.799959659576416, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.20s/it] 80%|████████  | 32/40 [01:03<00:12,  1.59s/it]                                               {'loss': 0.1131, 'grad_norm': 4.100358486175537, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.59s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it]                                               {'loss': 0.7665, 'grad_norm': 3.2068464756011963, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.78s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it]                                               {'loss': 0.0679, 'grad_norm': 1.7674241065979004, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.93s/it] 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it]                                               {'loss': 0.0596, 'grad_norm': 1.506539225578308, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:09<00:10,  2.01s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it]                                               {'loss': 0.0137, 'grad_norm': 0.32409512996673584, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.09s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0218, 'grad_norm': 0.6065347790718079, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it]                                               {'loss': 0.0432, 'grad_norm': 1.327201008796692, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.1095, 'grad_norm': 0.8148067593574524, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'loss': 0.0313, 'grad_norm': 3.0264053344726562, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]                                               {'train_runtime': 79.573, 'train_samples_per_second': 7.1, 'train_steps_per_second': 0.503, 'train_loss': 0.5829149554978358, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.61s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
CLIENT:86
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:34,  2.42s/it]                                              {'loss': 1.8491, 'grad_norm': 10.268799781799316, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:34,  2.42s/it]  5%|▌         | 2/40 [00:04<01:26,  2.28s/it]                                              {'loss': 2.3161, 'grad_norm': 14.360001564025879, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:26,  2.28s/it]  8%|▊         | 3/40 [00:06<01:23,  2.26s/it]                                              {'loss': 1.5113, 'grad_norm': 13.391589164733887, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:23,  2.26s/it] 10%|█         | 4/40 [00:09<01:20,  2.23s/it]                                              {'loss': 1.6623, 'grad_norm': 16.857006072998047, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:20,  2.23s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 0.9207, 'grad_norm': 9.84013557434082, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it]                                              {'loss': 1.2901, 'grad_norm': 10.699353218078613, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.20s/it] 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it]                                              {'loss': 1.1685, 'grad_norm': 9.782772064208984, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:13,  2.22s/it] 20%|██        | 8/40 [00:15<00:50,  1.57s/it]                                              {'loss': 4.8438, 'grad_norm': 88.58592987060547, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:50,  1.57s/it] 22%|██▎       | 9/40 [00:18<00:54,  1.77s/it]                                              {'loss': 0.8044, 'grad_norm': 6.804013729095459, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:54,  1.77s/it] 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it]                                               {'loss': 0.1685, 'grad_norm': 2.0999770164489746, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:57,  1.92s/it] 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it]                                               {'loss': 0.2889, 'grad_norm': 3.6000659465789795, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:58,  2.01s/it] 30%|███       | 12/40 [00:24<00:58,  2.08s/it]                                               {'loss': 0.2593, 'grad_norm': 3.6378071308135986, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:58,  2.08s/it] 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it]                                               {'loss': 0.4168, 'grad_norm': 4.81632661819458, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:57,  2.13s/it] 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it]                                               {'loss': 0.1387, 'grad_norm': 1.6782073974609375, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:29<00:56,  2.16s/it] 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it]                                               {'loss': 0.1881, 'grad_norm': 4.0201191902160645, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:54,  2.20s/it] 40%|████      | 16/40 [00:31<00:38,  1.59s/it]                                               {'loss': 0.021, 'grad_norm': 1.0791511535644531, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:38,  1.59s/it] 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it]                                               {'loss': 0.33, 'grad_norm': 3.120210886001587, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:41,  1.79s/it] 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it]                                               {'loss': 0.0339, 'grad_norm': 0.532733142375946, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:36<00:42,  1.94s/it] 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it]                                               {'loss': 0.148, 'grad_norm': 5.445237159729004, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:42,  2.04s/it] 50%|█████     | 20/40 [00:40<00:42,  2.11s/it]                                               {'loss': 0.4133, 'grad_norm': 7.457286357879639, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:42,  2.11s/it] 52%|█████▎    | 21/40 [00:43<00:41,  2.16s/it]                                               {'loss': 0.2643, 'grad_norm': 5.942070484161377, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:43<00:41,  2.16s/it] 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it]                                               {'loss': 0.1238, 'grad_norm': 1.7878601551055908, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:45<00:39,  2.19s/it] 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it]                                               {'loss': 0.27, 'grad_norm': 1.303013563156128, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:47<00:37,  2.20s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.041, 'grad_norm': 0.9941496849060059, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it]                                               {'loss': 0.064, 'grad_norm': 1.3235834836959839, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.80s/it] 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it]                                               {'loss': 0.2488, 'grad_norm': 3.3633430004119873, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:52<00:27,  1.94s/it] 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it]                                               {'loss': 0.095, 'grad_norm': 3.642822504043579, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:54<00:26,  2.05s/it] 70%|███████   | 28/40 [00:56<00:25,  2.12s/it]                                               {'loss': 0.0188, 'grad_norm': 0.27987855672836304, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:25,  2.12s/it] 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it]                                               {'loss': 0.0227, 'grad_norm': 0.4430665969848633, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:59<00:23,  2.18s/it] 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it]                                               {'loss': 0.0573, 'grad_norm': 2.2139971256256104, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:01<00:21,  2.19s/it] 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it]                                               {'loss': 0.0426, 'grad_norm': 0.7193801999092102, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:03<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:12,  1.61s/it]                                               {'loss': 0.0236, 'grad_norm': 0.6396401524543762, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:12,  1.61s/it] 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it]                                               {'loss': 0.0539, 'grad_norm': 1.4706130027770996, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:06<00:12,  1.81s/it] 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it]                                               {'loss': 0.0132, 'grad_norm': 0.3238106369972229, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:08<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it]                                               {'loss': 0.0761, 'grad_norm': 1.9993261098861694, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.06s/it] 90%|█████████ | 36/40 [01:13<00:08,  2.14s/it]                                               {'loss': 0.1497, 'grad_norm': 7.254427909851074, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:13<00:08,  2.14s/it] 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it]                                               {'loss': 0.0732, 'grad_norm': 1.3727844953536987, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:15<00:06,  2.18s/it] 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it]                                               {'loss': 0.0624, 'grad_norm': 1.248034119606018, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:17<00:04,  2.20s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]                                               {'loss': 0.0948, 'grad_norm': 5.0559916496276855, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.20s/it]100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'loss': 0.0025, 'grad_norm': 0.19473673403263092, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.60s/it]                                               {'train_runtime': 80.2349, 'train_samples_per_second': 7.042, 'train_steps_per_second': 0.499, 'train_loss': 0.5142580348125193, 'epoch': 5.0}
100%|██████████| 40/40 [01:20<00:00,  1.60s/it]100%|██████████| 40/40 [01:20<00:00,  2.01s/it]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:354: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:40,  2.59s/it]                                              {'loss': 1.3227, 'grad_norm': 8.045778274536133, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:40,  2.59s/it]  5%|▌         | 2/40 [00:04<01:29,  2.35s/it]                                              {'loss': 1.4623, 'grad_norm': 10.89257526397705, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:04<01:29,  2.35s/it]  8%|▊         | 3/40 [00:06<01:24,  2.28s/it]                                              {'loss': 1.8802, 'grad_norm': 12.080748558044434, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:06<01:24,  2.28s/it] 10%|█         | 4/40 [00:09<01:21,  2.26s/it]                                              {'loss': 2.1022, 'grad_norm': 21.288969039916992, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:09<01:21,  2.26s/it] 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it]                                              {'loss': 0.5315, 'grad_norm': 5.511421203613281, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:11<01:17,  2.22s/it] 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it]                                              {'loss': 1.6165, 'grad_norm': 14.424226760864258, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:13<01:14,  2.19s/it] 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it]                                              {'loss': 1.2648, 'grad_norm': 14.342756271362305, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:15<01:12,  2.19s/it] 20%|██        | 8/40 [00:15<00:49,  1.56s/it]                                              {'loss': 3.5991, 'grad_norm': 66.26825714111328, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:15<00:49,  1.56s/it] 22%|██▎       | 9/40 [00:18<00:53,  1.74s/it]                                              {'loss': 0.2837, 'grad_norm': 6.44277286529541, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:18<00:53,  1.74s/it] 25%|██▌       | 10/40 [00:20<00:55,  1.86s/it]                                               {'loss': 0.6243, 'grad_norm': 5.335361480712891, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:20<00:55,  1.86s/it] 28%|██▊       | 11/40 [00:22<00:56,  1.94s/it]                                               {'loss': 0.9021, 'grad_norm': 3.8121111392974854, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:22<00:56,  1.94s/it] 30%|███       | 12/40 [00:24<00:56,  2.03s/it]                                               {'loss': 0.3378, 'grad_norm': 6.567391395568848, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:24<00:56,  2.03s/it] 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it]                                               {'loss': 0.8412, 'grad_norm': 5.16287899017334, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:26<00:56,  2.08s/it] 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it]                                               {'loss': 0.1208, 'grad_norm': 6.915889739990234, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:28<00:55,  2.12s/it] 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it]                                               {'loss': 0.7125, 'grad_norm': 8.090432167053223, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:31<00:53,  2.15s/it] 40%|████      | 16/40 [00:31<00:37,  1.57s/it]                                               {'loss': 0.8191, 'grad_norm': 32.75575256347656, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:31<00:37,  1.57s/it] 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it]                                               {'loss': 0.6458, 'grad_norm': 10.851444244384766, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:33<00:40,  1.78s/it] 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it]                                               {'loss': 0.649, 'grad_norm': 6.26575231552124, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:35<00:42,  1.92s/it] 48%|████▊     | 19/40 [00:37<00:41,  1.99s/it]                                               {'loss': 0.4914, 'grad_norm': 4.666148662567139, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:38<00:41,  1.99s/it] 50%|█████     | 20/40 [00:40<00:40,  2.05s/it]                                               {'loss': 0.4184, 'grad_norm': 5.626253128051758, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:40<00:40,  2.05s/it] 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it]                                               {'loss': 0.2061, 'grad_norm': 1.4079928398132324, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:42<00:40,  2.11s/it] 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it]                                               {'loss': 0.0739, 'grad_norm': 1.5632964372634888, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:44<00:38,  2.15s/it] 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it]                                               {'loss': 0.1217, 'grad_norm': 1.0362908840179443, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:46<00:37,  2.18s/it] 60%|██████    | 24/40 [00:47<00:25,  1.59s/it]                                               {'loss': 0.0022, 'grad_norm': 0.11525119841098785, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:47<00:25,  1.59s/it] 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it]                                               {'loss': 0.2763, 'grad_norm': 1.3459826707839966, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:49<00:26,  1.77s/it] 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it]                                               {'loss': 0.1294, 'grad_norm': 1.3990023136138916, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:51<00:26,  1.93s/it] 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it]                                               {'loss': 0.4568, 'grad_norm': 3.791109800338745, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:53<00:26,  2.01s/it] 70%|███████   | 28/40 [00:56<00:24,  2.08s/it]                                               {'loss': 0.0829, 'grad_norm': 1.424141764640808, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:56<00:24,  2.08s/it] 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it]                                               {'loss': 0.273, 'grad_norm': 6.2093377113342285, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:58<00:23,  2.13s/it] 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it]                                               {'loss': 0.2205, 'grad_norm': 1.4779155254364014, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [01:00<00:21,  2.16s/it] 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it]                                               {'loss': 0.0576, 'grad_norm': 0.934040367603302, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [01:02<00:19,  2.22s/it] 80%|████████  | 32/40 [01:03<00:13,  1.64s/it]                                               {'loss': 0.0951, 'grad_norm': 5.510919570922852, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [01:03<00:13,  1.64s/it] 82%|████████▎ | 33/40 [01:05<00:12,  1.83s/it]                                               {'loss': 0.0316, 'grad_norm': 0.9432814717292786, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [01:05<00:12,  1.83s/it] 85%|████████▌ | 34/40 [01:07<00:11,  1.96s/it]                                               {'loss': 0.0669, 'grad_norm': 3.3215537071228027, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [01:07<00:11,  1.96s/it] 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it]                                               {'loss': 0.0355, 'grad_norm': 0.9203288555145264, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [01:10<00:10,  2.05s/it] 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it]                                               {'loss': 1.2789, 'grad_norm': 12.174758911132812, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [01:12<00:08,  2.10s/it] 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it]                                               {'loss': 0.0722, 'grad_norm': 4.665460109710693, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [01:14<00:06,  2.15s/it] 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it]                                               {'loss': 0.6913, 'grad_norm': 7.125102519989014, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [01:16<00:04,  2.18s/it] 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]                                               {'loss': 0.6422, 'grad_norm': 5.238376140594482, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [01:19<00:02,  2.22s/it]100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'loss': 0.045, 'grad_norm': 1.5671144723892212, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]                                               {'train_runtime': 79.7017, 'train_samples_per_second': 7.089, 'train_steps_per_second': 0.502, 'train_loss': 0.6371137326641474, 'epoch': 5.0}
100%|██████████| 40/40 [01:19<00:00,  1.62s/it]100%|██████████| 40/40 [01:19<00:00,  1.99s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:389: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:01<04:57,  1.58it/s]  1%|          | 3/471 [00:02<06:59,  1.11it/s]  1%|          | 4/471 [00:03<08:05,  1.04s/it]  1%|          | 5/471 [00:05<08:42,  1.12s/it]  1%|▏         | 6/471 [00:06<09:04,  1.17s/it]  1%|▏         | 7/471 [00:07<09:19,  1.21s/it]  2%|▏         | 8/471 [00:08<09:29,  1.23s/it]  2%|▏         | 9/471 [00:10<09:35,  1.24s/it]  2%|▏         | 10/471 [00:11<09:39,  1.26s/it]  2%|▏         | 11/471 [00:12<09:41,  1.26s/it]  3%|▎         | 12/471 [00:14<09:43,  1.27s/it]  3%|▎         | 13/471 [00:15<09:45,  1.28s/it]  3%|▎         | 14/471 [00:16<09:45,  1.28s/it]  3%|▎         | 15/471 [00:17<09:45,  1.28s/it]  3%|▎         | 16/471 [00:19<09:46,  1.29s/it]  4%|▎         | 17/471 [00:20<09:45,  1.29s/it]  4%|▍         | 18/471 [00:21<09:45,  1.29s/it]  4%|▍         | 19/471 [00:23<09:44,  1.29s/it]  4%|▍         | 20/471 [00:24<09:44,  1.29s/it]  4%|▍         | 21/471 [00:25<09:43,  1.30s/it]  5%|▍         | 22/471 [00:27<09:42,  1.30s/it]  5%|▍         | 23/471 [00:28<09:41,  1.30s/it]  5%|▌         | 24/471 [00:29<09:41,  1.30s/it]  5%|▌         | 25/471 [00:30<09:40,  1.30s/it]  6%|▌         | 26/471 [00:32<09:39,  1.30s/it]  6%|▌         | 27/471 [00:33<09:38,  1.30s/it]  6%|▌         | 28/471 [00:34<09:37,  1.30s/it]  6%|▌         | 29/471 [00:36<09:37,  1.31s/it]  6%|▋         | 30/471 [00:37<09:37,  1.31s/it]  7%|▋         | 31/471 [00:38<09:35,  1.31s/it]  7%|▋         | 32/471 [00:40<09:34,  1.31s/it]  7%|▋         | 33/471 [00:41<09:32,  1.31s/it]  7%|▋         | 34/471 [00:42<09:31,  1.31s/it]  7%|▋         | 35/471 [00:44<09:30,  1.31s/it]  8%|▊         | 36/471 [00:45<09:29,  1.31s/it]  8%|▊         | 37/471 [00:46<09:29,  1.31s/it]  8%|▊         | 38/471 [00:47<09:29,  1.31s/it]  8%|▊         | 39/471 [00:49<09:27,  1.31s/it]  8%|▊         | 40/471 [00:50<09:26,  1.31s/it]  9%|▊         | 41/471 [00:51<09:25,  1.32s/it]  9%|▉         | 42/471 [00:53<09:25,  1.32s/it]  9%|▉         | 43/471 [00:54<09:23,  1.32s/it]  9%|▉         | 44/471 [00:55<09:22,  1.32s/it] 10%|▉         | 45/471 [00:57<09:22,  1.32s/it] 10%|▉         | 46/471 [00:58<09:21,  1.32s/it] 10%|▉         | 47/471 [00:59<09:19,  1.32s/it] 10%|█         | 48/471 [01:01<09:19,  1.32s/it] 10%|█         | 49/471 [01:02<09:18,  1.32s/it] 11%|█         | 50/471 [01:03<09:17,  1.32s/it] 11%|█         | 51/471 [01:05<09:17,  1.33s/it] 11%|█         | 52/471 [01:06<09:16,  1.33s/it] 11%|█▏        | 53/471 [01:07<09:15,  1.33s/it] 11%|█▏        | 54/471 [01:09<09:15,  1.33s/it] 12%|█▏        | 55/471 [01:10<09:13,  1.33s/it] 12%|█▏        | 56/471 [01:11<09:13,  1.33s/it] 12%|█▏        | 57/471 [01:13<09:12,  1.33s/it] 12%|█▏        | 58/471 [01:14<09:10,  1.33s/it] 13%|█▎        | 59/471 [01:15<09:09,  1.33s/it] 13%|█▎        | 60/471 [01:17<09:08,  1.33s/it] 13%|█▎        | 61/471 [01:18<09:07,  1.34s/it] 13%|█▎        | 62/471 [01:19<09:06,  1.34s/it] 13%|█▎        | 63/471 [01:21<09:04,  1.33s/it] 14%|█▎        | 64/471 [01:22<09:03,  1.34s/it] 14%|█▍        | 65/471 [01:23<09:02,  1.34s/it] 14%|█▍        | 66/471 [01:25<09:01,  1.34s/it] 14%|█▍        | 67/471 [01:26<09:00,  1.34s/it] 14%|█▍        | 68/471 [01:27<08:59,  1.34s/it] 15%|█▍        | 69/471 [01:29<08:58,  1.34s/it] 15%|█▍        | 70/471 [01:30<08:58,  1.34s/it] 15%|█▌        | 71/471 [01:31<08:57,  1.34s/it] 15%|█▌        | 72/471 [01:33<08:56,  1.34s/it] 15%|█▌        | 73/471 [01:34<08:55,  1.35s/it] 16%|█▌        | 74/471 [01:35<08:53,  1.34s/it] 16%|█▌        | 75/471 [01:37<08:52,  1.35s/it] 16%|█▌        | 76/471 [01:38<08:51,  1.34s/it] 16%|█▋        | 77/471 [01:39<08:50,  1.35s/it] 17%|█▋        | 78/471 [01:41<08:48,  1.35s/it] 17%|█▋        | 79/471 [01:42<08:48,  1.35s/it] 17%|█▋        | 80/471 [01:44<08:46,  1.35s/it] 17%|█▋        | 81/471 [01:45<08:44,  1.35s/it] 17%|█▋        | 82/471 [01:46<08:43,  1.35s/it] 18%|█▊        | 83/471 [01:48<08:42,  1.35s/it] 18%|█▊        | 84/471 [01:49<08:40,  1.35s/it] 18%|█▊        | 85/471 [01:50<08:40,  1.35s/it] 18%|█▊        | 86/471 [01:52<08:38,  1.35s/it] 18%|█▊        | 87/471 [01:53<08:36,  1.35s/it] 19%|█▊        | 88/471 [01:54<08:34,  1.34s/it] 19%|█▉        | 89/471 [01:56<08:33,  1.34s/it] 19%|█▉        | 90/471 [01:57<08:32,  1.34s/it] 19%|█▉        | 91/471 [01:58<08:30,  1.34s/it] 20%|█▉        | 92/471 [02:00<08:29,  1.34s/it] 20%|█▉        | 93/471 [02:01<08:28,  1.35s/it] 20%|█▉        | 94/471 [02:02<08:26,  1.34s/it] 20%|██        | 95/471 [02:04<08:25,  1.34s/it] 20%|██        | 96/471 [02:05<08:23,  1.34s/it] 21%|██        | 97/471 [02:06<08:22,  1.34s/it] 21%|██        | 98/471 [02:08<08:21,  1.34s/it] 21%|██        | 99/471 [02:09<08:20,  1.34s/it] 21%|██        | 100/471 [02:10<08:18,  1.34s/it] 21%|██▏       | 101/471 [02:12<08:17,  1.35s/it] 22%|██▏       | 102/471 [02:13<08:16,  1.35s/it] 22%|██▏       | 103/471 [02:14<08:16,  1.35s/it] 22%|██▏       | 104/471 [02:16<08:16,  1.35s/it] 22%|██▏       | 105/471 [02:17<08:14,  1.35s/it] 23%|██▎       | 106/471 [02:18<08:12,  1.35s/it] 23%|██▎       | 107/471 [02:20<08:10,  1.35s/it] 23%|██▎       | 108/471 [02:21<08:09,  1.35s/it] 23%|██▎       | 109/471 [02:23<08:06,  1.35s/it] 23%|██▎       | 110/471 [02:24<08:05,  1.34s/it] 24%|██▎       | 111/471 [02:25<08:04,  1.35s/it] 24%|██▍       | 112/471 [02:27<08:03,  1.35s/it] 24%|██▍       | 113/471 [02:28<08:01,  1.34s/it] 24%|██▍       | 114/471 [02:29<08:00,  1.35s/it] 24%|██▍       | 115/471 [02:31<07:59,  1.35s/it] 25%|██▍       | 116/471 [02:32<07:57,  1.35s/it] 25%|██▍       | 117/471 [02:33<07:56,  1.35s/it] 25%|██▌       | 118/471 [02:35<07:55,  1.35s/it] 25%|██▌       | 119/471 [02:36<07:54,  1.35s/it] 25%|██▌       | 120/471 [02:37<07:53,  1.35s/it] 26%|██▌       | 121/471 [02:39<07:51,  1.35s/it] 26%|██▌       | 122/471 [02:40<07:50,  1.35s/it] 26%|██▌       | 123/471 [02:41<07:49,  1.35s/it] 26%|██▋       | 124/471 [02:43<07:48,  1.35s/it] 27%|██▋       | 125/471 [02:44<07:46,  1.35s/it] 27%|██▋       | 126/471 [02:45<07:45,  1.35s/it] 27%|██▋       | 127/471 [02:47<07:43,  1.35s/it] 27%|██▋       | 128/471 [02:48<07:41,  1.35s/it] 27%|██▋       | 129/471 [02:49<07:40,  1.35s/it] 28%|██▊       | 130/471 [02:51<07:38,  1.35s/it] 28%|██▊       | 131/471 [02:52<07:37,  1.35s/it] 28%|██▊       | 132/471 [02:54<07:36,  1.35s/it] 28%|██▊       | 133/471 [02:55<07:34,  1.34s/it] 28%|██▊       | 134/471 [02:56<07:33,  1.35s/it] 29%|██▊       | 135/471 [02:58<07:31,  1.35s/it] 29%|██▉       | 136/471 [02:59<07:30,  1.34s/it] 29%|██▉       | 137/471 [03:00<07:28,  1.34s/it] 29%|██▉       | 138/471 [03:02<07:27,  1.34s/it] 30%|██▉       | 139/471 [03:03<07:25,  1.34s/it] 30%|██▉       | 140/471 [03:04<07:23,  1.34s/it] 30%|██▉       | 141/471 [03:06<07:22,  1.34s/it] 30%|███       | 142/471 [03:07<07:20,  1.34s/it] 30%|███       | 143/471 [03:08<07:19,  1.34s/it] 31%|███       | 144/471 [03:10<07:18,  1.34s/it] 31%|███       | 145/471 [03:11<07:17,  1.34s/it] 31%|███       | 146/471 [03:12<07:16,  1.34s/it] 31%|███       | 147/471 [03:14<07:15,  1.34s/it] 31%|███▏      | 148/471 [03:15<07:13,  1.34s/it] 32%|███▏      | 149/471 [03:16<07:12,  1.34s/it] 32%|███▏      | 150/471 [03:18<07:10,  1.34s/it] 32%|███▏      | 151/471 [03:19<07:09,  1.34s/it] 32%|███▏      | 152/471 [03:20<07:07,  1.34s/it] 32%|███▏      | 153/471 [03:22<07:06,  1.34s/it] 33%|███▎      | 154/471 [03:23<07:03,  1.34s/it] 33%|███▎      | 155/471 [03:24<07:02,  1.34s/it] 33%|███▎      | 156/471 [03:26<07:00,  1.33s/it] 33%|███▎      | 157/471 [03:27<06:58,  1.33s/it] 34%|███▎      | 158/471 [03:28<06:56,  1.33s/it] 34%|███▍      | 159/471 [03:30<06:54,  1.33s/it] 34%|███▍      | 160/471 [03:31<06:54,  1.33s/it] 34%|███▍      | 161/471 [03:32<06:52,  1.33s/it] 34%|███▍      | 162/471 [03:34<06:51,  1.33s/it] 35%|███▍      | 163/471 [03:35<06:50,  1.33s/it] 35%|███▍      | 164/471 [03:36<06:49,  1.33s/it] 35%|███▌      | 165/471 [03:38<06:48,  1.33s/it] 35%|███▌      | 166/471 [03:39<06:47,  1.34s/it] 35%|███▌      | 167/471 [03:40<06:46,  1.34s/it] 36%|███▌      | 168/471 [03:42<06:44,  1.34s/it] 36%|███▌      | 169/471 [03:43<06:43,  1.34s/it] 36%|███▌      | 170/471 [03:44<06:42,  1.34s/it] 36%|███▋      | 171/471 [03:46<06:40,  1.33s/it] 37%|███▋      | 172/471 [03:47<06:38,  1.33s/it] 37%|███▋      | 173/471 [03:48<06:37,  1.33s/it] 37%|███▋      | 174/471 [03:50<06:36,  1.33s/it] 37%|███▋      | 175/471 [03:51<06:34,  1.33s/it] 37%|███▋      | 176/471 [03:52<06:32,  1.33s/it] 38%|███▊      | 177/471 [03:54<06:31,  1.33s/it] 38%|███▊      | 178/471 [03:55<06:30,  1.33s/it] 38%|███▊      | 179/471 [03:56<06:28,  1.33s/it] 38%|███▊      | 180/471 [03:58<06:26,  1.33s/it] 38%|███▊      | 181/471 [03:59<06:25,  1.33s/it] 39%|███▊      | 182/471 [04:00<06:24,  1.33s/it] 39%|███▉      | 183/471 [04:02<06:23,  1.33s/it] 39%|███▉      | 184/471 [04:03<06:21,  1.33s/it] 39%|███▉      | 185/471 [04:04<06:20,  1.33s/it] 39%|███▉      | 186/471 [04:06<06:19,  1.33s/it] 40%|███▉      | 187/471 [04:07<06:18,  1.33s/it] 40%|███▉      | 188/471 [04:08<06:17,  1.33s/it] 40%|████      | 189/471 [04:10<06:14,  1.33s/it] 40%|████      | 190/471 [04:11<06:13,  1.33s/it] 41%|████      | 191/471 [04:12<06:13,  1.33s/it] 41%|████      | 192/471 [04:14<06:11,  1.33s/it] 41%|████      | 193/471 [04:15<06:09,  1.33s/it] 41%|████      | 194/471 [04:16<06:08,  1.33s/it] 41%|████▏     | 195/471 [04:18<06:07,  1.33s/it] 42%|████▏     | 196/471 [04:19<06:05,  1.33s/it] 42%|████▏     | 197/471 [04:20<06:03,  1.32s/it] 42%|████▏     | 198/471 [04:22<06:01,  1.32s/it] 42%|████▏     | 199/471 [04:23<06:00,  1.33s/it] 42%|████▏     | 200/471 [04:24<05:59,  1.33s/it] 43%|████▎     | 201/471 [04:26<05:57,  1.32s/it] 43%|████▎     | 202/471 [04:27<05:56,  1.33s/it] 43%|████▎     | 203/471 [04:28<05:55,  1.33s/it] 43%|████▎     | 204/471 [04:30<05:54,  1.33s/it] 44%|████▎     | 205/471 [04:31<05:53,  1.33s/it] 44%|████▎     | 206/471 [04:32<05:51,  1.33s/it] 44%|████▍     | 207/471 [04:34<05:50,  1.33s/it] 44%|████▍     | 208/471 [04:35<05:48,  1.33s/it] 44%|████▍     | 209/471 [04:36<05:46,  1.32s/it] 45%|████▍     | 210/471 [04:37<05:45,  1.32s/it] 45%|████▍     | 211/471 [04:39<05:44,  1.33s/it] 45%|████▌     | 212/471 [04:40<05:43,  1.33s/it] 45%|████▌     | 213/471 [04:41<05:42,  1.33s/it] 45%|████▌     | 214/471 [04:43<05:40,  1.33s/it] 46%|████▌     | 215/471 [04:44<05:39,  1.33s/it] 46%|████▌     | 216/471 [04:45<05:38,  1.33s/it] 46%|████▌     | 217/471 [04:47<05:37,  1.33s/it] 46%|████▋     | 218/471 [04:48<05:36,  1.33s/it] 46%|████▋     | 219/471 [04:49<05:34,  1.33s/it] 47%|████▋     | 220/471 [04:51<05:33,  1.33s/it] 47%|████▋     | 221/471 [04:52<05:32,  1.33s/it] 47%|████▋     | 222/471 [04:53<05:30,  1.33s/it] 47%|████▋     | 223/471 [04:55<05:28,  1.33s/it] 48%|████▊     | 224/471 [04:56<05:27,  1.33s/it] 48%|████▊     | 225/471 [04:57<05:26,  1.33s/it] 48%|████▊     | 226/471 [04:59<05:25,  1.33s/it] 48%|████▊     | 227/471 [05:00<05:23,  1.33s/it] 48%|████▊     | 228/471 [05:01<05:22,  1.33s/it] 49%|████▊     | 229/471 [05:03<05:21,  1.33s/it] 49%|████▉     | 230/471 [05:04<05:19,  1.33s/it] 49%|████▉     | 231/471 [05:05<05:18,  1.33s/it] 49%|████▉     | 232/471 [05:07<05:16,  1.32s/it] 49%|████▉     | 233/471 [05:08<05:15,  1.32s/it] 50%|████▉     | 234/471 [05:09<05:14,  1.33s/it] 50%|████▉     | 235/471 [05:11<05:13,  1.33s/it] 50%|█████     | 236/471 [05:12<05:11,  1.32s/it] 50%|█████     | 237/471 [05:13<05:09,  1.32s/it] 51%|█████     | 238/471 [05:15<05:08,  1.32s/it] 51%|█████     | 239/471 [05:16<05:07,  1.32s/it] 51%|█████     | 240/471 [05:17<05:05,  1.32s/it] 51%|█████     | 241/471 [05:19<05:04,  1.33s/it] 51%|█████▏    | 242/471 [05:20<05:03,  1.32s/it] 52%|█████▏    | 243/471 [05:21<05:02,  1.33s/it] 52%|█████▏    | 244/471 [05:23<05:01,  1.33s/it] 52%|█████▏    | 245/471 [05:24<04:59,  1.33s/it] 52%|█████▏    | 246/471 [05:25<04:58,  1.33s/it] 52%|█████▏    | 247/471 [05:27<04:56,  1.32s/it] 53%|█████▎    | 248/471 [05:28<04:55,  1.32s/it] 53%|█████▎    | 249/471 [05:29<04:54,  1.33s/it] 53%|█████▎    | 250/471 [05:31<04:52,  1.33s/it] 53%|█████▎    | 251/471 [05:32<04:51,  1.32s/it] 54%|█████▎    | 252/471 [05:33<04:49,  1.32s/it] 54%|█████▎    | 253/471 [05:35<04:48,  1.32s/it] 54%|█████▍    | 254/471 [05:36<04:47,  1.33s/it] 54%|█████▍    | 255/471 [05:37<04:45,  1.32s/it] 54%|█████▍    | 256/471 [05:38<04:44,  1.32s/it] 55%|█████▍    | 257/471 [05:40<04:43,  1.32s/it] 55%|█████▍    | 258/471 [05:41<04:42,  1.33s/it] 55%|█████▍    | 259/471 [05:42<04:41,  1.33s/it] 55%|█████▌    | 260/471 [05:44<04:40,  1.33s/it] 55%|█████▌    | 261/471 [05:45<04:38,  1.33s/it] 56%|█████▌    | 262/471 [05:46<04:37,  1.33s/it] 56%|█████▌    | 263/471 [05:48<04:35,  1.33s/it] 56%|█████▌    | 264/471 [05:49<04:34,  1.33s/it] 56%|█████▋    | 265/471 [05:50<04:33,  1.33s/it] 56%|█████▋    | 266/471 [05:52<04:32,  1.33s/it] 57%|█████▋    | 267/471 [05:53<04:31,  1.33s/it] 57%|█████▋    | 268/471 [05:54<04:30,  1.33s/it] 57%|█████▋    | 269/471 [05:56<04:28,  1.33s/it] 57%|█████▋    | 270/471 [05:57<04:27,  1.33s/it] 58%|█████▊    | 271/471 [05:58<04:25,  1.33s/it] 58%|█████▊    | 272/471 [06:00<04:24,  1.33s/it] 58%|█████▊    | 273/471 [06:01<04:22,  1.33s/it] 58%|█████▊    | 274/471 [06:02<04:21,  1.33s/it] 58%|█████▊    | 275/471 [06:04<04:20,  1.33s/it] 59%|█████▊    | 276/471 [06:05<04:18,  1.33s/it] 59%|█████▉    | 277/471 [06:06<04:17,  1.33s/it] 59%|█████▉    | 278/471 [06:08<04:16,  1.33s/it] 59%|█████▉    | 279/471 [06:09<04:15,  1.33s/it] 59%|█████▉    | 280/471 [06:10<04:13,  1.33s/it] 60%|█████▉    | 281/471 [06:12<04:12,  1.33s/it] 60%|█████▉    | 282/471 [06:13<04:11,  1.33s/it] 60%|██████    | 283/471 [06:14<04:10,  1.33s/it] 60%|██████    | 284/471 [06:16<04:08,  1.33s/it] 61%|██████    | 285/471 [06:17<04:07,  1.33s/it] 61%|██████    | 286/471 [06:18<04:06,  1.33s/it] 61%|██████    | 287/471 [06:20<04:05,  1.33s/it] 61%|██████    | 288/471 [06:21<04:04,  1.33s/it] 61%|██████▏   | 289/471 [06:22<04:02,  1.33s/it] 62%|██████▏   | 290/471 [06:24<04:01,  1.33s/it] 62%|██████▏   | 291/471 [06:25<04:00,  1.33s/it] 62%|██████▏   | 292/471 [06:26<03:58,  1.33s/it] 62%|██████▏   | 293/471 [06:28<03:57,  1.33s/it] 62%|██████▏   | 294/471 [06:29<03:55,  1.33s/it] 63%|██████▎   | 295/471 [06:30<03:54,  1.33s/it] 63%|██████▎   | 296/471 [06:32<03:53,  1.33s/it] 63%|██████▎   | 297/471 [06:33<03:51,  1.33s/it] 63%|██████▎   | 298/471 [06:34<03:51,  1.34s/it] 63%|██████▎   | 299/471 [06:36<03:49,  1.34s/it] 64%|██████▎   | 300/471 [06:37<03:48,  1.34s/it] 64%|██████▍   | 301/471 [06:38<03:47,  1.34s/it] 64%|██████▍   | 302/471 [06:40<03:45,  1.34s/it] 64%|██████▍   | 303/471 [06:41<03:44,  1.33s/it] 65%|██████▍   | 304/471 [06:42<03:42,  1.33s/it] 65%|██████▍   | 305/471 [06:44<03:41,  1.33s/it] 65%|██████▍   | 306/471 [06:45<03:40,  1.34s/it] 65%|██████▌   | 307/471 [06:46<03:39,  1.34s/it] 65%|██████▌   | 308/471 [06:48<03:38,  1.34s/it] 66%|██████▌   | 309/471 [06:49<03:37,  1.34s/it] 66%|██████▌   | 310/471 [06:50<03:35,  1.34s/it] 66%|██████▌   | 311/471 [06:52<03:34,  1.34s/it] 66%|██████▌   | 312/471 [06:53<03:32,  1.34s/it] 66%|██████▋   | 313/471 [06:54<03:31,  1.34s/it] 67%|██████▋   | 314/471 [06:56<03:29,  1.34s/it] 67%|██████▋   | 315/471 [06:57<03:28,  1.34s/it] 67%|██████▋   | 316/471 [06:58<03:27,  1.34s/it] 67%|██████▋   | 317/471 [07:00<03:26,  1.34s/it] 68%|██████▊   | 318/471 [07:01<03:25,  1.34s/it] 68%|██████▊   | 319/471 [07:02<03:23,  1.34s/it] 68%|██████▊   | 320/471 [07:04<03:22,  1.34s/it] 68%|██████▊   | 321/471 [07:05<03:21,  1.34s/it] 68%|██████▊   | 322/471 [07:06<03:19,  1.34s/it] 69%|██████▊   | 323/471 [07:08<03:18,  1.34s/it] 69%|██████▉   | 324/471 [07:09<03:17,  1.35s/it] 69%|██████▉   | 325/471 [07:11<03:16,  1.34s/it] 69%|██████▉   | 326/471 [07:12<03:14,  1.34s/it] 69%|██████▉   | 327/471 [07:13<03:13,  1.34s/it] 70%|██████▉   | 328/471 [07:15<03:11,  1.34s/it] 70%|██████▉   | 329/471 [07:16<03:10,  1.34s/it] 70%|███████   | 330/471 [07:17<03:08,  1.34s/it] 70%|███████   | 331/471 [07:19<03:07,  1.34s/it] 70%|███████   | 332/471 [07:20<03:06,  1.34s/it] 71%|███████   | 333/471 [07:21<03:04,  1.34s/it] 71%|███████   | 334/471 [07:23<03:03,  1.34s/it] 71%|███████   | 335/471 [07:24<03:02,  1.34s/it] 71%|███████▏  | 336/471 [07:25<03:01,  1.34s/it] 72%|███████▏  | 337/471 [07:27<02:59,  1.34s/it] 72%|███████▏  | 338/471 [07:28<02:57,  1.34s/it] 72%|███████▏  | 339/471 [07:29<02:56,  1.34s/it] 72%|███████▏  | 340/471 [07:31<02:55,  1.34s/it] 72%|███████▏  | 341/471 [07:32<02:53,  1.34s/it] 73%|███████▎  | 342/471 [07:33<02:52,  1.34s/it] 73%|███████▎  | 343/471 [07:35<02:51,  1.34s/it] 73%|███████▎  | 344/471 [07:36<02:50,  1.34s/it] 73%|███████▎  | 345/471 [07:37<02:48,  1.34s/it] 73%|███████▎  | 346/471 [07:39<02:47,  1.34s/it] 74%|███████▎  | 347/471 [07:40<02:45,  1.34s/it] 74%|███████▍  | 348/471 [07:41<02:44,  1.34s/it] 74%|███████▍  | 349/471 [07:43<02:43,  1.34s/it] 74%|███████▍  | 350/471 [07:44<02:41,  1.34s/it] 75%|███████▍  | 351/471 [07:45<02:40,  1.33s/it] 75%|███████▍  | 352/471 [07:47<02:38,  1.34s/it] 75%|███████▍  | 353/471 [07:48<02:37,  1.34s/it] 75%|███████▌  | 354/471 [07:49<02:36,  1.34s/it] 75%|███████▌  | 355/471 [07:51<02:35,  1.34s/it] 76%|███████▌  | 356/471 [07:52<02:33,  1.34s/it] 76%|███████▌  | 357/471 [07:53<02:32,  1.34s/it] 76%|███████▌  | 358/471 [07:55<02:30,  1.34s/it] 76%|███████▌  | 359/471 [07:56<02:29,  1.34s/it] 76%|███████▋  | 360/471 [07:57<02:28,  1.33s/it] 77%|███████▋  | 361/471 [07:59<02:26,  1.34s/it] 77%|███████▋  | 362/471 [08:00<02:25,  1.34s/it] 77%|███████▋  | 363/471 [08:01<02:23,  1.33s/it] 77%|███████▋  | 364/471 [08:03<02:22,  1.33s/it] 77%|███████▋  | 365/471 [08:04<02:21,  1.33s/it] 78%|███████▊  | 366/471 [08:05<02:20,  1.34s/it] 78%|███████▊  | 367/471 [08:07<02:18,  1.34s/it] 78%|███████▊  | 368/471 [08:08<02:17,  1.33s/it] 78%|███████▊  | 369/471 [08:09<02:15,  1.33s/it] 79%|███████▊  | 370/471 [08:11<02:14,  1.33s/it] 79%|███████▉  | 371/471 [08:12<02:13,  1.33s/it] 79%|███████▉  | 372/471 [08:13<02:11,  1.33s/it] 79%|███████▉  | 373/471 [08:15<02:10,  1.33s/it] 79%|███████▉  | 374/471 [08:16<02:08,  1.33s/it] 80%|███████▉  | 375/471 [08:17<02:07,  1.33s/it] 80%|███████▉  | 376/471 [08:19<02:06,  1.33s/it] 80%|████████  | 377/471 [08:20<02:04,  1.33s/it] 80%|████████  | 378/471 [08:21<02:03,  1.32s/it] 80%|████████  | 379/471 [08:23<02:02,  1.33s/it] 81%|████████  | 380/471 [08:24<02:00,  1.33s/it] 81%|████████  | 381/471 [08:25<01:59,  1.33s/it] 81%|████████  | 382/471 [08:27<01:58,  1.33s/it] 81%|████████▏ | 383/471 [08:28<01:57,  1.33s/it] 82%|████████▏ | 384/471 [08:29<01:55,  1.33s/it] 82%|████████▏ | 385/471 [08:31<01:54,  1.33s/it] 82%|████████▏ | 386/471 [08:32<01:53,  1.33s/it] 82%|████████▏ | 387/471 [08:33<01:51,  1.33s/it] 82%|████████▏ | 388/471 [08:35<01:50,  1.33s/it] 83%|████████▎ | 389/471 [08:36<01:48,  1.33s/it] 83%|████████▎ | 390/471 [08:37<01:47,  1.33s/it] 83%|████████▎ | 391/471 [08:39<01:46,  1.33s/it] 83%|████████▎ | 392/471 [08:40<01:44,  1.33s/it] 83%|████████▎ | 393/471 [08:41<01:43,  1.33s/it] 84%|████████▎ | 394/471 [08:43<01:42,  1.33s/it] 84%|████████▍ | 395/471 [08:44<01:41,  1.33s/it] 84%|████████▍ | 396/471 [08:45<01:39,  1.33s/it] 84%|████████▍ | 397/471 [08:47<01:38,  1.33s/it] 85%|████████▍ | 398/471 [08:48<01:37,  1.33s/it] 85%|████████▍ | 399/471 [08:49<01:35,  1.33s/it] 85%|████████▍ | 400/471 [08:51<01:34,  1.33s/it] 85%|████████▌ | 401/471 [08:52<01:32,  1.33s/it] 85%|████████▌ | 402/471 [08:53<01:31,  1.33s/it] 86%|████████▌ | 403/471 [08:55<01:30,  1.33s/it] 86%|████████▌ | 404/471 [08:56<01:28,  1.33s/it] 86%|████████▌ | 405/471 [08:57<01:27,  1.33s/it] 86%|████████▌ | 406/471 [08:58<01:26,  1.33s/it] 86%|████████▋ | 407/471 [09:00<01:24,  1.32s/it] 87%|████████▋ | 408/471 [09:01<01:23,  1.33s/it] 87%|████████▋ | 409/471 [09:02<01:22,  1.33s/it] 87%|████████▋ | 410/471 [09:04<01:20,  1.33s/it] 87%|████████▋ | 411/471 [09:05<01:19,  1.33s/it] 87%|████████▋ | 412/471 [09:06<01:18,  1.33s/it] 88%|████████▊ | 413/471 [09:08<01:16,  1.33s/it] 88%|████████▊ | 414/471 [09:09<01:15,  1.33s/it] 88%|████████▊ | 415/471 [09:10<01:14,  1.32s/it] 88%|████████▊ | 416/471 [09:12<01:13,  1.33s/it] 89%|████████▊ | 417/471 [09:13<01:11,  1.33s/it] 89%|████████▊ | 418/471 [09:14<01:10,  1.33s/it] 89%|████████▉ | 419/471 [09:16<01:08,  1.33s/it] 89%|████████▉ | 420/471 [09:17<01:07,  1.32s/it] 89%|████████▉ | 421/471 [09:18<01:06,  1.33s/it] 90%|████████▉ | 422/471 [09:20<01:04,  1.32s/it] 90%|████████▉ | 423/471 [09:21<01:03,  1.32s/it] 90%|█████████ | 424/471 [09:22<01:02,  1.32s/it] 90%|█████████ | 425/471 [09:24<01:00,  1.32s/it] 90%|█████████ | 426/471 [09:25<00:59,  1.33s/it] 91%|█████████ | 427/471 [09:26<00:58,  1.33s/it] 91%|█████████ | 428/471 [09:28<00:57,  1.33s/it] 91%|█████████ | 429/471 [09:29<00:55,  1.33s/it] 91%|█████████▏| 430/471 [09:30<00:54,  1.33s/it] 92%|█████████▏| 431/471 [09:32<00:53,  1.33s/it] 92%|█████████▏| 432/471 [09:33<00:51,  1.33s/it] 92%|█████████▏| 433/471 [09:34<00:50,  1.33s/it] 92%|█████████▏| 434/471 [09:36<00:49,  1.33s/it] 92%|█████████▏| 435/471 [09:37<00:47,  1.33s/it] 93%|█████████▎| 436/471 [09:38<00:46,  1.33s/it] 93%|█████████▎| 437/471 [09:40<00:45,  1.33s/it] 93%|█████████▎| 438/471 [09:41<00:43,  1.33s/it] 93%|█████████▎| 439/471 [09:42<00:42,  1.33s/it] 93%|█████████▎| 440/471 [09:44<00:41,  1.33s/it] 94%|█████████▎| 441/471 [09:45<00:39,  1.33s/it] 94%|█████████▍| 442/471 [09:46<00:38,  1.33s/it] 94%|█████████▍| 443/471 [09:48<00:37,  1.33s/it] 94%|█████████▍| 444/471 [09:49<00:35,  1.33s/it] 94%|█████████▍| 445/471 [09:50<00:34,  1.33s/it] 95%|█████████▍| 446/471 [09:52<00:33,  1.33s/it] 95%|█████████▍| 447/471 [09:53<00:31,  1.33s/it] 95%|█████████▌| 448/471 [09:54<00:30,  1.33s/it] 95%|█████████▌| 449/471 [09:56<00:29,  1.33s/it] 96%|█████████▌| 450/471 [09:57<00:27,  1.33s/it] 96%|█████████▌| 451/471 [09:58<00:26,  1.33s/it] 96%|█████████▌| 452/471 [10:00<00:25,  1.33s/it] 96%|█████████▌| 453/471 [10:01<00:23,  1.33s/it] 96%|█████████▋| 454/471 [10:02<00:22,  1.33s/it] 97%|█████████▋| 455/471 [10:04<00:21,  1.33s/it] 97%|█████████▋| 456/471 [10:05<00:19,  1.33s/it] 97%|█████████▋| 457/471 [10:06<00:18,  1.33s/it] 97%|█████████▋| 458/471 [10:08<00:17,  1.33s/it] 97%|█████████▋| 459/471 [10:09<00:15,  1.33s/it] 98%|█████████▊| 460/471 [10:10<00:14,  1.33s/it] 98%|█████████▊| 461/471 [10:12<00:13,  1.33s/it] 98%|█████████▊| 462/471 [10:13<00:11,  1.33s/it] 98%|█████████▊| 463/471 [10:14<00:10,  1.33s/it] 99%|█████████▊| 464/471 [10:15<00:09,  1.33s/it] 99%|█████████▊| 465/471 [10:17<00:07,  1.33s/it] 99%|█████████▉| 466/471 [10:18<00:06,  1.33s/it] 99%|█████████▉| 467/471 [10:19<00:05,  1.33s/it] 99%|█████████▉| 468/471 [10:21<00:03,  1.33s/it]100%|█████████▉| 469/471 [10:22<00:02,  1.33s/it]100%|█████████▉| 470/471 [10:23<00:01,  1.33s/it]100%|██████████| 471/471 [10:24<00:00,  1.22s/it]100%|██████████| 471/471 [10:24<00:00,  1.33s/it]
{'eval_loss': 2.211106538772583, 'eval_model_preparation_time': 0.0119, 'eval_acc': 0.3996282527881041, 'eval_runtime': 626.1551, 'eval_samples_per_second': 12.029, 'eval_steps_per_second': 0.752}
