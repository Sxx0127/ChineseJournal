nohup: ignoring input
Map:   0%|          | 0/11314 [00:00<?, ? examples/s]Map:   9%|▉         | 1000/11314 [00:00<00:03, 3008.27 examples/s]Map:  18%|█▊        | 2000/11314 [00:00<00:03, 2951.32 examples/s]Map:  27%|██▋       | 3000/11314 [00:00<00:02, 3292.01 examples/s]Map:  35%|███▌      | 4000/11314 [00:01<00:02, 3214.72 examples/s]Map:  44%|████▍     | 5000/11314 [00:01<00:02, 3089.07 examples/s]Map:  53%|█████▎    | 6000/11314 [00:01<00:01, 3168.50 examples/s]Map:  62%|██████▏   | 7000/11314 [00:02<00:01, 3211.78 examples/s]Map:  71%|███████   | 8000/11314 [00:02<00:01, 3300.81 examples/s]Map:  80%|███████▉  | 9000/11314 [00:02<00:00, 3353.21 examples/s]Map:  88%|████████▊ | 10000/11314 [00:03<00:00, 3287.22 examples/s]Map:  97%|█████████▋| 11000/11314 [00:03<00:00, 3298.83 examples/s]Map: 100%|██████████| 11314/11314 [00:03<00:00, 3233.75 examples/s]
Map:   0%|          | 0/7532 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7532 [00:00<00:01, 3997.72 examples/s]Map:  27%|██▋       | 2000/7532 [00:00<00:02, 2703.18 examples/s]Map:  40%|███▉      | 3000/7532 [00:01<00:01, 2589.51 examples/s]Map:  53%|█████▎    | 4000/7532 [00:01<00:01, 2968.52 examples/s]Map:  66%|██████▋   | 5000/7532 [00:01<00:00, 3209.92 examples/s]Map:  80%|███████▉  | 6000/7532 [00:01<00:00, 3444.03 examples/s]Map:  93%|█████████▎| 7000/7532 [00:02<00:00, 3440.73 examples/s]Map: 100%|██████████| 7532/7532 [00:02<00:00, 3464.63 examples/s]Map: 100%|██████████| 7532/7532 [00:02<00:00, 3232.20 examples/s]
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at ./model/models--roberta-large/ and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
trainable params: 3,145,728 || all params: 358,525,972 || trainable%: 0.8774
PeftModelForCausalLM(
  (base_model): LoraModel(
    (model): RobertaForSequenceClassification(
      (roberta): RobertaModel(
        (embeddings): RobertaEmbeddings(
          (word_embeddings): Embedding(50265, 1024, padding_idx=1)
          (position_embeddings): Embedding(514, 1024, padding_idx=1)
          (token_type_embeddings): Embedding(1, 1024)
          (LayerNorm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): RobertaEncoder(
          (layer): ModuleList(
            (0-23): 24 x RobertaLayer(
              (attention): RobertaAttention(
                (self): RobertaSdpaSelfAttention(
                  (query): lora.Linear(
                    (base_layer): Linear(in_features=1024, out_features=1024, bias=True)
                    (lora_dropout): ModuleDict(
                      (default): Dropout(p=0.05, inplace=False)
                    )
                    (lora_A): ModuleDict(
                      (default): Linear(in_features=1024, out_features=32, bias=False)
                    )
                    (lora_B): ModuleDict(
                      (default): Linear(in_features=32, out_features=1024, bias=False)
                    )
                    (lora_embedding_A): ParameterDict()
                    (lora_embedding_B): ParameterDict()
                    (lora_magnitude_vector): ModuleDict()
                  )
                  (key): Linear(in_features=1024, out_features=1024, bias=True)
                  (value): lora.Linear(
                    (base_layer): Linear(in_features=1024, out_features=1024, bias=True)
                    (lora_dropout): ModuleDict(
                      (default): Dropout(p=0.05, inplace=False)
                    )
                    (lora_A): ModuleDict(
                      (default): Linear(in_features=1024, out_features=32, bias=False)
                    )
                    (lora_B): ModuleDict(
                      (default): Linear(in_features=32, out_features=1024, bias=False)
                    )
                    (lora_embedding_A): ParameterDict()
                    (lora_embedding_B): ParameterDict()
                    (lora_magnitude_vector): ModuleDict()
                  )
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): RobertaSelfOutput(
                  (dense): Linear(in_features=1024, out_features=1024, bias=True)
                  (LayerNorm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): RobertaIntermediate(
                (dense): Linear(in_features=1024, out_features=4096, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): RobertaOutput(
                (dense): Linear(in_features=4096, out_features=1024, bias=True)
                (LayerNorm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (classifier): RobertaClassificationHead(
        (dense): Linear(in_features=1024, out_features=1024, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (out_proj): Linear(in_features=1024, out_features=20, bias=True)
      )
    )
  )
)
ROUND:0
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:02<01:39,  2.55s/it]                                              {'loss': 3.0755, 'grad_norm': 4.590071678161621, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:02<01:39,  2.55s/it]  5%|▌         | 2/40 [00:03<01:00,  1.60s/it]                                              {'loss': 2.7843, 'grad_norm': 5.818452835083008, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:03<01:00,  1.60s/it]  8%|▊         | 3/40 [00:04<00:48,  1.31s/it]                                              {'loss': 3.1056, 'grad_norm': 7.522160053253174, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:04<00:48,  1.31s/it] 10%|█         | 4/40 [00:05<00:44,  1.25s/it]                                              {'loss': 3.0386, 'grad_norm': 8.824932098388672, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:05<00:44,  1.25s/it] 12%|█▎        | 5/40 [00:06<00:41,  1.18s/it]                                              {'loss': 3.1395, 'grad_norm': 6.960599899291992, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:06<00:41,  1.18s/it] 15%|█▌        | 6/40 [00:07<00:39,  1.17s/it]                                              {'loss': 3.3858, 'grad_norm': 8.44744873046875, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:39,  1.17s/it] 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it]                                              {'loss': 3.5636, 'grad_norm': 7.063024044036865, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it] 20%|██        | 8/40 [00:09<00:27,  1.15it/s]                                              {'loss': 2.9307, 'grad_norm': 24.87830924987793, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:09<00:27,  1.15it/s] 22%|██▎       | 9/40 [00:10<00:29,  1.06it/s]                                              {'loss': 2.9972, 'grad_norm': 6.306448459625244, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:10<00:29,  1.06it/s] 25%|██▌       | 10/40 [00:11<00:29,  1.00it/s]                                               {'loss': 2.8704, 'grad_norm': 5.7034454345703125, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:29,  1.00it/s] 28%|██▊       | 11/40 [00:12<00:29,  1.03s/it]                                               {'loss': 2.9579, 'grad_norm': 5.360772609710693, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:29,  1.03s/it] 30%|███       | 12/40 [00:13<00:29,  1.06s/it]                                               {'loss': 2.8041, 'grad_norm': 5.398708820343018, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.08s/it]                                               {'loss': 2.9431, 'grad_norm': 5.905668258666992, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it]                                               {'loss': 3.0387, 'grad_norm': 6.60312557220459, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:17<00:27,  1.10s/it]                                               {'loss': 3.0768, 'grad_norm': 49.223514556884766, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:17<00:27,  1.10s/it] 40%|████      | 16/40 [00:17<00:20,  1.20it/s]                                               {'loss': 2.9229, 'grad_norm': 24.589630126953125, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:17<00:20,  1.20it/s] 42%|████▎     | 17/40 [00:18<00:21,  1.09it/s]                                               {'loss': 2.937, 'grad_norm': 4.895790100097656, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:19<00:21,  1.00it/s]                                               {'loss': 3.0384, 'grad_norm': 6.148650169372559, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:21,  1.00it/s] 48%|████▊     | 19/40 [00:20<00:21,  1.02s/it]                                               {'loss': 2.6406, 'grad_norm': 4.952907085418701, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.02s/it] 50%|█████     | 20/40 [00:21<00:19,  1.00it/s]                                               {'loss': 2.7526, 'grad_norm': 5.7681660652160645, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:19,  1.00it/s] 52%|█████▎    | 21/40 [00:22<00:18,  1.03it/s]                                               {'loss': 2.7359, 'grad_norm': 5.041025638580322, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:18,  1.03it/s] 55%|█████▌    | 22/40 [00:23<00:17,  1.05it/s]                                               {'loss': 2.9729, 'grad_norm': 6.2089338302612305, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:17,  1.05it/s] 57%|█████▊    | 23/40 [00:24<00:17,  1.01s/it]                                               {'loss': 2.8774, 'grad_norm': 5.807790279388428, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:17,  1.01s/it] 60%|██████    | 24/40 [00:24<00:12,  1.31it/s]                                               {'loss': 2.6949, 'grad_norm': 23.726469039916992, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:12,  1.31it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.13it/s]                                               {'loss': 2.9325, 'grad_norm': 5.414642333984375, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.13it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.05it/s]                                               {'loss': 2.5911, 'grad_norm': 5.756010055541992, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.05it/s] 68%|██████▊   | 27/40 [00:28<00:12,  1.00it/s]                                               {'loss': 2.7874, 'grad_norm': 6.331757068634033, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:12,  1.00it/s] 70%|███████   | 28/40 [00:29<00:12,  1.03s/it]                                               {'loss': 2.6332, 'grad_norm': 6.119978427886963, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.03s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.04s/it]                                               {'loss': 2.5767, 'grad_norm': 6.405032634735107, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.04s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.07s/it]                                               {'loss': 2.6873, 'grad_norm': 5.521020412445068, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.07s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it]                                               {'loss': 3.0056, 'grad_norm': 6.123549461364746, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it] 80%|████████  | 32/40 [00:32<00:06,  1.23it/s]                                               {'loss': 3.9888, 'grad_norm': 26.420368194580078, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.23it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.10it/s]                                               {'loss': 2.5002, 'grad_norm': 4.870180130004883, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.10it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.05it/s]                                               {'loss': 2.758, 'grad_norm': 5.724463939666748, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.05it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.01s/it]                                               {'loss': 2.7266, 'grad_norm': 6.941756248474121, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.01s/it] 90%|█████████ | 36/40 [00:37<00:03,  1.00it/s]                                               {'loss': 2.5201, 'grad_norm': 4.788017749786377, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:03,  1.00it/s] 92%|█████████▎| 37/40 [00:37<00:02,  1.01it/s]                                               {'loss': 2.486, 'grad_norm': 5.4241509437561035, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:02,  1.01it/s] 95%|█████████▌| 38/40 [00:38<00:01,  1.01it/s]                                               {'loss': 2.5187, 'grad_norm': 6.340243339538574, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:01,  1.01it/s] 98%|█████████▊| 39/40 [00:39<00:00,  1.08it/s]                                               {'loss': 2.3274, 'grad_norm': 6.384658336639404, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:00,  1.08it/s]100%|██████████| 40/40 [00:39<00:00,  1.42it/s]                                               {'loss': 2.3299, 'grad_norm': 24.299623489379883, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.42it/s]                                               {'train_runtime': 40.1065, 'train_samples_per_second': 14.087, 'train_steps_per_second': 0.997, 'train_loss': 2.8663501679897307, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.42it/s]100%|██████████| 40/40 [00:40<00:00,  1.00s/it]
CLIENT:64
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:45,  1.17s/it]                                              {'loss': 3.1997, 'grad_norm': 3.200329065322876, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:45,  1.17s/it]  5%|▌         | 2/40 [00:02<00:42,  1.13s/it]                                              {'loss': 2.998, 'grad_norm': 1.9099091291427612, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.13s/it]  8%|▊         | 3/40 [00:03<00:41,  1.13s/it]                                              {'loss': 3.0692, 'grad_norm': 0.6386018991470337, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.13s/it] 10%|█         | 4/40 [00:04<00:40,  1.13s/it]                                              {'loss': 3.2298, 'grad_norm': 0.9348130226135254, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.13s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.14s/it]                                              {'loss': 2.9953, 'grad_norm': 0.6518173813819885, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.14s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.8908, 'grad_norm': 1.011029601097107, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.8115, 'grad_norm': 1.0618757009506226, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:33,  1.04s/it]                                              {'loss': 2.6416, 'grad_norm': 4.680365085601807, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:33,  1.04s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it]                                              {'loss': 2.8317, 'grad_norm': 1.3511327505111694, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it] 25%|██▌       | 10/40 [00:10<00:30,  1.01s/it]                                               {'loss': 2.8783, 'grad_norm': 1.5662659406661987, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:30,  1.01s/it] 28%|██▊       | 11/40 [00:11<00:28,  1.01it/s]                                               {'loss': 2.915, 'grad_norm': 1.256840467453003, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:28,  1.01it/s] 30%|███       | 12/40 [00:12<00:27,  1.02it/s]                                               {'loss': 2.8289, 'grad_norm': 2.160223960876465, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:27,  1.02it/s] 32%|███▎      | 13/40 [00:13<00:26,  1.01it/s]                                               {'loss': 2.7056, 'grad_norm': 2.5141804218292236, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:26,  1.01it/s] 35%|███▌      | 14/40 [00:14<00:25,  1.01it/s]                                               {'loss': 2.667, 'grad_norm': 2.209045886993408, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:25,  1.01it/s] 38%|███▊      | 15/40 [00:15<00:24,  1.02it/s]                                               {'loss': 2.9172, 'grad_norm': 2.4261815547943115, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:24,  1.02it/s] 40%|████      | 16/40 [00:15<00:17,  1.36it/s]                                               {'loss': 3.6668, 'grad_norm': 11.833416938781738, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:17,  1.36it/s] 42%|████▎     | 17/40 [00:16<00:19,  1.20it/s]                                               {'loss': 2.5636, 'grad_norm': 3.1358256340026855, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:19,  1.20it/s] 45%|████▌     | 18/40 [00:18<00:20,  1.08it/s]                                               {'loss': 2.4195, 'grad_norm': 3.199591875076294, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:20,  1.08it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.01it/s]                                               {'loss': 2.7451, 'grad_norm': 3.2873644828796387, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.01it/s] 50%|█████     | 20/40 [00:20<00:20,  1.03s/it]                                               {'loss': 2.5843, 'grad_norm': 3.2517435550689697, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.03s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.05s/it]                                               {'loss': 2.3266, 'grad_norm': 3.4776322841644287, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.05s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.10s/it]                                               {'loss': 2.5185, 'grad_norm': 3.746960401535034, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.10s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.09s/it]                                               {'loss': 2.5033, 'grad_norm': 4.169812202453613, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.09s/it] 60%|██████    | 24/40 [00:23<00:13,  1.20it/s]                                               {'loss': 1.6947, 'grad_norm': 11.370471954345703, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s]                                               {'loss': 2.2957, 'grad_norm': 3.693761110305786, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.01it/s]                                               {'loss': 2.5566, 'grad_norm': 4.165809631347656, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 2.4436, 'grad_norm': 4.153125286102295, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:12,  1.07s/it]                                               {'loss': 2.3217, 'grad_norm': 3.437232255935669, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.07s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it]                                               {'loss': 2.2465, 'grad_norm': 3.9175031185150146, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.04s/it]                                               {'loss': 2.4858, 'grad_norm': 4.054630279541016, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.04s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.00s/it]                                               {'loss': 2.4085, 'grad_norm': 5.990200996398926, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.00s/it] 80%|████████  | 32/40 [00:31<00:06,  1.31it/s]                                               {'loss': 1.7621, 'grad_norm': 12.884153366088867, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.31it/s] 82%|████████▎ | 33/40 [00:32<00:05,  1.23it/s]                                               {'loss': 2.2986, 'grad_norm': 3.460543632507324, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:05,  1.23it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.10it/s]                                               {'loss': 2.4582, 'grad_norm': 4.104323863983154, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.10it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.04it/s]                                               {'loss': 2.1899, 'grad_norm': 3.6150951385498047, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.04it/s] 90%|█████████ | 36/40 [00:35<00:03,  1.04it/s]                                               {'loss': 2.2235, 'grad_norm': 3.4444260597229004, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:03,  1.04it/s] 92%|█████████▎| 37/40 [00:36<00:02,  1.04it/s]                                               {'loss': 2.3497, 'grad_norm': 2.991804361343384, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:02,  1.04it/s] 95%|█████████▌| 38/40 [00:37<00:01,  1.04it/s]                                               {'loss': 2.3288, 'grad_norm': 12.862719535827637, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:01,  1.04it/s] 98%|█████████▊| 39/40 [00:38<00:00,  1.03it/s]                                               {'loss': 2.4023, 'grad_norm': 4.164339065551758, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:00,  1.03it/s]100%|██████████| 40/40 [00:38<00:00,  1.35it/s]                                               {'loss': 2.3068, 'grad_norm': 12.430384635925293, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.35it/s]                                               {'train_runtime': 39.0124, 'train_samples_per_second': 14.483, 'train_steps_per_second': 1.025, 'train_loss': 2.5920119494199754, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.35it/s]100%|██████████| 40/40 [00:39<00:00,  1.03it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 3.4167, 'grad_norm': 2.7675323486328125, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]                                              {'loss': 2.9512, 'grad_norm': 0.6528685092926025, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]  8%|▊         | 3/40 [00:03<00:38,  1.04s/it]                                              {'loss': 3.1731, 'grad_norm': 0.7064168453216553, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:38,  1.04s/it] 10%|█         | 4/40 [00:04<00:35,  1.00it/s]                                              {'loss': 3.2394, 'grad_norm': 0.9110034108161926, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:35,  1.00it/s] 12%|█▎        | 5/40 [00:05<00:35,  1.01s/it]                                              {'loss': 3.0285, 'grad_norm': 0.44919320940971375, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:35,  1.01s/it] 15%|█▌        | 6/40 [00:06<00:34,  1.01s/it]                                              {'loss': 2.951, 'grad_norm': 0.8946509957313538, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:34,  1.01s/it] 18%|█▊        | 7/40 [00:07<00:34,  1.06s/it]                                              {'loss': 2.9262, 'grad_norm': 1.1767405271530151, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:34,  1.06s/it] 20%|██        | 8/40 [00:07<00:24,  1.29it/s]                                              {'loss': 2.7805, 'grad_norm': 3.4383046627044678, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:24,  1.29it/s] 22%|██▎       | 9/40 [00:08<00:27,  1.14it/s]                                              {'loss': 2.7008, 'grad_norm': 1.3473397493362427, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:27,  1.14it/s] 25%|██▌       | 10/40 [00:09<00:28,  1.06it/s]                                               {'loss': 2.7807, 'grad_norm': 1.5208405256271362, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:28,  1.06it/s] 28%|██▊       | 11/40 [00:10<00:28,  1.00it/s]                                               {'loss': 3.0351, 'grad_norm': 1.385457158088684, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:28,  1.00it/s] 30%|███       | 12/40 [00:11<00:28,  1.03s/it]                                               {'loss': 2.955, 'grad_norm': 2.094430685043335, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:28,  1.03s/it] 32%|███▎      | 13/40 [00:12<00:27,  1.03s/it]                                               {'loss': 2.856, 'grad_norm': 10.735883712768555, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:12<00:27,  1.03s/it] 35%|███▌      | 14/40 [00:14<00:27,  1.05s/it]                                               {'loss': 2.8128, 'grad_norm': 2.4112789630889893, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:27,  1.05s/it] 38%|███▊      | 15/40 [00:15<00:26,  1.06s/it]                                               {'loss': 2.6423, 'grad_norm': 2.987140655517578, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:26,  1.06s/it] 40%|████      | 16/40 [00:15<00:18,  1.28it/s]                                               {'loss': 3.7825, 'grad_norm': 11.882247924804688, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:18,  1.28it/s] 42%|████▎     | 17/40 [00:16<00:20,  1.13it/s]                                               {'loss': 2.4018, 'grad_norm': 6.802950382232666, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:20,  1.13it/s] 45%|████▌     | 18/40 [00:17<00:20,  1.05it/s]                                               {'loss': 2.6016, 'grad_norm': 2.758226156234741, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:20,  1.05it/s] 48%|████▊     | 19/40 [00:18<00:20,  1.03it/s]                                               {'loss': 2.5811, 'grad_norm': 3.4480669498443604, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:20,  1.03it/s] 50%|█████     | 20/40 [00:19<00:20,  1.02s/it]                                               {'loss': 2.6628, 'grad_norm': 3.7256686687469482, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:20,  1.02s/it] 52%|█████▎    | 21/40 [00:20<00:19,  1.05s/it]                                               {'loss': 2.9154, 'grad_norm': 2.976168632507324, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:19,  1.05s/it] 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it]                                               {'loss': 2.407, 'grad_norm': 5.275406837463379, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it] 57%|█████▊    | 23/40 [00:22<00:17,  1.02s/it]                                               {'loss': 2.4332, 'grad_norm': 2.8662383556365967, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:17,  1.02s/it] 60%|██████    | 24/40 [00:22<00:12,  1.29it/s]                                               {'loss': 2.1314, 'grad_norm': 11.954463958740234, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:12,  1.29it/s] 62%|██████▎   | 25/40 [00:23<00:12,  1.23it/s]                                               {'loss': 2.3574, 'grad_norm': 2.9956698417663574, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:23<00:12,  1.23it/s] 65%|██████▌   | 26/40 [00:24<00:11,  1.18it/s]                                               {'loss': 2.3831, 'grad_norm': 3.6307437419891357, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:24<00:11,  1.18it/s] 68%|██████▊   | 27/40 [00:25<00:11,  1.09it/s]                                               {'loss': 2.5286, 'grad_norm': 3.050389289855957, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:25<00:11,  1.09it/s] 70%|███████   | 28/40 [00:27<00:11,  1.01it/s]                                               {'loss': 2.3379, 'grad_norm': 3.3505187034606934, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.01it/s] 72%|███████▎  | 29/40 [00:28<00:11,  1.02s/it]                                               {'loss': 2.5789, 'grad_norm': 3.1830568313598633, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.02s/it] 75%|███████▌  | 30/40 [00:29<00:10,  1.05s/it]                                               {'loss': 2.465, 'grad_norm': 29.98237419128418, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:10,  1.05s/it] 78%|███████▊  | 31/40 [00:30<00:09,  1.07s/it]                                               {'loss': 2.4742, 'grad_norm': 3.2877376079559326, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.07s/it] 80%|████████  | 32/40 [00:30<00:06,  1.23it/s]                                               {'loss': 2.6569, 'grad_norm': 12.381804466247559, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:30<00:06,  1.23it/s] 82%|████████▎ | 33/40 [00:31<00:06,  1.13it/s]                                               {'loss': 2.4487, 'grad_norm': 3.4405205249786377, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:31<00:06,  1.13it/s] 85%|████████▌ | 34/40 [00:32<00:05,  1.04it/s]                                               {'loss': 2.4561, 'grad_norm': 4.75450325012207, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:32<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:33<00:05,  1.00s/it]                                               {'loss': 2.2782, 'grad_norm': 3.179753541946411, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:33<00:05,  1.00s/it] 90%|█████████ | 36/40 [00:34<00:04,  1.03s/it]                                               {'loss': 2.3863, 'grad_norm': 3.1172916889190674, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:34<00:04,  1.03s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.06s/it]                                               {'loss': 2.4445, 'grad_norm': 3.1310553550720215, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.06s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.08s/it]                                               {'loss': 2.5731, 'grad_norm': 3.4184300899505615, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:38<00:01,  1.08s/it]                                               {'loss': 2.1758, 'grad_norm': 4.055363655090332, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:01,  1.08s/it]100%|██████████| 40/40 [00:38<00:00,  1.21it/s]                                               {'loss': 3.254, 'grad_norm': 24.928796768188477, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.21it/s]                                               {'train_runtime': 38.6959, 'train_samples_per_second': 14.601, 'train_steps_per_second': 1.034, 'train_loss': 2.6991190195083616, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.21it/s]100%|██████████| 40/40 [00:38<00:00,  1.03it/s]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]                                              {'loss': 2.8081, 'grad_norm': 1.6324543952941895, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]                                              {'loss': 2.9722, 'grad_norm': 1.686600923538208, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]  8%|▊         | 3/40 [00:03<00:40,  1.10s/it]                                              {'loss': 2.8976, 'grad_norm': 0.7821910977363586, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:40,  1.10s/it] 10%|█         | 4/40 [00:04<00:39,  1.11s/it]                                              {'loss': 2.9989, 'grad_norm': 0.9858715534210205, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.11s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.09s/it]                                              {'loss': 3.1624, 'grad_norm': 0.6508669257164001, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.09s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it]                                              {'loss': 2.7128, 'grad_norm': 1.2668014764785767, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it]                                              {'loss': 2.9712, 'grad_norm': 1.2425504922866821, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it] 20%|██        | 8/40 [00:07<00:26,  1.21it/s]                                              {'loss': 2.6251, 'grad_norm': 5.486014366149902, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:26,  1.21it/s] 22%|██▎       | 9/40 [00:09<00:28,  1.09it/s]                                              {'loss': 2.5333, 'grad_norm': 1.7400157451629639, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:28,  1.09it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s]                                               {'loss': 2.9061, 'grad_norm': 2.1550028324127197, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it]                                               {'loss': 2.7396, 'grad_norm': 1.9068069458007812, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it] 30%|███       | 12/40 [00:12<00:29,  1.05s/it]                                               {'loss': 2.5554, 'grad_norm': 2.3911855220794678, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.05s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.07s/it]                                               {'loss': 2.7201, 'grad_norm': 2.9212119579315186, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.07s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it]                                               {'loss': 2.626, 'grad_norm': 9.267269134521484, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it] 38%|███▊      | 15/40 [00:15<00:25,  1.04s/it]                                               {'loss': 2.5986, 'grad_norm': 3.2247886657714844, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:25,  1.04s/it] 40%|████      | 16/40 [00:15<00:18,  1.28it/s]                                               {'loss': 1.7531, 'grad_norm': 10.205832481384277, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:18,  1.28it/s] 42%|████▎     | 17/40 [00:16<00:18,  1.22it/s]                                               {'loss': 2.7273, 'grad_norm': 4.761324405670166, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:18,  1.22it/s] 45%|████▌     | 18/40 [00:17<00:18,  1.16it/s]                                               {'loss': 2.4338, 'grad_norm': 5.1247639656066895, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:18,  1.16it/s] 48%|████▊     | 19/40 [00:18<00:19,  1.07it/s]                                               {'loss': 2.3772, 'grad_norm': 5.235640525817871, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:19,  1.07it/s] 50%|█████     | 20/40 [00:19<00:19,  1.00it/s]                                               {'loss': 2.536, 'grad_norm': 4.182341575622559, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:19,  1.00it/s] 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it]                                               {'loss': 2.2828, 'grad_norm': 3.688772678375244, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.07s/it]                                               {'loss': 2.3686, 'grad_norm': 5.568455696105957, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.07s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.07s/it]                                               {'loss': 2.595, 'grad_norm': 3.7409777641296387, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.07s/it] 60%|██████    | 24/40 [00:23<00:13,  1.21it/s]                                               {'loss': 1.7401, 'grad_norm': 13.086796760559082, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.12it/s]                                               {'loss': 2.5167, 'grad_norm': 4.106033802032471, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.12it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.02it/s]                                               {'loss': 2.1781, 'grad_norm': 3.0506348609924316, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.01s/it]                                               {'loss': 2.4464, 'grad_norm': 11.221158027648926, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.01s/it] 70%|███████   | 28/40 [00:27<00:12,  1.05s/it]                                               {'loss': 2.3214, 'grad_norm': 3.86796498298645, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it]                                               {'loss': 2.2994, 'grad_norm': 3.3441100120544434, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.09s/it]                                               {'loss': 2.1346, 'grad_norm': 3.3781447410583496, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.09s/it]                                               {'loss': 2.22, 'grad_norm': 3.1712732315063477, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.09s/it] 80%|████████  | 32/40 [00:31<00:06,  1.20it/s]                                               {'loss': 3.2831, 'grad_norm': 2.9022278785705566, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.09it/s]                                               {'loss': 2.1233, 'grad_norm': 3.4900317192077637, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s]                                               {'loss': 2.1996, 'grad_norm': 3.3128719329833984, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.03it/s]                                               {'loss': 2.4798, 'grad_norm': 3.613459348678589, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.03it/s] 90%|█████████ | 36/40 [00:35<00:03,  1.04it/s]                                               {'loss': 2.2254, 'grad_norm': 2.956859588623047, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:03,  1.04it/s] 92%|█████████▎| 37/40 [00:36<00:02,  1.04it/s]                                               {'loss': 2.2277, 'grad_norm': 3.0274624824523926, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:02,  1.04it/s] 95%|█████████▌| 38/40 [00:37<00:02,  1.00s/it]                                               {'loss': 2.2033, 'grad_norm': 3.6243999004364014, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.00s/it] 98%|█████████▊| 39/40 [00:38<00:01,  1.05s/it]                                               {'loss': 2.3074, 'grad_norm': 3.3986241817474365, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:01,  1.05s/it]100%|██████████| 40/40 [00:39<00:00,  1.27it/s]                                               {'loss': 2.3824, 'grad_norm': 13.172728538513184, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.27it/s]                                               {'train_runtime': 39.1886, 'train_samples_per_second': 14.417, 'train_steps_per_second': 1.021, 'train_loss': 2.5047420144081114, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.27it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
CLIENT:6
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.06s/it]                                              {'loss': 2.8636, 'grad_norm': 1.8032268285751343, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:41,  1.06s/it]  5%|▌         | 2/40 [00:01<00:37,  1.02it/s]                                              {'loss': 3.0927, 'grad_norm': 1.0477793216705322, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.02it/s]  8%|▊         | 3/40 [00:02<00:35,  1.05it/s]                                              {'loss': 2.9133, 'grad_norm': 0.803192675113678, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:35,  1.05it/s] 10%|█         | 4/40 [00:04<00:36,  1.03s/it]                                              {'loss': 3.2593, 'grad_norm': 1.1786900758743286, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:36,  1.03s/it] 12%|█▎        | 5/40 [00:05<00:37,  1.06s/it]                                              {'loss': 2.9629, 'grad_norm': 0.9922271966934204, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:37,  1.06s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 2.8976, 'grad_norm': 1.1229445934295654, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it]                                              {'loss': 2.8049, 'grad_norm': 1.3232135772705078, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it] 20%|██        | 8/40 [00:08<00:34,  1.07s/it]                                              {'loss': 2.949, 'grad_norm': 4.183527946472168, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:34,  1.07s/it] 22%|██▎       | 9/40 [00:09<00:33,  1.10s/it]                                              {'loss': 2.7666, 'grad_norm': 1.553935170173645, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:33,  1.10s/it] 25%|██▌       | 10/40 [00:10<00:33,  1.11s/it]                                               {'loss': 2.7128, 'grad_norm': 1.7427973747253418, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:33,  1.11s/it] 28%|██▊       | 11/40 [00:11<00:32,  1.11s/it]                                               {'loss': 2.8326, 'grad_norm': 2.528198480606079, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:32,  1.11s/it] 30%|███       | 12/40 [00:13<00:31,  1.12s/it]                                               {'loss': 2.6587, 'grad_norm': 2.1809144020080566, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.12s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.11s/it]                                               {'loss': 2.4917, 'grad_norm': 3.0449047088623047, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.11s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it]                                               {'loss': 2.6805, 'grad_norm': 2.6493890285491943, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.12s/it]                                               {'loss': 2.384, 'grad_norm': 3.0968635082244873, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.12s/it] 40%|████      | 16/40 [00:16<00:20,  1.18it/s]                                               {'loss': 3.2591, 'grad_norm': 14.666208267211914, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.18it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s]                                               {'loss': 2.3261, 'grad_norm': 3.3341877460479736, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.00it/s]                                               {'loss': 2.813, 'grad_norm': 3.359703779220581, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.00it/s] 48%|████▊     | 19/40 [00:20<00:21,  1.05s/it]                                               {'loss': 2.2701, 'grad_norm': 4.520831108093262, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.05s/it] 50%|█████     | 20/40 [00:21<00:21,  1.08s/it]                                               {'loss': 2.1715, 'grad_norm': 3.4305529594421387, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.08s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it]                                               {'loss': 2.3723, 'grad_norm': 3.9536068439483643, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:23<00:18,  1.05s/it]                                               {'loss': 2.5435, 'grad_norm': 3.760390520095825, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:18,  1.05s/it] 57%|█████▊    | 23/40 [00:24<00:17,  1.02s/it]                                               {'loss': 2.4809, 'grad_norm': 5.37140417098999, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:17,  1.02s/it] 60%|██████    | 24/40 [00:24<00:12,  1.32it/s]                                               {'loss': 1.6434, 'grad_norm': 10.622252464294434, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:12,  1.32it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.15it/s]                                               {'loss': 2.1283, 'grad_norm': 3.431936502456665, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.15it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.05it/s]                                               {'loss': 1.9541, 'grad_norm': 3.3024563789367676, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.05it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.02s/it]                                               {'loss': 2.1487, 'grad_norm': 54.52372360229492, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.02s/it] 70%|███████   | 28/40 [00:28<00:12,  1.05s/it]                                               {'loss': 2.3485, 'grad_norm': 3.1518237590789795, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 2.2588, 'grad_norm': 3.347520112991333, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.10s/it]                                               {'loss': 2.4873, 'grad_norm': 3.228318691253662, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.10s/it] 78%|███████▊  | 31/40 [00:32<00:10,  1.12s/it]                                               {'loss': 2.3829, 'grad_norm': 2.955554962158203, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:10,  1.12s/it] 80%|████████  | 32/40 [00:32<00:06,  1.20it/s]                                               {'loss': 3.1476, 'grad_norm': 11.053445816040039, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s]                                               {'loss': 2.2121, 'grad_norm': 3.540318727493286, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.01it/s]                                               {'loss': 2.3192, 'grad_norm': 3.304333209991455, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.05s/it]                                               {'loss': 2.1558, 'grad_norm': 3.209393262863159, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.05s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.07s/it]                                               {'loss': 2.0519, 'grad_norm': 3.29400634765625, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it]                                               {'loss': 2.3564, 'grad_norm': 4.413800239562988, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.09s/it]                                               {'loss': 2.0556, 'grad_norm': 6.877328395843506, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.09s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.10s/it]                                               {'loss': 1.9534, 'grad_norm': 3.6312992572784424, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.10s/it]100%|██████████| 40/40 [00:40<00:00,  1.21it/s]                                               {'loss': 2.9666, 'grad_norm': 12.891929626464844, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.21it/s]                                               {'train_runtime': 40.8175, 'train_samples_per_second': 13.842, 'train_steps_per_second': 0.98, 'train_loss': 2.5269302099943163, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.21it/s]100%|██████████| 40/40 [00:40<00:00,  1.02s/it]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:56,  1.44s/it]                                              {'loss': 2.9955, 'grad_norm': 1.6148627996444702, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:56,  1.44s/it]  5%|▌         | 2/40 [00:02<00:47,  1.24s/it]                                              {'loss': 3.2224, 'grad_norm': 1.0192409753799438, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:47,  1.24s/it]  8%|▊         | 3/40 [00:03<00:44,  1.19s/it]                                              {'loss': 2.9991, 'grad_norm': 0.8415594100952148, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:44,  1.19s/it] 10%|█         | 4/40 [00:04<00:42,  1.18s/it]                                              {'loss': 3.1352, 'grad_norm': 0.952389121055603, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:42,  1.18s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.17s/it]                                              {'loss': 3.0665, 'grad_norm': 1.063223123550415, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.17s/it] 15%|█▌        | 6/40 [00:07<00:39,  1.16s/it]                                              {'loss': 3.0331, 'grad_norm': 1.6295562982559204, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:39,  1.16s/it] 18%|█▊        | 7/40 [00:08<00:37,  1.15s/it]                                              {'loss': 2.9717, 'grad_norm': 1.2096102237701416, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:37,  1.15s/it] 20%|██        | 8/40 [00:08<00:27,  1.18it/s]                                              {'loss': 2.5406, 'grad_norm': 4.0729193687438965, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:27,  1.18it/s] 22%|██▎       | 9/40 [00:09<00:29,  1.07it/s]                                              {'loss': 2.932, 'grad_norm': 1.930739402770996, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:29,  1.07it/s] 25%|██▌       | 10/40 [00:10<00:30,  1.01s/it]                                               {'loss': 2.8433, 'grad_norm': 1.823715090751648, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:30,  1.01s/it] 28%|██▊       | 11/40 [00:11<00:30,  1.05s/it]                                               {'loss': 2.6855, 'grad_norm': 2.1144862174987793, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:30,  1.05s/it] 30%|███       | 12/40 [00:13<00:30,  1.08s/it]                                               {'loss': 2.5831, 'grad_norm': 6.159442901611328, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:30,  1.08s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.09s/it]                                               {'loss': 2.9051, 'grad_norm': 3.1623117923736572, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.09s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it]                                               {'loss': 2.6341, 'grad_norm': 3.0196540355682373, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it]                                               {'loss': 2.7404, 'grad_norm': 3.3982133865356445, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it] 40%|████      | 16/40 [00:16<00:20,  1.17it/s]                                               {'loss': 2.8772, 'grad_norm': 12.367022514343262, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.17it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s]                                               {'loss': 2.6044, 'grad_norm': 3.736135482788086, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s] 45%|████▌     | 18/40 [00:18<00:22,  1.00s/it]                                               {'loss': 2.5764, 'grad_norm': 3.6816468238830566, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:22,  1.00s/it] 48%|████▊     | 19/40 [00:20<00:21,  1.03s/it]                                               {'loss': 2.8402, 'grad_norm': 4.546922206878662, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.03s/it] 50%|█████     | 20/40 [00:21<00:21,  1.07s/it]                                               {'loss': 2.4855, 'grad_norm': 3.960521936416626, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.07s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.07s/it]                                               {'loss': 2.55, 'grad_norm': 3.761363983154297, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it]                                               {'loss': 2.2631, 'grad_norm': 4.101527214050293, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it]                                               {'loss': 2.4481, 'grad_norm': 3.2891321182250977, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it] 60%|██████    | 24/40 [00:24<00:13,  1.18it/s]                                               {'loss': 3.018, 'grad_norm': 12.97326946258545, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.18it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.07it/s]                                               {'loss': 2.1569, 'grad_norm': 4.543630123138428, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.07it/s] 65%|██████▌   | 26/40 [00:27<00:13,  1.02it/s]                                               {'loss': 2.2742, 'grad_norm': 3.297956705093384, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it]                                               {'loss': 2.3992, 'grad_norm': 3.4306061267852783, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it] 70%|███████   | 28/40 [00:29<00:12,  1.04s/it]                                               {'loss': 2.3476, 'grad_norm': 3.6894242763519287, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.04s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 2.3932, 'grad_norm': 3.5147345066070557, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it]                                               {'loss': 2.4709, 'grad_norm': 3.394052028656006, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.10s/it]                                               {'loss': 2.3576, 'grad_norm': 18.871383666992188, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.10s/it] 80%|████████  | 32/40 [00:32<00:06,  1.21it/s]                                               {'loss': 2.4092, 'grad_norm': 16.703868865966797, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.21it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.09it/s]                                               {'loss': 2.4682, 'grad_norm': 3.341491937637329, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s]                                               {'loss': 2.3029, 'grad_norm': 2.604611396789551, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it]                                               {'loss': 2.3558, 'grad_norm': 3.7174346446990967, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.07s/it]                                               {'loss': 2.07, 'grad_norm': 4.906019687652588, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it]                                               {'loss': 2.3009, 'grad_norm': 3.4205846786499023, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.11s/it]                                               {'loss': 2.216, 'grad_norm': 2.922187328338623, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.11s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.12s/it]                                               {'loss': 2.3983, 'grad_norm': 3.1135170459747314, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.12s/it]100%|██████████| 40/40 [00:41<00:00,  1.18it/s]                                               {'loss': 2.9555, 'grad_norm': 15.022658348083496, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.18it/s]                                               {'train_runtime': 41.2218, 'train_samples_per_second': 13.706, 'train_steps_per_second': 0.97, 'train_loss': 2.6206669330596926, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.18it/s]100%|██████████| 40/40 [00:41<00:00,  1.03s/it]
CLIENT:43
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]                                              {'loss': 2.782, 'grad_norm': 1.960137128829956, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 3.2281, 'grad_norm': 4.4795145988464355, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:41,  1.12s/it]                                              {'loss': 3.0824, 'grad_norm': 2.9467906951904297, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.12s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 3.1577, 'grad_norm': 1.884657382965088, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.9651, 'grad_norm': 1.1996523141860962, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.8775, 'grad_norm': 1.4036041498184204, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.9588, 'grad_norm': 1.5302824974060059, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:34,  1.07s/it]                                              {'loss': 2.643, 'grad_norm': 3.4892935752868652, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:34,  1.07s/it] 22%|██▎       | 9/40 [00:09<00:33,  1.10s/it]                                              {'loss': 2.7729, 'grad_norm': 3.8564341068267822, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:33,  1.10s/it] 25%|██▌       | 10/40 [00:11<00:33,  1.11s/it]                                               {'loss': 2.8696, 'grad_norm': 1.582468867301941, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:33,  1.11s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it]                                               {'loss': 2.7024, 'grad_norm': 2.109508514404297, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it] 30%|███       | 12/40 [00:13<00:31,  1.12s/it]                                               {'loss': 2.8218, 'grad_norm': 2.17002010345459, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.12s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.10s/it]                                               {'loss': 2.7068, 'grad_norm': 2.8681702613830566, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.10s/it] 35%|███▌      | 14/40 [00:15<00:27,  1.05s/it]                                               {'loss': 2.2604, 'grad_norm': 2.8992490768432617, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:27,  1.05s/it] 38%|███▊      | 15/40 [00:16<00:25,  1.02s/it]                                               {'loss': 2.5604, 'grad_norm': 4.184682369232178, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:25,  1.02s/it] 40%|████      | 16/40 [00:16<00:18,  1.32it/s]                                               {'loss': 2.6326, 'grad_norm': 8.632328033447266, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:18,  1.32it/s] 42%|████▎     | 17/40 [00:17<00:19,  1.18it/s]                                               {'loss': 2.4403, 'grad_norm': 2.78226637840271, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:19,  1.18it/s] 45%|████▌     | 18/40 [00:18<00:20,  1.07it/s]                                               {'loss': 2.3508, 'grad_norm': 7.8800458908081055, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:20,  1.07it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.00it/s]                                               {'loss': 2.6023, 'grad_norm': 3.275628089904785, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.00it/s] 50%|█████     | 20/40 [00:20<00:20,  1.00s/it]                                               {'loss': 2.4297, 'grad_norm': 3.2046515941619873, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.00s/it] 52%|█████▎    | 21/40 [00:21<00:19,  1.04s/it]                                               {'loss': 2.2599, 'grad_norm': 3.846435308456421, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.04s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.08s/it]                                               {'loss': 2.4727, 'grad_norm': 3.3324079513549805, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.08s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.09s/it]                                               {'loss': 2.432, 'grad_norm': 3.0398545265197754, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.09s/it] 60%|██████    | 24/40 [00:24<00:13,  1.22it/s]                                               {'loss': 2.8625, 'grad_norm': 13.455645561218262, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.22it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s]                                               {'loss': 2.1859, 'grad_norm': 3.408484697341919, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s]                                               {'loss': 2.2454, 'grad_norm': 3.051431655883789, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 2.5069, 'grad_norm': 3.2467355728149414, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:12,  1.06s/it]                                               {'loss': 2.1967, 'grad_norm': 2.7149155139923096, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 2.2625, 'grad_norm': 5.632217884063721, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it]                                               {'loss': 2.2009, 'grad_norm': 3.2201693058013916, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.10s/it]                                               {'loss': 2.3385, 'grad_norm': 2.709151029586792, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.10s/it] 80%|████████  | 32/40 [00:32<00:06,  1.20it/s]                                               {'loss': 1.8793, 'grad_norm': 9.144634246826172, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s]                                               {'loss': 2.1624, 'grad_norm': 2.9726035594940186, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.09it/s]                                               {'loss': 2.1722, 'grad_norm': 2.8260562419891357, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.09it/s] 88%|████████▊ | 35/40 [00:35<00:04,  1.08it/s]                                               {'loss': 2.274, 'grad_norm': 3.3258707523345947, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:04,  1.08it/s] 90%|█████████ | 36/40 [00:36<00:03,  1.08it/s]                                               {'loss': 2.168, 'grad_norm': 4.964507102966309, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:03,  1.08it/s] 92%|█████████▎| 37/40 [00:37<00:02,  1.02it/s]                                               {'loss': 2.4158, 'grad_norm': 2.9914138317108154, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:02,  1.02it/s] 95%|█████████▌| 38/40 [00:38<00:02,  1.02s/it]                                               {'loss': 2.17, 'grad_norm': 2.7567577362060547, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.02s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.06s/it]                                               {'loss': 2.0223, 'grad_norm': 3.237705707550049, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.06s/it]100%|██████████| 40/40 [00:40<00:00,  1.26it/s]                                               {'loss': 2.2564, 'grad_norm': 17.526752471923828, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.26it/s]                                               {'train_runtime': 40.1367, 'train_samples_per_second': 14.077, 'train_steps_per_second': 0.997, 'train_loss': 2.5082170724868775, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.26it/s]100%|██████████| 40/40 [00:40<00:00,  1.00s/it]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:45,  1.16s/it]                                              {'loss': 3.2275, 'grad_norm': 3.3326168060302734, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:45,  1.16s/it]  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]                                              {'loss': 2.7995, 'grad_norm': 2.2447218894958496, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]  8%|▊         | 3/40 [00:03<00:42,  1.14s/it]                                              {'loss': 3.0579, 'grad_norm': 0.9315758943557739, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.14s/it] 10%|█         | 4/40 [00:04<00:40,  1.14s/it]                                              {'loss': 3.1788, 'grad_norm': 0.7878374457359314, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.14s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.9243, 'grad_norm': 0.516616940498352, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it]                                              {'loss': 3.0911, 'grad_norm': 1.0322329998016357, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 3.1615, 'grad_norm': 1.0447663068771362, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:32,  1.03s/it]                                              {'loss': 2.3115, 'grad_norm': 2.415717601776123, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.03s/it] 22%|██▎       | 9/40 [00:09<00:29,  1.07it/s]                                              {'loss': 3.2153, 'grad_norm': 0.977840781211853, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:29,  1.07it/s] 25%|██▌       | 10/40 [00:10<00:26,  1.15it/s]                                               {'loss': 2.7781, 'grad_norm': 1.0571212768554688, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:26,  1.15it/s] 28%|██▊       | 11/40 [00:10<00:24,  1.19it/s]                                               {'loss': 2.8039, 'grad_norm': 1.0158902406692505, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:24,  1.19it/s] 30%|███       | 12/40 [00:11<00:21,  1.30it/s]                                               {'loss': 2.7315, 'grad_norm': 1.4210208654403687, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:21,  1.30it/s] 32%|███▎      | 13/40 [00:12<00:21,  1.24it/s]                                               {'loss': 2.8997, 'grad_norm': 2.1015377044677734, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:12<00:21,  1.24it/s] 35%|███▌      | 14/40 [00:13<00:22,  1.14it/s]                                               {'loss': 2.7085, 'grad_norm': 2.304628849029541, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:22,  1.14it/s] 38%|███▊      | 15/40 [00:14<00:22,  1.11it/s]                                               {'loss': 2.7293, 'grad_norm': 3.8748300075531006, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:22,  1.11it/s] 40%|████      | 16/40 [00:14<00:16,  1.46it/s]                                               {'loss': 1.8311, 'grad_norm': 9.419198036193848, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:14<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:15<00:19,  1.21it/s]                                               {'loss': 2.5092, 'grad_norm': 4.049347400665283, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:15<00:19,  1.21it/s] 45%|████▌     | 18/40 [00:16<00:20,  1.08it/s]                                               {'loss': 2.4041, 'grad_norm': 3.7657790184020996, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:16<00:20,  1.08it/s] 48%|████▊     | 19/40 [00:18<00:20,  1.02it/s]                                               {'loss': 2.5777, 'grad_norm': 5.094857692718506, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:20,  1.02it/s] 50%|█████     | 20/40 [00:19<00:20,  1.03s/it]                                               {'loss': 2.482, 'grad_norm': 4.262977600097656, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:20,  1.03s/it] 52%|█████▎    | 21/40 [00:20<00:20,  1.06s/it]                                               {'loss': 2.4459, 'grad_norm': 4.740550518035889, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:20,  1.06s/it] 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it]                                               {'loss': 2.6964, 'grad_norm': 6.611613750457764, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it] 57%|█████▊    | 23/40 [00:22<00:18,  1.09s/it]                                               {'loss': 2.7267, 'grad_norm': 4.542447090148926, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:18,  1.09s/it] 60%|██████    | 24/40 [00:22<00:13,  1.22it/s]                                               {'loss': 2.7318, 'grad_norm': 15.050135612487793, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:13,  1.22it/s] 62%|██████▎   | 25/40 [00:23<00:13,  1.09it/s]                                               {'loss': 2.7252, 'grad_norm': 4.577354907989502, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:23<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:24<00:13,  1.05it/s]                                               {'loss': 2.5356, 'grad_norm': 3.3882992267608643, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:24<00:13,  1.05it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.01s/it]                                               {'loss': 2.0649, 'grad_norm': 3.8579883575439453, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.01s/it] 70%|███████   | 28/40 [00:27<00:12,  1.04s/it]                                               {'loss': 2.3703, 'grad_norm': 3.8682303428649902, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.04s/it] 72%|███████▎  | 29/40 [00:28<00:11,  1.04s/it]                                               {'loss': 2.4868, 'grad_norm': 3.7238590717315674, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.04s/it] 75%|███████▌  | 30/40 [00:29<00:10,  1.01s/it]                                               {'loss': 2.4653, 'grad_norm': 4.972247123718262, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:10,  1.01s/it] 78%|███████▊  | 31/40 [00:30<00:08,  1.02it/s]                                               {'loss': 2.3079, 'grad_norm': 4.3252034187316895, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:08,  1.02it/s] 80%|████████  | 32/40 [00:30<00:05,  1.34it/s]                                               {'loss': 2.9592, 'grad_norm': 14.33691692352295, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:30<00:05,  1.34it/s] 82%|████████▎ | 33/40 [00:31<00:05,  1.24it/s]                                               {'loss': 2.2627, 'grad_norm': 3.294243097305298, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:31<00:05,  1.24it/s] 85%|████████▌ | 34/40 [00:32<00:05,  1.17it/s]                                               {'loss': 2.225, 'grad_norm': 3.581127166748047, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:32<00:05,  1.17it/s] 88%|████████▊ | 35/40 [00:33<00:04,  1.14it/s]                                               {'loss': 2.2701, 'grad_norm': 3.7642550468444824, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:33<00:04,  1.14it/s] 90%|█████████ | 36/40 [00:34<00:03,  1.10it/s]                                               {'loss': 2.4181, 'grad_norm': 3.97467303276062, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:34<00:03,  1.10it/s] 92%|█████████▎| 37/40 [00:35<00:02,  1.01it/s]                                               {'loss': 2.4994, 'grad_norm': 3.920154333114624, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:35<00:02,  1.01it/s] 95%|█████████▌| 38/40 [00:36<00:02,  1.02s/it]                                               {'loss': 2.5926, 'grad_norm': 3.760807991027832, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:36<00:02,  1.02s/it] 98%|█████████▊| 39/40 [00:37<00:01,  1.06s/it]                                               {'loss': 2.3254, 'grad_norm': 4.012970924377441, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:37<00:01,  1.06s/it]100%|██████████| 40/40 [00:37<00:00,  1.27it/s]                                               {'loss': 1.4175, 'grad_norm': 13.726609230041504, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.27it/s]                                               {'train_runtime': 37.8575, 'train_samples_per_second': 14.924, 'train_steps_per_second': 1.057, 'train_loss': 2.598728534579277, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.27it/s]100%|██████████| 40/40 [00:37<00:00,  1.06it/s]
CLIENT:7
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.10s/it]                                              {'loss': 2.931, 'grad_norm': 2.164679765701294, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.10s/it]  5%|▌         | 2/40 [00:02<00:42,  1.13s/it]                                              {'loss': 3.234, 'grad_norm': 0.8969773650169373, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.13s/it]  8%|▊         | 3/40 [00:03<00:41,  1.12s/it]                                              {'loss': 2.8661, 'grad_norm': 1.4507976770401, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.12s/it] 10%|█         | 4/40 [00:04<00:39,  1.09s/it]                                              {'loss': 3.1648, 'grad_norm': 0.8205476999282837, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.09s/it] 12%|█▎        | 5/40 [00:05<00:35,  1.02s/it]                                              {'loss': 3.0971, 'grad_norm': 0.6543431282043457, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:35,  1.02s/it] 15%|█▌        | 6/40 [00:06<00:34,  1.00s/it]                                              {'loss': 2.7299, 'grad_norm': 3.5686707496643066, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:34,  1.00s/it] 18%|█▊        | 7/40 [00:07<00:33,  1.00s/it]                                              {'loss': 3.0717, 'grad_norm': 1.0791417360305786, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:33,  1.00s/it] 20%|██        | 8/40 [00:08<00:32,  1.01s/it]                                              {'loss': 3.2005, 'grad_norm': 3.780550241470337, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.01s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.04s/it]                                              {'loss': 2.7221, 'grad_norm': 1.7419170141220093, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.04s/it] 25%|██▌       | 10/40 [00:10<00:31,  1.05s/it]                                               {'loss': 2.7843, 'grad_norm': 1.5845932960510254, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:31,  1.05s/it] 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it]                                               {'loss': 2.7287, 'grad_norm': 2.235549211502075, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it] 30%|███       | 12/40 [00:12<00:28,  1.00s/it]                                               {'loss': 2.4853, 'grad_norm': 2.814718008041382, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:28,  1.00s/it] 32%|███▎      | 13/40 [00:13<00:26,  1.00it/s]                                               {'loss': 2.7693, 'grad_norm': 3.1173646450042725, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:26,  1.00it/s] 35%|███▌      | 14/40 [00:14<00:26,  1.02s/it]                                               {'loss': 2.6112, 'grad_norm': 2.694263219833374, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:26,  1.02s/it] 38%|███▊      | 15/40 [00:15<00:26,  1.05s/it]                                               {'loss': 2.9411, 'grad_norm': 3.7757585048675537, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:26,  1.05s/it] 40%|████      | 16/40 [00:15<00:19,  1.25it/s]                                               {'loss': 2.544, 'grad_norm': 11.637534141540527, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.25it/s] 42%|████▎     | 17/40 [00:16<00:20,  1.11it/s]                                               {'loss': 2.529, 'grad_norm': 4.087189674377441, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:20,  1.11it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s]                                               {'loss': 2.4528, 'grad_norm': 3.574171543121338, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.01s/it]                                               {'loss': 2.4437, 'grad_norm': 3.5851223468780518, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.01s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 2.5778, 'grad_norm': 3.842397689819336, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 2.4337, 'grad_norm': 4.06355094909668, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it]                                               {'loss': 2.3574, 'grad_norm': 3.4521403312683105, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:23<00:17,  1.04s/it]                                               {'loss': 2.5542, 'grad_norm': 4.0025835037231445, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:17,  1.04s/it] 60%|██████    | 24/40 [00:23<00:12,  1.27it/s]                                               {'loss': 1.9085, 'grad_norm': 16.16737174987793, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.27it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.20it/s]                                               {'loss': 2.3001, 'grad_norm': 2.8746144771575928, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.20it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.12it/s]                                               {'loss': 2.2572, 'grad_norm': 3.7640817165374756, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.12it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.05it/s]                                               {'loss': 2.313, 'grad_norm': 2.9616732597351074, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.05it/s] 70%|███████   | 28/40 [00:27<00:12,  1.02s/it]                                               {'loss': 2.6789, 'grad_norm': 3.187535524368286, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.02s/it] 72%|███████▎  | 29/40 [00:28<00:11,  1.02s/it]                                               {'loss': 1.9629, 'grad_norm': 3.3223671913146973, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.02s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.07s/it]                                               {'loss': 2.3142, 'grad_norm': 3.034672260284424, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.07s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.08s/it]                                               {'loss': 2.2802, 'grad_norm': 3.38352632522583, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.08s/it] 80%|████████  | 32/40 [00:31<00:06,  1.21it/s]                                               {'loss': 2.0649, 'grad_norm': 10.70643138885498, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.21it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s]                                               {'loss': 2.4163, 'grad_norm': 2.926486015319824, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s]                                               {'loss': 2.1136, 'grad_norm': 2.9875330924987793, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it]                                               {'loss': 2.2932, 'grad_norm': 3.3499786853790283, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.06s/it]                                               {'loss': 2.0997, 'grad_norm': 2.955552101135254, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.06s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it]                                               {'loss': 2.2549, 'grad_norm': 3.0571348667144775, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.11s/it]                                               {'loss': 2.2013, 'grad_norm': 3.5930869579315186, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.11s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]                                               {'loss': 2.0763, 'grad_norm': 3.3570919036865234, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'loss': 2.4733, 'grad_norm': 13.157364845275879, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'train_runtime': 39.7233, 'train_samples_per_second': 14.223, 'train_steps_per_second': 1.007, 'train_loss': 2.5309548020362853, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]                                              {'loss': 3.0704, 'grad_norm': 2.575161933898926, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]                                              {'loss': 3.3149, 'grad_norm': 0.9191431403160095, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]  8%|▊         | 3/40 [00:03<00:41,  1.11s/it]                                              {'loss': 3.1952, 'grad_norm': 0.6622398495674133, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.11s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 3.1527, 'grad_norm': 4.55355167388916, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it]                                              {'loss': 2.9065, 'grad_norm': 0.5668254494667053, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 3.2044, 'grad_norm': 1.037708044052124, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it]                                              {'loss': 3.1634, 'grad_norm': 1.1933724880218506, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it] 20%|██        | 8/40 [00:08<00:32,  1.02s/it]                                              {'loss': 2.7877, 'grad_norm': 2.7258694171905518, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.02s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it]                                              {'loss': 2.9294, 'grad_norm': 1.720572829246521, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it] 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it]                                               {'loss': 2.9093, 'grad_norm': 1.41144859790802, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it] 28%|██▊       | 11/40 [00:11<00:31,  1.10s/it]                                               {'loss': 2.9413, 'grad_norm': 1.5788731575012207, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:31,  1.10s/it] 30%|███       | 12/40 [00:13<00:30,  1.10s/it]                                               {'loss': 2.8417, 'grad_norm': 3.9373443126678467, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:30,  1.10s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it]                                               {'loss': 2.6909, 'grad_norm': 2.5027458667755127, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it]                                               {'loss': 2.9295, 'grad_norm': 3.642909526824951, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it]                                               {'loss': 2.6481, 'grad_norm': 3.605175018310547, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it] 40%|████      | 16/40 [00:16<00:19,  1.23it/s]                                               {'loss': 2.3785, 'grad_norm': 10.677868843078613, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:19,  1.23it/s] 42%|████▎     | 17/40 [00:17<00:19,  1.17it/s]                                               {'loss': 2.5007, 'grad_norm': 3.670893907546997, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:19,  1.17it/s] 45%|████▌     | 18/40 [00:18<00:19,  1.15it/s]                                               {'loss': 2.6039, 'grad_norm': 4.643182754516602, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:19,  1.15it/s] 48%|████▊     | 19/40 [00:19<00:19,  1.08it/s]                                               {'loss': 2.7687, 'grad_norm': 4.248006820678711, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:19,  1.08it/s] 50%|█████     | 20/40 [00:20<00:19,  1.02it/s]                                               {'loss': 2.5104, 'grad_norm': 4.288467884063721, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:19,  1.02it/s] 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it]                                               {'loss': 2.6633, 'grad_norm': 4.4241766929626465, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it] 55%|█████▌    | 22/40 [00:22<00:18,  1.05s/it]                                               {'loss': 2.1843, 'grad_norm': 4.470452785491943, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.05s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.08s/it]                                               {'loss': 2.4683, 'grad_norm': 3.5460972785949707, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.08s/it] 60%|██████    | 24/40 [00:24<00:13,  1.23it/s]                                               {'loss': 2.082, 'grad_norm': 13.301870346069336, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.23it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s]                                               {'loss': 2.3216, 'grad_norm': 3.6733391284942627, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s]                                               {'loss': 2.3945, 'grad_norm': 3.6618781089782715, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 2.5719, 'grad_norm': 3.4731216430664062, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:12,  1.04s/it]                                               {'loss': 2.341, 'grad_norm': 3.8880064487457275, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.04s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it]                                               {'loss': 2.5709, 'grad_norm': 3.367798328399658, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.08s/it]                                               {'loss': 2.2025, 'grad_norm': 3.420365810394287, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.08s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it]                                               {'loss': 2.2328, 'grad_norm': 6.464779853820801, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it] 80%|████████  | 32/40 [00:32<00:06,  1.22it/s]                                               {'loss': 2.1036, 'grad_norm': 15.98420238494873, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.22it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s]                                               {'loss': 2.1069, 'grad_norm': 3.0756869316101074, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.03it/s]                                               {'loss': 2.4117, 'grad_norm': 3.4483022689819336, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.03it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.00s/it]                                               {'loss': 2.1939, 'grad_norm': 3.37270188331604, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.00s/it] 90%|█████████ | 36/40 [00:36<00:03,  1.03it/s]                                               {'loss': 2.2964, 'grad_norm': 2.81097674369812, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:03,  1.03it/s] 92%|█████████▎| 37/40 [00:37<00:02,  1.03it/s]                                               {'loss': 2.3406, 'grad_norm': 3.2671632766723633, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:02,  1.03it/s] 95%|█████████▌| 38/40 [00:38<00:01,  1.06it/s]                                               {'loss': 2.3601, 'grad_norm': 6.008814811706543, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:01,  1.06it/s] 98%|█████████▊| 39/40 [00:39<00:01,  1.00s/it]                                               {'loss': 2.3513, 'grad_norm': 4.337148189544678, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.00s/it]100%|██████████| 40/40 [00:39<00:00,  1.33it/s]                                               {'loss': 2.177, 'grad_norm': 12.492053985595703, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.33it/s]                                               {'train_runtime': 39.7844, 'train_samples_per_second': 14.202, 'train_steps_per_second': 1.005, 'train_loss': 2.5955510318279265, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.33it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<02:03,  3.81it/s]  1%|          | 3/471 [00:01<03:02,  2.57it/s]  1%|          | 4/471 [00:01<03:27,  2.25it/s]  1%|          | 5/471 [00:02<03:43,  2.08it/s]  1%|▏         | 6/471 [00:02<03:53,  1.99it/s]  1%|▏         | 7/471 [00:03<03:53,  1.99it/s]  2%|▏         | 8/471 [00:03<03:57,  1.95it/s]  2%|▏         | 9/471 [00:04<04:03,  1.89it/s]  2%|▏         | 10/471 [00:04<04:03,  1.89it/s]  2%|▏         | 11/471 [00:05<04:05,  1.87it/s]  3%|▎         | 12/471 [00:05<04:06,  1.86it/s]  3%|▎         | 13/471 [00:06<04:02,  1.89it/s]  3%|▎         | 14/471 [00:06<04:02,  1.89it/s]  3%|▎         | 15/471 [00:07<04:03,  1.87it/s]  3%|▎         | 16/471 [00:08<04:02,  1.88it/s]  4%|▎         | 17/471 [00:08<03:50,  1.97it/s]  4%|▍         | 18/471 [00:08<03:42,  2.03it/s]  4%|▍         | 19/471 [00:09<03:35,  2.10it/s]  4%|▍         | 20/471 [00:09<03:29,  2.15it/s]  4%|▍         | 21/471 [00:10<03:30,  2.14it/s]  5%|▍         | 22/471 [00:10<03:28,  2.15it/s]  5%|▍         | 23/471 [00:11<03:27,  2.16it/s]  5%|▌         | 24/471 [00:11<03:35,  2.08it/s]  5%|▌         | 25/471 [00:12<03:40,  2.03it/s]  6%|▌         | 26/471 [00:12<03:47,  1.96it/s]  6%|▌         | 27/471 [00:13<03:51,  1.92it/s]  6%|▌         | 28/471 [00:13<03:54,  1.89it/s]  6%|▌         | 29/471 [00:14<03:57,  1.86it/s]  6%|▋         | 30/471 [00:15<03:59,  1.84it/s]  7%|▋         | 31/471 [00:15<03:55,  1.87it/s]  7%|▋         | 32/471 [00:16<03:55,  1.86it/s]  7%|▋         | 33/471 [00:16<03:53,  1.87it/s]  7%|▋         | 34/471 [00:17<03:57,  1.84it/s]  7%|▋         | 35/471 [00:17<03:58,  1.83it/s]  8%|▊         | 36/471 [00:18<03:59,  1.82it/s]  8%|▊         | 37/471 [00:18<03:55,  1.84it/s]  8%|▊         | 38/471 [00:19<03:55,  1.84it/s]  8%|▊         | 39/471 [00:19<03:57,  1.82it/s]  8%|▊         | 40/471 [00:20<03:57,  1.81it/s]  9%|▊         | 41/471 [00:21<03:53,  1.84it/s]  9%|▉         | 42/471 [00:21<03:41,  1.94it/s]  9%|▉         | 43/471 [00:21<03:29,  2.05it/s]  9%|▉         | 44/471 [00:22<03:23,  2.10it/s] 10%|▉         | 45/471 [00:22<03:14,  2.19it/s] 10%|▉         | 46/471 [00:23<03:04,  2.30it/s] 10%|▉         | 47/471 [00:23<03:06,  2.28it/s] 10%|█         | 48/471 [00:24<03:08,  2.25it/s] 10%|█         | 49/471 [00:24<03:07,  2.25it/s] 11%|█         | 50/471 [00:24<03:08,  2.23it/s] 11%|█         | 51/471 [00:25<03:10,  2.20it/s] 11%|█         | 52/471 [00:25<03:24,  2.05it/s] 11%|█▏        | 53/471 [00:26<03:32,  1.97it/s] 11%|█▏        | 54/471 [00:27<03:37,  1.91it/s] 12%|█▏        | 55/471 [00:27<03:38,  1.90it/s] 12%|█▏        | 56/471 [00:28<03:43,  1.86it/s] 12%|█▏        | 57/471 [00:28<03:44,  1.84it/s] 12%|█▏        | 58/471 [00:29<03:46,  1.83it/s] 13%|█▎        | 59/471 [00:29<03:47,  1.81it/s] 13%|█▎        | 60/471 [00:30<03:44,  1.83it/s] 13%|█▎        | 61/471 [00:30<03:43,  1.83it/s] 13%|█▎        | 62/471 [00:31<03:45,  1.81it/s] 13%|█▎        | 63/471 [00:32<03:46,  1.80it/s] 14%|█▎        | 64/471 [00:32<03:46,  1.80it/s] 14%|█▍        | 65/471 [00:33<03:44,  1.81it/s] 14%|█▍        | 66/471 [00:33<03:38,  1.85it/s] 14%|█▍        | 67/471 [00:34<03:40,  1.84it/s] 14%|█▍        | 68/471 [00:34<03:40,  1.83it/s] 15%|█▍        | 69/471 [00:35<03:37,  1.85it/s] 15%|█▍        | 70/471 [00:35<03:38,  1.84it/s] 15%|█▌        | 71/471 [00:36<03:37,  1.84it/s] 15%|█▌        | 72/471 [00:36<03:35,  1.85it/s] 15%|█▌        | 73/471 [00:37<03:31,  1.88it/s] 16%|█▌        | 74/471 [00:37<03:31,  1.88it/s] 16%|█▌        | 75/471 [00:38<03:33,  1.85it/s] 16%|█▌        | 76/471 [00:39<03:35,  1.83it/s] 16%|█▋        | 77/471 [00:39<03:35,  1.83it/s] 17%|█▋        | 78/471 [00:40<03:35,  1.82it/s] 17%|█▋        | 79/471 [00:40<03:33,  1.84it/s] 17%|█▋        | 80/471 [00:41<03:30,  1.86it/s] 17%|█▋        | 81/471 [00:41<03:32,  1.84it/s] 17%|█▋        | 82/471 [00:42<03:31,  1.84it/s] 18%|█▊        | 83/471 [00:42<03:29,  1.85it/s] 18%|█▊        | 84/471 [00:43<03:19,  1.94it/s] 18%|█▊        | 85/471 [00:43<03:14,  1.99it/s] 18%|█▊        | 86/471 [00:44<03:04,  2.09it/s] 18%|█▊        | 87/471 [00:44<03:00,  2.13it/s] 19%|█▊        | 88/471 [00:45<02:57,  2.15it/s] 19%|█▉        | 89/471 [00:45<03:05,  2.06it/s] 19%|█▉        | 90/471 [00:46<03:14,  1.96it/s] 19%|█▉        | 91/471 [00:46<03:18,  1.91it/s] 20%|█▉        | 92/471 [00:47<03:17,  1.92it/s] 20%|█▉        | 93/471 [00:47<03:21,  1.87it/s] 20%|█▉        | 94/471 [00:48<03:23,  1.85it/s] 20%|██        | 95/471 [00:49<03:25,  1.83it/s] 20%|██        | 96/471 [00:49<03:25,  1.83it/s] 21%|██        | 97/471 [00:50<03:23,  1.84it/s] 21%|██        | 98/471 [00:50<03:18,  1.88it/s] 21%|██        | 99/471 [00:51<03:18,  1.87it/s] 21%|██        | 100/471 [00:51<03:20,  1.85it/s] 21%|██▏       | 101/471 [00:52<03:19,  1.85it/s] 22%|██▏       | 102/471 [00:52<03:21,  1.83it/s] 22%|██▏       | 103/471 [00:53<03:18,  1.85it/s] 22%|██▏       | 104/471 [00:53<03:20,  1.83it/s] 22%|██▏       | 105/471 [00:54<03:17,  1.85it/s] 23%|██▎       | 106/471 [00:54<03:19,  1.83it/s] 23%|██▎       | 107/471 [00:55<03:19,  1.82it/s] 23%|██▎       | 108/471 [00:56<03:17,  1.84it/s] 23%|██▎       | 109/471 [00:56<03:18,  1.83it/s] 23%|██▎       | 110/471 [00:57<03:17,  1.83it/s] 24%|██▎       | 111/471 [00:57<03:17,  1.82it/s] 24%|██▍       | 112/471 [00:58<03:19,  1.80it/s] 24%|██▍       | 113/471 [00:58<03:18,  1.80it/s] 24%|██▍       | 114/471 [00:59<03:16,  1.82it/s] 24%|██▍       | 115/471 [00:59<03:15,  1.82it/s] 25%|██▍       | 116/471 [01:00<03:15,  1.81it/s] 25%|██▍       | 117/471 [01:01<03:17,  1.79it/s] 25%|██▌       | 118/471 [01:01<03:16,  1.79it/s] 25%|██▌       | 119/471 [01:02<03:16,  1.79it/s] 25%|██▌       | 120/471 [01:02<03:11,  1.84it/s] 26%|██▌       | 121/471 [01:03<03:13,  1.81it/s] 26%|██▌       | 122/471 [01:03<03:14,  1.80it/s] 26%|██▌       | 123/471 [01:04<03:12,  1.81it/s] 26%|██▋       | 124/471 [01:04<03:11,  1.81it/s] 27%|██▋       | 125/471 [01:05<03:09,  1.83it/s] 27%|██▋       | 126/471 [01:05<03:05,  1.86it/s] 27%|██▋       | 127/471 [01:06<03:07,  1.84it/s] 27%|██▋       | 128/471 [01:07<03:00,  1.90it/s] 27%|██▋       | 129/471 [01:07<02:53,  1.97it/s] 28%|██▊       | 130/471 [01:07<02:48,  2.02it/s] 28%|██▊       | 131/471 [01:08<02:44,  2.07it/s] 28%|██▊       | 132/471 [01:08<02:40,  2.11it/s] 28%|██▊       | 133/471 [01:09<02:41,  2.10it/s] 28%|██▊       | 134/471 [01:09<02:50,  1.98it/s] 29%|██▊       | 135/471 [01:10<02:56,  1.90it/s] 29%|██▉       | 136/471 [01:11<02:59,  1.87it/s] 29%|██▉       | 137/471 [01:11<02:59,  1.86it/s] 29%|██▉       | 138/471 [01:12<02:58,  1.87it/s] 30%|██▉       | 139/471 [01:12<03:00,  1.84it/s] 30%|██▉       | 140/471 [01:13<03:02,  1.81it/s] 30%|██▉       | 141/471 [01:13<03:03,  1.80it/s] 30%|███       | 142/471 [01:14<03:02,  1.80it/s] 30%|███       | 143/471 [01:14<02:57,  1.85it/s] 31%|███       | 144/471 [01:15<02:59,  1.82it/s] 31%|███       | 145/471 [01:15<03:00,  1.80it/s] 31%|███       | 146/471 [01:16<03:00,  1.81it/s] 31%|███       | 147/471 [01:17<02:59,  1.81it/s] 31%|███▏      | 148/471 [01:17<02:56,  1.83it/s] 32%|███▏      | 149/471 [01:18<02:58,  1.81it/s] 32%|███▏      | 150/471 [01:18<03:00,  1.78it/s] 32%|███▏      | 151/471 [01:19<02:59,  1.79it/s] 32%|███▏      | 152/471 [01:19<02:56,  1.81it/s] 32%|███▏      | 153/471 [01:20<02:53,  1.83it/s] 33%|███▎      | 154/471 [01:20<02:54,  1.81it/s] 33%|███▎      | 155/471 [01:21<02:56,  1.79it/s] 33%|███▎      | 156/471 [01:22<02:56,  1.79it/s] 33%|███▎      | 157/471 [01:22<02:55,  1.79it/s] 34%|███▎      | 158/471 [01:23<02:51,  1.82it/s] 34%|███▍      | 159/471 [01:23<02:49,  1.84it/s] 34%|███▍      | 160/471 [01:24<02:51,  1.81it/s] 34%|███▍      | 161/471 [01:24<02:52,  1.80it/s] 34%|███▍      | 162/471 [01:25<02:50,  1.81it/s] 35%|███▍      | 163/471 [01:25<02:49,  1.82it/s] 35%|███▍      | 164/471 [01:26<02:49,  1.81it/s] 35%|███▌      | 165/471 [01:27<02:50,  1.80it/s] 35%|███▌      | 166/471 [01:27<02:49,  1.80it/s] 35%|███▌      | 167/471 [01:28<02:48,  1.80it/s] 36%|███▌      | 168/471 [01:28<02:45,  1.83it/s] 36%|███▌      | 169/471 [01:29<02:47,  1.81it/s] 36%|███▌      | 170/471 [01:29<02:48,  1.79it/s] 36%|███▋      | 171/471 [01:30<02:48,  1.79it/s] 37%|███▋      | 172/471 [01:30<02:46,  1.80it/s] 37%|███▋      | 173/471 [01:31<02:42,  1.84it/s] 37%|███▋      | 174/471 [01:32<02:41,  1.84it/s] 37%|███▋      | 175/471 [01:32<02:43,  1.81it/s] 37%|███▋      | 176/471 [01:33<02:43,  1.81it/s] 38%|███▊      | 177/471 [01:33<02:44,  1.79it/s] 38%|███▊      | 178/471 [01:34<02:42,  1.80it/s] 38%|███▊      | 179/471 [01:34<02:38,  1.85it/s] 38%|███▊      | 180/471 [01:35<02:37,  1.85it/s] 38%|███▊      | 181/471 [01:35<02:38,  1.83it/s] 39%|███▊      | 182/471 [01:36<02:40,  1.81it/s] 39%|███▉      | 183/471 [01:36<02:39,  1.81it/s] 39%|███▉      | 184/471 [01:37<02:38,  1.81it/s] 39%|███▉      | 185/471 [01:38<02:37,  1.82it/s] 39%|███▉      | 186/471 [01:38<02:33,  1.85it/s] 40%|███▉      | 187/471 [01:39<02:36,  1.82it/s] 40%|███▉      | 188/471 [01:39<02:36,  1.81it/s] 40%|████      | 189/471 [01:40<02:35,  1.81it/s] 40%|████      | 190/471 [01:40<02:35,  1.81it/s] 41%|████      | 191/471 [01:41<02:34,  1.81it/s] 41%|████      | 192/471 [01:41<02:31,  1.84it/s] 41%|████      | 193/471 [01:42<02:32,  1.83it/s] 41%|████      | 194/471 [01:43<02:32,  1.81it/s] 41%|████▏     | 195/471 [01:43<02:32,  1.81it/s] 42%|████▏     | 196/471 [01:44<02:32,  1.80it/s] 42%|████▏     | 197/471 [01:44<02:30,  1.82it/s] 42%|████▏     | 198/471 [01:45<02:27,  1.85it/s] 42%|████▏     | 199/471 [01:45<02:28,  1.84it/s] 42%|████▏     | 200/471 [01:46<02:29,  1.82it/s] 43%|████▎     | 201/471 [01:46<02:27,  1.83it/s] 43%|████▎     | 202/471 [01:47<02:27,  1.82it/s] 43%|████▎     | 203/471 [01:47<02:27,  1.82it/s] 43%|████▎     | 204/471 [01:48<02:25,  1.84it/s] 44%|████▎     | 205/471 [01:49<02:25,  1.83it/s] 44%|████▎     | 206/471 [01:49<02:25,  1.82it/s] 44%|████▍     | 207/471 [01:50<02:26,  1.81it/s] 44%|████▍     | 208/471 [01:50<02:26,  1.80it/s] 44%|████▍     | 209/471 [01:51<02:23,  1.83it/s] 45%|████▍     | 210/471 [01:51<02:13,  1.95it/s] 45%|████▍     | 211/471 [01:52<02:09,  2.01it/s] 45%|████▌     | 212/471 [01:52<02:05,  2.06it/s] 45%|████▌     | 213/471 [01:53<02:04,  2.08it/s] 45%|████▌     | 214/471 [01:53<02:08,  2.00it/s] 46%|████▌     | 215/471 [01:54<02:10,  1.97it/s] 46%|████▌     | 216/471 [01:54<02:11,  1.93it/s] 46%|████▌     | 217/471 [01:55<02:15,  1.88it/s] 46%|████▋     | 218/471 [01:55<02:17,  1.84it/s] 46%|████▋     | 219/471 [01:56<02:16,  1.85it/s] 47%|████▋     | 220/471 [01:56<02:15,  1.85it/s] 47%|████▋     | 221/471 [01:57<02:15,  1.85it/s] 47%|████▋     | 222/471 [01:57<02:14,  1.85it/s] 47%|████▋     | 223/471 [01:58<02:15,  1.82it/s] 48%|████▊     | 224/471 [01:59<02:17,  1.79it/s] 48%|████▊     | 225/471 [01:59<02:15,  1.81it/s] 48%|████▊     | 226/471 [02:00<02:12,  1.84it/s] 48%|████▊     | 227/471 [02:00<02:13,  1.82it/s] 48%|████▊     | 228/471 [02:01<02:14,  1.81it/s] 49%|████▊     | 229/471 [02:01<02:13,  1.82it/s] 49%|████▉     | 230/471 [02:02<02:12,  1.82it/s] 49%|████▉     | 231/471 [02:02<02:09,  1.86it/s] 49%|████▉     | 232/471 [02:03<02:07,  1.88it/s] 49%|████▉     | 233/471 [02:03<02:08,  1.85it/s] 50%|████▉     | 234/471 [02:04<02:09,  1.83it/s] 50%|████▉     | 235/471 [02:05<02:08,  1.83it/s] 50%|█████     | 236/471 [02:05<02:07,  1.84it/s] 50%|█████     | 237/471 [02:06<02:04,  1.88it/s] 51%|█████     | 238/471 [02:06<02:00,  1.93it/s] 51%|█████     | 239/471 [02:07<02:01,  1.91it/s] 51%|█████     | 240/471 [02:07<02:03,  1.87it/s] 51%|█████     | 241/471 [02:08<02:05,  1.83it/s] 51%|█████▏    | 242/471 [02:08<02:06,  1.82it/s] 52%|█████▏    | 243/471 [02:09<02:05,  1.82it/s] 52%|█████▏    | 244/471 [02:09<02:01,  1.87it/s] 52%|█████▏    | 245/471 [02:10<01:55,  1.96it/s] 52%|█████▏    | 246/471 [02:10<01:50,  2.04it/s] 52%|█████▏    | 247/471 [02:11<01:47,  2.09it/s] 53%|█████▎    | 248/471 [02:11<01:45,  2.11it/s] 53%|█████▎    | 249/471 [02:12<01:44,  2.12it/s] 53%|█████▎    | 250/471 [02:12<01:47,  2.05it/s] 53%|█████▎    | 251/471 [02:13<01:46,  2.07it/s] 54%|█████▎    | 252/471 [02:13<01:42,  2.14it/s] 54%|█████▎    | 253/471 [02:14<01:45,  2.07it/s] 54%|█████▍    | 254/471 [02:14<01:49,  1.99it/s] 54%|█████▍    | 255/471 [02:15<01:51,  1.93it/s] 54%|█████▍    | 256/471 [02:15<01:52,  1.91it/s] 55%|█████▍    | 257/471 [02:16<01:51,  1.92it/s] 55%|█████▍    | 258/471 [02:16<01:49,  1.94it/s] 55%|█████▍    | 259/471 [02:17<01:49,  1.93it/s] 55%|█████▌    | 260/471 [02:17<01:52,  1.88it/s] 55%|█████▌    | 261/471 [02:18<01:52,  1.87it/s] 56%|█████▌    | 262/471 [02:18<01:53,  1.85it/s] 56%|█████▌    | 263/471 [02:19<01:53,  1.83it/s] 56%|█████▌    | 264/471 [02:20<01:52,  1.84it/s] 56%|█████▋    | 265/471 [02:20<01:51,  1.84it/s] 56%|█████▋    | 266/471 [02:21<01:52,  1.83it/s] 57%|█████▋    | 267/471 [02:21<01:53,  1.80it/s] 57%|█████▋    | 268/471 [02:22<01:52,  1.81it/s] 57%|█████▋    | 269/471 [02:22<01:52,  1.79it/s] 57%|█████▋    | 270/471 [02:23<01:47,  1.86it/s] 58%|█████▊    | 271/471 [02:23<01:47,  1.87it/s] 58%|█████▊    | 272/471 [02:24<01:48,  1.83it/s] 58%|█████▊    | 273/471 [02:25<01:48,  1.82it/s] 58%|█████▊    | 274/471 [02:25<01:47,  1.83it/s] 58%|█████▊    | 275/471 [02:26<01:46,  1.83it/s] 59%|█████▊    | 276/471 [02:26<01:44,  1.87it/s] 59%|█████▉    | 277/471 [02:27<01:45,  1.84it/s] 59%|█████▉    | 278/471 [02:27<01:45,  1.83it/s] 59%|█████▉    | 279/471 [02:28<01:45,  1.83it/s] 59%|█████▉    | 280/471 [02:28<01:43,  1.84it/s] 60%|█████▉    | 281/471 [02:29<01:43,  1.84it/s] 60%|█████▉    | 282/471 [02:29<01:43,  1.82it/s] 60%|██████    | 283/471 [02:30<01:39,  1.89it/s] 60%|██████    | 284/471 [02:30<01:35,  1.96it/s] 61%|██████    | 285/471 [02:31<01:31,  2.02it/s] 61%|██████    | 286/471 [02:31<01:27,  2.11it/s] 61%|██████    | 287/471 [02:32<01:26,  2.13it/s] 61%|██████    | 288/471 [02:32<01:26,  2.12it/s] 61%|██████▏   | 289/471 [02:33<01:30,  2.02it/s] 62%|██████▏   | 290/471 [02:33<01:32,  1.96it/s] 62%|██████▏   | 291/471 [02:34<01:33,  1.93it/s] 62%|██████▏   | 292/471 [02:34<01:32,  1.93it/s] 62%|██████▏   | 293/471 [02:35<01:34,  1.88it/s] 62%|██████▏   | 294/471 [02:35<01:36,  1.84it/s] 63%|██████▎   | 295/471 [02:36<01:34,  1.85it/s] 63%|██████▎   | 296/471 [02:37<01:34,  1.84it/s] 63%|██████▎   | 297/471 [02:37<01:32,  1.88it/s] 63%|██████▎   | 298/471 [02:38<01:33,  1.85it/s] 63%|██████▎   | 299/471 [02:38<01:33,  1.83it/s] 64%|██████▎   | 300/471 [02:39<01:33,  1.82it/s] 64%|██████▍   | 301/471 [02:39<01:32,  1.83it/s] 64%|██████▍   | 302/471 [02:40<01:31,  1.84it/s] 64%|██████▍   | 303/471 [02:40<01:30,  1.85it/s] 65%|██████▍   | 304/471 [02:41<01:31,  1.83it/s] 65%|██████▍   | 305/471 [02:41<01:31,  1.82it/s] 65%|██████▍   | 306/471 [02:42<01:31,  1.81it/s] 65%|██████▌   | 307/471 [02:43<01:28,  1.85it/s] 65%|██████▌   | 308/471 [02:43<01:29,  1.82it/s] 66%|██████▌   | 309/471 [02:44<01:29,  1.80it/s] 66%|██████▌   | 310/471 [02:44<01:29,  1.79it/s] 66%|██████▌   | 311/471 [02:45<01:28,  1.82it/s] 66%|██████▌   | 312/471 [02:45<01:26,  1.83it/s] 66%|██████▋   | 313/471 [02:46<01:26,  1.83it/s] 67%|██████▋   | 314/471 [02:46<01:26,  1.81it/s] 67%|██████▋   | 315/471 [02:47<01:26,  1.80it/s] 67%|██████▋   | 316/471 [02:48<01:25,  1.81it/s] 67%|██████▋   | 317/471 [02:48<01:23,  1.84it/s] 68%|██████▊   | 318/471 [02:49<01:24,  1.82it/s] 68%|██████▊   | 319/471 [02:49<01:23,  1.83it/s] 68%|██████▊   | 320/471 [02:50<01:18,  1.92it/s] 68%|██████▊   | 321/471 [02:50<01:15,  2.00it/s] 68%|██████▊   | 322/471 [02:51<01:11,  2.08it/s] 69%|██████▊   | 323/471 [02:51<01:09,  2.14it/s] 69%|██████▉   | 324/471 [02:51<01:09,  2.13it/s] 69%|██████▉   | 325/471 [02:52<01:12,  2.03it/s] 69%|██████▉   | 326/471 [02:52<01:13,  1.97it/s] 69%|██████▉   | 327/471 [02:53<01:13,  1.97it/s] 70%|██████▉   | 328/471 [02:53<01:10,  2.03it/s] 70%|██████▉   | 329/471 [02:54<01:09,  2.05it/s] 70%|███████   | 330/471 [02:54<01:08,  2.07it/s] 70%|███████   | 331/471 [02:55<01:06,  2.12it/s] 70%|███████   | 332/471 [02:55<01:01,  2.26it/s] 71%|███████   | 333/471 [02:56<00:57,  2.40it/s] 71%|███████   | 334/471 [02:56<00:57,  2.40it/s] 71%|███████   | 335/471 [02:56<00:57,  2.35it/s] 71%|███████▏  | 336/471 [02:57<00:58,  2.29it/s] 72%|███████▏  | 337/471 [02:57<00:59,  2.26it/s] 72%|███████▏  | 338/471 [02:58<01:00,  2.21it/s] 72%|███████▏  | 339/471 [02:58<01:04,  2.06it/s] 72%|███████▏  | 340/471 [02:59<01:05,  1.99it/s] 72%|███████▏  | 341/471 [02:59<01:06,  1.97it/s] 73%|███████▎  | 342/471 [03:00<01:07,  1.92it/s] 73%|███████▎  | 343/471 [03:01<01:08,  1.87it/s] 73%|███████▎  | 344/471 [03:01<01:08,  1.85it/s] 73%|███████▎  | 345/471 [03:02<01:09,  1.82it/s] 73%|███████▎  | 346/471 [03:02<01:08,  1.83it/s] 74%|███████▎  | 347/471 [03:03<01:06,  1.86it/s] 74%|███████▍  | 348/471 [03:03<01:06,  1.84it/s] 74%|███████▍  | 349/471 [03:04<01:07,  1.82it/s] 74%|███████▍  | 350/471 [03:04<01:07,  1.81it/s] 75%|███████▍  | 351/471 [03:05<01:06,  1.82it/s] 75%|███████▍  | 352/471 [03:06<01:03,  1.86it/s] 75%|███████▍  | 353/471 [03:06<01:03,  1.85it/s] 75%|███████▌  | 354/471 [03:07<01:03,  1.84it/s] 75%|███████▌  | 355/471 [03:07<01:02,  1.87it/s] 76%|███████▌  | 356/471 [03:08<00:58,  1.96it/s] 76%|███████▌  | 357/471 [03:08<00:56,  2.04it/s] 76%|███████▌  | 358/471 [03:08<00:54,  2.07it/s] 76%|███████▌  | 359/471 [03:09<00:52,  2.13it/s] 76%|███████▋  | 360/471 [03:09<00:50,  2.21it/s] 77%|███████▋  | 361/471 [03:10<00:51,  2.12it/s] 77%|███████▋  | 362/471 [03:10<00:53,  2.02it/s] 77%|███████▋  | 363/471 [03:11<00:54,  1.98it/s] 77%|███████▋  | 364/471 [03:11<00:55,  1.94it/s] 77%|███████▋  | 365/471 [03:12<00:55,  1.91it/s] 78%|███████▊  | 366/471 [03:13<00:55,  1.90it/s] 78%|███████▊  | 367/471 [03:13<00:54,  1.91it/s] 78%|███████▊  | 368/471 [03:14<00:52,  1.96it/s] 78%|███████▊  | 369/471 [03:14<00:49,  2.07it/s] 79%|███████▊  | 370/471 [03:14<00:46,  2.16it/s] 79%|███████▉  | 371/471 [03:15<00:46,  2.17it/s] 79%|███████▉  | 372/471 [03:15<00:45,  2.17it/s] 79%|███████▉  | 373/471 [03:16<00:44,  2.19it/s] 79%|███████▉  | 374/471 [03:16<00:44,  2.19it/s] 80%|███████▉  | 375/471 [03:17<00:46,  2.08it/s] 80%|███████▉  | 376/471 [03:17<00:47,  2.01it/s] 80%|████████  | 377/471 [03:18<00:47,  1.99it/s] 80%|████████  | 378/471 [03:18<00:47,  1.97it/s] 80%|████████  | 379/471 [03:19<00:47,  1.93it/s] 81%|████████  | 380/471 [03:19<00:48,  1.87it/s] 81%|████████  | 381/471 [03:20<00:49,  1.83it/s] 81%|████████  | 382/471 [03:21<00:48,  1.82it/s] 81%|████████▏ | 383/471 [03:21<00:47,  1.85it/s] 82%|████████▏ | 384/471 [03:22<00:46,  1.87it/s] 82%|████████▏ | 385/471 [03:22<00:46,  1.84it/s] 82%|████████▏ | 386/471 [03:23<00:46,  1.81it/s] 82%|████████▏ | 387/471 [03:23<00:46,  1.80it/s] 82%|████████▏ | 388/471 [03:24<00:46,  1.80it/s] 83%|████████▎ | 389/471 [03:24<00:44,  1.85it/s] 83%|████████▎ | 390/471 [03:25<00:43,  1.85it/s] 83%|████████▎ | 391/471 [03:25<00:43,  1.83it/s] 83%|████████▎ | 392/471 [03:26<00:41,  1.92it/s] 83%|████████▎ | 393/471 [03:26<00:38,  2.00it/s] 84%|████████▎ | 394/471 [03:27<00:37,  2.05it/s] 84%|████████▍ | 395/471 [03:27<00:35,  2.12it/s] 84%|████████▍ | 396/471 [03:28<00:34,  2.15it/s] 84%|████████▍ | 397/471 [03:28<00:34,  2.15it/s] 85%|████████▍ | 398/471 [03:29<00:35,  2.05it/s] 85%|████████▍ | 399/471 [03:29<00:36,  1.96it/s] 85%|████████▍ | 400/471 [03:30<00:37,  1.90it/s] 85%|████████▌ | 401/471 [03:30<00:37,  1.88it/s] 85%|████████▌ | 402/471 [03:31<00:36,  1.87it/s] 86%|████████▌ | 403/471 [03:31<00:36,  1.87it/s] 86%|████████▌ | 404/471 [03:32<00:36,  1.85it/s] 86%|████████▌ | 405/471 [03:33<00:36,  1.81it/s] 86%|████████▌ | 406/471 [03:33<00:36,  1.80it/s] 86%|████████▋ | 407/471 [03:34<00:35,  1.82it/s] 87%|████████▋ | 408/471 [03:34<00:33,  1.86it/s] 87%|████████▋ | 409/471 [03:35<00:33,  1.85it/s] 87%|████████▋ | 410/471 [03:35<00:32,  1.85it/s] 87%|████████▋ | 411/471 [03:36<00:32,  1.83it/s] 87%|████████▋ | 412/471 [03:36<00:31,  1.85it/s] 88%|████████▊ | 413/471 [03:37<00:30,  1.93it/s] 88%|████████▊ | 414/471 [03:37<00:28,  2.03it/s] 88%|████████▊ | 415/471 [03:38<00:26,  2.10it/s] 88%|████████▊ | 416/471 [03:38<00:26,  2.10it/s] 89%|████████▊ | 417/471 [03:39<00:25,  2.11it/s] 89%|████████▊ | 418/471 [03:39<00:25,  2.05it/s] 89%|████████▉ | 419/471 [03:40<00:26,  1.97it/s] 89%|████████▉ | 420/471 [03:40<00:26,  1.94it/s] 89%|████████▉ | 421/471 [03:41<00:25,  1.97it/s] 90%|████████▉ | 422/471 [03:41<00:25,  1.94it/s] 90%|████████▉ | 423/471 [03:42<00:25,  1.91it/s] 90%|█████████ | 424/471 [03:42<00:24,  1.90it/s] 90%|█████████ | 425/471 [03:43<00:24,  1.89it/s] 90%|█████████ | 426/471 [03:43<00:24,  1.87it/s] 91%|█████████ | 427/471 [03:44<00:23,  1.87it/s] 91%|█████████ | 428/471 [03:44<00:22,  1.94it/s] 91%|█████████ | 429/471 [03:45<00:20,  2.05it/s] 91%|█████████▏| 430/471 [03:45<00:18,  2.16it/s] 92%|█████████▏| 431/471 [03:46<00:18,  2.20it/s] 92%|█████████▏| 432/471 [03:46<00:17,  2.17it/s] 92%|█████████▏| 433/471 [03:47<00:17,  2.19it/s] 92%|█████████▏| 434/471 [03:47<00:17,  2.16it/s] 92%|█████████▏| 435/471 [03:48<00:17,  2.04it/s] 93%|█████████▎| 436/471 [03:48<00:17,  1.96it/s] 93%|█████████▎| 437/471 [03:49<00:17,  1.95it/s] 93%|█████████▎| 438/471 [03:49<00:17,  1.90it/s] 93%|█████████▎| 439/471 [03:50<00:17,  1.86it/s] 93%|█████████▎| 440/471 [03:50<00:16,  1.83it/s] 94%|█████████▎| 441/471 [03:51<00:16,  1.84it/s] 94%|█████████▍| 442/471 [03:51<00:15,  1.87it/s] 94%|█████████▍| 443/471 [03:52<00:14,  1.92it/s] 94%|█████████▍| 444/471 [03:53<00:14,  1.89it/s] 94%|█████████▍| 445/471 [03:53<00:13,  1.88it/s] 95%|█████████▍| 446/471 [03:54<00:13,  1.87it/s] 95%|█████████▍| 447/471 [03:54<00:12,  1.91it/s] 95%|█████████▌| 448/471 [03:55<00:12,  1.87it/s] 95%|█████████▌| 449/471 [03:55<00:11,  1.85it/s] 96%|█████████▌| 450/471 [03:56<00:11,  1.86it/s] 96%|█████████▌| 451/471 [03:56<00:10,  1.86it/s] 96%|█████████▌| 452/471 [03:57<00:10,  1.83it/s] 96%|█████████▌| 453/471 [03:57<00:09,  1.85it/s] 96%|█████████▋| 454/471 [03:58<00:09,  1.82it/s] 97%|█████████▋| 455/471 [03:59<00:08,  1.81it/s] 97%|█████████▋| 456/471 [03:59<00:08,  1.83it/s] 97%|█████████▋| 457/471 [04:00<00:07,  1.81it/s] 97%|█████████▋| 458/471 [04:00<00:07,  1.83it/s] 97%|█████████▋| 459/471 [04:01<00:06,  1.82it/s] 98%|█████████▊| 460/471 [04:01<00:06,  1.81it/s] 98%|█████████▊| 461/471 [04:02<00:05,  1.81it/s] 98%|█████████▊| 462/471 [04:02<00:04,  1.82it/s] 98%|█████████▊| 463/471 [04:03<00:04,  1.82it/s] 99%|█████████▊| 464/471 [04:03<00:03,  1.80it/s] 99%|█████████▊| 465/471 [04:04<00:03,  1.80it/s] 99%|█████████▉| 466/471 [04:05<00:02,  1.87it/s] 99%|█████████▉| 467/471 [04:05<00:02,  1.98it/s] 99%|█████████▉| 468/471 [04:05<00:01,  2.09it/s]100%|█████████▉| 469/471 [04:06<00:00,  2.13it/s]100%|█████████▉| 470/471 [04:06<00:00,  2.15it/s]100%|██████████| 471/471 [04:07<00:00,  2.19it/s]100%|██████████| 471/471 [04:07<00:00,  1.91it/s]
{'eval_loss': 2.6725199222564697, 'eval_model_preparation_time': 0.0097, 'eval_acc': 0.2688528943175783, 'eval_runtime': 247.7444, 'eval_samples_per_second': 30.402, 'eval_steps_per_second': 1.901}
ROUND:1
CLIENT:26
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]                                              {'loss': 2.6588, 'grad_norm': 2.3424837589263916, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]  5%|▌         | 2/40 [00:02<00:42,  1.13s/it]                                              {'loss': 2.747, 'grad_norm': 3.285536766052246, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.13s/it]  8%|▊         | 3/40 [00:03<00:42,  1.14s/it]                                              {'loss': 2.7335, 'grad_norm': 3.884533405303955, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.14s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 2.6726, 'grad_norm': 5.419570446014404, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.8529, 'grad_norm': 6.728939056396484, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.12s/it]                                              {'loss': 2.5146, 'grad_norm': 3.505545139312744, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.12s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.5385, 'grad_norm': 4.474209785461426, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:33,  1.04s/it]                                              {'loss': 1.5306, 'grad_norm': 11.033003807067871, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:33,  1.04s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it]                                              {'loss': 2.481, 'grad_norm': 4.194421768188477, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it] 25%|██▌       | 10/40 [00:10<00:32,  1.07s/it]                                               {'loss': 2.3213, 'grad_norm': 3.5518064498901367, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:32,  1.07s/it] 28%|██▊       | 11/40 [00:11<00:29,  1.02s/it]                                               {'loss': 2.4404, 'grad_norm': 4.536414623260498, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.02s/it] 30%|███       | 12/40 [00:12<00:28,  1.00s/it]                                               {'loss': 2.4364, 'grad_norm': 4.701318740844727, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:28,  1.00s/it] 32%|███▎      | 13/40 [00:13<00:27,  1.02s/it]                                               {'loss': 2.1602, 'grad_norm': 75.12417602539062, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:27,  1.02s/it] 35%|███▌      | 14/40 [00:14<00:26,  1.01s/it]                                               {'loss': 2.4963, 'grad_norm': 4.972029685974121, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:26,  1.01s/it] 38%|███▊      | 15/40 [00:16<00:26,  1.06s/it]                                               {'loss': 2.4045, 'grad_norm': 3.917041301727295, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:26,  1.06s/it] 40%|████      | 16/40 [00:16<00:19,  1.26it/s]                                               {'loss': 1.5386, 'grad_norm': 10.77199649810791, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:19,  1.26it/s] 42%|████▎     | 17/40 [00:17<00:20,  1.13it/s]                                               {'loss': 2.148, 'grad_norm': 3.054659605026245, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:20,  1.13it/s] 45%|████▌     | 18/40 [00:18<00:20,  1.05it/s]                                               {'loss': 2.4622, 'grad_norm': 3.3371379375457764, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:20,  1.05it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.01s/it]                                               {'loss': 2.1953, 'grad_norm': 4.305109977722168, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.01s/it] 50%|█████     | 20/40 [00:20<00:20,  1.03s/it]                                               {'loss': 2.4033, 'grad_norm': 3.1605448722839355, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.03s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.06s/it]                                               {'loss': 2.237, 'grad_norm': 4.039530277252197, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.06s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it]                                               {'loss': 2.0472, 'grad_norm': 3.707014799118042, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.09s/it]                                               {'loss': 2.3035, 'grad_norm': 3.4842848777770996, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.09s/it] 60%|██████    | 24/40 [00:24<00:13,  1.21it/s]                                               {'loss': 2.4331, 'grad_norm': 13.565081596374512, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s]                                               {'loss': 2.287, 'grad_norm': 3.5613322257995605, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.01it/s]                                               {'loss': 2.2185, 'grad_norm': 3.5035903453826904, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 2.4252, 'grad_norm': 4.17081356048584, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:12,  1.06s/it]                                               {'loss': 2.0164, 'grad_norm': 3.4481348991394043, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it]                                               {'loss': 2.3007, 'grad_norm': 4.172879219055176, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.07s/it]                                               {'loss': 1.9979, 'grad_norm': 3.6949234008789062, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.07s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.02s/it]                                               {'loss': 2.1218, 'grad_norm': 3.4878244400024414, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.02s/it] 80%|████████  | 32/40 [00:31<00:06,  1.31it/s]                                               {'loss': 2.2968, 'grad_norm': 14.130683898925781, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.31it/s] 82%|████████▎ | 33/40 [00:32<00:05,  1.27it/s]                                               {'loss': 2.0998, 'grad_norm': 4.170092582702637, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:05,  1.27it/s] 85%|████████▌ | 34/40 [00:33<00:04,  1.20it/s]                                               {'loss': 2.0795, 'grad_norm': 3.194401502609253, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:04,  1.20it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.11it/s]                                               {'loss': 1.8864, 'grad_norm': 3.5686330795288086, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.11it/s] 90%|█████████ | 36/40 [00:35<00:03,  1.05it/s]                                               {'loss': 2.0323, 'grad_norm': 3.2074272632598877, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:03,  1.05it/s] 92%|█████████▎| 37/40 [00:37<00:03,  1.00s/it]                                               {'loss': 2.3682, 'grad_norm': 4.430891036987305, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.00s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.03s/it]                                               {'loss': 2.2919, 'grad_norm': 4.447366237640381, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.03s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.05s/it]                                               {'loss': 2.0878, 'grad_norm': 4.239912033081055, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.05s/it]100%|██████████| 40/40 [00:39<00:00,  1.25it/s]                                               {'loss': 1.8222, 'grad_norm': 20.508302688598633, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.25it/s]                                               {'train_runtime': 39.573, 'train_samples_per_second': 14.277, 'train_steps_per_second': 1.011, 'train_loss': 2.2772363871335983, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.25it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.08s/it]                                              {'loss': 2.5681, 'grad_norm': 2.216672897338867, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:41,  1.08s/it]  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]                                              {'loss': 2.3811, 'grad_norm': 3.3915228843688965, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]  8%|▊         | 3/40 [00:03<00:40,  1.10s/it]                                              {'loss': 2.4386, 'grad_norm': 3.907960891723633, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:40,  1.10s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 2.4484, 'grad_norm': 3.8854730129241943, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.12s/it]                                              {'loss': 2.8851, 'grad_norm': 4.589517116546631, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.12s/it] 15%|█▌        | 6/40 [00:06<00:35,  1.03s/it]                                              {'loss': 2.3363, 'grad_norm': 3.8968923091888428, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:35,  1.03s/it] 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it]                                              {'loss': 2.9012, 'grad_norm': 4.522150993347168, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it] 20%|██        | 8/40 [00:07<00:23,  1.36it/s]                                              {'loss': 2.2228, 'grad_norm': 14.044296264648438, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:23,  1.36it/s] 22%|██▎       | 9/40 [00:08<00:25,  1.23it/s]                                              {'loss': 2.0674, 'grad_norm': 4.7818450927734375, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:25,  1.23it/s] 25%|██▌       | 10/40 [00:09<00:27,  1.09it/s]                                               {'loss': 2.2457, 'grad_norm': 3.6791200637817383, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:27,  1.09it/s] 28%|██▊       | 11/40 [00:10<00:28,  1.01it/s]                                               {'loss': 2.3981, 'grad_norm': 4.734279155731201, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:28,  1.01it/s] 30%|███       | 12/40 [00:11<00:28,  1.03s/it]                                               {'loss': 2.1643, 'grad_norm': 3.5281951427459717, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:28,  1.03s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 2.4502, 'grad_norm': 3.4830451011657715, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it]                                               {'loss': 2.3075, 'grad_norm': 4.470972061157227, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.11s/it]                                               {'loss': 2.3502, 'grad_norm': 3.5674922466278076, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.11s/it] 40%|████      | 16/40 [00:15<00:19,  1.21it/s]                                               {'loss': 1.3169, 'grad_norm': 11.889103889465332, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.21it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.07it/s]                                               {'loss': 2.2598, 'grad_norm': 3.7843592166900635, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:21,  1.07it/s] 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s]                                               {'loss': 2.2112, 'grad_norm': 5.562191963195801, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.04s/it]                                               {'loss': 2.0799, 'grad_norm': 4.787506103515625, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.04s/it] 50%|█████     | 20/40 [00:20<00:21,  1.07s/it]                                               {'loss': 2.2825, 'grad_norm': 8.82607364654541, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.07s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.10s/it]                                               {'loss': 2.1185, 'grad_norm': 4.048649787902832, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.10s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.10s/it]                                               {'loss': 2.0838, 'grad_norm': 4.77052116394043, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.10s/it] 57%|█████▊    | 23/40 [00:23<00:19,  1.12s/it]                                               {'loss': 2.2019, 'grad_norm': 4.087206840515137, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:19,  1.12s/it] 60%|██████    | 24/40 [00:23<00:13,  1.19it/s]                                               {'loss': 1.5121, 'grad_norm': 13.423223495483398, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.19it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.12it/s]                                               {'loss': 2.316, 'grad_norm': 11.109989166259766, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.12it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.10it/s]                                               {'loss': 2.0087, 'grad_norm': 3.7532474994659424, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.10it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.07it/s]                                               {'loss': 2.1764, 'grad_norm': 4.577230453491211, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.07it/s] 70%|███████   | 28/40 [00:27<00:11,  1.06it/s]                                               {'loss': 2.1892, 'grad_norm': 4.393530368804932, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.06it/s] 72%|███████▎  | 29/40 [00:28<00:10,  1.05it/s]                                               {'loss': 2.0115, 'grad_norm': 4.383310317993164, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:10,  1.05it/s] 75%|███████▌  | 30/40 [00:29<00:09,  1.01it/s]                                               {'loss': 1.9686, 'grad_norm': 3.2531840801239014, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:09,  1.01it/s] 78%|███████▊  | 31/40 [00:30<00:09,  1.04s/it]                                               {'loss': 1.9958, 'grad_norm': 3.6151235103607178, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.04s/it] 80%|████████  | 32/40 [00:31<00:06,  1.27it/s]                                               {'loss': 3.2548, 'grad_norm': 4.642046928405762, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.27it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s]                                               {'loss': 1.8367, 'grad_norm': 3.537529230117798, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s]                                               {'loss': 2.1188, 'grad_norm': 3.955653429031372, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it]                                               {'loss': 2.2394, 'grad_norm': 4.570108413696289, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.06s/it]                                               {'loss': 2.0548, 'grad_norm': 4.121112823486328, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.06s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.08s/it]                                               {'loss': 2.0532, 'grad_norm': 3.438807249069214, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.10s/it]                                               {'loss': 2.0333, 'grad_norm': 4.124470233917236, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.10s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.11s/it]                                               {'loss': 2.1932, 'grad_norm': 3.7803032398223877, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.11s/it]100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'loss': 1.8853, 'grad_norm': 13.650137901306152, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'train_runtime': 39.4942, 'train_samples_per_second': 14.306, 'train_steps_per_second': 1.013, 'train_loss': 2.2141892343759535, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:37,  1.05it/s]                                              {'loss': 2.9658, 'grad_norm': 2.727078437805176, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:37,  1.05it/s]  5%|▌         | 2/40 [00:01<00:35,  1.08it/s]                                              {'loss': 2.5332, 'grad_norm': 3.3421783447265625, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:35,  1.08it/s]  8%|▊         | 3/40 [00:02<00:35,  1.04it/s]                                              {'loss': 2.5094, 'grad_norm': 3.25018310546875, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:35,  1.04it/s] 10%|█         | 4/40 [00:03<00:36,  1.02s/it]                                              {'loss': 2.7899, 'grad_norm': 4.59527587890625, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:36,  1.02s/it] 12%|█▎        | 5/40 [00:05<00:37,  1.07s/it]                                              {'loss': 2.5045, 'grad_norm': 5.2110395431518555, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:37,  1.07s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.09s/it]                                              {'loss': 2.5529, 'grad_norm': 6.825178623199463, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.09s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it]                                              {'loss': 2.3441, 'grad_norm': 4.216195583343506, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it] 20%|██        | 8/40 [00:07<00:26,  1.22it/s]                                              {'loss': 2.9237, 'grad_norm': 13.087693214416504, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:26,  1.22it/s] 22%|██▎       | 9/40 [00:08<00:27,  1.12it/s]                                              {'loss': 2.5147, 'grad_norm': 4.58939266204834, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:27,  1.12it/s] 25%|██▌       | 10/40 [00:09<00:29,  1.02it/s]                                               {'loss': 2.2578, 'grad_norm': 5.061944007873535, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:29,  1.02it/s] 28%|██▊       | 11/40 [00:10<00:29,  1.01s/it]                                               {'loss': 2.1626, 'grad_norm': 7.031018257141113, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:29,  1.01s/it] 30%|███       | 12/40 [00:12<00:29,  1.06s/it]                                               {'loss': 2.2185, 'grad_norm': 3.9382870197296143, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 2.4805, 'grad_norm': 6.933135032653809, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.10s/it]                                               {'loss': 2.4325, 'grad_norm': 4.007591724395752, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.11s/it]                                               {'loss': 2.2102, 'grad_norm': 3.9389824867248535, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.11s/it] 40%|████      | 16/40 [00:15<00:20,  1.19it/s]                                               {'loss': 2.6371, 'grad_norm': 5.138379096984863, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.08it/s]                                               {'loss': 2.2949, 'grad_norm': 4.370096206665039, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:18<00:22,  1.00s/it]                                               {'loss': 2.2347, 'grad_norm': 4.98795223236084, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:22,  1.00s/it] 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it]                                               {'loss': 2.2182, 'grad_norm': 3.4986000061035156, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.08s/it]                                               {'loss': 2.2238, 'grad_norm': 3.210022211074829, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.08s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.09s/it]                                               {'loss': 2.1121, 'grad_norm': 3.4402334690093994, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it]                                               {'loss': 1.9199, 'grad_norm': 4.757930755615234, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it] 57%|█████▊    | 23/40 [00:23<00:17,  1.03s/it]                                               {'loss': 2.3422, 'grad_norm': 4.0585761070251465, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:17,  1.03s/it] 60%|██████    | 24/40 [00:23<00:12,  1.28it/s]                                               {'loss': 1.698, 'grad_norm': 16.16461181640625, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.28it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.21it/s]                                               {'loss': 2.1471, 'grad_norm': 3.120340585708618, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.21it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.11it/s]                                               {'loss': 2.0457, 'grad_norm': 3.055311441421509, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.11it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.05it/s]                                               {'loss': 1.7018, 'grad_norm': 3.0856873989105225, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.05it/s] 70%|███████   | 28/40 [00:27<00:11,  1.01it/s]                                               {'loss': 2.0794, 'grad_norm': 3.5889394283294678, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.01it/s] 72%|███████▎  | 29/40 [00:28<00:11,  1.04s/it]                                               {'loss': 2.071, 'grad_norm': 9.150419235229492, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.04s/it] 75%|███████▌  | 30/40 [00:29<00:10,  1.05s/it]                                               {'loss': 2.4186, 'grad_norm': 4.716313362121582, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.05s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.09s/it]                                               {'loss': 2.2777, 'grad_norm': 3.881488084793091, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.09s/it] 80%|████████  | 32/40 [00:31<00:06,  1.22it/s]                                               {'loss': 2.4685, 'grad_norm': 17.1342830657959, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.22it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.09it/s]                                               {'loss': 1.8568, 'grad_norm': 3.330460786819458, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.01it/s]                                               {'loss': 2.3278, 'grad_norm': 3.7748799324035645, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.04s/it]                                               {'loss': 1.9893, 'grad_norm': 3.181119680404663, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.04s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.07s/it]                                               {'loss': 1.8699, 'grad_norm': 3.1807010173797607, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.09s/it]                                               {'loss': 2.1336, 'grad_norm': 3.3027687072753906, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.09s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.11s/it]                                               {'loss': 2.1771, 'grad_norm': 3.4896700382232666, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.11s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.10s/it]                                               {'loss': 1.9354, 'grad_norm': 3.794694185256958, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.10s/it]100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'loss': 2.4275, 'grad_norm': 19.16234016418457, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'train_runtime': 39.7167, 'train_samples_per_second': 14.226, 'train_steps_per_second': 1.007, 'train_loss': 2.2752001911401747, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.10s/it]                                              {'loss': 2.8894, 'grad_norm': 2.3880794048309326, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.10s/it]  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]                                              {'loss': 2.6669, 'grad_norm': 3.6193315982818604, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]  8%|▊         | 3/40 [00:03<00:41,  1.13s/it]                                              {'loss': 2.4029, 'grad_norm': 3.9244213104248047, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.13s/it] 10%|█         | 4/40 [00:04<00:40,  1.14s/it]                                              {'loss': 2.4941, 'grad_norm': 3.9830799102783203, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.14s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.5771, 'grad_norm': 3.7607626914978027, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.12s/it]                                              {'loss': 2.5245, 'grad_norm': 4.726258277893066, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.12s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.12s/it]                                              {'loss': 2.4049, 'grad_norm': 4.558131694793701, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.12s/it] 20%|██        | 8/40 [00:08<00:32,  1.02s/it]                                              {'loss': 3.1196, 'grad_norm': 11.979938507080078, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.02s/it] 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it]                                              {'loss': 2.4399, 'grad_norm': 4.045655727386475, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it] 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it]                                               {'loss': 2.37, 'grad_norm': 4.517542362213135, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it] 28%|██▊       | 11/40 [00:12<00:31,  1.09s/it]                                               {'loss': 2.4072, 'grad_norm': 4.343794345855713, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:31,  1.09s/it] 30%|███       | 12/40 [00:13<00:30,  1.11s/it]                                               {'loss': 2.3385, 'grad_norm': 4.890096664428711, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:30,  1.11s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it]                                               {'loss': 2.1788, 'grad_norm': 4.53340482711792, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it]                                               {'loss': 2.2676, 'grad_norm': 3.6298203468322754, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.10s/it]                                               {'loss': 2.1227, 'grad_norm': 3.477111577987671, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.10s/it] 40%|████      | 16/40 [00:16<00:20,  1.16it/s]                                               {'loss': 1.9077, 'grad_norm': 16.19059181213379, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.16it/s] 42%|████▎     | 17/40 [00:17<00:20,  1.12it/s]                                               {'loss': 2.3543, 'grad_norm': 3.6169848442077637, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:20,  1.12it/s] 45%|████▌     | 18/40 [00:18<00:19,  1.11it/s]                                               {'loss': 2.277, 'grad_norm': 4.870747089385986, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:19,  1.11it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.04it/s]                                               {'loss': 2.17, 'grad_norm': 4.544047832489014, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.04it/s] 50%|█████     | 20/40 [00:20<00:19,  1.02it/s]                                               {'loss': 2.1751, 'grad_norm': 3.6511833667755127, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:19,  1.02it/s] 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it]                                               {'loss': 1.9688, 'grad_norm': 3.3049066066741943, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it] 55%|█████▌    | 22/40 [00:22<00:18,  1.03s/it]                                               {'loss': 2.1784, 'grad_norm': 3.758229970932007, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:18,  1.03s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.06s/it]                                               {'loss': 2.2319, 'grad_norm': 7.23344087600708, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.06s/it] 60%|██████    | 24/40 [00:24<00:12,  1.25it/s]                                               {'loss': 2.1037, 'grad_norm': 22.196210861206055, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:12,  1.25it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.10it/s]                                               {'loss': 1.9604, 'grad_norm': 4.240263938903809, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.10it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.05it/s]                                               {'loss': 2.2148, 'grad_norm': 3.7195942401885986, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.05it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it]                                               {'loss': 2.0788, 'grad_norm': 3.2364439964294434, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it] 70%|███████   | 28/40 [00:28<00:12,  1.05s/it]                                               {'loss': 2.0771, 'grad_norm': 3.7574260234832764, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it]                                               {'loss': 1.9735, 'grad_norm': 3.9087071418762207, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it]                                               {'loss': 1.9802, 'grad_norm': 3.201995611190796, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.11s/it]                                               {'loss': 2.173, 'grad_norm': 4.45839786529541, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.11s/it] 80%|████████  | 32/40 [00:32<00:06,  1.20it/s]                                               {'loss': 3.1693, 'grad_norm': 17.322328567504883, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s]                                               {'loss': 2.1735, 'grad_norm': 3.6020476818084717, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.05it/s]                                               {'loss': 2.0501, 'grad_norm': 4.436221122741699, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.05it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.01s/it]                                               {'loss': 1.7098, 'grad_norm': 4.849211692810059, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.01s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.02s/it]                                               {'loss': 2.1455, 'grad_norm': 4.186680793762207, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.02s/it] 92%|█████████▎| 37/40 [00:37<00:02,  1.02it/s]                                               {'loss': 1.9971, 'grad_norm': 4.084854602813721, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:02,  1.02it/s] 95%|█████████▌| 38/40 [00:38<00:01,  1.04it/s]                                               {'loss': 1.985, 'grad_norm': 4.048144817352295, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:01,  1.04it/s] 98%|█████████▊| 39/40 [00:39<00:00,  1.05it/s]                                               {'loss': 2.0608, 'grad_norm': 3.7451093196868896, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:00,  1.05it/s]100%|██████████| 40/40 [00:39<00:00,  1.37it/s]                                               {'loss': 2.3799, 'grad_norm': 17.885353088378906, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.37it/s]                                               {'train_runtime': 39.8469, 'train_samples_per_second': 14.179, 'train_steps_per_second': 1.004, 'train_loss': 2.267504107952118, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.37it/s]100%|██████████| 40/40 [00:39<00:00,  1.00it/s]
CLIENT:77
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]                                              {'loss': 2.8804, 'grad_norm': 4.331366062164307, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]                                              {'loss': 2.6602, 'grad_norm': 3.409454107284546, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]  8%|▊         | 3/40 [00:03<00:41,  1.13s/it]                                              {'loss': 2.3563, 'grad_norm': 3.518681764602661, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.13s/it] 10%|█         | 4/40 [00:04<00:39,  1.10s/it]                                              {'loss': 2.6943, 'grad_norm': 3.975490093231201, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.10s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it]                                              {'loss': 2.5511, 'grad_norm': 4.34260892868042, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 2.3898, 'grad_norm': 3.312958002090454, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it]                                              {'loss': 2.3414, 'grad_norm': 3.4031224250793457, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it] 20%|██        | 8/40 [00:08<00:32,  1.03s/it]                                              {'loss': 2.0546, 'grad_norm': 9.26279067993164, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.03s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.06s/it]                                              {'loss': 2.276, 'grad_norm': 4.396866321563721, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.06s/it] 25%|██▌       | 10/40 [00:10<00:31,  1.04s/it]                                               {'loss': 2.2548, 'grad_norm': 3.768106698989868, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:31,  1.04s/it] 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it]                                               {'loss': 2.1192, 'grad_norm': 3.7575273513793945, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it] 30%|███       | 12/40 [00:12<00:27,  1.01it/s]                                               {'loss': 2.1868, 'grad_norm': 4.056933403015137, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:27,  1.01it/s] 32%|███▎      | 13/40 [00:13<00:27,  1.03s/it]                                               {'loss': 2.4428, 'grad_norm': 3.858323574066162, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:27,  1.03s/it] 35%|███▌      | 14/40 [00:14<00:27,  1.05s/it]                                               {'loss': 2.2029, 'grad_norm': 3.1673038005828857, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:27,  1.05s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.09s/it]                                               {'loss': 2.4106, 'grad_norm': 3.8834617137908936, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.09s/it] 40%|████      | 16/40 [00:16<00:19,  1.24it/s]                                               {'loss': 1.8718, 'grad_norm': 12.514561653137207, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:19,  1.24it/s] 42%|████▎     | 17/40 [00:17<00:20,  1.10it/s]                                               {'loss': 2.3777, 'grad_norm': 4.040328025817871, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:20,  1.10it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s]                                               {'loss': 2.203, 'grad_norm': 3.403428316116333, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.01s/it]                                               {'loss': 2.083, 'grad_norm': 3.413865804672241, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.01s/it] 50%|█████     | 20/40 [00:20<00:21,  1.05s/it]                                               {'loss': 2.0396, 'grad_norm': 4.026274681091309, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.05s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 2.2625, 'grad_norm': 3.697493314743042, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it]                                               {'loss': 2.058, 'grad_norm': 3.4175591468811035, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it]                                               {'loss': 2.3328, 'grad_norm': 4.083580017089844, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it] 60%|██████    | 24/40 [00:24<00:13,  1.21it/s]                                               {'loss': 1.5096, 'grad_norm': 9.071956634521484, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s]                                               {'loss': 2.1577, 'grad_norm': 3.3090085983276367, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s]                                               {'loss': 1.9762, 'grad_norm': 3.9733684062957764, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 2.2746, 'grad_norm': 4.469295978546143, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:12,  1.05s/it]                                               {'loss': 2.2281, 'grad_norm': 2.8025217056274414, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.05s/it]                                               {'loss': 1.8895, 'grad_norm': 3.4311842918395996, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.05s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.02s/it]                                               {'loss': 1.8853, 'grad_norm': 3.1355578899383545, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.02s/it] 78%|███████▊  | 31/40 [00:31<00:08,  1.00it/s]                                               {'loss': 2.2136, 'grad_norm': 3.807835102081299, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:08,  1.00it/s] 80%|████████  | 32/40 [00:31<00:05,  1.34it/s]                                               {'loss': 2.0076, 'grad_norm': 14.748096466064453, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:05,  1.34it/s] 82%|████████▎ | 33/40 [00:33<00:05,  1.17it/s]                                               {'loss': 2.0912, 'grad_norm': 3.8830606937408447, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:05,  1.17it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.08it/s]                                               {'loss': 1.9602, 'grad_norm': 3.929431438446045, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.08it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.00s/it]                                               {'loss': 1.9965, 'grad_norm': 3.5428338050842285, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.00s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.02s/it]                                               {'loss': 1.8824, 'grad_norm': 4.2060723304748535, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.02s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.00s/it]                                               {'loss': 2.1417, 'grad_norm': 3.352229595184326, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.00s/it] 95%|█████████▌| 38/40 [00:38<00:01,  1.01it/s]                                               {'loss': 1.8592, 'grad_norm': 3.479745388031006, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:01,  1.01it/s] 98%|█████████▊| 39/40 [00:39<00:00,  1.07it/s]                                               {'loss': 2.0683, 'grad_norm': 3.030731439590454, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:00,  1.07it/s]100%|██████████| 40/40 [00:39<00:00,  1.44it/s]                                               {'loss': 2.4026, 'grad_norm': 13.069531440734863, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.44it/s]                                               {'train_runtime': 39.3284, 'train_samples_per_second': 14.366, 'train_steps_per_second': 1.017, 'train_loss': 2.1898523956537246, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.44it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:46,  1.18s/it]                                              {'loss': 2.6611, 'grad_norm': 2.402672529220581, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:46,  1.18s/it]  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]                                              {'loss': 2.8322, 'grad_norm': 3.73673677444458, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]  8%|▊         | 3/40 [00:03<00:39,  1.08s/it]                                              {'loss': 2.4976, 'grad_norm': 4.677814483642578, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:39,  1.08s/it] 10%|█         | 4/40 [00:04<00:37,  1.03s/it]                                              {'loss': 2.5524, 'grad_norm': 5.295543670654297, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:37,  1.03s/it] 12%|█▎        | 5/40 [00:05<00:36,  1.04s/it]                                              {'loss': 2.4745, 'grad_norm': 4.275024890899658, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:36,  1.04s/it] 15%|█▌        | 6/40 [00:06<00:35,  1.06s/it]                                              {'loss': 2.7684, 'grad_norm': 5.162635326385498, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:35,  1.06s/it] 18%|█▊        | 7/40 [00:07<00:35,  1.09s/it]                                              {'loss': 2.4409, 'grad_norm': 4.63960599899292, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:35,  1.09s/it] 20%|██        | 8/40 [00:07<00:25,  1.24it/s]                                              {'loss': 2.1536, 'grad_norm': 15.54100513458252, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:25,  1.24it/s] 22%|██▎       | 9/40 [00:08<00:27,  1.13it/s]                                              {'loss': 2.0664, 'grad_norm': 4.505207538604736, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:27,  1.13it/s] 25%|██▌       | 10/40 [00:09<00:29,  1.03it/s]                                               {'loss': 2.2154, 'grad_norm': 4.217075824737549, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:29,  1.03it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it]                                               {'loss': 2.4345, 'grad_norm': 6.503658294677734, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it] 30%|███       | 12/40 [00:12<00:28,  1.01s/it]                                               {'loss': 2.2185, 'grad_norm': 3.32637882232666, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:28,  1.01s/it] 32%|███▎      | 13/40 [00:13<00:27,  1.00s/it]                                               {'loss': 2.6511, 'grad_norm': 4.116141319274902, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:27,  1.00s/it] 35%|███▌      | 14/40 [00:14<00:26,  1.02s/it]                                               {'loss': 2.5511, 'grad_norm': 4.2386932373046875, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:26,  1.02s/it] 38%|███▊      | 15/40 [00:15<00:26,  1.05s/it]                                               {'loss': 2.4329, 'grad_norm': 5.272604465484619, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:26,  1.05s/it] 40%|████      | 16/40 [00:15<00:19,  1.25it/s]                                               {'loss': 3.6411, 'grad_norm': 15.248536109924316, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.25it/s] 42%|████▎     | 17/40 [00:16<00:20,  1.11it/s]                                               {'loss': 2.1448, 'grad_norm': 3.4230496883392334, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:20,  1.11it/s] 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s]                                               {'loss': 2.2987, 'grad_norm': 3.714906930923462, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:18<00:21,  1.03s/it]                                               {'loss': 2.4055, 'grad_norm': 3.533521890640259, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.07s/it]                                               {'loss': 2.1674, 'grad_norm': 3.1252830028533936, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.07s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.10s/it]                                               {'loss': 2.161, 'grad_norm': 3.4022724628448486, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.10s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it]                                               {'loss': 2.2437, 'grad_norm': 3.7118728160858154, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.06s/it]                                               {'loss': 2.4776, 'grad_norm': 3.9101948738098145, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.06s/it] 60%|██████    | 24/40 [00:23<00:12,  1.26it/s]                                               {'loss': 1.5881, 'grad_norm': 12.978615760803223, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.26it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.18it/s]                                               {'loss': 2.0972, 'grad_norm': 6.057132720947266, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.18it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.08it/s]                                               {'loss': 2.0905, 'grad_norm': 3.4406630992889404, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.08it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.00it/s]                                               {'loss': 2.3271, 'grad_norm': 3.86063551902771, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.00it/s] 70%|███████   | 28/40 [00:27<00:12,  1.05s/it]                                               {'loss': 2.1845, 'grad_norm': 3.3294920921325684, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it]                                               {'loss': 2.2852, 'grad_norm': 3.3683242797851562, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:30<00:11,  1.10s/it]                                               {'loss': 2.057, 'grad_norm': 3.519190788269043, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:11,  1.10s/it] 78%|███████▊  | 31/40 [00:31<00:10,  1.12s/it]                                               {'loss': 2.1122, 'grad_norm': 5.172852993011475, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:10,  1.12s/it] 80%|████████  | 32/40 [00:31<00:06,  1.19it/s]                                               {'loss': 2.2619, 'grad_norm': 12.731988906860352, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.19it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.06it/s]                                               {'loss': 1.9496, 'grad_norm': 5.81934118270874, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.06it/s] 85%|████████▌ | 34/40 [00:33<00:06,  1.01s/it]                                               {'loss': 1.9789, 'grad_norm': 4.397235870361328, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:06,  1.01s/it] 88%|████████▊ | 35/40 [00:34<00:04,  1.00it/s]                                               {'loss': 2.177, 'grad_norm': 3.044680595397949, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.00it/s] 90%|█████████ | 36/40 [00:35<00:04,  1.00s/it]                                               {'loss': 2.0329, 'grad_norm': 3.240380048751831, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.00s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.01s/it]                                               {'loss': 2.0772, 'grad_norm': 3.595111608505249, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.01s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.05s/it]                                               {'loss': 2.3246, 'grad_norm': 3.45263934135437, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.05s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]                                               {'loss': 2.0108, 'grad_norm': 3.372187852859497, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]100%|██████████| 40/40 [00:39<00:00,  1.22it/s]                                               {'loss': 1.6645, 'grad_norm': 15.06478214263916, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.22it/s]                                               {'train_runtime': 39.5822, 'train_samples_per_second': 14.274, 'train_steps_per_second': 1.011, 'train_loss': 2.2927355796098707, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.22it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:46,  1.19s/it]                                              {'loss': 2.7128, 'grad_norm': 2.7689285278320312, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:46,  1.19s/it]  5%|▌         | 2/40 [00:02<00:44,  1.17s/it]                                              {'loss': 2.4353, 'grad_norm': 3.4852631092071533, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:44,  1.17s/it]  8%|▊         | 3/40 [00:03<00:43,  1.16s/it]                                              {'loss': 2.7727, 'grad_norm': 4.386564254760742, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:43,  1.16s/it] 10%|█         | 4/40 [00:04<00:42,  1.17s/it]                                              {'loss': 2.571, 'grad_norm': 4.338283061981201, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:42,  1.17s/it] 12%|█▎        | 5/40 [00:05<00:41,  1.17s/it]                                              {'loss': 2.5582, 'grad_norm': 4.710925102233887, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:41,  1.17s/it] 15%|█▌        | 6/40 [00:07<00:39,  1.18s/it]                                              {'loss': 2.5305, 'grad_norm': 4.721980094909668, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:39,  1.18s/it] 18%|█▊        | 7/40 [00:08<00:38,  1.17s/it]                                              {'loss': 2.7662, 'grad_norm': 4.549432277679443, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:38,  1.17s/it] 20%|██        | 8/40 [00:08<00:30,  1.03it/s]                                              {'loss': 2.3298, 'grad_norm': 25.759742736816406, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:30,  1.03it/s] 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it]                                              {'loss': 2.5975, 'grad_norm': 6.1084370613098145, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.07s/it]                                               {'loss': 2.5349, 'grad_norm': 3.747347831726074, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.07s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.10s/it]                                               {'loss': 2.4207, 'grad_norm': 4.555825710296631, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.10s/it] 30%|███       | 12/40 [00:13<00:31,  1.13s/it]                                               {'loss': 2.4088, 'grad_norm': 4.677294731140137, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.13s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.14s/it]                                               {'loss': 2.3416, 'grad_norm': 3.7531356811523438, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.14s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.15s/it]                                               {'loss': 2.3965, 'grad_norm': 4.0589423179626465, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.15s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.15s/it]                                               {'loss': 2.3692, 'grad_norm': 4.626161575317383, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.15s/it] 40%|████      | 16/40 [00:17<00:20,  1.17it/s]                                               {'loss': 2.6787, 'grad_norm': 13.565282821655273, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:17<00:20,  1.17it/s] 42%|████▎     | 17/40 [00:18<00:20,  1.13it/s]                                               {'loss': 2.4392, 'grad_norm': 4.1102495193481445, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:20,  1.13it/s] 45%|████▌     | 18/40 [00:18<00:18,  1.17it/s]                                               {'loss': 2.3362, 'grad_norm': 3.5971109867095947, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:18,  1.17it/s] 48%|████▊     | 19/40 [00:19<00:17,  1.22it/s]                                               {'loss': 2.2151, 'grad_norm': 3.264634609222412, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:17,  1.22it/s] 50%|█████     | 20/40 [00:20<00:14,  1.34it/s]                                               {'loss': 2.2842, 'grad_norm': 3.6129660606384277, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:14,  1.34it/s] 52%|█████▎    | 21/40 [00:20<00:13,  1.45it/s]                                               {'loss': 2.2434, 'grad_norm': 3.678790807723999, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:21<00:11,  1.51it/s]                                               {'loss': 2.2755, 'grad_norm': 3.708055257797241, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:11,  1.51it/s] 57%|█████▊    | 23/40 [00:21<00:11,  1.54it/s]                                               {'loss': 2.2098, 'grad_norm': 3.924421548843384, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:21<00:11,  1.54it/s] 60%|██████    | 24/40 [00:22<00:07,  2.01it/s]                                               {'loss': 1.9729, 'grad_norm': 15.577336311340332, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:07,  2.01it/s] 62%|██████▎   | 25/40 [00:22<00:08,  1.73it/s]                                               {'loss': 2.0376, 'grad_norm': 4.000385761260986, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:22<00:08,  1.73it/s] 65%|██████▌   | 26/40 [00:23<00:09,  1.52it/s]                                               {'loss': 2.358, 'grad_norm': 3.784998893737793, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:23<00:09,  1.52it/s] 68%|██████▊   | 27/40 [00:24<00:10,  1.24it/s]                                               {'loss': 2.2711, 'grad_norm': 4.5512776374816895, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:24<00:10,  1.24it/s] 70%|███████   | 28/40 [00:25<00:10,  1.10it/s]                                               {'loss': 2.1856, 'grad_norm': 3.3083791732788086, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:25<00:10,  1.10it/s] 72%|███████▎  | 29/40 [00:27<00:10,  1.02it/s]                                               {'loss': 2.142, 'grad_norm': 4.116880416870117, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:27<00:10,  1.02it/s] 75%|███████▌  | 30/40 [00:28<00:10,  1.04s/it]                                               {'loss': 2.261, 'grad_norm': 3.7964627742767334, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:28<00:10,  1.04s/it] 78%|███████▊  | 31/40 [00:29<00:09,  1.08s/it]                                               {'loss': 2.2062, 'grad_norm': 3.9954817295074463, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:29<00:09,  1.08s/it] 80%|████████  | 32/40 [00:29<00:06,  1.23it/s]                                               {'loss': 1.3056, 'grad_norm': 7.876304626464844, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:29<00:06,  1.23it/s] 82%|████████▎ | 33/40 [00:30<00:06,  1.10it/s]                                               {'loss': 2.0465, 'grad_norm': 3.674363136291504, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:30<00:06,  1.10it/s] 85%|████████▌ | 34/40 [00:31<00:05,  1.02it/s]                                               {'loss': 2.1224, 'grad_norm': 3.9428555965423584, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:31<00:05,  1.02it/s] 88%|████████▊ | 35/40 [00:33<00:05,  1.04s/it]                                               {'loss': 1.9844, 'grad_norm': 3.2575154304504395, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:33<00:05,  1.04s/it] 90%|█████████ | 36/40 [00:34<00:04,  1.07s/it]                                               {'loss': 2.0774, 'grad_norm': 5.670741081237793, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:34<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:35<00:03,  1.10s/it]                                               {'loss': 2.22, 'grad_norm': 3.5828847885131836, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:35<00:03,  1.10s/it] 95%|█████████▌| 38/40 [00:36<00:02,  1.06s/it]                                               {'loss': 2.1198, 'grad_norm': 4.513330459594727, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:36<00:02,  1.06s/it] 98%|█████████▊| 39/40 [00:37<00:01,  1.03s/it]                                               {'loss': 2.1262, 'grad_norm': 3.585480213165283, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:37<00:01,  1.03s/it]100%|██████████| 40/40 [00:37<00:00,  1.29it/s]                                               {'loss': 2.4136, 'grad_norm': 18.274805068969727, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.29it/s]                                               {'train_runtime': 37.651, 'train_samples_per_second': 15.006, 'train_steps_per_second': 1.062, 'train_loss': 2.306961065530777, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.29it/s]100%|██████████| 40/40 [00:37<00:00,  1.06it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 2.7155, 'grad_norm': 2.782491445541382, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 2.7127, 'grad_norm': 3.9642317295074463, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:42,  1.15s/it]                                              {'loss': 2.5347, 'grad_norm': 3.986314058303833, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.15s/it] 10%|█         | 4/40 [00:04<00:41,  1.14s/it]                                              {'loss': 2.4827, 'grad_norm': 6.812449932098389, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.14s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.14s/it]                                              {'loss': 2.6658, 'grad_norm': 5.737341403961182, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.14s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.5848, 'grad_norm': 4.941507816314697, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.14s/it]                                              {'loss': 2.6563, 'grad_norm': 3.950634241104126, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.14s/it] 20%|██        | 8/40 [00:08<00:32,  1.03s/it]                                              {'loss': 2.3699, 'grad_norm': 16.924251556396484, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.03s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it]                                              {'loss': 2.3815, 'grad_norm': 5.476367473602295, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.08s/it]                                               {'loss': 2.299, 'grad_norm': 5.251769065856934, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.08s/it] 28%|██▊       | 11/40 [00:12<00:31,  1.10s/it]                                               {'loss': 2.5087, 'grad_norm': 4.196771144866943, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:31,  1.10s/it] 30%|███       | 12/40 [00:13<00:30,  1.10s/it]                                               {'loss': 2.3796, 'grad_norm': 4.417958736419678, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:30,  1.10s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it]                                               {'loss': 2.6014, 'grad_norm': 4.771054744720459, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it]                                               {'loss': 2.3245, 'grad_norm': 3.939302921295166, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it] 38%|███▊      | 15/40 [00:16<00:26,  1.07s/it]                                               {'loss': 2.1907, 'grad_norm': 3.275127649307251, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:26,  1.07s/it] 40%|████      | 16/40 [00:16<00:18,  1.27it/s]                                               {'loss': 2.3499, 'grad_norm': 12.867424964904785, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:18,  1.27it/s] 42%|████▎     | 17/40 [00:17<00:17,  1.28it/s]                                               {'loss': 2.2577, 'grad_norm': 3.4137279987335205, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:17,  1.28it/s] 45%|████▌     | 18/40 [00:18<00:17,  1.22it/s]                                               {'loss': 2.3846, 'grad_norm': 4.1983561515808105, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:17,  1.22it/s] 48%|████▊     | 19/40 [00:19<00:17,  1.20it/s]                                               {'loss': 2.4041, 'grad_norm': 3.5331084728240967, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:17,  1.20it/s] 50%|█████     | 20/40 [00:20<00:18,  1.10it/s]                                               {'loss': 2.1104, 'grad_norm': 4.203182220458984, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:18,  1.10it/s] 52%|█████▎    | 21/40 [00:21<00:18,  1.04it/s]                                               {'loss': 2.5029, 'grad_norm': 4.0404887199401855, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:18,  1.04it/s] 55%|█████▌    | 22/40 [00:22<00:18,  1.03s/it]                                               {'loss': 2.1088, 'grad_norm': 10.807059288024902, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.03s/it] 57%|█████▊    | 23/40 [00:23<00:17,  1.03s/it]                                               {'loss': 2.1745, 'grad_norm': 4.120758056640625, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:17,  1.03s/it] 60%|██████    | 24/40 [00:23<00:12,  1.26it/s]                                               {'loss': 2.1708, 'grad_norm': 14.722156524658203, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.26it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.13it/s]                                               {'loss': 2.0769, 'grad_norm': 4.409383296966553, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.13it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s]                                               {'loss': 2.1652, 'grad_norm': 3.1026291847229004, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it]                                               {'loss': 2.1002, 'grad_norm': 3.0939204692840576, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it] 70%|███████   | 28/40 [00:28<00:12,  1.06s/it]                                               {'loss': 2.3623, 'grad_norm': 3.279691219329834, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it]                                               {'loss': 2.1265, 'grad_norm': 3.33693528175354, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.10s/it]                                               {'loss': 1.9171, 'grad_norm': 3.2995259761810303, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.10s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it]                                               {'loss': 2.346, 'grad_norm': 3.2022809982299805, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it] 80%|████████  | 32/40 [00:31<00:06,  1.19it/s]                                               {'loss': 1.3931, 'grad_norm': 16.910987854003906, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.19it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s]                                               {'loss': 2.3208, 'grad_norm': 3.8817760944366455, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.02it/s]                                               {'loss': 2.2022, 'grad_norm': 4.1030354499816895, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.02it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.03s/it]                                               {'loss': 2.1818, 'grad_norm': 4.242892265319824, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it]                                               {'loss': 2.0541, 'grad_norm': 4.3537678718566895, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.02s/it]                                               {'loss': 2.0131, 'grad_norm': 4.066298007965088, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.02s/it] 95%|█████████▌| 38/40 [00:38<00:01,  1.02it/s]                                               {'loss': 2.0663, 'grad_norm': 3.346529960632324, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:01,  1.02it/s] 98%|█████████▊| 39/40 [00:39<00:00,  1.03it/s]                                               {'loss': 2.1583, 'grad_norm': 3.546267509460449, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:00,  1.03it/s]100%|██████████| 40/40 [00:39<00:00,  1.37it/s]                                               {'loss': 2.1482, 'grad_norm': 17.163448333740234, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.37it/s]                                               {'train_runtime': 39.5105, 'train_samples_per_second': 14.3, 'train_steps_per_second': 1.012, 'train_loss': 2.2876017063856127, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.37it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]                                              {'loss': 2.4531, 'grad_norm': 3.31982421875, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]                                              {'loss': 2.6726, 'grad_norm': 4.037220478057861, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]  8%|▊         | 3/40 [00:03<00:41,  1.13s/it]                                              {'loss': 2.6777, 'grad_norm': 4.231239318847656, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.13s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 2.4755, 'grad_norm': 4.103912353515625, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.6478, 'grad_norm': 5.349245071411133, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it]                                              {'loss': 2.7723, 'grad_norm': 4.832115173339844, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.5318, 'grad_norm': 5.032156944274902, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:33,  1.06s/it]                                              {'loss': 2.0711, 'grad_norm': 10.655162811279297, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:33,  1.06s/it] 22%|██▎       | 9/40 [00:09<00:33,  1.09s/it]                                              {'loss': 2.3174, 'grad_norm': 4.314231872558594, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:33,  1.09s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.10s/it]                                               {'loss': 2.2867, 'grad_norm': 4.397329807281494, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.10s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.12s/it]                                               {'loss': 2.2667, 'grad_norm': 3.8147330284118652, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.12s/it] 30%|███       | 12/40 [00:13<00:31,  1.12s/it]                                               {'loss': 2.4317, 'grad_norm': 4.975398063659668, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.12s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.13s/it]                                               {'loss': 2.472, 'grad_norm': 4.239480972290039, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.13s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it]                                               {'loss': 2.3671, 'grad_norm': 3.601984977722168, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it]                                               {'loss': 2.3344, 'grad_norm': 4.588179588317871, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it] 40%|████      | 16/40 [00:17<00:22,  1.05it/s]                                               {'loss': 2.3104, 'grad_norm': 27.651098251342773, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:17<00:22,  1.05it/s] 42%|████▎     | 17/40 [00:18<00:22,  1.01it/s]                                               {'loss': 2.3907, 'grad_norm': 3.3052937984466553, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:22,  1.01it/s] 45%|████▌     | 18/40 [00:19<00:22,  1.03s/it]                                               {'loss': 2.12, 'grad_norm': 3.4640004634857178, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:22,  1.03s/it] 48%|████▊     | 19/40 [00:20<00:22,  1.05s/it]                                               {'loss': 2.4382, 'grad_norm': 4.261444568634033, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:22,  1.05s/it] 50%|█████     | 20/40 [00:21<00:21,  1.08s/it]                                               {'loss': 2.1327, 'grad_norm': 4.350222110748291, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.08s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it]                                               {'loss': 2.315, 'grad_norm': 3.060124635696411, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:24<00:20,  1.11s/it]                                               {'loss': 2.0695, 'grad_norm': 3.979074716567993, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:24<00:20,  1.11s/it] 57%|█████▊    | 23/40 [00:25<00:18,  1.11s/it]                                               {'loss': 2.1091, 'grad_norm': 3.2334060668945312, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:25<00:18,  1.11s/it] 60%|██████    | 24/40 [00:25<00:13,  1.17it/s]                                               {'loss': 2.8368, 'grad_norm': 11.819900512695312, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.17it/s] 62%|██████▎   | 25/40 [00:26<00:13,  1.08it/s]                                               {'loss': 2.2712, 'grad_norm': 4.028696537017822, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:27<00:13,  1.01it/s]                                               {'loss': 2.0862, 'grad_norm': 3.348574638366699, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:28<00:13,  1.02s/it]                                               {'loss': 2.4204, 'grad_norm': 4.056066989898682, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.02s/it] 70%|███████   | 28/40 [00:29<00:12,  1.06s/it]                                               {'loss': 2.0404, 'grad_norm': 2.9900002479553223, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.07s/it]                                               {'loss': 2.0528, 'grad_norm': 3.7925777435302734, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.07s/it] 75%|███████▌  | 30/40 [00:32<00:10,  1.09s/it]                                               {'loss': 1.9558, 'grad_norm': 3.8992490768432617, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:32<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:33<00:09,  1.10s/it]                                               {'loss': 1.9486, 'grad_norm': 3.446291923522949, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:33<00:09,  1.10s/it] 80%|████████  | 32/40 [00:33<00:06,  1.19it/s]                                               {'loss': 0.9032, 'grad_norm': 8.349822044372559, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:33<00:06,  1.19it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.09it/s]                                               {'loss': 2.1758, 'grad_norm': 3.826803207397461, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.00it/s]                                               {'loss': 1.9258, 'grad_norm': 3.890817165374756, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.00it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it]                                               {'loss': 1.8964, 'grad_norm': 3.0070266723632812, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:38<00:04,  1.07s/it]                                               {'loss': 1.8878, 'grad_norm': 3.5182855129241943, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:38<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:39<00:03,  1.08s/it]                                               {'loss': 1.9925, 'grad_norm': 3.1207902431488037, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:39<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:40<00:02,  1.11s/it]                                               {'loss': 2.3689, 'grad_norm': 4.031470775604248, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:40<00:02,  1.11s/it] 98%|█████████▊| 39/40 [00:41<00:01,  1.10s/it]                                               {'loss': 2.3534, 'grad_norm': 3.911510705947876, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:41<00:01,  1.10s/it]100%|██████████| 40/40 [00:41<00:00,  1.19it/s]                                               {'loss': 1.0312, 'grad_norm': 12.07304859161377, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.19it/s]                                               {'train_runtime': 41.7714, 'train_samples_per_second': 13.526, 'train_steps_per_second': 0.958, 'train_loss': 2.2202664270997046, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.19it/s]100%|██████████| 40/40 [00:41<00:00,  1.04s/it]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]                                              {'loss': 2.7854, 'grad_norm': 2.7152841091156006, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]                                              {'loss': 2.4237, 'grad_norm': 3.4115545749664307, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]  8%|▊         | 3/40 [00:03<00:42,  1.14s/it]                                              {'loss': 2.4916, 'grad_norm': 4.1413493156433105, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.14s/it] 10%|█         | 4/40 [00:04<00:40,  1.13s/it]                                              {'loss': 2.4327, 'grad_norm': 3.648432493209839, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.13s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.6192, 'grad_norm': 5.414106845855713, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.5538, 'grad_norm': 3.7006382942199707, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.5817, 'grad_norm': 4.103725433349609, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:32,  1.02s/it]                                              {'loss': 2.1203, 'grad_norm': 11.365598678588867, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.02s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.06s/it]                                              {'loss': 2.5608, 'grad_norm': 3.894766330718994, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.06s/it] 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it]                                               {'loss': 2.2909, 'grad_norm': 3.716477155685425, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it] 28%|██▊       | 11/40 [00:12<00:31,  1.10s/it]                                               {'loss': 2.303, 'grad_norm': 3.696453809738159, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:31,  1.10s/it] 30%|███       | 12/40 [00:13<00:31,  1.11s/it]                                               {'loss': 2.2174, 'grad_norm': 3.6811020374298096, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.11s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it]                                               {'loss': 2.1096, 'grad_norm': 7.929295539855957, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it]                                               {'loss': 2.3394, 'grad_norm': 3.749706268310547, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it]                                               {'loss': 2.1048, 'grad_norm': 4.054670333862305, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it] 40%|████      | 16/40 [00:17<00:22,  1.08it/s]                                               {'loss': 1.5648, 'grad_norm': 14.181543350219727, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:17<00:22,  1.08it/s] 42%|████▎     | 17/40 [00:18<00:22,  1.01it/s]                                               {'loss': 2.1115, 'grad_norm': 3.5108909606933594, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:22,  1.01it/s] 45%|████▌     | 18/40 [00:19<00:22,  1.03s/it]                                               {'loss': 2.0011, 'grad_norm': 3.2412776947021484, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:22,  1.03s/it] 48%|████▊     | 19/40 [00:20<00:22,  1.05s/it]                                               {'loss': 2.1416, 'grad_norm': 3.8781745433807373, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:22,  1.05s/it] 50%|█████     | 20/40 [00:21<00:21,  1.08s/it]                                               {'loss': 2.2332, 'grad_norm': 4.230593204498291, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.08s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it]                                               {'loss': 2.0109, 'grad_norm': 3.866058111190796, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.11s/it]                                               {'loss': 2.4134, 'grad_norm': 4.206509113311768, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.11s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.10s/it]                                               {'loss': 2.3647, 'grad_norm': 3.7680459022521973, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:25<00:18,  1.10s/it] 60%|██████    | 24/40 [00:25<00:13,  1.19it/s]                                               {'loss': 2.2467, 'grad_norm': 11.893229484558105, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.19it/s] 62%|██████▎   | 25/40 [00:26<00:13,  1.09it/s]                                               {'loss': 2.2679, 'grad_norm': 3.406697988510132, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:27<00:13,  1.02it/s]                                               {'loss': 2.1665, 'grad_norm': 3.510563611984253, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:28<00:13,  1.02s/it]                                               {'loss': 1.7688, 'grad_norm': 3.3912179470062256, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.02s/it] 70%|███████   | 28/40 [00:29<00:12,  1.06s/it]                                               {'loss': 2.1398, 'grad_norm': 3.869819402694702, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 2.1538, 'grad_norm': 5.065107822418213, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.08s/it]                                               {'loss': 2.1481, 'grad_norm': 3.822145700454712, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.08s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.05s/it]                                               {'loss': 1.9503, 'grad_norm': 4.380736827850342, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.05s/it] 80%|████████  | 32/40 [00:33<00:06,  1.30it/s]                                               {'loss': 2.2281, 'grad_norm': 13.272228240966797, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:33<00:06,  1.30it/s] 82%|████████▎ | 33/40 [00:33<00:05,  1.20it/s]                                               {'loss': 1.9255, 'grad_norm': 3.5039479732513428, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:05,  1.20it/s] 85%|████████▌ | 34/40 [00:34<00:04,  1.24it/s]                                               {'loss': 1.9255, 'grad_norm': 3.9758596420288086, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:04,  1.24it/s] 88%|████████▊ | 35/40 [00:35<00:04,  1.20it/s]                                               {'loss': 1.9669, 'grad_norm': 4.499375343322754, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:04,  1.20it/s] 90%|█████████ | 36/40 [00:36<00:03,  1.15it/s]                                               {'loss': 2.0034, 'grad_norm': 4.04294490814209, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:03,  1.15it/s] 92%|█████████▎| 37/40 [00:37<00:02,  1.06it/s]                                               {'loss': 2.2045, 'grad_norm': 3.6083760261535645, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:02,  1.06it/s] 95%|█████████▌| 38/40 [00:38<00:02,  1.01s/it]                                               {'loss': 2.3019, 'grad_norm': 3.8357882499694824, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.01s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.04s/it]                                               {'loss': 2.0858, 'grad_norm': 4.259039402008057, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.04s/it]100%|██████████| 40/40 [00:40<00:00,  1.26it/s]                                               {'loss': 1.5552, 'grad_norm': 19.857357025146484, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.26it/s]                                               {'train_runtime': 40.3107, 'train_samples_per_second': 14.016, 'train_steps_per_second': 0.992, 'train_loss': 2.1953530102968215, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.26it/s]100%|██████████| 40/40 [00:40<00:00,  1.01s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<02:04,  3.77it/s]  1%|          | 3/471 [00:01<03:00,  2.60it/s]  1%|          | 4/471 [00:01<03:18,  2.35it/s]  1%|          | 5/471 [00:02<03:21,  2.31it/s]  1%|▏         | 6/471 [00:02<03:24,  2.27it/s]  1%|▏         | 7/471 [00:02<03:26,  2.25it/s]  2%|▏         | 8/471 [00:03<03:26,  2.24it/s]  2%|▏         | 9/471 [00:03<03:25,  2.24it/s]  2%|▏         | 10/471 [00:04<03:27,  2.22it/s]  2%|▏         | 11/471 [00:04<03:31,  2.18it/s]  3%|▎         | 12/471 [00:05<03:40,  2.08it/s]  3%|▎         | 13/471 [00:05<03:51,  1.98it/s]  3%|▎         | 14/471 [00:06<03:56,  1.93it/s]  3%|▎         | 15/471 [00:06<03:59,  1.91it/s]  3%|▎         | 16/471 [00:07<04:01,  1.89it/s]  4%|▎         | 17/471 [00:08<03:59,  1.90it/s]  4%|▍         | 18/471 [00:08<04:03,  1.86it/s]  4%|▍         | 19/471 [00:09<04:07,  1.83it/s]  4%|▍         | 20/471 [00:09<04:04,  1.85it/s]  4%|▍         | 21/471 [00:10<04:05,  1.83it/s]  5%|▍         | 22/471 [00:10<04:01,  1.86it/s]  5%|▍         | 23/471 [00:11<04:05,  1.83it/s]  5%|▌         | 24/471 [00:11<04:07,  1.81it/s]  5%|▌         | 25/471 [00:12<04:07,  1.80it/s]  6%|▌         | 26/471 [00:12<04:02,  1.83it/s]  6%|▌         | 27/471 [00:13<03:55,  1.88it/s]  6%|▌         | 28/471 [00:13<03:55,  1.88it/s]  6%|▌         | 29/471 [00:14<03:58,  1.86it/s]  6%|▋         | 30/471 [00:15<04:00,  1.84it/s]  7%|▋         | 31/471 [00:15<03:58,  1.85it/s]  7%|▋         | 32/471 [00:16<03:50,  1.91it/s]  7%|▋         | 33/471 [00:16<03:37,  2.01it/s]  7%|▋         | 34/471 [00:16<03:25,  2.13it/s]  7%|▋         | 35/471 [00:17<03:22,  2.15it/s]  8%|▊         | 36/471 [00:17<03:21,  2.15it/s]  8%|▊         | 37/471 [00:18<03:25,  2.11it/s]  8%|▊         | 38/471 [00:18<03:25,  2.10it/s]  8%|▊         | 39/471 [00:19<03:27,  2.08it/s]  8%|▊         | 40/471 [00:19<03:34,  2.01it/s]  9%|▊         | 41/471 [00:20<03:41,  1.95it/s]  9%|▉         | 42/471 [00:20<03:45,  1.90it/s]  9%|▉         | 43/471 [00:21<03:44,  1.90it/s]  9%|▉         | 44/471 [00:22<03:42,  1.92it/s] 10%|▉         | 45/471 [00:22<03:41,  1.92it/s] 10%|▉         | 46/471 [00:23<03:36,  1.96it/s] 10%|▉         | 47/471 [00:23<03:30,  2.02it/s] 10%|█         | 48/471 [00:23<03:23,  2.08it/s] 10%|█         | 49/471 [00:24<03:15,  2.15it/s] 11%|█         | 50/471 [00:24<03:10,  2.21it/s] 11%|█         | 51/471 [00:25<03:06,  2.25it/s] 11%|█         | 52/471 [00:25<03:20,  2.09it/s] 11%|█▏        | 53/471 [00:26<03:31,  1.97it/s] 11%|█▏        | 54/471 [00:26<03:36,  1.93it/s] 12%|█▏        | 55/471 [00:27<03:38,  1.91it/s] 12%|█▏        | 56/471 [00:27<03:37,  1.91it/s] 12%|█▏        | 57/471 [00:28<03:31,  1.95it/s] 12%|█▏        | 58/471 [00:28<03:35,  1.91it/s] 13%|█▎        | 59/471 [00:29<03:38,  1.88it/s] 13%|█▎        | 60/471 [00:30<03:41,  1.86it/s] 13%|█▎        | 61/471 [00:30<03:42,  1.84it/s] 13%|█▎        | 62/471 [00:31<03:40,  1.85it/s] 13%|█▎        | 63/471 [00:31<03:34,  1.90it/s] 14%|█▎        | 64/471 [00:32<03:37,  1.88it/s] 14%|█▍        | 65/471 [00:32<03:38,  1.86it/s] 14%|█▍        | 66/471 [00:33<03:40,  1.84it/s] 14%|█▍        | 67/471 [00:33<03:38,  1.85it/s] 14%|█▍        | 68/471 [00:34<03:38,  1.84it/s] 15%|█▍        | 69/471 [00:34<03:34,  1.88it/s] 15%|█▍        | 70/471 [00:35<03:26,  1.94it/s] 15%|█▌        | 71/471 [00:35<03:19,  2.01it/s] 15%|█▌        | 72/471 [00:36<03:14,  2.06it/s] 15%|█▌        | 73/471 [00:36<03:10,  2.09it/s] 16%|█▌        | 74/471 [00:37<03:05,  2.14it/s] 16%|█▌        | 75/471 [00:37<03:11,  2.06it/s] 16%|█▌        | 76/471 [00:38<03:19,  1.98it/s] 16%|█▋        | 77/471 [00:38<03:26,  1.91it/s] 17%|█▋        | 78/471 [00:39<03:28,  1.89it/s] 17%|█▋        | 79/471 [00:39<03:28,  1.88it/s] 17%|█▋        | 80/471 [00:40<03:26,  1.90it/s] 17%|█▋        | 81/471 [00:40<03:20,  1.95it/s] 17%|█▋        | 82/471 [00:41<03:18,  1.96it/s] 18%|█▊        | 83/471 [00:41<03:22,  1.92it/s] 18%|█▊        | 84/471 [00:42<03:24,  1.89it/s] 18%|█▊        | 85/471 [00:43<03:26,  1.87it/s] 18%|█▊        | 86/471 [00:43<03:25,  1.87it/s] 18%|█▊        | 87/471 [00:44<03:22,  1.90it/s] 19%|█▊        | 88/471 [00:44<03:20,  1.91it/s] 19%|█▉        | 89/471 [00:45<03:19,  1.91it/s] 19%|█▉        | 90/471 [00:45<03:25,  1.86it/s] 19%|█▉        | 91/471 [00:46<03:25,  1.85it/s] 20%|█▉        | 92/471 [00:46<03:25,  1.85it/s] 20%|█▉        | 93/471 [00:47<03:22,  1.87it/s] 20%|█▉        | 94/471 [00:47<03:21,  1.87it/s] 20%|██        | 95/471 [00:48<03:22,  1.86it/s] 20%|██        | 96/471 [00:48<03:21,  1.86it/s] 21%|██        | 97/471 [00:49<03:21,  1.86it/s] 21%|██        | 98/471 [00:50<03:21,  1.85it/s] 21%|██        | 99/471 [00:50<03:16,  1.89it/s] 21%|██        | 100/471 [00:51<03:18,  1.87it/s] 21%|██▏       | 101/471 [00:51<03:20,  1.85it/s] 22%|██▏       | 102/471 [00:52<03:19,  1.85it/s] 22%|██▏       | 103/471 [00:52<03:18,  1.85it/s] 22%|██▏       | 104/471 [00:53<03:17,  1.86it/s] 22%|██▏       | 105/471 [00:53<03:17,  1.85it/s] 23%|██▎       | 106/471 [00:54<03:09,  1.92it/s] 23%|██▎       | 107/471 [00:54<03:00,  2.02it/s] 23%|██▎       | 108/471 [00:55<02:54,  2.08it/s] 23%|██▎       | 109/471 [00:55<02:47,  2.16it/s] 23%|██▎       | 110/471 [00:56<02:46,  2.17it/s] 24%|██▎       | 111/471 [00:56<02:55,  2.05it/s] 24%|██▍       | 112/471 [00:57<03:02,  1.96it/s] 24%|██▍       | 113/471 [00:57<03:05,  1.93it/s] 24%|██▍       | 114/471 [00:58<03:06,  1.91it/s] 24%|██▍       | 115/471 [00:58<03:07,  1.90it/s] 25%|██▍       | 116/471 [00:59<03:09,  1.87it/s] 25%|██▍       | 117/471 [00:59<03:10,  1.86it/s] 25%|██▌       | 118/471 [01:00<03:09,  1.87it/s] 25%|██▌       | 119/471 [01:00<03:08,  1.87it/s] 25%|██▌       | 120/471 [01:01<03:06,  1.88it/s] 26%|██▌       | 121/471 [01:02<03:09,  1.84it/s] 26%|██▌       | 122/471 [01:02<03:10,  1.83it/s] 26%|██▌       | 123/471 [01:03<03:08,  1.85it/s] 26%|██▋       | 124/471 [01:03<03:07,  1.85it/s] 27%|██▋       | 125/471 [01:04<03:05,  1.87it/s] 27%|██▋       | 126/471 [01:04<03:07,  1.84it/s] 27%|██▋       | 127/471 [01:05<03:09,  1.82it/s] 27%|██▋       | 128/471 [01:05<03:08,  1.82it/s] 27%|██▋       | 129/471 [01:06<03:03,  1.87it/s] 28%|██▊       | 130/471 [01:06<03:02,  1.87it/s] 28%|██▊       | 131/471 [01:07<03:04,  1.84it/s] 28%|██▊       | 132/471 [01:07<03:05,  1.83it/s] 28%|██▊       | 133/471 [01:08<03:05,  1.82it/s] 28%|██▊       | 134/471 [01:09<03:05,  1.82it/s] 29%|██▊       | 135/471 [01:09<02:59,  1.87it/s] 29%|██▉       | 136/471 [01:10<03:00,  1.86it/s] 29%|██▉       | 137/471 [01:10<03:00,  1.85it/s] 29%|██▉       | 138/471 [01:11<03:01,  1.84it/s] 30%|██▉       | 139/471 [01:11<03:00,  1.84it/s] 30%|██▉       | 140/471 [01:12<02:58,  1.86it/s] 30%|██▉       | 141/471 [01:12<02:51,  1.93it/s] 30%|███       | 142/471 [01:13<02:44,  2.00it/s] 30%|███       | 143/471 [01:13<02:39,  2.06it/s] 31%|███       | 144/471 [01:14<02:36,  2.09it/s] 31%|███       | 145/471 [01:14<02:32,  2.13it/s] 31%|███       | 146/471 [01:15<02:30,  2.17it/s] 31%|███       | 147/471 [01:15<02:31,  2.13it/s] 31%|███▏      | 148/471 [01:16<02:38,  2.04it/s] 32%|███▏      | 149/471 [01:16<02:43,  1.97it/s] 32%|███▏      | 150/471 [01:17<02:46,  1.92it/s] 32%|███▏      | 151/471 [01:17<02:47,  1.91it/s] 32%|███▏      | 152/471 [01:18<02:49,  1.88it/s] 32%|███▏      | 153/471 [01:18<02:50,  1.87it/s] 33%|███▎      | 154/471 [01:19<02:51,  1.85it/s] 33%|███▎      | 155/471 [01:19<02:52,  1.83it/s] 33%|███▎      | 156/471 [01:20<02:48,  1.87it/s] 33%|███▎      | 157/471 [01:20<02:49,  1.85it/s] 34%|███▎      | 158/471 [01:21<02:50,  1.83it/s] 34%|███▍      | 159/471 [01:22<02:47,  1.86it/s] 34%|███▍      | 160/471 [01:22<02:49,  1.84it/s] 34%|███▍      | 161/471 [01:23<02:48,  1.84it/s] 34%|███▍      | 162/471 [01:23<02:45,  1.87it/s] 35%|███▍      | 163/471 [01:24<02:46,  1.85it/s] 35%|███▍      | 164/471 [01:24<02:47,  1.84it/s] 35%|███▌      | 165/471 [01:25<02:45,  1.85it/s] 35%|███▌      | 166/471 [01:25<02:45,  1.84it/s] 35%|███▌      | 167/471 [01:26<02:44,  1.84it/s] 36%|███▌      | 168/471 [01:26<02:42,  1.86it/s] 36%|███▌      | 169/471 [01:27<02:44,  1.83it/s] 36%|███▌      | 170/471 [01:28<02:45,  1.82it/s] 36%|███▋      | 171/471 [01:28<02:43,  1.84it/s] 37%|███▋      | 172/471 [01:29<02:42,  1.85it/s] 37%|███▋      | 173/471 [01:29<02:40,  1.86it/s] 37%|███▋      | 174/471 [01:30<02:43,  1.82it/s] 37%|███▋      | 175/471 [01:30<02:44,  1.80it/s] 37%|███▋      | 176/471 [01:31<02:43,  1.81it/s] 38%|███▊      | 177/471 [01:31<02:41,  1.82it/s] 38%|███▊      | 178/471 [01:32<02:30,  1.95it/s] 38%|███▊      | 179/471 [01:32<02:25,  2.00it/s] 38%|███▊      | 180/471 [01:33<02:23,  2.03it/s] 38%|███▊      | 181/471 [01:33<02:19,  2.07it/s] 39%|███▊      | 182/471 [01:34<02:17,  2.10it/s] 39%|███▉      | 183/471 [01:34<02:20,  2.05it/s] 39%|███▉      | 184/471 [01:35<02:26,  1.96it/s] 39%|███▉      | 185/471 [01:35<02:31,  1.88it/s] 39%|███▉      | 186/471 [01:36<02:34,  1.85it/s] 40%|███▉      | 187/471 [01:36<02:33,  1.86it/s] 40%|███▉      | 188/471 [01:37<02:30,  1.88it/s] 40%|████      | 189/471 [01:37<02:27,  1.91it/s] 40%|████      | 190/471 [01:38<02:29,  1.88it/s] 41%|████      | 191/471 [01:39<02:30,  1.86it/s] 41%|████      | 192/471 [01:39<02:31,  1.85it/s] 41%|████      | 193/471 [01:40<02:30,  1.84it/s] 41%|████      | 194/471 [01:40<02:30,  1.84it/s] 41%|████▏     | 195/471 [01:41<02:26,  1.89it/s] 42%|████▏     | 196/471 [01:41<02:27,  1.86it/s] 42%|████▏     | 197/471 [01:42<02:27,  1.86it/s] 42%|████▏     | 198/471 [01:42<02:27,  1.84it/s] 42%|████▏     | 199/471 [01:43<02:28,  1.83it/s] 42%|████▏     | 200/471 [01:43<02:28,  1.82it/s] 43%|████▎     | 201/471 [01:44<02:24,  1.87it/s] 43%|████▎     | 202/471 [01:45<02:25,  1.85it/s] 43%|████▎     | 203/471 [01:45<02:27,  1.82it/s] 43%|████▎     | 204/471 [01:46<02:26,  1.82it/s] 44%|████▎     | 205/471 [01:46<02:23,  1.86it/s] 44%|████▎     | 206/471 [01:47<02:24,  1.83it/s] 44%|████▍     | 207/471 [01:47<02:24,  1.83it/s] 44%|████▍     | 208/471 [01:48<02:25,  1.81it/s] 44%|████▍     | 209/471 [01:48<02:24,  1.82it/s] 45%|████▍     | 210/471 [01:49<02:21,  1.84it/s] 45%|████▍     | 211/471 [01:49<02:21,  1.83it/s] 45%|████▌     | 212/471 [01:50<02:22,  1.81it/s] 45%|████▌     | 213/471 [01:51<02:19,  1.85it/s] 45%|████▌     | 214/471 [01:51<02:12,  1.94it/s] 46%|████▌     | 215/471 [01:51<02:05,  2.03it/s] 46%|████▌     | 216/471 [01:52<01:59,  2.13it/s] 46%|████▌     | 217/471 [01:52<01:56,  2.17it/s] 46%|████▋     | 218/471 [01:53<01:55,  2.18it/s] 46%|████▋     | 219/471 [01:53<02:02,  2.06it/s] 47%|████▋     | 220/471 [01:54<02:07,  1.97it/s] 47%|████▋     | 221/471 [01:54<02:11,  1.90it/s] 47%|████▋     | 222/471 [01:55<02:10,  1.90it/s] 47%|████▋     | 223/471 [01:55<02:12,  1.87it/s] 48%|████▊     | 224/471 [01:56<02:13,  1.85it/s] 48%|████▊     | 225/471 [01:57<02:13,  1.84it/s] 48%|████▊     | 226/471 [01:57<02:14,  1.83it/s] 48%|████▊     | 227/471 [01:58<02:14,  1.82it/s] 48%|████▊     | 228/471 [01:58<02:11,  1.84it/s] 49%|████▊     | 229/471 [01:59<02:12,  1.82it/s] 49%|████▉     | 230/471 [01:59<02:13,  1.81it/s] 49%|████▉     | 231/471 [02:00<02:10,  1.83it/s] 49%|████▉     | 232/471 [02:00<02:10,  1.83it/s] 49%|████▉     | 233/471 [02:01<02:08,  1.85it/s] 50%|████▉     | 234/471 [02:01<02:07,  1.86it/s] 50%|████▉     | 235/471 [02:02<02:07,  1.85it/s] 50%|█████     | 236/471 [02:03<02:07,  1.85it/s] 50%|█████     | 237/471 [02:03<02:05,  1.86it/s] 51%|█████     | 238/471 [02:04<02:07,  1.83it/s] 51%|█████     | 239/471 [02:04<02:08,  1.81it/s] 51%|█████     | 240/471 [02:05<02:06,  1.83it/s] 51%|█████     | 241/471 [02:05<02:05,  1.83it/s] 51%|█████▏    | 242/471 [02:06<02:06,  1.81it/s] 52%|█████▏    | 243/471 [02:06<02:05,  1.81it/s] 52%|█████▏    | 244/471 [02:07<02:05,  1.81it/s] 52%|█████▏    | 245/471 [02:08<02:04,  1.81it/s] 52%|█████▏    | 246/471 [02:08<02:01,  1.85it/s] 52%|█████▏    | 247/471 [02:09<01:59,  1.88it/s] 53%|█████▎    | 248/471 [02:09<02:00,  1.85it/s] 53%|█████▎    | 249/471 [02:10<01:58,  1.87it/s] 53%|█████▎    | 250/471 [02:10<01:52,  1.97it/s] 53%|█████▎    | 251/471 [02:11<01:47,  2.04it/s] 54%|█████▎    | 252/471 [02:11<01:44,  2.10it/s] 54%|█████▎    | 253/471 [02:11<01:42,  2.13it/s] 54%|█████▍    | 254/471 [02:12<01:39,  2.18it/s] 54%|█████▍    | 255/471 [02:12<01:44,  2.08it/s] 54%|█████▍    | 256/471 [02:13<01:48,  1.98it/s] 55%|█████▍    | 257/471 [02:14<01:51,  1.92it/s] 55%|█████▍    | 258/471 [02:14<01:53,  1.88it/s] 55%|█████▍    | 259/471 [02:15<01:51,  1.90it/s] 55%|█████▌    | 260/471 [02:15<01:44,  2.02it/s] 55%|█████▌    | 261/471 [02:15<01:41,  2.08it/s] 56%|█████▌    | 262/471 [02:16<01:36,  2.17it/s] 56%|█████▌    | 263/471 [02:16<01:31,  2.27it/s] 56%|█████▌    | 264/471 [02:17<01:27,  2.36it/s] 56%|█████▋    | 265/471 [02:17<01:24,  2.43it/s] 56%|█████▋    | 266/471 [02:17<01:21,  2.52it/s] 57%|█████▋    | 267/471 [02:18<01:21,  2.49it/s] 57%|█████▋    | 268/471 [02:18<01:29,  2.26it/s] 57%|█████▋    | 269/471 [02:19<01:32,  2.19it/s] 57%|█████▋    | 270/471 [02:19<01:36,  2.08it/s] 58%|█████▊    | 271/471 [02:20<01:41,  1.98it/s] 58%|█████▊    | 272/471 [02:20<01:43,  1.92it/s] 58%|█████▊    | 273/471 [02:21<01:42,  1.93it/s] 58%|█████▊    | 274/471 [02:22<01:44,  1.89it/s] 58%|█████▊    | 275/471 [02:22<01:45,  1.85it/s] 59%|█████▊    | 276/471 [02:23<01:46,  1.83it/s] 59%|█████▉    | 277/471 [02:23<01:46,  1.82it/s] 59%|█████▉    | 278/471 [02:24<01:46,  1.82it/s] 59%|█████▉    | 279/471 [02:24<01:43,  1.85it/s] 59%|█████▉    | 280/471 [02:25<01:44,  1.83it/s] 60%|█████▉    | 281/471 [02:25<01:45,  1.81it/s] 60%|█████▉    | 282/471 [02:26<01:44,  1.82it/s] 60%|██████    | 283/471 [02:27<01:43,  1.81it/s] 60%|██████    | 284/471 [02:27<01:43,  1.81it/s] 61%|██████    | 285/471 [02:28<01:40,  1.84it/s] 61%|██████    | 286/471 [02:28<01:36,  1.92it/s] 61%|██████    | 287/471 [02:29<01:32,  1.99it/s] 61%|██████    | 288/471 [02:29<01:29,  2.05it/s] 61%|██████▏   | 289/471 [02:29<01:25,  2.12it/s] 62%|██████▏   | 290/471 [02:30<01:21,  2.22it/s] 62%|██████▏   | 291/471 [02:30<01:21,  2.21it/s] 62%|██████▏   | 292/471 [02:31<01:16,  2.33it/s] 62%|██████▏   | 293/471 [02:31<01:18,  2.28it/s] 62%|██████▏   | 294/471 [02:32<01:18,  2.25it/s] 63%|██████▎   | 295/471 [02:32<01:19,  2.23it/s] 63%|██████▎   | 296/471 [02:33<01:20,  2.17it/s] 63%|██████▎   | 297/471 [02:33<01:24,  2.05it/s] 63%|██████▎   | 298/471 [02:33<01:21,  2.13it/s] 63%|██████▎   | 299/471 [02:34<01:18,  2.19it/s] 64%|██████▎   | 300/471 [02:34<01:22,  2.07it/s] 64%|██████▍   | 301/471 [02:35<01:24,  2.00it/s] 64%|██████▍   | 302/471 [02:36<01:27,  1.92it/s] 64%|██████▍   | 303/471 [02:36<01:29,  1.87it/s] 65%|██████▍   | 304/471 [02:37<01:30,  1.85it/s] 65%|██████▍   | 305/471 [02:37<01:29,  1.85it/s] 65%|██████▍   | 306/471 [02:38<01:27,  1.89it/s] 65%|██████▌   | 307/471 [02:38<01:27,  1.88it/s] 65%|██████▌   | 308/471 [02:39<01:28,  1.84it/s] 66%|██████▌   | 309/471 [02:39<01:28,  1.83it/s] 66%|██████▌   | 310/471 [02:40<01:27,  1.83it/s] 66%|██████▌   | 311/471 [02:40<01:27,  1.83it/s] 66%|██████▌   | 312/471 [02:41<01:25,  1.86it/s] 66%|██████▋   | 313/471 [02:42<01:24,  1.88it/s] 67%|██████▋   | 314/471 [02:42<01:23,  1.88it/s] 67%|██████▋   | 315/471 [02:43<01:24,  1.84it/s] 67%|██████▋   | 316/471 [02:43<01:23,  1.85it/s] 67%|██████▋   | 317/471 [02:44<01:23,  1.85it/s] 68%|██████▊   | 318/471 [02:44<01:22,  1.86it/s] 68%|██████▊   | 319/471 [02:45<01:22,  1.84it/s] 68%|██████▊   | 320/471 [02:45<01:21,  1.86it/s] 68%|██████▊   | 321/471 [02:46<01:19,  1.89it/s] 68%|██████▊   | 322/471 [02:46<01:20,  1.86it/s] 69%|██████▊   | 323/471 [02:47<01:21,  1.82it/s] 69%|██████▉   | 324/471 [02:47<01:18,  1.87it/s] 69%|██████▉   | 325/471 [02:48<01:15,  1.94it/s] 69%|██████▉   | 326/471 [02:48<01:11,  2.02it/s] 69%|██████▉   | 327/471 [02:49<01:10,  2.05it/s] 70%|██████▉   | 328/471 [02:49<01:09,  2.06it/s] 70%|██████▉   | 329/471 [02:50<01:08,  2.07it/s] 70%|███████   | 330/471 [02:50<01:08,  2.07it/s] 70%|███████   | 331/471 [02:51<01:08,  2.05it/s] 70%|███████   | 332/471 [02:51<01:07,  2.06it/s] 71%|███████   | 333/471 [02:52<01:06,  2.08it/s] 71%|███████   | 334/471 [02:52<01:05,  2.09it/s] 71%|███████   | 335/471 [02:53<01:04,  2.10it/s] 71%|███████▏  | 336/471 [02:53<01:03,  2.13it/s] 72%|███████▏  | 337/471 [02:54<01:06,  2.00it/s] 72%|███████▏  | 338/471 [02:54<01:08,  1.94it/s] 72%|███████▏  | 339/471 [02:55<01:10,  1.88it/s] 72%|███████▏  | 340/471 [02:55<01:10,  1.87it/s] 72%|███████▏  | 341/471 [02:56<01:09,  1.87it/s] 73%|███████▎  | 342/471 [02:56<01:09,  1.86it/s] 73%|███████▎  | 343/471 [02:57<01:10,  1.82it/s] 73%|███████▎  | 344/471 [02:58<01:10,  1.80it/s] 73%|███████▎  | 345/471 [02:58<01:10,  1.80it/s] 73%|███████▎  | 346/471 [02:59<01:07,  1.84it/s] 74%|███████▎  | 347/471 [02:59<01:07,  1.85it/s] 74%|███████▍  | 348/471 [03:00<01:06,  1.84it/s] 74%|███████▍  | 349/471 [03:00<01:07,  1.81it/s] 74%|███████▍  | 350/471 [03:01<01:07,  1.80it/s] 75%|███████▍  | 351/471 [03:01<01:06,  1.81it/s] 75%|███████▍  | 352/471 [03:02<01:04,  1.84it/s] 75%|███████▍  | 353/471 [03:03<01:04,  1.84it/s] 75%|███████▌  | 354/471 [03:03<01:04,  1.82it/s] 75%|███████▌  | 355/471 [03:04<01:03,  1.82it/s] 76%|███████▌  | 356/471 [03:04<01:03,  1.81it/s] 76%|███████▌  | 357/471 [03:05<01:02,  1.83it/s] 76%|███████▌  | 358/471 [03:05<01:01,  1.82it/s] 76%|███████▌  | 359/471 [03:06<01:02,  1.80it/s] 76%|███████▋  | 360/471 [03:06<01:01,  1.79it/s] 77%|███████▋  | 361/471 [03:07<00:58,  1.87it/s] 77%|███████▋  | 362/471 [03:07<00:55,  1.98it/s] 77%|███████▋  | 363/471 [03:08<00:52,  2.05it/s] 77%|███████▋  | 364/471 [03:08<00:51,  2.06it/s] 77%|███████▋  | 365/471 [03:09<00:51,  2.08it/s] 78%|███████▊  | 366/471 [03:09<00:51,  2.05it/s] 78%|███████▊  | 367/471 [03:10<00:52,  1.97it/s] 78%|███████▊  | 368/471 [03:10<00:52,  1.94it/s] 78%|███████▊  | 369/471 [03:11<00:53,  1.90it/s] 79%|███████▊  | 370/471 [03:11<00:54,  1.86it/s] 79%|███████▉  | 371/471 [03:12<00:54,  1.82it/s] 79%|███████▉  | 372/471 [03:13<00:54,  1.82it/s] 79%|███████▉  | 373/471 [03:13<00:54,  1.81it/s] 79%|███████▉  | 374/471 [03:14<00:52,  1.85it/s] 80%|███████▉  | 375/471 [03:14<00:52,  1.82it/s] 80%|███████▉  | 376/471 [03:15<00:52,  1.80it/s] 80%|████████  | 377/471 [03:15<00:52,  1.78it/s] 80%|████████  | 378/471 [03:16<00:51,  1.80it/s] 80%|████████  | 379/471 [03:16<00:50,  1.83it/s] 81%|████████  | 380/471 [03:17<00:50,  1.81it/s] 81%|████████  | 381/471 [03:18<00:49,  1.81it/s] 81%|████████  | 382/471 [03:18<00:49,  1.79it/s] 81%|████████▏ | 383/471 [03:19<00:48,  1.80it/s] 82%|████████▏ | 384/471 [03:19<00:48,  1.80it/s] 82%|████████▏ | 385/471 [03:20<00:48,  1.78it/s] 82%|████████▏ | 386/471 [03:20<00:48,  1.77it/s] 82%|████████▏ | 387/471 [03:21<00:47,  1.77it/s] 82%|████████▏ | 388/471 [03:21<00:46,  1.80it/s] 83%|████████▎ | 389/471 [03:22<00:44,  1.85it/s] 83%|████████▎ | 390/471 [03:23<00:44,  1.82it/s] 83%|████████▎ | 391/471 [03:23<00:44,  1.81it/s] 83%|████████▎ | 392/471 [03:24<00:44,  1.79it/s] 83%|████████▎ | 393/471 [03:24<00:43,  1.80it/s] 84%|████████▎ | 394/471 [03:25<00:42,  1.81it/s] 84%|████████▍ | 395/471 [03:25<00:41,  1.81it/s] 84%|████████▍ | 396/471 [03:26<00:41,  1.80it/s] 84%|████████▍ | 397/471 [03:26<00:41,  1.78it/s] 85%|████████▍ | 398/471 [03:27<00:40,  1.79it/s] 85%|████████▍ | 399/471 [03:28<00:40,  1.79it/s] 85%|████████▍ | 400/471 [03:28<00:38,  1.83it/s] 85%|████████▌ | 401/471 [03:29<00:38,  1.80it/s] 85%|████████▌ | 402/471 [03:29<00:38,  1.78it/s] 86%|████████▌ | 403/471 [03:30<00:38,  1.78it/s] 86%|████████▌ | 404/471 [03:30<00:37,  1.78it/s] 86%|████████▌ | 405/471 [03:31<00:36,  1.82it/s] 86%|████████▌ | 406/471 [03:31<00:36,  1.80it/s] 86%|████████▋ | 407/471 [03:32<00:35,  1.79it/s] 87%|████████▋ | 408/471 [03:33<00:35,  1.78it/s] 87%|████████▋ | 409/471 [03:33<00:34,  1.80it/s] 87%|████████▋ | 410/471 [03:34<00:33,  1.82it/s] 87%|████████▋ | 411/471 [03:34<00:33,  1.81it/s] 87%|████████▋ | 412/471 [03:35<00:32,  1.80it/s] 88%|████████▊ | 413/471 [03:35<00:32,  1.79it/s] 88%|████████▊ | 414/471 [03:36<00:31,  1.79it/s] 88%|████████▊ | 415/471 [03:36<00:30,  1.82it/s] 88%|████████▊ | 416/471 [03:37<00:30,  1.80it/s] 89%|████████▊ | 417/471 [03:38<00:30,  1.78it/s] 89%|████████▊ | 418/471 [03:38<00:29,  1.78it/s] 89%|████████▉ | 419/471 [03:39<00:29,  1.78it/s] 89%|████████▉ | 420/471 [03:39<00:28,  1.80it/s] 89%|████████▉ | 421/471 [03:40<00:27,  1.82it/s] 90%|████████▉ | 422/471 [03:40<00:27,  1.80it/s] 90%|████████▉ | 423/471 [03:41<00:26,  1.78it/s] 90%|█████████ | 424/471 [03:41<00:26,  1.78it/s] 90%|█████████ | 425/471 [03:42<00:25,  1.80it/s] 90%|█████████ | 426/471 [03:43<00:24,  1.84it/s] 91%|█████████ | 427/471 [03:43<00:23,  1.84it/s] 91%|█████████ | 428/471 [03:44<00:23,  1.82it/s] 91%|█████████ | 429/471 [03:44<00:23,  1.82it/s] 91%|█████████▏| 430/471 [03:45<00:22,  1.81it/s] 92%|█████████▏| 431/471 [03:45<00:22,  1.80it/s] 92%|█████████▏| 432/471 [03:46<00:21,  1.83it/s] 92%|█████████▏| 433/471 [03:46<00:20,  1.86it/s] 92%|█████████▏| 434/471 [03:47<00:20,  1.81it/s] 92%|█████████▏| 435/471 [03:48<00:20,  1.80it/s] 93%|█████████▎| 436/471 [03:48<00:19,  1.81it/s] 93%|█████████▎| 437/471 [03:49<00:18,  1.80it/s] 93%|█████████▎| 438/471 [03:49<00:18,  1.80it/s] 93%|█████████▎| 439/471 [03:50<00:17,  1.79it/s] 93%|█████████▎| 440/471 [03:50<00:17,  1.78it/s] 94%|█████████▎| 441/471 [03:51<00:16,  1.80it/s] 94%|█████████▍| 442/471 [03:51<00:16,  1.81it/s] 94%|█████████▍| 443/471 [03:52<00:15,  1.80it/s] 94%|█████████▍| 444/471 [03:53<00:15,  1.78it/s] 94%|█████████▍| 445/471 [03:53<00:14,  1.78it/s] 95%|█████████▍| 446/471 [03:54<00:13,  1.79it/s] 95%|█████████▍| 447/471 [03:54<00:13,  1.82it/s] 95%|█████████▌| 448/471 [03:55<00:12,  1.81it/s] 95%|█████████▌| 449/471 [03:55<00:12,  1.79it/s] 96%|█████████▌| 450/471 [03:56<00:11,  1.78it/s] 96%|█████████▌| 451/471 [03:56<00:11,  1.79it/s] 96%|█████████▌| 452/471 [03:57<00:10,  1.84it/s] 96%|█████████▌| 453/471 [03:57<00:09,  1.81it/s] 96%|█████████▋| 454/471 [03:58<00:09,  1.79it/s] 97%|█████████▋| 455/471 [03:59<00:09,  1.78it/s] 97%|█████████▋| 456/471 [03:59<00:08,  1.78it/s] 97%|█████████▋| 457/471 [04:00<00:07,  1.82it/s] 97%|█████████▋| 458/471 [04:00<00:07,  1.82it/s] 97%|█████████▋| 459/471 [04:01<00:06,  1.80it/s] 98%|█████████▊| 460/471 [04:01<00:06,  1.78it/s] 98%|█████████▊| 461/471 [04:02<00:05,  1.77it/s] 98%|█████████▊| 462/471 [04:03<00:04,  1.81it/s] 98%|█████████▊| 463/471 [04:03<00:04,  1.82it/s] 99%|█████████▊| 464/471 [04:04<00:03,  1.80it/s] 99%|█████████▊| 465/471 [04:04<00:03,  1.80it/s] 99%|█████████▉| 466/471 [04:05<00:02,  1.80it/s] 99%|█████████▉| 467/471 [04:05<00:02,  1.80it/s] 99%|█████████▉| 468/471 [04:06<00:01,  1.81it/s]100%|█████████▉| 469/471 [04:06<00:01,  1.79it/s]100%|█████████▉| 470/471 [04:07<00:00,  1.78it/s]100%|██████████| 471/471 [04:07<00:00,  1.88it/s]100%|██████████| 471/471 [04:07<00:00,  1.90it/s]
{'eval_loss': 2.30006742477417, 'eval_model_preparation_time': 0.0095, 'eval_acc': 0.4247211895910781, 'eval_runtime': 248.3912, 'eval_samples_per_second': 30.323, 'eval_steps_per_second': 1.896}
ROUND:2
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.10s/it]                                              {'loss': 2.3518, 'grad_norm': 4.261285305023193, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.10s/it]  5%|▌         | 2/40 [00:02<00:41,  1.10s/it]                                              {'loss': 2.4593, 'grad_norm': 3.9312381744384766, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:41,  1.10s/it]  8%|▊         | 3/40 [00:03<00:41,  1.12s/it]                                              {'loss': 2.1492, 'grad_norm': 4.36150598526001, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.12s/it] 10%|█         | 4/40 [00:04<00:39,  1.11s/it]                                              {'loss': 2.4003, 'grad_norm': 9.436295509338379, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.11s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.4763, 'grad_norm': 3.862377882003784, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.3535, 'grad_norm': 16.044448852539062, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.14s/it]                                              {'loss': 2.4365, 'grad_norm': 3.943143129348755, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.14s/it] 20%|██        | 8/40 [00:08<00:34,  1.08s/it]                                              {'loss': 2.2962, 'grad_norm': 15.074909210205078, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:34,  1.08s/it] 22%|██▎       | 9/40 [00:09<00:34,  1.10s/it]                                              {'loss': 2.082, 'grad_norm': 3.983672618865967, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:10<00:34,  1.10s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.09s/it]                                               {'loss': 2.0195, 'grad_norm': 7.620898246765137, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.09s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it]                                               {'loss': 2.1852, 'grad_norm': 3.308772087097168, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it] 30%|███       | 12/40 [00:13<00:30,  1.11s/it]                                               {'loss': 2.34, 'grad_norm': 4.292594909667969, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:30,  1.11s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.13s/it]                                               {'loss': 2.468, 'grad_norm': 3.9491138458251953, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.13s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it]                                               {'loss': 2.125, 'grad_norm': 3.8833913803100586, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.14s/it]                                               {'loss': 2.2377, 'grad_norm': 30.163938522338867, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.14s/it] 40%|████      | 16/40 [00:16<00:20,  1.19it/s]                                               {'loss': 2.5006, 'grad_norm': 16.265214920043945, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:18<00:21,  1.05it/s]                                               {'loss': 1.8673, 'grad_norm': 3.487025022506714, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:21,  1.05it/s] 45%|████▌     | 18/40 [00:19<00:21,  1.00it/s]                                               {'loss': 2.1737, 'grad_norm': 6.688683986663818, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:21,  1.00it/s] 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it]                                               {'loss': 2.2538, 'grad_norm': 3.631254196166992, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it] 50%|█████     | 20/40 [00:21<00:21,  1.05s/it]                                               {'loss': 2.1038, 'grad_norm': 3.286710500717163, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.05s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it]                                               {'loss': 2.2598, 'grad_norm': 5.455966949462891, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it]                                               {'loss': 2.0426, 'grad_norm': 3.3109586238861084, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it]                                               {'loss': 1.8962, 'grad_norm': 4.548556327819824, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it] 60%|██████    | 24/40 [00:25<00:13,  1.20it/s]                                               {'loss': 2.4365, 'grad_norm': 17.55120849609375, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:26<00:13,  1.07it/s]                                               {'loss': 2.0601, 'grad_norm': 3.3385467529296875, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:13,  1.07it/s] 65%|██████▌   | 26/40 [00:27<00:13,  1.01it/s]                                               {'loss': 1.9264, 'grad_norm': 4.228876113891602, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it]                                               {'loss': 2.2353, 'grad_norm': 4.81333589553833, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it] 70%|███████   | 28/40 [00:29<00:12,  1.06s/it]                                               {'loss': 2.0976, 'grad_norm': 4.512648582458496, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 2.0688, 'grad_norm': 4.226827621459961, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:11,  1.11s/it]                                               {'loss': 1.976, 'grad_norm': 5.127658367156982, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:11,  1.11s/it] 78%|███████▊  | 31/40 [00:33<00:09,  1.10s/it]                                               {'loss': 1.9088, 'grad_norm': 4.106927871704102, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:33<00:09,  1.10s/it] 80%|████████  | 32/40 [00:33<00:06,  1.20it/s]                                               {'loss': 2.1386, 'grad_norm': 13.757671356201172, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:33<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.10it/s]                                               {'loss': 1.9669, 'grad_norm': 4.0718584060668945, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.10it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.08it/s]                                               {'loss': 2.0287, 'grad_norm': 3.746054172515869, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.08it/s] 88%|████████▊ | 35/40 [00:36<00:04,  1.13it/s]                                               {'loss': 1.8055, 'grad_norm': 4.468812942504883, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:04,  1.13it/s] 90%|█████████ | 36/40 [00:36<00:03,  1.17it/s]                                               {'loss': 1.8539, 'grad_norm': 4.707569599151611, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:03,  1.17it/s] 92%|█████████▎| 37/40 [00:37<00:02,  1.19it/s]                                               {'loss': 2.1114, 'grad_norm': 4.6533308029174805, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:02,  1.19it/s] 95%|█████████▌| 38/40 [00:38<00:01,  1.22it/s]                                               {'loss': 1.9774, 'grad_norm': 4.537171363830566, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:01,  1.22it/s] 98%|█████████▊| 39/40 [00:39<00:00,  1.16it/s]                                               {'loss': 1.846, 'grad_norm': 3.6130330562591553, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:00,  1.16it/s]100%|██████████| 40/40 [00:39<00:00,  1.54it/s]                                               {'loss': 1.3658, 'grad_norm': 19.015676498413086, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.54it/s]                                               {'train_runtime': 39.689, 'train_samples_per_second': 14.236, 'train_steps_per_second': 1.008, 'train_loss': 2.1320584952831267, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.54it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 2.3288, 'grad_norm': 4.700577259063721, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 2.3259, 'grad_norm': 4.912500381469727, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:42,  1.14s/it]                                              {'loss': 2.387, 'grad_norm': 5.446018218994141, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.14s/it] 10%|█         | 4/40 [00:04<00:38,  1.08s/it]                                              {'loss': 2.6908, 'grad_norm': 5.310577392578125, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:38,  1.08s/it] 12%|█▎        | 5/40 [00:05<00:36,  1.03s/it]                                              {'loss': 2.2517, 'grad_norm': 4.493042469024658, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:36,  1.03s/it] 15%|█▌        | 6/40 [00:06<00:33,  1.01it/s]                                              {'loss': 2.4647, 'grad_norm': 4.375130653381348, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:33,  1.01it/s] 18%|█▊        | 7/40 [00:07<00:32,  1.01it/s]                                              {'loss': 2.1903, 'grad_norm': 5.396788597106934, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:32,  1.01it/s] 20%|██        | 8/40 [00:07<00:22,  1.39it/s]                                              {'loss': 2.8832, 'grad_norm': 11.417882919311523, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:22,  1.39it/s] 22%|██▎       | 9/40 [00:08<00:25,  1.20it/s]                                              {'loss': 2.2737, 'grad_norm': 4.2230095863342285, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:25,  1.20it/s] 25%|██▌       | 10/40 [00:09<00:26,  1.12it/s]                                               {'loss': 2.1229, 'grad_norm': 4.258281230926514, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:26,  1.12it/s] 28%|██▊       | 11/40 [00:10<00:28,  1.03it/s]                                               {'loss': 2.0054, 'grad_norm': 3.135547637939453, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:28,  1.03it/s] 30%|███       | 12/40 [00:11<00:28,  1.02s/it]                                               {'loss': 2.0298, 'grad_norm': 3.517350435256958, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:28,  1.02s/it] 32%|███▎      | 13/40 [00:12<00:26,  1.02it/s]                                               {'loss': 2.1176, 'grad_norm': 3.440551280975342, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:12<00:26,  1.02it/s] 35%|███▌      | 14/40 [00:13<00:25,  1.03it/s]                                               {'loss': 2.0567, 'grad_norm': 4.449472904205322, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:25,  1.03it/s] 38%|███▊      | 15/40 [00:14<00:23,  1.06it/s]                                               {'loss': 2.1546, 'grad_norm': 4.449290752410889, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:23,  1.06it/s] 40%|████      | 16/40 [00:14<00:16,  1.43it/s]                                               {'loss': 2.4442, 'grad_norm': 14.400290489196777, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:14<00:16,  1.43it/s] 42%|████▎     | 17/40 [00:15<00:19,  1.20it/s]                                               {'loss': 2.224, 'grad_norm': 3.842726230621338, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:15<00:19,  1.20it/s] 45%|████▌     | 18/40 [00:16<00:19,  1.11it/s]                                               {'loss': 1.5037, 'grad_norm': 4.27455472946167, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:16<00:19,  1.11it/s] 48%|████▊     | 19/40 [00:17<00:20,  1.03it/s]                                               {'loss': 2.111, 'grad_norm': 4.3752875328063965, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:17<00:20,  1.03it/s] 50%|█████     | 20/40 [00:19<00:20,  1.02s/it]                                               {'loss': 1.9469, 'grad_norm': 4.524300575256348, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:20,  1.02s/it] 52%|█████▎    | 21/40 [00:20<00:20,  1.05s/it]                                               {'loss': 1.8003, 'grad_norm': 3.2872326374053955, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:20,  1.05s/it] 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it]                                               {'loss': 2.1896, 'grad_norm': 4.434501647949219, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it] 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it]                                               {'loss': 2.1018, 'grad_norm': 4.409712791442871, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it] 60%|██████    | 24/40 [00:22<00:13,  1.22it/s]                                               {'loss': 1.9395, 'grad_norm': 14.38084602355957, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:13,  1.22it/s] 62%|██████▎   | 25/40 [00:23<00:13,  1.15it/s]                                               {'loss': 1.6953, 'grad_norm': 3.4303088188171387, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:23<00:13,  1.15it/s] 65%|██████▌   | 26/40 [00:24<00:12,  1.13it/s]                                               {'loss': 2.2531, 'grad_norm': 4.206022262573242, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:24<00:12,  1.13it/s] 68%|██████▊   | 27/40 [00:25<00:12,  1.07it/s]                                               {'loss': 2.0113, 'grad_norm': 3.8595919609069824, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:25<00:12,  1.07it/s] 70%|███████   | 28/40 [00:26<00:11,  1.05it/s]                                               {'loss': 1.9486, 'grad_norm': 3.732818126678467, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:26<00:11,  1.05it/s] 72%|███████▎  | 29/40 [00:27<00:11,  1.02s/it]                                               {'loss': 1.6559, 'grad_norm': 3.478646993637085, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:27<00:11,  1.02s/it] 75%|███████▌  | 30/40 [00:28<00:10,  1.04s/it]                                               {'loss': 2.0027, 'grad_norm': 4.784115791320801, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:28<00:10,  1.04s/it] 78%|███████▊  | 31/40 [00:30<00:09,  1.08s/it]                                               {'loss': 1.802, 'grad_norm': 3.7089853286743164, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.08s/it] 80%|████████  | 32/40 [00:30<00:06,  1.24it/s]                                               {'loss': 1.8393, 'grad_norm': 14.393335342407227, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:30<00:06,  1.24it/s] 82%|████████▎ | 33/40 [00:31<00:05,  1.17it/s]                                               {'loss': 1.8413, 'grad_norm': 3.7644753456115723, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:31<00:05,  1.17it/s] 85%|████████▌ | 34/40 [00:32<00:05,  1.14it/s]                                               {'loss': 1.4684, 'grad_norm': 4.372476100921631, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:32<00:05,  1.14it/s] 88%|████████▊ | 35/40 [00:33<00:04,  1.09it/s]                                               {'loss': 2.0295, 'grad_norm': 4.643373012542725, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:33<00:04,  1.09it/s] 90%|█████████ | 36/40 [00:34<00:03,  1.02it/s]                                               {'loss': 2.1485, 'grad_norm': 3.713404893875122, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:34<00:03,  1.02it/s] 92%|█████████▎| 37/40 [00:35<00:03,  1.01s/it]                                               {'loss': 1.8525, 'grad_norm': 4.371414661407471, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:35<00:03,  1.01s/it] 95%|█████████▌| 38/40 [00:36<00:02,  1.04s/it]                                               {'loss': 1.8635, 'grad_norm': 3.67413067817688, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:36<00:02,  1.04s/it] 98%|█████████▊| 39/40 [00:37<00:01,  1.06s/it]                                               {'loss': 1.9751, 'grad_norm': 4.106991767883301, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:37<00:01,  1.06s/it]100%|██████████| 40/40 [00:37<00:00,  1.23it/s]                                               {'loss': 1.4917, 'grad_norm': 11.789443969726562, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.23it/s]                                               {'train_runtime': 37.9411, 'train_samples_per_second': 14.892, 'train_steps_per_second': 1.054, 'train_loss': 2.0605750769376754, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.23it/s]100%|██████████| 40/40 [00:37<00:00,  1.05it/s]
CLIENT:46
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:49,  1.26s/it]                                              {'loss': 2.2324, 'grad_norm': 4.741044998168945, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:49,  1.26s/it]  5%|▌         | 2/40 [00:02<00:44,  1.17s/it]                                              {'loss': 2.2847, 'grad_norm': 4.080103397369385, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:44,  1.17s/it]  8%|▊         | 3/40 [00:03<00:42,  1.16s/it]                                              {'loss': 2.5814, 'grad_norm': 4.511316299438477, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.16s/it] 10%|█         | 4/40 [00:04<00:41,  1.15s/it]                                              {'loss': 2.2654, 'grad_norm': 3.649049758911133, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.15s/it] 12%|█▎        | 5/40 [00:05<00:37,  1.07s/it]                                              {'loss': 2.2704, 'grad_norm': 3.495640277862549, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:37,  1.07s/it] 15%|█▌        | 6/40 [00:06<00:35,  1.03s/it]                                              {'loss': 2.3539, 'grad_norm': 3.980029582977295, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:35,  1.03s/it] 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it]                                              {'loss': 2.5255, 'grad_norm': 4.002949237823486, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it] 20%|██        | 8/40 [00:07<00:24,  1.33it/s]                                              {'loss': 3.8487, 'grad_norm': 13.944684982299805, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:24,  1.33it/s] 22%|██▎       | 9/40 [00:08<00:26,  1.15it/s]                                              {'loss': 2.188, 'grad_norm': 3.9357504844665527, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:26,  1.15it/s] 25%|██▌       | 10/40 [00:09<00:28,  1.06it/s]                                               {'loss': 2.3189, 'grad_norm': 7.420928478240967, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:28,  1.06it/s] 28%|██▊       | 11/40 [00:11<00:28,  1.01it/s]                                               {'loss': 2.1072, 'grad_norm': 3.5245606899261475, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:28,  1.01it/s] 30%|███       | 12/40 [00:12<00:29,  1.04s/it]                                               {'loss': 2.1248, 'grad_norm': 3.773843765258789, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.04s/it] 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it]                                               {'loss': 2.1076, 'grad_norm': 3.1950325965881348, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it]                                               {'loss': 2.0978, 'grad_norm': 4.056347846984863, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it]                                               {'loss': 2.1971, 'grad_norm': 3.3582396507263184, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it] 40%|████      | 16/40 [00:15<00:20,  1.20it/s]                                               {'loss': 2.4107, 'grad_norm': 12.683302879333496, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:20,  1.20it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.09it/s]                                               {'loss': 1.8572, 'grad_norm': 3.8177924156188965, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s]                                               {'loss': 2.0078, 'grad_norm': 3.785289764404297, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.02s/it]                                               {'loss': 2.0982, 'grad_norm': 3.3335652351379395, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.02s/it] 50%|█████     | 20/40 [00:20<00:20,  1.04s/it]                                               {'loss': 2.0137, 'grad_norm': 8.486715316772461, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.04s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 1.9676, 'grad_norm': 4.644193649291992, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it]                                               {'loss': 1.8815, 'grad_norm': 3.355238199234009, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it]                                               {'loss': 2.1336, 'grad_norm': 4.855579853057861, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it] 60%|██████    | 24/40 [00:23<00:12,  1.25it/s]                                               {'loss': 1.0996, 'grad_norm': 16.95779800415039, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.25it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.19it/s]                                               {'loss': 1.7908, 'grad_norm': 4.511847496032715, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.19it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.16it/s]                                               {'loss': 1.7186, 'grad_norm': 3.438526153564453, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.16it/s] 68%|██████▊   | 27/40 [00:26<00:11,  1.12it/s]                                               {'loss': 2.2003, 'grad_norm': 4.28123664855957, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:11,  1.12it/s] 70%|███████   | 28/40 [00:27<00:11,  1.04it/s]                                               {'loss': 1.8548, 'grad_norm': 11.417354583740234, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.04it/s] 72%|███████▎  | 29/40 [00:28<00:11,  1.02s/it]                                               {'loss': 2.0766, 'grad_norm': 3.5884006023406982, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.02s/it] 75%|███████▌  | 30/40 [00:29<00:10,  1.05s/it]                                               {'loss': 1.8843, 'grad_norm': 3.4989287853240967, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:10,  1.05s/it] 78%|███████▊  | 31/40 [00:30<00:09,  1.06s/it]                                               {'loss': 2.0257, 'grad_norm': 3.8834550380706787, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.06s/it] 80%|████████  | 32/40 [00:31<00:06,  1.23it/s]                                               {'loss': 1.5316, 'grad_norm': 20.42693519592285, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.23it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.12it/s]                                               {'loss': 1.991, 'grad_norm': 4.130324840545654, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.12it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.04it/s]                                               {'loss': 1.5547, 'grad_norm': 2.966595411300659, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.00s/it]                                               {'loss': 1.8305, 'grad_norm': 4.368381977081299, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.00s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it]                                               {'loss': 1.735, 'grad_norm': 3.430229663848877, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.06s/it]                                               {'loss': 2.0393, 'grad_norm': 3.892793655395508, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.06s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.08s/it]                                               {'loss': 1.7404, 'grad_norm': 3.6603028774261475, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]                                               {'loss': 2.0494, 'grad_norm': 4.185859203338623, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'loss': 2.6456, 'grad_norm': 29.54633140563965, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'train_runtime': 39.3768, 'train_samples_per_second': 14.349, 'train_steps_per_second': 1.016, 'train_loss': 2.0910584926605225, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.03s/it]                                              {'loss': 2.2755, 'grad_norm': 3.7427608966827393, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:40,  1.03s/it]  5%|▌         | 2/40 [00:02<00:49,  1.30s/it]                                              {'loss': 2.4177, 'grad_norm': 3.6977717876434326, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:49,  1.30s/it]  8%|▊         | 3/40 [00:03<00:44,  1.21s/it]                                              {'loss': 2.1362, 'grad_norm': 4.123309135437012, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:44,  1.21s/it] 10%|█         | 4/40 [00:04<00:42,  1.18s/it]                                              {'loss': 2.1938, 'grad_norm': 4.316079139709473, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:42,  1.18s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.16s/it]                                              {'loss': 2.215, 'grad_norm': 4.199274063110352, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.16s/it] 15%|█▌        | 6/40 [00:07<00:39,  1.15s/it]                                              {'loss': 2.2856, 'grad_norm': 4.879295825958252, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:39,  1.15s/it] 18%|█▊        | 7/40 [00:08<00:37,  1.13s/it]                                              {'loss': 2.2689, 'grad_norm': 5.942587375640869, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:27,  1.18it/s]                                              {'loss': 2.8814, 'grad_norm': 12.03783893585205, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:27,  1.18it/s] 22%|██▎       | 9/40 [00:09<00:28,  1.08it/s]                                              {'loss': 2.0926, 'grad_norm': 4.254351615905762, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:28,  1.08it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s]                                               {'loss': 2.2554, 'grad_norm': 4.56393575668335, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it]                                               {'loss': 2.3116, 'grad_norm': 5.523523330688477, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it] 30%|███       | 12/40 [00:12<00:29,  1.06s/it]                                               {'loss': 2.0794, 'grad_norm': 5.256691932678223, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 1.9724, 'grad_norm': 4.271169662475586, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it]                                               {'loss': 2.1452, 'grad_norm': 3.981335401535034, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it]                                               {'loss': 1.8314, 'grad_norm': 3.6163594722747803, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it] 40%|████      | 16/40 [00:16<00:22,  1.08it/s]                                               {'loss': 1.6153, 'grad_norm': 15.658583641052246, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:22,  1.08it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s]                                               {'loss': 2.1618, 'grad_norm': 4.699885845184326, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:18<00:20,  1.07it/s]                                               {'loss': 1.9711, 'grad_norm': 4.781322479248047, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:20,  1.07it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.03it/s]                                               {'loss': 1.9636, 'grad_norm': 5.003616809844971, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.03it/s] 50%|█████     | 20/40 [00:20<00:20,  1.02s/it]                                               {'loss': 1.9318, 'grad_norm': 4.217825412750244, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.02s/it] 52%|█████▎    | 21/40 [00:21<00:19,  1.05s/it]                                               {'loss': 1.8157, 'grad_norm': 4.064196586608887, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.05s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.06s/it]                                               {'loss': 1.9838, 'grad_norm': 4.066359996795654, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.06s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.07s/it]                                               {'loss': 2.057, 'grad_norm': 10.851390838623047, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.07s/it] 60%|██████    | 24/40 [00:24<00:13,  1.23it/s]                                               {'loss': 2.1521, 'grad_norm': 24.643213272094727, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.23it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.11it/s]                                               {'loss': 1.8249, 'grad_norm': 5.981251239776611, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.11it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s]                                               {'loss': 1.9748, 'grad_norm': 4.406144142150879, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it]                                               {'loss': 1.8768, 'grad_norm': 4.103029727935791, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it] 70%|███████   | 28/40 [00:28<00:12,  1.06s/it]                                               {'loss': 1.8684, 'grad_norm': 5.301227569580078, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it]                                               {'loss': 1.7586, 'grad_norm': 4.169067859649658, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it]                                               {'loss': 1.804, 'grad_norm': 3.747576951980591, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it]                                               {'loss': 1.9411, 'grad_norm': 5.077895641326904, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it] 80%|████████  | 32/40 [00:32<00:06,  1.20it/s]                                               {'loss': 2.6087, 'grad_norm': 17.664087295532227, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.10it/s]                                               {'loss': 1.9231, 'grad_norm': 3.974275827407837, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.10it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.01it/s]                                               {'loss': 1.7574, 'grad_norm': 4.136073589324951, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.02s/it]                                               {'loss': 1.481, 'grad_norm': 5.528709888458252, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.00s/it]                                               {'loss': 1.9026, 'grad_norm': 5.504871368408203, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.00s/it] 92%|█████████▎| 37/40 [00:37<00:02,  1.02it/s]                                               {'loss': 1.7984, 'grad_norm': 4.226530075073242, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:02,  1.02it/s] 95%|█████████▌| 38/40 [00:38<00:02,  1.02s/it]                                               {'loss': 1.8349, 'grad_norm': 4.332897186279297, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.02s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.04s/it]                                               {'loss': 1.9162, 'grad_norm': 4.573122024536133, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.04s/it]100%|██████████| 40/40 [00:40<00:00,  1.25it/s]                                               {'loss': 2.3799, 'grad_norm': 15.778559684753418, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.25it/s]                                               {'train_runtime': 40.1929, 'train_samples_per_second': 14.057, 'train_steps_per_second': 0.995, 'train_loss': 2.0416294008493425, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.25it/s]100%|██████████| 40/40 [00:40<00:00,  1.00s/it]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:36,  1.07it/s]                                              {'loss': 2.3571, 'grad_norm': 4.28826379776001, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:36,  1.07it/s]  5%|▌         | 2/40 [00:01<00:37,  1.02it/s]                                              {'loss': 2.153, 'grad_norm': 3.8888235092163086, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:37,  1.02it/s]  8%|▊         | 3/40 [00:02<00:37,  1.01s/it]                                              {'loss': 2.6441, 'grad_norm': 5.277981758117676, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:37,  1.01s/it] 10%|█         | 4/40 [00:04<00:37,  1.05s/it]                                              {'loss': 2.3156, 'grad_norm': 5.101174831390381, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:37,  1.05s/it] 12%|█▎        | 5/40 [00:05<00:37,  1.07s/it]                                              {'loss': 2.3747, 'grad_norm': 4.1350250244140625, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:37,  1.07s/it] 15%|█▌        | 6/40 [00:06<00:34,  1.03s/it]                                              {'loss': 2.3326, 'grad_norm': 4.746816158294678, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:34,  1.03s/it] 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it]                                              {'loss': 2.538, 'grad_norm': 4.180759906768799, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it] 20%|██        | 8/40 [00:07<00:23,  1.36it/s]                                              {'loss': 3.1259, 'grad_norm': 30.036039352416992, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:23,  1.36it/s] 22%|██▎       | 9/40 [00:08<00:26,  1.19it/s]                                              {'loss': 2.3416, 'grad_norm': 5.431273460388184, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:26,  1.19it/s] 25%|██▌       | 10/40 [00:09<00:26,  1.11it/s]                                               {'loss': 2.3677, 'grad_norm': 4.123071193695068, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:26,  1.11it/s] 28%|██▊       | 11/40 [00:10<00:28,  1.02it/s]                                               {'loss': 2.2919, 'grad_norm': 5.928281307220459, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:28,  1.02it/s] 30%|███       | 12/40 [00:11<00:27,  1.01it/s]                                               {'loss': 2.1646, 'grad_norm': 4.960773944854736, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:27,  1.01it/s] 32%|███▎      | 13/40 [00:12<00:28,  1.04s/it]                                               {'loss': 2.1933, 'grad_norm': 4.190272808074951, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:12<00:28,  1.04s/it] 35%|███▌      | 14/40 [00:13<00:26,  1.03s/it]                                               {'loss': 2.1339, 'grad_norm': 4.454742431640625, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:26,  1.03s/it] 38%|███▊      | 15/40 [00:14<00:24,  1.01it/s]                                               {'loss': 2.0528, 'grad_norm': 4.161215305328369, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:24,  1.01it/s] 40%|████      | 16/40 [00:14<00:18,  1.33it/s]                                               {'loss': 2.2389, 'grad_norm': 12.228525161743164, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:14<00:18,  1.33it/s] 42%|████▎     | 17/40 [00:15<00:18,  1.25it/s]                                               {'loss': 2.2821, 'grad_norm': 4.850678443908691, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:15<00:18,  1.25it/s] 45%|████▌     | 18/40 [00:16<00:19,  1.13it/s]                                               {'loss': 2.0911, 'grad_norm': 4.137495517730713, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:16<00:19,  1.13it/s] 48%|████▊     | 19/40 [00:17<00:19,  1.06it/s]                                               {'loss': 2.0813, 'grad_norm': 4.02774715423584, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:17<00:19,  1.06it/s] 50%|█████     | 20/40 [00:19<00:20,  1.01s/it]                                               {'loss': 2.0849, 'grad_norm': 3.993837833404541, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:20,  1.01s/it] 52%|█████▎    | 21/40 [00:20<00:19,  1.04s/it]                                               {'loss': 2.0332, 'grad_norm': 3.8992929458618164, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:19,  1.04s/it] 55%|█████▌    | 22/40 [00:21<00:18,  1.04s/it]                                               {'loss': 2.0143, 'grad_norm': 3.510039806365967, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:18,  1.04s/it] 57%|█████▊    | 23/40 [00:22<00:18,  1.07s/it]                                               {'loss': 2.0433, 'grad_norm': 4.483199596405029, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:18,  1.07s/it] 60%|██████    | 24/40 [00:22<00:12,  1.24it/s]                                               {'loss': 1.6703, 'grad_norm': 14.140886306762695, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:12,  1.24it/s] 62%|██████▎   | 25/40 [00:23<00:13,  1.10it/s]                                               {'loss': 1.8775, 'grad_norm': 3.7039432525634766, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:23<00:13,  1.10it/s] 65%|██████▌   | 26/40 [00:24<00:13,  1.07it/s]                                               {'loss': 2.1332, 'grad_norm': 4.153806686401367, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:24<00:13,  1.07it/s] 68%|██████▊   | 27/40 [00:25<00:11,  1.08it/s]                                               {'loss': 2.0327, 'grad_norm': 5.014823913574219, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:25<00:11,  1.08it/s] 70%|███████   | 28/40 [00:26<00:11,  1.07it/s]                                               {'loss': 1.9494, 'grad_norm': 3.9332504272460938, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:26<00:11,  1.07it/s] 72%|███████▎  | 29/40 [00:27<00:10,  1.02it/s]                                               {'loss': 1.9101, 'grad_norm': 4.235040187835693, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:27<00:10,  1.02it/s] 75%|███████▌  | 30/40 [00:28<00:10,  1.03s/it]                                               {'loss': 2.0761, 'grad_norm': 4.32330846786499, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:28<00:10,  1.03s/it] 78%|███████▊  | 31/40 [00:29<00:09,  1.05s/it]                                               {'loss': 2.0217, 'grad_norm': 3.8873469829559326, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:29<00:09,  1.05s/it] 80%|████████  | 32/40 [00:30<00:06,  1.25it/s]                                               {'loss': 1.1573, 'grad_norm': 8.57546329498291, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:30<00:06,  1.25it/s] 82%|████████▎ | 33/40 [00:31<00:06,  1.12it/s]                                               {'loss': 1.8596, 'grad_norm': 3.885204315185547, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:31<00:06,  1.12it/s] 85%|████████▌ | 34/40 [00:32<00:05,  1.04it/s]                                               {'loss': 1.8862, 'grad_norm': 4.66400671005249, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:32<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:33<00:04,  1.07it/s]                                               {'loss': 1.7967, 'grad_norm': 3.5148706436157227, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:33<00:04,  1.07it/s] 90%|█████████ | 36/40 [00:34<00:03,  1.05it/s]                                               {'loss': 1.8423, 'grad_norm': 4.443666458129883, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:34<00:03,  1.05it/s] 92%|█████████▎| 37/40 [00:35<00:02,  1.01it/s]                                               {'loss': 1.9972, 'grad_norm': 3.6927695274353027, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:35<00:02,  1.01it/s] 95%|█████████▌| 38/40 [00:36<00:02,  1.03s/it]                                               {'loss': 1.9133, 'grad_norm': 4.477104663848877, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:36<00:02,  1.03s/it] 98%|█████████▊| 39/40 [00:37<00:01,  1.07s/it]                                               {'loss': 1.8618, 'grad_norm': 3.451094150543213, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:37<00:01,  1.07s/it]100%|██████████| 40/40 [00:37<00:00,  1.23it/s]                                               {'loss': 2.0373, 'grad_norm': 15.498640060424805, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.23it/s]                                               {'train_runtime': 37.8758, 'train_samples_per_second': 14.917, 'train_steps_per_second': 1.056, 'train_loss': 2.10696023106575, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.23it/s]100%|██████████| 40/40 [00:37<00:00,  1.06it/s]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:35,  1.09it/s]                                              {'loss': 2.5841, 'grad_norm': 4.62709903717041, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:35,  1.09it/s]  5%|▌         | 2/40 [00:01<00:34,  1.11it/s]                                              {'loss': 2.2804, 'grad_norm': 4.001241683959961, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:34,  1.11it/s]  8%|▊         | 3/40 [00:02<00:36,  1.00it/s]                                              {'loss': 2.5202, 'grad_norm': 3.9893953800201416, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:36,  1.00it/s] 10%|█         | 4/40 [00:04<00:37,  1.05s/it]                                              {'loss': 2.6094, 'grad_norm': 5.037464618682861, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:37,  1.05s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.09s/it]                                              {'loss': 2.4004, 'grad_norm': 5.4488630294799805, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.09s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 2.4721, 'grad_norm': 4.814875602722168, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.12s/it]                                              {'loss': 2.5325, 'grad_norm': 5.10260534286499, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.12s/it] 20%|██        | 8/40 [00:08<00:31,  1.00it/s]                                              {'loss': 1.5693, 'grad_norm': 16.080276489257812, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:31,  1.00it/s] 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it]                                              {'loss': 2.1271, 'grad_norm': 4.515295028686523, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it] 25%|██▌       | 10/40 [00:10<00:31,  1.06s/it]                                               {'loss': 2.1164, 'grad_norm': 3.9129228591918945, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:31,  1.06s/it] 28%|██▊       | 11/40 [00:11<00:31,  1.08s/it]                                               {'loss': 2.2941, 'grad_norm': 5.12044620513916, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:31,  1.08s/it] 30%|███       | 12/40 [00:12<00:30,  1.07s/it]                                               {'loss': 2.355, 'grad_norm': 4.440674304962158, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:30,  1.07s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.10s/it]                                               {'loss': 2.2478, 'grad_norm': 4.535903453826904, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.10s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.10s/it]                                               {'loss': 2.1051, 'grad_norm': 4.632388114929199, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it]                                               {'loss': 2.1058, 'grad_norm': 4.596975803375244, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it] 40%|████      | 16/40 [00:16<00:22,  1.06it/s]                                               {'loss': 3.0849, 'grad_norm': 36.02369689941406, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:22,  1.06it/s] 42%|████▎     | 17/40 [00:17<00:23,  1.01s/it]                                               {'loss': 2.2223, 'grad_norm': 4.506132125854492, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:23,  1.01s/it] 45%|████▌     | 18/40 [00:18<00:23,  1.05s/it]                                               {'loss': 2.0797, 'grad_norm': 4.758963584899902, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:23,  1.05s/it] 48%|████▊     | 19/40 [00:20<00:22,  1.08s/it]                                               {'loss': 2.1888, 'grad_norm': 4.188485622406006, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:22,  1.08s/it] 50%|█████     | 20/40 [00:21<00:21,  1.09s/it]                                               {'loss': 2.1181, 'grad_norm': 9.796490669250488, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.09s/it] 52%|█████▎    | 21/40 [00:22<00:21,  1.11s/it]                                               {'loss': 2.0672, 'grad_norm': 4.7336907386779785, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:21,  1.11s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.11s/it]                                               {'loss': 2.019, 'grad_norm': 4.241018772125244, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.11s/it] 57%|█████▊    | 23/40 [00:24<00:19,  1.12s/it]                                               {'loss': 1.9409, 'grad_norm': 5.987591743469238, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:19,  1.12s/it] 60%|██████    | 24/40 [00:24<00:13,  1.20it/s]                                               {'loss': 1.6374, 'grad_norm': 12.35315990447998, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:25<00:14,  1.07it/s]                                               {'loss': 2.0026, 'grad_norm': 3.482400417327881, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:14,  1.07it/s] 65%|██████▌   | 26/40 [00:27<00:13,  1.01it/s]                                               {'loss': 2.1135, 'grad_norm': 3.2095136642456055, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:28<00:13,  1.04s/it]                                               {'loss': 1.8854, 'grad_norm': 3.816133499145508, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.04s/it] 70%|███████   | 28/40 [00:29<00:12,  1.06s/it]                                               {'loss': 1.9115, 'grad_norm': 4.283241271972656, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 2.1935, 'grad_norm': 5.367103576660156, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it]                                               {'loss': 1.9859, 'grad_norm': 4.4260406494140625, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it]                                               {'loss': 1.935, 'grad_norm': 4.370016574859619, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.09s/it] 80%|████████  | 32/40 [00:32<00:06,  1.21it/s]                                               {'loss': 2.6961, 'grad_norm': 13.175171852111816, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.21it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s]                                               {'loss': 2.1887, 'grad_norm': 4.85042667388916, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s]                                               {'loss': 1.8637, 'grad_norm': 12.042279243469238, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it]                                               {'loss': 2.08, 'grad_norm': 4.77067756652832, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.06s/it]                                               {'loss': 1.7405, 'grad_norm': 3.6052889823913574, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.06s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.08s/it]                                               {'loss': 2.152, 'grad_norm': 3.7810158729553223, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.10s/it]                                               {'loss': 1.8465, 'grad_norm': 4.267630100250244, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.10s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.09s/it]                                               {'loss': 1.7964, 'grad_norm': 4.535107612609863, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.09s/it]100%|██████████| 40/40 [00:40<00:00,  1.19it/s]                                               {'loss': 1.619, 'grad_norm': 13.489442825317383, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.19it/s]                                               {'train_runtime': 41.1047, 'train_samples_per_second': 13.745, 'train_steps_per_second': 0.973, 'train_loss': 2.1422121465206145, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.19it/s]100%|██████████| 40/40 [00:41<00:00,  1.03s/it]
CLIENT:23
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 2.1892, 'grad_norm': 3.35860276222229, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]                                              {'loss': 2.3456, 'grad_norm': 3.2576353549957275, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]  8%|▊         | 3/40 [00:03<00:41,  1.13s/it]                                              {'loss': 2.3977, 'grad_norm': 4.6737895011901855, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.13s/it] 10%|█         | 4/40 [00:04<00:41,  1.14s/it]                                              {'loss': 2.5519, 'grad_norm': 4.281508922576904, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.14s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.4129, 'grad_norm': 4.102733612060547, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it]                                              {'loss': 2.5126, 'grad_norm': 4.63515567779541, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.2673, 'grad_norm': 5.366580963134766, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:34,  1.07s/it]                                              {'loss': 2.429, 'grad_norm': 17.146669387817383, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:34,  1.07s/it] 22%|██▎       | 9/40 [00:09<00:33,  1.08s/it]                                              {'loss': 2.178, 'grad_norm': 5.111245632171631, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:33,  1.08s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.10s/it]                                               {'loss': 2.1697, 'grad_norm': 3.587183952331543, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.10s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.10s/it]                                               {'loss': 2.2352, 'grad_norm': 3.8238110542297363, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.10s/it] 30%|███       | 12/40 [00:13<00:30,  1.10s/it]                                               {'loss': 2.077, 'grad_norm': 4.179671287536621, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:30,  1.10s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it]                                               {'loss': 2.1688, 'grad_norm': 4.100564002990723, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it]                                               {'loss': 2.0219, 'grad_norm': 3.9220590591430664, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.12s/it]                                               {'loss': 2.1576, 'grad_norm': 3.9997718334198, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.12s/it] 40%|████      | 16/40 [00:16<00:20,  1.19it/s]                                               {'loss': 1.7293, 'grad_norm': 13.153093338012695, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:18<00:21,  1.07it/s]                                               {'loss': 1.9915, 'grad_norm': 3.8878815174102783, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:21,  1.07it/s] 45%|████▌     | 18/40 [00:19<00:21,  1.01it/s]                                               {'loss': 2.1692, 'grad_norm': 3.9041635990142822, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:21,  1.01it/s] 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it]                                               {'loss': 2.163, 'grad_norm': 3.6952896118164062, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it] 50%|█████     | 20/40 [00:21<00:21,  1.05s/it]                                               {'loss': 1.7875, 'grad_norm': 3.7867658138275146, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.05s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it]                                               {'loss': 1.8948, 'grad_norm': 3.7917892932891846, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it]                                               {'loss': 1.902, 'grad_norm': 3.834674119949341, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it]                                               {'loss': 2.026, 'grad_norm': 19.11258316040039, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it] 60%|██████    | 24/40 [00:25<00:13,  1.21it/s]                                               {'loss': 2.2335, 'grad_norm': 19.064638137817383, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:26<00:13,  1.09it/s]                                               {'loss': 2.0393, 'grad_norm': 3.885026454925537, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:27<00:13,  1.02it/s]                                               {'loss': 1.7403, 'grad_norm': 3.2131543159484863, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it]                                               {'loss': 2.0, 'grad_norm': 4.142606258392334, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it] 70%|███████   | 28/40 [00:29<00:12,  1.06s/it]                                               {'loss': 1.7062, 'grad_norm': 3.7270827293395996, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.09s/it]                                               {'loss': 1.6131, 'grad_norm': 3.91005277633667, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.09s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.10s/it]                                               {'loss': 1.7904, 'grad_norm': 4.231247901916504, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.10s/it] 78%|███████▊  | 31/40 [00:32<00:10,  1.12s/it]                                               {'loss': 2.3104, 'grad_norm': 4.278550624847412, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:10,  1.12s/it] 80%|████████  | 32/40 [00:33<00:06,  1.19it/s]                                               {'loss': 3.1764, 'grad_norm': 15.41856861114502, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:33<00:06,  1.19it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.07it/s]                                               {'loss': 1.841, 'grad_norm': 3.3611669540405273, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.07it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s]                                               {'loss': 1.9497, 'grad_norm': 3.9716689586639404, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.04s/it]                                               {'loss': 1.8356, 'grad_norm': 3.2036566734313965, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.04s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.06s/it]                                               {'loss': 1.7622, 'grad_norm': 3.8099725246429443, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.06s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it]                                               {'loss': 1.7089, 'grad_norm': 4.112627029418945, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.08s/it]                                               {'loss': 1.7282, 'grad_norm': 5.650323867797852, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:41<00:01,  1.11s/it]                                               {'loss': 1.9065, 'grad_norm': 5.380375862121582, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:41<00:01,  1.11s/it]100%|██████████| 40/40 [00:41<00:00,  1.20it/s]                                               {'loss': 1.6751, 'grad_norm': 16.10361671447754, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.20it/s]                                               {'train_runtime': 41.4147, 'train_samples_per_second': 13.642, 'train_steps_per_second': 0.966, 'train_loss': 2.069855636358261, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.20it/s]100%|██████████| 40/40 [00:41<00:00,  1.04s/it]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:14,  1.91s/it]                                              {'loss': 2.1022, 'grad_norm': 3.751777410507202, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:14,  1.91s/it]  5%|▌         | 2/40 [00:03<00:55,  1.47s/it]                                              {'loss': 2.5327, 'grad_norm': 4.692748069763184, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:03<00:55,  1.47s/it]  8%|▊         | 3/40 [00:04<00:48,  1.30s/it]                                              {'loss': 2.6294, 'grad_norm': 5.417602062225342, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:04<00:48,  1.30s/it] 10%|█         | 4/40 [00:05<00:45,  1.25s/it]                                              {'loss': 2.3874, 'grad_norm': 5.217761993408203, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:05<00:45,  1.25s/it] 12%|█▎        | 5/40 [00:06<00:41,  1.19s/it]                                              {'loss': 2.2957, 'grad_norm': 5.483911037445068, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:06<00:41,  1.19s/it] 15%|█▌        | 6/40 [00:07<00:39,  1.17s/it]                                              {'loss': 2.3739, 'grad_norm': 4.021064281463623, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:39,  1.17s/it] 18%|█▊        | 7/40 [00:08<00:36,  1.09s/it]                                              {'loss': 2.1821, 'grad_norm': 4.160939693450928, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:36,  1.09s/it] 20%|██        | 8/40 [00:08<00:25,  1.26it/s]                                              {'loss': 1.8514, 'grad_norm': 9.508943557739258, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:25,  1.26it/s] 22%|██▎       | 9/40 [00:09<00:25,  1.21it/s]                                              {'loss': 2.0365, 'grad_norm': 4.110937595367432, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:25,  1.21it/s] 25%|██▌       | 10/40 [00:10<00:24,  1.22it/s]                                               {'loss': 2.1496, 'grad_norm': 3.5118634700775146, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:24,  1.22it/s] 28%|██▊       | 11/40 [00:11<00:24,  1.20it/s]                                               {'loss': 2.1268, 'grad_norm': 4.207458972930908, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:24,  1.20it/s] 30%|███       | 12/40 [00:12<00:23,  1.20it/s]                                               {'loss': 2.1507, 'grad_norm': 3.6495697498321533, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:23,  1.20it/s] 32%|███▎      | 13/40 [00:12<00:22,  1.19it/s]                                               {'loss': 2.2502, 'grad_norm': 3.6768414974212646, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:12<00:22,  1.19it/s] 35%|███▌      | 14/40 [00:13<00:23,  1.13it/s]                                               {'loss': 2.2091, 'grad_norm': 3.867701530456543, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:23,  1.13it/s] 38%|███▊      | 15/40 [00:14<00:23,  1.06it/s]                                               {'loss': 2.2048, 'grad_norm': 9.614063262939453, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:23,  1.06it/s] 40%|████      | 16/40 [00:15<00:17,  1.37it/s]                                               {'loss': 2.4685, 'grad_norm': 53.97664260864258, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:17,  1.37it/s] 42%|████▎     | 17/40 [00:16<00:19,  1.19it/s]                                               {'loss': 2.2485, 'grad_norm': 3.080033540725708, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:19,  1.19it/s] 45%|████▌     | 18/40 [00:17<00:20,  1.07it/s]                                               {'loss': 2.0011, 'grad_norm': 5.004568576812744, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:20,  1.07it/s] 48%|████▊     | 19/40 [00:18<00:20,  1.01it/s]                                               {'loss': 2.2757, 'grad_norm': 4.800353050231934, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:20,  1.01it/s] 50%|█████     | 20/40 [00:19<00:20,  1.04s/it]                                               {'loss': 1.9039, 'grad_norm': 4.134439945220947, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:20,  1.04s/it] 52%|█████▎    | 21/40 [00:20<00:20,  1.07s/it]                                               {'loss': 2.1109, 'grad_norm': 3.3972959518432617, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:21<00:19,  1.08s/it]                                               {'loss': 1.9618, 'grad_norm': 4.034336090087891, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it]                                               {'loss': 1.94, 'grad_norm': 3.6953296661376953, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it] 60%|██████    | 24/40 [00:23<00:13,  1.22it/s]                                               {'loss': 2.4465, 'grad_norm': 12.358518600463867, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.22it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.09it/s]                                               {'loss': 2.0083, 'grad_norm': 4.249273300170898, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.04it/s]                                               {'loss': 1.9498, 'grad_norm': 4.177460193634033, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.04it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.06it/s]                                               {'loss': 2.2038, 'grad_norm': 4.290148735046387, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.06it/s] 70%|███████   | 28/40 [00:27<00:10,  1.14it/s]                                               {'loss': 1.9478, 'grad_norm': 3.8748295307159424, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:10,  1.14it/s] 72%|███████▎  | 29/40 [00:27<00:09,  1.20it/s]                                               {'loss': 1.8985, 'grad_norm': 3.7947287559509277, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:27<00:09,  1.20it/s] 75%|███████▌  | 30/40 [00:28<00:07,  1.26it/s]                                               {'loss': 1.7718, 'grad_norm': 3.5861282348632812, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:28<00:07,  1.26it/s] 78%|███████▊  | 31/40 [00:29<00:07,  1.18it/s]                                               {'loss': 1.7571, 'grad_norm': 3.767026901245117, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:29<00:07,  1.18it/s] 80%|████████  | 32/40 [00:29<00:05,  1.55it/s]                                               {'loss': 0.9275, 'grad_norm': 10.107714653015137, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:29<00:05,  1.55it/s] 82%|████████▎ | 33/40 [00:30<00:05,  1.25it/s]                                               {'loss': 1.9682, 'grad_norm': 4.257180690765381, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:30<00:05,  1.25it/s] 85%|████████▌ | 34/40 [00:31<00:05,  1.12it/s]                                               {'loss': 1.7767, 'grad_norm': 4.238621711730957, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:31<00:05,  1.12it/s] 88%|████████▊ | 35/40 [00:33<00:04,  1.04it/s]                                               {'loss': 1.7327, 'grad_norm': 3.8000059127807617, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:33<00:04,  1.04it/s] 90%|█████████ | 36/40 [00:34<00:04,  1.01s/it]                                               {'loss': 1.7235, 'grad_norm': 3.8458735942840576, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:34<00:04,  1.01s/it] 92%|█████████▎| 37/40 [00:35<00:03,  1.02s/it]                                               {'loss': 1.7949, 'grad_norm': 3.165623664855957, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:35<00:03,  1.02s/it] 95%|█████████▌| 38/40 [00:36<00:02,  1.06s/it]                                               {'loss': 2.1559, 'grad_norm': 4.777846813201904, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:36<00:02,  1.06s/it] 98%|█████████▊| 39/40 [00:37<00:01,  1.07s/it]                                               {'loss': 2.219, 'grad_norm': 4.876507759094238, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:37<00:01,  1.07s/it]100%|██████████| 40/40 [00:37<00:00,  1.22it/s]                                               {'loss': 0.9435, 'grad_norm': 12.706745147705078, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.22it/s]                                               {'train_runtime': 37.8877, 'train_samples_per_second': 14.912, 'train_steps_per_second': 1.056, 'train_loss': 2.0404512137174606, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.22it/s]100%|██████████| 40/40 [00:37<00:00,  1.06it/s]
CLIENT:70
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:55,  1.43s/it]                                              {'loss': 2.2697, 'grad_norm': 4.647007942199707, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:55,  1.43s/it]  5%|▌         | 2/40 [00:02<00:41,  1.08s/it]                                              {'loss': 2.42, 'grad_norm': 4.5120673179626465, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:41,  1.08s/it]  8%|▊         | 3/40 [00:03<00:34,  1.07it/s]                                              {'loss': 2.4289, 'grad_norm': 4.239926815032959, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:34,  1.07it/s] 10%|█         | 4/40 [00:03<00:31,  1.15it/s]                                              {'loss': 2.4627, 'grad_norm': 4.984033107757568, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:31,  1.15it/s] 12%|█▎        | 5/40 [00:04<00:29,  1.17it/s]                                              {'loss': 2.0682, 'grad_norm': 3.6498847007751465, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:29,  1.17it/s] 15%|█▌        | 6/40 [00:05<00:31,  1.07it/s]                                              {'loss': 2.5691, 'grad_norm': 4.222259998321533, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:31,  1.07it/s] 18%|█▊        | 7/40 [00:06<00:33,  1.01s/it]                                              {'loss': 2.436, 'grad_norm': 3.6667063236236572, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:06<00:33,  1.01s/it] 20%|██        | 8/40 [00:07<00:27,  1.16it/s]                                              {'loss': 1.9556, 'grad_norm': 12.77322769165039, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:27,  1.16it/s] 22%|██▎       | 9/40 [00:08<00:28,  1.08it/s]                                              {'loss': 2.0529, 'grad_norm': 3.9571211338043213, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:28,  1.08it/s] 25%|██▌       | 10/40 [00:09<00:30,  1.00s/it]                                               {'loss': 1.9895, 'grad_norm': 3.6757943630218506, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:30,  1.00s/it] 28%|██▊       | 11/40 [00:10<00:29,  1.03s/it]                                               {'loss': 2.0142, 'grad_norm': 4.3113298416137695, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:29,  1.03s/it] 30%|███       | 12/40 [00:11<00:29,  1.07s/it]                                               {'loss': 2.1501, 'grad_norm': 4.186534404754639, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:29,  1.07s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 2.1716, 'grad_norm': 3.242799758911133, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.11s/it]                                               {'loss': 1.9815, 'grad_norm': 5.594920635223389, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.11s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.10s/it]                                               {'loss': 2.1595, 'grad_norm': 4.094767093658447, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.10s/it] 40%|████      | 16/40 [00:15<00:20,  1.19it/s]                                               {'loss': 2.7127, 'grad_norm': 16.564329147338867, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.08it/s]                                               {'loss': 1.9746, 'grad_norm': 4.744259834289551, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:17<00:21,  1.01it/s]                                               {'loss': 2.0168, 'grad_norm': 4.054102420806885, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:21,  1.01it/s] 48%|████▊     | 19/40 [00:18<00:21,  1.03s/it]                                               {'loss': 1.9752, 'grad_norm': 3.638929605484009, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.07s/it]                                               {'loss': 2.115, 'grad_norm': 3.800440549850464, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.07s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.08s/it]                                               {'loss': 1.8234, 'grad_norm': 3.750859260559082, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.08s/it] 55%|█████▌    | 22/40 [00:22<00:18,  1.04s/it]                                               {'loss': 1.9493, 'grad_norm': 3.7220230102539062, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.04s/it] 57%|█████▊    | 23/40 [00:23<00:17,  1.00s/it]                                               {'loss': 1.8656, 'grad_norm': 4.413792610168457, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:17,  1.00s/it] 60%|██████    | 24/40 [00:23<00:12,  1.32it/s]                                               {'loss': 1.8972, 'grad_norm': 15.182343482971191, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.32it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.17it/s]                                               {'loss': 1.6835, 'grad_norm': 3.8226494789123535, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.17it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.06it/s]                                               {'loss': 1.7822, 'grad_norm': 4.7591094970703125, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.06it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.00s/it]                                               {'loss': 1.8891, 'grad_norm': 3.646210193634033, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.00s/it] 70%|███████   | 28/40 [00:27<00:12,  1.03s/it]                                               {'loss': 1.939, 'grad_norm': 3.38675856590271, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.03s/it] 72%|███████▎  | 29/40 [00:28<00:11,  1.06s/it]                                               {'loss': 1.943, 'grad_norm': 4.098575115203857, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.06s/it] 75%|███████▌  | 30/40 [00:29<00:10,  1.08s/it]                                               {'loss': 1.9582, 'grad_norm': 4.519124984741211, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:10,  1.08s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it]                                               {'loss': 1.847, 'grad_norm': 3.6815764904022217, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it] 80%|████████  | 32/40 [00:31<00:06,  1.20it/s]                                               {'loss': 1.3517, 'grad_norm': 10.893651962280273, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.07it/s]                                               {'loss': 1.6949, 'grad_norm': 3.519357204437256, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.07it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s]                                               {'loss': 1.7507, 'grad_norm': 3.37658429145813, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.03s/it]                                               {'loss': 1.7138, 'grad_norm': 3.2711570262908936, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.07s/it]                                               {'loss': 1.354, 'grad_norm': 3.5711636543273926, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.08s/it]                                               {'loss': 2.0255, 'grad_norm': 4.323730945587158, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.10s/it]                                               {'loss': 2.0891, 'grad_norm': 8.386491775512695, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.10s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]                                               {'loss': 1.8337, 'grad_norm': 5.451836109161377, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'loss': 2.1205, 'grad_norm': 16.806852340698242, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'train_runtime': 39.5732, 'train_samples_per_second': 14.277, 'train_steps_per_second': 1.011, 'train_loss': 2.010879358649254, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:53,  1.37s/it]                                              {'loss': 2.3394, 'grad_norm': 4.080817222595215, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:53,  1.37s/it]  5%|▌         | 2/40 [00:02<00:45,  1.21s/it]                                              {'loss': 2.1144, 'grad_norm': 4.183587551116943, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:45,  1.21s/it]  8%|▊         | 3/40 [00:03<00:44,  1.19s/it]                                              {'loss': 2.277, 'grad_norm': 4.339402675628662, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:44,  1.19s/it] 10%|█         | 4/40 [00:04<00:41,  1.15s/it]                                              {'loss': 2.2683, 'grad_norm': 5.152411460876465, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.15s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.15s/it]                                              {'loss': 2.0369, 'grad_norm': 4.710915565490723, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.15s/it] 15%|█▌        | 6/40 [00:07<00:38,  1.15s/it]                                              {'loss': 2.1019, 'grad_norm': 3.9127602577209473, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:38,  1.15s/it] 18%|█▊        | 7/40 [00:08<00:37,  1.14s/it]                                              {'loss': 2.2352, 'grad_norm': 3.4986135959625244, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:37,  1.14s/it] 20%|██        | 8/40 [00:08<00:26,  1.19it/s]                                              {'loss': 3.88, 'grad_norm': 24.662752151489258, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:26,  1.19it/s] 22%|██▎       | 9/40 [00:09<00:28,  1.07it/s]                                              {'loss': 1.8825, 'grad_norm': 5.0679144859313965, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:28,  1.07it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.00it/s]                                               {'loss': 2.0652, 'grad_norm': 3.3785035610198975, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.00it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it]                                               {'loss': 1.8825, 'grad_norm': 3.7438912391662598, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it] 30%|███       | 12/40 [00:12<00:29,  1.07s/it]                                               {'loss': 2.0348, 'grad_norm': 3.961301326751709, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.07s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 1.8278, 'grad_norm': 3.9436542987823486, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:15<00:27,  1.07s/it]                                               {'loss': 2.0726, 'grad_norm': 3.832515001296997, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:27,  1.07s/it] 38%|███▊      | 15/40 [00:15<00:25,  1.02s/it]                                               {'loss': 2.017, 'grad_norm': 4.648711204528809, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:25,  1.02s/it] 40%|████      | 16/40 [00:16<00:18,  1.30it/s]                                               {'loss': 2.1419, 'grad_norm': 21.53221893310547, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:18,  1.30it/s] 42%|████▎     | 17/40 [00:17<00:18,  1.22it/s]                                               {'loss': 1.9382, 'grad_norm': 3.859968900680542, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:18,  1.22it/s] 45%|████▌     | 18/40 [00:18<00:19,  1.14it/s]                                               {'loss': 1.9181, 'grad_norm': 3.88584041595459, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:19,  1.14it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.04it/s]                                               {'loss': 1.6818, 'grad_norm': 3.041472911834717, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.04it/s] 50%|█████     | 20/40 [00:20<00:19,  1.01it/s]                                               {'loss': 1.687, 'grad_norm': 4.360156059265137, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:19,  1.01it/s] 52%|█████▎    | 21/40 [00:21<00:19,  1.04s/it]                                               {'loss': 1.9818, 'grad_norm': 8.443839073181152, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.04s/it] 55%|█████▌    | 22/40 [00:22<00:18,  1.05s/it]                                               {'loss': 1.8736, 'grad_norm': 4.685861110687256, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.05s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it]                                               {'loss': 1.8041, 'grad_norm': 4.718286037445068, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it] 60%|██████    | 24/40 [00:23<00:13,  1.22it/s]                                               {'loss': 1.6171, 'grad_norm': 18.18459701538086, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.22it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s]                                               {'loss': 1.6062, 'grad_norm': 3.7654168605804443, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s]                                               {'loss': 1.7762, 'grad_norm': 3.2625114917755127, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it]                                               {'loss': 1.473, 'grad_norm': 3.875725507736206, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it] 70%|███████   | 28/40 [00:28<00:12,  1.05s/it]                                               {'loss': 1.812, 'grad_norm': 4.33635950088501, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it]                                               {'loss': 1.6689, 'grad_norm': 3.2922720909118652, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.08s/it]                                               {'loss': 1.9799, 'grad_norm': 5.036462783813477, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.08s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it]                                               {'loss': 1.6319, 'grad_norm': 3.6523241996765137, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it] 80%|████████  | 32/40 [00:31<00:06,  1.20it/s]                                               {'loss': 1.4984, 'grad_norm': 14.626004219055176, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s]                                               {'loss': 1.5717, 'grad_norm': 3.7633140087127686, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.09it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s]                                               {'loss': 1.7468, 'grad_norm': 3.9384870529174805, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:35<00:04,  1.06it/s]                                               {'loss': 1.6126, 'grad_norm': 3.755683422088623, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:04,  1.06it/s] 90%|█████████ | 36/40 [00:36<00:03,  1.05it/s]                                               {'loss': 1.7307, 'grad_norm': 4.235180854797363, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:03,  1.05it/s] 92%|█████████▎| 37/40 [00:36<00:02,  1.05it/s]                                               {'loss': 1.5497, 'grad_norm': 3.3180596828460693, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:02,  1.05it/s] 95%|█████████▌| 38/40 [00:38<00:02,  1.01s/it]                                               {'loss': 1.6582, 'grad_norm': 3.139063596725464, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.01s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.05s/it]                                               {'loss': 1.7153, 'grad_norm': 3.6936893463134766, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.05s/it]100%|██████████| 40/40 [00:39<00:00,  1.26it/s]                                               {'loss': 1.0021, 'grad_norm': 10.250317573547363, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.26it/s]                                               {'train_runtime': 39.6224, 'train_samples_per_second': 14.26, 'train_steps_per_second': 1.01, 'train_loss': 1.8928201854228974, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.26it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<02:09,  3.63it/s]  1%|          | 3/471 [00:01<02:55,  2.66it/s]  1%|          | 4/471 [00:01<03:25,  2.27it/s]  1%|          | 5/471 [00:02<03:45,  2.07it/s]  1%|▏         | 6/471 [00:02<03:54,  1.98it/s]  1%|▏         | 7/471 [00:03<03:56,  1.96it/s]  2%|▏         | 8/471 [00:03<04:02,  1.91it/s]  2%|▏         | 9/471 [00:04<04:03,  1.90it/s]  2%|▏         | 10/471 [00:04<03:58,  1.93it/s]  2%|▏         | 11/471 [00:05<03:59,  1.92it/s]  3%|▎         | 12/471 [00:05<04:05,  1.87it/s]  3%|▎         | 13/471 [00:06<04:02,  1.89it/s]  3%|▎         | 14/471 [00:06<03:53,  1.96it/s]  3%|▎         | 15/471 [00:07<03:45,  2.02it/s]  3%|▎         | 16/471 [00:07<03:39,  2.07it/s]  4%|▎         | 17/471 [00:08<03:32,  2.13it/s]  4%|▍         | 18/471 [00:08<03:31,  2.14it/s]  4%|▍         | 19/471 [00:09<03:42,  2.03it/s]  4%|▍         | 20/471 [00:09<03:51,  1.95it/s]  4%|▍         | 21/471 [00:10<03:56,  1.90it/s]  5%|▍         | 22/471 [00:10<03:56,  1.90it/s]  5%|▍         | 23/471 [00:11<04:01,  1.86it/s]  5%|▌         | 24/471 [00:12<04:04,  1.83it/s]  5%|▌         | 25/471 [00:12<04:03,  1.83it/s]  6%|▌         | 26/471 [00:13<04:03,  1.83it/s]  6%|▌         | 27/471 [00:13<04:01,  1.84it/s]  6%|▌         | 28/471 [00:14<04:03,  1.82it/s]  6%|▌         | 29/471 [00:14<04:07,  1.79it/s]  6%|▋         | 30/471 [00:15<04:07,  1.78it/s]  7%|▋         | 31/471 [00:15<04:02,  1.81it/s]  7%|▋         | 32/471 [00:16<03:58,  1.84it/s]  7%|▋         | 33/471 [00:16<03:58,  1.83it/s]  7%|▋         | 34/471 [00:17<04:00,  1.82it/s]  7%|▋         | 35/471 [00:18<04:00,  1.81it/s]  8%|▊         | 36/471 [00:18<04:00,  1.81it/s]  8%|▊         | 37/471 [00:19<03:57,  1.83it/s]  8%|▊         | 38/471 [00:19<03:52,  1.86it/s]  8%|▊         | 39/471 [00:20<03:52,  1.86it/s]  8%|▊         | 40/471 [00:20<03:53,  1.84it/s]  9%|▊         | 41/471 [00:21<03:43,  1.93it/s]  9%|▉         | 42/471 [00:21<03:36,  1.98it/s]  9%|▉         | 43/471 [00:22<03:27,  2.06it/s]  9%|▉         | 44/471 [00:22<03:17,  2.16it/s] 10%|▉         | 45/471 [00:22<03:04,  2.32it/s] 10%|▉         | 46/471 [00:23<02:55,  2.42it/s] 10%|▉         | 47/471 [00:23<02:49,  2.51it/s] 10%|█         | 48/471 [00:24<02:58,  2.37it/s] 10%|█         | 49/471 [00:24<03:02,  2.31it/s] 11%|█         | 50/471 [00:24<02:53,  2.42it/s] 11%|█         | 51/471 [00:25<02:52,  2.43it/s] 11%|█         | 52/471 [00:25<02:58,  2.34it/s] 11%|█▏        | 53/471 [00:26<02:59,  2.32it/s] 11%|█▏        | 54/471 [00:26<03:02,  2.28it/s] 12%|█▏        | 55/471 [00:27<03:14,  2.14it/s] 12%|█▏        | 56/471 [00:27<03:26,  2.01it/s] 12%|█▏        | 57/471 [00:28<03:33,  1.94it/s] 12%|█▏        | 58/471 [00:28<03:36,  1.90it/s] 13%|█▎        | 59/471 [00:29<03:41,  1.86it/s] 13%|█▎        | 60/471 [00:30<03:44,  1.83it/s] 13%|█▎        | 61/471 [00:30<03:44,  1.83it/s] 13%|█▎        | 62/471 [00:31<03:45,  1.82it/s] 13%|█▎        | 63/471 [00:31<03:42,  1.83it/s] 14%|█▎        | 64/471 [00:32<03:44,  1.81it/s] 14%|█▍        | 65/471 [00:32<03:47,  1.78it/s] 14%|█▍        | 66/471 [00:33<03:47,  1.78it/s] 14%|█▍        | 67/471 [00:33<03:44,  1.80it/s] 14%|█▍        | 68/471 [00:34<03:39,  1.83it/s] 15%|█▍        | 69/471 [00:35<03:41,  1.82it/s] 15%|█▍        | 70/471 [00:35<03:42,  1.80it/s] 15%|█▌        | 71/471 [00:36<03:43,  1.79it/s] 15%|█▌        | 72/471 [00:36<03:43,  1.79it/s] 15%|█▌        | 73/471 [00:37<03:35,  1.85it/s] 16%|█▌        | 74/471 [00:37<03:31,  1.88it/s] 16%|█▌        | 75/471 [00:38<03:35,  1.84it/s] 16%|█▌        | 76/471 [00:38<03:35,  1.83it/s] 16%|█▋        | 77/471 [00:39<03:36,  1.82it/s] 17%|█▋        | 78/471 [00:40<03:36,  1.82it/s] 17%|█▋        | 79/471 [00:40<03:28,  1.88it/s] 17%|█▋        | 80/471 [00:40<03:16,  1.99it/s] 17%|█▋        | 81/471 [00:41<03:10,  2.05it/s] 17%|█▋        | 82/471 [00:41<03:07,  2.08it/s] 18%|█▊        | 83/471 [00:42<03:04,  2.11it/s] 18%|█▊        | 84/471 [00:42<03:03,  2.11it/s] 18%|█▊        | 85/471 [00:43<03:02,  2.11it/s] 18%|█▊        | 86/471 [00:43<02:54,  2.20it/s] 18%|█▊        | 87/471 [00:44<02:43,  2.35it/s] 19%|█▊        | 88/471 [00:44<02:38,  2.42it/s] 19%|█▉        | 89/471 [00:44<02:42,  2.35it/s] 19%|█▉        | 90/471 [00:45<02:47,  2.28it/s] 19%|█▉        | 91/471 [00:45<02:49,  2.25it/s] 20%|█▉        | 92/471 [00:46<03:01,  2.09it/s] 20%|█▉        | 93/471 [00:46<03:10,  1.99it/s] 20%|█▉        | 94/471 [00:47<03:13,  1.95it/s] 20%|██        | 95/471 [00:47<03:11,  1.96it/s] 20%|██        | 96/471 [00:48<03:14,  1.93it/s] 21%|██        | 97/471 [00:49<03:16,  1.91it/s] 21%|██        | 98/471 [00:49<03:19,  1.87it/s] 21%|██        | 99/471 [00:50<03:20,  1.85it/s] 21%|██        | 100/471 [00:50<03:22,  1.84it/s] 21%|██▏       | 101/471 [00:51<03:21,  1.84it/s] 22%|██▏       | 102/471 [00:51<03:15,  1.88it/s] 22%|██▏       | 103/471 [00:52<03:17,  1.86it/s] 22%|██▏       | 104/471 [00:52<03:19,  1.84it/s] 22%|██▏       | 105/471 [00:53<03:20,  1.82it/s] 23%|██▎       | 106/471 [00:53<03:22,  1.80it/s] 23%|██▎       | 107/471 [00:54<03:19,  1.83it/s] 23%|██▎       | 108/471 [00:55<03:18,  1.83it/s] 23%|██▎       | 109/471 [00:55<03:18,  1.83it/s] 23%|██▎       | 110/471 [00:56<03:15,  1.84it/s] 24%|██▎       | 111/471 [00:56<03:14,  1.85it/s] 24%|██▍       | 112/471 [00:57<03:12,  1.87it/s] 24%|██▍       | 113/471 [00:57<03:03,  1.95it/s] 24%|██▍       | 114/471 [00:58<03:00,  1.98it/s] 24%|██▍       | 115/471 [00:58<02:57,  2.01it/s] 25%|██▍       | 116/471 [00:59<02:50,  2.08it/s] 25%|██▍       | 117/471 [00:59<02:54,  2.03it/s] 25%|██▌       | 118/471 [01:00<03:00,  1.96it/s] 25%|██▌       | 119/471 [01:00<03:05,  1.90it/s] 25%|██▌       | 120/471 [01:01<03:07,  1.87it/s] 26%|██▌       | 121/471 [01:01<03:08,  1.85it/s] 26%|██▌       | 122/471 [01:02<03:00,  1.93it/s] 26%|██▌       | 123/471 [01:02<02:53,  2.00it/s] 26%|██▋       | 124/471 [01:03<02:50,  2.04it/s] 27%|██▋       | 125/471 [01:03<02:49,  2.04it/s] 27%|██▋       | 126/471 [01:04<02:45,  2.09it/s] 27%|██▋       | 127/471 [01:04<02:42,  2.11it/s] 27%|██▋       | 128/471 [01:05<02:43,  2.10it/s] 27%|██▋       | 129/471 [01:05<02:53,  1.98it/s] 28%|██▊       | 130/471 [01:06<02:58,  1.91it/s] 28%|██▊       | 131/471 [01:06<03:02,  1.87it/s] 28%|██▊       | 132/471 [01:07<03:02,  1.85it/s] 28%|██▊       | 133/471 [01:07<03:00,  1.87it/s] 28%|██▊       | 134/471 [01:08<03:04,  1.83it/s] 29%|██▊       | 135/471 [01:09<03:05,  1.81it/s] 29%|██▉       | 136/471 [01:09<03:07,  1.79it/s] 29%|██▉       | 137/471 [01:10<03:06,  1.79it/s] 29%|██▉       | 138/471 [01:10<03:04,  1.81it/s] 30%|██▉       | 139/471 [01:11<03:02,  1.82it/s] 30%|██▉       | 140/471 [01:11<03:03,  1.80it/s] 30%|██▉       | 141/471 [01:12<03:04,  1.79it/s] 30%|███       | 142/471 [01:12<03:03,  1.80it/s] 30%|███       | 143/471 [01:13<03:01,  1.81it/s] 31%|███       | 144/471 [01:14<03:00,  1.81it/s] 31%|███       | 145/471 [01:14<03:01,  1.79it/s] 31%|███       | 146/471 [01:15<03:03,  1.78it/s] 31%|███       | 147/471 [01:15<03:02,  1.78it/s] 31%|███▏      | 148/471 [01:16<02:59,  1.80it/s] 32%|███▏      | 149/471 [01:16<02:57,  1.82it/s] 32%|███▏      | 150/471 [01:17<02:59,  1.78it/s] 32%|███▏      | 151/471 [01:17<03:01,  1.77it/s] 32%|███▏      | 152/471 [01:18<02:58,  1.78it/s] 32%|███▏      | 153/471 [01:19<02:59,  1.78it/s] 33%|███▎      | 154/471 [01:19<02:52,  1.84it/s] 33%|███▎      | 155/471 [01:20<02:51,  1.84it/s] 33%|███▎      | 156/471 [01:20<02:52,  1.83it/s] 33%|███▎      | 157/471 [01:21<02:53,  1.81it/s] 34%|███▎      | 158/471 [01:21<02:52,  1.81it/s] 34%|███▍      | 159/471 [01:22<02:50,  1.83it/s] 34%|███▍      | 160/471 [01:22<02:51,  1.82it/s] 34%|███▍      | 161/471 [01:23<02:50,  1.81it/s] 34%|███▍      | 162/471 [01:23<02:51,  1.80it/s] 35%|███▍      | 163/471 [01:24<02:52,  1.79it/s] 35%|███▍      | 164/471 [01:25<02:50,  1.80it/s] 35%|███▌      | 165/471 [01:25<02:48,  1.81it/s] 35%|███▌      | 166/471 [01:26<02:49,  1.80it/s] 35%|███▌      | 167/471 [01:26<02:51,  1.78it/s] 36%|███▌      | 168/471 [01:27<02:51,  1.77it/s] 36%|███▌      | 169/471 [01:27<02:50,  1.77it/s] 36%|███▌      | 170/471 [01:28<02:45,  1.82it/s] 36%|███▋      | 171/471 [01:29<02:46,  1.80it/s] 37%|███▋      | 172/471 [01:29<02:47,  1.79it/s] 37%|███▋      | 173/471 [01:30<02:47,  1.78it/s] 37%|███▋      | 174/471 [01:30<02:45,  1.79it/s] 37%|███▋      | 175/471 [01:31<02:43,  1.81it/s] 37%|███▋      | 176/471 [01:31<02:44,  1.79it/s] 38%|███▊      | 177/471 [01:32<02:44,  1.78it/s] 38%|███▊      | 178/471 [01:32<02:43,  1.79it/s] 38%|███▊      | 179/471 [01:33<02:42,  1.80it/s] 38%|███▊      | 180/471 [01:34<02:40,  1.82it/s] 38%|███▊      | 181/471 [01:34<02:41,  1.80it/s] 39%|███▊      | 182/471 [01:35<02:43,  1.76it/s] 39%|███▉      | 183/471 [01:35<02:43,  1.76it/s] 39%|███▉      | 184/471 [01:36<02:41,  1.78it/s] 39%|███▉      | 185/471 [01:36<02:37,  1.81it/s] 39%|███▉      | 186/471 [01:37<02:38,  1.80it/s] 40%|███▉      | 187/471 [01:37<02:40,  1.77it/s] 40%|███▉      | 188/471 [01:38<02:39,  1.77it/s] 40%|████      | 189/471 [01:39<02:38,  1.78it/s] 40%|████      | 190/471 [01:39<02:35,  1.81it/s] 41%|████      | 191/471 [01:40<02:33,  1.82it/s] 41%|████      | 192/471 [01:40<02:34,  1.80it/s] 41%|████      | 193/471 [01:41<02:36,  1.78it/s] 41%|████      | 194/471 [01:41<02:36,  1.77it/s] 41%|████▏     | 195/471 [01:42<02:34,  1.78it/s] 42%|████▏     | 196/471 [01:42<02:31,  1.81it/s] 42%|████▏     | 197/471 [01:43<02:32,  1.80it/s] 42%|████▏     | 198/471 [01:44<02:33,  1.78it/s] 42%|████▏     | 199/471 [01:44<02:31,  1.79it/s] 42%|████▏     | 200/471 [01:45<02:31,  1.79it/s] 43%|████▎     | 201/471 [01:45<02:28,  1.82it/s] 43%|████▎     | 202/471 [01:46<02:29,  1.80it/s] 43%|████▎     | 203/471 [01:46<02:29,  1.79it/s] 43%|████▎     | 204/471 [01:47<02:29,  1.78it/s] 44%|████▎     | 205/471 [01:47<02:28,  1.80it/s] 44%|████▎     | 206/471 [01:48<02:24,  1.83it/s] 44%|████▍     | 207/471 [01:49<02:25,  1.81it/s] 44%|████▍     | 208/471 [01:49<02:26,  1.79it/s] 44%|████▍     | 209/471 [01:50<02:25,  1.80it/s] 45%|████▍     | 210/471 [01:50<02:25,  1.80it/s] 45%|████▍     | 211/471 [01:51<02:22,  1.82it/s] 45%|████▌     | 212/471 [01:51<02:22,  1.82it/s] 45%|████▌     | 213/471 [01:52<02:23,  1.80it/s] 45%|████▌     | 214/471 [01:52<02:22,  1.81it/s] 46%|████▌     | 215/471 [01:53<02:21,  1.81it/s] 46%|████▌     | 216/471 [01:54<02:20,  1.82it/s] 46%|████▌     | 217/471 [01:54<02:19,  1.82it/s] 46%|████▋     | 218/471 [01:55<02:20,  1.80it/s] 46%|████▋     | 219/471 [01:55<02:20,  1.79it/s] 47%|████▋     | 220/471 [01:56<02:18,  1.81it/s] 47%|████▋     | 221/471 [01:56<02:17,  1.82it/s] 47%|████▋     | 222/471 [01:57<02:16,  1.82it/s] 47%|████▋     | 223/471 [01:57<02:18,  1.79it/s] 48%|████▊     | 224/471 [01:58<02:17,  1.80it/s] 48%|████▊     | 225/471 [01:59<02:16,  1.80it/s] 48%|████▊     | 226/471 [01:59<02:13,  1.83it/s] 48%|████▊     | 227/471 [02:00<02:11,  1.85it/s] 48%|████▊     | 228/471 [02:00<02:13,  1.82it/s] 49%|████▊     | 229/471 [02:01<02:13,  1.81it/s] 49%|████▉     | 230/471 [02:01<02:13,  1.81it/s] 49%|████▉     | 231/471 [02:02<02:12,  1.81it/s] 49%|████▉     | 232/471 [02:02<02:10,  1.84it/s] 49%|████▉     | 233/471 [02:03<02:11,  1.81it/s] 50%|████▉     | 234/471 [02:03<02:11,  1.80it/s] 50%|████▉     | 235/471 [02:04<02:11,  1.80it/s] 50%|█████     | 236/471 [02:05<02:10,  1.80it/s] 50%|█████     | 237/471 [02:05<02:07,  1.83it/s] 51%|█████     | 238/471 [02:06<02:07,  1.82it/s] 51%|█████     | 239/471 [02:06<02:09,  1.79it/s] 51%|█████     | 240/471 [02:07<02:08,  1.80it/s] 51%|█████     | 241/471 [02:07<02:08,  1.79it/s] 51%|█████▏    | 242/471 [02:08<02:05,  1.82it/s] 52%|█████▏    | 243/471 [02:08<02:03,  1.85it/s] 52%|█████▏    | 244/471 [02:09<02:03,  1.83it/s] 52%|█████▏    | 245/471 [02:10<02:04,  1.82it/s] 52%|█████▏    | 246/471 [02:10<02:03,  1.82it/s] 52%|█████▏    | 247/471 [02:11<02:02,  1.82it/s] 53%|█████▎    | 248/471 [02:11<02:02,  1.82it/s] 53%|█████▎    | 249/471 [02:12<01:59,  1.86it/s] 53%|█████▎    | 250/471 [02:12<01:59,  1.85it/s] 53%|█████▎    | 251/471 [02:13<02:00,  1.83it/s] 54%|█████▎    | 252/471 [02:13<01:59,  1.84it/s] 54%|█████▎    | 253/471 [02:14<01:56,  1.87it/s] 54%|█████▍    | 254/471 [02:14<01:57,  1.85it/s] 54%|█████▍    | 255/471 [02:15<01:57,  1.83it/s] 54%|█████▍    | 256/471 [02:15<01:54,  1.87it/s] 55%|█████▍    | 257/471 [02:16<01:55,  1.85it/s] 55%|█████▍    | 258/471 [02:17<01:56,  1.83it/s] 55%|█████▍    | 259/471 [02:17<01:57,  1.80it/s] 55%|█████▌    | 260/471 [02:18<01:56,  1.80it/s] 55%|█████▌    | 261/471 [02:18<01:55,  1.82it/s] 56%|█████▌    | 262/471 [02:19<01:53,  1.84it/s] 56%|█████▌    | 263/471 [02:19<01:54,  1.82it/s] 56%|█████▌    | 264/471 [02:20<01:55,  1.80it/s] 56%|█████▋    | 265/471 [02:20<01:54,  1.79it/s] 56%|█████▋    | 266/471 [02:21<01:53,  1.81it/s] 57%|█████▋    | 267/471 [02:22<01:50,  1.84it/s] 57%|█████▋    | 268/471 [02:22<01:48,  1.87it/s] 57%|█████▋    | 269/471 [02:23<01:48,  1.87it/s] 57%|█████▋    | 270/471 [02:23<01:48,  1.86it/s] 58%|█████▊    | 271/471 [02:24<01:49,  1.83it/s] 58%|█████▊    | 272/471 [02:24<01:48,  1.83it/s] 58%|█████▊    | 273/471 [02:25<01:49,  1.81it/s] 58%|█████▊    | 274/471 [02:25<01:46,  1.84it/s] 58%|█████▊    | 275/471 [02:26<01:46,  1.84it/s] 59%|█████▊    | 276/471 [02:26<01:46,  1.83it/s] 59%|█████▉    | 277/471 [02:27<01:46,  1.82it/s] 59%|█████▉    | 278/471 [02:28<01:46,  1.81it/s] 59%|█████▉    | 279/471 [02:28<01:46,  1.80it/s] 59%|█████▉    | 280/471 [02:29<01:44,  1.82it/s] 60%|█████▉    | 281/471 [02:29<01:43,  1.83it/s] 60%|█████▉    | 282/471 [02:30<01:44,  1.81it/s] 60%|██████    | 283/471 [02:30<01:44,  1.80it/s] 60%|██████    | 284/471 [02:31<01:42,  1.82it/s] 61%|██████    | 285/471 [02:31<01:42,  1.81it/s] 61%|██████    | 286/471 [02:32<01:41,  1.82it/s] 61%|██████    | 287/471 [02:32<01:40,  1.83it/s] 61%|██████    | 288/471 [02:33<01:40,  1.82it/s] 61%|██████▏   | 289/471 [02:34<01:39,  1.83it/s] 62%|██████▏   | 290/471 [02:34<01:39,  1.81it/s] 62%|██████▏   | 291/471 [02:35<01:39,  1.81it/s] 62%|██████▏   | 292/471 [02:35<01:37,  1.84it/s] 62%|██████▏   | 293/471 [02:36<01:36,  1.84it/s] 62%|██████▏   | 294/471 [02:36<01:37,  1.82it/s] 63%|██████▎   | 295/471 [02:37<01:36,  1.83it/s] 63%|██████▎   | 296/471 [02:37<01:35,  1.83it/s] 63%|██████▎   | 297/471 [02:38<01:35,  1.82it/s] 63%|██████▎   | 298/471 [02:39<01:33,  1.85it/s] 63%|██████▎   | 299/471 [02:39<01:30,  1.90it/s] 64%|██████▎   | 300/471 [02:40<01:29,  1.92it/s] 64%|██████▍   | 301/471 [02:40<01:29,  1.89it/s] 64%|██████▍   | 302/471 [02:41<01:30,  1.86it/s] 64%|██████▍   | 303/471 [02:41<01:31,  1.84it/s] 65%|██████▍   | 304/471 [02:42<01:30,  1.85it/s] 65%|██████▍   | 305/471 [02:42<01:29,  1.85it/s] 65%|██████▍   | 306/471 [02:43<01:29,  1.85it/s] 65%|██████▌   | 307/471 [02:43<01:26,  1.90it/s] 65%|██████▌   | 308/471 [02:44<01:26,  1.88it/s] 66%|██████▌   | 309/471 [02:44<01:27,  1.86it/s] 66%|██████▌   | 310/471 [02:45<01:27,  1.84it/s] 66%|██████▌   | 311/471 [02:45<01:27,  1.83it/s] 66%|██████▌   | 312/471 [02:46<01:27,  1.82it/s] 66%|██████▋   | 313/471 [02:46<01:22,  1.92it/s] 67%|██████▋   | 314/471 [02:47<01:18,  2.01it/s] 67%|██████▋   | 315/471 [02:47<01:15,  2.07it/s] 67%|██████▋   | 316/471 [02:48<01:13,  2.11it/s] 67%|██████▋   | 317/471 [02:48<01:11,  2.16it/s] 68%|██████▊   | 318/471 [02:49<01:12,  2.12it/s] 68%|██████▊   | 319/471 [02:49<01:14,  2.03it/s] 68%|██████▊   | 320/471 [02:50<01:15,  1.99it/s] 68%|██████▊   | 321/471 [02:50<01:15,  2.00it/s] 68%|██████▊   | 322/471 [02:51<01:15,  1.96it/s] 69%|██████▊   | 323/471 [02:51<01:17,  1.91it/s] 69%|██████▉   | 324/471 [02:52<01:17,  1.89it/s] 69%|██████▉   | 325/471 [02:53<01:18,  1.86it/s] 69%|██████▉   | 326/471 [02:53<01:18,  1.86it/s] 69%|██████▉   | 327/471 [02:54<01:15,  1.92it/s] 70%|██████▉   | 328/471 [02:54<01:10,  2.03it/s] 70%|██████▉   | 329/471 [02:54<01:06,  2.13it/s] 70%|███████   | 330/471 [02:55<01:03,  2.21it/s] 70%|███████   | 331/471 [02:55<01:00,  2.32it/s] 70%|███████   | 332/471 [02:56<00:57,  2.42it/s] 71%|███████   | 333/471 [02:56<00:55,  2.50it/s] 71%|███████   | 334/471 [02:56<00:53,  2.55it/s] 71%|███████   | 335/471 [02:57<00:52,  2.60it/s] 71%|███████▏  | 336/471 [02:57<00:50,  2.65it/s] 72%|███████▏  | 337/471 [02:57<00:54,  2.46it/s] 72%|███████▏  | 338/471 [02:58<00:59,  2.23it/s] 72%|███████▏  | 339/471 [02:59<01:02,  2.12it/s] 72%|███████▏  | 340/471 [02:59<01:05,  2.01it/s] 72%|███████▏  | 341/471 [03:00<01:06,  1.95it/s] 73%|███████▎  | 342/471 [03:00<01:07,  1.90it/s] 73%|███████▎  | 343/471 [03:01<01:07,  1.89it/s] 73%|███████▎  | 344/471 [03:01<01:07,  1.89it/s] 73%|███████▎  | 345/471 [03:02<01:06,  1.89it/s] 73%|███████▎  | 346/471 [03:02<01:07,  1.86it/s] 74%|███████▎  | 347/471 [03:03<01:06,  1.86it/s] 74%|███████▍  | 348/471 [03:03<01:07,  1.83it/s] 74%|███████▍  | 349/471 [03:04<01:05,  1.85it/s] 74%|███████▍  | 350/471 [03:04<01:01,  1.96it/s] 75%|███████▍  | 351/471 [03:05<00:57,  2.08it/s] 75%|███████▍  | 352/471 [03:05<00:55,  2.15it/s] 75%|███████▍  | 353/471 [03:06<00:54,  2.15it/s] 75%|███████▌  | 354/471 [03:06<00:54,  2.15it/s] 75%|███████▌  | 355/471 [03:07<00:57,  2.03it/s] 76%|███████▌  | 356/471 [03:07<00:58,  1.95it/s] 76%|███████▌  | 357/471 [03:08<00:59,  1.92it/s] 76%|███████▌  | 358/471 [03:08<00:57,  1.96it/s] 76%|███████▌  | 359/471 [03:09<00:58,  1.92it/s] 76%|███████▋  | 360/471 [03:09<00:58,  1.91it/s] 77%|███████▋  | 361/471 [03:10<00:58,  1.87it/s] 77%|███████▋  | 362/471 [03:11<00:59,  1.85it/s] 77%|███████▋  | 363/471 [03:11<00:58,  1.85it/s] 77%|███████▋  | 364/471 [03:12<00:57,  1.87it/s] 77%|███████▋  | 365/471 [03:12<00:54,  1.93it/s] 78%|███████▊  | 366/471 [03:13<00:54,  1.91it/s] 78%|███████▊  | 367/471 [03:13<00:52,  1.98it/s] 78%|███████▊  | 368/471 [03:14<00:50,  2.04it/s] 78%|███████▊  | 369/471 [03:14<00:48,  2.09it/s] 79%|███████▊  | 370/471 [03:14<00:47,  2.13it/s] 79%|███████▉  | 371/471 [03:15<00:46,  2.15it/s] 79%|███████▉  | 372/471 [03:15<00:45,  2.18it/s] 79%|███████▉  | 373/471 [03:16<00:43,  2.23it/s] 79%|███████▉  | 374/471 [03:16<00:42,  2.26it/s] 80%|███████▉  | 375/471 [03:17<00:43,  2.23it/s] 80%|███████▉  | 376/471 [03:17<00:45,  2.10it/s] 80%|████████  | 377/471 [03:18<00:46,  2.01it/s] 80%|████████  | 378/471 [03:18<00:47,  1.95it/s] 80%|████████  | 379/471 [03:19<00:47,  1.93it/s] 81%|████████  | 380/471 [03:19<00:48,  1.88it/s] 81%|████████  | 381/471 [03:20<00:47,  1.88it/s] 81%|████████  | 382/471 [03:20<00:47,  1.88it/s] 81%|████████▏ | 383/471 [03:21<00:47,  1.84it/s] 82%|████████▏ | 384/471 [03:22<00:47,  1.82it/s] 82%|████████▏ | 385/471 [03:22<00:45,  1.88it/s] 82%|████████▏ | 386/471 [03:23<00:43,  1.97it/s] 82%|████████▏ | 387/471 [03:23<00:40,  2.06it/s] 82%|████████▏ | 388/471 [03:23<00:38,  2.17it/s] 83%|████████▎ | 389/471 [03:24<00:37,  2.21it/s] 83%|████████▎ | 390/471 [03:24<00:38,  2.09it/s] 83%|████████▎ | 391/471 [03:25<00:37,  2.11it/s] 83%|████████▎ | 392/471 [03:25<00:38,  2.06it/s] 83%|████████▎ | 393/471 [03:26<00:39,  1.98it/s] 84%|████████▎ | 394/471 [03:26<00:38,  1.98it/s] 84%|████████▍ | 395/471 [03:27<00:39,  1.95it/s] 84%|████████▍ | 396/471 [03:27<00:39,  1.89it/s] 84%|████████▍ | 397/471 [03:28<00:38,  1.92it/s] 85%|████████▍ | 398/471 [03:28<00:37,  1.93it/s] 85%|████████▍ | 399/471 [03:29<00:35,  2.03it/s] 85%|████████▍ | 400/471 [03:29<00:34,  2.08it/s] 85%|████████▌ | 401/471 [03:30<00:33,  2.09it/s] 85%|████████▌ | 402/471 [03:30<00:32,  2.11it/s] 86%|████████▌ | 403/471 [03:31<00:32,  2.12it/s] 86%|████████▌ | 404/471 [03:31<00:31,  2.10it/s] 86%|████████▌ | 405/471 [03:32<00:32,  2.02it/s] 86%|████████▌ | 406/471 [03:32<00:33,  1.96it/s] 86%|████████▋ | 407/471 [03:33<00:33,  1.91it/s] 87%|████████▋ | 408/471 [03:33<00:33,  1.87it/s] 87%|████████▋ | 409/471 [03:34<00:33,  1.84it/s] 87%|████████▋ | 410/471 [03:35<00:32,  1.86it/s] 87%|████████▋ | 411/471 [03:35<00:31,  1.89it/s] 87%|████████▋ | 412/471 [03:36<00:31,  1.87it/s] 88%|████████▊ | 413/471 [03:36<00:31,  1.84it/s] 88%|████████▊ | 414/471 [03:37<00:31,  1.83it/s] 88%|████████▊ | 415/471 [03:37<00:30,  1.84it/s] 88%|████████▊ | 416/471 [03:38<00:29,  1.85it/s] 89%|████████▊ | 417/471 [03:38<00:28,  1.88it/s] 89%|████████▊ | 418/471 [03:39<00:28,  1.89it/s] 89%|████████▉ | 419/471 [03:39<00:27,  1.86it/s] 89%|████████▉ | 420/471 [03:40<00:27,  1.84it/s] 89%|████████▉ | 421/471 [03:40<00:27,  1.83it/s] 90%|████████▉ | 422/471 [03:41<00:25,  1.89it/s] 90%|████████▉ | 423/471 [03:41<00:23,  2.00it/s] 90%|█████████ | 424/471 [03:42<00:22,  2.10it/s] 90%|█████████ | 425/471 [03:42<00:21,  2.13it/s] 90%|█████████ | 426/471 [03:43<00:21,  2.13it/s] 91%|█████████ | 427/471 [03:43<00:21,  2.05it/s] 91%|█████████ | 428/471 [03:44<00:21,  1.98it/s] 91%|█████████ | 429/471 [03:44<00:21,  1.94it/s] 91%|█████████▏| 430/471 [03:45<00:21,  1.95it/s] 92%|█████████▏| 431/471 [03:45<00:20,  1.91it/s] 92%|█████████▏| 432/471 [03:46<00:20,  1.87it/s] 92%|█████████▏| 433/471 [03:47<00:20,  1.88it/s] 92%|█████████▏| 434/471 [03:47<00:19,  1.86it/s] 92%|█████████▏| 435/471 [03:48<00:19,  1.86it/s] 93%|█████████▎| 436/471 [03:48<00:18,  1.90it/s] 93%|█████████▎| 437/471 [03:49<00:17,  1.91it/s] 93%|█████████▎| 438/471 [03:49<00:17,  1.88it/s] 93%|█████████▎| 439/471 [03:50<00:16,  1.90it/s] 93%|█████████▎| 440/471 [03:50<00:16,  1.86it/s] 94%|█████████▎| 441/471 [03:51<00:16,  1.83it/s] 94%|█████████▍| 442/471 [03:51<00:15,  1.83it/s] 94%|█████████▍| 443/471 [03:52<00:15,  1.86it/s] 94%|█████████▍| 444/471 [03:52<00:14,  1.85it/s] 94%|█████████▍| 445/471 [03:53<00:14,  1.84it/s] 95%|█████████▍| 446/471 [03:54<00:13,  1.82it/s] 95%|█████████▍| 447/471 [03:54<00:13,  1.81it/s] 95%|█████████▌| 448/471 [03:55<00:12,  1.84it/s] 95%|█████████▌| 449/471 [03:55<00:11,  1.86it/s] 96%|█████████▌| 450/471 [03:56<00:11,  1.84it/s] 96%|█████████▌| 451/471 [03:56<00:10,  1.84it/s] 96%|█████████▌| 452/471 [03:57<00:10,  1.86it/s] 96%|█████████▌| 453/471 [03:57<00:09,  1.84it/s] 96%|█████████▋| 454/471 [03:58<00:09,  1.84it/s] 97%|█████████▋| 455/471 [03:58<00:08,  1.81it/s] 97%|█████████▋| 456/471 [03:59<00:08,  1.80it/s] 97%|█████████▋| 457/471 [04:00<00:07,  1.81it/s] 97%|█████████▋| 458/471 [04:00<00:06,  1.95it/s] 97%|█████████▋| 459/471 [04:00<00:05,  2.07it/s] 98%|█████████▊| 460/471 [04:01<00:05,  2.06it/s] 98%|█████████▊| 461/471 [04:01<00:04,  2.08it/s] 98%|█████████▊| 462/471 [04:02<00:04,  2.13it/s] 98%|█████████▊| 463/471 [04:02<00:03,  2.09it/s] 99%|█████████▊| 464/471 [04:03<00:03,  2.07it/s] 99%|█████████▊| 465/471 [04:03<00:02,  2.11it/s] 99%|█████████▉| 466/471 [04:04<00:02,  2.01it/s] 99%|█████████▉| 467/471 [04:04<00:02,  1.93it/s] 99%|█████████▉| 468/471 [04:05<00:01,  1.90it/s]100%|█████████▉| 469/471 [04:05<00:01,  1.88it/s]100%|█████████▉| 470/471 [04:06<00:00,  1.91it/s]100%|██████████| 471/471 [04:06<00:00,  2.07it/s]100%|██████████| 471/471 [04:06<00:00,  1.91it/s]
{'eval_loss': 2.1176695823669434, 'eval_model_preparation_time': 0.0095, 'eval_acc': 0.48990971853425386, 'eval_runtime': 247.3616, 'eval_samples_per_second': 30.449, 'eval_steps_per_second': 1.904}
ROUND:3
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.07s/it]                                              {'loss': 2.0919, 'grad_norm': 3.949052572250366, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:41,  1.07s/it]  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]                                              {'loss': 2.3088, 'grad_norm': 6.223127841949463, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]  8%|▊         | 3/40 [00:03<00:40,  1.10s/it]                                              {'loss': 1.9723, 'grad_norm': 5.081456184387207, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:40,  1.10s/it] 10%|█         | 4/40 [00:04<00:40,  1.13s/it]                                              {'loss': 2.104, 'grad_norm': 3.989422082901001, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.13s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it]                                              {'loss': 1.9945, 'grad_norm': 4.742197036743164, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.1934, 'grad_norm': 4.429112434387207, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it]                                              {'loss': 2.3707, 'grad_norm': 4.8259406089782715, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it] 20%|██        | 8/40 [00:08<00:27,  1.16it/s]                                              {'loss': 1.5677, 'grad_norm': 11.52768611907959, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:27,  1.16it/s] 22%|██▎       | 9/40 [00:09<00:27,  1.11it/s]                                              {'loss': 2.3566, 'grad_norm': 4.848174095153809, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:27,  1.11it/s] 25%|██▌       | 10/40 [00:10<00:27,  1.09it/s]                                               {'loss': 1.9061, 'grad_norm': 4.1889142990112305, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:27,  1.09it/s] 28%|██▊       | 11/40 [00:10<00:26,  1.10it/s]                                               {'loss': 1.9067, 'grad_norm': 4.138126373291016, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:26,  1.10it/s] 30%|███       | 12/40 [00:12<00:27,  1.01it/s]                                               {'loss': 1.905, 'grad_norm': 9.319403648376465, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:27,  1.01it/s] 32%|███▎      | 13/40 [00:13<00:27,  1.02s/it]                                               {'loss': 1.7176, 'grad_norm': 3.621101140975952, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:27,  1.02s/it] 35%|███▌      | 14/40 [00:14<00:27,  1.06s/it]                                               {'loss': 1.8565, 'grad_norm': 8.536543846130371, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:27,  1.06s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it]                                               {'loss': 1.8045, 'grad_norm': 4.195946216583252, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it] 40%|████      | 16/40 [00:15<00:19,  1.22it/s]                                               {'loss': 1.2077, 'grad_norm': 22.2253475189209, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.22it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.08it/s]                                               {'loss': 1.8376, 'grad_norm': 3.7798123359680176, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s]                                               {'loss': 1.6216, 'grad_norm': 3.7248196601867676, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it]                                               {'loss': 1.7581, 'grad_norm': 4.291574954986572, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 1.9167, 'grad_norm': 4.034643173217773, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.09s/it]                                               {'loss': 1.6851, 'grad_norm': 4.124358177185059, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it]                                               {'loss': 2.0019, 'grad_norm': 5.171201705932617, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.11s/it]                                               {'loss': 2.1237, 'grad_norm': 4.545607089996338, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.11s/it] 60%|██████    | 24/40 [00:23<00:13,  1.20it/s]                                               {'loss': 1.8078, 'grad_norm': 12.895431518554688, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.08it/s]                                               {'loss': 1.9222, 'grad_norm': 4.225487232208252, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s]                                               {'loss': 1.8652, 'grad_norm': 3.933657646179199, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.04s/it]                                               {'loss': 1.4362, 'grad_norm': 9.037179946899414, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.04s/it] 70%|███████   | 28/40 [00:28<00:12,  1.01s/it]                                               {'loss': 1.7785, 'grad_norm': 4.452658176422119, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.01s/it] 72%|███████▎  | 29/40 [00:29<00:10,  1.01it/s]                                               {'loss': 1.7976, 'grad_norm': 5.192089080810547, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:10,  1.01it/s] 75%|███████▌  | 30/40 [00:30<00:09,  1.02it/s]                                               {'loss': 1.7492, 'grad_norm': 4.249279499053955, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:09,  1.02it/s] 78%|███████▊  | 31/40 [00:31<00:09,  1.02s/it]                                               {'loss': 1.65, 'grad_norm': 5.701026439666748, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.02s/it] 80%|████████  | 32/40 [00:31<00:06,  1.29it/s]                                               {'loss': 1.6422, 'grad_norm': 12.08266544342041, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.29it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.14it/s]                                               {'loss': 1.6672, 'grad_norm': 5.04659366607666, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.14it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.05it/s]                                               {'loss': 1.688, 'grad_norm': 6.411762237548828, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.05it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.01s/it]                                               {'loss': 1.6088, 'grad_norm': 4.347033500671387, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.01s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it]                                               {'loss': 1.7044, 'grad_norm': 4.143039226531982, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it]                                               {'loss': 1.8081, 'grad_norm': 4.438673496246338, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.08s/it]                                               {'loss': 1.9322, 'grad_norm': 5.790826797485352, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.10s/it]                                               {'loss': 1.7189, 'grad_norm': 4.017200469970703, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.10s/it]100%|██████████| 40/40 [00:39<00:00,  1.21it/s]                                               {'loss': 1.1887, 'grad_norm': 21.399642944335938, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.21it/s]                                               {'train_runtime': 39.6723, 'train_samples_per_second': 14.242, 'train_steps_per_second': 1.008, 'train_loss': 1.8293453693389892, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.21it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:14,  1.91s/it]                                              {'loss': 2.1735, 'grad_norm': 3.7435853481292725, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:14,  1.91s/it]  5%|▌         | 2/40 [00:02<00:51,  1.36s/it]                                              {'loss': 2.324, 'grad_norm': 5.910947322845459, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:51,  1.36s/it]  8%|▊         | 3/40 [00:03<00:43,  1.18s/it]                                              {'loss': 2.3056, 'grad_norm': 5.636033535003662, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:43,  1.18s/it] 10%|█         | 4/40 [00:04<00:39,  1.11s/it]                                              {'loss': 2.244, 'grad_norm': 5.8288679122924805, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.11s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it]                                              {'loss': 2.6684, 'grad_norm': 5.083895683288574, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it] 15%|█▌        | 6/40 [00:07<00:38,  1.13s/it]                                              {'loss': 1.9084, 'grad_norm': 3.9435060024261475, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:08<00:35,  1.08s/it]                                              {'loss': 2.2034, 'grad_norm': 4.068450450897217, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:35,  1.08s/it] 20%|██        | 8/40 [00:08<00:25,  1.23it/s]                                              {'loss': 2.2741, 'grad_norm': 14.249797821044922, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:25,  1.23it/s] 22%|██▎       | 9/40 [00:09<00:28,  1.10it/s]                                              {'loss': 2.0893, 'grad_norm': 4.030545711517334, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:28,  1.10it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s]                                               {'loss': 2.218, 'grad_norm': 4.807945251464844, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it]                                               {'loss': 2.008, 'grad_norm': 3.658583879470825, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it] 30%|███       | 12/40 [00:12<00:29,  1.06s/it]                                               {'loss': 2.1803, 'grad_norm': 5.617366313934326, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 2.2045, 'grad_norm': 6.858899116516113, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it]                                               {'loss': 2.0163, 'grad_norm': 4.055305480957031, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it]                                               {'loss': 1.7979, 'grad_norm': 3.7459781169891357, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it] 40%|████      | 16/40 [00:16<00:20,  1.19it/s]                                               {'loss': 2.0046, 'grad_norm': 15.04094409942627, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s]                                               {'loss': 1.8652, 'grad_norm': 4.570345878601074, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s]                                               {'loss': 1.9699, 'grad_norm': 4.351175308227539, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it]                                               {'loss': 2.0499, 'grad_norm': 3.9626619815826416, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it] 50%|█████     | 20/40 [00:21<00:21,  1.07s/it]                                               {'loss': 1.9382, 'grad_norm': 3.9189510345458984, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.07s/it] 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it]                                               {'loss': 2.204, 'grad_norm': 6.177753925323486, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it] 55%|█████▌    | 22/40 [00:22<00:18,  1.01s/it]                                               {'loss': 1.821, 'grad_norm': 3.8226797580718994, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.01s/it] 57%|█████▊    | 23/40 [00:23<00:16,  1.01it/s]                                               {'loss': 2.1394, 'grad_norm': 5.626400947570801, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:16,  1.01it/s] 60%|██████    | 24/40 [00:24<00:11,  1.36it/s]                                               {'loss': 1.7237, 'grad_norm': 17.473522186279297, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:25<00:12,  1.17it/s]                                               {'loss': 1.843, 'grad_norm': 4.458117961883545, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:12,  1.17it/s] 65%|██████▌   | 26/40 [00:26<00:12,  1.11it/s]                                               {'loss': 1.9581, 'grad_norm': 4.248813629150391, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:12,  1.11it/s] 68%|██████▊   | 27/40 [00:26<00:11,  1.17it/s]                                               {'loss': 1.7393, 'grad_norm': 4.797672271728516, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:11,  1.17it/s] 70%|███████   | 28/40 [00:27<00:09,  1.20it/s]                                               {'loss': 2.0382, 'grad_norm': 4.591213226318359, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:09,  1.20it/s] 72%|███████▎  | 29/40 [00:28<00:09,  1.22it/s]                                               {'loss': 1.9232, 'grad_norm': 4.066312789916992, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:09,  1.22it/s] 75%|███████▌  | 30/40 [00:29<00:08,  1.14it/s]                                               {'loss': 1.885, 'grad_norm': 4.8054423332214355, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:08,  1.14it/s] 78%|███████▊  | 31/40 [00:30<00:08,  1.06it/s]                                               {'loss': 1.8549, 'grad_norm': 4.571907997131348, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:08,  1.06it/s] 80%|████████  | 32/40 [00:30<00:05,  1.36it/s]                                               {'loss': 2.7031, 'grad_norm': 31.5780086517334, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:30<00:05,  1.36it/s] 82%|████████▎ | 33/40 [00:31<00:05,  1.19it/s]                                               {'loss': 1.9258, 'grad_norm': 3.987412691116333, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:31<00:05,  1.19it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.06it/s]                                               {'loss': 1.9089, 'grad_norm': 4.730373859405518, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.06it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.01it/s]                                               {'loss': 1.8424, 'grad_norm': 4.594710350036621, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.01it/s] 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it]                                               {'loss': 1.8888, 'grad_norm': 4.526322841644287, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.06s/it]                                               {'loss': 1.813, 'grad_norm': 4.494502067565918, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.06s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.09s/it]                                               {'loss': 1.7414, 'grad_norm': 3.9787909984588623, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.09s/it] 98%|█████████▊| 39/40 [00:38<00:01,  1.10s/it]                                               {'loss': 1.5101, 'grad_norm': 4.041897296905518, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:01,  1.10s/it]100%|██████████| 40/40 [00:38<00:00,  1.21it/s]                                               {'loss': 2.1369, 'grad_norm': 14.519254684448242, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.21it/s]                                               {'train_runtime': 39.0702, 'train_samples_per_second': 14.461, 'train_steps_per_second': 1.024, 'train_loss': 2.0261030554771424, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.21it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
CLIENT:76
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:34,  1.12it/s]                                              {'loss': 2.5443, 'grad_norm': 4.229429244995117, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:34,  1.12it/s]  5%|▌         | 2/40 [00:01<00:38,  1.01s/it]                                              {'loss': 1.984, 'grad_norm': 4.468922138214111, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:38,  1.01s/it]  8%|▊         | 3/40 [00:03<00:39,  1.06s/it]                                              {'loss': 2.3176, 'grad_norm': 5.922152996063232, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:39,  1.06s/it] 10%|█         | 4/40 [00:04<00:39,  1.10s/it]                                              {'loss': 2.2094, 'grad_norm': 5.881865501403809, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.10s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it]                                              {'loss': 2.4216, 'grad_norm': 6.137387752532959, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.12s/it]                                              {'loss': 2.2692, 'grad_norm': 4.681893825531006, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.12s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it]                                              {'loss': 2.2395, 'grad_norm': 9.36145305633545, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it] 20%|██        | 8/40 [00:07<00:26,  1.23it/s]                                              {'loss': 1.7955, 'grad_norm': 16.503034591674805, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:26,  1.23it/s] 22%|██▎       | 9/40 [00:08<00:28,  1.10it/s]                                              {'loss': 2.2353, 'grad_norm': 5.843391418457031, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:28,  1.10it/s] 25%|██▌       | 10/40 [00:09<00:28,  1.05it/s]                                               {'loss': 1.9892, 'grad_norm': 4.845552921295166, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:28,  1.05it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it]                                               {'loss': 1.9685, 'grad_norm': 4.108638286590576, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it] 30%|███       | 12/40 [00:12<00:29,  1.05s/it]                                               {'loss': 2.1651, 'grad_norm': 8.110880851745605, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.05s/it] 32%|███▎      | 13/40 [00:13<00:27,  1.02s/it]                                               {'loss': 1.9713, 'grad_norm': 4.266028881072998, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:27,  1.02s/it] 35%|███▌      | 14/40 [00:13<00:24,  1.07it/s]                                               {'loss': 2.0634, 'grad_norm': 4.037533283233643, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:24,  1.07it/s] 38%|███▊      | 15/40 [00:14<00:23,  1.08it/s]                                               {'loss': 2.1419, 'grad_norm': 4.458281993865967, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:23,  1.08it/s] 40%|████      | 16/40 [00:14<00:16,  1.45it/s]                                               {'loss': 1.2423, 'grad_norm': 10.85960865020752, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:14<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:15<00:18,  1.27it/s]                                               {'loss': 1.8142, 'grad_norm': 4.542458534240723, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:15<00:18,  1.27it/s] 45%|████▌     | 18/40 [00:17<00:19,  1.13it/s]                                               {'loss': 1.7618, 'grad_norm': 3.9320883750915527, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:19,  1.13it/s] 48%|████▊     | 19/40 [00:18<00:20,  1.02it/s]                                               {'loss': 1.9586, 'grad_norm': 4.03323221206665, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:20,  1.02it/s] 50%|█████     | 20/40 [00:19<00:20,  1.02s/it]                                               {'loss': 2.1346, 'grad_norm': 4.7933125495910645, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:20,  1.02s/it] 52%|█████▎    | 21/40 [00:20<00:20,  1.07s/it]                                               {'loss': 1.8586, 'grad_norm': 4.317811965942383, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it]                                               {'loss': 2.0298, 'grad_norm': 5.308620929718018, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it] 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it]                                               {'loss': 2.0458, 'grad_norm': 3.701648712158203, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it] 60%|██████    | 24/40 [00:23<00:13,  1.21it/s]                                               {'loss': 2.9393, 'grad_norm': 21.099014282226562, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.07it/s]                                               {'loss': 1.8565, 'grad_norm': 11.408698081970215, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.07it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.01it/s]                                               {'loss': 2.0388, 'grad_norm': 4.25009298324585, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.04s/it]                                               {'loss': 1.9203, 'grad_norm': 4.337896823883057, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.04s/it] 70%|███████   | 28/40 [00:27<00:12,  1.07s/it]                                               {'loss': 1.6449, 'grad_norm': 3.8724656105041504, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.07s/it] 72%|███████▎  | 29/40 [00:28<00:11,  1.07s/it]                                               {'loss': 1.7497, 'grad_norm': 4.303279399871826, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.07s/it] 75%|███████▌  | 30/40 [00:29<00:10,  1.10s/it]                                               {'loss': 1.8136, 'grad_norm': 5.322031021118164, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:10,  1.10s/it] 78%|███████▊  | 31/40 [00:30<00:09,  1.10s/it]                                               {'loss': 2.0339, 'grad_norm': 4.592833995819092, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.10s/it] 80%|████████  | 32/40 [00:31<00:06,  1.19it/s]                                               {'loss': 1.9797, 'grad_norm': 18.75304412841797, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.19it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.08it/s]                                               {'loss': 1.8355, 'grad_norm': 4.956643581390381, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:33<00:06,  1.00s/it]                                               {'loss': 1.9911, 'grad_norm': 5.273920059204102, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:06,  1.00s/it] 88%|████████▊ | 35/40 [00:34<00:05,  1.03s/it]                                               {'loss': 1.9062, 'grad_norm': 3.435462236404419, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.08s/it]                                               {'loss': 1.7214, 'grad_norm': 3.993748188018799, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.08s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.08s/it]                                               {'loss': 1.7351, 'grad_norm': 4.526547908782959, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.11s/it]                                               {'loss': 2.0555, 'grad_norm': 5.190325736999512, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.11s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.11s/it]                                               {'loss': 1.6742, 'grad_norm': 5.540649890899658, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.11s/it]100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'loss': 1.3787, 'grad_norm': 16.316450119018555, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]                                               {'train_runtime': 39.5034, 'train_samples_per_second': 14.303, 'train_steps_per_second': 1.013, 'train_loss': 1.9858968883752823, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.19it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]                                              {'loss': 2.0949, 'grad_norm': 3.8689122200012207, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 1.8776, 'grad_norm': 4.913806915283203, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:41,  1.12s/it]                                              {'loss': 2.4704, 'grad_norm': 6.6166558265686035, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.12s/it] 10%|█         | 4/40 [00:04<00:41,  1.15s/it]                                              {'loss': 2.0145, 'grad_norm': 5.738264083862305, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.15s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.12s/it]                                              {'loss': 2.2123, 'grad_norm': 4.399129867553711, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.12s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it]                                              {'loss': 2.1305, 'grad_norm': 5.271816253662109, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.3959, 'grad_norm': 4.50718355178833, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:32,  1.02s/it]                                              {'loss': 2.7467, 'grad_norm': 41.28313064575195, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.02s/it] 22%|██▎       | 9/40 [00:09<00:33,  1.07s/it]                                              {'loss': 2.1395, 'grad_norm': 5.955745697021484, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:33,  1.07s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.09s/it]                                               {'loss': 2.1371, 'grad_norm': 4.737016677856445, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.09s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it]                                               {'loss': 2.1007, 'grad_norm': 6.219865798950195, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it] 30%|███       | 12/40 [00:13<00:31,  1.12s/it]                                               {'loss': 1.9737, 'grad_norm': 5.0658464431762695, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.12s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it]                                               {'loss': 2.0026, 'grad_norm': 5.172059059143066, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it]                                               {'loss': 1.9266, 'grad_norm': 5.305978298187256, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it]                                               {'loss': 1.8024, 'grad_norm': 4.565530776977539, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it] 40%|████      | 16/40 [00:16<00:20,  1.18it/s]                                               {'loss': 2.0378, 'grad_norm': 13.47749137878418, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.18it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s]                                               {'loss': 2.0815, 'grad_norm': 4.876097679138184, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:19<00:22,  1.00s/it]                                               {'loss': 1.8764, 'grad_norm': 4.77450704574585, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:22,  1.00s/it] 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it]                                               {'loss': 1.8954, 'grad_norm': 4.782990455627441, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it] 50%|█████     | 20/40 [00:21<00:21,  1.08s/it]                                               {'loss': 1.8995, 'grad_norm': 4.000148773193359, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.08s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.08s/it]                                               {'loss': 1.8466, 'grad_norm': 4.645698070526123, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.08s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it]                                               {'loss': 1.7029, 'grad_norm': 3.9649832248687744, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it]                                               {'loss': 1.7822, 'grad_norm': 5.334589004516602, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it] 60%|██████    | 24/40 [00:25<00:13,  1.20it/s]                                               {'loss': 1.6087, 'grad_norm': 15.990069389343262, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:26<00:13,  1.09it/s]                                               {'loss': 1.6918, 'grad_norm': 3.517503499984741, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:27<00:13,  1.03it/s]                                               {'loss': 1.8603, 'grad_norm': 4.290201187133789, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:13,  1.03it/s] 68%|██████▊   | 27/40 [00:28<00:13,  1.02s/it]                                               {'loss': 1.8727, 'grad_norm': 6.771258354187012, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.02s/it] 70%|███████   | 28/40 [00:29<00:12,  1.06s/it]                                               {'loss': 1.7556, 'grad_norm': 4.939879417419434, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 1.7501, 'grad_norm': 5.710233211517334, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:11,  1.11s/it]                                               {'loss': 1.8411, 'grad_norm': 5.04681396484375, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:11,  1.11s/it] 78%|███████▊  | 31/40 [00:32<00:10,  1.11s/it]                                               {'loss': 1.7809, 'grad_norm': 4.2321882247924805, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:10,  1.11s/it] 80%|████████  | 32/40 [00:33<00:06,  1.18it/s]                                               {'loss': 1.0351, 'grad_norm': 9.617950439453125, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:33<00:06,  1.18it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.07it/s]                                               {'loss': 1.6799, 'grad_norm': 3.8820388317108154, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.07it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s]                                               {'loss': 1.6628, 'grad_norm': 4.309895992279053, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it]                                               {'loss': 1.5976, 'grad_norm': 5.629366874694824, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.04s/it]                                               {'loss': 1.7012, 'grad_norm': 4.719704627990723, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.04s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.07s/it]                                               {'loss': 1.832, 'grad_norm': 5.213689804077148, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.07s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.08s/it]                                               {'loss': 1.712, 'grad_norm': 5.142204284667969, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.09s/it]                                               {'loss': 1.6511, 'grad_norm': 3.9257023334503174, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.09s/it]100%|██████████| 40/40 [00:41<00:00,  1.21it/s]                                               {'loss': 1.849, 'grad_norm': 17.6732120513916, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.21it/s]                                               {'train_runtime': 41.3118, 'train_samples_per_second': 13.676, 'train_steps_per_second': 0.968, 'train_loss': 1.9007427453994752, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.21it/s]100%|██████████| 40/40 [00:41<00:00,  1.03s/it]
CLIENT:56
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.10s/it]                                              {'loss': 2.429, 'grad_norm': 4.771684646606445, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.10s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 2.1122, 'grad_norm': 4.79799747467041, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:41,  1.12s/it]                                              {'loss': 2.1122, 'grad_norm': 6.128494739532471, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.12s/it] 10%|█         | 4/40 [00:04<00:41,  1.14s/it]                                              {'loss': 2.4838, 'grad_norm': 4.8241868019104, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.14s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.02, 'grad_norm': 4.6843061447143555, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.2007, 'grad_norm': 4.174692630767822, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.1971, 'grad_norm': 4.439114570617676, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:34,  1.07s/it]                                              {'loss': 3.1644, 'grad_norm': 26.255151748657227, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:34,  1.07s/it] 22%|██▎       | 9/40 [00:09<00:33,  1.09s/it]                                              {'loss': 2.2799, 'grad_norm': 4.982181549072266, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:10<00:33,  1.09s/it] 25%|██▌       | 10/40 [00:11<00:33,  1.11s/it]                                               {'loss': 1.8744, 'grad_norm': 3.7684459686279297, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:33,  1.11s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.12s/it]                                               {'loss': 1.7362, 'grad_norm': 3.8877944946289062, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.12s/it] 30%|███       | 12/40 [00:13<00:31,  1.13s/it]                                               {'loss': 2.0563, 'grad_norm': 5.1665940284729, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.13s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it]                                               {'loss': 2.438, 'grad_norm': 6.020510673522949, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.11s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it]                                               {'loss': 2.0567, 'grad_norm': 5.37031888961792, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it]                                               {'loss': 1.7999, 'grad_norm': 4.767488956451416, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it] 40%|████      | 16/40 [00:16<00:20,  1.18it/s]                                               {'loss': 2.1217, 'grad_norm': 26.93805694580078, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.18it/s] 42%|████▎     | 17/40 [00:18<00:21,  1.08it/s]                                               {'loss': 1.833, 'grad_norm': 4.386385440826416, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:19<00:21,  1.03it/s]                                               {'loss': 1.843, 'grad_norm': 4.362404823303223, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:21,  1.03it/s] 48%|████▊     | 19/40 [00:20<00:21,  1.02s/it]                                               {'loss': 2.1204, 'grad_norm': 4.652678489685059, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.02s/it] 50%|█████     | 20/40 [00:21<00:20,  1.03s/it]                                               {'loss': 1.7977, 'grad_norm': 5.044375896453857, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:20,  1.03s/it] 52%|█████▎    | 21/40 [00:22<00:18,  1.01it/s]                                               {'loss': 1.7385, 'grad_norm': 4.697843551635742, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:18,  1.01it/s] 55%|█████▌    | 22/40 [00:23<00:17,  1.04it/s]                                               {'loss': 2.158, 'grad_norm': 4.5357584953308105, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:17,  1.04it/s] 57%|█████▊    | 23/40 [00:24<00:16,  1.04it/s]                                               {'loss': 2.0988, 'grad_norm': 5.947981357574463, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:16,  1.04it/s] 60%|██████    | 24/40 [00:24<00:11,  1.39it/s]                                               {'loss': 1.1798, 'grad_norm': 13.578900337219238, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:11,  1.39it/s] 62%|██████▎   | 25/40 [00:25<00:12,  1.19it/s]                                               {'loss': 1.6969, 'grad_norm': 3.8656272888183594, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:12,  1.19it/s] 65%|██████▌   | 26/40 [00:26<00:12,  1.10it/s]                                               {'loss': 1.9105, 'grad_norm': 37.27690124511719, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:12,  1.10it/s] 68%|██████▊   | 27/40 [00:27<00:12,  1.04it/s]                                               {'loss': 1.8732, 'grad_norm': 4.461418151855469, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:12,  1.04it/s] 70%|███████   | 28/40 [00:28<00:12,  1.02s/it]                                               {'loss': 1.8207, 'grad_norm': 4.273892879486084, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.02s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.04s/it]                                               {'loss': 1.8331, 'grad_norm': 4.302566051483154, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.04s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.06s/it]                                               {'loss': 1.9768, 'grad_norm': 4.833716869354248, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.06s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.07s/it]                                               {'loss': 1.623, 'grad_norm': 5.740324974060059, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.07s/it] 80%|████████  | 32/40 [00:32<00:06,  1.22it/s]                                               {'loss': 2.6087, 'grad_norm': 16.8541202545166, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.22it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.11it/s]                                               {'loss': 1.8371, 'grad_norm': 5.6338019371032715, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.11it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s]                                               {'loss': 1.7794, 'grad_norm': 4.476293563842773, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.01s/it]                                               {'loss': 1.7703, 'grad_norm': 4.148697853088379, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.01s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.03s/it]                                               {'loss': 1.9371, 'grad_norm': 4.830663681030273, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.03s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it]                                               {'loss': 1.7406, 'grad_norm': 3.73744797706604, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.04s/it]                                               {'loss': 1.9353, 'grad_norm': 16.26241111755371, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.04s/it] 98%|█████████▊| 39/40 [00:39<00:00,  1.05it/s]                                               {'loss': 1.8154, 'grad_norm': 4.404088973999023, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:00,  1.05it/s]100%|██████████| 40/40 [00:39<00:00,  1.43it/s]                                               {'loss': 1.3682, 'grad_norm': 16.849157333374023, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.43it/s]                                               {'train_runtime': 39.7604, 'train_samples_per_second': 14.21, 'train_steps_per_second': 1.006, 'train_loss': 1.9844481289386748, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.43it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]                                              {'loss': 2.0359, 'grad_norm': 5.8653564453125, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]                                              {'loss': 2.1907, 'grad_norm': 4.652010440826416, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]  8%|▊         | 3/40 [00:03<00:42,  1.14s/it]                                              {'loss': 2.0396, 'grad_norm': 4.388416290283203, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.14s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 2.1497, 'grad_norm': 4.893036842346191, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.1247, 'grad_norm': 5.422336578369141, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it]                                              {'loss': 2.1154, 'grad_norm': 4.707418441772461, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.13s/it] 18%|█▊        | 7/40 [00:07<00:35,  1.08s/it]                                              {'loss': 2.0658, 'grad_norm': 3.9217264652252197, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:35,  1.08s/it] 20%|██        | 8/40 [00:08<00:33,  1.06s/it]                                              {'loss': 2.2569, 'grad_norm': 20.287458419799805, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:33,  1.06s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it]                                              {'loss': 1.8871, 'grad_norm': 4.4491987228393555, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.05s/it] 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it]                                               {'loss': 1.903, 'grad_norm': 4.468075275421143, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:32,  1.08s/it] 28%|██▊       | 11/40 [00:12<00:31,  1.09s/it]                                               {'loss': 1.8742, 'grad_norm': 4.258096694946289, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:31,  1.09s/it] 30%|███       | 12/40 [00:13<00:31,  1.11s/it]                                               {'loss': 1.7351, 'grad_norm': 3.9788622856140137, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.11s/it] 32%|███▎      | 13/40 [00:14<00:28,  1.05s/it]                                               {'loss': 1.7058, 'grad_norm': 4.218009948730469, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:28,  1.05s/it] 35%|███▌      | 14/40 [00:15<00:26,  1.02s/it]                                               {'loss': 1.7002, 'grad_norm': 4.589210510253906, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:26,  1.02s/it] 38%|███▊      | 15/40 [00:15<00:24,  1.01it/s]                                               {'loss': 2.143, 'grad_norm': 5.770290374755859, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:24,  1.01it/s] 40%|████      | 16/40 [00:16<00:17,  1.37it/s]                                               {'loss': 2.6655, 'grad_norm': 33.482730865478516, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:17,  1.37it/s] 42%|████▎     | 17/40 [00:17<00:19,  1.17it/s]                                               {'loss': 1.6798, 'grad_norm': 6.898596286773682, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:19,  1.17it/s] 45%|████▌     | 18/40 [00:18<00:20,  1.08it/s]                                               {'loss': 1.6147, 'grad_norm': 3.700700521469116, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:20,  1.08it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.01it/s]                                               {'loss': 1.6831, 'grad_norm': 3.874290704727173, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.01it/s] 50%|█████     | 20/40 [00:20<00:20,  1.02s/it]                                               {'loss': 2.0175, 'grad_norm': 4.894030570983887, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.02s/it] 52%|█████▎    | 21/40 [00:21<00:18,  1.01it/s]                                               {'loss': 1.744, 'grad_norm': 11.789258003234863, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:18,  1.01it/s] 55%|█████▌    | 22/40 [00:22<00:17,  1.04it/s]                                               {'loss': 2.0481, 'grad_norm': 4.598308086395264, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:17,  1.04it/s] 57%|█████▊    | 23/40 [00:23<00:16,  1.02it/s]                                               {'loss': 1.7073, 'grad_norm': 6.058797836303711, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:16,  1.02it/s] 60%|██████    | 24/40 [00:23<00:11,  1.34it/s]                                               {'loss': 0.929, 'grad_norm': 11.824200630187988, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:11,  1.34it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.16it/s]                                               {'loss': 1.6824, 'grad_norm': 4.1872735023498535, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.16it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.07it/s]                                               {'loss': 1.8066, 'grad_norm': 5.340151309967041, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.07it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.00it/s]                                               {'loss': 1.8968, 'grad_norm': 5.240320205688477, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.00it/s] 70%|███████   | 28/40 [00:28<00:12,  1.04s/it]                                               {'loss': 1.7134, 'grad_norm': 4.802275657653809, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.04s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it]                                               {'loss': 1.4777, 'grad_norm': 3.7912938594818115, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.06s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.08s/it]                                               {'loss': 1.7053, 'grad_norm': 4.848392963409424, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.08s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.07s/it]                                               {'loss': 1.5957, 'grad_norm': 3.654250383377075, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.07s/it] 80%|████████  | 32/40 [00:31<00:06,  1.21it/s]                                               {'loss': 2.1195, 'grad_norm': 18.84261703491211, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.21it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.16it/s]                                               {'loss': 1.6809, 'grad_norm': 4.472285747528076, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.16it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.13it/s]                                               {'loss': 1.6038, 'grad_norm': 4.196418762207031, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.13it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.12it/s]                                               {'loss': 1.7378, 'grad_norm': 4.616835594177246, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.12it/s] 90%|█████████ | 36/40 [00:35<00:03,  1.10it/s]                                               {'loss': 1.5655, 'grad_norm': 4.107186794281006, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:03,  1.10it/s] 92%|█████████▎| 37/40 [00:36<00:02,  1.02it/s]                                               {'loss': 1.5335, 'grad_norm': 3.7031331062316895, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:02,  1.02it/s] 95%|█████████▌| 38/40 [00:37<00:02,  1.02s/it]                                               {'loss': 1.6071, 'grad_norm': 5.482964038848877, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.02s/it] 98%|█████████▊| 39/40 [00:38<00:01,  1.05s/it]                                               {'loss': 1.6919, 'grad_norm': 4.3202714920043945, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:01,  1.05s/it]100%|██████████| 40/40 [00:38<00:00,  1.26it/s]                                               {'loss': 0.6702, 'grad_norm': 11.187789916992188, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.26it/s]                                               {'train_runtime': 39.136, 'train_samples_per_second': 14.437, 'train_steps_per_second': 1.022, 'train_loss': 1.8026023507118225, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.26it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.07s/it]                                              {'loss': 2.1406, 'grad_norm': 3.77807354927063, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:41,  1.07s/it]  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]                                              {'loss': 2.419, 'grad_norm': 4.995450019836426, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]  8%|▊         | 3/40 [00:03<00:40,  1.10s/it]                                              {'loss': 2.0796, 'grad_norm': 4.630264759063721, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:40,  1.10s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 2.1652, 'grad_norm': 4.565413475036621, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.234, 'grad_norm': 6.1553144454956055, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 2.2533, 'grad_norm': 5.093695640563965, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:34,  1.04s/it]                                              {'loss': 2.0875, 'grad_norm': 4.19832706451416, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:34,  1.04s/it] 20%|██        | 8/40 [00:07<00:24,  1.31it/s]                                              {'loss': 1.9788, 'grad_norm': 16.514795303344727, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:24,  1.31it/s] 22%|██▎       | 9/40 [00:08<00:25,  1.22it/s]                                              {'loss': 1.6642, 'grad_norm': 3.2965335845947266, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:25,  1.22it/s] 25%|██▌       | 10/40 [00:09<00:27,  1.10it/s]                                               {'loss': 1.8209, 'grad_norm': 4.092380523681641, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:27,  1.10it/s] 28%|██▊       | 11/40 [00:10<00:28,  1.02it/s]                                               {'loss': 2.0574, 'grad_norm': 4.736904144287109, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:28,  1.02it/s] 30%|███       | 12/40 [00:12<00:28,  1.02s/it]                                               {'loss': 1.9139, 'grad_norm': 3.2891783714294434, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:28,  1.02s/it] 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it]                                               {'loss': 2.3027, 'grad_norm': 4.437673091888428, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it] 35%|███▌      | 14/40 [00:14<00:27,  1.07s/it]                                               {'loss': 2.1013, 'grad_norm': 5.559964656829834, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:27,  1.07s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it]                                               {'loss': 2.0418, 'grad_norm': 4.0501861572265625, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it] 40%|████      | 16/40 [00:15<00:19,  1.22it/s]                                               {'loss': 3.1787, 'grad_norm': 20.093053817749023, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.22it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.09it/s]                                               {'loss': 1.77, 'grad_norm': 3.440714120864868, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s]                                               {'loss': 1.9969, 'grad_norm': 5.634159088134766, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:18<00:21,  1.02s/it]                                               {'loss': 2.0987, 'grad_norm': 4.01555871963501, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.02s/it] 50%|█████     | 20/40 [00:20<00:21,  1.05s/it]                                               {'loss': 1.7764, 'grad_norm': 3.6773900985717773, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.05s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.08s/it]                                               {'loss': 1.7259, 'grad_norm': 3.517054319381714, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.08s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it]                                               {'loss': 1.8594, 'grad_norm': 3.8935301303863525, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it]                                               {'loss': 2.1313, 'grad_norm': 5.122671127319336, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it] 60%|██████    | 24/40 [00:23<00:13,  1.20it/s]                                               {'loss': 1.0633, 'grad_norm': 14.007707595825195, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.09it/s]                                               {'loss': 1.8005, 'grad_norm': 3.6263959407806396, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.08it/s]                                               {'loss': 1.5265, 'grad_norm': 3.880030393600464, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.08it/s] 68%|██████▊   | 27/40 [00:26<00:11,  1.08it/s]                                               {'loss': 2.0908, 'grad_norm': 5.351356029510498, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:11,  1.08it/s] 70%|███████   | 28/40 [00:27<00:11,  1.08it/s]                                               {'loss': 1.7623, 'grad_norm': 4.089812755584717, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.08it/s] 72%|███████▎  | 29/40 [00:28<00:10,  1.01it/s]                                               {'loss': 1.8986, 'grad_norm': 4.059965133666992, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:10,  1.01it/s] 75%|███████▌  | 30/40 [00:29<00:10,  1.00s/it]                                               {'loss': 1.761, 'grad_norm': 5.049561500549316, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:10,  1.00s/it] 78%|███████▊  | 31/40 [00:30<00:09,  1.03s/it]                                               {'loss': 1.7186, 'grad_norm': 6.862611293792725, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.03s/it] 80%|████████  | 32/40 [00:31<00:06,  1.28it/s]                                               {'loss': 2.1618, 'grad_norm': 14.569964408874512, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.28it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.14it/s]                                               {'loss': 1.5999, 'grad_norm': 4.978315830230713, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.14it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.06it/s]                                               {'loss': 1.6117, 'grad_norm': 4.000438213348389, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.06it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.03it/s]                                               {'loss': 1.7902, 'grad_norm': 4.5630059242248535, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.03it/s] 90%|█████████ | 36/40 [00:35<00:04,  1.02s/it]                                               {'loss': 1.622, 'grad_norm': 3.9559171199798584, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.02s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.05s/it]                                               {'loss': 1.7429, 'grad_norm': 3.8223578929901123, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.05s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.06s/it]                                               {'loss': 1.8733, 'grad_norm': 4.248195648193359, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.06s/it] 98%|█████████▊| 39/40 [00:38<00:01,  1.07s/it]                                               {'loss': 1.7655, 'grad_norm': 3.6502633094787598, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:01,  1.07s/it]100%|██████████| 40/40 [00:38<00:00,  1.23it/s]                                               {'loss': 1.406, 'grad_norm': 16.1168155670166, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.23it/s]                                               {'train_runtime': 39.1135, 'train_samples_per_second': 14.445, 'train_steps_per_second': 1.023, 'train_loss': 1.9248070508241653, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.23it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:36,  1.06it/s]                                              {'loss': 2.0137, 'grad_norm': 5.379692554473877, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:36,  1.06it/s]  5%|▌         | 2/40 [00:01<00:37,  1.00it/s]                                              {'loss': 2.291, 'grad_norm': 5.087287902832031, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:37,  1.00it/s]  8%|▊         | 3/40 [00:03<00:39,  1.06s/it]                                              {'loss': 2.1634, 'grad_norm': 4.291911602020264, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:39,  1.06s/it] 10%|█         | 4/40 [00:04<00:38,  1.07s/it]                                              {'loss': 2.4331, 'grad_norm': 4.68233060836792, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:38,  1.07s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it]                                              {'loss': 2.2943, 'grad_norm': 6.435094833374023, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 2.205, 'grad_norm': 5.1429924964904785, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it]                                              {'loss': 2.1091, 'grad_norm': 3.9065258502960205, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it] 20%|██        | 8/40 [00:07<00:26,  1.21it/s]                                              {'loss': 1.4558, 'grad_norm': 10.687660217285156, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:26,  1.21it/s] 22%|██▎       | 9/40 [00:08<00:28,  1.08it/s]                                              {'loss': 1.9442, 'grad_norm': 4.803721904754639, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:28,  1.08it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s]                                               {'loss': 2.0935, 'grad_norm': 4.785817623138428, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it]                                               {'loss': 2.0403, 'grad_norm': 4.116029739379883, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it] 30%|███       | 12/40 [00:12<00:29,  1.06s/it]                                               {'loss': 2.0264, 'grad_norm': 3.659348249435425, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 1.9387, 'grad_norm': 4.22584867477417, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.09s/it]                                               {'loss': 2.2621, 'grad_norm': 5.179655075073242, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.09s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.11s/it]                                               {'loss': 1.9919, 'grad_norm': 4.722723007202148, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.11s/it] 40%|████      | 16/40 [00:15<00:19,  1.20it/s]                                               {'loss': 1.7699, 'grad_norm': 14.791969299316406, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.20it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s]                                               {'loss': 1.8742, 'grad_norm': 3.797654628753662, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:18<00:20,  1.05it/s]                                               {'loss': 1.9359, 'grad_norm': 4.323974132537842, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:20,  1.05it/s] 48%|████▊     | 19/40 [00:18<00:19,  1.07it/s]                                               {'loss': 2.1966, 'grad_norm': 4.296843528747559, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:19,  1.07it/s] 50%|█████     | 20/40 [00:19<00:18,  1.06it/s]                                               {'loss': 1.9122, 'grad_norm': 4.876348972320557, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:18,  1.06it/s] 52%|█████▎    | 21/40 [00:20<00:18,  1.04it/s]                                               {'loss': 2.1889, 'grad_norm': 4.611234188079834, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:18,  1.04it/s] 55%|█████▌    | 22/40 [00:22<00:18,  1.02s/it]                                               {'loss': 1.7071, 'grad_norm': 5.174328327178955, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.02s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.06s/it]                                               {'loss': 1.9389, 'grad_norm': 4.238519191741943, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.06s/it] 60%|██████    | 24/40 [00:23<00:12,  1.25it/s]                                               {'loss': 1.0862, 'grad_norm': 9.878100395202637, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.25it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.11it/s]                                               {'loss': 1.6973, 'grad_norm': 4.628968715667725, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.11it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.03it/s]                                               {'loss': 1.918, 'grad_norm': 3.882164239883423, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.03it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.03s/it]                                               {'loss': 2.0979, 'grad_norm': 3.6690640449523926, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.03s/it] 70%|███████   | 28/40 [00:27<00:12,  1.05s/it]                                               {'loss': 1.8587, 'grad_norm': 4.589531421661377, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.09s/it]                                               {'loss': 1.9117, 'grad_norm': 4.106395721435547, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.09s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.09s/it]                                               {'loss': 1.6265, 'grad_norm': 4.191219329833984, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.11s/it]                                               {'loss': 1.7063, 'grad_norm': 4.743565082550049, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.11s/it] 80%|████████  | 32/40 [00:31<00:06,  1.20it/s]                                               {'loss': 1.3705, 'grad_norm': 15.300619125366211, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.08it/s]                                               {'loss': 1.7638, 'grad_norm': 5.824615001678467, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s]                                               {'loss': 1.7644, 'grad_norm': 4.14061164855957, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.02it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it]                                               {'loss': 1.7554, 'grad_norm': 7.840557098388672, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.07s/it]                                               {'loss': 1.6537, 'grad_norm': 3.89628005027771, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.04s/it]                                               {'loss': 1.7305, 'grad_norm': 4.664515972137451, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.04s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.01s/it]                                               {'loss': 1.87, 'grad_norm': 5.7768683433532715, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.01s/it] 98%|█████████▊| 39/40 [00:38<00:00,  1.01it/s]                                               {'loss': 1.769, 'grad_norm': 4.742091178894043, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:00,  1.01it/s]100%|██████████| 40/40 [00:39<00:00,  1.37it/s]                                               {'loss': 2.172, 'grad_norm': 15.354029655456543, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.37it/s]                                               {'train_runtime': 39.2462, 'train_samples_per_second': 14.396, 'train_steps_per_second': 1.019, 'train_loss': 1.9134632617235183, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.37it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
CLIENT:60
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 2.1069, 'grad_norm': 3.7424352169036865, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 2.394, 'grad_norm': 4.607851028442383, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:42,  1.15s/it]                                              {'loss': 2.1702, 'grad_norm': 5.379757404327393, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.15s/it] 10%|█         | 4/40 [00:04<00:39,  1.09s/it]                                              {'loss': 2.1399, 'grad_norm': 4.270248889923096, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.09s/it] 12%|█▎        | 5/40 [00:05<00:36,  1.05s/it]                                              {'loss': 2.2839, 'grad_norm': 5.409762859344482, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:36,  1.05s/it] 15%|█▌        | 6/40 [00:06<00:32,  1.05it/s]                                              {'loss': 2.2212, 'grad_norm': 7.0030741691589355, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:32,  1.05it/s] 18%|█▊        | 7/40 [00:07<00:30,  1.09it/s]                                              {'loss': 2.0718, 'grad_norm': 4.323127746582031, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:30,  1.09it/s] 20%|██        | 8/40 [00:07<00:21,  1.49it/s]                                              {'loss': 2.5215, 'grad_norm': 16.011302947998047, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:21,  1.49it/s] 22%|██▎       | 9/40 [00:08<00:24,  1.24it/s]                                              {'loss': 1.9535, 'grad_norm': 3.505079984664917, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:24,  1.24it/s] 25%|██▌       | 10/40 [00:09<00:27,  1.11it/s]                                               {'loss': 2.0118, 'grad_norm': 4.012732028961182, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:27,  1.11it/s] 28%|██▊       | 11/40 [00:10<00:28,  1.01it/s]                                               {'loss': 1.8339, 'grad_norm': 6.415308475494385, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:28,  1.01it/s] 30%|███       | 12/40 [00:11<00:28,  1.01s/it]                                               {'loss': 2.2411, 'grad_norm': 5.882437229156494, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:28,  1.01s/it] 32%|███▎      | 13/40 [00:12<00:27,  1.00s/it]                                               {'loss': 2.1047, 'grad_norm': 3.66296124458313, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:12<00:27,  1.00s/it] 35%|███▌      | 14/40 [00:13<00:26,  1.01s/it]                                               {'loss': 1.8772, 'grad_norm': 5.347818851470947, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:26,  1.01s/it] 38%|███▊      | 15/40 [00:14<00:26,  1.06s/it]                                               {'loss': 2.1658, 'grad_norm': 4.839022159576416, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:26,  1.06s/it] 40%|████      | 16/40 [00:15<00:19,  1.25it/s]                                               {'loss': 2.362, 'grad_norm': 16.159221649169922, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.25it/s] 42%|████▎     | 17/40 [00:16<00:20,  1.10it/s]                                               {'loss': 1.8251, 'grad_norm': 5.744626522064209, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:20,  1.10it/s] 45%|████▌     | 18/40 [00:17<00:20,  1.07it/s]                                               {'loss': 1.8587, 'grad_norm': 4.708234786987305, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:20,  1.07it/s] 48%|████▊     | 19/40 [00:18<00:19,  1.05it/s]                                               {'loss': 1.6645, 'grad_norm': 4.3013224601745605, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:19,  1.05it/s] 50%|█████     | 20/40 [00:19<00:19,  1.02it/s]                                               {'loss': 1.878, 'grad_norm': 5.608950138092041, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:19,  1.02it/s] 52%|█████▎    | 21/40 [00:20<00:19,  1.04s/it]                                               {'loss': 2.1964, 'grad_norm': 3.757552146911621, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:19,  1.04s/it] 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it]                                               {'loss': 1.9772, 'grad_norm': 4.060491561889648, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it] 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it]                                               {'loss': 1.8743, 'grad_norm': 5.018163681030273, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it] 60%|██████    | 24/40 [00:22<00:13,  1.21it/s]                                               {'loss': 1.6445, 'grad_norm': 24.836074829101562, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:24<00:14,  1.07it/s]                                               {'loss': 1.9088, 'grad_norm': 4.652676105499268, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:14,  1.07it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.00it/s]                                               {'loss': 1.9219, 'grad_norm': 4.153800964355469, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.00it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.05s/it]                                               {'loss': 1.8956, 'grad_norm': 4.286927700042725, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.05s/it] 70%|███████   | 28/40 [00:27<00:13,  1.09s/it]                                               {'loss': 1.7083, 'grad_norm': 4.475820064544678, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:13,  1.09s/it] 72%|███████▎  | 29/40 [00:28<00:12,  1.12s/it]                                               {'loss': 1.5512, 'grad_norm': 4.8629069328308105, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:12,  1.12s/it] 75%|███████▌  | 30/40 [00:29<00:11,  1.11s/it]                                               {'loss': 1.9634, 'grad_norm': 4.715094566345215, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:11,  1.11s/it] 78%|███████▊  | 31/40 [00:30<00:09,  1.08s/it]                                               {'loss': 1.8646, 'grad_norm': 4.041327476501465, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.08s/it] 80%|████████  | 32/40 [00:31<00:06,  1.25it/s]                                               {'loss': 1.4998, 'grad_norm': 13.783086776733398, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.25it/s] 82%|████████▎ | 33/40 [00:31<00:05,  1.23it/s]                                               {'loss': 1.7276, 'grad_norm': 3.408860921859741, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:31<00:05,  1.23it/s] 85%|████████▌ | 34/40 [00:32<00:05,  1.16it/s]                                               {'loss': 1.7189, 'grad_norm': 4.6060791015625, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:32<00:05,  1.16it/s] 88%|████████▊ | 35/40 [00:33<00:04,  1.09it/s]                                               {'loss': 1.8148, 'grad_norm': 4.694262504577637, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:33<00:04,  1.09it/s] 90%|█████████ | 36/40 [00:35<00:03,  1.00it/s]                                               {'loss': 1.605, 'grad_norm': 3.6447064876556396, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:03,  1.00it/s] 92%|█████████▎| 37/40 [00:36<00:03,  1.05s/it]                                               {'loss': 1.98, 'grad_norm': 7.2704572677612305, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.05s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.09s/it]                                               {'loss': 1.5287, 'grad_norm': 3.738819122314453, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.09s/it] 98%|█████████▊| 39/40 [00:38<00:01,  1.13s/it]                                               {'loss': 1.7214, 'grad_norm': 4.542004585266113, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:01,  1.13s/it]100%|██████████| 40/40 [00:38<00:00,  1.18it/s]                                               {'loss': 2.2432, 'grad_norm': 16.322622299194336, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.18it/s]                                               {'train_runtime': 38.9857, 'train_samples_per_second': 14.492, 'train_steps_per_second': 1.026, 'train_loss': 1.950779166817665, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.18it/s]100%|██████████| 40/40 [00:38<00:00,  1.03it/s]
CLIENT:67
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:46,  1.19s/it]                                              {'loss': 2.2502, 'grad_norm': 6.26630163192749, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:46,  1.19s/it]  5%|▌         | 2/40 [00:02<00:45,  1.19s/it]                                              {'loss': 1.9037, 'grad_norm': 4.932624340057373, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:45,  1.19s/it]  8%|▊         | 3/40 [00:03<00:43,  1.19s/it]                                              {'loss': 1.993, 'grad_norm': 3.9442574977874756, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:43,  1.19s/it] 10%|█         | 4/40 [00:04<00:42,  1.18s/it]                                              {'loss': 2.4118, 'grad_norm': 5.303799629211426, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:42,  1.18s/it] 12%|█▎        | 5/40 [00:05<00:41,  1.18s/it]                                              {'loss': 2.4454, 'grad_norm': 5.2053656578063965, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:41,  1.18s/it] 15%|█▌        | 6/40 [00:07<00:40,  1.19s/it]                                              {'loss': 2.0604, 'grad_norm': 4.957117080688477, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:40,  1.19s/it] 18%|█▊        | 7/40 [00:08<00:39,  1.18s/it]                                              {'loss': 2.3279, 'grad_norm': 5.7741289138793945, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:39,  1.18s/it] 20%|██        | 8/40 [00:08<00:30,  1.03it/s]                                              {'loss': 2.7195, 'grad_norm': 20.28935432434082, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:30,  1.03it/s] 22%|██▎       | 9/40 [00:09<00:32,  1.03s/it]                                              {'loss': 1.8342, 'grad_norm': 3.3791966438293457, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.03s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.08s/it]                                               {'loss': 1.8447, 'grad_norm': 3.548776865005493, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.08s/it] 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it]                                               {'loss': 2.1144, 'grad_norm': 4.847224235534668, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:32,  1.11s/it] 30%|███       | 12/40 [00:13<00:31,  1.12s/it]                                               {'loss': 1.7977, 'grad_norm': 7.181549072265625, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.12s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.14s/it]                                               {'loss': 2.1791, 'grad_norm': 3.713954448699951, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.14s/it] 35%|███▌      | 14/40 [00:15<00:30,  1.16s/it]                                               {'loss': 1.8655, 'grad_norm': 3.6317200660705566, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:30,  1.16s/it] 38%|███▊      | 15/40 [00:17<00:29,  1.17s/it]                                               {'loss': 2.1554, 'grad_norm': 4.260515213012695, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:17<00:29,  1.17s/it] 40%|████      | 16/40 [00:17<00:21,  1.14it/s]                                               {'loss': 2.2639, 'grad_norm': 17.78104019165039, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:17<00:21,  1.14it/s] 42%|████▎     | 17/40 [00:18<00:22,  1.04it/s]                                               {'loss': 2.1229, 'grad_norm': 4.956887245178223, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:22,  1.04it/s] 45%|████▌     | 18/40 [00:19<00:22,  1.02s/it]                                               {'loss': 1.9605, 'grad_norm': 3.8988051414489746, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:22,  1.02s/it] 48%|████▊     | 19/40 [00:20<00:22,  1.07s/it]                                               {'loss': 1.9683, 'grad_norm': 3.598876953125, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:22,  1.07s/it] 50%|█████     | 20/40 [00:21<00:22,  1.11s/it]                                               {'loss': 1.6569, 'grad_norm': 3.8407390117645264, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:22,  1.11s/it] 52%|█████▎    | 21/40 [00:23<00:21,  1.13s/it]                                               {'loss': 1.8036, 'grad_norm': 3.800887107849121, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:23<00:21,  1.13s/it] 55%|█████▌    | 22/40 [00:24<00:20,  1.14s/it]                                               {'loss': 1.9703, 'grad_norm': 3.990706443786621, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:24<00:20,  1.14s/it] 57%|█████▊    | 23/40 [00:25<00:19,  1.16s/it]                                               {'loss': 1.6528, 'grad_norm': 4.321983337402344, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:25<00:19,  1.16s/it] 60%|██████    | 24/40 [00:25<00:13,  1.15it/s]                                               {'loss': 1.4429, 'grad_norm': 19.06429100036621, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.15it/s] 62%|██████▎   | 25/40 [00:26<00:14,  1.03it/s]                                               {'loss': 1.9049, 'grad_norm': 4.496976375579834, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:14,  1.03it/s] 65%|██████▌   | 26/40 [00:28<00:14,  1.03s/it]                                               {'loss': 1.7094, 'grad_norm': 5.462456703186035, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:28<00:14,  1.03s/it] 68%|██████▊   | 27/40 [00:29<00:13,  1.07s/it]                                               {'loss': 1.6958, 'grad_norm': 3.4443917274475098, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:29<00:13,  1.07s/it] 70%|███████   | 28/40 [00:30<00:13,  1.11s/it]                                               {'loss': 2.0935, 'grad_norm': 4.1312055587768555, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:30<00:13,  1.11s/it] 72%|███████▎  | 29/40 [00:31<00:12,  1.13s/it]                                               {'loss': 1.4754, 'grad_norm': 3.506063461303711, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:31<00:12,  1.13s/it] 75%|███████▌  | 30/40 [00:32<00:11,  1.14s/it]                                               {'loss': 1.8175, 'grad_norm': 6.908819675445557, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:32<00:11,  1.14s/it] 78%|███████▊  | 31/40 [00:33<00:10,  1.12s/it]                                               {'loss': 1.7508, 'grad_norm': 3.558027505874634, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:33<00:10,  1.12s/it] 80%|████████  | 32/40 [00:34<00:06,  1.20it/s]                                               {'loss': 2.4581, 'grad_norm': 18.337244033813477, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:34<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:34<00:05,  1.19it/s]                                               {'loss': 1.8628, 'grad_norm': 4.053972244262695, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:05,  1.19it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.14it/s]                                               {'loss': 1.4996, 'grad_norm': 4.152329444885254, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.14it/s] 88%|████████▊ | 35/40 [00:36<00:04,  1.08it/s]                                               {'loss': 1.6574, 'grad_norm': 3.6981115341186523, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:04,  1.08it/s] 90%|█████████ | 36/40 [00:38<00:04,  1.00s/it]                                               {'loss': 1.886, 'grad_norm': 4.179479598999023, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:38<00:04,  1.00s/it] 92%|█████████▎| 37/40 [00:39<00:03,  1.05s/it]                                               {'loss': 1.562, 'grad_norm': 3.615633487701416, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:39<00:03,  1.05s/it] 95%|█████████▌| 38/40 [00:40<00:02,  1.09s/it]                                               {'loss': 1.8726, 'grad_norm': 4.311436176300049, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:40<00:02,  1.09s/it] 98%|█████████▊| 39/40 [00:41<00:01,  1.11s/it]                                               {'loss': 1.5868, 'grad_norm': 4.414585113525391, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:41<00:01,  1.11s/it]100%|██████████| 40/40 [00:41<00:00,  1.19it/s]                                               {'loss': 2.5549, 'grad_norm': 25.481037139892578, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.19it/s]                                               {'train_runtime': 41.9287, 'train_samples_per_second': 13.475, 'train_steps_per_second': 0.954, 'train_loss': 1.953313300013542, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.19it/s]100%|██████████| 40/40 [00:41<00:00,  1.05s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:46,  4.40it/s]  1%|          | 3/471 [00:00<02:47,  2.79it/s]  1%|          | 4/471 [00:01<03:23,  2.29it/s]  1%|          | 5/471 [00:02<03:46,  2.05it/s]  1%|▏         | 6/471 [00:02<03:58,  1.95it/s]  1%|▏         | 7/471 [00:03<04:05,  1.89it/s]  2%|▏         | 8/471 [00:03<04:07,  1.87it/s]  2%|▏         | 9/471 [00:04<04:10,  1.85it/s]  2%|▏         | 10/471 [00:04<04:13,  1.82it/s]  2%|▏         | 11/471 [00:05<04:15,  1.80it/s]  3%|▎         | 12/471 [00:06<04:16,  1.79it/s]  3%|▎         | 13/471 [00:06<04:17,  1.78it/s]  3%|▎         | 14/471 [00:07<04:11,  1.82it/s]  3%|▎         | 15/471 [00:07<04:13,  1.80it/s]  3%|▎         | 16/471 [00:08<04:15,  1.78it/s]  4%|▎         | 17/471 [00:08<04:16,  1.77it/s]  4%|▍         | 18/471 [00:09<04:15,  1.77it/s]  4%|▍         | 19/471 [00:10<04:14,  1.78it/s]  4%|▍         | 20/471 [00:10<04:08,  1.82it/s]  4%|▍         | 21/471 [00:11<04:12,  1.78it/s]  5%|▍         | 22/471 [00:11<04:13,  1.77it/s]  5%|▍         | 23/471 [00:12<04:13,  1.77it/s]  5%|▌         | 24/471 [00:12<04:14,  1.76it/s]  5%|▌         | 25/471 [00:13<04:07,  1.80it/s]  6%|▌         | 26/471 [00:13<04:03,  1.82it/s]  6%|▌         | 27/471 [00:14<03:53,  1.90it/s]  6%|▌         | 28/471 [00:14<03:47,  1.95it/s]  6%|▌         | 29/471 [00:15<03:40,  2.01it/s]  6%|▋         | 30/471 [00:15<03:37,  2.03it/s]  7%|▋         | 31/471 [00:16<03:32,  2.07it/s]  7%|▋         | 32/471 [00:16<03:38,  2.01it/s]  7%|▋         | 33/471 [00:17<03:37,  2.01it/s]  7%|▋         | 34/471 [00:17<03:46,  1.93it/s]  7%|▋         | 35/471 [00:18<03:53,  1.87it/s]  8%|▊         | 36/471 [00:18<03:56,  1.84it/s]  8%|▊         | 37/471 [00:19<03:57,  1.83it/s]  8%|▊         | 38/471 [00:20<03:58,  1.82it/s]  8%|▊         | 39/471 [00:20<03:57,  1.82it/s]  8%|▊         | 40/471 [00:21<03:58,  1.81it/s]  9%|▊         | 41/471 [00:21<03:59,  1.80it/s]  9%|▉         | 42/471 [00:22<03:58,  1.80it/s]  9%|▉         | 43/471 [00:22<03:58,  1.79it/s]  9%|▉         | 44/471 [00:23<03:55,  1.81it/s] 10%|▉         | 45/471 [00:24<03:58,  1.79it/s] 10%|▉         | 46/471 [00:24<03:59,  1.78it/s] 10%|▉         | 47/471 [00:25<03:56,  1.79it/s] 10%|█         | 48/471 [00:25<03:55,  1.80it/s] 10%|█         | 49/471 [00:26<03:54,  1.80it/s] 11%|█         | 50/471 [00:26<03:55,  1.79it/s] 11%|█         | 51/471 [00:27<03:57,  1.77it/s] 11%|█         | 52/471 [00:27<03:57,  1.76it/s] 11%|█▏        | 53/471 [00:28<03:53,  1.79it/s] 11%|█▏        | 54/471 [00:29<03:52,  1.79it/s] 12%|█▏        | 55/471 [00:29<03:53,  1.78it/s] 12%|█▏        | 56/471 [00:30<03:55,  1.76it/s] 12%|█▏        | 57/471 [00:30<03:53,  1.77it/s] 12%|█▏        | 58/471 [00:31<03:48,  1.81it/s] 13%|█▎        | 59/471 [00:31<03:48,  1.80it/s] 13%|█▎        | 60/471 [00:32<03:50,  1.79it/s] 13%|█▎        | 61/471 [00:32<03:49,  1.79it/s] 13%|█▎        | 62/471 [00:33<03:48,  1.79it/s] 13%|█▎        | 63/471 [00:34<03:45,  1.81it/s] 14%|█▎        | 64/471 [00:34<03:43,  1.82it/s] 14%|█▍        | 65/471 [00:35<03:47,  1.79it/s] 14%|█▍        | 66/471 [00:35<03:48,  1.78it/s] 14%|█▍        | 67/471 [00:36<03:47,  1.78it/s] 14%|█▍        | 68/471 [00:36<03:45,  1.79it/s] 15%|█▍        | 69/471 [00:37<03:41,  1.81it/s] 15%|█▍        | 70/471 [00:37<03:45,  1.78it/s] 15%|█▌        | 71/471 [00:38<03:45,  1.77it/s] 15%|█▌        | 72/471 [00:39<03:43,  1.78it/s] 15%|█▌        | 73/471 [00:39<03:42,  1.79it/s] 16%|█▌        | 74/471 [00:40<03:38,  1.82it/s] 16%|█▌        | 75/471 [00:40<03:30,  1.88it/s] 16%|█▌        | 76/471 [00:41<03:23,  1.94it/s] 16%|█▋        | 77/471 [00:41<03:18,  1.99it/s] 17%|█▋        | 78/471 [00:42<03:13,  2.03it/s] 17%|█▋        | 79/471 [00:42<03:08,  2.07it/s] 17%|█▋        | 80/471 [00:43<03:15,  2.00it/s] 17%|█▋        | 81/471 [00:43<03:09,  2.06it/s] 17%|█▋        | 82/471 [00:44<03:12,  2.02it/s] 18%|█▊        | 83/471 [00:44<03:19,  1.95it/s] 18%|█▊        | 84/471 [00:45<03:23,  1.90it/s] 18%|█▊        | 85/471 [00:45<03:26,  1.87it/s] 18%|█▊        | 86/471 [00:46<03:25,  1.88it/s] 18%|█▊        | 87/471 [00:46<03:18,  1.93it/s] 19%|█▊        | 88/471 [00:47<03:22,  1.90it/s] 19%|█▉        | 89/471 [00:47<03:21,  1.89it/s] 19%|█▉        | 90/471 [00:48<03:23,  1.87it/s] 19%|█▉        | 91/471 [00:48<03:24,  1.86it/s] 20%|█▉        | 92/471 [00:49<03:26,  1.84it/s] 20%|█▉        | 93/471 [00:50<03:28,  1.82it/s] 20%|█▉        | 94/471 [00:50<03:25,  1.83it/s] 20%|██        | 95/471 [00:51<03:23,  1.85it/s] 20%|██        | 96/471 [00:51<03:23,  1.84it/s] 21%|██        | 97/471 [00:52<03:27,  1.80it/s] 21%|██        | 98/471 [00:52<03:28,  1.79it/s] 21%|██        | 99/471 [00:53<03:26,  1.81it/s] 21%|██        | 100/471 [00:53<03:22,  1.83it/s] 21%|██▏       | 101/471 [00:54<03:17,  1.88it/s] 22%|██▏       | 102/471 [00:54<03:18,  1.86it/s] 22%|██▏       | 103/471 [00:55<03:21,  1.82it/s] 22%|██▏       | 104/471 [00:56<03:22,  1.81it/s] 22%|██▏       | 105/471 [00:56<03:21,  1.82it/s] 23%|██▎       | 106/471 [00:57<03:18,  1.84it/s] 23%|██▎       | 107/471 [00:57<03:16,  1.85it/s] 23%|██▎       | 108/471 [00:58<03:11,  1.90it/s] 23%|██▎       | 109/471 [00:58<03:12,  1.88it/s] 23%|██▎       | 110/471 [00:59<03:14,  1.86it/s] 24%|██▎       | 111/471 [00:59<03:14,  1.85it/s] 24%|██▍       | 112/471 [01:00<03:09,  1.89it/s] 24%|██▍       | 113/471 [01:00<03:00,  1.98it/s] 24%|██▍       | 114/471 [01:01<02:52,  2.06it/s] 24%|██▍       | 115/471 [01:01<02:47,  2.12it/s] 25%|██▍       | 116/471 [01:02<02:47,  2.13it/s] 25%|██▍       | 117/471 [01:02<02:46,  2.13it/s] 25%|██▌       | 118/471 [01:03<02:46,  2.12it/s] 25%|██▌       | 119/471 [01:03<02:54,  2.02it/s] 25%|██▌       | 120/471 [01:04<02:59,  1.96it/s] 26%|██▌       | 121/471 [01:04<03:02,  1.92it/s] 26%|██▌       | 122/471 [01:05<03:05,  1.88it/s] 26%|██▌       | 123/471 [01:05<03:08,  1.84it/s] 26%|██▋       | 124/471 [01:06<03:06,  1.86it/s] 27%|██▋       | 125/471 [01:06<03:07,  1.85it/s] 27%|██▋       | 126/471 [01:07<03:06,  1.85it/s] 27%|██▋       | 127/471 [01:08<03:08,  1.83it/s] 27%|██▋       | 128/471 [01:08<03:09,  1.81it/s] 27%|██▋       | 129/471 [01:09<03:09,  1.81it/s] 28%|██▊       | 130/471 [01:09<03:05,  1.84it/s] 28%|██▊       | 131/471 [01:10<03:02,  1.86it/s] 28%|██▊       | 132/471 [01:10<03:05,  1.83it/s] 28%|██▊       | 133/471 [01:11<03:05,  1.82it/s] 28%|██▊       | 134/471 [01:11<03:07,  1.80it/s] 29%|██▊       | 135/471 [01:12<03:06,  1.80it/s] 29%|██▉       | 136/471 [01:12<03:01,  1.84it/s] 29%|██▉       | 137/471 [01:13<03:01,  1.84it/s] 29%|██▉       | 138/471 [01:14<03:03,  1.82it/s] 30%|██▉       | 139/471 [01:14<03:04,  1.80it/s] 30%|██▉       | 140/471 [01:15<03:04,  1.79it/s] 30%|██▉       | 141/471 [01:15<03:00,  1.82it/s] 30%|███       | 142/471 [01:16<02:56,  1.87it/s] 30%|███       | 143/471 [01:16<02:57,  1.85it/s] 31%|███       | 144/471 [01:17<02:58,  1.83it/s] 31%|███       | 145/471 [01:17<02:56,  1.85it/s] 31%|███       | 146/471 [01:18<02:58,  1.82it/s] 31%|███       | 147/471 [01:18<02:56,  1.84it/s] 31%|███▏      | 148/471 [01:19<02:56,  1.83it/s] 32%|███▏      | 149/471 [01:19<02:50,  1.89it/s] 32%|███▏      | 150/471 [01:20<02:42,  1.98it/s] 32%|███▏      | 151/471 [01:20<02:33,  2.08it/s] 32%|███▏      | 152/471 [01:21<02:27,  2.16it/s] 32%|███▏      | 153/471 [01:21<02:26,  2.17it/s] 33%|███▎      | 154/471 [01:22<02:28,  2.13it/s] 33%|███▎      | 155/471 [01:22<02:36,  2.02it/s] 33%|███▎      | 156/471 [01:23<02:39,  1.97it/s] 33%|███▎      | 157/471 [01:23<02:42,  1.93it/s] 34%|███▎      | 158/471 [01:24<02:41,  1.94it/s] 34%|███▍      | 159/471 [01:24<02:39,  1.95it/s] 34%|███▍      | 160/471 [01:25<02:43,  1.90it/s] 34%|███▍      | 161/471 [01:25<02:46,  1.87it/s] 34%|███▍      | 162/471 [01:26<02:48,  1.84it/s] 35%|███▍      | 163/471 [01:27<02:49,  1.82it/s] 35%|███▍      | 164/471 [01:27<02:45,  1.85it/s] 35%|███▌      | 165/471 [01:28<02:45,  1.85it/s] 35%|███▌      | 166/471 [01:28<02:44,  1.85it/s] 35%|███▌      | 167/471 [01:29<02:45,  1.84it/s] 36%|███▌      | 168/471 [01:29<02:46,  1.82it/s] 36%|███▌      | 169/471 [01:30<02:45,  1.83it/s] 36%|███▌      | 170/471 [01:30<02:41,  1.87it/s] 36%|███▋      | 171/471 [01:31<02:40,  1.87it/s] 37%|███▋      | 172/471 [01:31<02:40,  1.86it/s] 37%|███▋      | 173/471 [01:32<02:41,  1.84it/s] 37%|███▋      | 174/471 [01:33<02:42,  1.83it/s] 37%|███▋      | 175/471 [01:33<02:40,  1.84it/s] 37%|███▋      | 176/471 [01:34<02:40,  1.83it/s] 38%|███▊      | 177/471 [01:34<02:41,  1.82it/s] 38%|███▊      | 178/471 [01:35<02:41,  1.81it/s] 38%|███▊      | 179/471 [01:35<02:40,  1.82it/s] 38%|███▊      | 180/471 [01:36<02:37,  1.85it/s] 38%|███▊      | 181/471 [01:36<02:37,  1.84it/s] 39%|███▊      | 182/471 [01:37<02:39,  1.81it/s] 39%|███▉      | 183/471 [01:38<02:39,  1.80it/s] 39%|███▉      | 184/471 [01:38<02:38,  1.82it/s] 39%|███▉      | 185/471 [01:39<02:29,  1.92it/s] 39%|███▉      | 186/471 [01:39<02:19,  2.05it/s] 40%|███▉      | 187/471 [01:39<02:14,  2.11it/s] 40%|███▉      | 188/471 [01:40<02:14,  2.10it/s] 40%|████      | 189/471 [01:40<02:12,  2.13it/s] 40%|████      | 190/471 [01:41<02:12,  2.11it/s] 41%|████      | 191/471 [01:41<02:11,  2.14it/s] 41%|████      | 192/471 [01:42<02:12,  2.10it/s] 41%|████      | 193/471 [01:42<02:13,  2.08it/s] 41%|████      | 194/471 [01:43<02:18,  1.99it/s] 41%|████▏     | 195/471 [01:43<02:22,  1.94it/s] 42%|████▏     | 196/471 [01:44<02:24,  1.91it/s] 42%|████▏     | 197/471 [01:44<02:24,  1.89it/s] 42%|████▏     | 198/471 [01:45<02:23,  1.90it/s] 42%|████▏     | 199/471 [01:45<02:23,  1.89it/s] 42%|████▏     | 200/471 [01:46<02:23,  1.89it/s] 43%|████▎     | 201/471 [01:47<02:23,  1.88it/s] 43%|████▎     | 202/471 [01:47<02:25,  1.85it/s] 43%|████▎     | 203/471 [01:48<02:24,  1.85it/s] 43%|████▎     | 204/471 [01:48<02:23,  1.86it/s] 44%|████▎     | 205/471 [01:49<02:23,  1.85it/s] 44%|████▎     | 206/471 [01:49<02:24,  1.84it/s] 44%|████▍     | 207/471 [01:50<02:24,  1.82it/s] 44%|████▍     | 208/471 [01:50<02:22,  1.85it/s] 44%|████▍     | 209/471 [01:51<02:20,  1.87it/s] 45%|████▍     | 210/471 [01:51<02:20,  1.86it/s] 45%|████▍     | 211/471 [01:52<02:21,  1.83it/s] 45%|████▌     | 212/471 [01:53<02:23,  1.81it/s] 45%|████▌     | 213/471 [01:53<02:22,  1.82it/s] 45%|████▌     | 214/471 [01:54<02:18,  1.85it/s] 46%|████▌     | 215/471 [01:54<02:16,  1.87it/s] 46%|████▌     | 216/471 [01:55<02:18,  1.84it/s] 46%|████▌     | 217/471 [01:55<02:20,  1.81it/s] 46%|████▋     | 218/471 [01:56<02:20,  1.80it/s] 46%|████▋     | 219/471 [01:56<02:18,  1.82it/s] 47%|████▋     | 220/471 [01:57<02:15,  1.85it/s] 47%|████▋     | 221/471 [01:57<02:16,  1.84it/s] 47%|████▋     | 222/471 [01:58<02:15,  1.83it/s] 47%|████▋     | 223/471 [01:58<02:07,  1.94it/s] 48%|████▊     | 224/471 [01:59<02:00,  2.04it/s] 48%|████▊     | 225/471 [01:59<01:56,  2.11it/s] 48%|████▊     | 226/471 [02:00<01:53,  2.16it/s] 48%|████▊     | 227/471 [02:00<01:50,  2.20it/s] 48%|████▊     | 228/471 [02:01<01:52,  2.16it/s] 49%|████▊     | 229/471 [02:01<01:58,  2.04it/s] 49%|████▉     | 230/471 [02:02<02:03,  1.95it/s] 49%|████▉     | 231/471 [02:02<02:06,  1.89it/s] 49%|████▉     | 232/471 [02:03<02:06,  1.89it/s] 49%|████▉     | 233/471 [02:03<02:04,  1.92it/s] 50%|████▉     | 234/471 [02:04<02:04,  1.90it/s] 50%|████▉     | 235/471 [02:04<02:06,  1.87it/s] 50%|█████     | 236/471 [02:05<02:07,  1.84it/s] 50%|█████     | 237/471 [02:06<02:07,  1.83it/s] 51%|█████     | 238/471 [02:06<02:06,  1.84it/s] 51%|█████     | 239/471 [02:07<02:03,  1.89it/s] 51%|█████     | 240/471 [02:07<02:03,  1.87it/s] 51%|█████     | 241/471 [02:08<02:05,  1.83it/s] 51%|█████▏    | 242/471 [02:08<02:05,  1.82it/s] 52%|█████▏    | 243/471 [02:09<02:05,  1.81it/s] 52%|█████▏    | 244/471 [02:09<02:04,  1.82it/s] 52%|█████▏    | 245/471 [02:10<02:01,  1.86it/s] 52%|█████▏    | 246/471 [02:10<02:01,  1.85it/s] 52%|█████▏    | 247/471 [02:11<02:01,  1.84it/s] 53%|█████▎    | 248/471 [02:12<02:02,  1.83it/s] 53%|█████▎    | 249/471 [02:12<02:02,  1.81it/s] 53%|█████▎    | 250/471 [02:13<02:00,  1.83it/s] 53%|█████▎    | 251/471 [02:13<01:57,  1.87it/s] 54%|█████▎    | 252/471 [02:14<01:57,  1.86it/s] 54%|█████▎    | 253/471 [02:14<01:57,  1.85it/s] 54%|█████▍    | 254/471 [02:15<01:58,  1.83it/s] 54%|█████▍    | 255/471 [02:15<01:56,  1.85it/s] 54%|█████▍    | 256/471 [02:16<01:56,  1.84it/s] 55%|█████▍    | 257/471 [02:16<01:54,  1.87it/s] 55%|█████▍    | 258/471 [02:17<01:51,  1.92it/s] 55%|█████▍    | 259/471 [02:17<01:41,  2.09it/s] 55%|█████▌    | 260/471 [02:18<01:33,  2.26it/s] 55%|█████▌    | 261/471 [02:18<01:26,  2.42it/s] 56%|█████▌    | 262/471 [02:18<01:18,  2.68it/s] 56%|█████▌    | 263/471 [02:19<01:12,  2.89it/s] 56%|█████▌    | 264/471 [02:19<01:07,  3.06it/s] 56%|█████▋    | 265/471 [02:19<01:04,  3.21it/s] 56%|█████▋    | 266/471 [02:19<01:02,  3.29it/s] 57%|█████▋    | 267/471 [02:20<01:10,  2.89it/s] 57%|█████▋    | 268/471 [02:20<01:18,  2.57it/s] 57%|█████▋    | 269/471 [02:21<01:24,  2.40it/s] 57%|█████▋    | 270/471 [02:21<01:31,  2.19it/s] 58%|█████▊    | 271/471 [02:22<01:36,  2.08it/s] 58%|█████▊    | 272/471 [02:22<01:38,  2.03it/s] 58%|█████▊    | 273/471 [02:23<01:41,  1.95it/s] 58%|█████▊    | 274/471 [02:24<01:43,  1.90it/s] 58%|█████▊    | 275/471 [02:24<01:45,  1.86it/s] 59%|█████▊    | 276/471 [02:25<01:45,  1.85it/s] 59%|█████▉    | 277/471 [02:25<01:43,  1.88it/s] 59%|█████▉    | 278/471 [02:26<01:42,  1.89it/s] 59%|█████▉    | 279/471 [02:26<01:42,  1.88it/s] 59%|█████▉    | 280/471 [02:27<01:42,  1.86it/s] 60%|█████▉    | 281/471 [02:27<01:43,  1.84it/s] 60%|█████▉    | 282/471 [02:28<01:41,  1.87it/s] 60%|██████    | 283/471 [02:28<01:35,  1.97it/s] 60%|██████    | 284/471 [02:29<01:30,  2.06it/s] 61%|██████    | 285/471 [02:29<01:26,  2.14it/s] 61%|██████    | 286/471 [02:30<01:24,  2.18it/s] 61%|██████    | 287/471 [02:30<01:25,  2.16it/s] 61%|██████    | 288/471 [02:31<01:26,  2.12it/s] 61%|██████▏   | 289/471 [02:31<01:25,  2.13it/s] 62%|██████▏   | 290/471 [02:32<01:29,  2.02it/s] 62%|██████▏   | 291/471 [02:32<01:30,  1.99it/s] 62%|██████▏   | 292/471 [02:33<01:30,  1.97it/s] 62%|██████▏   | 293/471 [02:33<01:30,  1.97it/s] 62%|██████▏   | 294/471 [02:34<01:30,  1.96it/s] 63%|██████▎   | 295/471 [02:34<01:30,  1.93it/s] 63%|██████▎   | 296/471 [02:35<01:31,  1.91it/s] 63%|██████▎   | 297/471 [02:35<01:30,  1.93it/s] 63%|██████▎   | 298/471 [02:36<01:26,  2.00it/s] 63%|██████▎   | 299/471 [02:36<01:22,  2.08it/s] 64%|██████▎   | 300/471 [02:37<01:20,  2.13it/s] 64%|██████▍   | 301/471 [02:37<01:16,  2.21it/s] 64%|██████▍   | 302/471 [02:37<01:15,  2.25it/s] 64%|██████▍   | 303/471 [02:38<01:15,  2.21it/s] 65%|██████▍   | 304/471 [02:38<01:15,  2.20it/s] 65%|██████▍   | 305/471 [02:39<01:19,  2.08it/s] 65%|██████▍   | 306/471 [02:39<01:23,  1.99it/s] 65%|██████▌   | 307/471 [02:40<01:24,  1.94it/s] 65%|██████▌   | 308/471 [02:40<01:24,  1.94it/s] 66%|██████▌   | 309/471 [02:41<01:25,  1.89it/s] 66%|██████▌   | 310/471 [02:42<01:26,  1.87it/s] 66%|██████▌   | 311/471 [02:42<01:26,  1.86it/s] 66%|██████▌   | 312/471 [02:43<01:23,  1.91it/s] 66%|██████▋   | 313/471 [02:43<01:19,  1.98it/s] 67%|██████▋   | 314/471 [02:43<01:15,  2.07it/s] 67%|██████▋   | 315/471 [02:44<01:13,  2.12it/s] 67%|██████▋   | 316/471 [02:44<01:12,  2.13it/s] 67%|██████▋   | 317/471 [02:45<01:11,  2.16it/s] 68%|██████▊   | 318/471 [02:45<01:10,  2.17it/s] 68%|██████▊   | 319/471 [02:46<01:12,  2.11it/s] 68%|██████▊   | 320/471 [02:46<01:15,  2.01it/s] 68%|██████▊   | 321/471 [02:47<01:15,  1.98it/s] 68%|██████▊   | 322/471 [02:47<01:18,  1.90it/s] 69%|██████▊   | 323/471 [02:48<01:18,  1.89it/s] 69%|██████▉   | 324/471 [02:49<01:18,  1.86it/s] 69%|██████▉   | 325/471 [02:49<01:19,  1.84it/s] 69%|██████▉   | 326/471 [02:50<01:18,  1.84it/s] 69%|██████▉   | 327/471 [02:50<01:16,  1.87it/s] 70%|██████▉   | 328/471 [02:51<01:16,  1.86it/s] 70%|██████▉   | 329/471 [02:51<01:17,  1.84it/s] 70%|███████   | 330/471 [02:52<01:17,  1.83it/s] 70%|███████   | 331/471 [02:52<01:17,  1.81it/s] 70%|███████   | 332/471 [02:53<01:17,  1.80it/s] 71%|███████   | 333/471 [02:53<01:15,  1.83it/s] 71%|███████   | 334/471 [02:54<01:15,  1.82it/s] 71%|███████   | 335/471 [02:55<01:14,  1.82it/s] 71%|███████▏  | 336/471 [02:55<01:10,  1.91it/s] 72%|███████▏  | 337/471 [02:56<01:07,  1.98it/s] 72%|███████▏  | 338/471 [02:56<01:05,  2.04it/s] 72%|███████▏  | 339/471 [02:56<01:02,  2.12it/s] 72%|███████▏  | 340/471 [02:57<00:59,  2.20it/s] 72%|███████▏  | 341/471 [02:57<01:00,  2.16it/s] 73%|███████▎  | 342/471 [02:58<01:03,  2.03it/s] 73%|███████▎  | 343/471 [02:58<01:05,  1.94it/s] 73%|███████▎  | 344/471 [02:59<01:06,  1.91it/s] 73%|███████▎  | 345/471 [03:00<01:06,  1.88it/s] 73%|███████▎  | 346/471 [03:00<01:05,  1.90it/s] 74%|███████▎  | 347/471 [03:01<01:04,  1.92it/s] 74%|███████▍  | 348/471 [03:01<01:05,  1.88it/s] 74%|███████▍  | 349/471 [03:02<01:05,  1.85it/s] 74%|███████▍  | 350/471 [03:02<01:05,  1.84it/s] 75%|███████▍  | 351/471 [03:03<01:05,  1.83it/s] 75%|███████▍  | 352/471 [03:03<01:05,  1.83it/s] 75%|███████▍  | 353/471 [03:04<01:03,  1.87it/s] 75%|███████▌  | 354/471 [03:04<01:03,  1.85it/s] 75%|███████▌  | 355/471 [03:05<01:03,  1.83it/s] 76%|███████▌  | 356/471 [03:06<01:03,  1.81it/s] 76%|███████▌  | 357/471 [03:06<01:03,  1.81it/s] 76%|███████▌  | 358/471 [03:07<01:02,  1.80it/s] 76%|███████▌  | 359/471 [03:07<01:00,  1.86it/s] 76%|███████▋  | 360/471 [03:08<00:59,  1.87it/s] 77%|███████▋  | 361/471 [03:08<00:59,  1.85it/s] 77%|███████▋  | 362/471 [03:09<01:00,  1.81it/s] 77%|███████▋  | 363/471 [03:09<00:59,  1.82it/s] 77%|███████▋  | 364/471 [03:10<00:58,  1.81it/s] 77%|███████▋  | 365/471 [03:10<00:57,  1.83it/s] 78%|███████▊  | 366/471 [03:11<00:55,  1.89it/s] 78%|███████▊  | 367/471 [03:11<00:55,  1.87it/s] 78%|███████▊  | 368/471 [03:12<00:55,  1.87it/s] 78%|███████▊  | 369/471 [03:13<00:54,  1.87it/s] 79%|███████▊  | 370/471 [03:13<00:54,  1.86it/s] 79%|███████▉  | 371/471 [03:14<00:53,  1.85it/s] 79%|███████▉  | 372/471 [03:14<00:51,  1.92it/s] 79%|███████▉  | 373/471 [03:15<00:48,  2.01it/s] 79%|███████▉  | 374/471 [03:15<00:46,  2.11it/s] 80%|███████▉  | 375/471 [03:15<00:43,  2.19it/s] 80%|███████▉  | 376/471 [03:16<00:44,  2.16it/s] 80%|████████  | 377/471 [03:16<00:45,  2.07it/s] 80%|████████  | 378/471 [03:17<00:47,  1.97it/s] 80%|████████  | 379/471 [03:17<00:48,  1.91it/s] 81%|████████  | 380/471 [03:18<00:47,  1.90it/s] 81%|████████  | 381/471 [03:19<00:48,  1.87it/s] 81%|████████  | 382/471 [03:19<00:48,  1.85it/s] 81%|████████▏ | 383/471 [03:20<00:47,  1.86it/s] 82%|████████▏ | 384/471 [03:20<00:47,  1.84it/s] 82%|████████▏ | 385/471 [03:21<00:47,  1.81it/s] 82%|████████▏ | 386/471 [03:21<00:46,  1.81it/s] 82%|████████▏ | 387/471 [03:22<00:46,  1.81it/s] 82%|████████▏ | 388/471 [03:22<00:45,  1.83it/s] 83%|████████▎ | 389/471 [03:23<00:44,  1.85it/s] 83%|████████▎ | 390/471 [03:24<00:44,  1.81it/s] 83%|████████▎ | 391/471 [03:24<00:44,  1.80it/s] 83%|████████▎ | 392/471 [03:25<00:44,  1.79it/s] 83%|████████▎ | 393/471 [03:25<00:42,  1.82it/s] 84%|████████▎ | 394/471 [03:26<00:42,  1.80it/s] 84%|████████▍ | 395/471 [03:26<00:42,  1.81it/s] 84%|████████▍ | 396/471 [03:27<00:41,  1.80it/s] 84%|████████▍ | 397/471 [03:27<00:41,  1.79it/s] 85%|████████▍ | 398/471 [03:28<00:40,  1.81it/s] 85%|████████▍ | 399/471 [03:29<00:39,  1.81it/s] 85%|████████▍ | 400/471 [03:29<00:39,  1.79it/s] 85%|████████▌ | 401/471 [03:30<00:39,  1.79it/s] 85%|████████▌ | 402/471 [03:30<00:37,  1.82it/s] 86%|████████▌ | 403/471 [03:31<00:37,  1.81it/s] 86%|████████▌ | 404/471 [03:31<00:36,  1.83it/s] 86%|████████▌ | 405/471 [03:32<00:36,  1.80it/s] 86%|████████▌ | 406/471 [03:32<00:36,  1.80it/s] 86%|████████▋ | 407/471 [03:33<00:35,  1.80it/s] 87%|████████▋ | 408/471 [03:33<00:33,  1.88it/s] 87%|████████▋ | 409/471 [03:34<00:31,  1.97it/s] 87%|████████▋ | 410/471 [03:34<00:29,  2.05it/s] 87%|████████▋ | 411/471 [03:35<00:28,  2.14it/s] 87%|████████▋ | 412/471 [03:35<00:27,  2.16it/s] 88%|████████▊ | 413/471 [03:36<00:28,  2.02it/s] 88%|████████▊ | 414/471 [03:36<00:29,  1.93it/s] 88%|████████▊ | 415/471 [03:37<00:29,  1.88it/s] 88%|████████▊ | 416/471 [03:37<00:29,  1.84it/s] 89%|████████▊ | 417/471 [03:38<00:28,  1.89it/s] 89%|████████▊ | 418/471 [03:39<00:28,  1.87it/s] 89%|████████▉ | 419/471 [03:39<00:28,  1.84it/s] 89%|████████▉ | 420/471 [03:40<00:28,  1.81it/s] 89%|████████▉ | 421/471 [03:40<00:27,  1.80it/s] 90%|████████▉ | 422/471 [03:41<00:26,  1.83it/s] 90%|████████▉ | 423/471 [03:41<00:25,  1.86it/s] 90%|█████████ | 424/471 [03:42<00:25,  1.86it/s] 90%|█████████ | 425/471 [03:42<00:24,  1.85it/s] 90%|█████████ | 426/471 [03:43<00:24,  1.82it/s] 91%|█████████ | 427/471 [03:43<00:24,  1.81it/s] 91%|█████████ | 428/471 [03:44<00:23,  1.80it/s] 91%|█████████ | 429/471 [03:45<00:22,  1.83it/s] 91%|█████████▏| 430/471 [03:45<00:21,  1.88it/s] 92%|█████████▏| 431/471 [03:46<00:21,  1.85it/s] 92%|█████████▏| 432/471 [03:46<00:21,  1.84it/s] 92%|█████████▏| 433/471 [03:47<00:21,  1.81it/s] 92%|█████████▏| 434/471 [03:47<00:20,  1.78it/s] 92%|█████████▏| 435/471 [03:48<00:20,  1.79it/s] 93%|█████████▎| 436/471 [03:48<00:19,  1.81it/s] 93%|█████████▎| 437/471 [03:49<00:18,  1.82it/s] 93%|█████████▎| 438/471 [03:50<00:18,  1.82it/s] 93%|█████████▎| 439/471 [03:50<00:17,  1.82it/s] 93%|█████████▎| 440/471 [03:51<00:17,  1.80it/s] 94%|█████████▎| 441/471 [03:51<00:16,  1.80it/s] 94%|█████████▍| 442/471 [03:52<00:16,  1.81it/s] 94%|█████████▍| 443/471 [03:52<00:14,  1.89it/s] 94%|█████████▍| 444/471 [03:53<00:13,  1.96it/s] 94%|█████████▍| 445/471 [03:53<00:12,  2.00it/s] 95%|█████████▍| 446/471 [03:54<00:12,  2.03it/s] 95%|█████████▍| 447/471 [03:54<00:11,  2.06it/s] 95%|█████████▌| 448/471 [03:55<00:11,  2.08it/s] 95%|█████████▌| 449/471 [03:55<00:11,  1.99it/s] 96%|█████████▌| 450/471 [03:56<00:10,  1.91it/s] 96%|█████████▌| 451/471 [03:56<00:10,  1.87it/s] 96%|█████████▌| 452/471 [03:57<00:10,  1.83it/s] 96%|█████████▌| 453/471 [03:57<00:09,  1.82it/s] 96%|█████████▋| 454/471 [03:58<00:09,  1.83it/s] 97%|█████████▋| 455/471 [03:59<00:08,  1.79it/s] 97%|█████████▋| 456/471 [03:59<00:08,  1.78it/s] 97%|█████████▋| 457/471 [04:00<00:07,  1.78it/s] 97%|█████████▋| 458/471 [04:00<00:07,  1.81it/s] 97%|█████████▋| 459/471 [04:01<00:06,  1.81it/s] 98%|█████████▊| 460/471 [04:01<00:06,  1.82it/s] 98%|█████████▊| 461/471 [04:02<00:05,  1.80it/s] 98%|█████████▊| 462/471 [04:02<00:05,  1.80it/s] 98%|█████████▊| 463/471 [04:03<00:04,  1.78it/s] 99%|█████████▊| 464/471 [04:04<00:03,  1.77it/s] 99%|█████████▊| 465/471 [04:04<00:03,  1.80it/s] 99%|█████████▉| 466/471 [04:05<00:02,  1.79it/s] 99%|█████████▉| 467/471 [04:05<00:02,  1.78it/s] 99%|█████████▉| 468/471 [04:06<00:01,  1.78it/s]100%|█████████▉| 469/471 [04:06<00:01,  1.77it/s]100%|█████████▉| 470/471 [04:07<00:00,  1.78it/s]100%|██████████| 471/471 [04:07<00:00,  1.88it/s]100%|██████████| 471/471 [04:07<00:00,  1.90it/s]
{'eval_loss': 1.9729896783828735, 'eval_model_preparation_time': 0.01, 'eval_acc': 0.514073287307488, 'eval_runtime': 248.3537, 'eval_samples_per_second': 30.328, 'eval_steps_per_second': 1.896}
ROUND:4
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:50,  1.28s/it]                                              {'loss': 1.9213, 'grad_norm': 4.8543901443481445, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:50,  1.28s/it]  5%|▌         | 2/40 [00:02<00:46,  1.22s/it]                                              {'loss': 1.969, 'grad_norm': 5.786151885986328, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:46,  1.22s/it]  8%|▊         | 3/40 [00:03<00:43,  1.19s/it]                                              {'loss': 1.9231, 'grad_norm': 4.416950225830078, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:43,  1.19s/it] 10%|█         | 4/40 [00:04<00:42,  1.19s/it]                                              {'loss': 2.3328, 'grad_norm': 5.443745136260986, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:42,  1.19s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.16s/it]                                              {'loss': 1.9666, 'grad_norm': 4.1834821701049805, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.16s/it] 15%|█▌        | 6/40 [00:07<00:39,  1.17s/it]                                              {'loss': 2.0781, 'grad_norm': 4.955679416656494, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:39,  1.17s/it] 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it]                                              {'loss': 2.4391, 'grad_norm': 6.685863971710205, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it] 20%|██        | 8/40 [00:08<00:27,  1.16it/s]                                              {'loss': 2.4985, 'grad_norm': 18.200998306274414, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:27,  1.16it/s] 22%|██▎       | 9/40 [00:09<00:29,  1.04it/s]                                              {'loss': 1.8548, 'grad_norm': 5.024374008178711, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:29,  1.04it/s] 25%|██▌       | 10/40 [00:10<00:30,  1.02s/it]                                               {'loss': 1.9469, 'grad_norm': 4.18408203125, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:30,  1.02s/it] 28%|██▊       | 11/40 [00:11<00:30,  1.07s/it]                                               {'loss': 1.8885, 'grad_norm': 4.9324870109558105, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:30,  1.07s/it] 30%|███       | 12/40 [00:13<00:30,  1.09s/it]                                               {'loss': 2.0628, 'grad_norm': 4.5837721824646, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:30,  1.09s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it]                                               {'loss': 1.9156, 'grad_norm': 5.822215557098389, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it]                                               {'loss': 1.6763, 'grad_norm': 4.625439643859863, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.12s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it]                                               {'loss': 1.635, 'grad_norm': 4.812379360198975, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it] 40%|████      | 16/40 [00:16<00:20,  1.17it/s]                                               {'loss': 2.1477, 'grad_norm': 20.727020263671875, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.17it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s]                                               {'loss': 1.7464, 'grad_norm': 5.629654407501221, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s] 45%|████▌     | 18/40 [00:19<00:21,  1.00it/s]                                               {'loss': 1.7446, 'grad_norm': 6.210727691650391, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:21,  1.00it/s] 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it]                                               {'loss': 1.6329, 'grad_norm': 4.406292915344238, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:21,  1.04s/it] 50%|█████     | 20/40 [00:21<00:21,  1.08s/it]                                               {'loss': 1.5506, 'grad_norm': 4.720508098602295, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.08s/it] 52%|█████▎    | 21/40 [00:22<00:21,  1.11s/it]                                               {'loss': 1.7008, 'grad_norm': 4.849509239196777, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:21,  1.11s/it] 55%|█████▌    | 22/40 [00:23<00:20,  1.12s/it]                                               {'loss': 1.7386, 'grad_norm': 3.802050828933716, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:20,  1.12s/it] 57%|█████▊    | 23/40 [00:24<00:19,  1.13s/it]                                               {'loss': 2.0142, 'grad_norm': 6.331394672393799, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:19,  1.13s/it] 60%|██████    | 24/40 [00:25<00:13,  1.17it/s]                                               {'loss': 1.4348, 'grad_norm': 16.21542739868164, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.17it/s] 62%|██████▎   | 25/40 [00:26<00:14,  1.06it/s]                                               {'loss': 1.8972, 'grad_norm': 3.9709372520446777, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:14,  1.06it/s] 65%|██████▌   | 26/40 [00:27<00:14,  1.00s/it]                                               {'loss': 1.6729, 'grad_norm': 4.546141147613525, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:14,  1.00s/it] 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it]                                               {'loss': 1.7867, 'grad_norm': 4.552896499633789, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.03s/it] 70%|███████   | 28/40 [00:29<00:12,  1.07s/it]                                               {'loss': 1.6852, 'grad_norm': 4.5469255447387695, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.07s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 1.5542, 'grad_norm': 5.955119609832764, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:10,  1.10s/it]                                               {'loss': 1.6726, 'grad_norm': 8.038460731506348, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:10,  1.10s/it] 78%|███████▊  | 31/40 [00:33<00:10,  1.11s/it]                                               {'loss': 1.3984, 'grad_norm': 3.716676950454712, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:33<00:10,  1.11s/it] 80%|████████  | 32/40 [00:33<00:06,  1.20it/s]                                               {'loss': 1.4657, 'grad_norm': 19.794330596923828, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:33<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.08it/s]                                               {'loss': 1.3698, 'grad_norm': 4.462991714477539, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.00it/s]                                               {'loss': 1.5811, 'grad_norm': 4.341644287109375, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.00it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.04s/it]                                               {'loss': 1.5482, 'grad_norm': 4.410567760467529, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.04s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.02s/it]                                               {'loss': 1.6184, 'grad_norm': 4.178945064544678, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.02s/it] 92%|█████████▎| 37/40 [00:38<00:02,  1.03it/s]                                               {'loss': 1.6559, 'grad_norm': 6.282655239105225, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:02,  1.03it/s] 95%|█████████▌| 38/40 [00:39<00:01,  1.06it/s]                                               {'loss': 1.6593, 'grad_norm': 4.105289936065674, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:01,  1.06it/s] 98%|█████████▊| 39/40 [00:40<00:00,  1.05it/s]                                               {'loss': 1.9203, 'grad_norm': 4.706937789916992, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:00,  1.05it/s]100%|██████████| 40/40 [00:40<00:00,  1.39it/s]                                               {'loss': 1.398, 'grad_norm': 15.560022354125977, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.39it/s]                                               {'train_runtime': 40.6295, 'train_samples_per_second': 13.906, 'train_steps_per_second': 0.985, 'train_loss': 1.7925691395998, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.39it/s]100%|██████████| 40/40 [00:40<00:00,  1.02s/it]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 1.9296, 'grad_norm': 4.538973331451416, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:39,  1.03s/it]                                              {'loss': 2.0834, 'grad_norm': 6.920281887054443, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.03s/it]  8%|▊         | 3/40 [00:03<00:37,  1.02s/it]                                              {'loss': 2.1536, 'grad_norm': 5.358522891998291, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:37,  1.02s/it] 10%|█         | 4/40 [00:04<00:35,  1.01it/s]                                              {'loss': 2.1681, 'grad_norm': 5.391343116760254, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:35,  1.01it/s] 12%|█▎        | 5/40 [00:05<00:37,  1.06s/it]                                              {'loss': 2.2099, 'grad_norm': 5.164384841918945, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:37,  1.06s/it] 15%|█▌        | 6/40 [00:06<00:36,  1.08s/it]                                              {'loss': 2.0666, 'grad_norm': 6.253496170043945, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:36,  1.08s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it]                                              {'loss': 2.4623, 'grad_norm': 4.89047908782959, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.12s/it] 20%|██        | 8/40 [00:08<00:33,  1.04s/it]                                              {'loss': 2.3576, 'grad_norm': 16.5229434967041, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:33,  1.04s/it] 22%|██▎       | 9/40 [00:09<00:33,  1.08s/it]                                              {'loss': 2.1119, 'grad_norm': 6.055513381958008, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:33,  1.08s/it] 25%|██▌       | 10/40 [00:10<00:32,  1.10s/it]                                               {'loss': 2.1622, 'grad_norm': 5.631880283355713, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:32,  1.10s/it] 28%|██▊       | 11/40 [00:11<00:32,  1.11s/it]                                               {'loss': 1.8943, 'grad_norm': 4.677272319793701, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:32,  1.11s/it] 30%|███       | 12/40 [00:13<00:31,  1.13s/it]                                               {'loss': 1.8519, 'grad_norm': 4.217405319213867, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.13s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it]                                               {'loss': 2.0022, 'grad_norm': 3.992025852203369, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.12s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it]                                               {'loss': 1.9128, 'grad_norm': 4.218502521514893, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.13s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it]                                               {'loss': 1.9931, 'grad_norm': 4.807118892669678, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.12s/it] 40%|████      | 16/40 [00:16<00:21,  1.10it/s]                                               {'loss': 2.557, 'grad_norm': 35.648681640625, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:21,  1.10it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s]                                               {'loss': 1.7236, 'grad_norm': 4.073750972747803, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:18<00:20,  1.07it/s]                                               {'loss': 1.8933, 'grad_norm': 4.8907976150512695, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:20,  1.07it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.03it/s]                                               {'loss': 1.8943, 'grad_norm': 6.526295185089111, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.03it/s] 50%|█████     | 20/40 [00:20<00:20,  1.03s/it]                                               {'loss': 1.8516, 'grad_norm': 4.800085544586182, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.03s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.07s/it]                                               {'loss': 1.9201, 'grad_norm': 4.124813556671143, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it]                                               {'loss': 1.7628, 'grad_norm': 4.013397693634033, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it]                                               {'loss': 1.9111, 'grad_norm': 5.715927600860596, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it] 60%|██████    | 24/40 [00:24<00:13,  1.18it/s]                                               {'loss': 2.5793, 'grad_norm': 10.734475135803223, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.18it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s]                                               {'loss': 1.6043, 'grad_norm': 5.391284942626953, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:26<00:14,  1.01s/it]                                               {'loss': 1.7688, 'grad_norm': 5.5550127029418945, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:14,  1.01s/it] 68%|██████▊   | 27/40 [00:28<00:13,  1.04s/it]                                               {'loss': 1.7754, 'grad_norm': 12.239794731140137, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.04s/it] 70%|███████   | 28/40 [00:29<00:13,  1.09s/it]                                               {'loss': 1.8822, 'grad_norm': 4.494583606719971, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:13,  1.09s/it] 72%|███████▎  | 29/40 [00:30<00:12,  1.10s/it]                                               {'loss': 1.7564, 'grad_norm': 5.268265247344971, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:12,  1.10s/it] 75%|███████▌  | 30/40 [00:31<00:11,  1.12s/it]                                               {'loss': 1.788, 'grad_norm': 4.783102512359619, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:11,  1.12s/it] 78%|███████▊  | 31/40 [00:32<00:10,  1.12s/it]                                               {'loss': 1.7245, 'grad_norm': 4.134335994720459, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:10,  1.12s/it] 80%|████████  | 32/40 [00:32<00:06,  1.16it/s]                                               {'loss': 1.1918, 'grad_norm': 11.048480987548828, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.16it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.07it/s]                                               {'loss': 1.7305, 'grad_norm': 5.775926113128662, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.07it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.02it/s]                                               {'loss': 1.8123, 'grad_norm': 4.236425876617432, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.02it/s] 88%|████████▊ | 35/40 [00:36<00:04,  1.03it/s]                                               {'loss': 1.7905, 'grad_norm': 4.576347827911377, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:04,  1.03it/s] 90%|█████████ | 36/40 [00:36<00:03,  1.05it/s]                                               {'loss': 1.8207, 'grad_norm': 4.540279388427734, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:03,  1.05it/s] 92%|█████████▎| 37/40 [00:38<00:02,  1.01it/s]                                               {'loss': 1.812, 'grad_norm': 4.908463954925537, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:02,  1.01it/s] 95%|█████████▌| 38/40 [00:39<00:02,  1.02s/it]                                               {'loss': 2.0695, 'grad_norm': 4.402886390686035, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.02s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.06s/it]                                               {'loss': 1.4343, 'grad_norm': 4.228540420532227, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.06s/it]100%|██████████| 40/40 [00:40<00:00,  1.25it/s]                                               {'loss': 1.6598, 'grad_norm': 14.280838966369629, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.25it/s]                                               {'train_runtime': 40.6667, 'train_samples_per_second': 13.893, 'train_steps_per_second': 0.984, 'train_loss': 1.92683544754982, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.25it/s]100%|██████████| 40/40 [00:40<00:00,  1.02s/it]
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]                                              {'loss': 2.1548, 'grad_norm': 5.116316795349121, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.12s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 2.1713, 'grad_norm': 5.045576095581055, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:41,  1.11s/it]                                              {'loss': 2.0351, 'grad_norm': 5.084554672241211, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.11s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 2.1644, 'grad_norm': 5.361697673797607, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 1.9836, 'grad_norm': 4.5504841804504395, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 2.0305, 'grad_norm': 12.480030059814453, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:35,  1.06s/it]                                              {'loss': 1.9678, 'grad_norm': 4.712706089019775, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:35,  1.06s/it] 20%|██        | 8/40 [00:07<00:24,  1.29it/s]                                              {'loss': 1.7354, 'grad_norm': 11.981128692626953, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:24,  1.29it/s] 22%|██▎       | 9/40 [00:08<00:26,  1.19it/s]                                              {'loss': 2.1015, 'grad_norm': 4.393321514129639, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:26,  1.19it/s] 25%|██▌       | 10/40 [00:09<00:28,  1.07it/s]                                               {'loss': 1.8014, 'grad_norm': 4.558338642120361, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:28,  1.07it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it]                                               {'loss': 1.4801, 'grad_norm': 5.5200676918029785, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.01s/it] 30%|███       | 12/40 [00:12<00:29,  1.04s/it]                                               {'loss': 1.8925, 'grad_norm': 4.5404534339904785, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.04s/it] 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it]                                               {'loss': 1.8254, 'grad_norm': 4.873646259307861, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it] 35%|███▌      | 14/40 [00:14<00:27,  1.06s/it]                                               {'loss': 1.7795, 'grad_norm': 5.179731369018555, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:27,  1.06s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.08s/it]                                               {'loss': 1.8863, 'grad_norm': 5.254923343658447, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.08s/it] 40%|████      | 16/40 [00:15<00:19,  1.21it/s]                                               {'loss': 1.4236, 'grad_norm': 14.184480667114258, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.21it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.09it/s]                                               {'loss': 1.4663, 'grad_norm': 4.12839937210083, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.00it/s]                                               {'loss': 1.5891, 'grad_norm': 5.051095008850098, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.00it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.02s/it]                                               {'loss': 1.8967, 'grad_norm': 4.199631690979004, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.02s/it] 50%|█████     | 20/40 [00:20<00:21,  1.07s/it]                                               {'loss': 1.7374, 'grad_norm': 5.027530670166016, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.07s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 1.8257, 'grad_norm': 5.991680145263672, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.10s/it]                                               {'loss': 1.7195, 'grad_norm': 4.700373649597168, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.10s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it]                                               {'loss': 1.7605, 'grad_norm': 3.9431474208831787, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it] 60%|██████    | 24/40 [00:23<00:13,  1.19it/s]                                               {'loss': 2.2034, 'grad_norm': 18.4202880859375, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.19it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s]                                               {'loss': 1.5923, 'grad_norm': 4.739503383636475, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.08it/s]                                               {'loss': 1.4914, 'grad_norm': 4.910645008087158, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.08it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.08it/s]                                               {'loss': 1.521, 'grad_norm': 4.811273574829102, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.08it/s] 70%|███████   | 28/40 [00:27<00:11,  1.06it/s]                                               {'loss': 1.76, 'grad_norm': 5.345310211181641, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.06it/s] 72%|███████▎  | 29/40 [00:29<00:10,  1.01it/s]                                               {'loss': 1.5682, 'grad_norm': 4.637536525726318, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:10,  1.01it/s] 75%|███████▌  | 30/40 [00:30<00:10,  1.03s/it]                                               {'loss': 1.7024, 'grad_norm': 4.496679782867432, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.03s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.04s/it]                                               {'loss': 1.6692, 'grad_norm': 114.32398986816406, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.04s/it] 80%|████████  | 32/40 [00:31<00:06,  1.26it/s]                                               {'loss': 2.0668, 'grad_norm': 22.375818252563477, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.26it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.12it/s]                                               {'loss': 1.6098, 'grad_norm': 5.035220146179199, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.12it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s]                                               {'loss': 1.3923, 'grad_norm': 6.271886348724365, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it]                                               {'loss': 1.7881, 'grad_norm': 4.520373821258545, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.05s/it]                                               {'loss': 1.8575, 'grad_norm': 4.238648891448975, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.05s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.08s/it]                                               {'loss': 1.409, 'grad_norm': 4.622359275817871, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.09s/it]                                               {'loss': 1.6789, 'grad_norm': 4.810458660125732, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.09s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]                                               {'loss': 1.361, 'grad_norm': 3.9582247734069824, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'loss': 2.0661, 'grad_norm': 15.989521980285645, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'train_runtime': 39.6653, 'train_samples_per_second': 14.244, 'train_steps_per_second': 1.008, 'train_loss': 1.7791474044322968, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:37,  1.04it/s]                                              {'loss': 2.1986, 'grad_norm': 5.7879204750061035, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:37,  1.04it/s]  5%|▌         | 2/40 [00:02<00:38,  1.02s/it]                                              {'loss': 2.0919, 'grad_norm': 5.548247337341309, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:38,  1.02s/it]  8%|▊         | 3/40 [00:03<00:39,  1.06s/it]                                              {'loss': 1.9234, 'grad_norm': 4.991570472717285, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:39,  1.06s/it] 10%|█         | 4/40 [00:04<00:39,  1.09s/it]                                              {'loss': 1.9192, 'grad_norm': 5.9427313804626465, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.09s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.09s/it]                                              {'loss': 2.0121, 'grad_norm': 6.072732448577881, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.09s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it]                                              {'loss': 2.0464, 'grad_norm': 5.8143110275268555, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it]                                              {'loss': 2.2691, 'grad_norm': 6.155729293823242, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.11s/it] 20%|██        | 8/40 [00:08<00:30,  1.05it/s]                                              {'loss': 1.4215, 'grad_norm': 13.097124099731445, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:30,  1.05it/s] 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it]                                              {'loss': 1.9919, 'grad_norm': 4.975155830383301, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:31,  1.03s/it] 25%|██▌       | 10/40 [00:10<00:31,  1.06s/it]                                               {'loss': 1.829, 'grad_norm': 5.07826566696167, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:31,  1.06s/it] 28%|██▊       | 11/40 [00:11<00:31,  1.09s/it]                                               {'loss': 1.8124, 'grad_norm': 5.364427089691162, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:31,  1.09s/it] 30%|███       | 12/40 [00:12<00:30,  1.09s/it]                                               {'loss': 1.9035, 'grad_norm': 4.863717555999756, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:30,  1.09s/it] 32%|███▎      | 13/40 [00:13<00:30,  1.11s/it]                                               {'loss': 2.0697, 'grad_norm': 4.726902484893799, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:30,  1.11s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it]                                               {'loss': 1.8017, 'grad_norm': 3.7414941787719727, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.11s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it]                                               {'loss': 1.9853, 'grad_norm': 5.3054704666137695, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.13s/it] 40%|████      | 16/40 [00:16<00:20,  1.19it/s]                                               {'loss': 1.5093, 'grad_norm': 14.6575345993042, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s]                                               {'loss': 1.6586, 'grad_norm': 4.826551914215088, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s]                                               {'loss': 1.5406, 'grad_norm': 3.6378965377807617, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.03it/s]                                               {'loss': 1.9927, 'grad_norm': 4.706212520599365, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.03it/s] 50%|█████     | 20/40 [00:20<00:19,  1.05it/s]                                               {'loss': 1.7219, 'grad_norm': 4.449936866760254, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:19,  1.05it/s] 52%|█████▎    | 21/40 [00:21<00:18,  1.03it/s]                                               {'loss': 1.8965, 'grad_norm': 6.702601432800293, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:18,  1.03it/s] 55%|█████▌    | 22/40 [00:22<00:18,  1.01s/it]                                               {'loss': 1.8912, 'grad_norm': 5.969082355499268, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.01s/it] 57%|█████▊    | 23/40 [00:23<00:17,  1.05s/it]                                               {'loss': 1.628, 'grad_norm': 3.8774402141571045, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:17,  1.05s/it] 60%|██████    | 24/40 [00:23<00:12,  1.26it/s]                                               {'loss': 1.5125, 'grad_norm': 18.045480728149414, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.26it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.12it/s]                                               {'loss': 1.7564, 'grad_norm': 8.020488739013672, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.12it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s]                                               {'loss': 1.5154, 'grad_norm': 6.528171062469482, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.03it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it]                                               {'loss': 1.8571, 'grad_norm': 6.373362064361572, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.01s/it] 70%|███████   | 28/40 [00:28<00:12,  1.04s/it]                                               {'loss': 1.6705, 'grad_norm': 4.750940322875977, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.04s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it]                                               {'loss': 1.8356, 'grad_norm': 4.909397125244141, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.07s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.10s/it]                                               {'loss': 1.6589, 'grad_norm': 3.9092047214508057, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.10s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.11s/it]                                               {'loss': 1.3113, 'grad_norm': 4.37509822845459, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.11s/it] 80%|████████  | 32/40 [00:32<00:06,  1.20it/s]                                               {'loss': 1.7092, 'grad_norm': 14.19748592376709, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.20it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.07it/s]                                               {'loss': 1.6093, 'grad_norm': 5.021312713623047, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.07it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.01it/s]                                               {'loss': 1.3262, 'grad_norm': 4.034475326538086, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.04s/it]                                               {'loss': 1.7649, 'grad_norm': 4.15667200088501, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.04s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.07s/it]                                               {'loss': 1.4518, 'grad_norm': 4.664586067199707, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it]                                               {'loss': 1.8392, 'grad_norm': 6.444241046905518, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.03s/it]                                               {'loss': 1.8056, 'grad_norm': 10.708714485168457, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.03s/it] 98%|█████████▊| 39/40 [00:39<00:00,  1.01it/s]                                               {'loss': 1.6315, 'grad_norm': 4.931384563446045, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:00,  1.01it/s]100%|██████████| 40/40 [00:39<00:00,  1.32it/s]                                               {'loss': 0.9256, 'grad_norm': 12.645244598388672, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.32it/s]                                               {'train_runtime': 39.925, 'train_samples_per_second': 14.152, 'train_steps_per_second': 1.002, 'train_loss': 1.7573826134204864, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.32it/s]100%|██████████| 40/40 [00:39<00:00,  1.00it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:30,  1.29it/s]                                              {'loss': 1.9852, 'grad_norm': 4.074223518371582, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:30,  1.29it/s]  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]                                              {'loss': 2.2641, 'grad_norm': 6.350736618041992, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]  8%|▊         | 3/40 [00:02<00:32,  1.14it/s]                                              {'loss': 2.1672, 'grad_norm': 5.409981727600098, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.14it/s] 10%|█         | 4/40 [00:03<00:35,  1.02it/s]                                              {'loss': 1.8625, 'grad_norm': 15.426624298095703, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:35,  1.02it/s] 12%|█▎        | 5/40 [00:04<00:36,  1.03s/it]                                              {'loss': 2.1403, 'grad_norm': 5.060957431793213, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:36,  1.03s/it] 15%|█▌        | 6/40 [00:05<00:36,  1.06s/it]                                              {'loss': 1.9804, 'grad_norm': 4.954812526702881, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:36,  1.06s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.09s/it]                                              {'loss': 2.2112, 'grad_norm': 4.140570163726807, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.09s/it] 20%|██        | 8/40 [00:07<00:25,  1.24it/s]                                              {'loss': 1.8392, 'grad_norm': 17.031002044677734, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:25,  1.24it/s] 22%|██▎       | 9/40 [00:08<00:27,  1.11it/s]                                              {'loss': 1.7393, 'grad_norm': 4.1988749504089355, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:27,  1.11it/s] 25%|██▌       | 10/40 [00:09<00:26,  1.13it/s]                                               {'loss': 1.745, 'grad_norm': 4.138279438018799, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:26,  1.13it/s] 28%|██▊       | 11/40 [00:10<00:24,  1.17it/s]                                               {'loss': 2.1267, 'grad_norm': 4.945819854736328, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:24,  1.17it/s] 30%|███       | 12/40 [00:10<00:23,  1.17it/s]                                               {'loss': 1.922, 'grad_norm': 4.674315929412842, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:10<00:23,  1.17it/s] 32%|███▎      | 13/40 [00:11<00:23,  1.13it/s]                                               {'loss': 2.0704, 'grad_norm': 5.354180812835693, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:11<00:23,  1.13it/s] 35%|███▌      | 14/40 [00:13<00:25,  1.04it/s]                                               {'loss': 1.7674, 'grad_norm': 4.215102672576904, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:25,  1.04it/s] 38%|███▊      | 15/40 [00:14<00:25,  1.01s/it]                                               {'loss': 1.7433, 'grad_norm': 3.866415500640869, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:25,  1.01s/it] 40%|████      | 16/40 [00:14<00:18,  1.31it/s]                                               {'loss': 2.1275, 'grad_norm': 17.781333923339844, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:14<00:18,  1.31it/s] 42%|████▎     | 17/40 [00:15<00:19,  1.16it/s]                                               {'loss': 1.816, 'grad_norm': 3.9902589321136475, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:15<00:19,  1.16it/s] 45%|████▌     | 18/40 [00:16<00:20,  1.05it/s]                                               {'loss': 1.8553, 'grad_norm': 5.87348747253418, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:16<00:20,  1.05it/s] 48%|████▊     | 19/40 [00:17<00:20,  1.02it/s]                                               {'loss': 1.8909, 'grad_norm': 4.214184761047363, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:17<00:20,  1.02it/s] 50%|█████     | 20/40 [00:18<00:20,  1.03s/it]                                               {'loss': 1.6978, 'grad_norm': 5.003830432891846, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:18<00:20,  1.03s/it] 52%|█████▎    | 21/40 [00:19<00:20,  1.06s/it]                                               {'loss': 2.1443, 'grad_norm': 5.892915725708008, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:19<00:20,  1.06s/it] 55%|█████▌    | 22/40 [00:20<00:19,  1.07s/it]                                               {'loss': 1.5285, 'grad_norm': 3.5069220066070557, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:19,  1.07s/it] 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it]                                               {'loss': 1.7415, 'grad_norm': 4.8287672996521, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:18,  1.10s/it] 60%|██████    | 24/40 [00:22<00:13,  1.22it/s]                                               {'loss': 1.417, 'grad_norm': 16.211402893066406, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:13,  1.22it/s] 62%|██████▎   | 25/40 [00:23<00:13,  1.10it/s]                                               {'loss': 1.4493, 'grad_norm': 5.289458751678467, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:23<00:13,  1.10it/s] 65%|██████▌   | 26/40 [00:24<00:12,  1.10it/s]                                               {'loss': 1.6226, 'grad_norm': 4.370136737823486, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:24<00:12,  1.10it/s] 68%|██████▊   | 27/40 [00:25<00:11,  1.09it/s]                                               {'loss': 1.6433, 'grad_norm': 3.8282299041748047, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:25<00:11,  1.09it/s] 70%|███████   | 28/40 [00:26<00:11,  1.06it/s]                                               {'loss': 2.0148, 'grad_norm': 4.416399002075195, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:26<00:11,  1.06it/s] 72%|███████▎  | 29/40 [00:27<00:10,  1.04it/s]                                               {'loss': 1.602, 'grad_norm': 3.808335542678833, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:27<00:10,  1.04it/s] 75%|███████▌  | 30/40 [00:28<00:09,  1.04it/s]                                               {'loss': 1.6171, 'grad_norm': 4.764747619628906, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:28<00:09,  1.04it/s] 78%|███████▊  | 31/40 [00:29<00:08,  1.05it/s]                                               {'loss': 1.9754, 'grad_norm': 6.067460060119629, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:29<00:08,  1.05it/s] 80%|████████  | 32/40 [00:29<00:05,  1.38it/s]                                               {'loss': 0.7906, 'grad_norm': 11.686813354492188, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:29<00:05,  1.38it/s] 82%|████████▎ | 33/40 [00:30<00:05,  1.18it/s]                                               {'loss': 1.9295, 'grad_norm': 4.390364646911621, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:30<00:05,  1.18it/s] 85%|████████▌ | 34/40 [00:31<00:05,  1.08it/s]                                               {'loss': 1.7094, 'grad_norm': 6.028608322143555, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:31<00:05,  1.08it/s] 88%|████████▊ | 35/40 [00:32<00:04,  1.01it/s]                                               {'loss': 1.7239, 'grad_norm': 5.722520351409912, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:32<00:04,  1.01it/s] 90%|█████████ | 36/40 [00:33<00:04,  1.03s/it]                                               {'loss': 1.6622, 'grad_norm': 4.545020580291748, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:33<00:04,  1.03s/it] 92%|█████████▎| 37/40 [00:35<00:03,  1.07s/it]                                               {'loss': 1.4059, 'grad_norm': 4.574216842651367, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:35<00:03,  1.07s/it] 95%|█████████▌| 38/40 [00:36<00:02,  1.08s/it]                                               {'loss': 1.6367, 'grad_norm': 3.9074738025665283, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:36<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:37<00:01,  1.10s/it]                                               {'loss': 1.6675, 'grad_norm': 3.6215145587921143, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:37<00:01,  1.10s/it]100%|██████████| 40/40 [00:37<00:00,  1.21it/s]                                               {'loss': 1.9416, 'grad_norm': 18.819805145263672, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.21it/s]                                               {'train_runtime': 37.5953, 'train_samples_per_second': 15.028, 'train_steps_per_second': 1.064, 'train_loss': 1.8043709069490432, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.21it/s]100%|██████████| 40/40 [00:37<00:00,  1.06it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:06,  1.69s/it]                                              {'loss': 1.853, 'grad_norm': 4.019459247589111, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:06,  1.69s/it]  5%|▌         | 2/40 [00:02<00:51,  1.36s/it]                                              {'loss': 1.717, 'grad_norm': 5.447988986968994, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:51,  1.36s/it]  8%|▊         | 3/40 [00:03<00:43,  1.16s/it]                                              {'loss': 2.3214, 'grad_norm': 7.002490997314453, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:43,  1.16s/it] 10%|█         | 4/40 [00:04<00:39,  1.09s/it]                                              {'loss': 1.7451, 'grad_norm': 5.632631778717041, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.09s/it] 12%|█▎        | 5/40 [00:05<00:36,  1.04s/it]                                              {'loss': 2.0105, 'grad_norm': 4.705284118652344, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:36,  1.04s/it] 15%|█▌        | 6/40 [00:06<00:36,  1.07s/it]                                              {'loss': 1.9122, 'grad_norm': 5.490519046783447, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:36,  1.07s/it] 18%|█▊        | 7/40 [00:07<00:35,  1.08s/it]                                              {'loss': 2.2324, 'grad_norm': 4.682183742523193, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:35,  1.08s/it] 20%|██        | 8/40 [00:08<00:25,  1.27it/s]                                              {'loss': 2.1527, 'grad_norm': 36.39289855957031, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:25,  1.27it/s] 22%|██▎       | 9/40 [00:09<00:27,  1.12it/s]                                              {'loss': 1.9083, 'grad_norm': 5.600358009338379, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:27,  1.12it/s] 25%|██▌       | 10/40 [00:10<00:28,  1.06it/s]                                               {'loss': 1.8963, 'grad_norm': 8.056525230407715, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:28,  1.06it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.00s/it]                                               {'loss': 1.8969, 'grad_norm': 5.063003063201904, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.00s/it] 30%|███       | 12/40 [00:12<00:28,  1.04s/it]                                               {'loss': 1.7056, 'grad_norm': 5.952942371368408, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:28,  1.04s/it] 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it]                                               {'loss': 1.8861, 'grad_norm': 5.289789199829102, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.09s/it]                                               {'loss': 1.7855, 'grad_norm': 5.572710037231445, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.09s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it]                                               {'loss': 1.5637, 'grad_norm': 4.5015997886657715, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.09s/it] 40%|████      | 16/40 [00:16<00:19,  1.21it/s]                                               {'loss': 1.9352, 'grad_norm': 15.262469291687012, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:19,  1.21it/s] 42%|████▎     | 17/40 [00:17<00:20,  1.10it/s]                                               {'loss': 1.8317, 'grad_norm': 5.142235279083252, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:20,  1.10it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s]                                               {'loss': 1.7201, 'grad_norm': 4.766716003417969, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it]                                               {'loss': 1.699, 'grad_norm': 5.935102462768555, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.05s/it]                                               {'loss': 1.7363, 'grad_norm': 3.7240843772888184, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.05s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 1.6937, 'grad_norm': 4.349251747131348, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:22<00:18,  1.02s/it]                                               {'loss': 1.4467, 'grad_norm': 3.7652313709259033, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.02s/it] 57%|█████▊    | 23/40 [00:23<00:16,  1.00it/s]                                               {'loss': 1.6018, 'grad_norm': 5.174797058105469, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:16,  1.00it/s] 60%|██████    | 24/40 [00:23<00:11,  1.36it/s]                                               {'loss': 1.2502, 'grad_norm': 15.444804191589355, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.20it/s]                                               {'loss': 1.5769, 'grad_norm': 4.068464279174805, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.20it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.11it/s]                                               {'loss': 1.694, 'grad_norm': 4.310523986816406, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.11it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.03it/s]                                               {'loss': 1.6644, 'grad_norm': 5.630417823791504, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.03it/s] 70%|███████   | 28/40 [00:27<00:11,  1.00it/s]                                               {'loss': 1.5247, 'grad_norm': 4.0131683349609375, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.00it/s] 72%|███████▎  | 29/40 [00:29<00:11,  1.02s/it]                                               {'loss': 1.6087, 'grad_norm': 4.795026779174805, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.02s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.06s/it]                                               {'loss': 1.7519, 'grad_norm': 5.192947864532471, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.06s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.06s/it]                                               {'loss': 1.5703, 'grad_norm': 4.11977481842041, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.06s/it] 80%|████████  | 32/40 [00:31<00:06,  1.22it/s]                                               {'loss': 0.8619, 'grad_norm': 8.881940841674805, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.22it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.12it/s]                                               {'loss': 1.5316, 'grad_norm': 3.787836790084839, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.12it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.05it/s]                                               {'loss': 1.5033, 'grad_norm': 4.267326354980469, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.05it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.00it/s]                                               {'loss': 1.4146, 'grad_norm': 3.7922165393829346, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.00it/s] 90%|█████████ | 36/40 [00:35<00:04,  1.02s/it]                                               {'loss': 1.5232, 'grad_norm': 4.744747638702393, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.02s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it]                                               {'loss': 1.7315, 'grad_norm': 4.9425554275512695, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.06s/it]                                               {'loss': 1.6145, 'grad_norm': 5.258065700531006, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.06s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]                                               {'loss': 1.4045, 'grad_norm': 35.47040557861328, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]100%|██████████| 40/40 [00:39<00:00,  1.22it/s]                                               {'loss': 1.7262, 'grad_norm': 16.03762435913086, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.22it/s]                                               {'train_runtime': 39.5823, 'train_samples_per_second': 14.274, 'train_steps_per_second': 1.011, 'train_loss': 1.7050932377576828, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.22it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:19
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]                                              {'loss': 2.125, 'grad_norm': 4.439469814300537, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]                                              {'loss': 2.0462, 'grad_norm': 5.60770845413208, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.12s/it]  8%|▊         | 3/40 [00:03<00:41,  1.12s/it]                                              {'loss': 2.2339, 'grad_norm': 5.171523571014404, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:41,  1.12s/it] 10%|█         | 4/40 [00:04<00:40,  1.14s/it]                                              {'loss': 2.1356, 'grad_norm': 5.41317892074585, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.14s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 1.9142, 'grad_norm': 4.954742431640625, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it]                                              {'loss': 2.0191, 'grad_norm': 4.333381175994873, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it] 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it]                                              {'loss': 2.0992, 'grad_norm': 11.004718780517578, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:27,  1.18it/s]                                              {'loss': 2.6476, 'grad_norm': 29.275266647338867, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:27,  1.18it/s] 22%|██▎       | 9/40 [00:09<00:28,  1.08it/s]                                              {'loss': 1.9291, 'grad_norm': 20.47139549255371, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:28,  1.08it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.00it/s]                                               {'loss': 1.8288, 'grad_norm': 4.964191436767578, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.00it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it]                                               {'loss': 2.1119, 'grad_norm': 8.881352424621582, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it] 30%|███       | 12/40 [00:12<00:30,  1.07s/it]                                               {'loss': 1.8494, 'grad_norm': 4.699143886566162, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:30,  1.07s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.09s/it]                                               {'loss': 1.8617, 'grad_norm': 5.428525924682617, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.09s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.11s/it]                                               {'loss': 1.7785, 'grad_norm': 3.98551344871521, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.11s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it]                                               {'loss': 2.021, 'grad_norm': 4.774721145629883, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it] 40%|████      | 16/40 [00:16<00:20,  1.19it/s]                                               {'loss': 1.6722, 'grad_norm': 20.55849266052246, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s]                                               {'loss': 1.7111, 'grad_norm': 4.043248176574707, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s]                                               {'loss': 1.7057, 'grad_norm': 5.569235801696777, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it]                                               {'loss': 2.128, 'grad_norm': 4.872341156005859, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 1.5658, 'grad_norm': 4.734991550445557, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.08s/it]                                               {'loss': 1.6656, 'grad_norm': 11.353571891784668, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.08s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it]                                               {'loss': 1.7375, 'grad_norm': 3.6482675075531006, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.10s/it]                                               {'loss': 1.6074, 'grad_norm': 3.2859134674072266, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.10s/it] 60%|██████    | 24/40 [00:24<00:13,  1.21it/s]                                               {'loss': 2.1176, 'grad_norm': 19.129791259765625, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s]                                               {'loss': 1.4845, 'grad_norm': 3.5554263591766357, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s]                                               {'loss': 1.7166, 'grad_norm': 63.6769905090332, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 1.7825, 'grad_norm': 5.751873970031738, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:12,  1.06s/it]                                               {'loss': 1.7071, 'grad_norm': 4.0105743408203125, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it]                                               {'loss': 1.6064, 'grad_norm': 11.176241874694824, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:11,  1.10s/it]                                               {'loss': 1.7274, 'grad_norm': 4.905657768249512, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:11,  1.10s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.11s/it]                                               {'loss': 1.8833, 'grad_norm': 4.766475677490234, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.11s/it] 80%|████████  | 32/40 [00:32<00:06,  1.19it/s]                                               {'loss': 0.8579, 'grad_norm': 8.336256980895996, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.19it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s]                                               {'loss': 1.5627, 'grad_norm': 4.122204303741455, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.00it/s]                                               {'loss': 1.5834, 'grad_norm': 5.720736980438232, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.00it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.04s/it]                                               {'loss': 1.3754, 'grad_norm': 4.113794803619385, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.04s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.08s/it]                                               {'loss': 1.7236, 'grad_norm': 4.560825824737549, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.08s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it]                                               {'loss': 1.5998, 'grad_norm': 3.7328693866729736, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.09s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.12s/it]                                               {'loss': 1.8143, 'grad_norm': 3.944423198699951, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.12s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.12s/it]                                               {'loss': 1.6901, 'grad_norm': 4.627607345581055, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.12s/it]100%|██████████| 40/40 [00:40<00:00,  1.17it/s]                                               {'loss': 2.0359, 'grad_norm': 19.59457015991211, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.17it/s]                                               {'train_runtime': 40.8724, 'train_samples_per_second': 13.824, 'train_steps_per_second': 0.979, 'train_loss': 1.816579769551754, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.17it/s]100%|██████████| 40/40 [00:40<00:00,  1.02s/it]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 1.8256, 'grad_norm': 5.602514743804932, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]                                              {'loss': 1.726, 'grad_norm': 4.943077087402344, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]  8%|▊         | 3/40 [00:03<00:42,  1.15s/it]                                              {'loss': 2.2123, 'grad_norm': 6.076221466064453, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.15s/it] 10%|█         | 4/40 [00:04<00:41,  1.15s/it]                                              {'loss': 1.9869, 'grad_norm': 8.296463012695312, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.15s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.14s/it]                                              {'loss': 2.5219, 'grad_norm': 6.023571014404297, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.14s/it] 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it]                                              {'loss': 2.1683, 'grad_norm': 5.5888776779174805, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:38,  1.14s/it] 18%|█▊        | 7/40 [00:08<00:37,  1.14s/it]                                              {'loss': 1.981, 'grad_norm': 4.704866409301758, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:37,  1.14s/it] 20%|██        | 8/40 [00:08<00:32,  1.01s/it]                                              {'loss': 2.4261, 'grad_norm': 22.831974029541016, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:32,  1.01s/it] 22%|██▎       | 9/40 [00:09<00:32,  1.04s/it]                                              {'loss': 1.9854, 'grad_norm': 3.590913772583008, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:32,  1.04s/it] 25%|██▌       | 10/40 [00:11<00:32,  1.08s/it]                                               {'loss': 1.6401, 'grad_norm': 4.461431503295898, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:32,  1.08s/it] 28%|██▊       | 11/40 [00:12<00:31,  1.09s/it]                                               {'loss': 1.9515, 'grad_norm': 4.776707649230957, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:31,  1.09s/it] 30%|███       | 12/40 [00:13<00:29,  1.06s/it]                                               {'loss': 1.8449, 'grad_norm': 4.929097652435303, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:14<00:27,  1.04s/it]                                               {'loss': 2.1503, 'grad_norm': 6.051602363586426, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:27,  1.04s/it] 35%|███▌      | 14/40 [00:14<00:25,  1.01it/s]                                               {'loss': 1.8822, 'grad_norm': 7.821481227874756, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:25,  1.01it/s] 38%|███▊      | 15/40 [00:15<00:24,  1.01it/s]                                               {'loss': 1.6191, 'grad_norm': 4.113793849945068, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:24,  1.01it/s] 40%|████      | 16/40 [00:16<00:17,  1.36it/s]                                               {'loss': 2.8408, 'grad_norm': 20.086034774780273, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:17,  1.36it/s] 42%|████▎     | 17/40 [00:17<00:18,  1.23it/s]                                               {'loss': 1.6816, 'grad_norm': 4.390182971954346, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:18,  1.23it/s] 45%|████▌     | 18/40 [00:18<00:19,  1.11it/s]                                               {'loss': 1.7855, 'grad_norm': 4.774701118469238, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:19,  1.11it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.02it/s]                                               {'loss': 1.7434, 'grad_norm': 5.102266311645508, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.02it/s] 50%|█████     | 20/40 [00:20<00:20,  1.02s/it]                                               {'loss': 1.9259, 'grad_norm': 5.591565132141113, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.02s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 1.6252, 'grad_norm': 4.1849751472473145, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it]                                               {'loss': 1.8836, 'grad_norm': 5.252238750457764, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.08s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it]                                               {'loss': 1.8345, 'grad_norm': 4.979598522186279, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it] 60%|██████    | 24/40 [00:24<00:12,  1.24it/s]                                               {'loss': 0.887, 'grad_norm': 29.524250030517578, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:12,  1.24it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.19it/s]                                               {'loss': 1.4838, 'grad_norm': 4.072348117828369, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.19it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.14it/s]                                               {'loss': 1.5913, 'grad_norm': 4.490485191345215, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.14it/s] 68%|██████▊   | 27/40 [00:26<00:12,  1.07it/s]                                               {'loss': 1.6776, 'grad_norm': 8.27568244934082, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:12,  1.07it/s] 70%|███████   | 28/40 [00:28<00:12,  1.00s/it]                                               {'loss': 1.5538, 'grad_norm': 4.8846516609191895, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.00s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.04s/it]                                               {'loss': 1.7075, 'grad_norm': 6.5486040115356445, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.04s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.05s/it]                                               {'loss': 1.6222, 'grad_norm': 4.215145587921143, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.05s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.08s/it]                                               {'loss': 1.9713, 'grad_norm': 4.937747478485107, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.08s/it] 80%|████████  | 32/40 [00:31<00:06,  1.24it/s]                                               {'loss': 2.5352, 'grad_norm': 23.66034507751465, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.24it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.10it/s]                                               {'loss': 1.7765, 'grad_norm': 4.626577854156494, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.10it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s]                                               {'loss': 1.7097, 'grad_norm': 5.307456970214844, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.00it/s]                                               {'loss': 1.2762, 'grad_norm': 4.123970985412598, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.00it/s] 90%|█████████ | 36/40 [00:36<00:04,  1.04s/it]                                               {'loss': 1.6957, 'grad_norm': 6.8252339363098145, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.04s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it]                                               {'loss': 1.6633, 'grad_norm': 4.478726387023926, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.06s/it]                                               {'loss': 1.6801, 'grad_norm': 12.742623329162598, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.06s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.03s/it]                                               {'loss': 1.5007, 'grad_norm': 4.395971298217773, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.03s/it]100%|██████████| 40/40 [00:39<00:00,  1.30it/s]                                               {'loss': 1.5842, 'grad_norm': 22.969221115112305, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.30it/s]                                               {'train_runtime': 39.5545, 'train_samples_per_second': 14.284, 'train_steps_per_second': 1.011, 'train_loss': 1.8289574578404426, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.30it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:94
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 2.2263, 'grad_norm': 6.865902900695801, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]                                              {'loss': 2.0087, 'grad_norm': 6.265102386474609, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]  8%|▊         | 3/40 [00:03<00:42,  1.14s/it]                                              {'loss': 1.9718, 'grad_norm': 5.297423362731934, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.14s/it] 10%|█         | 4/40 [00:04<00:41,  1.14s/it]                                              {'loss': 1.9144, 'grad_norm': 5.183809757232666, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.14s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.15s/it]                                              {'loss': 2.1144, 'grad_norm': 5.66344690322876, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.15s/it] 15%|█▌        | 6/40 [00:06<00:36,  1.09s/it]                                              {'loss': 1.9056, 'grad_norm': 7.938838958740234, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:36,  1.09s/it] 18%|█▊        | 7/40 [00:07<00:34,  1.04s/it]                                              {'loss': 2.1798, 'grad_norm': 5.188982963562012, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:34,  1.04s/it] 20%|██        | 8/40 [00:08<00:28,  1.11it/s]                                              {'loss': 1.3283, 'grad_norm': 15.529302597045898, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:28,  1.11it/s] 22%|██▎       | 9/40 [00:09<00:30,  1.02it/s]                                              {'loss': 2.0806, 'grad_norm': 5.565628528594971, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:30,  1.02it/s] 25%|██▌       | 10/40 [00:10<00:30,  1.02s/it]                                               {'loss': 1.7531, 'grad_norm': 4.83466911315918, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:30,  1.02s/it] 28%|██▊       | 11/40 [00:11<00:30,  1.05s/it]                                               {'loss': 1.9657, 'grad_norm': 4.410656452178955, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:30,  1.05s/it] 30%|███       | 12/40 [00:12<00:29,  1.07s/it]                                               {'loss': 1.6787, 'grad_norm': 4.281983375549316, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.07s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.09s/it]                                               {'loss': 1.5883, 'grad_norm': 4.527693271636963, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.09s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.10s/it]                                               {'loss': 1.9098, 'grad_norm': 4.311460494995117, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.10s/it]                                               {'loss': 2.1729, 'grad_norm': 6.145462512969971, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.10s/it] 40%|████      | 16/40 [00:16<00:20,  1.20it/s]                                               {'loss': 3.1336, 'grad_norm': 35.45296096801758, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.20it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s]                                               {'loss': 1.856, 'grad_norm': 4.263664722442627, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s]                                               {'loss': 1.5549, 'grad_norm': 4.056571960449219, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it]                                               {'loss': 1.9026, 'grad_norm': 5.293242931365967, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 1.8905, 'grad_norm': 5.515921592712402, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 1.7927, 'grad_norm': 5.08399772644043, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it]                                               {'loss': 1.8772, 'grad_norm': 4.142910480499268, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.08s/it]                                               {'loss': 1.8072, 'grad_norm': 3.460115432739258, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.08s/it] 60%|██████    | 24/40 [00:24<00:13,  1.21it/s]                                               {'loss': 0.5845, 'grad_norm': 7.132516384124756, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:25<00:12,  1.16it/s]                                               {'loss': 1.7008, 'grad_norm': 4.323200702667236, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:12,  1.16it/s] 65%|██████▌   | 26/40 [00:26<00:12,  1.12it/s]                                               {'loss': 1.6622, 'grad_norm': 4.086194038391113, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:12,  1.12it/s] 68%|██████▊   | 27/40 [00:27<00:11,  1.10it/s]                                               {'loss': 1.4096, 'grad_norm': 3.926555871963501, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:11,  1.10it/s] 70%|███████   | 28/40 [00:28<00:11,  1.03it/s]                                               {'loss': 1.7753, 'grad_norm': 4.277405738830566, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:11,  1.03it/s] 72%|███████▎  | 29/40 [00:29<00:11,  1.02s/it]                                               {'loss': 1.7236, 'grad_norm': 4.168288707733154, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.02s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.04s/it]                                               {'loss': 1.7581, 'grad_norm': 8.714703559875488, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.04s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.07s/it]                                               {'loss': 1.775, 'grad_norm': 4.629749774932861, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.07s/it] 80%|████████  | 32/40 [00:31<00:06,  1.25it/s]                                               {'loss': 3.3882, 'grad_norm': 51.155357360839844, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.25it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s]                                               {'loss': 1.7308, 'grad_norm': 4.133754730224609, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s]                                               {'loss': 1.7835, 'grad_norm': 4.864479064941406, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.02s/it]                                               {'loss': 1.7228, 'grad_norm': 5.236974716186523, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it]                                               {'loss': 1.304, 'grad_norm': 3.1772191524505615, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it]                                               {'loss': 1.673, 'grad_norm': 4.3579020500183105, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.07s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.08s/it]                                               {'loss': 1.9164, 'grad_norm': 6.078867435455322, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.10s/it]                                               {'loss': 1.6595, 'grad_norm': 5.215441703796387, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.10s/it]100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'loss': 0.5531, 'grad_norm': 6.235209941864014, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'train_runtime': 40.0734, 'train_samples_per_second': 14.099, 'train_steps_per_second': 0.998, 'train_loss': 1.8183392778038978, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.20it/s]100%|██████████| 40/40 [00:40<00:00,  1.00s/it]
CLIENT:25
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:36,  1.06it/s]                                              {'loss': 2.0725, 'grad_norm': 5.175307273864746, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:36,  1.06it/s]  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]                                              {'loss': 1.9701, 'grad_norm': 6.573942184448242, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]  8%|▊         | 3/40 [00:03<00:39,  1.07s/it]                                              {'loss': 2.1559, 'grad_norm': 5.540600299835205, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:39,  1.07s/it] 10%|█         | 4/40 [00:04<00:39,  1.10s/it]                                              {'loss': 2.2926, 'grad_norm': 5.592166900634766, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.10s/it] 12%|█▎        | 5/40 [00:05<00:37,  1.08s/it]                                              {'loss': 2.2704, 'grad_norm': 6.53401517868042, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:37,  1.08s/it] 15%|█▌        | 6/40 [00:06<00:36,  1.09s/it]                                              {'loss': 2.6027, 'grad_norm': 5.691984176635742, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:36,  1.09s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it]                                              {'loss': 2.1812, 'grad_norm': 5.654122352600098, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it] 20%|██        | 8/40 [00:07<00:27,  1.18it/s]                                              {'loss': 1.8121, 'grad_norm': 15.527779579162598, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:27,  1.18it/s] 22%|██▎       | 9/40 [00:08<00:28,  1.09it/s]                                              {'loss': 1.974, 'grad_norm': 5.591267108917236, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:28,  1.09it/s] 25%|██▌       | 10/40 [00:10<00:28,  1.04it/s]                                               {'loss': 2.0013, 'grad_norm': 4.241015911102295, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:28,  1.04it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.02s/it]                                               {'loss': 2.052, 'grad_norm': 4.806384086608887, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.02s/it] 30%|███       | 12/40 [00:12<00:29,  1.05s/it]                                               {'loss': 1.8291, 'grad_norm': 5.656482219696045, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.05s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it]                                               {'loss': 1.9275, 'grad_norm': 5.118946552276611, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.08s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.09s/it]                                               {'loss': 1.8746, 'grad_norm': 5.204570770263672, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.09s/it] 38%|███▊      | 15/40 [00:15<00:27,  1.10s/it]                                               {'loss': 2.1602, 'grad_norm': 5.309473037719727, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:27,  1.10s/it] 40%|████      | 16/40 [00:15<00:19,  1.21it/s]                                               {'loss': 2.7569, 'grad_norm': 18.310176849365234, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.21it/s] 42%|████▎     | 17/40 [00:16<00:21,  1.09it/s]                                               {'loss': 2.0989, 'grad_norm': 6.039296627044678, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s]                                               {'loss': 1.9686, 'grad_norm': 4.257798194885254, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.03it/s] 48%|████▊     | 19/40 [00:19<00:20,  1.04it/s]                                               {'loss': 1.8153, 'grad_norm': 4.350839138031006, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:20,  1.04it/s] 50%|█████     | 20/40 [00:19<00:19,  1.05it/s]                                               {'loss': 1.8551, 'grad_norm': 4.932740688323975, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:19,  1.05it/s] 52%|█████▎    | 21/40 [00:20<00:18,  1.04it/s]                                               {'loss': 1.9105, 'grad_norm': 4.175954818725586, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:18,  1.04it/s] 55%|█████▌    | 22/40 [00:22<00:18,  1.00s/it]                                               {'loss': 1.8678, 'grad_norm': 4.822934627532959, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.00s/it] 57%|█████▊    | 23/40 [00:23<00:17,  1.05s/it]                                               {'loss': 1.7458, 'grad_norm': 4.315219879150391, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:17,  1.05s/it] 60%|██████    | 24/40 [00:23<00:12,  1.26it/s]                                               {'loss': 2.4509, 'grad_norm': 15.972722053527832, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.26it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.12it/s]                                               {'loss': 2.0126, 'grad_norm': 7.968886852264404, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.12it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.04it/s]                                               {'loss': 1.7534, 'grad_norm': 3.93882155418396, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.04it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.02s/it]                                               {'loss': 1.6734, 'grad_norm': 4.173091888427734, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.02s/it] 70%|███████   | 28/40 [00:27<00:12,  1.04s/it]                                               {'loss': 1.7126, 'grad_norm': 5.233468532562256, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.04s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it]                                               {'loss': 1.4725, 'grad_norm': 4.187158584594727, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.09s/it]                                               {'loss': 1.947, 'grad_norm': 4.184150218963623, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.09s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it]                                               {'loss': 1.8598, 'grad_norm': 4.702952861785889, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it] 80%|████████  | 32/40 [00:31<00:06,  1.22it/s]                                               {'loss': 1.4494, 'grad_norm': 16.301197052001953, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.22it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.08it/s]                                               {'loss': 1.4664, 'grad_norm': 4.306691646575928, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s]                                               {'loss': 1.7821, 'grad_norm': 6.0090556144714355, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.03it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it]                                               {'loss': 1.5591, 'grad_norm': 3.92838716506958, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it]                                               {'loss': 1.6273, 'grad_norm': 4.714554786682129, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.04s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it]                                               {'loss': 1.9008, 'grad_norm': 5.683371543884277, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.06s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.04s/it]                                               {'loss': 1.7119, 'grad_norm': 7.658721923828125, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.04s/it] 98%|█████████▊| 39/40 [00:38<00:00,  1.00it/s]                                               {'loss': 2.1322, 'grad_norm': 5.291702747344971, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:00,  1.00it/s]100%|██████████| 40/40 [00:39<00:00,  1.33it/s]                                               {'loss': 2.1856, 'grad_norm': 14.984278678894043, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.33it/s]                                               {'train_runtime': 39.2378, 'train_samples_per_second': 14.399, 'train_steps_per_second': 1.019, 'train_loss': 1.9473026871681214, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.33it/s]100%|██████████| 40/40 [00:39<00:00,  1.02it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<02:01,  3.87it/s]  1%|          | 3/471 [00:01<02:55,  2.67it/s]  1%|          | 4/471 [00:01<03:24,  2.28it/s]  1%|          | 5/471 [00:02<03:45,  2.07it/s]  1%|▏         | 6/471 [00:02<03:57,  1.96it/s]  1%|▏         | 7/471 [00:03<04:01,  1.92it/s]  2%|▏         | 8/471 [00:03<04:02,  1.91it/s]  2%|▏         | 9/471 [00:04<04:02,  1.91it/s]  2%|▏         | 10/471 [00:04<04:04,  1.89it/s]  2%|▏         | 11/471 [00:05<04:08,  1.85it/s]  3%|▎         | 12/471 [00:05<04:10,  1.83it/s]  3%|▎         | 13/471 [00:06<04:10,  1.83it/s]  3%|▎         | 14/471 [00:07<04:08,  1.84it/s]  3%|▎         | 15/471 [00:07<04:10,  1.82it/s]  3%|▎         | 16/471 [00:08<04:11,  1.81it/s]  4%|▎         | 17/471 [00:08<04:10,  1.81it/s]  4%|▍         | 18/471 [00:09<04:11,  1.80it/s]  4%|▍         | 19/471 [00:09<04:03,  1.86it/s]  4%|▍         | 20/471 [00:10<03:49,  1.97it/s]  4%|▍         | 21/471 [00:10<03:41,  2.03it/s]  5%|▍         | 22/471 [00:11<03:36,  2.08it/s]  5%|▍         | 23/471 [00:11<03:34,  2.08it/s]  5%|▌         | 24/471 [00:12<03:32,  2.11it/s]  5%|▌         | 25/471 [00:12<03:42,  2.00it/s]  6%|▌         | 26/471 [00:13<03:48,  1.95it/s]  6%|▌         | 27/471 [00:13<03:46,  1.96it/s]  6%|▌         | 28/471 [00:14<03:47,  1.94it/s]  6%|▌         | 29/471 [00:14<03:53,  1.89it/s]  6%|▋         | 30/471 [00:15<03:53,  1.89it/s]  7%|▋         | 31/471 [00:15<03:57,  1.85it/s]  7%|▋         | 32/471 [00:16<03:59,  1.84it/s]  7%|▋         | 33/471 [00:16<03:55,  1.86it/s]  7%|▋         | 34/471 [00:17<03:47,  1.92it/s]  7%|▋         | 35/471 [00:17<03:46,  1.93it/s]  8%|▊         | 36/471 [00:18<03:47,  1.91it/s]  8%|▊         | 37/471 [00:19<03:52,  1.87it/s]  8%|▊         | 38/471 [00:19<03:51,  1.87it/s]  8%|▊         | 39/471 [00:20<03:51,  1.86it/s]  8%|▊         | 40/471 [00:20<03:54,  1.83it/s]  9%|▊         | 41/471 [00:21<03:51,  1.86it/s]  9%|▉         | 42/471 [00:21<03:49,  1.87it/s]  9%|▉         | 43/471 [00:22<03:41,  1.93it/s]  9%|▉         | 44/471 [00:22<03:34,  2.00it/s] 10%|▉         | 45/471 [00:23<03:30,  2.02it/s] 10%|▉         | 46/471 [00:23<03:27,  2.05it/s] 10%|▉         | 47/471 [00:24<03:24,  2.08it/s] 10%|█         | 48/471 [00:24<03:17,  2.14it/s] 10%|█         | 49/471 [00:25<03:23,  2.07it/s] 11%|█         | 50/471 [00:25<03:21,  2.09it/s] 11%|█         | 51/471 [00:26<03:20,  2.10it/s] 11%|█         | 52/471 [00:26<03:17,  2.12it/s] 11%|█▏        | 53/471 [00:26<03:17,  2.12it/s] 11%|█▏        | 54/471 [00:27<03:14,  2.15it/s] 12%|█▏        | 55/471 [00:27<03:05,  2.25it/s] 12%|█▏        | 56/471 [00:28<03:09,  2.19it/s] 12%|█▏        | 57/471 [00:28<03:11,  2.16it/s] 12%|█▏        | 58/471 [00:29<03:11,  2.16it/s] 13%|█▎        | 59/471 [00:29<03:09,  2.17it/s] 13%|█▎        | 60/471 [00:30<03:18,  2.07it/s] 13%|█▎        | 61/471 [00:30<03:29,  1.96it/s] 13%|█▎        | 62/471 [00:31<03:37,  1.88it/s] 13%|█▎        | 63/471 [00:31<03:40,  1.85it/s] 14%|█▎        | 64/471 [00:32<03:39,  1.86it/s] 14%|█▍        | 65/471 [00:33<03:41,  1.84it/s] 14%|█▍        | 66/471 [00:33<03:42,  1.82it/s] 14%|█▍        | 67/471 [00:34<03:33,  1.89it/s] 14%|█▍        | 68/471 [00:34<03:25,  1.96it/s] 15%|█▍        | 69/471 [00:34<03:16,  2.04it/s] 15%|█▍        | 70/471 [00:35<03:13,  2.07it/s] 15%|█▌        | 71/471 [00:35<03:13,  2.07it/s] 15%|█▌        | 72/471 [00:36<03:10,  2.10it/s] 15%|█▌        | 73/471 [00:36<03:16,  2.03it/s] 16%|█▌        | 74/471 [00:37<03:20,  1.98it/s] 16%|█▌        | 75/471 [00:37<03:20,  1.98it/s] 16%|█▌        | 76/471 [00:38<03:26,  1.91it/s] 16%|█▋        | 77/471 [00:39<03:31,  1.87it/s] 17%|█▋        | 78/471 [00:39<03:28,  1.88it/s] 17%|█▋        | 79/471 [00:40<03:31,  1.86it/s] 17%|█▋        | 80/471 [00:40<03:29,  1.87it/s] 17%|█▋        | 81/471 [00:41<03:28,  1.87it/s] 17%|█▋        | 82/471 [00:41<03:22,  1.92it/s] 18%|█▊        | 83/471 [00:42<03:24,  1.89it/s] 18%|█▊        | 84/471 [00:42<03:25,  1.88it/s] 18%|█▊        | 85/471 [00:43<03:29,  1.84it/s] 18%|█▊        | 86/471 [00:43<03:32,  1.81it/s] 18%|█▊        | 87/471 [00:44<03:32,  1.81it/s] 19%|█▊        | 88/471 [00:44<03:27,  1.84it/s] 19%|█▉        | 89/471 [00:45<03:30,  1.82it/s] 19%|█▉        | 90/471 [00:46<03:31,  1.80it/s] 19%|█▉        | 91/471 [00:46<03:18,  1.91it/s] 20%|█▉        | 92/471 [00:47<03:10,  1.99it/s] 20%|█▉        | 93/471 [00:47<03:04,  2.05it/s] 20%|█▉        | 94/471 [00:47<02:52,  2.18it/s] 20%|██        | 95/471 [00:48<02:42,  2.31it/s] 20%|██        | 96/471 [00:48<02:46,  2.26it/s] 21%|██        | 97/471 [00:49<02:48,  2.21it/s] 21%|██        | 98/471 [00:49<02:50,  2.19it/s] 21%|██        | 99/471 [00:50<02:53,  2.15it/s] 21%|██        | 100/471 [00:50<03:03,  2.02it/s] 21%|██▏       | 101/471 [00:51<03:06,  1.98it/s] 22%|██▏       | 102/471 [00:51<03:07,  1.97it/s] 22%|██▏       | 103/471 [00:52<03:15,  1.88it/s] 22%|██▏       | 104/471 [00:52<03:19,  1.84it/s] 22%|██▏       | 105/471 [00:53<03:19,  1.84it/s] 23%|██▎       | 106/471 [00:54<03:20,  1.82it/s] 23%|██▎       | 107/471 [00:54<03:18,  1.83it/s] 23%|██▎       | 108/471 [00:55<03:16,  1.85it/s] 23%|██▎       | 109/471 [00:55<03:17,  1.83it/s] 23%|██▎       | 110/471 [00:56<03:18,  1.82it/s] 24%|██▎       | 111/471 [00:56<03:16,  1.83it/s] 24%|██▍       | 112/471 [00:57<03:18,  1.81it/s] 24%|██▍       | 113/471 [00:57<03:19,  1.80it/s] 24%|██▍       | 114/471 [00:58<03:15,  1.82it/s] 24%|██▍       | 115/471 [00:58<03:16,  1.81it/s] 25%|██▍       | 116/471 [00:59<03:17,  1.80it/s] 25%|██▍       | 117/471 [01:00<03:19,  1.78it/s] 25%|██▌       | 118/471 [01:00<03:19,  1.77it/s] 25%|██▌       | 119/471 [01:01<03:17,  1.78it/s] 25%|██▌       | 120/471 [01:01<03:13,  1.82it/s] 26%|██▌       | 121/471 [01:02<03:14,  1.80it/s] 26%|██▌       | 122/471 [01:02<03:15,  1.78it/s] 26%|██▌       | 123/471 [01:03<03:15,  1.78it/s] 26%|██▋       | 124/471 [01:04<03:14,  1.79it/s] 27%|██▋       | 125/471 [01:04<03:09,  1.83it/s] 27%|██▋       | 126/471 [01:04<02:58,  1.93it/s] 27%|██▋       | 127/471 [01:05<02:48,  2.04it/s] 27%|██▋       | 128/471 [01:05<02:44,  2.09it/s] 27%|██▋       | 129/471 [01:06<02:41,  2.12it/s] 28%|██▊       | 130/471 [01:06<02:38,  2.15it/s] 28%|██▊       | 131/471 [01:07<02:47,  2.03it/s] 28%|██▊       | 132/471 [01:07<02:53,  1.95it/s] 28%|██▊       | 133/471 [01:08<02:55,  1.93it/s] 28%|██▊       | 134/471 [01:08<02:58,  1.88it/s] 29%|██▊       | 135/471 [01:09<03:00,  1.86it/s] 29%|██▉       | 136/471 [01:10<03:03,  1.83it/s] 29%|██▉       | 137/471 [01:10<03:02,  1.83it/s] 29%|██▉       | 138/471 [01:11<03:03,  1.81it/s] 30%|██▉       | 139/471 [01:11<02:58,  1.86it/s] 30%|██▉       | 140/471 [01:12<02:56,  1.88it/s] 30%|██▉       | 141/471 [01:12<02:59,  1.84it/s] 30%|███       | 142/471 [01:13<02:59,  1.84it/s] 30%|███       | 143/471 [01:13<02:54,  1.88it/s] 31%|███       | 144/471 [01:14<02:56,  1.85it/s] 31%|███       | 145/471 [01:14<02:57,  1.84it/s] 31%|███       | 146/471 [01:15<02:55,  1.85it/s] 31%|███       | 147/471 [01:15<02:50,  1.90it/s] 31%|███▏      | 148/471 [01:16<02:50,  1.90it/s] 32%|███▏      | 149/471 [01:17<02:52,  1.87it/s] 32%|███▏      | 150/471 [01:17<02:55,  1.83it/s] 32%|███▏      | 151/471 [01:18<02:56,  1.81it/s] 32%|███▏      | 152/471 [01:18<02:57,  1.80it/s] 32%|███▏      | 153/471 [01:19<02:53,  1.83it/s] 33%|███▎      | 154/471 [01:19<02:52,  1.83it/s] 33%|███▎      | 155/471 [01:20<02:53,  1.82it/s] 33%|███▎      | 156/471 [01:20<02:53,  1.82it/s] 33%|███▎      | 157/471 [01:21<02:53,  1.81it/s] 34%|███▎      | 158/471 [01:22<02:52,  1.81it/s] 34%|███▍      | 159/471 [01:22<02:50,  1.83it/s] 34%|███▍      | 160/471 [01:23<02:52,  1.81it/s] 34%|███▍      | 161/471 [01:23<02:51,  1.81it/s] 34%|███▍      | 162/471 [01:24<02:40,  1.92it/s] 35%|███▍      | 163/471 [01:24<02:36,  1.97it/s] 35%|███▍      | 164/471 [01:25<02:30,  2.04it/s] 35%|███▌      | 165/471 [01:25<02:29,  2.04it/s] 35%|███▌      | 166/471 [01:26<02:29,  2.03it/s] 35%|███▌      | 167/471 [01:26<02:31,  2.01it/s] 36%|███▌      | 168/471 [01:27<02:29,  2.03it/s] 36%|███▌      | 169/471 [01:27<02:36,  1.93it/s] 36%|███▌      | 170/471 [01:28<02:41,  1.86it/s] 36%|███▋      | 171/471 [01:28<02:43,  1.83it/s] 37%|███▋      | 172/471 [01:29<02:40,  1.86it/s] 37%|███▋      | 173/471 [01:29<02:39,  1.87it/s] 37%|███▋      | 174/471 [01:30<02:41,  1.84it/s] 37%|███▋      | 175/471 [01:30<02:43,  1.81it/s] 37%|███▋      | 176/471 [01:31<02:43,  1.81it/s] 38%|███▊      | 177/471 [01:32<02:41,  1.82it/s] 38%|███▊      | 178/471 [01:32<02:40,  1.83it/s] 38%|███▊      | 179/471 [01:33<02:41,  1.80it/s] 38%|███▊      | 180/471 [01:33<02:39,  1.82it/s] 38%|███▊      | 181/471 [01:34<02:38,  1.82it/s] 39%|███▊      | 182/471 [01:34<02:39,  1.81it/s] 39%|███▉      | 183/471 [01:35<02:37,  1.83it/s] 39%|███▉      | 184/471 [01:35<02:31,  1.89it/s] 39%|███▉      | 185/471 [01:36<02:33,  1.86it/s] 39%|███▉      | 186/471 [01:36<02:35,  1.83it/s] 40%|███▉      | 187/471 [01:37<02:37,  1.81it/s] 40%|███▉      | 188/471 [01:38<02:37,  1.79it/s] 40%|████      | 189/471 [01:38<02:35,  1.82it/s] 40%|████      | 190/471 [01:39<02:34,  1.81it/s] 41%|████      | 191/471 [01:39<02:35,  1.80it/s] 41%|████      | 192/471 [01:40<02:35,  1.80it/s] 41%|████      | 193/471 [01:40<02:34,  1.80it/s] 41%|████      | 194/471 [01:41<02:32,  1.82it/s] 41%|████▏     | 195/471 [01:41<02:33,  1.80it/s] 42%|████▏     | 196/471 [01:42<02:35,  1.77it/s] 42%|████▏     | 197/471 [01:43<02:34,  1.77it/s] 42%|████▏     | 198/471 [01:43<02:32,  1.79it/s] 42%|████▏     | 199/471 [01:44<02:21,  1.92it/s] 42%|████▏     | 200/471 [01:44<02:14,  2.02it/s] 43%|████▎     | 201/471 [01:45<02:10,  2.06it/s] 43%|████▎     | 202/471 [01:45<02:08,  2.10it/s] 43%|████▎     | 203/471 [01:45<02:05,  2.14it/s] 43%|████▎     | 204/471 [01:46<02:10,  2.05it/s] 44%|████▎     | 205/471 [01:46<02:14,  1.97it/s] 44%|████▎     | 206/471 [01:47<02:17,  1.93it/s] 44%|████▍     | 207/471 [01:48<02:15,  1.95it/s] 44%|████▍     | 208/471 [01:48<02:18,  1.89it/s] 44%|████▍     | 209/471 [01:49<02:21,  1.85it/s] 45%|████▍     | 210/471 [01:49<02:23,  1.82it/s] 45%|████▍     | 211/471 [01:50<02:21,  1.84it/s] 45%|████▌     | 212/471 [01:50<02:21,  1.83it/s] 45%|████▌     | 213/471 [01:51<02:20,  1.84it/s] 45%|████▌     | 214/471 [01:51<02:20,  1.83it/s] 46%|████▌     | 215/471 [01:52<02:21,  1.80it/s] 46%|████▌     | 216/471 [01:53<02:21,  1.80it/s] 46%|████▌     | 217/471 [01:53<02:21,  1.80it/s] 46%|████▋     | 218/471 [01:54<02:20,  1.80it/s] 46%|████▋     | 219/471 [01:54<02:18,  1.81it/s] 47%|████▋     | 220/471 [01:55<02:19,  1.80it/s] 47%|████▋     | 221/471 [01:55<02:19,  1.79it/s] 47%|████▋     | 222/471 [01:56<02:18,  1.80it/s] 47%|████▋     | 223/471 [01:56<02:17,  1.81it/s] 48%|████▊     | 224/471 [01:57<02:17,  1.80it/s] 48%|████▊     | 225/471 [01:58<02:16,  1.80it/s] 48%|████▊     | 226/471 [01:58<02:16,  1.79it/s] 48%|████▊     | 227/471 [01:59<02:15,  1.80it/s] 48%|████▊     | 228/471 [01:59<02:16,  1.79it/s] 49%|████▊     | 229/471 [02:00<02:16,  1.77it/s] 49%|████▉     | 230/471 [02:00<02:15,  1.77it/s] 49%|████▉     | 231/471 [02:01<02:13,  1.80it/s] 49%|████▉     | 232/471 [02:01<02:10,  1.82it/s] 49%|████▉     | 233/471 [02:02<02:12,  1.80it/s] 50%|████▉     | 234/471 [02:03<02:14,  1.77it/s] 50%|████▉     | 235/471 [02:03<02:13,  1.76it/s] 50%|█████     | 236/471 [02:04<02:12,  1.78it/s] 50%|█████     | 237/471 [02:04<02:07,  1.83it/s] 51%|█████     | 238/471 [02:05<02:09,  1.80it/s] 51%|█████     | 239/471 [02:05<02:09,  1.78it/s] 51%|█████     | 240/471 [02:06<02:09,  1.79it/s] 51%|█████     | 241/471 [02:06<02:07,  1.80it/s] 51%|█████▏    | 242/471 [02:07<02:06,  1.81it/s] 52%|█████▏    | 243/471 [02:08<02:05,  1.82it/s] 52%|█████▏    | 244/471 [02:08<02:04,  1.82it/s] 52%|█████▏    | 245/471 [02:09<02:06,  1.78it/s] 52%|█████▏    | 246/471 [02:09<02:05,  1.79it/s] 52%|█████▏    | 247/471 [02:10<02:05,  1.79it/s] 53%|█████▎    | 248/471 [02:10<02:03,  1.81it/s] 53%|█████▎    | 249/471 [02:11<02:01,  1.82it/s] 53%|█████▎    | 250/471 [02:11<02:02,  1.80it/s] 53%|█████▎    | 251/471 [02:12<02:03,  1.78it/s] 54%|█████▎    | 252/471 [02:13<02:02,  1.79it/s] 54%|█████▎    | 253/471 [02:13<02:01,  1.79it/s] 54%|█████▍    | 254/471 [02:14<01:58,  1.83it/s] 54%|█████▍    | 255/471 [02:14<01:58,  1.83it/s] 54%|█████▍    | 256/471 [02:15<01:58,  1.81it/s] 55%|█████▍    | 257/471 [02:15<01:58,  1.80it/s] 55%|█████▍    | 258/471 [02:16<01:59,  1.79it/s] 55%|█████▍    | 259/471 [02:16<01:58,  1.79it/s] 55%|█████▌    | 260/471 [02:17<01:55,  1.82it/s] 55%|█████▌    | 261/471 [02:18<01:55,  1.82it/s] 56%|█████▌    | 262/471 [02:18<01:56,  1.80it/s] 56%|█████▌    | 263/471 [02:19<01:57,  1.78it/s] 56%|█████▌    | 264/471 [02:19<01:56,  1.78it/s] 56%|█████▋    | 265/471 [02:20<01:55,  1.78it/s] 56%|█████▋    | 266/471 [02:20<01:51,  1.84it/s] 57%|█████▋    | 267/471 [02:21<01:53,  1.80it/s] 57%|█████▋    | 268/471 [02:21<01:53,  1.79it/s] 57%|█████▋    | 269/471 [02:22<01:53,  1.78it/s] 57%|█████▋    | 270/471 [02:23<01:52,  1.79it/s] 58%|█████▊    | 271/471 [02:23<01:51,  1.80it/s] 58%|█████▊    | 272/471 [02:24<01:48,  1.83it/s] 58%|█████▊    | 273/471 [02:24<01:49,  1.80it/s] 58%|█████▊    | 274/471 [02:25<01:48,  1.81it/s] 58%|█████▊    | 275/471 [02:25<01:48,  1.80it/s] 59%|█████▊    | 276/471 [02:26<01:49,  1.78it/s] 59%|█████▉    | 277/471 [02:26<01:48,  1.79it/s] 59%|█████▉    | 278/471 [02:27<01:47,  1.79it/s] 59%|█████▉    | 279/471 [02:28<01:46,  1.80it/s] 59%|█████▉    | 280/471 [02:28<01:45,  1.81it/s] 60%|█████▉    | 281/471 [02:29<01:45,  1.80it/s] 60%|█████▉    | 282/471 [02:29<01:46,  1.78it/s] 60%|██████    | 283/471 [02:30<01:44,  1.79it/s] 60%|██████    | 284/471 [02:30<01:44,  1.79it/s] 61%|██████    | 285/471 [02:31<01:43,  1.80it/s] 61%|██████    | 286/471 [02:31<01:43,  1.78it/s] 61%|██████    | 287/471 [02:32<01:43,  1.77it/s] 61%|██████    | 288/471 [02:33<01:43,  1.76it/s] 61%|██████▏   | 289/471 [02:33<01:40,  1.80it/s] 62%|██████▏   | 290/471 [02:34<01:39,  1.82it/s] 62%|██████▏   | 291/471 [02:34<01:40,  1.79it/s] 62%|██████▏   | 292/471 [02:35<01:40,  1.79it/s] 62%|██████▏   | 293/471 [02:35<01:39,  1.80it/s] 62%|██████▏   | 294/471 [02:36<01:37,  1.81it/s] 63%|██████▎   | 295/471 [02:36<01:35,  1.84it/s] 63%|██████▎   | 296/471 [02:37<01:34,  1.86it/s] 63%|██████▎   | 297/471 [02:38<01:35,  1.82it/s] 63%|██████▎   | 298/471 [02:38<01:35,  1.81it/s] 63%|██████▎   | 299/471 [02:39<01:36,  1.79it/s] 64%|██████▎   | 300/471 [02:39<01:35,  1.79it/s] 64%|██████▍   | 301/471 [02:40<01:34,  1.80it/s] 64%|██████▍   | 302/471 [02:40<01:32,  1.83it/s] 64%|██████▍   | 303/471 [02:41<01:32,  1.82it/s] 65%|██████▍   | 304/471 [02:41<01:32,  1.80it/s] 65%|██████▍   | 305/471 [02:42<01:33,  1.78it/s] 65%|██████▍   | 306/471 [02:43<01:33,  1.77it/s] 65%|██████▌   | 307/471 [02:43<01:30,  1.82it/s] 65%|██████▌   | 308/471 [02:44<01:30,  1.81it/s] 66%|██████▌   | 309/471 [02:44<01:29,  1.80it/s] 66%|██████▌   | 310/471 [02:45<01:30,  1.79it/s] 66%|██████▌   | 311/471 [02:45<01:29,  1.79it/s] 66%|██████▌   | 312/471 [02:46<01:29,  1.78it/s] 66%|██████▋   | 313/471 [02:46<01:26,  1.83it/s] 67%|██████▋   | 314/471 [02:47<01:26,  1.82it/s] 67%|██████▋   | 315/471 [02:48<01:26,  1.80it/s] 67%|██████▋   | 316/471 [02:48<01:26,  1.79it/s] 67%|██████▋   | 317/471 [02:49<01:26,  1.79it/s] 68%|██████▊   | 318/471 [02:49<01:24,  1.80it/s] 68%|██████▊   | 319/471 [02:50<01:22,  1.85it/s] 68%|██████▊   | 320/471 [02:50<01:22,  1.84it/s] 68%|██████▊   | 321/471 [02:51<01:22,  1.81it/s] 68%|██████▊   | 322/471 [02:51<01:22,  1.81it/s] 69%|██████▊   | 323/471 [02:52<01:22,  1.80it/s] 69%|██████▉   | 324/471 [02:53<01:21,  1.79it/s] 69%|██████▉   | 325/471 [02:53<01:20,  1.81it/s] 69%|██████▉   | 326/471 [02:54<01:20,  1.80it/s] 69%|██████▉   | 327/471 [02:54<01:20,  1.79it/s] 70%|██████▉   | 328/471 [02:55<01:18,  1.81it/s] 70%|██████▉   | 329/471 [02:55<01:14,  1.91it/s] 70%|███████   | 330/471 [02:56<01:10,  1.99it/s] 70%|███████   | 331/471 [02:56<01:09,  2.01it/s] 70%|███████   | 332/471 [02:57<01:08,  2.02it/s] 71%|███████   | 333/471 [02:57<01:07,  2.06it/s] 71%|███████   | 334/471 [02:58<01:04,  2.11it/s] 71%|███████   | 335/471 [02:58<01:03,  2.16it/s] 71%|███████▏  | 336/471 [02:58<01:02,  2.16it/s] 72%|███████▏  | 337/471 [02:59<01:02,  2.15it/s] 72%|███████▏  | 338/471 [02:59<01:01,  2.15it/s] 72%|███████▏  | 339/471 [03:00<01:01,  2.14it/s] 72%|███████▏  | 340/471 [03:00<01:01,  2.13it/s] 72%|███████▏  | 341/471 [03:01<01:03,  2.04it/s] 73%|███████▎  | 342/471 [03:01<01:03,  2.03it/s] 73%|███████▎  | 343/471 [03:02<01:05,  1.95it/s] 73%|███████▎  | 344/471 [03:02<01:06,  1.90it/s] 73%|███████▎  | 345/471 [03:03<01:08,  1.85it/s] 73%|███████▎  | 346/471 [03:04<01:08,  1.83it/s] 74%|███████▎  | 347/471 [03:04<01:07,  1.83it/s] 74%|███████▍  | 348/471 [03:05<01:06,  1.86it/s] 74%|███████▍  | 349/471 [03:05<01:05,  1.87it/s] 74%|███████▍  | 350/471 [03:06<01:06,  1.83it/s] 75%|███████▍  | 351/471 [03:06<01:06,  1.82it/s] 75%|███████▍  | 352/471 [03:07<01:05,  1.83it/s] 75%|███████▍  | 353/471 [03:07<01:01,  1.90it/s] 75%|███████▌  | 354/471 [03:08<00:59,  1.97it/s] 75%|███████▌  | 355/471 [03:08<00:56,  2.05it/s] 76%|███████▌  | 356/471 [03:09<00:54,  2.11it/s] 76%|███████▌  | 357/471 [03:09<00:53,  2.12it/s] 76%|███████▌  | 358/471 [03:10<00:56,  2.00it/s] 76%|███████▌  | 359/471 [03:10<00:58,  1.93it/s] 76%|███████▋  | 360/471 [03:11<00:59,  1.88it/s] 77%|███████▋  | 361/471 [03:11<00:59,  1.85it/s] 77%|███████▋  | 362/471 [03:12<00:58,  1.87it/s] 77%|███████▋  | 363/471 [03:12<00:58,  1.86it/s] 77%|███████▋  | 364/471 [03:13<00:58,  1.83it/s] 77%|███████▋  | 365/471 [03:14<00:58,  1.80it/s] 78%|███████▊  | 366/471 [03:14<00:58,  1.80it/s] 78%|███████▊  | 367/471 [03:15<00:58,  1.79it/s] 78%|███████▊  | 368/471 [03:15<00:55,  1.84it/s] 78%|███████▊  | 369/471 [03:16<00:55,  1.83it/s] 79%|███████▊  | 370/471 [03:16<00:56,  1.80it/s] 79%|███████▉  | 371/471 [03:17<00:56,  1.78it/s] 79%|███████▉  | 372/471 [03:18<00:55,  1.78it/s] 79%|███████▉  | 373/471 [03:18<00:54,  1.79it/s] 79%|███████▉  | 374/471 [03:19<00:52,  1.84it/s] 80%|███████▉  | 375/471 [03:19<00:52,  1.84it/s] 80%|███████▉  | 376/471 [03:20<00:52,  1.83it/s] 80%|████████  | 377/471 [03:20<00:52,  1.81it/s] 80%|████████  | 378/471 [03:21<00:51,  1.80it/s] 80%|████████  | 379/471 [03:21<00:50,  1.83it/s] 81%|████████  | 380/471 [03:22<00:47,  1.92it/s] 81%|████████  | 381/471 [03:22<00:44,  2.03it/s] 81%|████████  | 382/471 [03:23<00:43,  2.06it/s] 81%|████████▏ | 383/471 [03:23<00:42,  2.07it/s] 82%|████████▏ | 384/471 [03:24<00:41,  2.09it/s] 82%|████████▏ | 385/471 [03:24<00:43,  1.99it/s] 82%|████████▏ | 386/471 [03:25<00:42,  2.00it/s] 82%|████████▏ | 387/471 [03:25<00:42,  1.99it/s] 82%|████████▏ | 388/471 [03:26<00:42,  1.97it/s] 83%|████████▎ | 389/471 [03:26<00:41,  2.00it/s] 83%|████████▎ | 390/471 [03:27<00:39,  2.05it/s] 83%|████████▎ | 391/471 [03:27<00:38,  2.10it/s] 83%|████████▎ | 392/471 [03:28<00:37,  2.11it/s] 83%|████████▎ | 393/471 [03:28<00:36,  2.13it/s] 84%|████████▎ | 394/471 [03:29<00:38,  2.01it/s] 84%|████████▍ | 395/471 [03:29<00:39,  1.95it/s] 84%|████████▍ | 396/471 [03:30<00:39,  1.92it/s] 84%|████████▍ | 397/471 [03:30<00:39,  1.88it/s] 85%|████████▍ | 398/471 [03:31<00:39,  1.83it/s] 85%|████████▍ | 399/471 [03:31<00:39,  1.82it/s] 85%|████████▍ | 400/471 [03:32<00:39,  1.82it/s] 85%|████████▌ | 401/471 [03:32<00:37,  1.85it/s] 85%|████████▌ | 402/471 [03:33<00:37,  1.84it/s] 86%|████████▌ | 403/471 [03:34<00:37,  1.83it/s] 86%|████████▌ | 404/471 [03:34<00:36,  1.82it/s] 86%|████████▌ | 405/471 [03:35<00:36,  1.82it/s] 86%|████████▌ | 406/471 [03:35<00:35,  1.83it/s] 86%|████████▋ | 407/471 [03:36<00:34,  1.84it/s] 87%|████████▋ | 408/471 [03:36<00:34,  1.83it/s] 87%|████████▋ | 409/471 [03:37<00:34,  1.81it/s] 87%|████████▋ | 410/471 [03:37<00:34,  1.79it/s] 87%|████████▋ | 411/471 [03:38<00:33,  1.78it/s] 87%|████████▋ | 412/471 [03:39<00:32,  1.79it/s] 88%|████████▊ | 413/471 [03:39<00:31,  1.82it/s] 88%|████████▊ | 414/471 [03:40<00:31,  1.82it/s] 88%|████████▊ | 415/471 [03:40<00:30,  1.82it/s] 88%|████████▊ | 416/471 [03:41<00:30,  1.80it/s] 89%|████████▊ | 417/471 [03:41<00:30,  1.79it/s] 89%|████████▊ | 418/471 [03:42<00:29,  1.82it/s] 89%|████████▉ | 419/471 [03:42<00:28,  1.83it/s] 89%|████████▉ | 420/471 [03:43<00:28,  1.81it/s] 89%|████████▉ | 421/471 [03:44<00:27,  1.79it/s] 90%|████████▉ | 422/471 [03:44<00:27,  1.81it/s] 90%|████████▉ | 423/471 [03:45<00:26,  1.80it/s] 90%|█████████ | 424/471 [03:45<00:25,  1.84it/s] 90%|█████████ | 425/471 [03:46<00:23,  1.92it/s] 90%|█████████ | 426/471 [03:46<00:22,  1.96it/s] 91%|█████████ | 427/471 [03:47<00:21,  2.00it/s] 91%|█████████ | 428/471 [03:47<00:20,  2.06it/s] 91%|█████████ | 429/471 [03:47<00:19,  2.12it/s] 91%|█████████▏| 430/471 [03:48<00:19,  2.13it/s] 92%|█████████▏| 431/471 [03:49<00:20,  1.99it/s] 92%|█████████▏| 432/471 [03:49<00:20,  1.92it/s] 92%|█████████▏| 433/471 [03:50<00:20,  1.88it/s] 92%|█████████▏| 434/471 [03:50<00:19,  1.87it/s] 92%|█████████▏| 435/471 [03:51<00:19,  1.86it/s] 93%|█████████▎| 436/471 [03:51<00:19,  1.83it/s] 93%|█████████▎| 437/471 [03:52<00:18,  1.81it/s] 93%|█████████▎| 438/471 [03:52<00:18,  1.81it/s] 93%|█████████▎| 439/471 [03:53<00:17,  1.83it/s] 93%|█████████▎| 440/471 [03:53<00:16,  1.85it/s] 94%|█████████▎| 441/471 [03:54<00:16,  1.82it/s] 94%|█████████▍| 442/471 [03:55<00:16,  1.80it/s] 94%|█████████▍| 443/471 [03:55<00:15,  1.82it/s] 94%|█████████▍| 444/471 [03:56<00:14,  1.81it/s] 94%|█████████▍| 445/471 [03:56<00:14,  1.84it/s] 95%|█████████▍| 446/471 [03:57<00:13,  1.83it/s] 95%|█████████▍| 447/471 [03:57<00:13,  1.81it/s] 95%|█████████▌| 448/471 [03:58<00:12,  1.80it/s] 95%|█████████▌| 449/471 [03:58<00:12,  1.83it/s] 96%|█████████▌| 450/471 [03:59<00:11,  1.83it/s] 96%|█████████▌| 451/471 [04:00<00:11,  1.81it/s] 96%|█████████▌| 452/471 [04:00<00:10,  1.81it/s] 96%|█████████▌| 453/471 [04:01<00:09,  1.81it/s] 96%|█████████▋| 454/471 [04:01<00:09,  1.82it/s] 97%|█████████▋| 455/471 [04:02<00:08,  1.83it/s] 97%|█████████▋| 456/471 [04:02<00:08,  1.80it/s] 97%|█████████▋| 457/471 [04:03<00:07,  1.78it/s] 97%|█████████▋| 458/471 [04:03<00:07,  1.77it/s] 97%|█████████▋| 459/471 [04:04<00:06,  1.84it/s] 98%|█████████▊| 460/471 [04:04<00:05,  1.86it/s] 98%|█████████▊| 461/471 [04:05<00:05,  1.86it/s] 98%|█████████▊| 462/471 [04:05<00:04,  1.95it/s] 98%|█████████▊| 463/471 [04:06<00:03,  2.02it/s] 99%|█████████▊| 464/471 [04:06<00:03,  2.08it/s] 99%|█████████▊| 465/471 [04:07<00:02,  2.12it/s] 99%|█████████▉| 466/471 [04:07<00:02,  2.09it/s] 99%|█████████▉| 467/471 [04:08<00:01,  2.12it/s] 99%|█████████▉| 468/471 [04:08<00:01,  2.12it/s]100%|█████████▉| 469/471 [04:09<00:00,  2.01it/s]100%|█████████▉| 470/471 [04:09<00:00,  1.94it/s]100%|██████████| 471/471 [04:10<00:00,  2.01it/s]100%|██████████| 471/471 [04:10<00:00,  1.88it/s]
{'eval_loss': 1.8494048118591309, 'eval_model_preparation_time': 0.0098, 'eval_acc': 0.5451407328730749, 'eval_runtime': 250.8375, 'eval_samples_per_second': 30.027, 'eval_steps_per_second': 1.878}
ROUND:5
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]                                              {'loss': 1.9042, 'grad_norm': 5.040455341339111, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]                                              {'loss': 1.9968, 'grad_norm': 5.952643871307373, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:42,  1.11s/it]  8%|▊         | 3/40 [00:03<00:40,  1.10s/it]                                              {'loss': 1.8333, 'grad_norm': 4.778383255004883, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:40,  1.10s/it] 10%|█         | 4/40 [00:04<00:38,  1.08s/it]                                              {'loss': 1.9755, 'grad_norm': 5.545662879943848, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:38,  1.08s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it]                                              {'loss': 1.7694, 'grad_norm': 4.878167629241943, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it]                                              {'loss': 1.7999, 'grad_norm': 8.304475784301758, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.10s/it] 18%|█▊        | 7/40 [00:07<00:35,  1.08s/it]                                              {'loss': 1.8346, 'grad_norm': 5.184081077575684, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:35,  1.08s/it] 20%|██        | 8/40 [00:07<00:26,  1.23it/s]                                              {'loss': 1.5053, 'grad_norm': 13.227245330810547, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:26,  1.23it/s] 22%|██▎       | 9/40 [00:08<00:27,  1.12it/s]                                              {'loss': 1.9924, 'grad_norm': 5.031951427459717, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:27,  1.12it/s] 25%|██▌       | 10/40 [00:09<00:27,  1.07it/s]                                               {'loss': 1.6588, 'grad_norm': 13.356284141540527, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:27,  1.07it/s] 28%|██▊       | 11/40 [00:10<00:27,  1.07it/s]                                               {'loss': 1.2754, 'grad_norm': 5.281316757202148, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:27,  1.07it/s] 30%|███       | 12/40 [00:11<00:26,  1.06it/s]                                               {'loss': 1.59, 'grad_norm': 4.795073509216309, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:26,  1.06it/s] 32%|███▎      | 13/40 [00:13<00:27,  1.01s/it]                                               {'loss': 1.6631, 'grad_norm': 5.202464580535889, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:27,  1.01s/it] 35%|███▌      | 14/40 [00:14<00:27,  1.05s/it]                                               {'loss': 1.6367, 'grad_norm': 5.710681438446045, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:27,  1.05s/it] 38%|███▊      | 15/40 [00:15<00:26,  1.08s/it]                                               {'loss': 1.7837, 'grad_norm': 5.771381378173828, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:26,  1.08s/it] 40%|████      | 16/40 [00:15<00:19,  1.23it/s]                                               {'loss': 1.2107, 'grad_norm': 12.602364540100098, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.23it/s] 42%|████▎     | 17/40 [00:16<00:20,  1.10it/s]                                               {'loss': 1.2996, 'grad_norm': 3.8450815677642822, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:20,  1.10it/s] 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s]                                               {'loss': 1.438, 'grad_norm': 5.2292256355285645, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:18<00:21,  1.03s/it]                                               {'loss': 1.7943, 'grad_norm': 4.224358558654785, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 1.5884, 'grad_norm': 5.255471706390381, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.09s/it]                                               {'loss': 1.6919, 'grad_norm': 8.914361953735352, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it]                                               {'loss': 1.5879, 'grad_norm': 5.301947593688965, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.11s/it]                                               {'loss': 1.641, 'grad_norm': 4.299823760986328, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.11s/it] 60%|██████    | 24/40 [00:23<00:13,  1.20it/s]                                               {'loss': 1.8594, 'grad_norm': 16.762184143066406, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.08it/s]                                               {'loss': 1.4174, 'grad_norm': 3.524383783340454, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.08it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.01it/s]                                               {'loss': 1.356, 'grad_norm': 4.383391857147217, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.04s/it]                                               {'loss': 1.3825, 'grad_norm': 4.599661827087402, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.04s/it] 70%|███████   | 28/40 [00:28<00:12,  1.05s/it]                                               {'loss': 1.6589, 'grad_norm': 5.3505754470825195, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.05s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.03s/it]                                               {'loss': 1.3906, 'grad_norm': 4.217628002166748, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.03s/it] 75%|███████▌  | 30/40 [00:30<00:10,  1.00s/it]                                               {'loss': 1.5758, 'grad_norm': 7.16837739944458, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.00s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.05s/it]                                               {'loss': 1.5482, 'grad_norm': 6.870153903961182, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.05s/it] 80%|████████  | 32/40 [00:31<00:06,  1.27it/s]                                               {'loss': 2.1009, 'grad_norm': 22.192373275756836, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.27it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s]                                               {'loss': 1.4309, 'grad_norm': 4.680887699127197, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.11it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.04it/s]                                               {'loss': 1.2169, 'grad_norm': 4.389112949371338, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it]                                               {'loss': 1.6874, 'grad_norm': 4.536080360412598, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.05s/it]                                               {'loss': 1.7067, 'grad_norm': 4.816390037536621, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.05s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.04s/it]                                               {'loss': 1.291, 'grad_norm': 4.922045707702637, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.04s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.06s/it]                                               {'loss': 1.5421, 'grad_norm': 4.9205498695373535, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.06s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]                                               {'loss': 1.2347, 'grad_norm': 3.8204572200775146, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.08s/it]100%|██████████| 40/40 [00:39<00:00,  1.24it/s]                                               {'loss': 2.1394, 'grad_norm': 17.4796142578125, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.24it/s]                                               {'train_runtime': 39.5266, 'train_samples_per_second': 14.294, 'train_steps_per_second': 1.012, 'train_loss': 1.6252354592084886, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.24it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]                                              {'loss': 2.0298, 'grad_norm': 5.49449348449707, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]  5%|▌         | 2/40 [00:02<00:41,  1.10s/it]                                              {'loss': 1.9847, 'grad_norm': 4.459505081176758, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:41,  1.10s/it]  8%|▊         | 3/40 [00:03<00:38,  1.04s/it]                                              {'loss': 1.7799, 'grad_norm': 5.67027473449707, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:38,  1.04s/it] 10%|█         | 4/40 [00:04<00:36,  1.01s/it]                                              {'loss': 2.0329, 'grad_norm': 9.076787948608398, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:36,  1.01s/it] 12%|█▎        | 5/40 [00:05<00:36,  1.04s/it]                                              {'loss': 2.043, 'grad_norm': 5.464725971221924, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:36,  1.04s/it] 15%|█▌        | 6/40 [00:06<00:36,  1.07s/it]                                              {'loss': 1.8851, 'grad_norm': 6.862328052520752, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:36,  1.07s/it] 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it]                                              {'loss': 2.0334, 'grad_norm': 5.470987796783447, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:36,  1.10s/it] 20%|██        | 8/40 [00:08<00:29,  1.08it/s]                                              {'loss': 2.3899, 'grad_norm': 23.043596267700195, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:29,  1.08it/s] 22%|██▎       | 9/40 [00:09<00:30,  1.00it/s]                                              {'loss': 1.5813, 'grad_norm': 4.409217834472656, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:30,  1.00it/s] 25%|██▌       | 10/40 [00:10<00:31,  1.05s/it]                                               {'loss': 1.5249, 'grad_norm': 7.114054203033447, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:31,  1.05s/it] 28%|██▊       | 11/40 [00:11<00:30,  1.06s/it]                                               {'loss': 1.772, 'grad_norm': 4.21496057510376, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:30,  1.06s/it] 30%|███       | 12/40 [00:12<00:30,  1.10s/it]                                               {'loss': 2.0594, 'grad_norm': 7.20991849899292, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:30,  1.10s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.10s/it]                                               {'loss': 2.2943, 'grad_norm': 5.469282150268555, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.10s/it] 35%|███▌      | 14/40 [00:14<00:29,  1.12s/it]                                               {'loss': 1.7143, 'grad_norm': 4.398951053619385, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:29,  1.12s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it]                                               {'loss': 1.7828, 'grad_norm': 4.613569259643555, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it] 40%|████      | 16/40 [00:16<00:20,  1.17it/s]                                               {'loss': 2.0592, 'grad_norm': 14.479853630065918, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.17it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s]                                               {'loss': 1.4078, 'grad_norm': 3.819362163543701, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.08it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s]                                               {'loss': 1.5415, 'grad_norm': 5.009899616241455, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.04s/it]                                               {'loss': 1.8087, 'grad_norm': 27.564340591430664, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.04s/it] 50%|█████     | 20/40 [00:20<00:21,  1.05s/it]                                               {'loss': 1.7352, 'grad_norm': 4.0213942527771, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.05s/it] 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it]                                               {'loss': 1.9928, 'grad_norm': 5.223700046539307, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.03s/it] 55%|█████▌    | 22/40 [00:22<00:17,  1.00it/s]                                               {'loss': 1.7019, 'grad_norm': 3.9425466060638428, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:17,  1.00it/s] 57%|█████▊    | 23/40 [00:23<00:16,  1.01it/s]                                               {'loss': 1.4632, 'grad_norm': 4.867713928222656, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:16,  1.01it/s] 60%|██████    | 24/40 [00:23<00:11,  1.36it/s]                                               {'loss': 1.9396, 'grad_norm': 19.062753677368164, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:24<00:12,  1.20it/s]                                               {'loss': 1.7012, 'grad_norm': 4.2635602951049805, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:12,  1.20it/s] 65%|██████▌   | 26/40 [00:25<00:12,  1.14it/s]                                               {'loss': 1.4453, 'grad_norm': 5.051346302032471, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:12,  1.14it/s] 68%|██████▊   | 27/40 [00:26<00:11,  1.11it/s]                                               {'loss': 1.7661, 'grad_norm': 5.374111175537109, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:11,  1.11it/s] 70%|███████   | 28/40 [00:27<00:11,  1.04it/s]                                               {'loss': 1.6388, 'grad_norm': 5.412017345428467, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:11,  1.04it/s] 72%|███████▎  | 29/40 [00:28<00:10,  1.03it/s]                                               {'loss': 1.7956, 'grad_norm': 4.7510175704956055, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:10,  1.03it/s] 75%|███████▌  | 30/40 [00:29<00:09,  1.04it/s]                                               {'loss': 1.402, 'grad_norm': 6.841148853302002, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:09,  1.04it/s] 78%|███████▊  | 31/40 [00:30<00:08,  1.01it/s]                                               {'loss': 1.5652, 'grad_norm': 4.637282371520996, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:08,  1.01it/s] 80%|████████  | 32/40 [00:31<00:05,  1.35it/s]                                               {'loss': 1.4451, 'grad_norm': 15.576946258544922, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:05,  1.35it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.15it/s]                                               {'loss': 1.6183, 'grad_norm': 5.2036848068237305, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.15it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.05it/s]                                               {'loss': 1.6737, 'grad_norm': 4.761658668518066, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.05it/s] 88%|████████▊ | 35/40 [00:34<00:05,  1.01s/it]                                               {'loss': 1.3795, 'grad_norm': 4.067410945892334, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:05,  1.01s/it] 90%|█████████ | 36/40 [00:35<00:04,  1.05s/it]                                               {'loss': 1.569, 'grad_norm': 4.890578746795654, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:04,  1.05s/it] 92%|█████████▎| 37/40 [00:36<00:03,  1.04s/it]                                               {'loss': 1.6553, 'grad_norm': 5.178817272186279, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.04s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.01s/it]                                               {'loss': 1.5897, 'grad_norm': 4.340656757354736, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.01s/it] 98%|█████████▊| 39/40 [00:38<00:00,  1.00it/s]                                               {'loss': 1.3596, 'grad_norm': 3.217463493347168, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:38<00:00,  1.00it/s]100%|██████████| 40/40 [00:38<00:00,  1.35it/s]                                               {'loss': 1.3036, 'grad_norm': 23.081918716430664, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.35it/s]                                               {'train_runtime': 38.8217, 'train_samples_per_second': 14.554, 'train_steps_per_second': 1.03, 'train_loss': 1.7366439759731294, 'epoch': 5.0}
100%|██████████| 40/40 [00:38<00:00,  1.35it/s]100%|██████████| 40/40 [00:38<00:00,  1.03it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]                                              {'loss': 1.954, 'grad_norm': 5.719212055206299, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]  5%|▌         | 2/40 [00:02<00:41,  1.10s/it]                                              {'loss': 2.1957, 'grad_norm': 6.422942161560059, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:41,  1.10s/it]  8%|▊         | 3/40 [00:03<00:40,  1.10s/it]                                              {'loss': 1.8127, 'grad_norm': 4.5887603759765625, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:40,  1.10s/it] 10%|█         | 4/40 [00:04<00:39,  1.10s/it]                                              {'loss': 2.1587, 'grad_norm': 4.575948715209961, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:39,  1.10s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it]                                              {'loss': 1.9523, 'grad_norm': 5.200515270233154, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.10s/it] 15%|█▌        | 6/40 [00:06<00:35,  1.06s/it]                                              {'loss': 2.0524, 'grad_norm': 4.867862224578857, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:35,  1.06s/it] 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it]                                              {'loss': 1.9987, 'grad_norm': 5.70073938369751, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:33,  1.01s/it] 20%|██        | 8/40 [00:08<00:31,  1.02it/s]                                              {'loss': 2.6705, 'grad_norm': 13.29814338684082, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:31,  1.02it/s] 22%|██▎       | 9/40 [00:09<00:29,  1.06it/s]                                              {'loss': 1.6775, 'grad_norm': 4.154902935028076, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:29,  1.06it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s]                                               {'loss': 1.6476, 'grad_norm': 3.649749755859375, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it]                                               {'loss': 1.8891, 'grad_norm': 5.835050582885742, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it] 30%|███       | 12/40 [00:12<00:29,  1.07s/it]                                               {'loss': 1.8663, 'grad_norm': 4.703238487243652, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.07s/it] 32%|███▎      | 13/40 [00:13<00:27,  1.03s/it]                                               {'loss': 1.9312, 'grad_norm': 5.347640037536621, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:27,  1.03s/it] 35%|███▌      | 14/40 [00:14<00:26,  1.01s/it]                                               {'loss': 1.9073, 'grad_norm': 4.731825828552246, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:26,  1.01s/it] 38%|███▊      | 15/40 [00:15<00:24,  1.01it/s]                                               {'loss': 1.6572, 'grad_norm': 5.054139614105225, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:24,  1.01it/s] 40%|████      | 16/40 [00:15<00:17,  1.34it/s]                                               {'loss': 2.7724, 'grad_norm': 17.033000946044922, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:17,  1.34it/s] 42%|████▎     | 17/40 [00:16<00:19,  1.15it/s]                                               {'loss': 1.7015, 'grad_norm': 5.43361759185791, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:19,  1.15it/s] 45%|████▌     | 18/40 [00:17<00:20,  1.06it/s]                                               {'loss': 1.685, 'grad_norm': 5.383668422698975, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:20,  1.06it/s] 48%|████▊     | 19/40 [00:18<00:21,  1.00s/it]                                               {'loss': 1.6922, 'grad_norm': 4.028810977935791, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.00s/it] 50%|█████     | 20/40 [00:20<00:20,  1.05s/it]                                               {'loss': 1.7226, 'grad_norm': 5.609494209289551, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:20,  1.05s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it]                                               {'loss': 2.1141, 'grad_norm': 5.290729522705078, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:20,  1.07s/it] 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it]                                               {'loss': 1.5532, 'grad_norm': 4.273380756378174, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:19,  1.09s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it]                                               {'loss': 1.5441, 'grad_norm': 4.101582050323486, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.10s/it] 60%|██████    | 24/40 [00:23<00:13,  1.21it/s]                                               {'loss': 2.0608, 'grad_norm': 21.609312057495117, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:13,  1.21it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.09it/s]                                               {'loss': 1.57, 'grad_norm': 6.082041263580322, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.09it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.01it/s]                                               {'loss': 1.6941, 'grad_norm': 4.4282402992248535, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.01it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 1.5881, 'grad_norm': 5.019021511077881, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:12,  1.07s/it]                                               {'loss': 1.5526, 'grad_norm': 7.266899108886719, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.07s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it]                                               {'loss': 1.6659, 'grad_norm': 4.60009765625, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:30<00:11,  1.10s/it]                                               {'loss': 1.5902, 'grad_norm': 4.752638816833496, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:11,  1.10s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it]                                               {'loss': 1.5737, 'grad_norm': 4.083471775054932, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.10s/it] 80%|████████  | 32/40 [00:31<00:06,  1.18it/s]                                               {'loss': 1.7425, 'grad_norm': 15.705926895141602, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.18it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.13it/s]                                               {'loss': 1.645, 'grad_norm': 4.6839213371276855, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.13it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.10it/s]                                               {'loss': 1.4417, 'grad_norm': 4.402645587921143, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.10it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.05it/s]                                               {'loss': 1.4623, 'grad_norm': 4.295194625854492, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.05it/s] 90%|█████████ | 36/40 [00:36<00:04,  1.01s/it]                                               {'loss': 1.6714, 'grad_norm': 4.206252574920654, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.01s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.05s/it]                                               {'loss': 1.5956, 'grad_norm': 4.423362731933594, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.05s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.08s/it]                                               {'loss': 1.8122, 'grad_norm': 3.909369945526123, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.08s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]                                               {'loss': 1.4467, 'grad_norm': 4.573253154754639, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'loss': 2.3442, 'grad_norm': 31.9030818939209, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]                                               {'train_runtime': 39.8443, 'train_samples_per_second': 14.18, 'train_steps_per_second': 1.004, 'train_loss': 1.815335714817047, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.20it/s]100%|██████████| 40/40 [00:39<00:00,  1.00it/s]
CLIENT:15
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:06,  1.71s/it]                                              {'loss': 1.6604, 'grad_norm': 3.966639280319214, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:06,  1.71s/it]  5%|▌         | 2/40 [00:02<00:52,  1.38s/it]                                              {'loss': 1.9419, 'grad_norm': 5.359543800354004, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:52,  1.38s/it]  8%|▊         | 3/40 [00:03<00:46,  1.26s/it]                                              {'loss': 1.8842, 'grad_norm': 4.23264741897583, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:46,  1.26s/it] 10%|█         | 4/40 [00:05<00:43,  1.22s/it]                                              {'loss': 1.811, 'grad_norm': 5.5624189376831055, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:05<00:43,  1.22s/it] 12%|█▎        | 5/40 [00:06<00:39,  1.14s/it]                                              {'loss': 1.6854, 'grad_norm': 6.472845077514648, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:06<00:39,  1.14s/it] 15%|█▌        | 6/40 [00:07<00:36,  1.08s/it]                                              {'loss': 2.3997, 'grad_norm': 5.286037921905518, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:36,  1.08s/it] 18%|█▊        | 7/40 [00:08<00:34,  1.04s/it]                                              {'loss': 1.8892, 'grad_norm': 5.7709197998046875, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:34,  1.04s/it] 20%|██        | 8/40 [00:08<00:24,  1.30it/s]                                              {'loss': 1.4134, 'grad_norm': 13.937469482421875, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:24,  1.30it/s] 22%|██▎       | 9/40 [00:09<00:26,  1.18it/s]                                              {'loss': 1.7254, 'grad_norm': 5.504829406738281, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:26,  1.18it/s] 25%|██▌       | 10/40 [00:10<00:28,  1.05it/s]                                               {'loss': 1.8229, 'grad_norm': 5.378296852111816, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:28,  1.05it/s] 28%|██▊       | 11/40 [00:11<00:28,  1.00it/s]                                               {'loss': 1.7105, 'grad_norm': 5.193317890167236, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:28,  1.00it/s] 30%|███       | 12/40 [00:12<00:29,  1.06s/it]                                               {'loss': 1.6433, 'grad_norm': 4.288078784942627, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:13<00:28,  1.07s/it]                                               {'loss': 1.6493, 'grad_norm': 4.925395965576172, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:28,  1.07s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it]                                               {'loss': 1.6673, 'grad_norm': 5.326803684234619, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it]                                               {'loss': 1.5943, 'grad_norm': 4.131782531738281, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.11s/it] 40%|████      | 16/40 [00:16<00:20,  1.19it/s]                                               {'loss': 2.0054, 'grad_norm': 11.201578140258789, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.19it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s]                                               {'loss': 1.6652, 'grad_norm': 11.655613899230957, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.07it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s]                                               {'loss': 1.5688, 'grad_norm': 4.9332146644592285, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.04s/it]                                               {'loss': 1.7843, 'grad_norm': 5.178420543670654, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.04s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 1.7053, 'grad_norm': 4.923357963562012, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it]                                               {'loss': 1.6457, 'grad_norm': 5.522418975830078, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:23<00:20,  1.11s/it]                                               {'loss': 1.4308, 'grad_norm': 6.477900505065918, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:20,  1.11s/it] 57%|█████▊    | 23/40 [00:24<00:19,  1.12s/it]                                               {'loss': 1.4344, 'grad_norm': 5.703920841217041, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:19,  1.12s/it] 60%|██████    | 24/40 [00:24<00:13,  1.18it/s]                                               {'loss': 1.8719, 'grad_norm': 13.715158462524414, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.18it/s] 62%|██████▎   | 25/40 [00:25<00:14,  1.07it/s]                                               {'loss': 1.4855, 'grad_norm': 4.616705894470215, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:14,  1.07it/s] 65%|██████▌   | 26/40 [00:26<00:14,  1.00s/it]                                               {'loss': 1.6174, 'grad_norm': 4.178161144256592, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:14,  1.00s/it] 68%|██████▊   | 27/40 [00:27<00:13,  1.04s/it]                                               {'loss': 1.395, 'grad_norm': 3.818223237991333, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.04s/it] 70%|███████   | 28/40 [00:29<00:12,  1.08s/it]                                               {'loss': 1.4402, 'grad_norm': 4.827394485473633, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.08s/it] 72%|███████▎  | 29/40 [00:30<00:12,  1.10s/it]                                               {'loss': 1.856, 'grad_norm': 5.335348129272461, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:30<00:12,  1.10s/it] 75%|███████▌  | 30/40 [00:31<00:11,  1.12s/it]                                               {'loss': 1.2503, 'grad_norm': 4.50576114654541, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:11,  1.12s/it] 78%|███████▊  | 31/40 [00:32<00:10,  1.13s/it]                                               {'loss': 1.5122, 'grad_norm': 3.64866042137146, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:10,  1.13s/it] 80%|████████  | 32/40 [00:32<00:06,  1.18it/s]                                               {'loss': 0.579, 'grad_norm': 6.113342761993408, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.18it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.06it/s]                                               {'loss': 1.6539, 'grad_norm': 66.33393859863281, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.06it/s] 85%|████████▌ | 34/40 [00:35<00:06,  1.01s/it]                                               {'loss': 1.2404, 'grad_norm': 3.54561448097229, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:06,  1.01s/it] 88%|████████▊ | 35/40 [00:36<00:05,  1.06s/it]                                               {'loss': 1.4093, 'grad_norm': 3.8272438049316406, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.06s/it] 90%|█████████ | 36/40 [00:37<00:04,  1.08s/it]                                               {'loss': 1.4528, 'grad_norm': 3.4935238361358643, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:37<00:04,  1.08s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.11s/it]                                               {'loss': 1.4955, 'grad_norm': 5.408950328826904, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.11s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.11s/it]                                               {'loss': 1.4669, 'grad_norm': 3.8104264736175537, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.11s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.13s/it]                                               {'loss': 1.4861, 'grad_norm': 4.873824596405029, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.13s/it]100%|██████████| 40/40 [00:41<00:00,  1.19it/s]                                               {'loss': 1.5992, 'grad_norm': 18.158031463623047, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.19it/s]                                               {'train_runtime': 41.228, 'train_samples_per_second': 13.704, 'train_steps_per_second': 0.97, 'train_loss': 1.6137377887964248, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.19it/s]100%|██████████| 40/40 [00:41<00:00,  1.03s/it]
CLIENT:38
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]                                              {'loss': 2.0558, 'grad_norm': 4.811491966247559, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.14s/it]  5%|▌         | 2/40 [00:02<00:44,  1.16s/it]                                              {'loss': 2.5517, 'grad_norm': 5.593677043914795, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:44,  1.16s/it]  8%|▊         | 3/40 [00:03<00:42,  1.16s/it]                                              {'loss': 2.0943, 'grad_norm': 5.549829483032227, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.16s/it] 10%|█         | 4/40 [00:04<00:41,  1.16s/it]                                              {'loss': 1.9529, 'grad_norm': 6.059531211853027, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.16s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.16s/it]                                              {'loss': 2.0154, 'grad_norm': 4.5904693603515625, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.16s/it] 15%|█▌        | 6/40 [00:06<00:39,  1.16s/it]                                              {'loss': 1.9283, 'grad_norm': 4.313823223114014, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:39,  1.16s/it] 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it]                                              {'loss': 1.7934, 'grad_norm': 4.959441661834717, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it] 20%|██        | 8/40 [00:08<00:30,  1.04it/s]                                              {'loss': 1.7204, 'grad_norm': 20.38634490966797, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:30,  1.04it/s] 22%|██▎       | 9/40 [00:09<00:31,  1.02s/it]                                              {'loss': 1.8467, 'grad_norm': 5.193051338195801, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:31,  1.02s/it] 25%|██▌       | 10/40 [00:10<00:31,  1.06s/it]                                               {'loss': 1.7413, 'grad_norm': 5.149940013885498, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:31,  1.06s/it] 28%|██▊       | 11/40 [00:12<00:31,  1.10s/it]                                               {'loss': 1.7581, 'grad_norm': 6.769659042358398, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:31,  1.10s/it] 30%|███       | 12/40 [00:13<00:31,  1.11s/it]                                               {'loss': 1.8977, 'grad_norm': 6.622326850891113, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:13<00:31,  1.11s/it] 32%|███▎      | 13/40 [00:14<00:30,  1.13s/it]                                               {'loss': 1.9965, 'grad_norm': 5.023615837097168, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:30,  1.13s/it] 35%|███▌      | 14/40 [00:15<00:29,  1.14s/it]                                               {'loss': 1.5622, 'grad_norm': 4.955030918121338, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:29,  1.14s/it] 38%|███▊      | 15/40 [00:16<00:28,  1.15s/it]                                               {'loss': 1.7403, 'grad_norm': 6.991671562194824, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:28,  1.15s/it] 40%|████      | 16/40 [00:16<00:20,  1.16it/s]                                               {'loss': 1.4703, 'grad_norm': 14.498137474060059, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.16it/s] 42%|████▎     | 17/40 [00:18<00:21,  1.05it/s]                                               {'loss': 1.7706, 'grad_norm': 4.389151096343994, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:18<00:21,  1.05it/s] 45%|████▌     | 18/40 [00:19<00:22,  1.02s/it]                                               {'loss': 1.659, 'grad_norm': 4.790186882019043, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:19<00:22,  1.02s/it] 48%|████▊     | 19/40 [00:20<00:22,  1.07s/it]                                               {'loss': 1.5417, 'grad_norm': 5.776034355163574, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:20<00:22,  1.07s/it] 50%|█████     | 20/40 [00:21<00:21,  1.08s/it]                                               {'loss': 1.6688, 'grad_norm': 5.409625053405762, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:21<00:21,  1.08s/it] 52%|█████▎    | 21/40 [00:22<00:21,  1.12s/it]                                               {'loss': 1.6184, 'grad_norm': 5.598658084869385, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:21,  1.12s/it] 55%|█████▌    | 22/40 [00:23<00:20,  1.12s/it]                                               {'loss': 1.8985, 'grad_norm': 6.152095794677734, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:20,  1.12s/it] 57%|█████▊    | 23/40 [00:25<00:19,  1.14s/it]                                               {'loss': 1.657, 'grad_norm': 4.315306186676025, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:25<00:19,  1.14s/it] 60%|██████    | 24/40 [00:25<00:13,  1.18it/s]                                               {'loss': 1.3968, 'grad_norm': 13.033228874206543, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:25<00:13,  1.18it/s] 62%|██████▎   | 25/40 [00:26<00:14,  1.05it/s]                                               {'loss': 1.5985, 'grad_norm': 7.709080219268799, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:26<00:14,  1.05it/s] 65%|██████▌   | 26/40 [00:27<00:14,  1.00s/it]                                               {'loss': 1.3931, 'grad_norm': 4.659519195556641, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:27<00:14,  1.00s/it] 68%|██████▊   | 27/40 [00:28<00:13,  1.06s/it]                                               {'loss': 1.6905, 'grad_norm': 4.052413463592529, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:28<00:13,  1.06s/it] 70%|███████   | 28/40 [00:29<00:12,  1.07s/it]                                               {'loss': 1.4599, 'grad_norm': 5.046399116516113, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:29<00:12,  1.07s/it] 72%|███████▎  | 29/40 [00:31<00:12,  1.10s/it]                                               {'loss': 1.8838, 'grad_norm': 6.070728302001953, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:31<00:12,  1.10s/it] 75%|███████▌  | 30/40 [00:32<00:11,  1.11s/it]                                               {'loss': 1.6089, 'grad_norm': 4.342210292816162, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:32<00:11,  1.11s/it] 78%|███████▊  | 31/40 [00:33<00:10,  1.12s/it]                                               {'loss': 1.4851, 'grad_norm': 4.478743553161621, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:33<00:10,  1.12s/it] 80%|████████  | 32/40 [00:33<00:06,  1.18it/s]                                               {'loss': 1.5313, 'grad_norm': 11.598499298095703, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:33<00:06,  1.18it/s] 82%|████████▎ | 33/40 [00:34<00:06,  1.10it/s]                                               {'loss': 1.7446, 'grad_norm': 5.202836990356445, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:34<00:06,  1.10it/s] 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s]                                               {'loss': 1.4957, 'grad_norm': 5.301440715789795, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:35<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:36<00:05,  1.02s/it]                                               {'loss': 1.5856, 'grad_norm': 4.978386878967285, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:36<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:38<00:04,  1.07s/it]                                               {'loss': 1.5241, 'grad_norm': 3.514047861099243, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:38<00:04,  1.07s/it] 92%|█████████▎| 37/40 [00:39<00:03,  1.09s/it]                                               {'loss': 1.5907, 'grad_norm': 7.083935260772705, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:39<00:03,  1.09s/it] 95%|█████████▌| 38/40 [00:40<00:02,  1.07s/it]                                               {'loss': 1.4304, 'grad_norm': 3.8330371379852295, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:40<00:02,  1.07s/it] 98%|█████████▊| 39/40 [00:41<00:01,  1.04s/it]                                               {'loss': 1.6574, 'grad_norm': 5.201902866363525, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:41<00:01,  1.04s/it]100%|██████████| 40/40 [00:41<00:00,  1.28it/s]                                               {'loss': 1.6097, 'grad_norm': 26.865354537963867, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.28it/s]                                               {'train_runtime': 41.5289, 'train_samples_per_second': 13.605, 'train_steps_per_second': 0.963, 'train_loss': 1.715636393427849, 'epoch': 5.0}
100%|██████████| 40/40 [00:41<00:00,  1.28it/s]100%|██████████| 40/40 [00:41<00:00,  1.04s/it]
CLIENT:11
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]                                              {'loss': 1.5341, 'grad_norm': 4.002513885498047, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]  5%|▌         | 2/40 [00:02<00:44,  1.16s/it]                                              {'loss': 1.6169, 'grad_norm': 4.827093601226807, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:44,  1.16s/it]  8%|▊         | 3/40 [00:03<00:42,  1.14s/it]                                              {'loss': 2.2305, 'grad_norm': 6.462676525115967, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.14s/it] 10%|█         | 4/40 [00:04<00:40,  1.12s/it]                                              {'loss': 1.8947, 'grad_norm': 5.100447654724121, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.12s/it] 12%|█▎        | 5/40 [00:05<00:37,  1.06s/it]                                              {'loss': 1.9213, 'grad_norm': 4.764754772186279, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:37,  1.06s/it] 15%|█▌        | 6/40 [00:06<00:35,  1.04s/it]                                              {'loss': 1.9749, 'grad_norm': 5.06757926940918, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:35,  1.04s/it] 18%|█▊        | 7/40 [00:07<00:34,  1.04s/it]                                              {'loss': 2.195, 'grad_norm': 4.992900848388672, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:34,  1.04s/it] 20%|██        | 8/40 [00:07<00:24,  1.30it/s]                                              {'loss': 1.3731, 'grad_norm': 13.600067138671875, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:24,  1.30it/s] 22%|██▎       | 9/40 [00:08<00:27,  1.12it/s]                                              {'loss': 1.7335, 'grad_norm': 5.587335586547852, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:27,  1.12it/s] 25%|██▌       | 10/40 [00:09<00:29,  1.03it/s]                                               {'loss': 1.5521, 'grad_norm': 5.038329124450684, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.03it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it]                                               {'loss': 1.8477, 'grad_norm': 4.7627692222595215, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.03s/it] 30%|███       | 12/40 [00:12<00:29,  1.05s/it]                                               {'loss': 1.6455, 'grad_norm': 3.6522979736328125, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.05s/it] 32%|███▎      | 13/40 [00:13<00:29,  1.09s/it]                                               {'loss': 1.9577, 'grad_norm': 4.506668567657471, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:29,  1.09s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.11s/it]                                               {'loss': 1.3662, 'grad_norm': 3.961909532546997, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.11s/it] 38%|███▊      | 15/40 [00:15<00:26,  1.06s/it]                                               {'loss': 2.0374, 'grad_norm': 5.674062252044678, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:15<00:26,  1.06s/it] 40%|████      | 16/40 [00:15<00:19,  1.24it/s]                                               {'loss': 1.1562, 'grad_norm': 8.662135124206543, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:15<00:19,  1.24it/s] 42%|████▎     | 17/40 [00:16<00:19,  1.20it/s]                                               {'loss': 1.7389, 'grad_norm': 7.229194641113281, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:19,  1.20it/s] 45%|████▌     | 18/40 [00:17<00:19,  1.10it/s]                                               {'loss': 1.6476, 'grad_norm': 4.676781177520752, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:19,  1.10it/s] 48%|████▊     | 19/40 [00:18<00:19,  1.05it/s]                                               {'loss': 1.7758, 'grad_norm': 3.5848097801208496, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:19,  1.05it/s] 50%|█████     | 20/40 [00:19<00:18,  1.06it/s]                                               {'loss': 1.7565, 'grad_norm': 4.611122131347656, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:18,  1.06it/s] 52%|█████▎    | 21/40 [00:20<00:18,  1.02it/s]                                               {'loss': 1.5337, 'grad_norm': 6.227329254150391, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:18,  1.02it/s] 55%|█████▌    | 22/40 [00:21<00:18,  1.03s/it]                                               {'loss': 1.6106, 'grad_norm': 3.72953462600708, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:18,  1.03s/it] 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it]                                               {'loss': 1.5914, 'grad_norm': 5.575992107391357, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:18,  1.08s/it] 60%|██████    | 24/40 [00:23<00:12,  1.26it/s]                                               {'loss': 1.0789, 'grad_norm': 11.85569953918457, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:23<00:12,  1.26it/s] 62%|██████▎   | 25/40 [00:24<00:13,  1.11it/s]                                               {'loss': 1.6867, 'grad_norm': 3.273136854171753, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:24<00:13,  1.11it/s] 65%|██████▌   | 26/40 [00:25<00:13,  1.02it/s]                                               {'loss': 1.6474, 'grad_norm': 5.392871856689453, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:25<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:26<00:13,  1.03s/it]                                               {'loss': 1.4863, 'grad_norm': 3.871401309967041, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:26<00:13,  1.03s/it] 70%|███████   | 28/40 [00:27<00:12,  1.07s/it]                                               {'loss': 1.537, 'grad_norm': 4.423925399780273, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.07s/it] 72%|███████▎  | 29/40 [00:29<00:12,  1.09s/it]                                               {'loss': 1.4041, 'grad_norm': 4.191615581512451, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:12,  1.09s/it] 75%|███████▌  | 30/40 [00:30<00:11,  1.11s/it]                                               {'loss': 1.5833, 'grad_norm': 30.440961837768555, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:11,  1.11s/it] 78%|███████▊  | 31/40 [00:31<00:10,  1.13s/it]                                               {'loss': 1.4553, 'grad_norm': 4.019012451171875, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:10,  1.13s/it] 80%|████████  | 32/40 [00:31<00:06,  1.17it/s]                                               {'loss': 1.1411, 'grad_norm': 12.662881851196289, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:31<00:06,  1.17it/s] 82%|████████▎ | 33/40 [00:32<00:06,  1.06it/s]                                               {'loss': 1.5277, 'grad_norm': 3.886375904083252, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:32<00:06,  1.06it/s] 85%|████████▌ | 34/40 [00:33<00:05,  1.01it/s]                                               {'loss': 1.4581, 'grad_norm': 3.850285053253174, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:33<00:05,  1.01it/s] 88%|████████▊ | 35/40 [00:34<00:04,  1.03it/s]                                               {'loss': 1.4434, 'grad_norm': 4.0099992752075195, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:34<00:04,  1.03it/s] 90%|█████████ | 36/40 [00:35<00:03,  1.04it/s]                                               {'loss': 1.3109, 'grad_norm': 3.425997734069824, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:35<00:03,  1.04it/s] 92%|█████████▎| 37/40 [00:36<00:03,  1.01s/it]                                               {'loss': 1.5947, 'grad_norm': 4.416719436645508, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:36<00:03,  1.01s/it] 95%|█████████▌| 38/40 [00:37<00:02,  1.06s/it]                                               {'loss': 1.7034, 'grad_norm': 9.892862319946289, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:37<00:02,  1.06s/it] 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]                                               {'loss': 1.2652, 'grad_norm': 3.625443458557129, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:39<00:01,  1.09s/it]100%|██████████| 40/40 [00:39<00:00,  1.23it/s]                                               {'loss': 1.5366, 'grad_norm': 20.346399307250977, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.23it/s]                                               {'train_runtime': 39.4325, 'train_samples_per_second': 14.328, 'train_steps_per_second': 1.014, 'train_loss': 1.6137859314680099, 'epoch': 5.0}
100%|██████████| 40/40 [00:39<00:00,  1.23it/s]100%|██████████| 40/40 [00:39<00:00,  1.01it/s]
CLIENT:40
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]                                              {'loss': 2.2292, 'grad_norm': 4.739823341369629, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.13s/it]  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]                                              {'loss': 1.9879, 'grad_norm': 4.984426498413086, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.15s/it]  8%|▊         | 3/40 [00:03<00:42,  1.15s/it]                                              {'loss': 1.9655, 'grad_norm': 6.389435291290283, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.15s/it] 10%|█         | 4/40 [00:04<00:41,  1.16s/it]                                              {'loss': 1.8875, 'grad_norm': 5.909745693206787, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:41,  1.16s/it] 12%|█▎        | 5/40 [00:05<00:40,  1.15s/it]                                              {'loss': 1.6209, 'grad_norm': 4.53424596786499, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:40,  1.15s/it] 15%|█▌        | 6/40 [00:06<00:39,  1.15s/it]                                              {'loss': 2.1799, 'grad_norm': 4.989288806915283, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:39,  1.15s/it] 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it]                                              {'loss': 2.2476, 'grad_norm': 5.41312837600708, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:38,  1.16s/it] 20%|██        | 8/40 [00:08<00:30,  1.05it/s]                                              {'loss': 2.0156, 'grad_norm': 16.31780433654785, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:30,  1.05it/s] 22%|██▎       | 9/40 [00:09<00:29,  1.04it/s]                                              {'loss': 1.7319, 'grad_norm': 5.449485778808594, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:29,  1.04it/s] 25%|██▌       | 10/40 [00:10<00:28,  1.05it/s]                                               {'loss': 1.837, 'grad_norm': 5.462766647338867, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:28,  1.05it/s] 28%|██▊       | 11/40 [00:11<00:29,  1.00s/it]                                               {'loss': 2.0471, 'grad_norm': 5.65294885635376, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:29,  1.00s/it] 30%|███       | 12/40 [00:12<00:28,  1.02s/it]                                               {'loss': 1.894, 'grad_norm': 5.066616535186768, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:28,  1.02s/it] 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it]                                               {'loss': 1.5596, 'grad_norm': 7.431840419769287, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:13<00:28,  1.06s/it] 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it]                                               {'loss': 1.6736, 'grad_norm': 4.427638530731201, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:14<00:28,  1.08s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.09s/it]                                               {'loss': 1.6219, 'grad_norm': 4.461267948150635, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.09s/it] 40%|████      | 16/40 [00:16<00:19,  1.20it/s]                                               {'loss': 1.7471, 'grad_norm': 17.484981536865234, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:19,  1.20it/s] 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s]                                               {'loss': 1.8821, 'grad_norm': 5.2898736000061035, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:21,  1.09it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s]                                               {'loss': 1.4173, 'grad_norm': 4.677615642547607, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.01it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it]                                               {'loss': 1.4674, 'grad_norm': 4.802774429321289, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.03s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 1.9442, 'grad_norm': 5.623103141784668, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:21<00:20,  1.09s/it]                                               {'loss': 1.7143, 'grad_norm': 3.719576358795166, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:22<00:20,  1.09s/it] 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it]                                               {'loss': 1.7448, 'grad_norm': 5.049164295196533, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:23<00:19,  1.10s/it] 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it]                                               {'loss': 1.6249, 'grad_norm': 5.744963645935059, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:24<00:18,  1.11s/it] 60%|██████    | 24/40 [00:24<00:13,  1.20it/s]                                               {'loss': 2.0295, 'grad_norm': 22.10362434387207, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:13,  1.20it/s] 62%|██████▎   | 25/40 [00:25<00:14,  1.07it/s]                                               {'loss': 1.4422, 'grad_norm': 3.7538259029388428, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:14,  1.07it/s] 65%|██████▌   | 26/40 [00:26<00:14,  1.01s/it]                                               {'loss': 1.6753, 'grad_norm': 4.8756279945373535, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:14,  1.01s/it] 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it]                                               {'loss': 1.6826, 'grad_norm': 11.023762702941895, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.03s/it] 70%|███████   | 28/40 [00:28<00:11,  1.01it/s]                                               {'loss': 1.6257, 'grad_norm': 10.162814140319824, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:11,  1.01it/s] 72%|███████▎  | 29/40 [00:29<00:10,  1.01it/s]                                               {'loss': 1.8065, 'grad_norm': 4.854031085968018, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:10,  1.01it/s] 75%|███████▌  | 30/40 [00:30<00:10,  1.00s/it]                                               {'loss': 1.4178, 'grad_norm': 4.266026973724365, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:30<00:10,  1.00s/it] 78%|███████▊  | 31/40 [00:31<00:09,  1.06s/it]                                               {'loss': 1.5501, 'grad_norm': 4.992945194244385, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:31<00:09,  1.06s/it] 80%|████████  | 32/40 [00:32<00:06,  1.27it/s]                                               {'loss': 0.8333, 'grad_norm': 12.384317398071289, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.27it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.10it/s]                                               {'loss': 1.3931, 'grad_norm': 4.492430686950684, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.10it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s]                                               {'loss': 1.7705, 'grad_norm': 4.670404434204102, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.04it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.02s/it]                                               {'loss': 1.5154, 'grad_norm': 4.763644218444824, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.02s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it]                                               {'loss': 1.4176, 'grad_norm': 3.8827362060546875, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it] 92%|█████████▎| 37/40 [00:37<00:03,  1.08s/it]                                               {'loss': 1.5579, 'grad_norm': 4.545526027679443, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:37<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:38<00:02,  1.10s/it]                                               {'loss': 1.719, 'grad_norm': 6.427349090576172, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:38<00:02,  1.10s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.11s/it]                                               {'loss': 1.5442, 'grad_norm': 5.044070243835449, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.11s/it]100%|██████████| 40/40 [00:40<00:00,  1.20it/s]                                               {'loss': 0.9447, 'grad_norm': 10.404443740844727, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.20it/s]                                               {'train_runtime': 40.4344, 'train_samples_per_second': 13.973, 'train_steps_per_second': 0.989, 'train_loss': 1.699174140393734, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.20it/s]100%|██████████| 40/40 [00:40<00:00,  1.01s/it]
CLIENT:45
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:10,  1.81s/it]                                              {'loss': 1.6476, 'grad_norm': 4.320953845977783, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:10,  1.81s/it]  5%|▌         | 2/40 [00:02<00:49,  1.29s/it]                                              {'loss': 1.9683, 'grad_norm': 6.202475070953369, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:49,  1.29s/it]  8%|▊         | 3/40 [00:03<00:42,  1.16s/it]                                              {'loss': 1.9073, 'grad_norm': 4.649825572967529, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:42,  1.16s/it] 10%|█         | 4/40 [00:04<00:38,  1.07s/it]                                              {'loss': 2.4375, 'grad_norm': 6.340453624725342, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:38,  1.07s/it] 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it]                                              {'loss': 2.022, 'grad_norm': 6.215812683105469, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:38,  1.11s/it] 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it]                                              {'loss': 2.2154, 'grad_norm': 5.8402228355407715, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:37,  1.11s/it] 18%|█▊        | 7/40 [00:08<00:37,  1.13s/it]                                              {'loss': 2.4158, 'grad_norm': 5.586165904998779, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:37,  1.13s/it] 20%|██        | 8/40 [00:08<00:26,  1.22it/s]                                              {'loss': 2.4657, 'grad_norm': 24.28158187866211, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:26,  1.22it/s] 22%|██▎       | 9/40 [00:09<00:29,  1.07it/s]                                              {'loss': 1.9782, 'grad_norm': 5.173541069030762, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:09<00:29,  1.07it/s] 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s]                                               {'loss': 1.7968, 'grad_norm': 3.9862060546875, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:10<00:29,  1.01it/s] 28%|██▊       | 11/40 [00:11<00:30,  1.04s/it]                                               {'loss': 1.5798, 'grad_norm': 4.698192596435547, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:11<00:30,  1.04s/it] 30%|███       | 12/40 [00:12<00:29,  1.06s/it]                                               {'loss': 1.9534, 'grad_norm': 5.8427252769470215, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:12<00:29,  1.06s/it] 32%|███▎      | 13/40 [00:14<00:29,  1.10s/it]                                               {'loss': 1.9372, 'grad_norm': 4.621230602264404, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:14<00:29,  1.10s/it] 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it]                                               {'loss': 2.0865, 'grad_norm': 5.432807922363281, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:15<00:28,  1.10s/it] 38%|███▊      | 15/40 [00:16<00:27,  1.09s/it]                                               {'loss': 1.8486, 'grad_norm': 4.816412925720215, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:16<00:27,  1.09s/it] 40%|████      | 16/40 [00:16<00:20,  1.20it/s]                                               {'loss': 1.8338, 'grad_norm': 11.63405990600586, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:16<00:20,  1.20it/s] 42%|████▎     | 17/40 [00:17<00:20,  1.10it/s]                                               {'loss': 1.6564, 'grad_norm': 4.140871524810791, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:17<00:20,  1.10it/s] 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s]                                               {'loss': 1.6394, 'grad_norm': 3.8374485969543457, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:18<00:21,  1.02it/s] 48%|████▊     | 19/40 [00:19<00:21,  1.02s/it]                                               {'loss': 2.0373, 'grad_norm': 5.5003838539123535, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:19<00:21,  1.02s/it] 50%|█████     | 20/40 [00:20<00:21,  1.06s/it]                                               {'loss': 1.6509, 'grad_norm': 4.685781478881836, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:20<00:21,  1.06s/it] 52%|█████▎    | 21/40 [00:21<00:19,  1.05s/it]                                               {'loss': 1.7901, 'grad_norm': 4.3963799476623535, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:21<00:19,  1.05s/it] 55%|█████▌    | 22/40 [00:22<00:18,  1.02s/it]                                               {'loss': 1.5691, 'grad_norm': 4.428186416625977, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:22<00:18,  1.02s/it] 57%|█████▊    | 23/40 [00:23<00:17,  1.02s/it]                                               {'loss': 1.9191, 'grad_norm': 3.609431028366089, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:23<00:17,  1.02s/it] 60%|██████    | 24/40 [00:24<00:12,  1.28it/s]                                               {'loss': 1.9185, 'grad_norm': 15.421041488647461, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:24<00:12,  1.28it/s] 62%|██████▎   | 25/40 [00:25<00:13,  1.12it/s]                                               {'loss': 1.5911, 'grad_norm': 6.175966739654541, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:25<00:13,  1.12it/s] 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s]                                               {'loss': 1.6178, 'grad_norm': 4.306711673736572, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:26<00:13,  1.02it/s] 68%|██████▊   | 27/40 [00:27<00:13,  1.02s/it]                                               {'loss': 1.47, 'grad_norm': 3.7814478874206543, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:27<00:13,  1.02s/it] 70%|███████   | 28/40 [00:28<00:12,  1.06s/it]                                               {'loss': 1.7569, 'grad_norm': 5.222617149353027, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:28<00:12,  1.06s/it] 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it]                                               {'loss': 1.7534, 'grad_norm': 6.423056602478027, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:29<00:11,  1.08s/it] 75%|███████▌  | 30/40 [00:31<00:11,  1.10s/it]                                               {'loss': 1.8352, 'grad_norm': 3.9625017642974854, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:31<00:11,  1.10s/it] 78%|███████▊  | 31/40 [00:32<00:09,  1.11s/it]                                               {'loss': 1.6326, 'grad_norm': 6.714724540710449, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:32<00:09,  1.11s/it] 80%|████████  | 32/40 [00:32<00:06,  1.18it/s]                                               {'loss': 1.1295, 'grad_norm': 18.087478637695312, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:32<00:06,  1.18it/s] 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s]                                               {'loss': 1.6371, 'grad_norm': 6.174569129943848, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:33<00:06,  1.08it/s] 85%|████████▌ | 34/40 [00:34<00:05,  1.00it/s]                                               {'loss': 1.6764, 'grad_norm': 8.417781829833984, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:34<00:05,  1.00it/s] 88%|████████▊ | 35/40 [00:35<00:05,  1.03s/it]                                               {'loss': 1.3431, 'grad_norm': 3.6103439331054688, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:35<00:05,  1.03s/it] 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it]                                               {'loss': 1.7028, 'grad_norm': 5.590641498565674, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:36<00:04,  1.05s/it] 92%|█████████▎| 37/40 [00:38<00:03,  1.08s/it]                                               {'loss': 1.8426, 'grad_norm': 5.473207473754883, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:38<00:03,  1.08s/it] 95%|█████████▌| 38/40 [00:39<00:02,  1.10s/it]                                               {'loss': 1.6591, 'grad_norm': 6.629490852355957, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:39<00:02,  1.10s/it] 98%|█████████▊| 39/40 [00:40<00:01,  1.11s/it]                                               {'loss': 1.7507, 'grad_norm': 4.958787441253662, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:40<00:01,  1.11s/it]100%|██████████| 40/40 [00:40<00:00,  1.22it/s]                                               {'loss': 2.6271, 'grad_norm': 21.337736129760742, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.22it/s]                                               {'train_runtime': 40.6466, 'train_samples_per_second': 13.9, 'train_steps_per_second': 0.984, 'train_loss': 1.8325010001659394, 'epoch': 5.0}
100%|██████████| 40/40 [00:40<00:00,  1.22it/s]100%|██████████| 40/40 [00:40<00:00,  1.02s/it]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]                                              {'loss': 1.9887, 'grad_norm': 4.7392048835754395, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]                                              {'loss': 1.6075, 'grad_norm': 4.960453987121582, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]  8%|▊         | 3/40 [00:03<00:40,  1.10s/it]                                              {'loss': 2.1558, 'grad_norm': 4.67361307144165, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:40,  1.10s/it] 10%|█         | 4/40 [00:04<00:40,  1.13s/it]                                              {'loss': 2.2059, 'grad_norm': 7.027748107910156, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:40,  1.13s/it] 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it]                                              {'loss': 2.0648, 'grad_norm': 6.714290618896484, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:05<00:39,  1.13s/it] 15%|█▌        | 6/40 [00:06<00:36,  1.07s/it]                                              {'loss': 2.0699, 'grad_norm': 5.975543022155762, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:06<00:36,  1.07s/it] 18%|█▊        | 7/40 [00:07<00:34,  1.05s/it]                                              {'loss': 2.0336, 'grad_norm': 7.396129608154297, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:07<00:34,  1.05s/it] 20%|██        | 8/40 [00:07<00:24,  1.31it/s]                                              {'loss': 1.3224, 'grad_norm': 14.605281829833984, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:24,  1.31it/s] 22%|██▎       | 9/40 [00:08<00:26,  1.19it/s]                                              {'loss': 1.6947, 'grad_norm': 6.440413475036621, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:08<00:26,  1.19it/s] 25%|██▌       | 10/40 [00:09<00:27,  1.09it/s]                                               {'loss': 1.6464, 'grad_norm': 4.735482692718506, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:09<00:27,  1.09it/s] 28%|██▊       | 11/40 [00:10<00:28,  1.03it/s]                                               {'loss': 1.8143, 'grad_norm': 5.74610710144043, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:10<00:28,  1.03it/s] 30%|███       | 12/40 [00:11<00:27,  1.03it/s]                                               {'loss': 1.9373, 'grad_norm': 6.412552356719971, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:11<00:27,  1.03it/s] 32%|███▎      | 13/40 [00:12<00:25,  1.07it/s]                                               {'loss': 1.852, 'grad_norm': 11.198683738708496, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:12<00:25,  1.07it/s] 35%|███▌      | 14/40 [00:13<00:24,  1.07it/s]                                               {'loss': 1.757, 'grad_norm': 4.393092632293701, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:13<00:24,  1.07it/s] 38%|███▊      | 15/40 [00:14<00:23,  1.06it/s]                                               {'loss': 1.7118, 'grad_norm': 6.6649603843688965, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:14<00:23,  1.06it/s] 40%|████      | 16/40 [00:14<00:17,  1.38it/s]                                               {'loss': 2.6827, 'grad_norm': 29.442142486572266, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:14<00:17,  1.38it/s] 42%|████▎     | 17/40 [00:16<00:19,  1.18it/s]                                               {'loss': 1.7638, 'grad_norm': 6.447737693786621, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:16<00:19,  1.18it/s] 45%|████▌     | 18/40 [00:17<00:20,  1.06it/s]                                               {'loss': 1.6937, 'grad_norm': 5.13016939163208, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:17<00:20,  1.06it/s] 48%|████▊     | 19/40 [00:18<00:19,  1.05it/s]                                               {'loss': 1.6402, 'grad_norm': 5.350276947021484, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:18<00:19,  1.05it/s] 50%|█████     | 20/40 [00:19<00:19,  1.03it/s]                                               {'loss': 1.662, 'grad_norm': 22.79541015625, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:19<00:19,  1.03it/s] 52%|█████▎    | 21/40 [00:20<00:18,  1.04it/s]                                               {'loss': 1.7151, 'grad_norm': 4.990055561065674, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:20<00:18,  1.04it/s] 55%|█████▌    | 22/40 [00:21<00:18,  1.02s/it]                                               {'loss': 1.5144, 'grad_norm': 4.812821388244629, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:21<00:18,  1.02s/it] 57%|█████▊    | 23/40 [00:22<00:17,  1.05s/it]                                               {'loss': 1.5603, 'grad_norm': 7.26834774017334, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:22<00:17,  1.05s/it] 60%|██████    | 24/40 [00:22<00:12,  1.24it/s]                                               {'loss': 0.7642, 'grad_norm': 8.957550048828125, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:22<00:12,  1.24it/s] 62%|██████▎   | 25/40 [00:23<00:13,  1.12it/s]                                               {'loss': 1.5059, 'grad_norm': 4.268590450286865, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:23<00:13,  1.12it/s] 65%|██████▌   | 26/40 [00:24<00:13,  1.04it/s]                                               {'loss': 1.6852, 'grad_norm': 4.485176086425781, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:24<00:13,  1.04it/s] 68%|██████▊   | 27/40 [00:25<00:13,  1.01s/it]                                               {'loss': 1.5544, 'grad_norm': 4.667068004608154, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:25<00:13,  1.01s/it] 70%|███████   | 28/40 [00:26<00:12,  1.02s/it]                                               {'loss': 1.4841, 'grad_norm': 5.446542739868164, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:27<00:12,  1.02s/it] 72%|███████▎  | 29/40 [00:28<00:11,  1.06s/it]                                               {'loss': 1.7762, 'grad_norm': 12.62501049041748, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:28<00:11,  1.06s/it] 75%|███████▌  | 30/40 [00:29<00:10,  1.08s/it]                                               {'loss': 1.6161, 'grad_norm': 5.118948459625244, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:29<00:10,  1.08s/it] 78%|███████▊  | 31/40 [00:30<00:09,  1.06s/it]                                               {'loss': 1.5062, 'grad_norm': 4.249586582183838, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:30<00:09,  1.06s/it] 80%|████████  | 32/40 [00:30<00:06,  1.22it/s]                                               {'loss': 2.6262, 'grad_norm': 18.669300079345703, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:30<00:06,  1.22it/s] 82%|████████▎ | 33/40 [00:31<00:05,  1.21it/s]                                               {'loss': 1.8376, 'grad_norm': 5.258533000946045, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:31<00:05,  1.21it/s] 85%|████████▌ | 34/40 [00:32<00:04,  1.27it/s]                                               {'loss': 1.5778, 'grad_norm': 10.378345489501953, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:32<00:04,  1.27it/s] 88%|████████▊ | 35/40 [00:32<00:03,  1.27it/s]                                               {'loss': 1.7642, 'grad_norm': 6.607372283935547, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:32<00:03,  1.27it/s] 90%|█████████ | 36/40 [00:33<00:03,  1.16it/s]                                               {'loss': 1.2814, 'grad_norm': 3.483954668045044, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:33<00:03,  1.16it/s] 92%|█████████▎| 37/40 [00:34<00:02,  1.08it/s]                                               {'loss': 1.6953, 'grad_norm': 4.656059265136719, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:34<00:02,  1.08it/s] 95%|█████████▌| 38/40 [00:36<00:01,  1.00it/s]                                               {'loss': 1.413, 'grad_norm': 4.776997089385986, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:36<00:01,  1.00it/s] 98%|█████████▊| 39/40 [00:37<00:01,  1.03s/it]                                               {'loss': 1.2799, 'grad_norm': 5.295785427093506, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:37<00:01,  1.03s/it]100%|██████████| 40/40 [00:37<00:00,  1.27it/s]                                               {'loss': 1.3952, 'grad_norm': 13.457198143005371, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.27it/s]                                               {'train_runtime': 37.6077, 'train_samples_per_second': 15.024, 'train_steps_per_second': 1.064, 'train_loss': 1.7214380905032158, 'epoch': 5.0}
100%|██████████| 40/40 [00:37<00:00,  1.27it/s]100%|██████████| 40/40 [00:37<00:00,  1.06it/s]
CLIENT:62
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:02,  1.59s/it]                                              {'loss': 1.7453, 'grad_norm': 4.887886047363281, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:02,  1.59s/it]  5%|▌         | 2/40 [00:02<00:51,  1.36s/it]                                              {'loss': 1.8195, 'grad_norm': 5.459139347076416, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:51,  1.36s/it]  8%|▊         | 3/40 [00:03<00:46,  1.24s/it]                                              {'loss': 1.7469, 'grad_norm': 4.540537357330322, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:46,  1.24s/it] 10%|█         | 4/40 [00:05<00:43,  1.22s/it]                                              {'loss': 1.6902, 'grad_norm': 4.153407573699951, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:05<00:43,  1.22s/it] 12%|█▎        | 5/40 [00:06<00:43,  1.24s/it]                                              {'loss': 1.8753, 'grad_norm': 4.701572418212891, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:06<00:43,  1.24s/it] 15%|█▌        | 6/40 [00:07<00:41,  1.22s/it]                                              {'loss': 2.0945, 'grad_norm': 5.14398193359375, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:07<00:41,  1.22s/it] 18%|█▊        | 7/40 [00:08<00:39,  1.20s/it]                                              {'loss': 1.8078, 'grad_norm': 4.745665550231934, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:08<00:39,  1.20s/it] 20%|██        | 8/40 [00:08<00:28,  1.12it/s]                                              {'loss': 1.5091, 'grad_norm': 20.001707077026367, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:08<00:28,  1.12it/s] 22%|██▎       | 9/40 [00:10<00:30,  1.00it/s]                                              {'loss': 1.5487, 'grad_norm': 4.093808650970459, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:10<00:30,  1.00it/s] 25%|██▌       | 10/40 [00:11<00:33,  1.11s/it]                                               {'loss': 1.8473, 'grad_norm': 4.836513519287109, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:11<00:33,  1.11s/it] 28%|██▊       | 11/40 [00:12<00:33,  1.17s/it]                                               {'loss': 1.7402, 'grad_norm': 4.870262622833252, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:12<00:33,  1.17s/it] 30%|███       | 12/40 [00:14<00:34,  1.23s/it]                                               {'loss': 1.4348, 'grad_norm': 5.337776184082031, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:14<00:34,  1.23s/it] 32%|███▎      | 13/40 [00:15<00:34,  1.26s/it]                                               {'loss': 1.6677, 'grad_norm': 4.032289981842041, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:15<00:34,  1.26s/it] 35%|███▌      | 14/40 [00:16<00:33,  1.29s/it]                                               {'loss': 1.7092, 'grad_norm': 4.956747055053711, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:16<00:33,  1.29s/it] 38%|███▊      | 15/40 [00:18<00:32,  1.30s/it]                                               {'loss': 1.6397, 'grad_norm': 5.454324245452881, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:18<00:32,  1.30s/it] 40%|████      | 16/40 [00:18<00:23,  1.01it/s]                                               {'loss': 3.4238, 'grad_norm': 13.388413429260254, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:18<00:23,  1.01it/s] 42%|████▎     | 17/40 [00:19<00:25,  1.10s/it]                                               {'loss': 1.5386, 'grad_norm': 4.833942890167236, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:19<00:25,  1.10s/it] 45%|████▌     | 18/40 [00:21<00:25,  1.17s/it]                                               {'loss': 1.7901, 'grad_norm': 4.360177040100098, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:21<00:25,  1.17s/it] 48%|████▊     | 19/40 [00:22<00:25,  1.21s/it]                                               {'loss': 1.7662, 'grad_norm': 6.923110485076904, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:22<00:25,  1.21s/it] 50%|█████     | 20/40 [00:23<00:25,  1.27s/it]                                               {'loss': 1.6668, 'grad_norm': 4.773167610168457, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:23<00:25,  1.27s/it] 52%|█████▎    | 21/40 [00:25<00:23,  1.25s/it]                                               {'loss': 1.5265, 'grad_norm': 5.442155838012695, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:25<00:23,  1.25s/it] 55%|█████▌    | 22/40 [00:26<00:22,  1.23s/it]                                               {'loss': 1.3873, 'grad_norm': 4.6990647315979, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:26<00:22,  1.23s/it] 57%|█████▊    | 23/40 [00:27<00:20,  1.20s/it]                                               {'loss': 1.341, 'grad_norm': 4.574044704437256, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:27<00:20,  1.20s/it] 60%|██████    | 24/40 [00:27<00:14,  1.10it/s]                                               {'loss': 0.9955, 'grad_norm': 12.260814666748047, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:27<00:14,  1.10it/s] 62%|██████▎   | 25/40 [00:28<00:15,  1.00s/it]                                               {'loss': 1.5026, 'grad_norm': 5.025925159454346, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:28<00:15,  1.00s/it] 65%|██████▌   | 26/40 [00:30<00:14,  1.06s/it]                                               {'loss': 1.1946, 'grad_norm': 3.5517935752868652, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:30<00:14,  1.06s/it] 68%|██████▊   | 27/40 [00:31<00:13,  1.06s/it]                                               {'loss': 1.3802, 'grad_norm': 4.966098785400391, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:31<00:13,  1.06s/it] 70%|███████   | 28/40 [00:32<00:12,  1.07s/it]                                               {'loss': 1.5432, 'grad_norm': 5.08791971206665, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:32<00:12,  1.07s/it] 72%|███████▎  | 29/40 [00:33<00:12,  1.17s/it]                                               {'loss': 1.7021, 'grad_norm': 5.504667282104492, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:33<00:12,  1.17s/it] 75%|███████▌  | 30/40 [00:34<00:12,  1.22s/it]                                               {'loss': 1.5798, 'grad_norm': 5.662363052368164, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:34<00:12,  1.22s/it] 78%|███████▊  | 31/40 [00:36<00:11,  1.27s/it]                                               {'loss': 1.4164, 'grad_norm': 4.508068084716797, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:36<00:11,  1.27s/it] 80%|████████  | 32/40 [00:36<00:07,  1.05it/s]                                               {'loss': 1.6217, 'grad_norm': 21.036785125732422, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:36<00:07,  1.05it/s] 82%|████████▎ | 33/40 [00:37<00:07,  1.08s/it]                                               {'loss': 1.4817, 'grad_norm': 4.318576335906982, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:37<00:07,  1.08s/it] 85%|████████▌ | 34/40 [00:39<00:06,  1.15s/it]                                               {'loss': 1.4294, 'grad_norm': 4.488058090209961, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:39<00:06,  1.15s/it] 88%|████████▊ | 35/40 [00:40<00:06,  1.26s/it]                                               {'loss': 1.4458, 'grad_norm': 3.3676834106445312, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:40<00:06,  1.26s/it] 90%|█████████ | 36/40 [00:42<00:05,  1.33s/it]                                               {'loss': 1.4853, 'grad_norm': 5.924257755279541, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:42<00:05,  1.33s/it] 92%|█████████▎| 37/40 [00:43<00:04,  1.40s/it]                                               {'loss': 1.5062, 'grad_norm': 4.755558013916016, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:43<00:04,  1.40s/it] 95%|█████████▌| 38/40 [00:45<00:02,  1.46s/it]                                               {'loss': 1.343, 'grad_norm': 4.571700572967529, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:45<00:02,  1.46s/it] 98%|█████████▊| 39/40 [00:46<00:01,  1.50s/it]                                               {'loss': 1.3639, 'grad_norm': 4.095619201660156, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:46<00:01,  1.50s/it]100%|██████████| 40/40 [00:47<00:00,  1.13s/it]                                               {'loss': 0.906, 'grad_norm': 10.042283058166504, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:47<00:00,  1.13s/it]                                               {'train_runtime': 47.3969, 'train_samples_per_second': 11.921, 'train_steps_per_second': 0.844, 'train_loss': 1.6053428381681443, 'epoch': 5.0}
100%|██████████| 40/40 [00:47<00:00,  1.13s/it]100%|██████████| 40/40 [00:47<00:00,  1.18s/it]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  training_args = TrainingArguments(output_dir='save', save_steps=sys.maxsize,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<02:54,  2.69it/s]  1%|          | 3/471 [00:01<04:06,  1.90it/s]  1%|          | 4/471 [00:02<04:45,  1.63it/s]  1%|          | 5/471 [00:03<05:13,  1.49it/s]  1%|▏         | 6/471 [00:03<05:26,  1.42it/s]  1%|▏         | 7/471 [00:04<05:40,  1.36it/s]  2%|▏         | 8/471 [00:05<05:39,  1.36it/s]  2%|▏         | 9/471 [00:06<05:43,  1.35it/s]  2%|▏         | 10/471 [00:06<05:40,  1.35it/s]  2%|▏         | 11/471 [00:07<05:48,  1.32it/s]  3%|▎         | 12/471 [00:08<05:43,  1.34it/s]  3%|▎         | 13/471 [00:09<05:42,  1.34it/s]  3%|▎         | 14/471 [00:09<05:44,  1.33it/s]  3%|▎         | 15/471 [00:10<05:45,  1.32it/s]  3%|▎         | 16/471 [00:11<05:45,  1.32it/s]  4%|▎         | 17/471 [00:12<05:43,  1.32it/s]  4%|▍         | 18/471 [00:12<05:47,  1.30it/s]  4%|▍         | 19/471 [00:13<05:41,  1.32it/s]  4%|▍         | 20/471 [00:14<05:47,  1.30it/s]  4%|▍         | 21/471 [00:15<05:45,  1.30it/s]  5%|▍         | 22/471 [00:15<05:44,  1.30it/s]  5%|▍         | 23/471 [00:16<05:39,  1.32it/s]  5%|▌         | 24/471 [00:17<05:42,  1.30it/s]  5%|▌         | 25/471 [00:18<05:42,  1.30it/s]  6%|▌         | 26/471 [00:19<05:42,  1.30it/s]  6%|▌         | 27/471 [00:19<05:39,  1.31it/s]  6%|▌         | 28/471 [00:20<05:30,  1.34it/s]  6%|▌         | 29/471 [00:21<05:22,  1.37it/s]  6%|▋         | 30/471 [00:21<05:15,  1.40it/s]  7%|▋         | 31/471 [00:22<05:11,  1.41it/s]  7%|▋         | 32/471 [00:23<05:03,  1.45it/s]  7%|▋         | 33/471 [00:23<05:10,  1.41it/s]  7%|▋         | 34/471 [00:24<05:14,  1.39it/s]  7%|▋         | 35/471 [00:25<05:26,  1.33it/s]  8%|▊         | 36/471 [00:26<05:27,  1.33it/s]  8%|▊         | 37/471 [00:27<05:29,  1.32it/s]  8%|▊         | 38/471 [00:27<05:26,  1.33it/s]  8%|▊         | 39/471 [00:28<05:28,  1.32it/s]  8%|▊         | 40/471 [00:29<05:28,  1.31it/s]  9%|▊         | 41/471 [00:30<05:30,  1.30it/s]  9%|▉         | 42/471 [00:30<05:30,  1.30it/s]  9%|▉         | 43/471 [00:31<05:22,  1.33it/s]  9%|▉         | 44/471 [00:32<05:27,  1.31it/s] 10%|▉         | 45/471 [00:33<05:26,  1.31it/s] 10%|▉         | 46/471 [00:33<05:29,  1.29it/s] 10%|▉         | 47/471 [00:34<05:23,  1.31it/s] 10%|█         | 48/471 [00:35<05:20,  1.32it/s] 10%|█         | 49/471 [00:36<05:20,  1.32it/s] 11%|█         | 50/471 [00:37<05:26,  1.29it/s] 11%|█         | 51/471 [00:37<05:22,  1.30it/s] 11%|█         | 52/471 [00:38<05:23,  1.30it/s] 11%|█▏        | 53/471 [00:39<05:17,  1.31it/s] 11%|█▏        | 54/471 [00:40<05:20,  1.30it/s] 12%|█▏        | 55/471 [00:40<05:23,  1.29it/s] 12%|█▏        | 56/471 [00:41<05:23,  1.28it/s] 12%|█▏        | 57/471 [00:42<05:20,  1.29it/s] 12%|█▏        | 58/471 [00:43<05:08,  1.34it/s] 13%|█▎        | 59/471 [00:43<04:59,  1.37it/s] 13%|█▎        | 60/471 [00:44<04:51,  1.41it/s] 13%|█▎        | 61/471 [00:45<04:44,  1.44it/s] 13%|█▎        | 62/471 [00:45<04:41,  1.45it/s] 13%|█▎        | 63/471 [00:46<04:28,  1.52it/s] 14%|█▎        | 64/471 [00:46<04:15,  1.59it/s] 14%|█▍        | 65/471 [00:47<04:09,  1.63it/s] 14%|█▍        | 66/471 [00:48<04:04,  1.66it/s] 14%|█▍        | 67/471 [00:48<04:00,  1.68it/s] 14%|█▍        | 68/471 [00:49<03:56,  1.71it/s] 15%|█▍        | 69/471 [00:49<04:07,  1.62it/s] 15%|█▍        | 70/471 [00:50<04:27,  1.50it/s] 15%|█▌        | 71/471 [00:51<04:38,  1.44it/s] 15%|█▌        | 72/471 [00:52<04:48,  1.38it/s] 15%|█▌        | 73/471 [00:53<04:55,  1.35it/s] 16%|█▌        | 74/471 [00:53<04:57,  1.34it/s] 16%|█▌        | 75/471 [00:54<04:55,  1.34it/s] 16%|█▌        | 76/471 [00:55<04:57,  1.33it/s] 16%|█▋        | 77/471 [00:56<04:56,  1.33it/s] 17%|█▋        | 78/471 [00:56<04:59,  1.31it/s] 17%|█▋        | 79/471 [00:57<04:59,  1.31it/s] 17%|█▋        | 80/471 [00:58<05:01,  1.29it/s] 17%|█▋        | 81/471 [00:59<04:56,  1.31it/s] 17%|█▋        | 82/471 [00:59<04:57,  1.31it/s] 18%|█▊        | 83/471 [01:00<04:56,  1.31it/s] 18%|█▊        | 84/471 [01:01<04:53,  1.32it/s] 18%|█▊        | 85/471 [01:02<04:54,  1.31it/s] 18%|█▊        | 86/471 [01:02<04:53,  1.31it/s] 18%|█▊        | 87/471 [01:03<04:49,  1.33it/s] 19%|█▊        | 88/471 [01:04<04:48,  1.33it/s] 19%|█▉        | 89/471 [01:05<04:54,  1.30it/s] 19%|█▉        | 90/471 [01:06<04:53,  1.30it/s] 19%|█▉        | 91/471 [01:06<04:54,  1.29it/s] 20%|█▉        | 92/471 [01:07<04:46,  1.32it/s] 20%|█▉        | 93/471 [01:08<04:49,  1.31it/s] 20%|█▉        | 94/471 [01:09<04:49,  1.30it/s] 20%|██        | 95/471 [01:09<04:49,  1.30it/s] 20%|██        | 96/471 [01:10<04:46,  1.31it/s] 21%|██        | 97/471 [01:11<04:46,  1.30it/s] 21%|██        | 98/471 [01:12<04:44,  1.31it/s] 21%|██        | 99/471 [01:12<04:40,  1.32it/s] 21%|██        | 100/471 [01:13<04:33,  1.35it/s] 21%|██▏       | 101/471 [01:14<04:23,  1.40it/s] 22%|██▏       | 102/471 [01:14<04:21,  1.41it/s] 22%|██▏       | 103/471 [01:15<04:13,  1.45it/s] 22%|██▏       | 104/471 [01:16<04:23,  1.39it/s] 22%|██▏       | 105/471 [01:17<04:28,  1.36it/s] 23%|██▎       | 106/471 [01:17<04:32,  1.34it/s] 23%|██▎       | 107/471 [01:18<04:33,  1.33it/s] 23%|██▎       | 108/471 [01:19<04:33,  1.33it/s] 23%|██▎       | 109/471 [01:20<04:35,  1.32it/s] 23%|██▎       | 110/471 [01:20<04:29,  1.34it/s] 24%|██▎       | 111/471 [01:21<04:25,  1.36it/s] 24%|██▍       | 112/471 [01:22<04:27,  1.34it/s] 24%|██▍       | 113/471 [01:23<04:26,  1.34it/s] 24%|██▍       | 114/471 [01:23<04:26,  1.34it/s] 24%|██▍       | 115/471 [01:24<04:31,  1.31it/s] 25%|██▍       | 116/471 [01:25<04:32,  1.30it/s] 25%|██▍       | 117/471 [01:26<04:31,  1.31it/s] 25%|██▌       | 118/471 [01:26<04:26,  1.33it/s] 25%|██▌       | 119/471 [01:27<04:31,  1.30it/s] 25%|██▌       | 120/471 [01:28<04:31,  1.30it/s] 26%|██▌       | 121/471 [01:29<04:28,  1.30it/s] 26%|██▌       | 122/471 [01:30<04:27,  1.31it/s] 26%|██▌       | 123/471 [01:30<04:24,  1.32it/s] 26%|██▋       | 124/471 [01:31<04:19,  1.34it/s] 27%|██▋       | 125/471 [01:32<04:13,  1.37it/s] 27%|██▋       | 126/471 [01:32<04:08,  1.39it/s] 27%|██▋       | 127/471 [01:33<04:02,  1.42it/s] 27%|██▋       | 128/471 [01:34<03:58,  1.44it/s] 27%|██▋       | 129/471 [01:34<03:55,  1.45it/s] 28%|██▊       | 130/471 [01:35<04:02,  1.40it/s] 28%|██▊       | 131/471 [01:36<04:08,  1.37it/s] 28%|██▊       | 132/471 [01:37<04:07,  1.37it/s] 28%|██▊       | 133/471 [01:37<04:01,  1.40it/s] 28%|██▊       | 134/471 [01:38<03:58,  1.41it/s] 29%|██▊       | 135/471 [01:39<03:56,  1.42it/s] 29%|██▉       | 136/471 [01:39<03:45,  1.48it/s] 29%|██▉       | 137/471 [01:40<03:38,  1.53it/s] 29%|██▉       | 138/471 [01:41<03:38,  1.52it/s] 30%|██▉       | 139/471 [01:41<03:41,  1.50it/s] 30%|██▉       | 140/471 [01:42<03:49,  1.44it/s] 30%|██▉       | 141/471 [01:43<03:57,  1.39it/s] 30%|███       | 142/471 [01:44<04:00,  1.37it/s] 30%|███       | 143/471 [01:44<04:02,  1.35it/s] 31%|███       | 144/471 [01:45<04:04,  1.33it/s] 31%|███       | 145/471 [01:46<03:59,  1.36it/s] 31%|███       | 146/471 [01:46<03:46,  1.43it/s] 31%|███       | 147/471 [01:47<03:34,  1.51it/s] 31%|███▏      | 148/471 [01:48<03:29,  1.54it/s] 32%|███▏      | 149/471 [01:48<03:21,  1.60it/s] 32%|███▏      | 150/471 [01:49<03:16,  1.63it/s] 32%|███▏      | 151/471 [01:49<03:14,  1.65it/s] 32%|███▏      | 152/471 [01:50<03:10,  1.68it/s] 32%|███▏      | 153/471 [01:51<03:11,  1.66it/s] 33%|███▎      | 154/471 [01:51<03:26,  1.54it/s] 33%|███▎      | 155/471 [01:52<03:27,  1.52it/s] 33%|███▎      | 156/471 [01:53<03:18,  1.59it/s] 33%|███▎      | 157/471 [01:53<03:20,  1.56it/s] 34%|███▎      | 158/471 [01:54<03:28,  1.50it/s] 34%|███▍      | 159/471 [01:55<03:37,  1.43it/s] 34%|███▍      | 160/471 [01:56<03:43,  1.39it/s] 34%|███▍      | 161/471 [01:56<03:46,  1.37it/s] 34%|███▍      | 162/471 [01:57<03:51,  1.34it/s] 35%|███▍      | 163/471 [01:58<03:52,  1.33it/s] 35%|███▍      | 164/471 [01:59<03:49,  1.34it/s] 35%|███▌      | 165/471 [01:59<03:48,  1.34it/s] 35%|███▌      | 166/471 [02:00<03:49,  1.33it/s] 35%|███▌      | 167/471 [02:01<03:49,  1.32it/s] 36%|███▌      | 168/471 [02:02<03:53,  1.30it/s] 36%|███▌      | 169/471 [02:02<03:51,  1.30it/s] 36%|███▌      | 170/471 [02:03<03:49,  1.31it/s] 36%|███▋      | 171/471 [02:04<03:47,  1.32it/s] 37%|███▋      | 172/471 [02:05<03:44,  1.33it/s] 37%|███▋      | 173/471 [02:05<03:38,  1.36it/s] 37%|███▋      | 174/471 [02:06<03:31,  1.40it/s] 37%|███▋      | 175/471 [02:07<03:22,  1.46it/s] 37%|███▋      | 176/471 [02:07<03:11,  1.54it/s] 38%|███▊      | 177/471 [02:08<03:14,  1.51it/s] 38%|███▊      | 178/471 [02:09<03:14,  1.51it/s] 38%|███▊      | 179/471 [02:09<03:19,  1.46it/s] 38%|███▊      | 180/471 [02:10<03:26,  1.41it/s] 38%|███▊      | 181/471 [02:11<03:31,  1.37it/s] 39%|███▊      | 182/471 [02:12<03:35,  1.34it/s] 39%|███▉      | 183/471 [02:12<03:35,  1.34it/s] 39%|███▉      | 184/471 [02:13<03:37,  1.32it/s] 39%|███▉      | 185/471 [02:14<03:34,  1.33it/s] 39%|███▉      | 186/471 [02:15<03:37,  1.31it/s] 40%|███▉      | 187/471 [02:15<03:37,  1.31it/s] 40%|███▉      | 188/471 [02:16<03:40,  1.29it/s] 40%|████      | 189/471 [02:17<03:31,  1.33it/s] 40%|████      | 190/471 [02:18<03:27,  1.35it/s] 41%|████      | 191/471 [02:18<03:22,  1.38it/s] 41%|████      | 192/471 [02:19<03:19,  1.40it/s] 41%|████      | 193/471 [02:20<03:14,  1.43it/s] 41%|████      | 194/471 [02:21<03:22,  1.37it/s] 41%|████▏     | 195/471 [02:21<03:23,  1.36it/s] 42%|████▏     | 196/471 [02:22<03:26,  1.33it/s] 42%|████▏     | 197/471 [02:23<03:28,  1.32it/s] 42%|████▏     | 198/471 [02:24<03:28,  1.31it/s] 42%|████▏     | 199/471 [02:24<03:28,  1.30it/s] 42%|████▏     | 200/471 [02:25<03:17,  1.37it/s] 43%|████▎     | 201/471 [02:26<03:23,  1.33it/s] 43%|████▎     | 202/471 [02:27<03:22,  1.33it/s] 43%|████▎     | 203/471 [02:27<03:25,  1.31it/s] 43%|████▎     | 204/471 [02:28<03:24,  1.31it/s] 44%|████▎     | 205/471 [02:29<03:23,  1.31it/s] 44%|████▎     | 206/471 [02:30<03:22,  1.31it/s] 44%|████▍     | 207/471 [02:30<03:22,  1.31it/s] 44%|████▍     | 208/471 [02:31<03:16,  1.34it/s] 44%|████▍     | 209/471 [02:32<03:09,  1.38it/s] 45%|████▍     | 210/471 [02:33<03:07,  1.39it/s] 45%|████▍     | 211/471 [02:33<03:01,  1.43it/s] 45%|████▌     | 212/471 [02:34<03:04,  1.41it/s] 45%|████▌     | 213/471 [02:35<03:05,  1.39it/s] 45%|████▌     | 214/471 [02:35<03:11,  1.34it/s] 46%|████▌     | 215/471 [02:36<03:09,  1.35it/s] 46%|████▌     | 216/471 [02:37<03:10,  1.34it/s] 46%|████▌     | 217/471 [02:38<03:13,  1.31it/s] 46%|████▋     | 218/471 [02:38<03:10,  1.32it/s] 46%|████▋     | 219/471 [02:39<03:11,  1.32it/s] 47%|████▋     | 220/471 [02:40<03:11,  1.31it/s] 47%|████▋     | 221/471 [02:41<03:13,  1.29it/s] 47%|████▋     | 222/471 [02:42<03:10,  1.31it/s] 47%|████▋     | 223/471 [02:42<03:11,  1.30it/s] 48%|████▊     | 224/471 [02:43<03:09,  1.30it/s] 48%|████▊     | 225/471 [02:44<03:05,  1.33it/s] 48%|████▊     | 226/471 [02:44<02:59,  1.37it/s] 48%|████▊     | 227/471 [02:45<02:56,  1.39it/s] 48%|████▊     | 228/471 [02:46<02:51,  1.41it/s] 49%|████▊     | 229/471 [02:47<02:50,  1.42it/s] 49%|████▉     | 230/471 [02:47<02:48,  1.43it/s] 49%|████▉     | 231/471 [02:48<02:40,  1.50it/s] 49%|████▉     | 232/471 [02:48<02:33,  1.55it/s] 49%|████▉     | 233/471 [02:49<02:34,  1.54it/s] 50%|████▉     | 234/471 [02:50<02:36,  1.52it/s] 50%|████▉     | 235/471 [02:50<02:37,  1.50it/s] 50%|█████     | 236/471 [02:51<02:35,  1.52it/s] 50%|█████     | 237/471 [02:52<02:34,  1.52it/s] 51%|█████     | 238/471 [02:52<02:33,  1.52it/s] 51%|█████     | 239/471 [02:53<02:32,  1.52it/s] 51%|█████     | 240/471 [02:54<02:32,  1.51it/s] 51%|█████     | 241/471 [02:54<02:37,  1.46it/s] 51%|█████▏    | 242/471 [02:55<02:43,  1.40it/s] 52%|█████▏    | 243/471 [02:56<02:42,  1.40it/s] 52%|█████▏    | 244/471 [02:57<02:40,  1.42it/s] 52%|█████▏    | 245/471 [02:57<02:35,  1.45it/s] 52%|█████▏    | 246/471 [02:58<02:35,  1.45it/s] 52%|█████▏    | 247/471 [02:59<02:32,  1.46it/s] 53%|█████▎    | 248/471 [02:59<02:34,  1.44it/s] 53%|█████▎    | 249/471 [03:00<02:33,  1.45it/s] 53%|█████▎    | 250/471 [03:01<02:39,  1.39it/s] 53%|█████▎    | 251/471 [03:02<02:40,  1.37it/s] 54%|█████▎    | 252/471 [03:02<02:42,  1.35it/s] 54%|█████▎    | 253/471 [03:03<02:42,  1.34it/s] 54%|█████▍    | 254/471 [03:04<02:44,  1.32it/s] 54%|█████▍    | 255/471 [03:05<02:43,  1.32it/s] 54%|█████▍    | 256/471 [03:05<02:39,  1.35it/s] 55%|█████▍    | 257/471 [03:06<02:34,  1.39it/s] 55%|█████▍    | 258/471 [03:07<02:40,  1.33it/s] 55%|█████▍    | 259/471 [03:08<02:39,  1.33it/s] 55%|█████▌    | 260/471 [03:08<02:39,  1.32it/s] 55%|█████▌    | 261/471 [03:09<02:38,  1.32it/s] 56%|█████▌    | 262/471 [03:10<02:37,  1.33it/s] 56%|█████▌    | 263/471 [03:11<02:29,  1.39it/s] 56%|█████▌    | 264/471 [03:11<02:21,  1.47it/s] 56%|█████▋    | 265/471 [03:12<02:16,  1.51it/s] 56%|█████▋    | 266/471 [03:12<02:13,  1.53it/s] 57%|█████▋    | 267/471 [03:13<02:15,  1.51it/s] 57%|█████▋    | 268/471 [03:14<02:16,  1.48it/s] 57%|█████▋    | 269/471 [03:15<02:19,  1.45it/s] 57%|█████▋    | 270/471 [03:15<02:23,  1.40it/s] 58%|█████▊    | 271/471 [03:16<02:23,  1.39it/s] 58%|█████▊    | 272/471 [03:17<02:19,  1.42it/s] 58%|█████▊    | 273/471 [03:17<02:18,  1.43it/s] 58%|█████▊    | 274/471 [03:18<02:15,  1.46it/s] 58%|█████▊    | 275/471 [03:19<02:17,  1.42it/s] 59%|█████▊    | 276/471 [03:20<02:21,  1.38it/s] 59%|█████▉    | 277/471 [03:20<02:24,  1.35it/s] 59%|█████▉    | 278/471 [03:21<02:26,  1.32it/s] 59%|█████▉    | 279/471 [03:22<02:25,  1.32it/s] 59%|█████▉    | 280/471 [03:23<02:21,  1.35it/s] 60%|█████▉    | 281/471 [03:23<02:15,  1.40it/s] 60%|█████▉    | 282/471 [03:24<02:13,  1.41it/s] 60%|██████    | 283/471 [03:25<02:10,  1.44it/s] 60%|██████    | 284/471 [03:25<02:09,  1.44it/s] 61%|██████    | 285/471 [03:26<02:09,  1.44it/s] 61%|██████    | 286/471 [03:27<02:12,  1.40it/s] 61%|██████    | 287/471 [03:27<02:08,  1.43it/s] 61%|██████    | 288/471 [03:28<02:08,  1.43it/s] 61%|██████▏   | 289/471 [03:29<02:06,  1.44it/s] 62%|██████▏   | 290/471 [03:29<02:05,  1.44it/s] 62%|██████▏   | 291/471 [03:30<02:08,  1.40it/s] 62%|██████▏   | 292/471 [03:31<02:10,  1.37it/s] 62%|██████▏   | 293/471 [03:32<02:11,  1.35it/s] 62%|██████▏   | 294/471 [03:33<02:11,  1.34it/s] 63%|██████▎   | 295/471 [03:33<02:13,  1.32it/s] 63%|██████▎   | 296/471 [03:34<02:12,  1.33it/s] 63%|██████▎   | 297/471 [03:35<02:12,  1.31it/s] 63%|██████▎   | 298/471 [03:36<02:12,  1.31it/s] 63%|██████▎   | 299/471 [03:36<02:12,  1.30it/s] 64%|██████▎   | 300/471 [03:37<02:06,  1.35it/s] 64%|██████▍   | 301/471 [03:38<02:03,  1.38it/s] 64%|██████▍   | 302/471 [03:38<01:59,  1.42it/s] 64%|██████▍   | 303/471 [03:39<01:56,  1.44it/s] 65%|██████▍   | 304/471 [03:40<02:00,  1.38it/s] 65%|██████▍   | 305/471 [03:41<02:01,  1.36it/s] 65%|██████▍   | 306/471 [03:41<02:03,  1.33it/s] 65%|██████▌   | 307/471 [03:42<02:02,  1.34it/s] 65%|██████▌   | 308/471 [03:43<02:03,  1.32it/s] 66%|██████▌   | 309/471 [03:44<02:02,  1.32it/s] 66%|██████▌   | 310/471 [03:44<02:03,  1.30it/s] 66%|██████▌   | 311/471 [03:45<02:02,  1.30it/s] 66%|██████▌   | 312/471 [03:46<02:00,  1.32it/s] 66%|██████▋   | 313/471 [03:47<01:57,  1.35it/s] 67%|██████▋   | 314/471 [03:47<01:54,  1.38it/s] 67%|██████▋   | 315/471 [03:48<01:51,  1.40it/s] 67%|██████▋   | 316/471 [03:49<01:48,  1.43it/s] 67%|██████▋   | 317/471 [03:49<01:48,  1.42it/s] 68%|██████▊   | 318/471 [03:50<01:45,  1.45it/s] 68%|██████▊   | 319/471 [03:51<01:44,  1.45it/s] 68%|██████▊   | 320/471 [03:51<01:43,  1.45it/s] 68%|██████▊   | 321/471 [03:52<01:41,  1.48it/s] 68%|██████▊   | 322/471 [03:53<01:39,  1.50it/s] 69%|██████▊   | 323/471 [03:53<01:38,  1.51it/s] 69%|██████▉   | 324/471 [03:54<01:37,  1.50it/s] 69%|██████▉   | 325/471 [03:55<01:37,  1.50it/s] 69%|██████▉   | 326/471 [03:55<01:35,  1.51it/s] 69%|██████▉   | 327/471 [03:56<01:38,  1.46it/s] 70%|██████▉   | 328/471 [03:57<01:39,  1.43it/s] 70%|██████▉   | 329/471 [03:58<01:43,  1.37it/s] 70%|███████   | 330/471 [03:58<01:44,  1.35it/s] 70%|███████   | 331/471 [03:59<01:44,  1.34it/s] 70%|███████   | 332/471 [04:00<01:43,  1.34it/s] 71%|███████   | 333/471 [04:01<01:44,  1.33it/s] 71%|███████   | 334/471 [04:02<01:43,  1.32it/s] 71%|███████   | 335/471 [04:02<01:39,  1.36it/s] 71%|███████▏  | 336/471 [04:03<01:37,  1.39it/s] 72%|███████▏  | 337/471 [04:04<01:33,  1.44it/s] 72%|███████▏  | 338/471 [04:04<01:33,  1.43it/s] 72%|███████▏  | 339/471 [04:05<01:35,  1.38it/s] 72%|███████▏  | 340/471 [04:06<01:37,  1.34it/s] 72%|███████▏  | 341/471 [04:07<01:37,  1.33it/s] 73%|███████▎  | 342/471 [04:07<01:33,  1.38it/s] 73%|███████▎  | 343/471 [04:08<01:34,  1.35it/s] 73%|███████▎  | 344/471 [04:09<01:35,  1.34it/s] 73%|███████▎  | 345/471 [04:10<01:34,  1.33it/s] 73%|███████▎  | 346/471 [04:10<01:34,  1.33it/s] 74%|███████▎  | 347/471 [04:11<01:33,  1.32it/s] 74%|███████▍  | 348/471 [04:12<01:32,  1.33it/s] 74%|███████▍  | 349/471 [04:13<01:33,  1.31it/s] 74%|███████▍  | 350/471 [04:13<01:32,  1.30it/s] 75%|███████▍  | 351/471 [04:14<01:31,  1.31it/s] 75%|███████▍  | 352/471 [04:15<01:30,  1.31it/s] 75%|███████▍  | 353/471 [04:16<01:29,  1.31it/s] 75%|███████▌  | 354/471 [04:16<01:30,  1.29it/s]