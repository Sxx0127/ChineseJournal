nohup: ignoring input
Map:   0%|          | 0/11314 [00:00<?, ? examples/s]Map:   9%|▉         | 1000/11314 [00:00<00:03, 3300.32 examples/s]Map:  18%|█▊        | 2000/11314 [00:00<00:03, 3028.64 examples/s]Map:  27%|██▋       | 3000/11314 [00:00<00:02, 3557.08 examples/s]Map:  35%|███▌      | 4000/11314 [00:01<00:01, 3691.94 examples/s]Map:  44%|████▍     | 5000/11314 [00:01<00:02, 3057.19 examples/s]Map:  53%|█████▎    | 6000/11314 [00:01<00:01, 3086.56 examples/s]Map:  62%|██████▏   | 7000/11314 [00:02<00:01, 3096.69 examples/s]Map:  71%|███████   | 8000/11314 [00:02<00:00, 3471.53 examples/s]Map:  80%|███████▉  | 9000/11314 [00:02<00:00, 3452.08 examples/s]Map:  88%|████████▊ | 10000/11314 [00:02<00:00, 3610.47 examples/s]Map:  97%|█████████▋| 11000/11314 [00:03<00:00, 3710.73 examples/s]Map: 100%|██████████| 11314/11314 [00:03<00:00, 3210.86 examples/s]
Map:   0%|          | 0/7532 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7532 [00:00<00:01, 4879.37 examples/s]Map:  27%|██▋       | 2000/7532 [00:00<00:01, 4653.95 examples/s]Map:  40%|███▉      | 3000/7532 [00:01<00:01, 2608.80 examples/s]Map:  53%|█████▎    | 4000/7532 [00:01<00:01, 3121.57 examples/s]Map:  66%|██████▋   | 5000/7532 [00:01<00:00, 3319.71 examples/s]Map:  80%|███████▉  | 6000/7532 [00:01<00:00, 3883.43 examples/s]Map:  93%|█████████▎| 7000/7532 [00:01<00:00, 4270.07 examples/s]Map: 100%|██████████| 7532/7532 [00:01<00:00, 4295.81 examples/s]Map: 100%|██████████| 7532/7532 [00:01<00:00, 3794.61 examples/s]
Some weights of LlamaForSequenceClassification were not initialized from the model checkpoint at ./model/models--llama-3.2-1b/ and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
trainable params: 1,703,936 || all params: 1,237,559,296 || trainable%: 0.1377
the model architecture is 
PeftModelForCausalLM(
  (base_model): LoraModel(
    (model): LlamaForSequenceClassification(
      (model): LlamaModel(
        (embed_tokens): Embedding(128256, 2048)
        (layers): ModuleList(
          (0-15): 16 x LlamaDecoderLayer(
            (self_attn): LlamaAttention(
              (q_proj): lora.Linear(
                (base_layer): Linear(in_features=2048, out_features=2048, bias=False)
                (lora_dropout): ModuleDict(
                  (default): Dropout(p=0.05, inplace=False)
                )
                (lora_A): ModuleDict(
                  (default): Linear(in_features=2048, out_features=16, bias=False)
                )
                (lora_B): ModuleDict(
                  (default): Linear(in_features=16, out_features=2048, bias=False)
                )
                (lora_embedding_A): ParameterDict()
                (lora_embedding_B): ParameterDict()
                (lora_magnitude_vector): ModuleDict()
              )
              (k_proj): Linear(in_features=2048, out_features=512, bias=False)
              (v_proj): lora.Linear(
                (base_layer): Linear(in_features=2048, out_features=512, bias=False)
                (lora_dropout): ModuleDict(
                  (default): Dropout(p=0.05, inplace=False)
                )
                (lora_A): ModuleDict(
                  (default): Linear(in_features=2048, out_features=16, bias=False)
                )
                (lora_B): ModuleDict(
                  (default): Linear(in_features=16, out_features=512, bias=False)
                )
                (lora_embedding_A): ParameterDict()
                (lora_embedding_B): ParameterDict()
                (lora_magnitude_vector): ModuleDict()
              )
              (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
            )
            (mlp): LlamaMLP(
              (gate_proj): Linear(in_features=2048, out_features=8192, bias=False)
              (up_proj): Linear(in_features=2048, out_features=8192, bias=False)
              (down_proj): Linear(in_features=8192, out_features=2048, bias=False)
              (act_fn): SiLU()
            )
            (input_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
            (post_attention_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
          )
        )
        (norm): LlamaRMSNorm((2048,), eps=1e-05)
        (rotary_emb): LlamaRotaryEmbedding()
      )
      (score): Linear(in_features=2048, out_features=20, bias=False)
    )
  )
)
the number of packet is  152
ROUND:0
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:32,  1.19it/s]                                              {'loss': 3.8921, 'grad_norm': 31.594146728515625, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:32,  1.19it/s]  5%|▌         | 2/40 [00:01<00:19,  1.91it/s]                                              {'loss': 4.642, 'grad_norm': 34.602115631103516, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:19,  1.91it/s]  8%|▊         | 3/40 [00:01<00:15,  2.34it/s]                                              {'loss': 5.5238, 'grad_norm': 34.62282943725586, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.34it/s] 10%|█         | 4/40 [00:01<00:13,  2.61it/s]                                              {'loss': 3.4909, 'grad_norm': 31.52759552001953, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.61it/s] 12%|█▎        | 5/40 [00:02<00:12,  2.79it/s]                                              {'loss': 3.035, 'grad_norm': 34.73244094848633, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:12,  2.79it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.91it/s]                                              {'loss': 3.1677, 'grad_norm': 24.37774085998535, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.91it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s]                                              {'loss': 3.7097, 'grad_norm': 29.465599060058594, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s]                                              {'loss': 5.0145, 'grad_norm': 119.21208953857422, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.99it/s] 22%|██▎       | 9/40 [00:03<00:08,  3.82it/s]                                              {'loss': 2.2034, 'grad_norm': 25.795068740844727, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:08,  3.82it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.65it/s]                                               {'loss': 1.1647, 'grad_norm': 21.41763687133789, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.65it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.50it/s]                                               {'loss': 1.9382, 'grad_norm': 25.334402084350586, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.50it/s] 30%|███       | 12/40 [00:04<00:08,  3.37it/s]                                               {'loss': 0.988, 'grad_norm': 22.522859573364258, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:08,  3.37it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.28it/s]                                               {'loss': 1.5551, 'grad_norm': 26.055402755737305, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.28it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.25it/s]                                               {'loss': 1.5989, 'grad_norm': 29.009979248046875, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.25it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.30it/s]                                               {'loss': 1.2302, 'grad_norm': 24.79191780090332, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.30it/s]                                               {'loss': 0.258, 'grad_norm': 26.30533218383789, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.30it/s] 42%|████▎     | 17/40 [00:05<00:05,  4.06it/s]                                               {'loss': 0.9125, 'grad_norm': 16.99055290222168, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  4.06it/s] 45%|████▌     | 18/40 [00:05<00:05,  3.81it/s]                                               {'loss': 0.3367, 'grad_norm': 11.402312278747559, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:05,  3.81it/s] 48%|████▊     | 19/40 [00:05<00:05,  3.61it/s]                                               {'loss': 0.5018, 'grad_norm': 14.241266250610352, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:05,  3.61it/s] 50%|█████     | 20/40 [00:06<00:05,  3.48it/s]                                               {'loss': 0.6687, 'grad_norm': 17.783838272094727, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:05,  3.48it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.39it/s]                                               {'loss': 0.42, 'grad_norm': 11.477724075317383, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.39it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.33it/s]                                               {'loss': 0.5724, 'grad_norm': 13.020075798034668, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.33it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.29it/s]                                               {'loss': 0.2462, 'grad_norm': 8.86244010925293, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.29it/s]                                               {'loss': 0.0087, 'grad_norm': 0.9938404560089111, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:04,  3.29it/s] 62%|██████▎   | 25/40 [00:07<00:03,  4.05it/s]                                               {'loss': 0.0346, 'grad_norm': 1.5533629655838013, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  4.05it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.79it/s]                                               {'loss': 0.1323, 'grad_norm': 7.16564416885376, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.79it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.61it/s]                                               {'loss': 0.0663, 'grad_norm': 4.003246307373047, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.61it/s] 70%|███████   | 28/40 [00:08<00:03,  3.50it/s]                                               {'loss': 0.0484, 'grad_norm': 2.9933581352233887, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.50it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.41it/s]                                               {'loss': 0.0422, 'grad_norm': 2.3355040550231934, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.41it/s] 75%|███████▌  | 30/40 [00:09<00:02,  3.35it/s]                                               {'loss': 0.0282, 'grad_norm': 2.4084856510162354, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:02,  3.35it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.28it/s]                                               {'loss': 0.008, 'grad_norm': 0.4660026431083679, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.28it/s]                                               {'loss': 0.0003, 'grad_norm': 0.03752443194389343, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.28it/s] 82%|████████▎ | 33/40 [00:09<00:01,  4.03it/s]                                               {'loss': 0.0226, 'grad_norm': 2.958416700363159, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  4.03it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.77it/s]                                               {'loss': 0.0031, 'grad_norm': 0.2860311269760132, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.77it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.0045, 'grad_norm': 0.24678972363471985, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.59it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.45it/s]                                               {'loss': 0.0088, 'grad_norm': 0.5488500595092773, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.45it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.36it/s]                                               {'loss': 0.002, 'grad_norm': 0.11390385776758194, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.36it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.30it/s]                                               {'loss': 0.0026, 'grad_norm': 0.12606211006641388, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.30it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.26it/s]                                               {'loss': 0.0339, 'grad_norm': 2.798604726791382, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.26it/s]                                               {'loss': 0.0006, 'grad_norm': 0.07756683975458145, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.26it/s]                                               {'train_runtime': 12.0239, 'train_samples_per_second': 46.99, 'train_steps_per_second': 3.327, 'train_loss': 1.1879342936932518, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.26it/s]100%|██████████| 40/40 [00:12<00:00,  3.33it/s]
CLIENT:64
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.09it/s]                                              {'loss': 5.619, 'grad_norm': 4.365850448608398, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.09it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 5.0649, 'grad_norm': 4.202415943145752, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:11,  3.10it/s]                                              {'loss': 4.7877, 'grad_norm': 4.365325450897217, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.10it/s] 10%|█         | 4/40 [00:01<00:11,  3.13it/s]                                              {'loss': 4.5405, 'grad_norm': 6.113450527191162, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.13it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.13it/s]                                              {'loss': 3.2313, 'grad_norm': 5.403496742248535, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.13it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.14it/s]                                              {'loss': 3.4218, 'grad_norm': 7.133248805999756, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.14it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.15it/s]                                              {'loss': 3.7669, 'grad_norm': 9.428001403808594, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.15it/s]                                              {'loss': 5.2333, 'grad_norm': 25.924306869506836, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.15it/s] 22%|██▎       | 9/40 [00:02<00:07,  3.96it/s]                                              {'loss': 2.0227, 'grad_norm': 5.886374473571777, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:07,  3.96it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.71it/s]                                               {'loss': 2.0075, 'grad_norm': 7.392993450164795, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.71it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.54it/s]                                               {'loss': 2.6109, 'grad_norm': 6.186077117919922, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.54it/s] 30%|███       | 12/40 [00:03<00:08,  3.43it/s]                                               {'loss': 2.9855, 'grad_norm': 7.079256534576416, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.43it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.34it/s]                                               {'loss': 2.1241, 'grad_norm': 5.939032077789307, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.34it/s] 35%|███▌      | 14/40 [00:04<00:07,  3.32it/s]                                               {'loss': 1.0672, 'grad_norm': 4.604672908782959, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:07,  3.32it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.25it/s]                                               {'loss': 1.3655, 'grad_norm': 5.632915019989014, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.25it/s]                                               {'loss': 0.8328, 'grad_norm': 21.804616928100586, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.25it/s] 42%|████▎     | 17/40 [00:04<00:05,  4.00it/s]                                               {'loss': 1.2304, 'grad_norm': 5.17799186706543, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  4.00it/s] 45%|████▌     | 18/40 [00:05<00:05,  3.81it/s]                                               {'loss': 0.6512, 'grad_norm': 2.9824583530426025, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:05,  3.81it/s] 48%|████▊     | 19/40 [00:05<00:05,  3.60it/s]                                               {'loss': 1.0326, 'grad_norm': 5.070735454559326, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:05,  3.60it/s] 50%|█████     | 20/40 [00:05<00:05,  3.47it/s]                                               {'loss': 1.5793, 'grad_norm': 5.052353858947754, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.47it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.37it/s]                                               {'loss': 0.6931, 'grad_norm': 8.327701568603516, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.37it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.31it/s]                                               {'loss': 0.9577, 'grad_norm': 6.0585618019104, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.31it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.26it/s]                                               {'loss': 0.6461, 'grad_norm': 8.102191925048828, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.26it/s]                                               {'loss': 2.3672, 'grad_norm': 20.46684455871582, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:06<00:04,  3.26it/s] 62%|██████▎   | 25/40 [00:07<00:03,  4.04it/s]                                               {'loss': 1.173, 'grad_norm': 5.460153102874756, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  4.04it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.77it/s]                                               {'loss': 0.4475, 'grad_norm': 5.433640480041504, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.77it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.57it/s]                                               {'loss': 0.3961, 'grad_norm': 2.207685947418213, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.57it/s] 70%|███████   | 28/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.481, 'grad_norm': 3.9810235500335693, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.43it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.34it/s]                                               {'loss': 0.3231, 'grad_norm': 4.3675456047058105, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.34it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.424, 'grad_norm': 5.067004203796387, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.27it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.23it/s]                                               {'loss': 0.3341, 'grad_norm': 3.0323638916015625, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.23it/s]                                               {'loss': 0.0709, 'grad_norm': 2.2503061294555664, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.23it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.96it/s]                                               {'loss': 0.0829, 'grad_norm': 1.024720549583435, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.96it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.71it/s]                                               {'loss': 0.2078, 'grad_norm': 1.1774206161499023, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.71it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.54it/s]                                               {'loss': 0.186, 'grad_norm': 1.6809229850769043, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.54it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.42it/s]                                               {'loss': 0.1977, 'grad_norm': 3.360727310180664, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.42it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.34it/s]                                               {'loss': 0.8042, 'grad_norm': 8.184710502624512, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.34it/s] 95%|█████████▌| 38/40 [00:10<00:00,  3.28it/s]                                               {'loss': 0.6414, 'grad_norm': 4.148025035858154, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:10<00:00,  3.28it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.23it/s]                                               {'loss': 0.1189, 'grad_norm': 3.2726032733917236, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.23it/s]                                               {'loss': 0.0327, 'grad_norm': 4.118975639343262, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.23it/s]                                               {'train_runtime': 11.6136, 'train_samples_per_second': 48.65, 'train_steps_per_second': 3.444, 'train_loss': 1.6440089576877654, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.23it/s]100%|██████████| 40/40 [00:11<00:00,  3.44it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]                                              {'loss': 4.2058, 'grad_norm': 4.30218505859375, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 4.2126, 'grad_norm': 3.8040947914123535, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:11,  3.12it/s]                                              {'loss': 3.7364, 'grad_norm': 3.5763864517211914, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.12it/s] 10%|█         | 4/40 [00:01<00:11,  3.09it/s]                                              {'loss': 4.7918, 'grad_norm': 6.099842548370361, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.09it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.11it/s]                                              {'loss': 3.63, 'grad_norm': 4.7287421226501465, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.11it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.13it/s]                                              {'loss': 2.8268, 'grad_norm': 5.66749382019043, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.13it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.12it/s]                                              {'loss': 4.22, 'grad_norm': 7.7243452072143555, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.12it/s]                                              {'loss': 0.2696, 'grad_norm': 9.097526550292969, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.12it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s]                                              {'loss': 1.5614, 'grad_norm': 12.28653335571289, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.65it/s]                                               {'loss': 2.4168, 'grad_norm': 10.149362564086914, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.65it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.53it/s]                                               {'loss': 2.1065, 'grad_norm': 7.626296043395996, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.53it/s] 30%|███       | 12/40 [00:03<00:08,  3.41it/s]                                               {'loss': 0.8462, 'grad_norm': 3.4339349269866943, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.41it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.32it/s]                                               {'loss': 2.4973, 'grad_norm': 5.746417999267578, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.32it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.25it/s]                                               {'loss': 0.835, 'grad_norm': 5.098829746246338, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.25it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.21it/s]                                               {'loss': 1.9568, 'grad_norm': 5.754665374755859, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.21it/s]                                               {'loss': 2.9989, 'grad_norm': 42.618141174316406, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.21it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.97it/s]                                               {'loss': 0.649, 'grad_norm': 4.747172832489014, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.97it/s] 45%|████▌     | 18/40 [00:05<00:05,  3.74it/s]                                               {'loss': 0.6791, 'grad_norm': 3.8384487628936768, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:05,  3.74it/s] 48%|████▊     | 19/40 [00:05<00:05,  3.60it/s]                                               {'loss': 1.4196, 'grad_norm': 5.162840843200684, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:05,  3.60it/s] 50%|█████     | 20/40 [00:05<00:05,  3.47it/s]                                               {'loss': 0.8511, 'grad_norm': 5.133343696594238, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.47it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.36it/s]                                               {'loss': 0.78, 'grad_norm': 2.2212560176849365, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.36it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.28it/s]                                               {'loss': 0.498, 'grad_norm': 5.208205699920654, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.28it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.6735, 'grad_norm': 6.526966094970703, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.0743, 'grad_norm': 2.5762927532196045, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:06<00:04,  3.22it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.99it/s]                                               {'loss': 0.694, 'grad_norm': 2.7469358444213867, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.99it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.73it/s]                                               {'loss': 0.6752, 'grad_norm': 1.2331894636154175, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.73it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.6585, 'grad_norm': 3.2920827865600586, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.56it/s] 70%|███████   | 28/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.1016, 'grad_norm': 2.269343614578247, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.43it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.33it/s]                                               {'loss': 0.3587, 'grad_norm': 3.4142568111419678, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.33it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.3163, 'grad_norm': 4.973286151885986, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.27it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.21it/s]                                               {'loss': 0.6455, 'grad_norm': 3.9603805541992188, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.21it/s]                                               {'loss': 0.0008, 'grad_norm': 0.04883216321468353, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.21it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.93it/s]                                               {'loss': 0.3664, 'grad_norm': 1.7167314291000366, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.93it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.68it/s]                                               {'loss': 0.2998, 'grad_norm': 2.2494006156921387, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.68it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.52it/s]                                               {'loss': 0.1123, 'grad_norm': 2.6733245849609375, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.52it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.39it/s]                                               {'loss': 0.7387, 'grad_norm': 4.884842395782471, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.39it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.31it/s]                                               {'loss': 0.1563, 'grad_norm': 1.9444384574890137, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.31it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.26it/s]                                               {'loss': 0.4702, 'grad_norm': 1.5397166013717651, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.26it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.2419, 'grad_norm': 1.2204099893569946, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.0066, 'grad_norm': 0.2184474617242813, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.22it/s]                                               {'train_runtime': 11.6894, 'train_samples_per_second': 48.334, 'train_steps_per_second': 3.422, 'train_loss': 1.3644855529055349, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.22it/s]100%|██████████| 40/40 [00:11<00:00,  3.42it/s]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]                                              {'loss': 4.8198, 'grad_norm': 5.048739433288574, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 3.2607, 'grad_norm': 3.461801290512085, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:11,  3.13it/s]                                              {'loss': 5.9404, 'grad_norm': 4.965264797210693, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.13it/s] 10%|█         | 4/40 [00:01<00:11,  3.11it/s]                                              {'loss': 4.4954, 'grad_norm': 4.755798816680908, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.11it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.20it/s]                                              {'loss': 3.5633, 'grad_norm': 5.557948589324951, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:10,  3.20it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.13it/s]                                              {'loss': 3.558, 'grad_norm': 8.954364776611328, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.13it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.12it/s]                                              {'loss': 4.3787, 'grad_norm': 10.491230964660645, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.12it/s]                                              {'loss': 0.9737, 'grad_norm': 35.6876220703125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.12it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s]                                              {'loss': 2.5805, 'grad_norm': 15.4558687210083, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.61it/s]                                               {'loss': 2.4992, 'grad_norm': 14.105332374572754, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.61it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.47it/s]                                               {'loss': 3.0202, 'grad_norm': 11.950445175170898, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.47it/s] 30%|███       | 12/40 [00:03<00:08,  3.35it/s]                                               {'loss': 0.8684, 'grad_norm': 7.904216766357422, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.35it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.27it/s]                                               {'loss': 1.7805, 'grad_norm': 12.374971389770508, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.27it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.18it/s]                                               {'loss': 2.7343, 'grad_norm': 9.421931266784668, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.18it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.16it/s]                                               {'loss': 2.0848, 'grad_norm': 9.633448600769043, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.16it/s]                                               {'loss': 2.9188, 'grad_norm': 73.82356262207031, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.16it/s] 42%|████▎     | 17/40 [00:04<00:06,  3.75it/s]                                               {'loss': 1.1227, 'grad_norm': 5.657047748565674, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:06,  3.75it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.6729, 'grad_norm': 5.928741931915283, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.48it/s]                                               {'loss': 1.5753, 'grad_norm': 7.205986976623535, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.48it/s] 50%|█████     | 20/40 [00:05<00:05,  3.42it/s]                                               {'loss': 0.7114, 'grad_norm': 4.739412784576416, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.42it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.32it/s]                                               {'loss': 1.0072, 'grad_norm': 5.376578330993652, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.32it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.26it/s]                                               {'loss': 1.5349, 'grad_norm': 5.45717191696167, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.26it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.23it/s]                                               {'loss': 1.0036, 'grad_norm': 8.167612075805664, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.0554, 'grad_norm': 2.659205436706543, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:06<00:04,  3.23it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.95it/s]                                               {'loss': 0.1275, 'grad_norm': 3.237653970718384, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.95it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.70it/s]                                               {'loss': 0.5108, 'grad_norm': 5.452972412109375, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.70it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.49it/s]                                               {'loss': 0.4636, 'grad_norm': 2.9542813301086426, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.49it/s] 70%|███████   | 28/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.6603, 'grad_norm': 2.6996359825134277, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.39it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.31it/s]                                               {'loss': 0.8252, 'grad_norm': 4.086909294128418, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.31it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.3187, 'grad_norm': 2.80172061920166, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.24it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.21it/s]                                               {'loss': 0.8533, 'grad_norm': 12.619144439697266, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.21it/s]                                               {'loss': 0.6265, 'grad_norm': 82.60702514648438, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.21it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.96it/s]                                               {'loss': 0.319, 'grad_norm': 3.438044548034668, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.96it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.71it/s]                                               {'loss': 0.3242, 'grad_norm': 3.2542195320129395, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.71it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.52it/s]                                               {'loss': 0.3483, 'grad_norm': 3.668704032897949, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.52it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.0462, 'grad_norm': 1.3166921138763428, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.38it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.31it/s]                                               {'loss': 0.461, 'grad_norm': 1.0449366569519043, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.31it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.1695, 'grad_norm': 5.310857772827148, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.24it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.3335, 'grad_norm': 1.7954753637313843, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.0044, 'grad_norm': 0.2993995249271393, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.20it/s]                                               {'train_runtime': 11.7968, 'train_samples_per_second': 47.894, 'train_steps_per_second': 3.391, 'train_loss': 1.5888069134904073, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.20it/s]100%|██████████| 40/40 [00:11<00:00,  3.39it/s]
CLIENT:6
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.08it/s]                                              {'loss': 3.3254, 'grad_norm': 4.39640998840332, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.08it/s]  5%|▌         | 2/40 [00:00<00:11,  3.21it/s]                                              {'loss': 3.8061, 'grad_norm': 4.399710178375244, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:11,  3.21it/s]  8%|▊         | 3/40 [00:00<00:11,  3.16it/s]                                              {'loss': 2.1474, 'grad_norm': 4.038141250610352, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.16it/s] 10%|█         | 4/40 [00:01<00:11,  3.21it/s]                                              {'loss': 2.3605, 'grad_norm': 3.3206725120544434, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.21it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.17it/s]                                              {'loss': 3.2851, 'grad_norm': 5.599468231201172, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.17it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.13it/s]                                              {'loss': 2.5344, 'grad_norm': 4.830652236938477, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.13it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.14it/s]                                              {'loss': 3.1313, 'grad_norm': 6.030097961425781, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.14it/s]                                              {'loss': 2.5701, 'grad_norm': 26.542539596557617, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.14it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s]                                              {'loss': 1.2765, 'grad_norm': 7.161355495452881, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.67it/s]                                               {'loss': 1.9789, 'grad_norm': 9.29153823852539, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.67it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.47it/s]                                               {'loss': 0.8047, 'grad_norm': 7.528871059417725, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.47it/s] 30%|███       | 12/40 [00:03<00:08,  3.37it/s]                                               {'loss': 1.2373, 'grad_norm': 5.410202503204346, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.37it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.26it/s]                                               {'loss': 0.9355, 'grad_norm': 4.792591094970703, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.26it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.4132, 'grad_norm': 5.3895087242126465, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.7982, 'grad_norm': 7.891814708709717, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.0273, 'grad_norm': 1.2185204029083252, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.86it/s]                                               {'loss': 1.0447, 'grad_norm': 3.920342445373535, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.86it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.63it/s]                                               {'loss': 0.1808, 'grad_norm': 2.8953983783721924, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.63it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.47it/s]                                               {'loss': 0.2612, 'grad_norm': 2.6895642280578613, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.47it/s] 50%|█████     | 20/40 [00:05<00:05,  3.37it/s]                                               {'loss': 0.8951, 'grad_norm': 5.008545398712158, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.37it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.29it/s]                                               {'loss': 1.142, 'grad_norm': 3.6391091346740723, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.29it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.26it/s]                                               {'loss': 0.4081, 'grad_norm': 4.124382972717285, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.26it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.3984, 'grad_norm': 4.28887414932251, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.21it/s]                                               {'loss': 2.5279, 'grad_norm': 32.07392120361328, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:06<00:04,  3.21it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.98it/s]                                               {'loss': 0.3221, 'grad_norm': 2.447007417678833, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.98it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.72it/s]                                               {'loss': 0.4525, 'grad_norm': 2.3778536319732666, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.72it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.54it/s]                                               {'loss': 0.2507, 'grad_norm': 3.739316940307617, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.54it/s] 70%|███████   | 28/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.2112, 'grad_norm': 2.121628999710083, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.40it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.2713, 'grad_norm': 1.3248697519302368, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.32it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.4849, 'grad_norm': 1.9998681545257568, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.26it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.20it/s]                                               {'loss': 0.1514, 'grad_norm': 1.2951689958572388, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.20it/s]                                               {'loss': 0.0343, 'grad_norm': 4.740190029144287, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.20it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.95it/s]                                               {'loss': 0.2165, 'grad_norm': 1.1208093166351318, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.95it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.69it/s]                                               {'loss': 0.0818, 'grad_norm': 4.384577751159668, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.69it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.51it/s]                                               {'loss': 0.0768, 'grad_norm': 0.9428675174713135, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.51it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.0326, 'grad_norm': 1.374786615371704, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.38it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.29it/s]                                               {'loss': 0.1186, 'grad_norm': 1.574127435684204, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.29it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.9162, 'grad_norm': 18.446008682250977, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.24it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.1874, 'grad_norm': 1.8379720449447632, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.0002, 'grad_norm': 0.012073014862835407, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.21it/s]                                               {'train_runtime': 11.8434, 'train_samples_per_second': 47.706, 'train_steps_per_second': 3.377, 'train_loss': 1.0824652412811702, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.21it/s]100%|██████████| 40/40 [00:11<00:00,  3.38it/s]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.97it/s]                                              {'loss': 4.3609, 'grad_norm': 3.308762311935425, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.97it/s]  5%|▌         | 2/40 [00:00<00:12,  3.13it/s]                                              {'loss': 3.5548, 'grad_norm': 3.173351764678955, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.13it/s]  8%|▊         | 3/40 [00:00<00:11,  3.08it/s]                                              {'loss': 5.0221, 'grad_norm': 4.777856349945068, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.08it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s]                                              {'loss': 3.1494, 'grad_norm': 4.494730472564697, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s]                                              {'loss': 3.3083, 'grad_norm': 5.283384323120117, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s]                                              {'loss': 4.0992, 'grad_norm': 8.28696346282959, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 4.9158, 'grad_norm': 13.533875465393066, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 0.2335, 'grad_norm': 9.085948944091797, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.03it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.69it/s]                                              {'loss': 3.3085, 'grad_norm': 13.168700218200684, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.69it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s]                                               {'loss': 2.061, 'grad_norm': 10.132762908935547, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 2.0868, 'grad_norm': 8.132597923278809, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.31it/s]                                               {'loss': 1.5677, 'grad_norm': 10.890439987182617, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.31it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.24it/s]                                               {'loss': 1.0261, 'grad_norm': 6.153021812438965, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.504, 'grad_norm': 4.807138442993164, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 1.0661, 'grad_norm': 4.924887657165527, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 6.5698, 'grad_norm': 48.589786529541016, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s]                                               {'loss': 0.9282, 'grad_norm': 5.8269219398498535, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s]                                               {'loss': 0.9727, 'grad_norm': 10.983463287353516, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s]                                               {'loss': 0.3746, 'grad_norm': 7.692554950714111, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s] 50%|█████     | 20/40 [00:06<00:05,  3.33it/s]                                               {'loss': 1.27, 'grad_norm': 7.70436429977417, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:05,  3.33it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s]                                               {'loss': 1.1198, 'grad_norm': 6.502680778503418, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s]                                               {'loss': 1.2407, 'grad_norm': 7.523151874542236, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.7995, 'grad_norm': 5.332972526550293, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.0629, 'grad_norm': 3.2783448696136475, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.18it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.92it/s]                                               {'loss': 0.6099, 'grad_norm': 1.071286916732788, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.92it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.68it/s]                                               {'loss': 0.5839, 'grad_norm': 5.6361799240112305, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.68it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.48it/s]                                               {'loss': 0.5126, 'grad_norm': 7.629609107971191, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.48it/s] 70%|███████   | 28/40 [00:08<00:03,  3.37it/s]                                               {'loss': 0.2598, 'grad_norm': 4.912458419799805, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.37it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.6503, 'grad_norm': 3.92462158203125, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.27it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.6173, 'grad_norm': 3.908926248550415, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.17it/s]                                               {'loss': 0.3738, 'grad_norm': 1.7934091091156006, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.17it/s]                                               {'loss': 2.8222, 'grad_norm': 19.742700576782227, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.17it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.90it/s]                                               {'loss': 0.2717, 'grad_norm': 1.730892539024353, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.90it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.66it/s]                                               {'loss': 0.3895, 'grad_norm': 1.104066014289856, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.66it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s]                                               {'loss': 0.6383, 'grad_norm': 3.324327230453491, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.3199, 'grad_norm': 3.907569408416748, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.38it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.28it/s]                                               {'loss': 0.2889, 'grad_norm': 6.263882160186768, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.28it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.1153, 'grad_norm': 1.1091142892837524, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.20it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.1891, 'grad_norm': 3.514810800552368, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.015, 'grad_norm': 0.5556513071060181, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.17it/s]                                               {'train_runtime': 11.9532, 'train_samples_per_second': 47.268, 'train_steps_per_second': 3.346, 'train_loss': 1.5815017878310755, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.17it/s]100%|██████████| 40/40 [00:11<00:00,  3.35it/s]
CLIENT:43
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.15it/s]                                              {'loss': 5.6685, 'grad_norm': 4.72395658493042, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.15it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 4.1351, 'grad_norm': 3.961528778076172, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:12,  3.07it/s]                                              {'loss': 5.1828, 'grad_norm': 5.831863880157471, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.07it/s] 10%|█         | 4/40 [00:01<00:11,  3.13it/s]                                              {'loss': 4.1937, 'grad_norm': 5.943734169006348, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.13it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s]                                              {'loss': 3.4262, 'grad_norm': 6.992818355560303, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.743, 'grad_norm': 7.914288520812988, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 2.7531, 'grad_norm': 10.334099769592285, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 1.2661, 'grad_norm': 28.36405372619629, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.06it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.78it/s]                                              {'loss': 1.7072, 'grad_norm': 8.356239318847656, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.78it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s]                                               {'loss': 3.1343, 'grad_norm': 17.03633689880371, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 1.3911, 'grad_norm': 7.769286632537842, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.2342, 'grad_norm': 5.626524448394775, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s]                                               {'loss': 2.0385, 'grad_norm': 6.097651481628418, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 2.0778, 'grad_norm': 5.173349380493164, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.6872, 'grad_norm': 4.660253524780273, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 4.8682, 'grad_norm': 16.092042922973633, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.72it/s]                                               {'loss': 1.0894, 'grad_norm': 4.781771183013916, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.72it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.53it/s]                                               {'loss': 1.7601, 'grad_norm': 4.748841762542725, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.53it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 0.8045, 'grad_norm': 3.272819995880127, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.26it/s]                                               {'loss': 0.2868, 'grad_norm': 2.8616855144500732, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.26it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s]                                               {'loss': 0.572, 'grad_norm': 6.924583435058594, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 1.2356, 'grad_norm': 8.677363395690918, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.5848, 'grad_norm': 8.002360343933105, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s] 60%|██████    | 24/40 [00:07<00:04,  3.81it/s]                                               {'loss': 0.179, 'grad_norm': 6.846005439758301, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:04,  3.81it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.58it/s]                                               {'loss': 0.3863, 'grad_norm': 2.799184560775757, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.58it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.41it/s]                                               {'loss': 0.436, 'grad_norm': 2.9121439456939697, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.41it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.2094, 'grad_norm': 2.1312873363494873, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.29it/s] 70%|███████   | 28/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.5768, 'grad_norm': 2.2558860778808594, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.22it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.3937, 'grad_norm': 4.487486839294434, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.179, 'grad_norm': 2.0443665981292725, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.4525, 'grad_norm': 2.8579161167144775, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.0153, 'grad_norm': 0.7691388130187988, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s]                                               {'loss': 0.1955, 'grad_norm': 1.5164275169372559, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s]                                               {'loss': 0.0441, 'grad_norm': 0.8954344987869263, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.3252, 'grad_norm': 6.968493461608887, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s]                                               {'loss': 0.1453, 'grad_norm': 1.9943454265594482, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.0315, 'grad_norm': 0.5042353272438049, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.0716, 'grad_norm': 1.0952353477478027, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.1336, 'grad_norm': 0.6615707874298096, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 6.2608, 'grad_norm': 2.795071840286255, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]                                               {'train_runtime': 12.1418, 'train_samples_per_second': 46.533, 'train_steps_per_second': 3.294, 'train_loss': 1.5718957832315936, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.15it/s]100%|██████████| 40/40 [00:12<00:00,  3.29it/s]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]                                              {'loss': 6.4081, 'grad_norm': 6.518463134765625, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]                                              {'loss': 4.8621, 'grad_norm': 3.5994229316711426, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]  8%|▊         | 3/40 [00:00<00:11,  3.12it/s]                                              {'loss': 5.3766, 'grad_norm': 4.688052654266357, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.12it/s] 10%|█         | 4/40 [00:01<00:11,  3.09it/s]                                              {'loss': 4.4932, 'grad_norm': 7.032900333404541, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.09it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s]                                              {'loss': 4.2741, 'grad_norm': 6.459965705871582, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.08it/s]                                              {'loss': 2.867, 'grad_norm': 10.972289085388184, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.08it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.09it/s]                                              {'loss': 2.3216, 'grad_norm': 8.505409240722656, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.09it/s]                                              {'loss': 0.0966, 'grad_norm': 4.27214241027832, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.09it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s]                                              {'loss': 1.3759, 'grad_norm': 8.158116340637207, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.63it/s]                                               {'loss': 2.6334, 'grad_norm': 9.447271347045898, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.63it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s]                                               {'loss': 1.6442, 'grad_norm': 9.039283752441406, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s] 30%|███       | 12/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.611, 'grad_norm': 7.053874969482422, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.33it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.4938, 'grad_norm': 9.321098327636719, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.6371, 'grad_norm': 5.622046947479248, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 1.0473, 'grad_norm': 5.327773094177246, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.1568, 'grad_norm': 4.51296329498291, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.85it/s]                                               {'loss': 0.2277, 'grad_norm': 2.995976209640503, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.85it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s]                                               {'loss': 0.9356, 'grad_norm': 4.363811492919922, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 1.247, 'grad_norm': 4.833234786987305, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:05<00:06,  3.31it/s]                                               {'loss': 1.01, 'grad_norm': 6.5843658447265625, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.6105, 'grad_norm': 5.343797206878662, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.361, 'grad_norm': 4.776064395904541, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.10it/s]                                               {'loss': 0.8297, 'grad_norm': 7.599860668182373, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.10it/s] 60%|██████    | 24/40 [00:07<00:04,  3.85it/s]                                               {'loss': 0.0252, 'grad_norm': 1.0437650680541992, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:04,  3.85it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.59it/s]                                               {'loss': 0.2827, 'grad_norm': 5.171683311462402, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.59it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.38it/s]                                               {'loss': 0.3002, 'grad_norm': 2.930696487426758, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.38it/s] 68%|██████▊   | 27/40 [00:08<00:04,  3.25it/s]                                               {'loss': 0.4373, 'grad_norm': 3.37848162651062, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:04,  3.25it/s] 70%|███████   | 28/40 [00:08<00:03,  3.16it/s]                                               {'loss': 0.2958, 'grad_norm': 4.279838562011719, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.16it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.14it/s]                                               {'loss': 0.8054, 'grad_norm': 5.013874053955078, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.14it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.04it/s]                                               {'loss': 0.2608, 'grad_norm': 5.491389751434326, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.04it/s] 78%|███████▊  | 31/40 [00:09<00:03,  2.98it/s]                                               {'loss': 0.1165, 'grad_norm': 1.7338396310806274, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:03,  2.98it/s] 80%|████████  | 32/40 [00:09<00:02,  3.70it/s]                                               {'loss': 1.9933, 'grad_norm': 21.63231658935547, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.70it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.55it/s]                                               {'loss': 0.095, 'grad_norm': 1.769223928451538, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.55it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.40it/s]                                               {'loss': 0.4704, 'grad_norm': 1.3677853345870972, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.40it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.0737, 'grad_norm': 1.3659989833831787, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.27it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.18it/s]                                               {'loss': 0.0636, 'grad_norm': 0.7703320384025574, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.18it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.1015, 'grad_norm': 1.3810948133468628, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.10it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.1372, 'grad_norm': 1.9979909658432007, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.08it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.1443, 'grad_norm': 2.2373881340026855, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.0745, 'grad_norm': 2.337555408477783, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.07it/s]                                               {'train_runtime': 12.2555, 'train_samples_per_second': 46.102, 'train_steps_per_second': 3.264, 'train_loss': 1.3299373893532902, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:7
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.12it/s]                                              {'loss': 6.3482, 'grad_norm': 4.609323501586914, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.12it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 5.6883, 'grad_norm': 3.953737497329712, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 6.2816, 'grad_norm': 5.385260581970215, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s]                                              {'loss': 4.9023, 'grad_norm': 6.251984596252441, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.6369, 'grad_norm': 8.194268226623535, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s]                                              {'loss': 4.974, 'grad_norm': 10.444358825683594, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 3.4098, 'grad_norm': 8.45801067352295, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 1.738, 'grad_norm': 44.42414474487305, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.05it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.77it/s]                                              {'loss': 2.4743, 'grad_norm': 8.744647026062012, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.77it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s]                                               {'loss': 2.4815, 'grad_norm': 9.537858963012695, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 2.8398, 'grad_norm': 12.978277206420898, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.29it/s]                                               {'loss': 2.0774, 'grad_norm': 12.376343727111816, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.29it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s]                                               {'loss': 2.3307, 'grad_norm': 9.034735679626465, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.8045, 'grad_norm': 9.269392013549805, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 1.1966, 'grad_norm': 7.387948036193848, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 0.6795, 'grad_norm': 24.577909469604492, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.13it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s]                                               {'loss': 0.96, 'grad_norm': 4.4890217781066895, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.4743, 'grad_norm': 3.8291409015655518, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s]                                               {'loss': 1.5881, 'grad_norm': 8.144365310668945, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 1.19, 'grad_norm': 6.800788879394531, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 1.6615, 'grad_norm': 6.721969127655029, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.6955, 'grad_norm': 4.96497917175293, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.6176, 'grad_norm': 4.648850440979004, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 1.1702, 'grad_norm': 26.398313522338867, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s]                                               {'loss': 0.7931, 'grad_norm': 5.271349906921387, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s]                                               {'loss': 0.702, 'grad_norm': 2.4490246772766113, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s]                                               {'loss': 0.5939, 'grad_norm': 3.726801633834839, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.4628, 'grad_norm': 5.506929397583008, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.5422, 'grad_norm': 3.115638256072998, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.1671, 'grad_norm': 2.169332981109619, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.2265, 'grad_norm': 1.8629865646362305, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.0613, 'grad_norm': 2.5213942527770996, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.12it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.84it/s]                                               {'loss': 0.1432, 'grad_norm': 1.2923386096954346, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.84it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.211, 'grad_norm': 3.4770379066467285, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s]                                               {'loss': 0.451, 'grad_norm': 1.994192361831665, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.35it/s]                                               {'loss': 0.5003, 'grad_norm': 3.527743101119995, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.35it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.26it/s]                                               {'loss': 0.2072, 'grad_norm': 2.940072774887085, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.26it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.3261, 'grad_norm': 4.51035737991333, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.24it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.4696, 'grad_norm': 2.713597059249878, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.0663, 'grad_norm': 1.624525547027588, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.16it/s]                                               {'train_runtime': 12.0327, 'train_samples_per_second': 46.955, 'train_steps_per_second': 3.324, 'train_loss': 1.678604670520872, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.16it/s]100%|██████████| 40/40 [00:12<00:00,  3.32it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]                                              {'loss': 3.2361, 'grad_norm': 3.7723605632781982, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 5.2075, 'grad_norm': 4.5612287521362305, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:11,  3.12it/s]                                              {'loss': 4.3845, 'grad_norm': 4.588952541351318, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.12it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s]                                              {'loss': 3.4283, 'grad_norm': 5.807948589324951, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.1095, 'grad_norm': 4.740962505340576, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.09it/s]                                              {'loss': 2.9176, 'grad_norm': 6.055185794830322, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.09it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.11it/s]                                              {'loss': 2.7191, 'grad_norm': 9.785224914550781, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.11it/s]                                              {'loss': 1.1328, 'grad_norm': 30.402767181396484, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.11it/s] 22%|██▎       | 9/40 [00:02<00:07,  3.95it/s]                                              {'loss': 1.7419, 'grad_norm': 9.648283958435059, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:07,  3.95it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.66it/s]                                               {'loss': 2.2786, 'grad_norm': 12.34028434753418, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.66it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s]                                               {'loss': 1.0936, 'grad_norm': 7.804413318634033, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s] 30%|███       | 12/40 [00:03<00:08,  3.29it/s]                                               {'loss': 0.7498, 'grad_norm': 5.035091400146484, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.29it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.20it/s]                                               {'loss': 2.1283, 'grad_norm': 7.154178619384766, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.20it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.4901, 'grad_norm': 8.248093605041504, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.1694, 'grad_norm': 4.282556533813477, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 0.8901, 'grad_norm': 19.68048095703125, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.09it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s]                                               {'loss': 1.1798, 'grad_norm': 5.075066089630127, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s]                                               {'loss': 0.6173, 'grad_norm': 5.098845481872559, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s]                                               {'loss': 0.5639, 'grad_norm': 4.37789249420166, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s] 50%|█████     | 20/40 [00:06<00:06,  3.26it/s]                                               {'loss': 0.596, 'grad_norm': 4.1734538078308105, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.26it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.1364, 'grad_norm': 2.7423579692840576, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s]                                               {'loss': 0.7756, 'grad_norm': 4.601838111877441, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.564, 'grad_norm': 10.20134449005127, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.2685, 'grad_norm': 10.946338653564453, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.07it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.61it/s]                                               {'loss': 0.2315, 'grad_norm': 3.0129220485687256, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.61it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.45it/s]                                               {'loss': 0.3034, 'grad_norm': 3.1556570529937744, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.45it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.1277, 'grad_norm': 2.260842800140381, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.32it/s] 70%|███████   | 28/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.2824, 'grad_norm': 4.195915699005127, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.24it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.2942, 'grad_norm': 2.8851494789123535, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.452, 'grad_norm': 2.8013222217559814, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.2042, 'grad_norm': 1.628580093383789, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.0011, 'grad_norm': 0.058963071554899216, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.10it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s]                                               {'loss': 0.0815, 'grad_norm': 1.094985008239746, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s]                                               {'loss': 0.3041, 'grad_norm': 1.7982276678085327, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s]                                               {'loss': 0.0602, 'grad_norm': 1.2486567497253418, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.0634, 'grad_norm': 1.0464465618133545, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.2035, 'grad_norm': 1.8912492990493774, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.0282, 'grad_norm': 0.5169981718063354, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0724, 'grad_norm': 1.3370258808135986, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0008, 'grad_norm': 0.048058561980724335, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 12.0919, 'train_samples_per_second': 46.725, 'train_steps_per_second': 3.308, 'train_loss': 1.12722890007135, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.12it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 11.11it/s]  1%|          | 4/471 [00:00<01:05,  7.11it/s]  1%|          | 5/471 [00:00<01:11,  6.54it/s]  1%|▏         | 6/471 [00:00<01:15,  6.14it/s]  1%|▏         | 7/471 [00:01<01:18,  5.89it/s]  2%|▏         | 8/471 [00:01<01:20,  5.76it/s]  2%|▏         | 9/471 [00:01<01:21,  5.68it/s]  2%|▏         | 10/471 [00:01<01:21,  5.62it/s]  2%|▏         | 11/471 [00:01<01:22,  5.59it/s]  3%|▎         | 12/471 [00:01<01:22,  5.56it/s]  3%|▎         | 13/471 [00:02<01:23,  5.51it/s]  3%|▎         | 14/471 [00:02<01:23,  5.48it/s]  3%|▎         | 15/471 [00:02<01:22,  5.50it/s]  3%|▎         | 16/471 [00:02<01:22,  5.50it/s]  4%|▎         | 17/471 [00:02<01:22,  5.49it/s]  4%|▍         | 18/471 [00:03<01:22,  5.49it/s]  4%|▍         | 19/471 [00:03<01:22,  5.48it/s]  4%|▍         | 20/471 [00:03<01:22,  5.47it/s]  4%|▍         | 21/471 [00:03<01:22,  5.46it/s]  5%|▍         | 22/471 [00:03<01:22,  5.46it/s]  5%|▍         | 23/471 [00:04<01:21,  5.48it/s]  5%|▌         | 24/471 [00:04<01:21,  5.46it/s]  5%|▌         | 25/471 [00:04<01:21,  5.47it/s]  6%|▌         | 26/471 [00:04<01:21,  5.48it/s]  6%|▌         | 27/471 [00:04<01:21,  5.48it/s]  6%|▌         | 28/471 [00:04<01:21,  5.47it/s]  6%|▌         | 29/471 [00:05<01:20,  5.46it/s]  6%|▋         | 30/471 [00:05<01:20,  5.46it/s]  7%|▋         | 31/471 [00:05<01:20,  5.47it/s]  7%|▋         | 32/471 [00:05<01:20,  5.47it/s]  7%|▋         | 33/471 [00:05<01:19,  5.50it/s]  7%|▋         | 34/471 [00:06<01:19,  5.51it/s]  7%|▋         | 35/471 [00:06<01:19,  5.50it/s]  8%|▊         | 36/471 [00:06<01:19,  5.49it/s]  8%|▊         | 37/471 [00:06<01:19,  5.46it/s]  8%|▊         | 38/471 [00:06<01:19,  5.46it/s]  8%|▊         | 39/471 [00:06<01:19,  5.46it/s]  8%|▊         | 40/471 [00:07<01:18,  5.47it/s]  9%|▊         | 41/471 [00:07<01:18,  5.47it/s]  9%|▉         | 42/471 [00:07<01:18,  5.45it/s]  9%|▉         | 43/471 [00:07<01:18,  5.45it/s]  9%|▉         | 44/471 [00:07<01:18,  5.47it/s] 10%|▉         | 45/471 [00:08<01:18,  5.45it/s] 10%|▉         | 46/471 [00:08<01:17,  5.46it/s] 10%|▉         | 47/471 [00:08<01:17,  5.47it/s] 10%|█         | 48/471 [00:08<01:17,  5.47it/s] 10%|█         | 49/471 [00:08<01:17,  5.44it/s] 11%|█         | 50/471 [00:08<01:17,  5.44it/s] 11%|█         | 51/471 [00:09<01:17,  5.44it/s] 11%|█         | 52/471 [00:09<01:16,  5.46it/s] 11%|█▏        | 53/471 [00:09<01:16,  5.44it/s] 11%|█▏        | 54/471 [00:09<01:16,  5.42it/s] 12%|█▏        | 55/471 [00:09<01:16,  5.42it/s] 12%|█▏        | 56/471 [00:10<01:16,  5.42it/s] 12%|█▏        | 57/471 [00:10<01:16,  5.44it/s] 12%|█▏        | 58/471 [00:10<01:16,  5.43it/s] 13%|█▎        | 59/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 60/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 61/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 62/471 [00:11<01:15,  5.44it/s] 13%|█▎        | 63/471 [00:11<01:15,  5.43it/s] 14%|█▎        | 64/471 [00:11<01:14,  5.44it/s] 14%|█▍        | 65/471 [00:11<01:14,  5.44it/s] 14%|█▍        | 66/471 [00:11<01:14,  5.43it/s] 14%|█▍        | 67/471 [00:12<01:14,  5.44it/s] 14%|█▍        | 68/471 [00:12<01:14,  5.43it/s] 15%|█▍        | 69/471 [00:12<01:13,  5.44it/s] 15%|█▍        | 70/471 [00:12<01:14,  5.42it/s] 15%|█▌        | 71/471 [00:12<01:13,  5.42it/s] 15%|█▌        | 72/471 [00:12<01:13,  5.43it/s] 15%|█▌        | 73/471 [00:13<01:13,  5.42it/s] 16%|█▌        | 74/471 [00:13<01:12,  5.44it/s] 16%|█▌        | 75/471 [00:13<01:13,  5.42it/s] 16%|█▌        | 76/471 [00:13<01:12,  5.44it/s] 16%|█▋        | 77/471 [00:13<01:12,  5.43it/s] 17%|█▋        | 78/471 [00:14<01:12,  5.43it/s] 17%|█▋        | 79/471 [00:14<01:12,  5.42it/s] 17%|█▋        | 80/471 [00:14<01:12,  5.42it/s] 17%|█▋        | 81/471 [00:14<01:11,  5.43it/s] 17%|█▋        | 82/471 [00:14<01:11,  5.43it/s] 18%|█▊        | 83/471 [00:15<01:11,  5.44it/s] 18%|█▊        | 84/471 [00:15<01:11,  5.44it/s] 18%|█▊        | 85/471 [00:15<01:11,  5.43it/s] 18%|█▊        | 86/471 [00:15<01:10,  5.43it/s] 18%|█▊        | 87/471 [00:15<01:10,  5.43it/s] 19%|█▊        | 88/471 [00:15<01:10,  5.44it/s] 19%|█▉        | 89/471 [00:16<01:10,  5.44it/s] 19%|█▉        | 90/471 [00:16<01:10,  5.43it/s] 19%|█▉        | 91/471 [00:16<01:09,  5.43it/s] 20%|█▉        | 92/471 [00:16<01:09,  5.43it/s] 20%|█▉        | 93/471 [00:16<01:09,  5.44it/s] 20%|█▉        | 94/471 [00:17<01:09,  5.45it/s] 20%|██        | 95/471 [00:17<01:08,  5.45it/s] 20%|██        | 96/471 [00:17<01:08,  5.46it/s] 21%|██        | 97/471 [00:17<01:08,  5.43it/s] 21%|██        | 98/471 [00:17<01:08,  5.44it/s] 21%|██        | 99/471 [00:17<01:08,  5.44it/s] 21%|██        | 100/471 [00:18<01:08,  5.45it/s] 21%|██▏       | 101/471 [00:18<01:07,  5.46it/s] 22%|██▏       | 102/471 [00:18<01:07,  5.45it/s] 22%|██▏       | 103/471 [00:18<01:07,  5.42it/s] 22%|██▏       | 104/471 [00:18<01:07,  5.41it/s] 22%|██▏       | 105/471 [00:19<01:07,  5.41it/s] 23%|██▎       | 106/471 [00:19<01:07,  5.42it/s] 23%|██▎       | 107/471 [00:19<01:07,  5.43it/s] 23%|██▎       | 108/471 [00:19<01:06,  5.43it/s] 23%|██▎       | 109/471 [00:19<01:06,  5.43it/s] 23%|██▎       | 110/471 [00:19<01:06,  5.45it/s] 24%|██▎       | 111/471 [00:20<01:06,  5.44it/s] 24%|██▍       | 112/471 [00:20<01:06,  5.42it/s] 24%|██▍       | 113/471 [00:20<01:05,  5.47it/s] 24%|██▍       | 114/471 [00:20<01:05,  5.46it/s] 24%|██▍       | 115/471 [00:20<01:05,  5.45it/s] 25%|██▍       | 116/471 [00:21<01:05,  5.45it/s] 25%|██▍       | 117/471 [00:21<01:05,  5.44it/s] 25%|██▌       | 118/471 [00:21<01:04,  5.44it/s] 25%|██▌       | 119/471 [00:21<01:04,  5.44it/s] 25%|██▌       | 120/471 [00:21<01:04,  5.42it/s] 26%|██▌       | 121/471 [00:22<01:04,  5.42it/s] 26%|██▌       | 122/471 [00:22<01:04,  5.42it/s] 26%|██▌       | 123/471 [00:22<01:04,  5.43it/s] 26%|██▋       | 124/471 [00:22<01:04,  5.42it/s] 27%|██▋       | 125/471 [00:22<01:03,  5.41it/s] 27%|██▋       | 126/471 [00:22<01:03,  5.40it/s] 27%|██▋       | 127/471 [00:23<01:03,  5.41it/s] 27%|██▋       | 128/471 [00:23<01:03,  5.41it/s] 27%|██▋       | 129/471 [00:23<01:03,  5.43it/s] 28%|██▊       | 130/471 [00:23<01:02,  5.42it/s] 28%|██▊       | 131/471 [00:23<01:02,  5.41it/s] 28%|██▊       | 132/471 [00:24<01:02,  5.41it/s] 28%|██▊       | 133/471 [00:24<01:02,  5.40it/s] 28%|██▊       | 134/471 [00:24<01:02,  5.39it/s] 29%|██▊       | 135/471 [00:24<01:02,  5.42it/s] 29%|██▉       | 136/471 [00:24<01:01,  5.41it/s] 29%|██▉       | 137/471 [00:24<01:01,  5.41it/s] 29%|██▉       | 138/471 [00:25<01:01,  5.40it/s] 30%|██▉       | 139/471 [00:25<01:01,  5.42it/s] 30%|██▉       | 140/471 [00:25<01:01,  5.42it/s] 30%|██▉       | 141/471 [00:25<01:00,  5.44it/s] 30%|███       | 142/471 [00:25<01:00,  5.44it/s] 30%|███       | 143/471 [00:26<01:00,  5.44it/s] 31%|███       | 144/471 [00:26<01:00,  5.41it/s] 31%|███       | 145/471 [00:26<01:00,  5.43it/s] 31%|███       | 146/471 [00:26<00:59,  5.43it/s] 31%|███       | 147/471 [00:26<00:59,  5.43it/s] 31%|███▏      | 148/471 [00:26<00:59,  5.43it/s] 32%|███▏      | 149/471 [00:27<00:59,  5.41it/s] 32%|███▏      | 150/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 151/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 152/471 [00:27<00:59,  5.40it/s] 32%|███▏      | 153/471 [00:27<00:58,  5.39it/s] 33%|███▎      | 154/471 [00:28<00:58,  5.43it/s] 33%|███▎      | 155/471 [00:28<00:58,  5.41it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.41it/s] 33%|███▎      | 157/471 [00:28<00:57,  5.42it/s] 34%|███▎      | 158/471 [00:28<00:57,  5.43it/s] 34%|███▍      | 159/471 [00:29<00:57,  5.44it/s] 34%|███▍      | 160/471 [00:29<00:57,  5.39it/s] 34%|███▍      | 161/471 [00:29<00:57,  5.40it/s] 34%|███▍      | 162/471 [00:29<00:57,  5.39it/s] 35%|███▍      | 163/471 [00:29<00:57,  5.39it/s] 35%|███▍      | 164/471 [00:29<00:56,  5.42it/s] 35%|███▌      | 165/471 [00:30<00:56,  5.42it/s] 35%|███▌      | 166/471 [00:30<00:56,  5.39it/s] 35%|███▌      | 167/471 [00:30<00:56,  5.38it/s] 36%|███▌      | 168/471 [00:30<00:56,  5.40it/s] 36%|███▌      | 169/471 [00:30<00:56,  5.38it/s] 36%|███▌      | 170/471 [00:31<00:55,  5.40it/s] 36%|███▋      | 171/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 172/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 173/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 174/471 [00:31<00:55,  5.37it/s] 37%|███▋      | 175/471 [00:32<00:54,  5.38it/s] 37%|███▋      | 176/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 177/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 178/471 [00:32<00:54,  5.38it/s] 38%|███▊      | 179/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 180/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 181/471 [00:33<00:53,  5.38it/s] 39%|███▊      | 182/471 [00:33<00:53,  5.37it/s] 39%|███▉      | 183/471 [00:33<00:53,  5.37it/s] 39%|███▉      | 184/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 185/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 186/471 [00:34<00:53,  5.36it/s] 40%|███▉      | 187/471 [00:34<00:53,  5.35it/s] 40%|███▉      | 188/471 [00:34<00:52,  5.35it/s] 40%|████      | 189/471 [00:34<00:52,  5.36it/s] 40%|████      | 190/471 [00:34<00:51,  5.51it/s] 41%|████      | 191/471 [00:34<00:51,  5.41it/s] 41%|████      | 192/471 [00:35<00:51,  5.40it/s] 41%|████      | 193/471 [00:35<00:51,  5.41it/s] 41%|████      | 194/471 [00:35<00:51,  5.39it/s] 41%|████▏     | 195/471 [00:35<00:51,  5.37it/s] 42%|████▏     | 196/471 [00:35<00:51,  5.36it/s] 42%|████▏     | 197/471 [00:36<00:50,  5.39it/s] 42%|████▏     | 198/471 [00:36<00:50,  5.40it/s] 42%|████▏     | 199/471 [00:36<00:50,  5.38it/s] 42%|████▏     | 200/471 [00:36<00:50,  5.37it/s] 43%|████▎     | 201/471 [00:36<00:50,  5.40it/s] 43%|████▎     | 202/471 [00:37<00:50,  5.37it/s] 43%|████▎     | 203/471 [00:37<00:49,  5.37it/s] 43%|████▎     | 204/471 [00:37<00:49,  5.37it/s] 44%|████▎     | 205/471 [00:37<00:49,  5.37it/s] 44%|████▎     | 206/471 [00:37<00:49,  5.39it/s] 44%|████▍     | 207/471 [00:37<00:49,  5.36it/s] 44%|████▍     | 208/471 [00:38<00:48,  5.38it/s] 44%|████▍     | 209/471 [00:38<00:48,  5.40it/s] 45%|████▍     | 210/471 [00:38<00:48,  5.41it/s] 45%|████▍     | 211/471 [00:38<00:48,  5.39it/s] 45%|████▌     | 212/471 [00:38<00:48,  5.37it/s] 45%|████▌     | 213/471 [00:39<00:47,  5.38it/s] 45%|████▌     | 214/471 [00:39<00:47,  5.37it/s] 46%|████▌     | 215/471 [00:39<00:47,  5.37it/s] 46%|████▌     | 216/471 [00:39<00:47,  5.36it/s] 46%|████▌     | 217/471 [00:39<00:47,  5.35it/s] 46%|████▋     | 218/471 [00:39<00:47,  5.35it/s] 46%|████▋     | 219/471 [00:40<00:47,  5.35it/s] 47%|████▋     | 220/471 [00:40<00:46,  5.36it/s] 47%|████▋     | 221/471 [00:40<00:46,  5.34it/s] 47%|████▋     | 222/471 [00:40<00:46,  5.37it/s] 47%|████▋     | 223/471 [00:40<00:46,  5.37it/s] 48%|████▊     | 224/471 [00:41<00:46,  5.36it/s] 48%|████▊     | 225/471 [00:41<00:45,  5.37it/s] 48%|████▊     | 226/471 [00:41<00:45,  5.36it/s] 48%|████▊     | 227/471 [00:41<00:45,  5.35it/s] 48%|████▊     | 228/471 [00:41<00:45,  5.36it/s] 49%|████▊     | 229/471 [00:42<00:45,  5.36it/s] 49%|████▉     | 230/471 [00:42<00:45,  5.35it/s] 49%|████▉     | 231/471 [00:42<00:44,  5.34it/s] 49%|████▉     | 232/471 [00:42<00:44,  5.37it/s] 49%|████▉     | 233/471 [00:42<00:44,  5.37it/s] 50%|████▉     | 234/471 [00:42<00:44,  5.38it/s] 50%|████▉     | 235/471 [00:43<00:44,  5.35it/s] 50%|█████     | 236/471 [00:43<00:43,  5.35it/s] 50%|█████     | 237/471 [00:43<00:43,  5.36it/s] 51%|█████     | 238/471 [00:43<00:43,  5.36it/s] 51%|█████     | 239/471 [00:43<00:43,  5.36it/s] 51%|█████     | 240/471 [00:44<00:43,  5.37it/s] 51%|█████     | 241/471 [00:44<00:43,  5.35it/s] 51%|█████▏    | 242/471 [00:44<00:42,  5.35it/s] 52%|█████▏    | 243/471 [00:44<00:42,  5.36it/s] 52%|█████▏    | 244/471 [00:44<00:42,  5.36it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.34it/s] 52%|█████▏    | 246/471 [00:45<00:42,  5.35it/s] 52%|█████▏    | 247/471 [00:45<00:41,  5.38it/s] 53%|█████▎    | 248/471 [00:45<00:41,  5.38it/s] 53%|█████▎    | 249/471 [00:45<00:41,  5.37it/s] 53%|█████▎    | 250/471 [00:45<00:41,  5.36it/s] 53%|█████▎    | 251/471 [00:46<00:41,  5.36it/s] 54%|█████▎    | 252/471 [00:46<00:40,  5.37it/s] 54%|█████▎    | 253/471 [00:46<00:40,  5.36it/s] 54%|█████▍    | 254/471 [00:46<00:40,  5.34it/s] 54%|█████▍    | 255/471 [00:46<00:40,  5.35it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.33it/s] 55%|█████▍    | 257/471 [00:47<00:40,  5.33it/s] 55%|█████▍    | 258/471 [00:47<00:39,  5.34it/s] 55%|█████▍    | 259/471 [00:47<00:39,  5.35it/s] 55%|█████▌    | 260/471 [00:47<00:39,  5.34it/s] 55%|█████▌    | 261/471 [00:48<00:39,  5.34it/s] 56%|█████▌    | 262/471 [00:48<00:39,  5.34it/s] 56%|█████▌    | 263/471 [00:48<00:38,  5.36it/s] 56%|█████▌    | 264/471 [00:48<00:38,  5.36it/s] 56%|█████▋    | 265/471 [00:48<00:38,  5.36it/s] 56%|█████▋    | 266/471 [00:48<00:38,  5.34it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.33it/s] 57%|█████▋    | 268/471 [00:49<00:38,  5.33it/s] 57%|█████▋    | 269/471 [00:49<00:37,  5.35it/s] 57%|█████▋    | 270/471 [00:49<00:37,  5.37it/s] 58%|█████▊    | 271/471 [00:49<00:37,  5.36it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.37it/s] 58%|█████▊    | 273/471 [00:50<00:36,  5.37it/s] 58%|█████▊    | 274/471 [00:50<00:36,  5.39it/s] 58%|█████▊    | 275/471 [00:50<00:36,  5.40it/s] 59%|█████▊    | 276/471 [00:50<00:36,  5.39it/s] 59%|█████▉    | 277/471 [00:51<00:36,  5.38it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.36it/s] 59%|█████▉    | 279/471 [00:51<00:35,  5.37it/s] 59%|█████▉    | 280/471 [00:51<00:35,  5.38it/s] 60%|█████▉    | 281/471 [00:51<00:35,  5.36it/s] 60%|█████▉    | 282/471 [00:51<00:35,  5.36it/s] 60%|██████    | 283/471 [00:52<00:35,  5.36it/s] 60%|██████    | 284/471 [00:52<00:34,  5.36it/s] 61%|██████    | 285/471 [00:52<00:34,  5.37it/s] 61%|██████    | 286/471 [00:52<00:34,  5.35it/s] 61%|██████    | 287/471 [00:52<00:34,  5.35it/s] 61%|██████    | 288/471 [00:53<00:34,  5.34it/s] 61%|██████▏   | 289/471 [00:53<00:33,  5.38it/s] 62%|██████▏   | 290/471 [00:53<00:33,  5.37it/s] 62%|██████▏   | 291/471 [00:53<00:33,  5.37it/s] 62%|██████▏   | 292/471 [00:53<00:33,  5.36it/s] 62%|██████▏   | 293/471 [00:53<00:33,  5.37it/s] 62%|██████▏   | 294/471 [00:54<00:32,  5.38it/s] 63%|██████▎   | 295/471 [00:54<00:32,  5.38it/s] 63%|██████▎   | 296/471 [00:54<00:32,  5.41it/s] 63%|██████▎   | 297/471 [00:54<00:32,  5.38it/s] 63%|██████▎   | 298/471 [00:54<00:32,  5.36it/s] 63%|██████▎   | 299/471 [00:55<00:31,  5.38it/s] 64%|██████▎   | 300/471 [00:55<00:31,  5.36it/s] 64%|██████▍   | 301/471 [00:55<00:31,  5.37it/s] 64%|██████▍   | 302/471 [00:55<00:31,  5.36it/s] 64%|██████▍   | 303/471 [00:55<00:31,  5.35it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.37it/s] 65%|██████▍   | 305/471 [00:56<00:30,  5.36it/s] 65%|██████▍   | 306/471 [00:56<00:30,  5.35it/s] 65%|██████▌   | 307/471 [00:56<00:30,  5.34it/s] 65%|██████▌   | 308/471 [00:56<00:30,  5.34it/s] 66%|██████▌   | 309/471 [00:56<00:30,  5.34it/s] 66%|██████▌   | 310/471 [00:57<00:30,  5.35it/s] 66%|██████▌   | 311/471 [00:57<00:29,  5.34it/s] 66%|██████▌   | 312/471 [00:57<00:29,  5.36it/s] 66%|██████▋   | 313/471 [00:57<00:29,  5.36it/s] 67%|██████▋   | 314/471 [00:57<00:29,  5.37it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.37it/s] 67%|██████▋   | 316/471 [00:58<00:28,  5.38it/s] 67%|██████▋   | 317/471 [00:58<00:28,  5.38it/s] 68%|██████▊   | 318/471 [00:58<00:28,  5.35it/s] 68%|██████▊   | 319/471 [00:58<00:28,  5.34it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.35it/s] 68%|██████▊   | 321/471 [00:59<00:28,  5.33it/s] 68%|██████▊   | 322/471 [00:59<00:27,  5.34it/s] 69%|██████▊   | 323/471 [00:59<00:27,  5.32it/s] 69%|██████▉   | 324/471 [00:59<00:27,  5.32it/s] 69%|██████▉   | 325/471 [00:59<00:27,  5.34it/s] 69%|██████▉   | 326/471 [01:00<00:27,  5.34it/s] 69%|██████▉   | 327/471 [01:00<00:26,  5.35it/s] 70%|██████▉   | 328/471 [01:00<00:26,  5.35it/s] 70%|██████▉   | 329/471 [01:00<00:26,  5.34it/s] 70%|███████   | 330/471 [01:00<00:26,  5.36it/s] 70%|███████   | 331/471 [01:01<00:26,  5.36it/s] 70%|███████   | 332/471 [01:01<00:25,  5.35it/s] 71%|███████   | 333/471 [01:01<00:25,  5.35it/s] 71%|███████   | 334/471 [01:01<00:25,  5.36it/s] 71%|███████   | 335/471 [01:01<00:25,  5.34it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.35it/s] 72%|███████▏  | 337/471 [01:02<00:24,  5.37it/s] 72%|███████▏  | 338/471 [01:02<00:24,  5.37it/s] 72%|███████▏  | 339/471 [01:02<00:24,  5.35it/s] 72%|███████▏  | 340/471 [01:02<00:24,  5.36it/s] 72%|███████▏  | 341/471 [01:02<00:24,  5.35it/s] 73%|███████▎  | 342/471 [01:03<00:24,  5.35it/s] 73%|███████▎  | 343/471 [01:03<00:23,  5.34it/s] 73%|███████▎  | 344/471 [01:03<00:23,  5.37it/s] 73%|███████▎  | 345/471 [01:03<00:23,  5.36it/s] 73%|███████▎  | 346/471 [01:03<00:23,  5.34it/s] 74%|███████▎  | 347/471 [01:04<00:23,  5.36it/s] 74%|███████▍  | 348/471 [01:04<00:23,  5.34it/s] 74%|███████▍  | 349/471 [01:04<00:22,  5.33it/s] 74%|███████▍  | 350/471 [01:04<00:22,  5.34it/s] 75%|███████▍  | 351/471 [01:04<00:22,  5.36it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.35it/s] 75%|███████▍  | 353/471 [01:05<00:22,  5.34it/s] 75%|███████▌  | 354/471 [01:05<00:21,  5.32it/s] 75%|███████▌  | 355/471 [01:05<00:21,  5.33it/s] 76%|███████▌  | 356/471 [01:05<00:21,  5.33it/s] 76%|███████▌  | 357/471 [01:05<00:21,  5.33it/s] 76%|███████▌  | 358/471 [01:06<00:21,  5.35it/s] 76%|███████▌  | 359/471 [01:06<00:20,  5.34it/s] 76%|███████▋  | 360/471 [01:06<00:20,  5.33it/s] 77%|███████▋  | 361/471 [01:06<00:20,  5.34it/s] 77%|███████▋  | 362/471 [01:06<00:20,  5.35it/s] 77%|███████▋  | 363/471 [01:07<00:20,  5.35it/s] 77%|███████▋  | 364/471 [01:07<00:19,  5.35it/s] 77%|███████▋  | 365/471 [01:07<00:19,  5.34it/s] 78%|███████▊  | 366/471 [01:07<00:19,  5.33it/s] 78%|███████▊  | 367/471 [01:07<00:19,  5.33it/s] 78%|███████▊  | 368/471 [01:08<00:19,  5.34it/s] 78%|███████▊  | 369/471 [01:08<00:19,  5.36it/s] 79%|███████▊  | 370/471 [01:08<00:18,  5.35it/s] 79%|███████▉  | 371/471 [01:08<00:18,  5.34it/s] 79%|███████▉  | 372/471 [01:08<00:18,  5.34it/s] 79%|███████▉  | 373/471 [01:08<00:18,  5.34it/s] 79%|███████▉  | 374/471 [01:09<00:18,  5.35it/s] 80%|███████▉  | 375/471 [01:09<00:17,  5.35it/s] 80%|███████▉  | 376/471 [01:09<00:17,  5.35it/s] 80%|████████  | 377/471 [01:09<00:17,  5.35it/s] 80%|████████  | 378/471 [01:09<00:17,  5.37it/s] 80%|████████  | 379/471 [01:10<00:17,  5.36it/s] 81%|████████  | 380/471 [01:10<00:17,  5.35it/s] 81%|████████  | 381/471 [01:10<00:16,  5.35it/s] 81%|████████  | 382/471 [01:10<00:16,  5.35it/s] 81%|████████▏ | 383/471 [01:10<00:16,  5.34it/s] 82%|████████▏ | 384/471 [01:10<00:16,  5.33it/s] 82%|████████▏ | 385/471 [01:11<00:16,  5.32it/s] 82%|████████▏ | 386/471 [01:11<00:15,  5.33it/s] 82%|████████▏ | 387/471 [01:11<00:15,  5.33it/s] 82%|████████▏ | 388/471 [01:11<00:15,  5.33it/s] 83%|████████▎ | 389/471 [01:11<00:15,  5.34it/s] 83%|████████▎ | 390/471 [01:12<00:15,  5.33it/s] 83%|████████▎ | 391/471 [01:12<00:14,  5.35it/s] 83%|████████▎ | 392/471 [01:12<00:14,  5.35it/s] 83%|████████▎ | 393/471 [01:12<00:14,  5.35it/s] 84%|████████▎ | 394/471 [01:12<00:14,  5.33it/s] 84%|████████▍ | 395/471 [01:13<00:14,  5.33it/s] 84%|████████▍ | 396/471 [01:13<00:14,  5.31it/s] 84%|████████▍ | 397/471 [01:13<00:13,  5.33it/s] 85%|████████▍ | 398/471 [01:13<00:13,  5.33it/s] 85%|████████▍ | 399/471 [01:13<00:13,  5.33it/s] 85%|████████▍ | 400/471 [01:13<00:13,  5.33it/s] 85%|████████▌ | 401/471 [01:14<00:13,  5.33it/s] 85%|████████▌ | 402/471 [01:14<00:12,  5.33it/s] 86%|████████▌ | 403/471 [01:14<00:12,  5.35it/s] 86%|████████▌ | 404/471 [01:14<00:12,  5.35it/s] 86%|████████▌ | 405/471 [01:14<00:12,  5.34it/s] 86%|████████▌ | 406/471 [01:15<00:12,  5.35it/s] 86%|████████▋ | 407/471 [01:15<00:11,  5.36it/s] 87%|████████▋ | 408/471 [01:15<00:11,  5.34it/s] 87%|████████▋ | 409/471 [01:15<00:11,  5.34it/s] 87%|████████▋ | 410/471 [01:15<00:11,  5.36it/s] 87%|████████▋ | 411/471 [01:16<00:11,  5.37it/s] 87%|████████▋ | 412/471 [01:16<00:11,  5.36it/s] 88%|████████▊ | 413/471 [01:16<00:10,  5.36it/s] 88%|████████▊ | 414/471 [01:16<00:10,  5.34it/s] 88%|████████▊ | 415/471 [01:16<00:10,  5.33it/s] 88%|████████▊ | 416/471 [01:16<00:10,  5.33it/s] 89%|████████▊ | 417/471 [01:17<00:10,  5.35it/s] 89%|████████▊ | 418/471 [01:17<00:09,  5.34it/s] 89%|████████▉ | 419/471 [01:17<00:09,  5.35it/s] 89%|████████▉ | 420/471 [01:17<00:09,  5.37it/s] 89%|████████▉ | 421/471 [01:17<00:09,  5.35it/s] 90%|████████▉ | 422/471 [01:18<00:09,  5.36it/s] 90%|████████▉ | 423/471 [01:18<00:08,  5.37it/s] 90%|█████████ | 424/471 [01:18<00:08,  5.35it/s] 90%|█████████ | 425/471 [01:18<00:08,  5.37it/s] 90%|█████████ | 426/471 [01:18<00:08,  5.34it/s] 91%|█████████ | 427/471 [01:19<00:08,  5.33it/s] 91%|█████████ | 428/471 [01:19<00:08,  5.33it/s] 91%|█████████ | 429/471 [01:19<00:07,  5.33it/s] 91%|█████████▏| 430/471 [01:19<00:07,  5.34it/s] 92%|█████████▏| 431/471 [01:19<00:07,  5.33it/s] 92%|█████████▏| 432/471 [01:19<00:07,  5.32it/s] 92%|█████████▏| 433/471 [01:20<00:07,  5.33it/s] 92%|█████████▏| 434/471 [01:20<00:06,  5.33it/s] 92%|█████████▏| 435/471 [01:20<00:06,  5.32it/s] 93%|█████████▎| 436/471 [01:20<00:06,  5.34it/s] 93%|█████████▎| 437/471 [01:20<00:06,  5.32it/s] 93%|█████████▎| 438/471 [01:21<00:06,  5.34it/s] 93%|█████████▎| 439/471 [01:21<00:05,  5.34it/s] 93%|█████████▎| 440/471 [01:21<00:05,  5.34it/s] 94%|█████████▎| 441/471 [01:21<00:05,  5.36it/s] 94%|█████████▍| 442/471 [01:21<00:05,  5.36it/s] 94%|█████████▍| 443/471 [01:22<00:05,  5.35it/s] 94%|█████████▍| 444/471 [01:22<00:05,  5.35it/s] 94%|█████████▍| 445/471 [01:22<00:04,  5.34it/s] 95%|█████████▍| 446/471 [01:22<00:04,  5.33it/s] 95%|█████████▍| 447/471 [01:22<00:04,  5.34it/s] 95%|█████████▌| 448/471 [01:22<00:04,  5.36it/s] 95%|█████████▌| 449/471 [01:23<00:04,  5.36it/s] 96%|█████████▌| 450/471 [01:23<00:03,  5.34it/s] 96%|█████████▌| 451/471 [01:23<00:03,  5.32it/s] 96%|█████████▌| 452/471 [01:23<00:03,  5.35it/s] 96%|█████████▌| 453/471 [01:23<00:03,  5.34it/s] 96%|█████████▋| 454/471 [01:24<00:03,  5.33it/s] 97%|█████████▋| 455/471 [01:24<00:03,  5.32it/s] 97%|█████████▋| 456/471 [01:24<00:02,  5.33it/s] 97%|█████████▋| 457/471 [01:24<00:02,  5.33it/s] 97%|█████████▋| 458/471 [01:24<00:02,  5.33it/s] 97%|█████████▋| 459/471 [01:25<00:02,  5.36it/s] 98%|█████████▊| 460/471 [01:25<00:02,  5.35it/s] 98%|█████████▊| 461/471 [01:25<00:01,  5.33it/s] 98%|█████████▊| 462/471 [01:25<00:01,  5.32it/s] 98%|█████████▊| 463/471 [01:25<00:01,  5.33it/s] 99%|█████████▊| 464/471 [01:25<00:01,  5.35it/s] 99%|█████████▊| 465/471 [01:26<00:01,  5.36it/s] 99%|█████████▉| 466/471 [01:26<00:00,  5.35it/s] 99%|█████████▉| 467/471 [01:26<00:00,  5.34it/s] 99%|█████████▉| 468/471 [01:26<00:00,  5.32it/s]100%|█████████▉| 469/471 [01:26<00:00,  5.32it/s]100%|█████████▉| 470/471 [01:27<00:00,  5.33it/s]100%|██████████| 471/471 [01:27<00:00,  5.71it/s]100%|██████████| 471/471 [01:27<00:00,  5.40it/s]
{'eval_loss': 5.460373878479004, 'eval_model_preparation_time': 0.0054, 'eval_acc': 0.1533457249070632, 'eval_runtime': 87.421, 'eval_samples_per_second': 86.158, 'eval_steps_per_second': 5.388}
ROUND:1
CLIENT:26
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]                                              {'loss': 7.3316, 'grad_norm': 4.508696556091309, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]                                              {'loss': 5.3674, 'grad_norm': 4.951786994934082, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]  8%|▊         | 3/40 [00:00<00:12,  3.04it/s]                                              {'loss': 4.7561, 'grad_norm': 4.822623252868652, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.04it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s]                                              {'loss': 3.4589, 'grad_norm': 5.5593061447143555, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.4157, 'grad_norm': 7.218086242675781, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s]                                              {'loss': 3.2587, 'grad_norm': 8.892090797424316, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s] 18%|█▊        | 7/40 [00:02<00:11,  3.00it/s]                                              {'loss': 3.9383, 'grad_norm': 11.72268295288086, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  3.00it/s]                                              {'loss': 0.9076, 'grad_norm': 28.697275161743164, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s]                                              {'loss': 2.5346, 'grad_norm': 10.291269302368164, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s]                                               {'loss': 2.3246, 'grad_norm': 8.0574369430542, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s]                                               {'loss': 2.4378, 'grad_norm': 9.708581924438477, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.3162, 'grad_norm': 6.754654884338379, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s]                                               {'loss': 1.9313, 'grad_norm': 6.855287551879883, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.3154, 'grad_norm': 7.508688926696777, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.8187, 'grad_norm': 6.834816932678223, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.8579, 'grad_norm': 14.824772834777832, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s]                                               {'loss': 0.9442, 'grad_norm': 4.481246471405029, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s]                                               {'loss': 1.0398, 'grad_norm': 5.394358158111572, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s]                                               {'loss': 0.7136, 'grad_norm': 4.676941871643066, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 0.9718, 'grad_norm': 8.541247367858887, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.725, 'grad_norm': 6.0795979499816895, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s]                                               {'loss': 1.1266, 'grad_norm': 6.447619915008545, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.04it/s]                                               {'loss': 1.1493, 'grad_norm': 6.34674596786499, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.04it/s]                                               {'loss': 0.72, 'grad_norm': 18.270177841186523, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.04it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s]                                               {'loss': 0.1001, 'grad_norm': 1.363173484802246, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.3021, 'grad_norm': 3.240379571914673, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.4148, 'grad_norm': 3.6889772415161133, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.4226, 'grad_norm': 3.527785539627075, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.6761, 'grad_norm': 4.396857261657715, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.3709, 'grad_norm': 3.524221181869507, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 1.1014, 'grad_norm': 4.135857105255127, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.0102, 'grad_norm': 0.5374088883399963, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.13it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s]                                               {'loss': 0.2792, 'grad_norm': 5.686310768127441, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s]                                               {'loss': 0.161, 'grad_norm': 3.8289759159088135, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s]                                               {'loss': 0.3011, 'grad_norm': 3.3358569145202637, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.3164, 'grad_norm': 0.769597053527832, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.2901, 'grad_norm': 1.6744287014007568, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.0745, 'grad_norm': 1.1906477212905884, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.1456, 'grad_norm': 1.5087385177612305, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.6358, 'grad_norm': 10.756442070007324, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.11it/s]                                               {'train_runtime': 12.0986, 'train_samples_per_second': 46.7, 'train_steps_per_second': 3.306, 'train_loss': 1.5240735669387504, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.11it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  3.00it/s]                                              {'loss': 4.8176, 'grad_norm': 5.279788017272949, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  3.00it/s]  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]                                              {'loss': 3.2461, 'grad_norm': 3.616374969482422, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]  8%|▊         | 3/40 [00:00<00:12,  3.06it/s]                                              {'loss': 5.8951, 'grad_norm': 5.233160495758057, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.06it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s]                                              {'loss': 4.4465, 'grad_norm': 4.9600043296813965, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.4295, 'grad_norm': 5.708347797393799, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s]                                              {'loss': 3.4157, 'grad_norm': 9.329131126403809, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 4.5764, 'grad_norm': 12.366978645324707, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 0.405, 'grad_norm': 20.703102111816406, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.03it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s]                                              {'loss': 2.5716, 'grad_norm': 16.048044204711914, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.61it/s]                                               {'loss': 2.3652, 'grad_norm': 14.332062721252441, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.61it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.45it/s]                                               {'loss': 3.0985, 'grad_norm': 12.652093887329102, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.45it/s] 30%|███       | 12/40 [00:03<00:08,  3.30it/s]                                               {'loss': 0.8248, 'grad_norm': 7.7523956298828125, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.30it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.22it/s]                                               {'loss': 1.7907, 'grad_norm': 7.954609394073486, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.22it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s]                                               {'loss': 2.5148, 'grad_norm': 10.220392227172852, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 2.2106, 'grad_norm': 11.425522804260254, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 4.0686, 'grad_norm': 62.76512145996094, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 1.1176, 'grad_norm': 9.62702465057373, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 0.7754, 'grad_norm': 8.199993133544922, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 2.0739, 'grad_norm': 11.42017650604248, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.29it/s]                                               {'loss': 0.8354, 'grad_norm': 6.6036272048950195, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.29it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 1.0096, 'grad_norm': 5.932577133178711, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 1.5379, 'grad_norm': 5.667778968811035, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.9075, 'grad_norm': 8.594218254089355, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.0382, 'grad_norm': 1.760911464691162, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s]                                               {'loss': 0.1477, 'grad_norm': 3.330723285675049, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s]                                               {'loss': 0.6451, 'grad_norm': 7.078949451446533, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.4977, 'grad_norm': 2.7136430740356445, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.23it/s]                                               {'loss': 1.0091, 'grad_norm': 8.962761878967285, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.23it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s]                                               {'loss': 0.9702, 'grad_norm': 5.423149585723877, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.3167, 'grad_norm': 2.0266308784484863, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.5643, 'grad_norm': 6.131199836730957, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.0505, 'grad_norm': 2.956747531890869, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.12it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.91it/s]                                               {'loss': 0.4105, 'grad_norm': 2.6879312992095947, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.91it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s]                                               {'loss': 0.4675, 'grad_norm': 5.314999103546143, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s]                                               {'loss': 0.3977, 'grad_norm': 5.610594749450684, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s]                                               {'loss': 0.179, 'grad_norm': 5.424214839935303, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s]                                               {'loss': 0.4772, 'grad_norm': 1.0814179182052612, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.2546, 'grad_norm': 3.305849075317383, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.3514, 'grad_norm': 2.082155227661133, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0019, 'grad_norm': 0.12310627847909927, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 12.0376, 'train_samples_per_second': 46.936, 'train_steps_per_second': 3.323, 'train_loss': 1.617836385499686, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.13it/s]100%|██████████| 40/40 [00:12<00:00,  3.32it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 4.9206, 'grad_norm': 4.022654056549072, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]                                              {'loss': 4.228, 'grad_norm': 4.328605651855469, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 3.9345, 'grad_norm': 6.264374256134033, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.05it/s]                                              {'loss': 3.5367, 'grad_norm': 6.782312870025635, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.05it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.0923, 'grad_norm': 8.203606605529785, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.7533, 'grad_norm': 9.483989715576172, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 4.1471, 'grad_norm': 19.06791114807129, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 5.6974, 'grad_norm': 60.85590362548828, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.79it/s]                                              {'loss': 1.776, 'grad_norm': 12.536731719970703, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.79it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s]                                               {'loss': 1.5185, 'grad_norm': 8.456541061401367, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s]                                               {'loss': 2.0778, 'grad_norm': 10.745285987854004, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.1788, 'grad_norm': 10.483850479125977, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 0.8811, 'grad_norm': 8.062703132629395, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s]                                               {'loss': 1.1338, 'grad_norm': 6.7618408203125, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 1.4501, 'grad_norm': 5.194679260253906, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 2.9745, 'grad_norm': 34.74333953857422, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.13it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s]                                               {'loss': 0.732, 'grad_norm': 6.588704586029053, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s]                                               {'loss': 0.6478, 'grad_norm': 5.906280994415283, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.734, 'grad_norm': 5.486060619354248, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 0.9248, 'grad_norm': 9.525382995605469, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.5727, 'grad_norm': 3.866697072982788, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.6831, 'grad_norm': 5.2382612228393555, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.3723, 'grad_norm': 8.322839736938477, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.0917, 'grad_norm': 8.223782539367676, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s]                                               {'loss': 0.0478, 'grad_norm': 0.9979355335235596, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.7229, 'grad_norm': 7.165637969970703, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.3262, 'grad_norm': 3.69735050201416, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.3564, 'grad_norm': 2.821544647216797, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.5251, 'grad_norm': 4.155886650085449, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.4253, 'grad_norm': 8.553959846496582, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.2529, 'grad_norm': 1.8903239965438843, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.7483, 'grad_norm': 27.876150131225586, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s]                                               {'loss': 0.0249, 'grad_norm': 0.3571806848049164, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s]                                               {'loss': 0.0656, 'grad_norm': 1.1544893980026245, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.3157, 'grad_norm': 3.0995078086853027, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.1158, 'grad_norm': 6.211664199829102, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.0539, 'grad_norm': 1.0508966445922852, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.3128, 'grad_norm': 2.673903226852417, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.3207, 'grad_norm': 6.622755527496338, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0018, 'grad_norm': 0.07604515552520752, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.14it/s]                                               {'train_runtime': 12.1311, 'train_samples_per_second': 46.575, 'train_steps_per_second': 3.297, 'train_loss': 1.391870107088471, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.14it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]                                              {'loss': 5.701, 'grad_norm': 4.748131275177002, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 6.3979, 'grad_norm': 4.357882499694824, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:12,  3.02it/s]                                              {'loss': 5.2976, 'grad_norm': 5.2983598709106445, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.02it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 4.9461, 'grad_norm': 5.967511177062988, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.7124, 'grad_norm': 6.602567672729492, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s]                                              {'loss': 4.0417, 'grad_norm': 10.574263572692871, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 2.7719, 'grad_norm': 8.711854934692383, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 7.1866, 'grad_norm': 52.041412353515625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s]                                              {'loss': 2.6497, 'grad_norm': 13.312254905700684, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.53it/s]                                               {'loss': 2.5967, 'grad_norm': 11.554030418395996, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.53it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s]                                               {'loss': 1.9767, 'grad_norm': 10.344623565673828, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s] 30%|███       | 12/40 [00:03<00:08,  3.25it/s]                                               {'loss': 1.8294, 'grad_norm': 10.357806205749512, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.25it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 2.1552, 'grad_norm': 7.236292839050293, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s]                                               {'loss': 1.7351, 'grad_norm': 12.092992782592773, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 2.9542, 'grad_norm': 11.10621166229248, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 2.3922, 'grad_norm': 28.844587326049805, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s]                                               {'loss': 1.2603, 'grad_norm': 7.20540714263916, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s]                                               {'loss': 1.3632, 'grad_norm': 6.541444778442383, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s]                                               {'loss': 0.8234, 'grad_norm': 4.875884532928467, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s] 50%|█████     | 20/40 [00:06<00:06,  3.24it/s]                                               {'loss': 1.3565, 'grad_norm': 4.671456336975098, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.24it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 1.3329, 'grad_norm': 6.184872150421143, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.8047, 'grad_norm': 4.08002233505249, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 1.1338, 'grad_norm': 5.292686462402344, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.0171, 'grad_norm': 0.7733901143074036, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s]                                               {'loss': 0.7799, 'grad_norm': 4.472769260406494, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s]                                               {'loss': 0.5751, 'grad_norm': 2.657460927963257, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s]                                               {'loss': 0.398, 'grad_norm': 2.8482775688171387, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s] 70%|███████   | 28/40 [00:08<00:03,  3.31it/s]                                               {'loss': 0.7873, 'grad_norm': 2.4295411109924316, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.31it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.4478, 'grad_norm': 5.0757737159729, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s]                                               {'loss': 0.5511, 'grad_norm': 5.376423358917236, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.6773, 'grad_norm': 3.47629714012146, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.6586, 'grad_norm': 20.1375789642334, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.67it/s]                                               {'loss': 0.3624, 'grad_norm': 2.6367175579071045, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.67it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.48it/s]                                               {'loss': 1.216, 'grad_norm': 1.402846336364746, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.48it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.1302, 'grad_norm': 1.5912891626358032, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.32it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.20it/s]                                               {'loss': 0.1365, 'grad_norm': 1.441809058189392, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.20it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.1719, 'grad_norm': 2.5305705070495605, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.09it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.1496, 'grad_norm': 1.9784237146377563, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.04it/s]                                               {'loss': 0.2185, 'grad_norm': 2.218945026397705, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.04it/s]                                               {'loss': 0.0462, 'grad_norm': 1.8592396974563599, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.04it/s]                                               {'train_runtime': 12.2737, 'train_samples_per_second': 46.033, 'train_steps_per_second': 3.259, 'train_loss': 1.8435699936933816, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.04it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:77
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]                                              {'loss': 5.7186, 'grad_norm': 5.176568508148193, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]                                              {'loss': 3.6527, 'grad_norm': 4.014581680297852, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]  8%|▊         | 3/40 [00:01<00:12,  2.96it/s]                                              {'loss': 5.2635, 'grad_norm': 5.413628101348877, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.96it/s] 10%|█         | 4/40 [00:01<00:12,  2.95it/s]                                              {'loss': 2.7323, 'grad_norm': 4.618246555328369, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.95it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s]                                              {'loss': 3.7068, 'grad_norm': 6.62839937210083, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.97it/s]                                              {'loss': 3.4312, 'grad_norm': 8.844183921813965, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.97it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 3.349, 'grad_norm': 10.57883071899414, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 1.0719, 'grad_norm': 25.558645248413086, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.62it/s]                                              {'loss': 3.1718, 'grad_norm': 13.99014663696289, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.62it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.33it/s]                                               {'loss': 1.7052, 'grad_norm': 12.91433048248291, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.33it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.1675, 'grad_norm': 10.30088996887207, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.23it/s] 30%|███       | 12/40 [00:03<00:08,  3.15it/s]                                               {'loss': 1.0118, 'grad_norm': 6.37601900100708, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.15it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.11it/s]                                               {'loss': 2.0514, 'grad_norm': 8.035228729248047, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.11it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.8106, 'grad_norm': 6.8992743492126465, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 2.2709, 'grad_norm': 8.85280704498291, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.0721, 'grad_norm': 3.0314390659332275, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.06it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s]                                               {'loss': 0.6489, 'grad_norm': 5.169539451599121, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 1.1068, 'grad_norm': 5.804732799530029, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s]                                               {'loss': 1.3409, 'grad_norm': 5.692560195922852, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s] 50%|█████     | 20/40 [00:06<00:06,  3.29it/s]                                               {'loss': 0.8684, 'grad_norm': 5.347105026245117, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.29it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.8089, 'grad_norm': 4.625060558319092, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.6026, 'grad_norm': 5.81695032119751, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.14it/s]                                               {'loss': 0.7998, 'grad_norm': 7.129211902618408, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.14it/s]                                               {'loss': 0.1966, 'grad_norm': 12.24519157409668, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.14it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.75it/s]                                               {'loss': 0.4999, 'grad_norm': 17.407432556152344, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.75it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.53it/s]                                               {'loss': 0.327, 'grad_norm': 5.114711761474609, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.53it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s]                                               {'loss': 0.2436, 'grad_norm': 3.216604471206665, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s] 70%|███████   | 28/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.6918, 'grad_norm': 7.565366744995117, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.32it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.52, 'grad_norm': 21.8776798248291, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.2144, 'grad_norm': 4.653885841369629, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.2391, 'grad_norm': 4.449470520019531, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.0437, 'grad_norm': 1.7682428359985352, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.12it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.1315, 'grad_norm': 2.007091999053955, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 0.2398, 'grad_norm': 2.509509801864624, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.2413, 'grad_norm': 3.867051124572754, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.2429, 'grad_norm': 3.7687342166900635, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.2993, 'grad_norm': 3.3431003093719482, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.3969, 'grad_norm': 10.452202796936035, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0978, 'grad_norm': 2.442751884460449, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.1312, 'grad_norm': 4.471185684204102, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 12.216, 'train_samples_per_second': 46.251, 'train_steps_per_second': 3.274, 'train_loss': 1.3030005637556314, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.13it/s]100%|██████████| 40/40 [00:12<00:00,  3.27it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.18it/s]                                              {'loss': 4.8641, 'grad_norm': 5.088180065155029, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.18it/s]  5%|▌         | 2/40 [00:00<00:12,  3.12it/s]                                              {'loss': 5.1069, 'grad_norm': 2.8853838443756104, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.12it/s]  8%|▊         | 3/40 [00:00<00:12,  3.08it/s]                                              {'loss': 4.9907, 'grad_norm': 4.998594760894775, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.08it/s] 10%|█         | 4/40 [00:01<00:11,  3.06it/s]                                              {'loss': 4.9201, 'grad_norm': 6.908781051635742, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.06it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 4.8511, 'grad_norm': 8.066431045532227, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s]                                              {'loss': 4.0604, 'grad_norm': 9.353437423706055, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s]                                              {'loss': 2.4655, 'grad_norm': 8.929073333740234, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s] 20%|██        | 8/40 [00:02<00:08,  3.83it/s]                                              {'loss': 2.4038, 'grad_norm': 59.49775314331055, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.83it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.53it/s]                                              {'loss': 2.5593, 'grad_norm': 16.629947662353516, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.53it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.37it/s]                                               {'loss': 3.1837, 'grad_norm': 13.163651466369629, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.37it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.24it/s]                                               {'loss': 2.6844, 'grad_norm': 12.688586235046387, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.24it/s] 30%|███       | 12/40 [00:03<00:08,  3.15it/s]                                               {'loss': 2.1701, 'grad_norm': 8.624185562133789, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.15it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.7201, 'grad_norm': 8.10090160369873, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.11it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.06it/s]                                               {'loss': 2.1102, 'grad_norm': 8.379798889160156, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.06it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.02it/s]                                               {'loss': 1.6627, 'grad_norm': 6.727718353271484, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.02it/s]                                               {'loss': 0.4946, 'grad_norm': 19.53130340576172, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.02it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.72it/s]                                               {'loss': 0.9875, 'grad_norm': 5.48219633102417, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.72it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.51it/s]                                               {'loss': 0.579, 'grad_norm': 3.5542538166046143, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.51it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s]                                               {'loss': 0.9357, 'grad_norm': 7.489242076873779, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s] 50%|█████     | 20/40 [00:06<00:06,  3.26it/s]                                               {'loss': 0.697, 'grad_norm': 6.133687496185303, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.26it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s]                                               {'loss': 1.1148, 'grad_norm': 6.981644153594971, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 1.2145, 'grad_norm': 8.623945236206055, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 1.0532, 'grad_norm': 6.977169513702393, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.2271, 'grad_norm': 10.022567749023438, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.68it/s]                                               {'loss': 0.1961, 'grad_norm': 2.8809642791748047, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.68it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.46it/s]                                               {'loss': 0.7797, 'grad_norm': 5.093419551849365, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.46it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.35it/s]                                               {'loss': 0.8502, 'grad_norm': 2.7487127780914307, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.35it/s] 70%|███████   | 28/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.244, 'grad_norm': 6.278807640075684, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.23it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.14it/s]                                               {'loss': 0.2974, 'grad_norm': 3.0389723777770996, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.14it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.09it/s]                                               {'loss': 0.1569, 'grad_norm': 2.6022021770477295, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.09it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.2984, 'grad_norm': 3.448575019836426, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.0092, 'grad_norm': 0.5032679438591003, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.06it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s]                                               {'loss': 0.4495, 'grad_norm': 0.6576254367828369, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s]                                               {'loss': 0.0595, 'grad_norm': 1.5022164583206177, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.2288, 'grad_norm': 2.0216171741485596, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s]                                               {'loss': 0.3921, 'grad_norm': 1.765398621559143, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.1891, 'grad_norm': 3.277463674545288, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.3176, 'grad_norm': 4.080821990966797, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.1538, 'grad_norm': 1.4635233879089355, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.017, 'grad_norm': 1.5614347457885742, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.09it/s]                                               {'train_runtime': 12.3771, 'train_samples_per_second': 45.649, 'train_steps_per_second': 3.232, 'train_loss': 1.5423994835000485, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.09it/s]100%|██████████| 40/40 [00:12<00:00,  3.23it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]                                              {'loss': 5.4242, 'grad_norm': 3.8586063385009766, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]                                              {'loss': 5.9468, 'grad_norm': 4.279901504516602, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]  8%|▊         | 3/40 [00:00<00:12,  3.07it/s]                                              {'loss': 5.6611, 'grad_norm': 7.508489608764648, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.07it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s]                                              {'loss': 4.2374, 'grad_norm': 6.776479244232178, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.5224, 'grad_norm': 8.386080741882324, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 4.2158, 'grad_norm': 9.866616249084473, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.07it/s]                                              {'loss': 4.551, 'grad_norm': 13.37695598602295, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.07it/s]                                              {'loss': 2.2687, 'grad_norm': 41.626094818115234, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.07it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s]                                              {'loss': 2.5994, 'grad_norm': 11.363706588745117, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.59it/s]                                               {'loss': 2.262, 'grad_norm': 11.167330741882324, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.59it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s]                                               {'loss': 2.3755, 'grad_norm': 9.422752380371094, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s] 30%|███       | 12/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.4547, 'grad_norm': 8.447758674621582, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.33it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s]                                               {'loss': 2.0917, 'grad_norm': 9.319645881652832, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.7345, 'grad_norm': 9.605936050415039, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.9147, 'grad_norm': 9.005224227905273, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.005, 'grad_norm': 0.24939051270484924, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.67it/s]                                               {'loss': 1.2568, 'grad_norm': 3.771472454071045, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.67it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.47it/s]                                               {'loss': 1.3684, 'grad_norm': 6.968827724456787, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.47it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.34it/s]                                               {'loss': 1.1002, 'grad_norm': 5.750629425048828, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.34it/s] 50%|█████     | 20/40 [00:06<00:06,  3.25it/s]                                               {'loss': 1.6074, 'grad_norm': 7.023726463317871, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.25it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 1.2916, 'grad_norm': 6.018409729003906, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.7191, 'grad_norm': 4.690309524536133, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.7003, 'grad_norm': 4.4410014152526855, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.1575, 'grad_norm': 24.180152893066406, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.75it/s]                                               {'loss': 0.6595, 'grad_norm': 3.1383442878723145, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.75it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s]                                               {'loss': 0.4701, 'grad_norm': 3.4725208282470703, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.2578, 'grad_norm': 4.407629489898682, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.3352, 'grad_norm': 3.181765079498291, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.6094, 'grad_norm': 3.1595458984375, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s]                                               {'loss': 0.3959, 'grad_norm': 2.441354751586914, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.938, 'grad_norm': 3.267894744873047, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.3168, 'grad_norm': 22.846582412719727, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.13it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s]                                               {'loss': 0.7468, 'grad_norm': 2.284379243850708, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s]                                               {'loss': 0.3931, 'grad_norm': 3.031179904937744, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s]                                               {'loss': 0.136, 'grad_norm': 1.6440356969833374, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s]                                               {'loss': 0.1318, 'grad_norm': 6.4655442237854, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s]                                               {'loss': 0.189, 'grad_norm': 3.8859329223632812, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.2031, 'grad_norm': 2.117387533187866, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1405, 'grad_norm': 2.4434142112731934, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0536, 'grad_norm': 2.3894264698028564, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.14it/s]                                               {'train_runtime': 12.0674, 'train_samples_per_second': 46.82, 'train_steps_per_second': 3.315, 'train_loss': 1.611069554160349, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.14it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.10it/s]                                              {'loss': 5.5646, 'grad_norm': 4.124462604522705, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.10it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 5.3135, 'grad_norm': 3.949831962585449, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:12,  3.03it/s]                                              {'loss': 3.7967, 'grad_norm': 5.373656749725342, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.03it/s] 10%|█         | 4/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.898, 'grad_norm': 6.050782680511475, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.05it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 4.3588, 'grad_norm': 6.577327728271484, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s]                                              {'loss': 2.8617, 'grad_norm': 6.258180141448975, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.11it/s]                                              {'loss': 3.4769, 'grad_norm': 7.273979663848877, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.11it/s]                                              {'loss': 3.6141, 'grad_norm': 34.85625457763672, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.11it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s]                                              {'loss': 2.2637, 'grad_norm': 8.336742401123047, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.66it/s]                                               {'loss': 2.7978, 'grad_norm': 10.194262504577637, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.66it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.48it/s]                                               {'loss': 1.9565, 'grad_norm': 10.987237930297852, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.48it/s] 30%|███       | 12/40 [00:03<00:08,  3.34it/s]                                               {'loss': 1.7565, 'grad_norm': 6.543037414550781, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.34it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.1814, 'grad_norm': 5.607070446014404, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.4908, 'grad_norm': 5.603119850158691, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.15it/s]                                               {'loss': 2.2291, 'grad_norm': 7.069586277008057, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.15it/s]                                               {'loss': 0.136, 'grad_norm': 9.333823204040527, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.15it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.90it/s]                                               {'loss': 1.3293, 'grad_norm': 5.5238752365112305, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.90it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s]                                               {'loss': 0.6524, 'grad_norm': 4.829306125640869, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s]                                               {'loss': 0.6764, 'grad_norm': 5.434511661529541, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s] 50%|█████     | 20/40 [00:05<00:06,  3.31it/s]                                               {'loss': 0.7438, 'grad_norm': 6.166433334350586, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.6828, 'grad_norm': 5.202081203460693, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.9415, 'grad_norm': 6.242974281311035, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.616, 'grad_norm': 7.585958480834961, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.8946, 'grad_norm': 46.899681091308594, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.14it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.6294, 'grad_norm': 9.189494132995605, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s]                                               {'loss': 0.2379, 'grad_norm': 4.940898895263672, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.5365, 'grad_norm': 11.104942321777344, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s] 70%|███████   | 28/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.44, 'grad_norm': 1.128125548362732, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.32it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.1366, 'grad_norm': 1.7219802141189575, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.6263, 'grad_norm': 4.778069496154785, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.4585, 'grad_norm': 3.2902920246124268, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.0123, 'grad_norm': 0.6118316054344177, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s]                                               {'loss': 0.304, 'grad_norm': 4.315910816192627, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.6093, 'grad_norm': 10.83655834197998, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s]                                               {'loss': 0.2167, 'grad_norm': 4.112961769104004, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.1652, 'grad_norm': 57.55607604980469, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s]                                               {'loss': 0.3271, 'grad_norm': 7.012904644012451, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.5118, 'grad_norm': 2.8328044414520264, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0588, 'grad_norm': 1.8736488819122314, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0046, 'grad_norm': 0.22123362123966217, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 11.9873, 'train_samples_per_second': 47.133, 'train_steps_per_second': 3.337, 'train_loss': 1.4376939681358636, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]100%|██████████| 40/40 [00:11<00:00,  3.34it/s]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  3.00it/s]                                              {'loss': 7.0964, 'grad_norm': 5.575537204742432, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  3.00it/s]  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]                                              {'loss': 6.3218, 'grad_norm': 5.414759635925293, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]  8%|▊         | 3/40 [00:00<00:12,  3.08it/s]                                              {'loss': 4.8906, 'grad_norm': 6.49973726272583, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.08it/s] 10%|█         | 4/40 [00:01<00:11,  3.09it/s]                                              {'loss': 3.4041, 'grad_norm': 5.743747234344482, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.09it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.10it/s]                                              {'loss': 3.922, 'grad_norm': 6.950956344604492, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.10it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.09it/s]                                              {'loss': 2.7776, 'grad_norm': 6.592919826507568, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.09it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 3.6183, 'grad_norm': 12.258666038513184, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 4.501, 'grad_norm': 52.61318588256836, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.08it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s]                                              {'loss': 1.2931, 'grad_norm': 5.7842631340026855, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.61it/s]                                               {'loss': 1.5461, 'grad_norm': 7.149697303771973, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.61it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.45it/s]                                               {'loss': 1.9708, 'grad_norm': 6.9134955406188965, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.45it/s] 30%|███       | 12/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.644, 'grad_norm': 5.228350639343262, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.33it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.25it/s]                                               {'loss': 1.6491, 'grad_norm': 6.485443592071533, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.25it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.20it/s]                                               {'loss': 1.3441, 'grad_norm': 6.9998369216918945, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.20it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.15it/s]                                               {'loss': 1.0267, 'grad_norm': 5.317581653594971, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.15it/s]                                               {'loss': 0.0231, 'grad_norm': 0.7585190534591675, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.15it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.89it/s]                                               {'loss': 0.1591, 'grad_norm': 2.682460308074951, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.89it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.64it/s]                                               {'loss': 0.4186, 'grad_norm': 5.916352272033691, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.64it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s]                                               {'loss': 1.0043, 'grad_norm': 4.112496852874756, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s] 50%|█████     | 20/40 [00:05<00:05,  3.34it/s]                                               {'loss': 0.2787, 'grad_norm': 4.692220211029053, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.34it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s]                                               {'loss': 0.9044, 'grad_norm': 13.647984504699707, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.4787, 'grad_norm': 2.566859722137451, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.19it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.7443, 'grad_norm': 4.399918556213379, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.0126, 'grad_norm': 0.6219414472579956, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.16it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.90it/s]                                               {'loss': 0.6467, 'grad_norm': 5.154788970947266, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.90it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.67it/s]                                               {'loss': 0.1542, 'grad_norm': 2.028057813644409, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.67it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.49it/s]                                               {'loss': 0.0995, 'grad_norm': 1.8133563995361328, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.49it/s] 70%|███████   | 28/40 [00:08<00:03,  3.35it/s]                                               {'loss': 0.4805, 'grad_norm': 2.6437835693359375, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.35it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.3034, 'grad_norm': 3.29624605178833, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.26it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.2686, 'grad_norm': 3.5991406440734863, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.4007, 'grad_norm': 2.6765618324279785, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.311, 'grad_norm': 20.84981346130371, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s]                                               {'loss': 0.2988, 'grad_norm': 2.034080982208252, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.64it/s]                                               {'loss': 0.6369, 'grad_norm': 3.453434467315674, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.64it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s]                                               {'loss': 0.1064, 'grad_norm': 3.0667717456817627, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s]                                               {'loss': 0.0969, 'grad_norm': 1.7389874458312988, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.21it/s]                                               {'loss': 0.0918, 'grad_norm': 3.470689535140991, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.21it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.31, 'grad_norm': 2.5187923908233643, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0947, 'grad_norm': 2.8838274478912354, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.1536, 'grad_norm': 6.665184497833252, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 11.9987, 'train_samples_per_second': 47.088, 'train_steps_per_second': 3.334, 'train_loss': 1.3870828114915639, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]100%|██████████| 40/40 [00:11<00:00,  3.33it/s]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 6.4064, 'grad_norm': 6.739020347595215, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]                                              {'loss': 4.8453, 'grad_norm': 3.781388521194458, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]  8%|▊         | 3/40 [00:00<00:12,  3.01it/s]                                              {'loss': 5.3307, 'grad_norm': 4.98266077041626, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.01it/s] 10%|█         | 4/40 [00:01<00:12,  2.99it/s]                                              {'loss': 4.3634, 'grad_norm': 7.392507076263428, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.99it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.94it/s]                                              {'loss': 4.2026, 'grad_norm': 6.696399688720703, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.94it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.823, 'grad_norm': 11.532975196838379, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 2.2711, 'grad_norm': 8.99618911743164, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 0.0797, 'grad_norm': 3.600123405456543, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s]                                              {'loss': 1.3199, 'grad_norm': 7.188957691192627, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s]                                               {'loss': 2.5348, 'grad_norm': 9.232258796691895, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s]                                               {'loss': 1.5861, 'grad_norm': 8.751923561096191, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 1.5537, 'grad_norm': 6.601027011871338, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 1.3497, 'grad_norm': 8.54153060913086, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.5584, 'grad_norm': 5.52101993560791, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.9665, 'grad_norm': 5.182240009307861, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.1475, 'grad_norm': 4.260481834411621, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.06it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.67it/s]                                               {'loss': 0.1925, 'grad_norm': 2.5320379734039307, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.67it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s]                                               {'loss': 0.8715, 'grad_norm': 4.205458164215088, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.34it/s]                                               {'loss': 1.1632, 'grad_norm': 4.434707164764404, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.34it/s] 50%|█████     | 20/40 [00:06<00:06,  3.26it/s]                                               {'loss': 0.9204, 'grad_norm': 5.7619147300720215, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.26it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.5347, 'grad_norm': 4.748766899108887, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s]                                               {'loss': 0.2974, 'grad_norm': 3.8737711906433105, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.7299, 'grad_norm': 7.314978122711182, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.0236, 'grad_norm': 1.0684367418289185, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.65it/s]                                               {'loss': 0.2366, 'grad_norm': 4.390427112579346, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.65it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.46it/s]                                               {'loss': 0.2881, 'grad_norm': 2.876850128173828, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.46it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.34it/s]                                               {'loss': 0.4366, 'grad_norm': 3.583265781402588, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.34it/s] 70%|███████   | 28/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.2791, 'grad_norm': 4.39452600479126, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.24it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s]                                               {'loss': 0.7133, 'grad_norm': 3.6496479511260986, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.1302, 'grad_norm': 2.444579839706421, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.1331, 'grad_norm': 3.2614221572875977, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 1.4458, 'grad_norm': 18.581104278564453, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s]                                               {'loss': 0.1184, 'grad_norm': 3.0041377544403076, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s]                                               {'loss': 0.4649, 'grad_norm': 1.766762137413025, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s]                                               {'loss': 0.0672, 'grad_norm': 1.481773853302002, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.0659, 'grad_norm': 0.8842505216598511, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.1303, 'grad_norm': 2.1561851501464844, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.1298, 'grad_norm': 2.1959116458892822, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.1297, 'grad_norm': 1.7962095737457275, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0775, 'grad_norm': 2.343449354171753, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 12.1866, 'train_samples_per_second': 46.362, 'train_steps_per_second': 3.282, 'train_loss': 1.2729667508974671, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.12it/s]100%|██████████| 40/40 [00:12<00:00,  3.28it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 10.96it/s]  1%|          | 4/471 [00:00<01:07,  6.89it/s]  1%|          | 5/471 [00:00<01:12,  6.40it/s]  1%|▏         | 6/471 [00:00<01:16,  6.06it/s]  1%|▏         | 7/471 [00:01<01:19,  5.83it/s]  2%|▏         | 8/471 [00:01<01:21,  5.71it/s]  2%|▏         | 9/471 [00:01<01:22,  5.63it/s]  2%|▏         | 10/471 [00:01<01:22,  5.58it/s]  2%|▏         | 11/471 [00:01<01:23,  5.54it/s]  3%|▎         | 12/471 [00:02<01:23,  5.48it/s]  3%|▎         | 13/471 [00:02<01:23,  5.46it/s]  3%|▎         | 14/471 [00:02<01:24,  5.43it/s]  3%|▎         | 15/471 [00:02<01:23,  5.45it/s]  3%|▎         | 16/471 [00:02<01:23,  5.42it/s]  4%|▎         | 17/471 [00:02<01:23,  5.43it/s]  4%|▍         | 18/471 [00:03<01:23,  5.42it/s]  4%|▍         | 19/471 [00:03<01:23,  5.42it/s]  4%|▍         | 20/471 [00:03<01:23,  5.40it/s]  4%|▍         | 21/471 [00:03<01:23,  5.41it/s]  5%|▍         | 22/471 [00:03<01:23,  5.38it/s]  5%|▍         | 23/471 [00:04<01:22,  5.40it/s]  5%|▌         | 24/471 [00:04<01:22,  5.40it/s]  5%|▌         | 25/471 [00:04<01:22,  5.42it/s]  6%|▌         | 26/471 [00:04<01:22,  5.40it/s]  6%|▌         | 27/471 [00:04<01:22,  5.39it/s]  6%|▌         | 28/471 [00:04<01:21,  5.40it/s]  6%|▌         | 29/471 [00:05<01:21,  5.40it/s]  6%|▋         | 30/471 [00:05<01:21,  5.39it/s]  7%|▋         | 31/471 [00:05<01:21,  5.39it/s]  7%|▋         | 32/471 [00:05<01:21,  5.41it/s]  7%|▋         | 33/471 [00:05<01:20,  5.44it/s]  7%|▋         | 34/471 [00:06<01:20,  5.43it/s]  7%|▋         | 35/471 [00:06<01:20,  5.43it/s]  8%|▊         | 36/471 [00:06<01:20,  5.41it/s]  8%|▊         | 37/471 [00:06<01:20,  5.40it/s]  8%|▊         | 38/471 [00:06<01:20,  5.39it/s]  8%|▊         | 39/471 [00:07<01:20,  5.39it/s]  8%|▊         | 40/471 [00:07<01:19,  5.40it/s]  9%|▊         | 41/471 [00:07<01:19,  5.39it/s]  9%|▉         | 42/471 [00:07<01:19,  5.39it/s]  9%|▉         | 43/471 [00:07<01:19,  5.38it/s]  9%|▉         | 44/471 [00:07<01:19,  5.40it/s] 10%|▉         | 45/471 [00:08<01:19,  5.39it/s] 10%|▉         | 46/471 [00:08<01:18,  5.39it/s] 10%|▉         | 47/471 [00:08<01:18,  5.40it/s] 10%|█         | 48/471 [00:08<01:18,  5.41it/s] 10%|█         | 49/471 [00:08<01:18,  5.38it/s] 11%|█         | 50/471 [00:09<01:18,  5.37it/s] 11%|█         | 51/471 [00:09<01:18,  5.32it/s] 11%|█         | 52/471 [00:09<01:17,  5.37it/s] 11%|█▏        | 53/471 [00:09<01:17,  5.36it/s] 11%|█▏        | 54/471 [00:09<01:17,  5.36it/s] 12%|█▏        | 55/471 [00:09<01:17,  5.37it/s] 12%|█▏        | 56/471 [00:10<01:17,  5.34it/s] 12%|█▏        | 57/471 [00:10<01:17,  5.34it/s] 12%|█▏        | 58/471 [00:10<01:17,  5.32it/s] 13%|█▎        | 59/471 [00:10<01:17,  5.34it/s] 13%|█▎        | 60/471 [00:10<01:16,  5.36it/s] 13%|█▎        | 61/471 [00:11<01:16,  5.37it/s] 13%|█▎        | 62/471 [00:11<01:16,  5.37it/s] 13%|█▎        | 63/471 [00:11<01:16,  5.34it/s] 14%|█▎        | 64/471 [00:11<01:16,  5.34it/s] 14%|█▍        | 65/471 [00:11<01:15,  5.37it/s] 14%|█▍        | 66/471 [00:12<01:15,  5.37it/s] 14%|█▍        | 67/471 [00:12<01:15,  5.36it/s] 14%|█▍        | 68/471 [00:12<01:15,  5.36it/s] 15%|█▍        | 69/471 [00:12<01:15,  5.36it/s] 15%|█▍        | 70/471 [00:12<01:15,  5.35it/s] 15%|█▌        | 71/471 [00:12<01:14,  5.35it/s] 15%|█▌        | 72/471 [00:13<01:14,  5.34it/s] 15%|█▌        | 73/471 [00:13<01:14,  5.33it/s] 16%|█▌        | 74/471 [00:13<01:14,  5.36it/s] 16%|█▌        | 75/471 [00:13<01:13,  5.35it/s] 16%|█▌        | 76/471 [00:13<01:13,  5.36it/s] 16%|█▋        | 77/471 [00:14<01:13,  5.36it/s] 17%|█▋        | 78/471 [00:14<01:13,  5.35it/s] 17%|█▋        | 79/471 [00:14<01:13,  5.34it/s] 17%|█▋        | 80/471 [00:14<01:13,  5.33it/s] 17%|█▋        | 81/471 [00:14<01:13,  5.34it/s] 17%|█▋        | 82/471 [00:15<01:12,  5.36it/s] 18%|█▊        | 83/471 [00:15<01:12,  5.36it/s] 18%|█▊        | 84/471 [00:15<01:12,  5.36it/s] 18%|█▊        | 85/471 [00:15<01:12,  5.35it/s] 18%|█▊        | 86/471 [00:15<01:11,  5.35it/s] 18%|█▊        | 87/471 [00:15<01:11,  5.34it/s] 19%|█▊        | 88/471 [00:16<01:11,  5.35it/s] 19%|█▉        | 89/471 [00:16<01:11,  5.37it/s] 19%|█▉        | 90/471 [00:16<01:11,  5.36it/s] 19%|█▉        | 91/471 [00:16<01:10,  5.38it/s] 20%|█▉        | 92/471 [00:16<01:10,  5.37it/s] 20%|█▉        | 93/471 [00:17<01:10,  5.34it/s] 20%|█▉        | 94/471 [00:17<01:10,  5.35it/s] 20%|██        | 95/471 [00:17<01:10,  5.36it/s] 20%|██        | 96/471 [00:17<01:09,  5.36it/s] 21%|██        | 97/471 [00:17<01:09,  5.35it/s] 21%|██        | 98/471 [00:18<01:09,  5.33it/s] 21%|██        | 99/471 [00:18<01:09,  5.34it/s] 21%|██        | 100/471 [00:18<01:09,  5.36it/s] 21%|██▏       | 101/471 [00:18<01:08,  5.37it/s] 22%|██▏       | 102/471 [00:18<01:09,  5.35it/s] 22%|██▏       | 103/471 [00:18<01:08,  5.33it/s] 22%|██▏       | 104/471 [00:19<01:08,  5.34it/s] 22%|██▏       | 105/471 [00:19<01:08,  5.32it/s] 23%|██▎       | 106/471 [00:19<01:08,  5.34it/s] 23%|██▎       | 107/471 [00:19<01:07,  5.36it/s] 23%|██▎       | 108/471 [00:19<01:07,  5.35it/s] 23%|██▎       | 109/471 [00:20<01:07,  5.36it/s] 23%|██▎       | 110/471 [00:20<01:07,  5.37it/s] 24%|██▎       | 111/471 [00:20<01:07,  5.36it/s] 24%|██▍       | 112/471 [00:20<01:07,  5.35it/s] 24%|██▍       | 113/471 [00:20<01:06,  5.38it/s] 24%|██▍       | 114/471 [00:21<01:06,  5.36it/s] 24%|██▍       | 115/471 [00:21<01:06,  5.35it/s] 25%|██▍       | 116/471 [00:21<01:06,  5.34it/s] 25%|██▍       | 117/471 [00:21<01:06,  5.34it/s] 25%|██▌       | 118/471 [00:21<01:06,  5.32it/s] 25%|██▌       | 119/471 [00:21<01:06,  5.31it/s] 25%|██▌       | 120/471 [00:22<01:06,  5.32it/s] 26%|██▌       | 121/471 [00:22<01:05,  5.32it/s] 26%|██▌       | 122/471 [00:22<01:05,  5.33it/s] 26%|██▌       | 123/471 [00:22<01:05,  5.33it/s] 26%|██▋       | 124/471 [00:22<01:05,  5.31it/s] 27%|██▋       | 125/471 [00:23<01:05,  5.31it/s] 27%|██▋       | 126/471 [00:23<01:04,  5.33it/s] 27%|██▋       | 127/471 [00:23<01:04,  5.33it/s] 27%|██▋       | 128/471 [00:23<01:04,  5.33it/s] 27%|██▋       | 129/471 [00:23<01:04,  5.33it/s] 28%|██▊       | 130/471 [00:24<01:04,  5.33it/s] 28%|██▊       | 131/471 [00:24<01:03,  5.32it/s] 28%|██▊       | 132/471 [00:24<01:03,  5.32it/s] 28%|██▊       | 133/471 [00:24<01:03,  5.32it/s] 28%|██▊       | 134/471 [00:24<01:03,  5.31it/s] 29%|██▊       | 135/471 [00:24<01:03,  5.32it/s] 29%|██▉       | 136/471 [00:25<01:02,  5.33it/s] 29%|██▉       | 137/471 [00:25<01:02,  5.32it/s] 29%|██▉       | 138/471 [00:25<01:02,  5.31it/s] 30%|██▉       | 139/471 [00:25<01:02,  5.32it/s] 30%|██▉       | 140/471 [00:25<01:02,  5.33it/s] 30%|██▉       | 141/471 [00:26<01:01,  5.34it/s] 30%|███       | 142/471 [00:26<01:01,  5.32it/s] 30%|███       | 143/471 [00:26<01:01,  5.32it/s] 31%|███       | 144/471 [00:26<01:01,  5.31it/s] 31%|███       | 145/471 [00:26<01:01,  5.34it/s] 31%|███       | 146/471 [00:27<01:00,  5.33it/s] 31%|███       | 147/471 [00:27<01:00,  5.32it/s] 31%|███▏      | 148/471 [00:27<01:00,  5.32it/s] 32%|███▏      | 149/471 [00:27<01:00,  5.30it/s] 32%|███▏      | 150/471 [00:27<01:00,  5.31it/s] 32%|███▏      | 151/471 [00:27<01:00,  5.32it/s] 32%|███▏      | 152/471 [00:28<01:00,  5.31it/s] 32%|███▏      | 153/471 [00:28<01:00,  5.29it/s] 33%|███▎      | 154/471 [00:28<00:59,  5.32it/s] 33%|███▎      | 155/471 [00:28<00:59,  5.32it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.34it/s] 33%|███▎      | 157/471 [00:29<00:58,  5.33it/s] 34%|███▎      | 158/471 [00:29<00:58,  5.32it/s] 34%|███▍      | 159/471 [00:29<00:58,  5.32it/s] 34%|███▍      | 160/471 [00:29<00:58,  5.31it/s] 34%|███▍      | 161/471 [00:29<00:58,  5.32it/s] 34%|███▍      | 162/471 [00:30<00:58,  5.31it/s] 35%|███▍      | 163/471 [00:30<00:58,  5.29it/s] 35%|███▍      | 164/471 [00:30<00:57,  5.30it/s] 35%|███▌      | 165/471 [00:30<00:57,  5.30it/s] 35%|███▌      | 166/471 [00:30<00:57,  5.30it/s] 35%|███▌      | 167/471 [00:30<00:57,  5.31it/s] 36%|███▌      | 168/471 [00:31<00:57,  5.31it/s] 36%|███▌      | 169/471 [00:31<00:56,  5.30it/s] 36%|███▌      | 170/471 [00:31<00:56,  5.31it/s] 36%|███▋      | 171/471 [00:31<00:56,  5.30it/s] 37%|███▋      | 172/471 [00:31<00:56,  5.31it/s] 37%|███▋      | 173/471 [00:32<00:56,  5.30it/s] 37%|███▋      | 174/471 [00:32<00:55,  5.31it/s] 37%|███▋      | 175/471 [00:32<00:55,  5.30it/s] 37%|███▋      | 176/471 [00:32<00:55,  5.30it/s] 38%|███▊      | 177/471 [00:32<00:55,  5.29it/s] 38%|███▊      | 178/471 [00:33<00:55,  5.30it/s] 38%|███▊      | 179/471 [00:33<00:54,  5.31it/s] 38%|███▊      | 180/471 [00:33<00:54,  5.31it/s] 38%|███▊      | 181/471 [00:33<00:54,  5.31it/s] 39%|███▊      | 182/471 [00:33<00:54,  5.31it/s] 39%|███▉      | 183/471 [00:34<00:54,  5.30it/s] 39%|███▉      | 184/471 [00:34<00:53,  5.32it/s] 39%|███▉      | 185/471 [00:34<00:53,  5.31it/s] 39%|███▉      | 186/471 [00:34<00:53,  5.31it/s] 40%|███▉      | 187/471 [00:34<00:53,  5.29it/s] 40%|███▉      | 188/471 [00:34<00:53,  5.29it/s] 40%|████      | 189/471 [00:35<00:53,  5.30it/s] 40%|████      | 190/471 [00:35<00:53,  5.30it/s] 41%|████      | 191/471 [00:35<00:52,  5.29it/s] 41%|████      | 192/471 [00:35<00:52,  5.29it/s] 41%|████      | 193/471 [00:35<00:52,  5.32it/s] 41%|████      | 194/471 [00:36<00:52,  5.31it/s] 41%|████▏     | 195/471 [00:36<00:52,  5.30it/s] 42%|████▏     | 196/471 [00:36<00:51,  5.29it/s] 42%|████▏     | 197/471 [00:36<00:51,  5.33it/s] 42%|████▏     | 198/471 [00:36<00:51,  5.32it/s] 42%|████▏     | 199/471 [00:37<00:51,  5.30it/s] 42%|████▏     | 200/471 [00:37<00:51,  5.30it/s] 43%|████▎     | 201/471 [00:37<00:50,  5.31it/s] 43%|████▎     | 202/471 [00:37<00:50,  5.31it/s] 43%|████▎     | 203/471 [00:37<00:50,  5.29it/s] 43%|████▎     | 204/471 [00:37<00:50,  5.28it/s] 44%|████▎     | 205/471 [00:38<00:50,  5.29it/s] 44%|████▎     | 206/471 [00:38<00:49,  5.31it/s] 44%|████▍     | 207/471 [00:38<00:49,  5.30it/s] 44%|████▍     | 208/471 [00:38<00:49,  5.32it/s] 44%|████▍     | 209/471 [00:38<00:49,  5.33it/s] 45%|████▍     | 210/471 [00:39<00:48,  5.34it/s] 45%|████▍     | 211/471 [00:39<00:48,  5.33it/s] 45%|████▌     | 212/471 [00:39<00:48,  5.32it/s] 45%|████▌     | 213/471 [00:39<00:48,  5.30it/s] 45%|████▌     | 214/471 [00:39<00:48,  5.30it/s] 46%|████▌     | 215/471 [00:40<00:48,  5.30it/s] 46%|████▌     | 216/471 [00:40<00:48,  5.30it/s] 46%|████▌     | 217/471 [00:40<00:48,  5.29it/s] 46%|████▋     | 218/471 [00:40<00:47,  5.28it/s] 46%|████▋     | 219/471 [00:40<00:47,  5.28it/s] 47%|████▋     | 220/471 [00:40<00:47,  5.28it/s] 47%|████▋     | 221/471 [00:41<00:47,  5.28it/s] 47%|████▋     | 222/471 [00:41<00:47,  5.29it/s] 47%|████▋     | 223/471 [00:41<00:46,  5.30it/s] 48%|████▊     | 224/471 [00:41<00:46,  5.29it/s] 48%|████▊     | 225/471 [00:41<00:46,  5.28it/s] 48%|████▊     | 226/471 [00:42<00:46,  5.27it/s] 48%|████▊     | 227/471 [00:42<00:46,  5.26it/s] 48%|████▊     | 228/471 [00:42<00:46,  5.26it/s] 49%|████▊     | 229/471 [00:42<00:46,  5.26it/s] 49%|████▉     | 230/471 [00:42<00:45,  5.26it/s] 49%|████▉     | 231/471 [00:43<00:45,  5.26it/s] 49%|████▉     | 232/471 [00:43<00:45,  5.29it/s] 49%|████▉     | 233/471 [00:43<00:45,  5.28it/s] 50%|████▉     | 234/471 [00:43<00:44,  5.27it/s] 50%|████▉     | 235/471 [00:43<00:44,  5.26it/s] 50%|█████     | 236/471 [00:44<00:44,  5.27it/s] 50%|█████     | 237/471 [00:44<00:44,  5.28it/s] 51%|█████     | 238/471 [00:44<00:44,  5.27it/s] 51%|█████     | 239/471 [00:44<00:43,  5.28it/s] 51%|█████     | 240/471 [00:44<00:43,  5.27it/s] 51%|█████     | 241/471 [00:44<00:43,  5.26it/s] 51%|█████▏    | 242/471 [00:45<00:43,  5.26it/s] 52%|█████▏    | 243/471 [00:45<00:43,  5.27it/s] 52%|█████▏    | 244/471 [00:45<00:43,  5.28it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.28it/s] 52%|█████▏    | 246/471 [00:45<00:42,  5.28it/s] 52%|█████▏    | 247/471 [00:46<00:42,  5.31it/s] 53%|█████▎    | 248/471 [00:46<00:42,  5.30it/s] 53%|█████▎    | 249/471 [00:46<00:42,  5.28it/s] 53%|█████▎    | 250/471 [00:46<00:41,  5.29it/s] 53%|█████▎    | 251/471 [00:46<00:41,  5.29it/s] 54%|█████▎    | 252/471 [00:47<00:41,  5.29it/s] 54%|█████▎    | 253/471 [00:47<00:41,  5.27it/s] 54%|█████▍    | 254/471 [00:47<00:41,  5.27it/s] 54%|█████▍    | 255/471 [00:47<00:41,  5.26it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.27it/s] 55%|█████▍    | 257/471 [00:47<00:40,  5.27it/s] 55%|█████▍    | 258/471 [00:48<00:40,  5.27it/s] 55%|█████▍    | 259/471 [00:48<00:40,  5.26it/s] 55%|█████▌    | 260/471 [00:48<00:40,  5.24it/s] 55%|█████▌    | 261/471 [00:48<00:39,  5.26it/s] 56%|█████▌    | 262/471 [00:48<00:39,  5.28it/s] 56%|█████▌    | 263/471 [00:49<00:39,  5.28it/s] 56%|█████▌    | 264/471 [00:49<00:39,  5.27it/s] 56%|█████▋    | 265/471 [00:49<00:39,  5.26it/s] 56%|█████▋    | 266/471 [00:49<00:39,  5.25it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.26it/s] 57%|█████▋    | 268/471 [00:50<00:38,  5.25it/s] 57%|█████▋    | 269/471 [00:50<00:38,  5.27it/s] 57%|█████▋    | 270/471 [00:50<00:38,  5.27it/s] 58%|█████▊    | 271/471 [00:50<00:37,  5.27it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.28it/s] 58%|█████▊    | 273/471 [00:51<00:37,  5.28it/s] 58%|█████▊    | 274/471 [00:51<00:37,  5.31it/s] 58%|█████▊    | 275/471 [00:51<00:36,  5.33it/s] 59%|█████▊    | 276/471 [00:51<00:36,  5.29it/s] 59%|█████▉    | 277/471 [00:51<00:36,  5.28it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.26it/s] 59%|█████▉    | 279/471 [00:52<00:36,  5.26it/s] 59%|█████▉    | 280/471 [00:52<00:36,  5.28it/s] 60%|█████▉    | 281/471 [00:52<00:35,  5.28it/s] 60%|█████▉    | 282/471 [00:52<00:35,  5.27it/s] 60%|██████    | 283/471 [00:52<00:35,  5.26it/s] 60%|██████    | 284/471 [00:53<00:35,  5.27it/s] 61%|██████    | 285/471 [00:53<00:35,  5.26it/s] 61%|██████    | 286/471 [00:53<00:35,  5.27it/s] 61%|██████    | 287/471 [00:53<00:34,  5.26it/s] 61%|██████    | 288/471 [00:53<00:34,  5.26it/s] 61%|██████▏   | 289/471 [00:54<00:34,  5.29it/s] 62%|██████▏   | 290/471 [00:54<00:34,  5.28it/s] 62%|██████▏   | 291/471 [00:54<00:34,  5.27it/s] 62%|██████▏   | 292/471 [00:54<00:33,  5.27it/s] 62%|██████▏   | 293/471 [00:54<00:33,  5.29it/s] 62%|██████▏   | 294/471 [00:55<00:33,  5.30it/s] 63%|██████▎   | 295/471 [00:55<00:33,  5.31it/s] 63%|██████▎   | 296/471 [00:55<00:32,  5.32it/s] 63%|██████▎   | 297/471 [00:55<00:32,  5.30it/s] 63%|██████▎   | 298/471 [00:55<00:32,  5.28it/s] 63%|██████▎   | 299/471 [00:55<00:32,  5.29it/s] 64%|██████▎   | 300/471 [00:56<00:32,  5.29it/s] 64%|██████▍   | 301/471 [00:56<00:32,  5.29it/s] 64%|██████▍   | 302/471 [00:56<00:32,  5.28it/s] 64%|██████▍   | 303/471 [00:56<00:31,  5.28it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.28it/s] 65%|██████▍   | 305/471 [00:57<00:31,  5.28it/s] 65%|██████▍   | 306/471 [00:57<00:31,  5.28it/s] 65%|██████▌   | 307/471 [00:57<00:31,  5.27it/s] 65%|██████▌   | 308/471 [00:57<00:30,  5.26it/s] 66%|██████▌   | 309/471 [00:57<00:30,  5.26it/s] 66%|██████▌   | 310/471 [00:58<00:30,  5.27it/s] 66%|██████▌   | 311/471 [00:58<00:30,  5.27it/s] 66%|██████▌   | 312/471 [00:58<00:30,  5.28it/s] 66%|██████▋   | 313/471 [00:58<00:29,  5.29it/s] 67%|██████▋   | 314/471 [00:58<00:29,  5.29it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.30it/s] 67%|██████▋   | 316/471 [00:59<00:29,  5.30it/s] 67%|██████▋   | 317/471 [00:59<00:29,  5.29it/s] 68%|██████▊   | 318/471 [00:59<00:28,  5.28it/s] 68%|██████▊   | 319/471 [00:59<00:28,  5.27it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.28it/s] 68%|██████▊   | 321/471 [01:00<00:28,  5.28it/s] 68%|██████▊   | 322/471 [01:00<00:28,  5.28it/s] 69%|██████▊   | 323/471 [01:00<00:28,  5.25it/s] 69%|██████▉   | 324/471 [01:00<00:27,  5.25it/s] 69%|██████▉   | 325/471 [01:00<00:27,  5.26it/s] 69%|██████▉   | 326/471 [01:01<00:27,  5.28it/s] 69%|██████▉   | 327/471 [01:01<00:27,  5.29it/s] 70%|██████▉   | 328/471 [01:01<00:27,  5.27it/s] 70%|██████▉   | 329/471 [01:01<00:27,  5.25it/s] 70%|███████   | 330/471 [01:01<00:26,  5.28it/s] 70%|███████   | 331/471 [01:02<00:26,  5.28it/s] 70%|███████   | 332/471 [01:02<00:26,  5.27it/s] 71%|███████   | 333/471 [01:02<00:26,  5.27it/s] 71%|███████   | 334/471 [01:02<00:26,  5.26it/s] 71%|███████   | 335/471 [01:02<00:25,  5.26it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.28it/s] 72%|███████▏  | 337/471 [01:03<00:25,  5.30it/s] 72%|███████▏  | 338/471 [01:03<00:25,  5.30it/s] 72%|███████▏  | 339/471 [01:03<00:24,  5.28it/s] 72%|███████▏  | 340/471 [01:03<00:24,  5.28it/s] 72%|███████▏  | 341/471 [01:03<00:24,  5.29it/s] 73%|███████▎  | 342/471 [01:04<00:24,  5.29it/s] 73%|███████▎  | 343/471 [01:04<00:24,  5.28it/s] 73%|███████▎  | 344/471 [01:04<00:23,  5.29it/s] 73%|███████▎  | 345/471 [01:04<00:23,  5.28it/s] 73%|███████▎  | 346/471 [01:04<00:23,  5.28it/s] 74%|███████▎  | 347/471 [01:05<00:23,  5.29it/s] 74%|███████▍  | 348/471 [01:05<00:23,  5.29it/s] 74%|███████▍  | 349/471 [01:05<00:23,  5.28it/s] 74%|███████▍  | 350/471 [01:05<00:22,  5.28it/s] 75%|███████▍  | 351/471 [01:05<00:22,  5.30it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.28it/s] 75%|███████▍  | 353/471 [01:06<00:22,  5.27it/s] 75%|███████▌  | 354/471 [01:06<00:22,  5.28it/s] 75%|███████▌  | 355/471 [01:06<00:21,  5.27it/s] 76%|███████▌  | 356/471 [01:06<00:21,  5.27it/s] 76%|███████▌  | 357/471 [01:06<00:21,  5.27it/s] 76%|███████▌  | 358/471 [01:07<00:21,  5.28it/s] 76%|███████▌  | 359/471 [01:07<00:21,  5.27it/s] 76%|███████▋  | 360/471 [01:07<00:21,  5.27it/s] 77%|███████▋  | 361/471 [01:07<00:20,  5.27it/s] 77%|███████▋  | 362/471 [01:07<00:20,  5.29it/s] 77%|███████▋  | 363/471 [01:08<00:20,  5.28it/s] 77%|███████▋  | 364/471 [01:08<00:20,  5.29it/s] 77%|███████▋  | 365/471 [01:08<00:20,  5.27it/s] 78%|███████▊  | 366/471 [01:08<00:19,  5.26it/s] 78%|███████▊  | 367/471 [01:08<00:19,  5.26it/s] 78%|███████▊  | 368/471 [01:09<00:19,  5.26it/s] 78%|███████▊  | 369/471 [01:09<00:19,  5.28it/s] 79%|███████▊  | 370/471 [01:09<00:19,  5.27it/s] 79%|███████▉  | 371/471 [01:09<00:19,  5.26it/s] 79%|███████▉  | 372/471 [01:09<00:18,  5.26it/s] 79%|███████▉  | 373/471 [01:09<00:18,  5.25it/s] 79%|███████▉  | 374/471 [01:10<00:18,  5.27it/s] 80%|███████▉  | 375/471 [01:10<00:18,  5.27it/s] 80%|███████▉  | 376/471 [01:10<00:18,  5.27it/s] 80%|████████  | 377/471 [01:10<00:17,  5.29it/s] 80%|████████  | 378/471 [01:10<00:17,  5.31it/s] 80%|████████  | 379/471 [01:11<00:17,  5.30it/s] 81%|████████  | 380/471 [01:11<00:17,  5.28it/s] 81%|████████  | 381/471 [01:11<00:17,  5.28it/s] 81%|████████  | 382/471 [01:11<00:16,  5.29it/s] 81%|████████▏ | 383/471 [01:11<00:16,  5.28it/s] 82%|████████▏ | 384/471 [01:12<00:16,  5.27it/s] 82%|████████▏ | 385/471 [01:12<00:16,  5.27it/s] 82%|████████▏ | 386/471 [01:12<00:16,  5.27it/s] 82%|████████▏ | 387/471 [01:12<00:15,  5.27it/s] 82%|████████▏ | 388/471 [01:12<00:15,  5.27it/s] 83%|████████▎ | 389/471 [01:13<00:15,  5.28it/s] 83%|████████▎ | 390/471 [01:13<00:15,  5.28it/s] 83%|████████▎ | 391/471 [01:13<00:15,  5.28it/s] 83%|████████▎ | 392/471 [01:13<00:14,  5.29it/s] 83%|████████▎ | 393/471 [01:13<00:14,  5.29it/s] 84%|████████▎ | 394/471 [01:13<00:14,  5.27it/s] 84%|████████▍ | 395/471 [01:14<00:14,  5.27it/s] 84%|████████▍ | 396/471 [01:14<00:14,  5.28it/s] 84%|████████▍ | 397/471 [01:14<00:14,  5.28it/s] 85%|████████▍ | 398/471 [01:14<00:13,  5.28it/s] 85%|████████▍ | 399/471 [01:14<00:13,  5.25it/s] 85%|████████▍ | 400/471 [01:15<00:13,  5.25it/s] 85%|████████▌ | 401/471 [01:15<00:13,  5.26it/s] 85%|████████▌ | 402/471 [01:15<00:13,  5.27it/s] 86%|████████▌ | 403/471 [01:15<00:12,  5.27it/s] 86%|████████▌ | 404/471 [01:15<00:12,  5.28it/s] 86%|████████▌ | 405/471 [01:16<00:12,  5.27it/s] 86%|████████▌ | 406/471 [01:16<00:12,  5.29it/s] 86%|████████▋ | 407/471 [01:16<00:12,  5.29it/s] 87%|████████▋ | 408/471 [01:16<00:11,  5.30it/s] 87%|████████▋ | 409/471 [01:16<00:11,  5.30it/s] 87%|████████▋ | 410/471 [01:16<00:11,  5.31it/s] 87%|████████▋ | 411/471 [01:17<00:11,  5.30it/s] 87%|████████▋ | 412/471 [01:17<00:11,  5.28it/s] 88%|████████▊ | 413/471 [01:17<00:10,  5.29it/s] 88%|████████▊ | 414/471 [01:17<00:10,  5.29it/s] 88%|████████▊ | 415/471 [01:17<00:10,  5.30it/s] 88%|████████▊ | 416/471 [01:18<00:10,  5.29it/s] 89%|████████▊ | 417/471 [01:18<00:10,  5.30it/s] 89%|████████▊ | 418/471 [01:18<00:10,  5.28it/s] 89%|████████▉ | 419/471 [01:18<00:09,  5.30it/s] 89%|████████▉ | 420/471 [01:18<00:09,  5.32it/s] 89%|████████▉ | 421/471 [01:19<00:09,  5.31it/s] 90%|████████▉ | 422/471 [01:19<00:09,  5.31it/s] 90%|████████▉ | 423/471 [01:19<00:09,  5.31it/s] 90%|█████████ | 424/471 [01:19<00:08,  5.31it/s] 90%|█████████ | 425/471 [01:19<00:08,  5.32it/s] 90%|█████████ | 426/471 [01:20<00:08,  5.29it/s] 91%|█████████ | 427/471 [01:20<00:08,  5.29it/s] 91%|█████████ | 428/471 [01:20<00:08,  5.28it/s] 91%|█████████ | 429/471 [01:20<00:07,  5.28it/s] 91%|█████████▏| 430/471 [01:20<00:07,  5.27it/s] 92%|█████████▏| 431/471 [01:20<00:07,  5.26it/s] 92%|█████████▏| 432/471 [01:21<00:07,  5.27it/s] 92%|█████████▏| 433/471 [01:21<00:07,  5.28it/s] 92%|█████████▏| 434/471 [01:21<00:07,  5.28it/s] 92%|█████████▏| 435/471 [01:21<00:06,  5.27it/s] 93%|█████████▎| 436/471 [01:21<00:06,  5.28it/s] 93%|█████████▎| 437/471 [01:22<00:06,  5.29it/s] 93%|█████████▎| 438/471 [01:22<00:06,  5.29it/s] 93%|█████████▎| 439/471 [01:22<00:06,  5.29it/s] 93%|█████████▎| 440/471 [01:22<00:05,  5.30it/s] 94%|█████████▎| 441/471 [01:22<00:05,  5.29it/s] 94%|█████████▍| 442/471 [01:23<00:05,  5.30it/s] 94%|█████████▍| 443/471 [01:23<00:05,  5.29it/s] 94%|█████████▍| 444/471 [01:23<00:05,  5.29it/s] 94%|█████████▍| 445/471 [01:23<00:04,  5.27it/s] 95%|█████████▍| 446/471 [01:23<00:04,  5.28it/s] 95%|█████████▍| 447/471 [01:23<00:04,  5.28it/s] 95%|█████████▌| 448/471 [01:24<00:04,  5.30it/s] 95%|█████████▌| 449/471 [01:24<00:04,  5.30it/s] 96%|█████████▌| 450/471 [01:24<00:03,  5.28it/s] 96%|█████████▌| 451/471 [01:24<00:03,  5.28it/s] 96%|█████████▌| 452/471 [01:24<00:03,  5.29it/s] 96%|█████████▌| 453/471 [01:25<00:03,  5.28it/s] 96%|█████████▋| 454/471 [01:25<00:03,  5.28it/s] 97%|█████████▋| 455/471 [01:25<00:03,  5.27it/s] 97%|█████████▋| 456/471 [01:25<00:02,  5.29it/s] 97%|█████████▋| 457/471 [01:25<00:02,  5.26it/s] 97%|█████████▋| 458/471 [01:26<00:02,  5.29it/s] 97%|█████████▋| 459/471 [01:26<00:02,  5.31it/s] 98%|█████████▊| 460/471 [01:26<00:02,  5.30it/s] 98%|█████████▊| 461/471 [01:26<00:01,  5.30it/s] 98%|█████████▊| 462/471 [01:26<00:01,  5.29it/s] 98%|█████████▊| 463/471 [01:27<00:01,  5.30it/s] 99%|█████████▊| 464/471 [01:27<00:01,  5.30it/s] 99%|█████████▊| 465/471 [01:27<00:01,  5.30it/s] 99%|█████████▉| 466/471 [01:27<00:00,  5.29it/s] 99%|█████████▉| 467/471 [01:27<00:00,  5.28it/s] 99%|█████████▉| 468/471 [01:27<00:00,  5.27it/s]100%|█████████▉| 469/471 [01:28<00:00,  5.28it/s]100%|█████████▉| 470/471 [01:28<00:00,  5.30it/s]100%|██████████| 471/471 [01:28<00:00,  5.67it/s]100%|██████████| 471/471 [01:28<00:00,  5.32it/s]
{'eval_loss': 5.450651168823242, 'eval_model_preparation_time': 0.0053, 'eval_acc': 0.1537440254912374, 'eval_runtime': 88.6485, 'eval_samples_per_second': 84.965, 'eval_steps_per_second': 5.313}
ROUND:2
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.95it/s]                                              {'loss': 4.4204, 'grad_norm': 3.994739055633545, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.95it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 5.0949, 'grad_norm': 6.040667533874512, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:12,  3.03it/s]                                              {'loss': 6.7476, 'grad_norm': 7.190357208251953, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.03it/s] 10%|█         | 4/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.5379, 'grad_norm': 6.033320426940918, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.00it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 3.4008, 'grad_norm': 7.6264801025390625, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.98it/s]                                              {'loss': 2.8626, 'grad_norm': 6.672691345214844, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.98it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 3.0372, 'grad_norm': 14.264556884765625, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 5.8973, 'grad_norm': 42.20224380493164, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.78it/s]                                              {'loss': 1.1529, 'grad_norm': 5.781254768371582, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.78it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.59it/s]                                               {'loss': 1.8467, 'grad_norm': 8.136603355407715, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.59it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s]                                               {'loss': 1.7543, 'grad_norm': 5.4343953132629395, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 0.9841, 'grad_norm': 4.11217737197876, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 1.5126, 'grad_norm': 8.666231155395508, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.0745, 'grad_norm': 7.008850574493408, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.9935, 'grad_norm': 5.236375331878662, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.6552, 'grad_norm': 27.523099899291992, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.06it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.77it/s]                                               {'loss': 0.8242, 'grad_norm': 6.6799774169921875, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.77it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s]                                               {'loss': 0.5513, 'grad_norm': 4.410442352294922, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.35it/s]                                               {'loss': 0.8276, 'grad_norm': 6.156783103942871, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.35it/s] 50%|█████     | 20/40 [00:06<00:06,  3.23it/s]                                               {'loss': 0.4211, 'grad_norm': 2.952824592590332, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.23it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.9781, 'grad_norm': 10.194671630859375, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s]                                               {'loss': 0.2623, 'grad_norm': 4.735936164855957, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.06it/s]                                               {'loss': 0.6623, 'grad_norm': 5.226301670074463, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.06it/s]                                               {'loss': 0.1171, 'grad_norm': 3.564032554626465, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.06it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.76it/s]                                               {'loss': 0.268, 'grad_norm': 2.972332239151001, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.76it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.53it/s]                                               {'loss': 0.6667, 'grad_norm': 4.755489826202393, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.53it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.35it/s]                                               {'loss': 0.2806, 'grad_norm': 5.256053447723389, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.35it/s] 70%|███████   | 28/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.1271, 'grad_norm': 4.598697185516357, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.25it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.16it/s]                                               {'loss': 0.278, 'grad_norm': 4.384829044342041, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.16it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.08it/s]                                               {'loss': 0.1857, 'grad_norm': 2.261974334716797, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.08it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.04it/s]                                               {'loss': 0.1384, 'grad_norm': 2.566131114959717, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.04it/s]                                               {'loss': 0.0065, 'grad_norm': 0.3675917983055115, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.04it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.72it/s]                                               {'loss': 0.1954, 'grad_norm': 7.15881872177124, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.72it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.48it/s]                                               {'loss': 0.0611, 'grad_norm': 1.6583415269851685, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.48it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.0958, 'grad_norm': 2.2070653438568115, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.32it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.23it/s]                                               {'loss': 0.4757, 'grad_norm': 1.235926628112793, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.23it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0596, 'grad_norm': 1.151546597480774, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.0797, 'grad_norm': 2.1911749839782715, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.03it/s]                                               {'loss': 0.0863, 'grad_norm': 1.4197471141815186, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.03it/s]                                               {'loss': 0.0561, 'grad_norm': 3.7778866291046143, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.03it/s]                                               {'train_runtime': 12.3763, 'train_samples_per_second': 45.652, 'train_steps_per_second': 3.232, 'train_loss': 1.3169242291594856, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.03it/s]100%|██████████| 40/40 [00:12<00:00,  3.23it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.15it/s]                                              {'loss': 4.7194, 'grad_norm': 4.034747123718262, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.15it/s]  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]                                              {'loss': 3.4601, 'grad_norm': 4.727884769439697, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]  8%|▊         | 3/40 [00:00<00:12,  3.00it/s]                                              {'loss': 5.0513, 'grad_norm': 5.664678573608398, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.00it/s] 10%|█         | 4/40 [00:01<00:12,  2.98it/s]                                              {'loss': 3.2141, 'grad_norm': 4.887657642364502, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.98it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 4.6925, 'grad_norm': 7.763528347015381, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.97it/s]                                              {'loss': 2.4885, 'grad_norm': 8.128106117248535, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.97it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.92it/s]                                              {'loss': 2.1217, 'grad_norm': 7.639050483703613, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.92it/s]                                              {'loss': 3.8591, 'grad_norm': 77.6112289428711, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.92it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.54it/s]                                              {'loss': 1.2986, 'grad_norm': 5.9966301918029785, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.54it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.38it/s]                                               {'loss': 3.2559, 'grad_norm': 13.075420379638672, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.38it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.4329, 'grad_norm': 10.881616592407227, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.24it/s] 30%|███       | 12/40 [00:03<00:08,  3.15it/s]                                               {'loss': 1.1695, 'grad_norm': 6.447094917297363, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.15it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.09it/s]                                               {'loss': 0.8273, 'grad_norm': 5.386470794677734, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.09it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.07it/s]                                               {'loss': 1.2664, 'grad_norm': 6.402627944946289, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.07it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.05it/s]                                               {'loss': 1.4708, 'grad_norm': 10.266805648803711, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.05it/s]                                               {'loss': 0.6164, 'grad_norm': 16.940061569213867, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.05it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s]                                               {'loss': 0.6546, 'grad_norm': 3.7179765701293945, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s]                                               {'loss': 0.4435, 'grad_norm': 2.9611237049102783, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s]                                               {'loss': 0.4978, 'grad_norm': 4.686678409576416, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s] 50%|█████     | 20/40 [00:06<00:06,  3.25it/s]                                               {'loss': 0.6011, 'grad_norm': 5.062243938446045, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.25it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s]                                               {'loss': 0.539, 'grad_norm': 3.5566680431365967, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.7042, 'grad_norm': 4.4893975257873535, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 0.6754, 'grad_norm': 3.6930222511291504, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 2.7168, 'grad_norm': 19.667098999023438, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.08it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.76it/s]                                               {'loss': 0.4246, 'grad_norm': 3.501725673675537, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.76it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.53it/s]                                               {'loss': 0.5914, 'grad_norm': 3.8092002868652344, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.53it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s]                                               {'loss': 0.2399, 'grad_norm': 1.899266004562378, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s] 70%|███████   | 28/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.3903, 'grad_norm': 1.8041630983352661, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.26it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s]                                               {'loss': 0.1478, 'grad_norm': 2.136698007583618, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.2503, 'grad_norm': 5.018798828125, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.0539, 'grad_norm': 2.2838499546051025, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.1586, 'grad_norm': 5.328845024108887, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:10<00:01,  3.72it/s]                                               {'loss': 0.2728, 'grad_norm': 3.7104744911193848, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:10<00:01,  3.72it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.48it/s]                                               {'loss': 0.0867, 'grad_norm': 2.5788395404815674, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.48it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.33it/s]                                               {'loss': 0.02, 'grad_norm': 0.3639147877693176, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.33it/s] 90%|█████████ | 36/40 [00:11<00:01,  3.22it/s]                                               {'loss': 0.1164, 'grad_norm': 1.3693488836288452, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:11<00:01,  3.22it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.3236, 'grad_norm': 3.0728652477264404, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.15it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.0461, 'grad_norm': 1.254311442375183, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s] 98%|█████████▊| 39/40 [00:12<00:00,  3.07it/s]                                               {'loss': 0.2049, 'grad_norm': 1.4950469732284546, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:12<00:00,  3.07it/s]                                               {'loss': 0.0423, 'grad_norm': 2.095557689666748, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]                                               {'train_runtime': 12.3362, 'train_samples_per_second': 45.8, 'train_steps_per_second': 3.242, 'train_loss': 1.2786543615162373, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]100%|██████████| 40/40 [00:12<00:00,  3.24it/s]
CLIENT:46
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]                                              {'loss': 6.3108, 'grad_norm': 4.6067070960998535, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 3.4089, 'grad_norm': 5.324038028717041, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 4.4224, 'grad_norm': 6.845426082611084, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.03it/s]                                              {'loss': 2.8535, 'grad_norm': 5.981018543243408, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.03it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 4.2216, 'grad_norm': 9.89230728149414, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.2051, 'grad_norm': 12.299300193786621, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 1.3053, 'grad_norm': 8.313817977905273, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 1.0423, 'grad_norm': 39.65858840942383, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s]                                              {'loss': 1.5171, 'grad_norm': 10.191296577453613, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s]                                               {'loss': 1.2642, 'grad_norm': 9.572559356689453, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 1.761, 'grad_norm': 8.94784927368164, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.25it/s]                                               {'loss': 2.1051, 'grad_norm': 10.094330787658691, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.25it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.1528, 'grad_norm': 5.301791191101074, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.6335, 'grad_norm': 6.192173004150391, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.9494, 'grad_norm': 7.95608377456665, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 2.3357, 'grad_norm': 22.76769256591797, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.80it/s]                                               {'loss': 0.8347, 'grad_norm': 3.5771732330322266, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.80it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.55it/s]                                               {'loss': 0.6115, 'grad_norm': 3.982663154602051, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.55it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 1.1547, 'grad_norm': 3.6445019245147705, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 0.3856, 'grad_norm': 9.139260292053223, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.9353, 'grad_norm': 5.221047878265381, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.633, 'grad_norm': 20.288867950439453, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.6354, 'grad_norm': 15.533136367797852, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.0378, 'grad_norm': 1.925645351409912, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s]                                               {'loss': 0.2899, 'grad_norm': 2.250166654586792, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.6129, 'grad_norm': 5.571014404296875, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s]                                               {'loss': 0.9761, 'grad_norm': 6.780351161956787, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.2648, 'grad_norm': 4.642502784729004, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.5159, 'grad_norm': 3.0986361503601074, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.07it/s]                                               {'loss': 0.1671, 'grad_norm': 2.520071029663086, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.07it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.04it/s]                                               {'loss': 0.1705, 'grad_norm': 2.7931175231933594, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.04it/s]                                               {'loss': 0.0158, 'grad_norm': 0.6674937009811401, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.04it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.55it/s]                                               {'loss': 0.2706, 'grad_norm': 2.026247024536133, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.55it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.37it/s]                                               {'loss': 0.189, 'grad_norm': 3.460573434829712, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.37it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.25it/s]                                               {'loss': 0.2356, 'grad_norm': 4.811942100524902, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.25it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.16it/s]                                               {'loss': 0.7458, 'grad_norm': 2.6599364280700684, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.16it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.1126, 'grad_norm': 2.580763101577759, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.10it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.4561, 'grad_norm': 3.07698917388916, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s] 98%|█████████▊| 39/40 [00:12<00:00,  2.98it/s]                                               {'loss': 0.0262, 'grad_norm': 0.4149206876754761, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:12<00:00,  2.98it/s]100%|██████████| 40/40 [00:12<00:00,  3.57it/s]                                               {'loss': 0.0924, 'grad_norm': 4.739808559417725, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.57it/s]                                               {'train_runtime': 12.6625, 'train_samples_per_second': 44.62, 'train_steps_per_second': 3.159, 'train_loss': 1.2714530517347158, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.57it/s]100%|██████████| 40/40 [00:12<00:00,  3.16it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  3.00it/s]                                              {'loss': 5.6871, 'grad_norm': 4.975676536560059, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  3.00it/s]  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]                                              {'loss': 6.3416, 'grad_norm': 4.848222732543945, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]  8%|▊         | 3/40 [00:01<00:12,  2.99it/s]                                              {'loss': 5.1826, 'grad_norm': 5.903273582458496, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.99it/s] 10%|█         | 4/40 [00:01<00:12,  2.99it/s]                                              {'loss': 4.7384, 'grad_norm': 6.587976455688477, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.99it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.98it/s]                                              {'loss': 3.4876, 'grad_norm': 7.156671047210693, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.98it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.93it/s]                                              {'loss': 3.5535, 'grad_norm': 10.391054153442383, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.93it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s]                                              {'loss': 2.8279, 'grad_norm': 11.965010643005371, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s] 20%|██        | 8/40 [00:02<00:09,  3.55it/s]                                              {'loss': 7.4505, 'grad_norm': 53.960750579833984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.55it/s] 22%|██▎       | 9/40 [00:02<00:09,  3.35it/s]                                              {'loss': 2.4281, 'grad_norm': 13.132001876831055, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:09,  3.35it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.30it/s]                                               {'loss': 2.3402, 'grad_norm': 9.931136131286621, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.30it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.7881, 'grad_norm': 9.53156566619873, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.23it/s] 30%|███       | 12/40 [00:03<00:08,  3.16it/s]                                               {'loss': 1.4766, 'grad_norm': 8.803702354431152, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.16it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.12it/s]                                               {'loss': 2.0969, 'grad_norm': 6.8701982498168945, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.12it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.4043, 'grad_norm': 10.768457412719727, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 2.7183, 'grad_norm': 10.782848358154297, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 2.3427, 'grad_norm': 29.46845817565918, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.83it/s]                                               {'loss': 1.1486, 'grad_norm': 7.17891263961792, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s]                                               {'loss': 1.2705, 'grad_norm': 6.83878755569458, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.799, 'grad_norm': 4.791126728057861, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 1.2773, 'grad_norm': 4.263976097106934, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 1.3336, 'grad_norm': 6.452552795410156, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.7159, 'grad_norm': 4.242552280426025, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 1.1411, 'grad_norm': 6.333763122558594, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.0217, 'grad_norm': 1.0112484693527222, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s]                                               {'loss': 0.5908, 'grad_norm': 3.36118745803833, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.5123, 'grad_norm': 2.5584402084350586, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.3845, 'grad_norm': 2.7906501293182373, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s] 70%|███████   | 28/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.7591, 'grad_norm': 1.984369158744812, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.29it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s]                                               {'loss': 0.3913, 'grad_norm': 2.976893663406372, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.4435, 'grad_norm': 5.387633800506592, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.6331, 'grad_norm': 1.6004375219345093, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.8439, 'grad_norm': 26.116199493408203, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s]                                               {'loss': 0.278, 'grad_norm': 1.988538384437561, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s]                                               {'loss': 1.179, 'grad_norm': 1.5948383808135986, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.0959, 'grad_norm': 1.0929756164550781, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.1224, 'grad_norm': 1.5750203132629395, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.0822, 'grad_norm': 1.248710036277771, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.1151, 'grad_norm': 2.129878520965576, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.1667, 'grad_norm': 2.7512567043304443, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.0166, 'grad_norm': 0.7728368043899536, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.09it/s]                                               {'train_runtime': 12.2433, 'train_samples_per_second': 46.148, 'train_steps_per_second': 3.267, 'train_loss': 1.7546677035279572, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.09it/s]100%|██████████| 40/40 [00:12<00:00,  3.27it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.09it/s]                                              {'loss': 5.4136, 'grad_norm': 4.019637107849121, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.09it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 5.8603, 'grad_norm': 4.811922073364258, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:12,  3.03it/s]                                              {'loss': 5.4418, 'grad_norm': 8.138626098632812, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.03it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.9712, 'grad_norm': 7.2644453048706055, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 3.3456, 'grad_norm': 8.951868057250977, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s]                                              {'loss': 4.1867, 'grad_norm': 11.276161193847656, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s]                                              {'loss': 4.4256, 'grad_norm': 14.928098678588867, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s]                                              {'loss': 2.3593, 'grad_norm': 43.76363754272461, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.99it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.68it/s]                                              {'loss': 2.4056, 'grad_norm': 10.288488388061523, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.68it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s]                                               {'loss': 2.0746, 'grad_norm': 11.483075141906738, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s]                                               {'loss': 2.2184, 'grad_norm': 9.688852310180664, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.374, 'grad_norm': 8.522488594055176, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.9986, 'grad_norm': 9.018646240234375, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s]                                               {'loss': 1.7711, 'grad_norm': 9.44245433807373, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.8578, 'grad_norm': 8.367209434509277, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.003, 'grad_norm': 0.14769473671913147, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s]                                               {'loss': 1.2227, 'grad_norm': 3.509488105773926, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.63it/s]                                               {'loss': 1.1677, 'grad_norm': 5.199949264526367, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.63it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s]                                               {'loss': 0.9695, 'grad_norm': 5.203112602233887, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 1.4488, 'grad_norm': 6.397463321685791, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 1.2041, 'grad_norm': 6.029974937438965, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.6646, 'grad_norm': 4.890637397766113, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 0.6365, 'grad_norm': 4.407602310180664, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 0.2115, 'grad_norm': 30.397802352905273, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.13it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.6081, 'grad_norm': 3.718642234802246, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s]                                               {'loss': 0.4204, 'grad_norm': 3.1380319595336914, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.1844, 'grad_norm': 3.094855785369873, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.2798, 'grad_norm': 2.028542995452881, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.26it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.545, 'grad_norm': 2.6997623443603516, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.09it/s]                                               {'loss': 0.3442, 'grad_norm': 2.0745928287506104, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.09it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.8923, 'grad_norm': 3.1586544513702393, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.2143, 'grad_norm': 13.529550552368164, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.06it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.69it/s]                                               {'loss': 0.7164, 'grad_norm': 1.5304843187332153, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.69it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.47it/s]                                               {'loss': 0.321, 'grad_norm': 2.6283249855041504, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.47it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.1109, 'grad_norm': 1.6467334032058716, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.30it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.18it/s]                                               {'loss': 0.0728, 'grad_norm': 1.2504026889801025, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.18it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.1532, 'grad_norm': 1.890465497970581, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.07it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.05it/s]                                               {'loss': 0.1929, 'grad_norm': 2.395411729812622, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.05it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.01it/s]                                               {'loss': 0.1328, 'grad_norm': 2.3074374198913574, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.01it/s]                                               {'loss': 0.0123, 'grad_norm': 0.527434766292572, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.01it/s]                                               {'train_runtime': 12.2722, 'train_samples_per_second': 46.039, 'train_steps_per_second': 3.259, 'train_loss': 1.5358399798395113, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.01it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 4.3903, 'grad_norm': 4.6911187171936035, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]                                              {'loss': 5.2212, 'grad_norm': 5.2650346755981445, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]  8%|▊         | 3/40 [00:00<00:11,  3.15it/s]                                              {'loss': 4.8179, 'grad_norm': 5.258626937866211, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.15it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.9366, 'grad_norm': 6.6855854988098145, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.4077, 'grad_norm': 7.194005966186523, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s]                                              {'loss': 3.5746, 'grad_norm': 7.952210426330566, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 2.6583, 'grad_norm': 7.354449272155762, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s] 20%|██        | 8/40 [00:02<00:08,  3.76it/s]                                              {'loss': 2.7488, 'grad_norm': 65.09236145019531, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.76it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.50it/s]                                              {'loss': 2.1643, 'grad_norm': 10.09227180480957, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.50it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.5632, 'grad_norm': 5.759317398071289, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.33it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.6488, 'grad_norm': 6.400258541107178, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.24it/s] 30%|███       | 12/40 [00:03<00:08,  3.18it/s]                                               {'loss': 1.6281, 'grad_norm': 12.234199523925781, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.18it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.15it/s]                                               {'loss': 2.1793, 'grad_norm': 11.196610450744629, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.15it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.314, 'grad_norm': 8.501689910888672, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.4307, 'grad_norm': 5.893917560577393, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.2244, 'grad_norm': 5.099525451660156, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 1.29, 'grad_norm': 4.80145263671875, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 1.0408, 'grad_norm': 7.779666423797607, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 1.0854, 'grad_norm': 6.23013973236084, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 0.7027, 'grad_norm': 6.24758768081665, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.5726, 'grad_norm': 5.7308526039123535, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.368, 'grad_norm': 3.205946207046509, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.7872, 'grad_norm': 7.096210479736328, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.0206, 'grad_norm': 1.0853052139282227, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.80it/s]                                               {'loss': 0.4188, 'grad_norm': 5.67698335647583, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.80it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s]                                               {'loss': 0.4966, 'grad_norm': 5.7076616287231445, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.5419, 'grad_norm': 3.0647313594818115, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.5275, 'grad_norm': 4.0467000007629395, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.32it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.1189, 'grad_norm': 3.0591368675231934, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s]                                               {'loss': 0.2176, 'grad_norm': 2.5566701889038086, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.15it/s]                                               {'loss': 0.1406, 'grad_norm': 2.9528450965881348, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.15it/s]                                               {'loss': 0.301, 'grad_norm': 11.827102661132812, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.15it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s]                                               {'loss': 0.1126, 'grad_norm': 1.6511478424072266, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 0.2793, 'grad_norm': 4.391811847686768, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s]                                               {'loss': 0.0851, 'grad_norm': 2.1323904991149902, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.33it/s]                                               {'loss': 0.0554, 'grad_norm': 1.4646427631378174, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.33it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.25it/s]                                               {'loss': 0.0245, 'grad_norm': 0.4093165099620819, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.25it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.1459, 'grad_norm': 2.3119988441467285, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.7481, 'grad_norm': 6.601718902587891, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0118, 'grad_norm': 0.7030913829803467, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]                                               {'train_runtime': 12.0929, 'train_samples_per_second': 46.721, 'train_steps_per_second': 3.308, 'train_loss': 1.325021154526621, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.15it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:23
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.23it/s]                                              {'loss': 7.0672, 'grad_norm': 5.383569717407227, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.23it/s]  5%|▌         | 2/40 [00:00<00:12,  3.15it/s]                                              {'loss': 6.5, 'grad_norm': 4.642812728881836, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.15it/s]  8%|▊         | 3/40 [00:00<00:11,  3.09it/s]                                              {'loss': 6.6718, 'grad_norm': 7.300520896911621, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.09it/s] 10%|█         | 4/40 [00:01<00:11,  3.05it/s]                                              {'loss': 4.5812, 'grad_norm': 6.304428577423096, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.05it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.8536, 'grad_norm': 8.486809730529785, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 4.0475, 'grad_norm': 8.18498706817627, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 3.7486, 'grad_norm': 11.453556060791016, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 0.7251, 'grad_norm': 35.54360580444336, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.01it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s]                                              {'loss': 1.5474, 'grad_norm': 8.749842643737793, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.51it/s]                                               {'loss': 2.4092, 'grad_norm': 11.721968650817871, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.51it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.33it/s]                                               {'loss': 2.6453, 'grad_norm': 11.853219032287598, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.33it/s] 30%|███       | 12/40 [00:03<00:08,  3.22it/s]                                               {'loss': 1.4361, 'grad_norm': 8.130095481872559, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.22it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.15it/s]                                               {'loss': 2.1566, 'grad_norm': 11.985458374023438, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.15it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.8462, 'grad_norm': 8.311412811279297, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 2.277, 'grad_norm': 7.827807426452637, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.2481, 'grad_norm': 10.859910011291504, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s]                                               {'loss': 0.9931, 'grad_norm': 4.768821716308594, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 0.6776, 'grad_norm': 5.375942707061768, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.36it/s]                                               {'loss': 0.8169, 'grad_norm': 5.444864273071289, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.36it/s] 50%|█████     | 20/40 [00:06<00:06,  3.21it/s]                                               {'loss': 0.6382, 'grad_norm': 5.078705787658691, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.21it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.15it/s]                                               {'loss': 1.1534, 'grad_norm': 4.774631023406982, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.15it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.07it/s]                                               {'loss': 0.9043, 'grad_norm': 4.091018199920654, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.07it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.03it/s]                                               {'loss': 0.9805, 'grad_norm': 7.096136093139648, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.03it/s]                                               {'loss': 0.4859, 'grad_norm': 16.050613403320312, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.03it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.74it/s]                                               {'loss': 0.3053, 'grad_norm': 3.908339738845825, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.74it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s]                                               {'loss': 0.7282, 'grad_norm': 4.948603630065918, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.4458, 'grad_norm': 6.256246089935303, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s] 70%|███████   | 28/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.4202, 'grad_norm': 5.083008766174316, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.27it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s]                                               {'loss': 0.3063, 'grad_norm': 3.648313522338867, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s]                                               {'loss': 0.7247, 'grad_norm': 2.6665334701538086, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.2051, 'grad_norm': 2.1911654472351074, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.0272, 'grad_norm': 0.9467401504516602, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.13it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.88it/s]                                               {'loss': 0.5238, 'grad_norm': 1.746389627456665, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.88it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.66it/s]                                               {'loss': 0.3971, 'grad_norm': 0.835411787033081, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.66it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.49it/s]                                               {'loss': 0.0764, 'grad_norm': 0.6882448196411133, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.49it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.36it/s]                                               {'loss': 0.1664, 'grad_norm': 2.8975908756256104, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.36it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.0743, 'grad_norm': 1.0511901378631592, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.1399, 'grad_norm': 1.7182990312576294, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.258, 'grad_norm': 3.3288567066192627, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0379, 'grad_norm': 2.134061813354492, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 12.1007, 'train_samples_per_second': 46.691, 'train_steps_per_second': 3.306, 'train_loss': 1.6061833672225476, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.13it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.91it/s]                                              {'loss': 7.0762, 'grad_norm': 5.963592529296875, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.91it/s]  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]                                              {'loss': 6.173, 'grad_norm': 5.995121479034424, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]  8%|▊         | 3/40 [00:00<00:12,  3.02it/s]                                              {'loss': 4.6917, 'grad_norm': 7.316587924957275, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.02it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.2962, 'grad_norm': 6.333725929260254, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.06it/s]                                              {'loss': 4.0258, 'grad_norm': 8.978737831115723, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.06it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 2.7081, 'grad_norm': 7.017914772033691, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 3.4349, 'grad_norm': 11.62532901763916, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 3.5636, 'grad_norm': 48.4152717590332, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.06it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s]                                              {'loss': 1.2717, 'grad_norm': 5.462311267852783, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s]                                               {'loss': 1.3968, 'grad_norm': 6.281224250793457, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s]                                               {'loss': 1.9269, 'grad_norm': 7.003653526306152, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s] 30%|███       | 12/40 [00:03<00:08,  3.29it/s]                                               {'loss': 1.6488, 'grad_norm': 5.509887218475342, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.29it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s]                                               {'loss': 1.55, 'grad_norm': 6.549592971801758, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.3001, 'grad_norm': 8.291659355163574, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 0.9867, 'grad_norm': 5.753210067749023, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 0.0275, 'grad_norm': 0.9727628231048584, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.11it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s]                                               {'loss': 0.1288, 'grad_norm': 1.8048311471939087, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.4603, 'grad_norm': 5.43008279800415, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 1.012, 'grad_norm': 4.396998882293701, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 0.2676, 'grad_norm': 4.1146464347839355, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.9358, 'grad_norm': 10.910524368286133, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.5531, 'grad_norm': 3.729619264602661, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.7471, 'grad_norm': 4.383054256439209, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.0119, 'grad_norm': 0.5960469841957092, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s]                                               {'loss': 0.6503, 'grad_norm': 5.979889392852783, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s]                                               {'loss': 0.136, 'grad_norm': 1.3948345184326172, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s]                                               {'loss': 0.0851, 'grad_norm': 1.590243935585022, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s] 70%|███████   | 28/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.5107, 'grad_norm': 2.6011104583740234, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.26it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s]                                               {'loss': 0.3639, 'grad_norm': 3.782560348510742, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.2954, 'grad_norm': 4.5855536460876465, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.4027, 'grad_norm': 2.536144495010376, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.0201, 'grad_norm': 0.9196494221687317, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.07it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s]                                               {'loss': 0.3324, 'grad_norm': 2.321301221847534, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.77it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s]                                               {'loss': 0.6184, 'grad_norm': 3.4368443489074707, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.2332, 'grad_norm': 6.1277008056640625, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s]                                               {'loss': 0.1081, 'grad_norm': 1.912673830986023, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.0683, 'grad_norm': 1.4581260681152344, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.2929, 'grad_norm': 2.6714565753936768, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0519, 'grad_norm': 1.0262763500213623, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0469, 'grad_norm': 1.4469220638275146, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 12.084, 'train_samples_per_second': 46.756, 'train_steps_per_second': 3.31, 'train_loss': 1.335270757903345, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.13it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:70
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]                                              {'loss': 3.1668, 'grad_norm': 3.3887710571289062, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]                                              {'loss': 4.1993, 'grad_norm': 4.129765033721924, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]  8%|▊         | 3/40 [00:00<00:12,  3.08it/s]                                              {'loss': 4.4416, 'grad_norm': 5.375805854797363, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.08it/s] 10%|█         | 4/40 [00:01<00:11,  3.11it/s]                                              {'loss': 4.1843, 'grad_norm': 7.203031539916992, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.11it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s]                                              {'loss': 4.4976, 'grad_norm': 9.2294340133667, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 2.0731, 'grad_norm': 8.765769958496094, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 5.1054, 'grad_norm': 17.03696060180664, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 0.7067, 'grad_norm': 18.954069137573242, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.06it/s] 22%|██▎       | 9/40 [00:02<00:07,  3.88it/s]                                              {'loss': 2.4329, 'grad_norm': 7.582255840301514, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:07,  3.88it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.64it/s]                                               {'loss': 2.075, 'grad_norm': 7.278148174285889, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.64it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s]                                               {'loss': 1.1116, 'grad_norm': 5.445574760437012, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s] 30%|███       | 12/40 [00:03<00:08,  3.34it/s]                                               {'loss': 1.2412, 'grad_norm': 4.950860977172852, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.34it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.26it/s]                                               {'loss': 1.2378, 'grad_norm': 6.83401346206665, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.26it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.3527, 'grad_norm': 5.338290214538574, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.16it/s]                                               {'loss': 1.402, 'grad_norm': 6.3379130363464355, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.16it/s]                                               {'loss': 0.2816, 'grad_norm': 9.008273124694824, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.16it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.92it/s]                                               {'loss': 0.7353, 'grad_norm': 4.660589694976807, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.92it/s] 45%|████▌     | 18/40 [00:05<00:05,  3.67it/s]                                               {'loss': 0.4094, 'grad_norm': 4.519471168518066, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:05,  3.67it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.50it/s]                                               {'loss': 0.9837, 'grad_norm': 4.1027750968933105, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.50it/s] 50%|█████     | 20/40 [00:05<00:05,  3.37it/s]                                               {'loss': 0.5699, 'grad_norm': 4.9472246170043945, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.37it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.28it/s]                                               {'loss': 0.6724, 'grad_norm': 4.052061080932617, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.28it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.5714, 'grad_norm': 3.8390438556671143, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.20it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.9423, 'grad_norm': 8.889814376831055, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.4075, 'grad_norm': 27.509464263916016, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.15it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.77it/s]                                               {'loss': 0.3667, 'grad_norm': 2.34757399559021, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.77it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.54it/s]                                               {'loss': 0.1836, 'grad_norm': 2.9443106651306152, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.54it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s]                                               {'loss': 0.128, 'grad_norm': 3.7823455333709717, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s] 70%|███████   | 28/40 [00:08<00:03,  3.31it/s]                                               {'loss': 0.1902, 'grad_norm': 1.5851552486419678, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.31it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.4438, 'grad_norm': 5.826642036437988, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.1741, 'grad_norm': 2.4949965476989746, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.719, 'grad_norm': 6.61052942276001, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.0211, 'grad_norm': 0.9787842035293579, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s]                                               {'loss': 0.2899, 'grad_norm': 2.327122449874878, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.1122, 'grad_norm': 1.9942588806152344, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.0902, 'grad_norm': 0.9973722100257874, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s]                                               {'loss': 0.0947, 'grad_norm': 1.5462960004806519, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s]                                               {'loss': 0.404, 'grad_norm': 4.50702428817749, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.1373, 'grad_norm': 3.7114951610565186, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.0504, 'grad_norm': 0.7554364800453186, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.2068, 'grad_norm': 9.662908554077148, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.11it/s]                                               {'train_runtime': 11.9617, 'train_samples_per_second': 47.234, 'train_steps_per_second': 3.344, 'train_loss': 1.210335482377559, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.11it/s]100%|██████████| 40/40 [00:11<00:00,  3.34it/s]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 4.2854, 'grad_norm': 4.503309726715088, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.05it/s]                                              {'loss': 4.7467, 'grad_norm': 6.624568939208984, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.05it/s]  8%|▊         | 3/40 [00:00<00:12,  3.03it/s]                                              {'loss': 4.1612, 'grad_norm': 5.015429973602295, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.03it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s]                                              {'loss': 4.917, 'grad_norm': 6.988659858703613, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s]                                              {'loss': 2.9512, 'grad_norm': 8.482152938842773, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.1417, 'grad_norm': 12.609371185302734, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 2.4793, 'grad_norm': 10.83626651763916, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 2.3513, 'grad_norm': 32.11821365356445, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.08it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.87it/s]                                              {'loss': 1.216, 'grad_norm': 3.5864412784576416, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.87it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.60it/s]                                               {'loss': 2.4099, 'grad_norm': 11.963968276977539, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.60it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s]                                               {'loss': 1.3008, 'grad_norm': 6.694278240203857, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s] 30%|███       | 12/40 [00:03<00:08,  3.32it/s]                                               {'loss': 1.3419, 'grad_norm': 7.617890357971191, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.32it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.25it/s]                                               {'loss': 0.8846, 'grad_norm': 7.373189449310303, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.25it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.21it/s]                                               {'loss': 0.9138, 'grad_norm': 7.0618696212768555, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.21it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.18it/s]                                               {'loss': 1.1937, 'grad_norm': 5.8421854972839355, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.18it/s]                                               {'loss': 3.8024, 'grad_norm': 34.61913299560547, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.18it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.90it/s]                                               {'loss': 0.1648, 'grad_norm': 2.2948765754699707, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.90it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s]                                               {'loss': 0.7801, 'grad_norm': 4.097917556762695, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s]                                               {'loss': 0.4533, 'grad_norm': 3.0803894996643066, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s] 50%|█████     | 20/40 [00:05<00:05,  3.34it/s]                                               {'loss': 1.0499, 'grad_norm': 3.0740628242492676, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.34it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.25it/s]                                               {'loss': 0.2916, 'grad_norm': 4.271223545074463, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.25it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.2337, 'grad_norm': 3.329148292541504, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.20it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.6401, 'grad_norm': 4.8069963455200195, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.17it/s]                                               {'loss': 3.3194, 'grad_norm': 54.50407409667969, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.17it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s]                                               {'loss': 0.4702, 'grad_norm': 1.7650680541992188, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.63it/s]                                               {'loss': 0.1711, 'grad_norm': 1.9408496618270874, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.63it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.46it/s]                                               {'loss': 0.1732, 'grad_norm': 2.1526949405670166, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.46it/s] 70%|███████   | 28/40 [00:08<00:03,  3.33it/s]                                               {'loss': 0.0326, 'grad_norm': 0.5162314176559448, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.33it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.1936, 'grad_norm': 1.154397964477539, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.53, 'grad_norm': 2.0949642658233643, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.18it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.3048, 'grad_norm': 2.734924077987671, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.0073, 'grad_norm': 0.31764018535614014, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.0507, 'grad_norm': 1.1287837028503418, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.0679, 'grad_norm': 1.202892541885376, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s]                                               {'loss': 0.3983, 'grad_norm': 0.31361499428749084, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.1552, 'grad_norm': 2.799955129623413, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.4183, 'grad_norm': 2.6876673698425293, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.2412, 'grad_norm': 2.1663830280303955, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.2113, 'grad_norm': 1.4472681283950806, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0043, 'grad_norm': 0.38229745626449585, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 12.0218, 'train_samples_per_second': 46.998, 'train_steps_per_second': 3.327, 'train_loss': 1.3114875735947862, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.12it/s]100%|██████████| 40/40 [00:12<00:00,  3.33it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 10.97it/s]  1%|          | 4/471 [00:00<01:07,  6.94it/s]  1%|          | 5/471 [00:00<01:12,  6.46it/s]  1%|▏         | 6/471 [00:00<01:16,  6.11it/s]  1%|▏         | 7/471 [00:01<01:18,  5.88it/s]  2%|▏         | 8/471 [00:01<01:20,  5.77it/s]  2%|▏         | 9/471 [00:01<01:21,  5.70it/s]  2%|▏         | 10/471 [00:01<01:21,  5.64it/s]  2%|▏         | 11/471 [00:01<01:22,  5.59it/s]  3%|▎         | 12/471 [00:02<01:22,  5.54it/s]  3%|▎         | 13/471 [00:02<01:23,  5.50it/s]  3%|▎         | 14/471 [00:02<01:23,  5.48it/s]  3%|▎         | 15/471 [00:02<01:22,  5.50it/s]  3%|▎         | 16/471 [00:02<01:22,  5.50it/s]  4%|▎         | 17/471 [00:02<01:22,  5.49it/s]  4%|▍         | 18/471 [00:03<01:22,  5.46it/s]  4%|▍         | 19/471 [00:03<01:22,  5.47it/s]  4%|▍         | 20/471 [00:03<01:22,  5.47it/s]  4%|▍         | 21/471 [00:03<01:22,  5.46it/s]  5%|▍         | 22/471 [00:03<01:22,  5.46it/s]  5%|▍         | 23/471 [00:04<01:22,  5.46it/s]  5%|▌         | 24/471 [00:04<01:22,  5.45it/s]  5%|▌         | 25/471 [00:04<01:21,  5.46it/s]  6%|▌         | 26/471 [00:04<01:21,  5.45it/s]  6%|▌         | 27/471 [00:04<01:21,  5.44it/s]  6%|▌         | 28/471 [00:04<01:21,  5.45it/s]  6%|▌         | 29/471 [00:05<01:21,  5.43it/s]  6%|▋         | 30/471 [00:05<01:21,  5.43it/s]  7%|▋         | 31/471 [00:05<01:21,  5.42it/s]  7%|▋         | 32/471 [00:05<01:20,  5.45it/s]  7%|▋         | 33/471 [00:05<01:19,  5.49it/s]  7%|▋         | 34/471 [00:06<01:19,  5.49it/s]  7%|▋         | 35/471 [00:06<01:19,  5.46it/s]  8%|▊         | 36/471 [00:06<01:19,  5.45it/s]  8%|▊         | 37/471 [00:06<01:19,  5.44it/s]  8%|▊         | 38/471 [00:06<01:19,  5.44it/s]  8%|▊         | 39/471 [00:06<01:19,  5.44it/s]  8%|▊         | 40/471 [00:07<01:19,  5.43it/s]  9%|▊         | 41/471 [00:07<01:19,  5.44it/s]  9%|▉         | 42/471 [00:07<01:19,  5.42it/s]  9%|▉         | 43/471 [00:07<01:18,  5.43it/s]  9%|▉         | 44/471 [00:07<01:18,  5.46it/s] 10%|▉         | 45/471 [00:08<01:18,  5.44it/s] 10%|▉         | 46/471 [00:08<01:18,  5.43it/s] 10%|▉         | 47/471 [00:08<01:18,  5.42it/s] 10%|█         | 48/471 [00:08<01:17,  5.43it/s] 10%|█         | 49/471 [00:08<01:17,  5.43it/s] 11%|█         | 50/471 [00:08<01:17,  5.42it/s] 11%|█         | 51/471 [00:09<01:17,  5.41it/s] 11%|█         | 52/471 [00:09<01:17,  5.42it/s] 11%|█▏        | 53/471 [00:09<01:17,  5.41it/s] 11%|█▏        | 54/471 [00:09<01:17,  5.40it/s] 12%|█▏        | 55/471 [00:09<01:17,  5.39it/s] 12%|█▏        | 56/471 [00:10<01:16,  5.40it/s] 12%|█▏        | 57/471 [00:10<01:16,  5.41it/s] 12%|█▏        | 58/471 [00:10<01:16,  5.43it/s] 13%|█▎        | 59/471 [00:10<01:16,  5.41it/s] 13%|█▎        | 60/471 [00:10<01:15,  5.42it/s] 13%|█▎        | 61/471 [00:11<01:15,  5.41it/s] 13%|█▎        | 62/471 [00:11<01:15,  5.41it/s] 13%|█▎        | 63/471 [00:11<01:15,  5.41it/s] 14%|█▎        | 64/471 [00:11<01:15,  5.40it/s] 14%|█▍        | 65/471 [00:11<01:15,  5.39it/s] 14%|█▍        | 66/471 [00:11<01:15,  5.39it/s] 14%|█▍        | 67/471 [00:12<01:15,  5.38it/s] 14%|█▍        | 68/471 [00:12<01:14,  5.38it/s] 15%|█▍        | 69/471 [00:12<01:14,  5.37it/s] 15%|█▍        | 70/471 [00:12<01:14,  5.36it/s] 15%|█▌        | 71/471 [00:12<01:14,  5.38it/s] 15%|█▌        | 72/471 [00:13<01:14,  5.38it/s] 15%|█▌        | 73/471 [00:13<01:13,  5.38it/s] 16%|█▌        | 74/471 [00:13<01:13,  5.39it/s] 16%|█▌        | 75/471 [00:13<01:13,  5.38it/s] 16%|█▌        | 76/471 [00:13<01:13,  5.40it/s] 16%|█▋        | 77/471 [00:13<01:12,  5.43it/s] 17%|█▋        | 78/471 [00:14<01:12,  5.40it/s] 17%|█▋        | 79/471 [00:14<01:12,  5.38it/s] 17%|█▋        | 80/471 [00:14<01:12,  5.38it/s] 17%|█▋        | 81/471 [00:14<01:12,  5.39it/s] 17%|█▋        | 82/471 [00:14<01:11,  5.41it/s] 18%|█▊        | 83/471 [00:15<01:12,  5.39it/s] 18%|█▊        | 84/471 [00:15<01:12,  5.37it/s] 18%|█▊        | 85/471 [00:15<01:11,  5.38it/s] 18%|█▊        | 86/471 [00:15<01:11,  5.37it/s] 18%|█▊        | 87/471 [00:15<01:11,  5.40it/s] 19%|█▊        | 88/471 [00:16<01:10,  5.40it/s] 19%|█▉        | 89/471 [00:16<01:10,  5.41it/s] 19%|█▉        | 90/471 [00:16<01:10,  5.37it/s] 19%|█▉        | 91/471 [00:16<01:10,  5.38it/s] 20%|█▉        | 92/471 [00:16<01:10,  5.39it/s] 20%|█▉        | 93/471 [00:16<01:10,  5.39it/s] 20%|█▉        | 94/471 [00:17<01:09,  5.40it/s] 20%|██        | 95/471 [00:17<01:09,  5.41it/s] 20%|██        | 96/471 [00:17<01:09,  5.40it/s] 21%|██        | 97/471 [00:17<01:09,  5.37it/s] 21%|██        | 98/471 [00:17<01:09,  5.38it/s] 21%|██        | 99/471 [00:18<01:08,  5.39it/s] 21%|██        | 100/471 [00:18<01:08,  5.43it/s] 21%|██▏       | 101/471 [00:18<01:08,  5.42it/s] 22%|██▏       | 102/471 [00:18<01:08,  5.38it/s] 22%|██▏       | 103/471 [00:18<01:08,  5.37it/s] 22%|██▏       | 104/471 [00:19<01:08,  5.36it/s] 22%|██▏       | 105/471 [00:19<01:08,  5.35it/s] 23%|██▎       | 106/471 [00:19<01:07,  5.40it/s] 23%|██▎       | 107/471 [00:19<01:07,  5.41it/s] 23%|██▎       | 108/471 [00:19<01:07,  5.39it/s] 23%|██▎       | 109/471 [00:19<01:07,  5.39it/s] 23%|██▎       | 110/471 [00:20<01:06,  5.40it/s] 24%|██▎       | 111/471 [00:20<01:06,  5.39it/s] 24%|██▍       | 112/471 [00:20<01:06,  5.39it/s] 24%|██▍       | 113/471 [00:20<01:06,  5.41it/s] 24%|██▍       | 114/471 [00:20<01:06,  5.39it/s] 24%|██▍       | 115/471 [00:21<01:06,  5.37it/s] 25%|██▍       | 116/471 [00:21<01:06,  5.36it/s] 25%|██▍       | 117/471 [00:21<01:05,  5.37it/s] 25%|██▌       | 118/471 [00:21<01:05,  5.36it/s] 25%|██▌       | 119/471 [00:21<01:05,  5.35it/s] 25%|██▌       | 120/471 [00:21<01:05,  5.36it/s] 26%|██▌       | 121/471 [00:22<01:05,  5.34it/s] 26%|██▌       | 122/471 [00:22<01:05,  5.34it/s] 26%|██▌       | 123/471 [00:22<01:04,  5.36it/s] 26%|██▋       | 124/471 [00:22<01:04,  5.35it/s] 27%|██▋       | 125/471 [00:22<01:04,  5.34it/s] 27%|██▋       | 126/471 [00:23<01:04,  5.34it/s] 27%|██▋       | 127/471 [00:23<01:04,  5.33it/s] 27%|██▋       | 128/471 [00:23<01:04,  5.34it/s] 27%|██▋       | 129/471 [00:23<01:04,  5.34it/s] 28%|██▊       | 130/471 [00:23<01:03,  5.34it/s] 28%|██▊       | 131/471 [00:24<01:03,  5.35it/s] 28%|██▊       | 132/471 [00:24<01:03,  5.34it/s] 28%|██▊       | 133/471 [00:24<01:03,  5.33it/s] 28%|██▊       | 134/471 [00:24<01:03,  5.32it/s] 29%|██▊       | 135/471 [00:24<01:03,  5.32it/s] 29%|██▉       | 136/471 [00:24<01:02,  5.34it/s] 29%|██▉       | 137/471 [00:25<01:02,  5.33it/s] 29%|██▉       | 138/471 [00:25<01:02,  5.32it/s] 30%|██▉       | 139/471 [00:25<01:02,  5.34it/s] 30%|██▉       | 140/471 [00:25<01:01,  5.34it/s] 30%|██▉       | 141/471 [00:25<01:01,  5.35it/s] 30%|███       | 142/471 [00:26<01:01,  5.36it/s] 30%|███       | 143/471 [00:26<01:01,  5.36it/s] 31%|███       | 144/471 [00:26<01:01,  5.33it/s] 31%|███       | 145/471 [00:26<01:00,  5.35it/s] 31%|███       | 146/471 [00:26<01:00,  5.35it/s] 31%|███       | 147/471 [00:27<01:00,  5.34it/s] 31%|███▏      | 148/471 [00:27<01:00,  5.34it/s] 32%|███▏      | 149/471 [00:27<01:00,  5.32it/s] 32%|███▏      | 150/471 [00:27<01:00,  5.32it/s] 32%|███▏      | 151/471 [00:27<01:00,  5.33it/s] 32%|███▏      | 152/471 [00:27<00:59,  5.32it/s] 32%|███▏      | 153/471 [00:28<00:59,  5.32it/s] 33%|███▎      | 154/471 [00:28<00:59,  5.34it/s] 33%|███▎      | 155/471 [00:28<00:59,  5.33it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.35it/s] 33%|███▎      | 157/471 [00:28<00:58,  5.34it/s] 34%|███▎      | 158/471 [00:29<00:58,  5.34it/s] 34%|███▍      | 159/471 [00:29<00:58,  5.35it/s] 34%|███▍      | 160/471 [00:29<00:58,  5.33it/s] 34%|███▍      | 161/471 [00:29<00:58,  5.32it/s] 34%|███▍      | 162/471 [00:29<00:58,  5.31it/s] 35%|███▍      | 163/471 [00:30<00:58,  5.30it/s] 35%|███▍      | 164/471 [00:30<00:57,  5.32it/s] 35%|███▌      | 165/471 [00:30<00:57,  5.31it/s] 35%|███▌      | 166/471 [00:30<00:57,  5.31it/s] 35%|███▌      | 167/471 [00:30<00:57,  5.29it/s] 36%|███▌      | 168/471 [00:30<00:57,  5.30it/s] 36%|███▌      | 169/471 [00:31<00:57,  5.28it/s] 36%|███▌      | 170/471 [00:31<00:56,  5.30it/s] 36%|███▋      | 171/471 [00:31<00:56,  5.30it/s] 37%|███▋      | 172/471 [00:31<00:56,  5.31it/s] 37%|███▋      | 173/471 [00:31<00:55,  5.32it/s] 37%|███▋      | 174/471 [00:32<00:56,  5.30it/s] 37%|███▋      | 175/471 [00:32<00:56,  5.28it/s] 37%|███▋      | 176/471 [00:32<00:55,  5.28it/s] 38%|███▊      | 177/471 [00:32<00:55,  5.29it/s] 38%|███▊      | 178/471 [00:32<00:55,  5.29it/s] 38%|███▊      | 179/471 [00:33<00:54,  5.31it/s] 38%|███▊      | 180/471 [00:33<00:54,  5.30it/s] 38%|███▊      | 181/471 [00:33<00:54,  5.30it/s] 39%|███▊      | 182/471 [00:33<00:54,  5.30it/s] 39%|███▉      | 183/471 [00:33<00:54,  5.30it/s] 39%|███▉      | 184/471 [00:33<00:54,  5.31it/s] 39%|███▉      | 185/471 [00:34<00:53,  5.31it/s] 39%|███▉      | 186/471 [00:34<00:53,  5.30it/s] 40%|███▉      | 187/471 [00:34<00:53,  5.29it/s] 40%|███▉      | 188/471 [00:34<00:53,  5.28it/s] 40%|████      | 189/471 [00:34<00:53,  5.30it/s] 40%|████      | 190/471 [00:35<00:52,  5.30it/s] 41%|████      | 191/471 [00:35<00:52,  5.29it/s] 41%|████      | 192/471 [00:35<00:52,  5.30it/s] 41%|████      | 193/471 [00:35<00:52,  5.32it/s] 41%|████      | 194/471 [00:35<00:52,  5.30it/s] 41%|████▏     | 195/471 [00:36<00:52,  5.30it/s] 42%|████▏     | 196/471 [00:36<00:51,  5.30it/s] 42%|████▏     | 197/471 [00:36<00:51,  5.32it/s] 42%|████▏     | 198/471 [00:36<00:51,  5.32it/s] 42%|████▏     | 199/471 [00:36<00:51,  5.30it/s] 42%|████▏     | 200/471 [00:37<00:51,  5.30it/s] 43%|████▎     | 201/471 [00:37<00:50,  5.32it/s] 43%|████▎     | 202/471 [00:37<00:50,  5.32it/s] 43%|████▎     | 203/471 [00:37<00:50,  5.31it/s] 43%|████▎     | 204/471 [00:37<00:50,  5.30it/s] 44%|████▎     | 205/471 [00:37<00:50,  5.32it/s] 44%|████▎     | 206/471 [00:38<00:49,  5.31it/s] 44%|████▍     | 207/471 [00:38<00:49,  5.31it/s] 44%|████▍     | 208/471 [00:38<00:49,  5.34it/s] 44%|████▍     | 209/471 [00:38<00:49,  5.35it/s] 45%|████▍     | 210/471 [00:38<00:48,  5.33it/s] 45%|████▍     | 211/471 [00:39<00:48,  5.32it/s] 45%|████▌     | 212/471 [00:39<00:48,  5.31it/s] 45%|████▌     | 213/471 [00:39<00:48,  5.32it/s] 45%|████▌     | 214/471 [00:39<00:48,  5.31it/s] 46%|████▌     | 215/471 [00:39<00:48,  5.31it/s] 46%|████▌     | 216/471 [00:40<00:48,  5.29it/s] 46%|████▌     | 217/471 [00:40<00:48,  5.27it/s] 46%|████▋     | 218/471 [00:40<00:47,  5.28it/s] 46%|████▋     | 219/471 [00:40<00:47,  5.29it/s] 47%|████▋     | 220/471 [00:40<00:47,  5.28it/s] 47%|████▋     | 221/471 [00:40<00:47,  5.27it/s] 47%|████▋     | 222/471 [00:41<00:47,  5.28it/s] 47%|████▋     | 223/471 [00:41<00:46,  5.30it/s] 48%|████▊     | 224/471 [00:41<00:46,  5.30it/s] 48%|████▊     | 225/471 [00:41<00:46,  5.29it/s] 48%|████▊     | 226/471 [00:41<00:46,  5.29it/s] 48%|████▊     | 227/471 [00:42<00:46,  5.29it/s] 48%|████▊     | 228/471 [00:42<00:46,  5.28it/s] 49%|████▊     | 229/471 [00:42<00:45,  5.28it/s] 49%|████▉     | 230/471 [00:42<00:45,  5.29it/s] 49%|████▉     | 231/471 [00:42<00:45,  5.29it/s] 49%|████▉     | 232/471 [00:43<00:45,  5.31it/s] 49%|████▉     | 233/471 [00:43<00:44,  5.29it/s] 50%|████▉     | 234/471 [00:43<00:44,  5.29it/s] 50%|████▉     | 235/471 [00:43<00:44,  5.28it/s] 50%|█████     | 236/471 [00:43<00:44,  5.30it/s] 50%|█████     | 237/471 [00:43<00:44,  5.30it/s] 51%|█████     | 238/471 [00:44<00:44,  5.30it/s] 51%|█████     | 239/471 [00:44<00:43,  5.31it/s] 51%|█████     | 240/471 [00:44<00:43,  5.30it/s] 51%|█████     | 241/471 [00:44<00:43,  5.30it/s] 51%|█████▏    | 242/471 [00:44<00:43,  5.30it/s] 52%|█████▏    | 243/471 [00:45<00:43,  5.30it/s] 52%|█████▏    | 244/471 [00:45<00:42,  5.30it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.29it/s] 52%|█████▏    | 246/471 [00:45<00:42,  5.30it/s] 52%|█████▏    | 247/471 [00:45<00:42,  5.31it/s] 53%|█████▎    | 248/471 [00:46<00:41,  5.31it/s] 53%|█████▎    | 249/471 [00:46<00:41,  5.31it/s] 53%|█████▎    | 250/471 [00:46<00:41,  5.30it/s] 53%|█████▎    | 251/471 [00:46<00:41,  5.30it/s] 54%|█████▎    | 252/471 [00:46<00:41,  5.29it/s] 54%|█████▎    | 253/471 [00:47<00:41,  5.29it/s] 54%|█████▍    | 254/471 [00:47<00:41,  5.28it/s] 54%|█████▍    | 255/471 [00:47<00:40,  5.28it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.28it/s] 55%|█████▍    | 257/471 [00:47<00:40,  5.27it/s] 55%|█████▍    | 258/471 [00:47<00:40,  5.28it/s] 55%|█████▍    | 259/471 [00:48<00:40,  5.28it/s] 55%|█████▌    | 260/471 [00:48<00:40,  5.27it/s] 55%|█████▌    | 261/471 [00:48<00:39,  5.27it/s] 56%|█████▌    | 262/471 [00:48<00:39,  5.29it/s] 56%|█████▌    | 263/471 [00:48<00:39,  5.26it/s] 56%|█████▌    | 264/471 [00:49<00:39,  5.27it/s] 56%|█████▋    | 265/471 [00:49<00:39,  5.25it/s] 56%|█████▋    | 266/471 [00:49<00:39,  5.25it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.27it/s] 57%|█████▋    | 268/471 [00:49<00:38,  5.27it/s] 57%|█████▋    | 269/471 [00:50<00:38,  5.26it/s] 57%|█████▋    | 270/471 [00:50<00:38,  5.25it/s] 58%|█████▊    | 271/471 [00:50<00:38,  5.26it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.28it/s] 58%|█████▊    | 273/471 [00:50<00:37,  5.29it/s] 58%|█████▊    | 274/471 [00:51<00:37,  5.30it/s] 58%|█████▊    | 275/471 [00:51<00:37,  5.29it/s] 59%|█████▊    | 276/471 [00:51<00:36,  5.27it/s] 59%|█████▉    | 277/471 [00:51<00:36,  5.28it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.27it/s] 59%|█████▉    | 279/471 [00:51<00:36,  5.28it/s] 59%|█████▉    | 280/471 [00:52<00:36,  5.28it/s] 60%|█████▉    | 281/471 [00:52<00:36,  5.26it/s] 60%|█████▉    | 282/471 [00:52<00:35,  5.26it/s] 60%|██████    | 283/471 [00:52<00:35,  5.26it/s] 60%|██████    | 284/471 [00:52<00:35,  5.27it/s] 61%|██████    | 285/471 [00:53<00:35,  5.27it/s] 61%|██████    | 286/471 [00:53<00:35,  5.26it/s] 61%|██████    | 287/471 [00:53<00:34,  5.27it/s] 61%|██████    | 288/471 [00:53<00:34,  5.26it/s] 61%|██████▏   | 289/471 [00:53<00:34,  5.29it/s] 62%|██████▏   | 290/471 [00:54<00:34,  5.29it/s] 62%|██████▏   | 291/471 [00:54<00:34,  5.28it/s] 62%|██████▏   | 292/471 [00:54<00:33,  5.28it/s] 62%|██████▏   | 293/471 [00:54<00:33,  5.30it/s] 62%|██████▏   | 294/471 [00:54<00:33,  5.30it/s] 63%|██████▎   | 295/471 [00:54<00:33,  5.30it/s] 63%|██████▎   | 296/471 [00:55<00:32,  5.31it/s] 63%|██████▎   | 297/471 [00:55<00:32,  5.32it/s] 63%|██████▎   | 298/471 [00:55<00:32,  5.29it/s] 63%|██████▎   | 299/471 [00:55<00:32,  5.30it/s] 64%|██████▎   | 300/471 [00:55<00:32,  5.28it/s] 64%|██████▍   | 301/471 [00:56<00:32,  5.28it/s] 64%|██████▍   | 302/471 [00:56<00:31,  5.28it/s] 64%|██████▍   | 303/471 [00:56<00:31,  5.27it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.28it/s] 65%|██████▍   | 305/471 [00:56<00:31,  5.29it/s] 65%|██████▍   | 306/471 [00:57<00:31,  5.28it/s] 65%|██████▌   | 307/471 [00:57<00:31,  5.26it/s] 65%|██████▌   | 308/471 [00:57<00:31,  5.25it/s] 66%|██████▌   | 309/471 [00:57<00:30,  5.25it/s] 66%|██████▌   | 310/471 [00:57<00:30,  5.27it/s] 66%|██████▌   | 311/471 [00:58<00:30,  5.27it/s] 66%|██████▌   | 312/471 [00:58<00:30,  5.28it/s] 66%|██████▋   | 313/471 [00:58<00:29,  5.28it/s] 67%|██████▋   | 314/471 [00:58<00:29,  5.28it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.28it/s] 67%|██████▋   | 316/471 [00:58<00:29,  5.28it/s] 67%|██████▋   | 317/471 [00:59<00:29,  5.29it/s] 68%|██████▊   | 318/471 [00:59<00:28,  5.28it/s] 68%|██████▊   | 319/471 [00:59<00:28,  5.27it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.26it/s] 68%|██████▊   | 321/471 [00:59<00:28,  5.25it/s] 68%|██████▊   | 322/471 [01:00<00:28,  5.25it/s] 69%|██████▊   | 323/471 [01:00<00:28,  5.25it/s] 69%|██████▉   | 324/471 [01:00<00:28,  5.25it/s] 69%|██████▉   | 325/471 [01:00<00:27,  5.26it/s] 69%|██████▉   | 326/471 [01:00<00:27,  5.27it/s] 69%|██████▉   | 327/471 [01:01<00:27,  5.28it/s] 70%|██████▉   | 328/471 [01:01<00:27,  5.27it/s] 70%|██████▉   | 329/471 [01:01<00:26,  5.27it/s] 70%|███████   | 330/471 [01:01<00:26,  5.29it/s] 70%|███████   | 331/471 [01:01<00:26,  5.30it/s] 70%|███████   | 332/471 [01:01<00:26,  5.28it/s] 71%|███████   | 333/471 [01:02<00:26,  5.28it/s] 71%|███████   | 334/471 [01:02<00:26,  5.27it/s] 71%|███████   | 335/471 [01:02<00:25,  5.27it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.28it/s] 72%|███████▏  | 337/471 [01:02<00:25,  5.31it/s] 72%|███████▏  | 338/471 [01:03<00:25,  5.29it/s] 72%|███████▏  | 339/471 [01:03<00:25,  5.24it/s] 72%|███████▏  | 340/471 [01:03<00:24,  5.27it/s] 72%|███████▏  | 341/471 [01:03<00:24,  5.28it/s] 73%|███████▎  | 342/471 [01:03<00:24,  5.27it/s] 73%|███████▎  | 343/471 [01:04<00:24,  5.25it/s] 73%|███████▎  | 344/471 [01:04<00:24,  5.27it/s] 73%|███████▎  | 345/471 [01:04<00:23,  5.27it/s] 73%|███████▎  | 346/471 [01:04<00:23,  5.26it/s] 74%|███████▎  | 347/471 [01:04<00:23,  5.28it/s] 74%|███████▍  | 348/471 [01:05<00:23,  5.26it/s] 74%|███████▍  | 349/471 [01:05<00:23,  5.27it/s] 74%|███████▍  | 350/471 [01:05<00:23,  5.26it/s] 75%|███████▍  | 351/471 [01:05<00:22,  5.28it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.27it/s] 75%|███████▍  | 353/471 [01:05<00:22,  5.26it/s] 75%|███████▌  | 354/471 [01:06<00:22,  5.26it/s] 75%|███████▌  | 355/471 [01:06<00:22,  5.25it/s] 76%|███████▌  | 356/471 [01:06<00:21,  5.25it/s] 76%|███████▌  | 357/471 [01:06<00:21,  5.26it/s] 76%|███████▌  | 358/471 [01:06<00:21,  5.26it/s] 76%|███████▌  | 359/471 [01:07<00:21,  5.27it/s] 76%|███████▋  | 360/471 [01:07<00:21,  5.25it/s] 77%|███████▋  | 361/471 [01:07<00:20,  5.27it/s] 77%|███████▋  | 362/471 [01:07<00:20,  5.27it/s] 77%|███████▋  | 363/471 [01:07<00:20,  5.27it/s] 77%|███████▋  | 364/471 [01:08<00:20,  5.28it/s] 77%|███████▋  | 365/471 [01:08<00:20,  5.26it/s] 78%|███████▊  | 366/471 [01:08<00:20,  5.25it/s] 78%|███████▊  | 367/471 [01:08<00:19,  5.25it/s] 78%|███████▊  | 368/471 [01:08<00:19,  5.26it/s] 78%|███████▊  | 369/471 [01:09<00:19,  5.28it/s] 79%|███████▊  | 370/471 [01:09<00:19,  5.26it/s] 79%|███████▉  | 371/471 [01:09<00:19,  5.26it/s] 79%|███████▉  | 372/471 [01:09<00:18,  5.27it/s] 79%|███████▉  | 373/471 [01:09<00:18,  5.27it/s] 79%|███████▉  | 374/471 [01:09<00:18,  5.28it/s] 80%|███████▉  | 375/471 [01:10<00:18,  5.28it/s] 80%|███████▉  | 376/471 [01:10<00:18,  5.28it/s] 80%|████████  | 377/471 [01:10<00:17,  5.28it/s] 80%|████████  | 378/471 [01:10<00:17,  5.30it/s] 80%|████████  | 379/471 [01:10<00:17,  5.30it/s] 81%|████████  | 380/471 [01:11<00:17,  5.28it/s] 81%|████████  | 381/471 [01:11<00:17,  5.29it/s] 81%|████████  | 382/471 [01:11<00:16,  5.27it/s] 81%|████████▏ | 383/471 [01:11<00:16,  5.27it/s] 82%|████████▏ | 384/471 [01:11<00:16,  5.26it/s] 82%|████████▏ | 385/471 [01:12<00:16,  5.26it/s] 82%|████████▏ | 386/471 [01:12<00:16,  5.26it/s] 82%|████████▏ | 387/471 [01:12<00:16,  5.25it/s] 82%|████████▏ | 388/471 [01:12<00:15,  5.24it/s] 83%|████████▎ | 389/471 [01:12<00:15,  5.26it/s] 83%|████████▎ | 390/471 [01:13<00:15,  5.26it/s] 83%|████████▎ | 391/471 [01:13<00:15,  5.26it/s] 83%|████████▎ | 392/471 [01:13<00:15,  5.26it/s] 83%|████████▎ | 393/471 [01:13<00:14,  5.27it/s] 84%|████████▎ | 394/471 [01:13<00:14,  5.26it/s] 84%|████████▍ | 395/471 [01:13<00:14,  5.25it/s] 84%|████████▍ | 396/471 [01:14<00:14,  5.25it/s] 84%|████████▍ | 397/471 [01:14<00:14,  5.26it/s] 85%|████████▍ | 398/471 [01:14<00:13,  5.26it/s] 85%|████████▍ | 399/471 [01:14<00:13,  5.24it/s] 85%|████████▍ | 400/471 [01:14<00:13,  5.25it/s] 85%|████████▌ | 401/471 [01:15<00:13,  5.26it/s] 85%|████████▌ | 402/471 [01:15<00:13,  5.25it/s] 86%|████████▌ | 403/471 [01:15<00:12,  5.26it/s] 86%|████████▌ | 404/471 [01:15<00:12,  5.27it/s] 86%|████████▌ | 405/471 [01:15<00:12,  5.26it/s] 86%|████████▌ | 406/471 [01:16<00:12,  5.27it/s] 86%|████████▋ | 407/471 [01:16<00:12,  5.28it/s] 87%|████████▋ | 408/471 [01:16<00:11,  5.26it/s] 87%|████████▋ | 409/471 [01:16<00:11,  5.26it/s] 87%|████████▋ | 410/471 [01:16<00:11,  5.28it/s] 87%|████████▋ | 411/471 [01:16<00:11,  5.29it/s] 87%|████████▋ | 412/471 [01:17<00:11,  5.28it/s] 88%|████████▊ | 413/471 [01:17<00:11,  5.27it/s] 88%|████████▊ | 414/471 [01:17<00:10,  5.26it/s] 88%|████████▊ | 415/471 [01:17<00:10,  5.26it/s] 88%|████████▊ | 416/471 [01:17<00:10,  5.25it/s] 89%|████████▊ | 417/471 [01:18<00:10,  5.26it/s] 89%|████████▊ | 418/471 [01:18<00:10,  5.25it/s] 89%|████████▉ | 419/471 [01:18<00:09,  5.27it/s] 89%|████████▉ | 420/471 [01:18<00:09,  5.29it/s] 89%|████████▉ | 421/471 [01:18<00:09,  5.28it/s] 90%|████████▉ | 422/471 [01:19<00:09,  5.29it/s] 90%|████████▉ | 423/471 [01:19<00:09,  5.29it/s] 90%|█████████ | 424/471 [01:19<00:08,  5.29it/s] 90%|█████████ | 425/471 [01:19<00:08,  5.29it/s] 90%|█████████ | 426/471 [01:19<00:08,  5.27it/s] 91%|█████████ | 427/471 [01:20<00:08,  5.26it/s] 91%|█████████ | 428/471 [01:20<00:08,  5.26it/s] 91%|█████████ | 429/471 [01:20<00:07,  5.26it/s] 91%|█████████▏| 430/471 [01:20<00:07,  5.27it/s] 92%|█████████▏| 431/471 [01:20<00:07,  5.26it/s] 92%|█████████▏| 432/471 [01:20<00:07,  5.26it/s] 92%|█████████▏| 433/471 [01:21<00:07,  5.26it/s] 92%|█████████▏| 434/471 [01:21<00:07,  5.26it/s] 92%|█████████▏| 435/471 [01:21<00:06,  5.27it/s] 93%|█████████▎| 436/471 [01:21<00:06,  5.29it/s] 93%|█████████▎| 437/471 [01:21<00:06,  5.27it/s] 93%|█████████▎| 438/471 [01:22<00:06,  5.27it/s] 93%|█████████▎| 439/471 [01:22<00:06,  5.27it/s] 93%|█████████▎| 440/471 [01:22<00:05,  5.29it/s] 94%|█████████▎| 441/471 [01:22<00:05,  5.28it/s] 94%|█████████▍| 442/471 [01:22<00:05,  5.29it/s] 94%|█████████▍| 443/471 [01:23<00:05,  5.29it/s] 94%|█████████▍| 444/471 [01:23<00:05,  5.28it/s] 94%|█████████▍| 445/471 [01:23<00:04,  5.27it/s] 95%|█████████▍| 446/471 [01:23<00:04,  5.26it/s] 95%|█████████▍| 447/471 [01:23<00:04,  5.26it/s] 95%|█████████▌| 448/471 [01:24<00:04,  5.27it/s] 95%|█████████▌| 449/471 [01:24<00:04,  5.28it/s] 96%|█████████▌| 450/471 [01:24<00:03,  5.26it/s] 96%|█████████▌| 451/471 [01:24<00:03,  5.28it/s] 96%|█████████▌| 452/471 [01:24<00:03,  5.28it/s] 96%|█████████▌| 453/471 [01:24<00:03,  5.26it/s] 96%|█████████▋| 454/471 [01:25<00:03,  5.25it/s] 97%|█████████▋| 455/471 [01:25<00:03,  5.24it/s] 97%|█████████▋| 456/471 [01:25<00:02,  5.27it/s] 97%|█████████▋| 457/471 [01:25<00:02,  5.26it/s] 97%|█████████▋| 458/471 [01:25<00:02,  5.26it/s] 97%|█████████▋| 459/471 [01:26<00:02,  5.28it/s] 98%|█████████▊| 460/471 [01:26<00:02,  5.29it/s] 98%|█████████▊| 461/471 [01:26<00:01,  5.27it/s] 98%|█████████▊| 462/471 [01:26<00:01,  5.27it/s] 98%|█████████▊| 463/471 [01:26<00:01,  5.27it/s] 99%|█████████▊| 464/471 [01:27<00:01,  5.27it/s] 99%|█████████▊| 465/471 [01:27<00:01,  5.29it/s] 99%|█████████▉| 466/471 [01:27<00:00,  5.28it/s] 99%|█████████▉| 467/471 [01:27<00:00,  5.27it/s] 99%|█████████▉| 468/471 [01:27<00:00,  5.26it/s]100%|█████████▉| 469/471 [01:28<00:00,  5.27it/s]100%|█████████▉| 470/471 [01:28<00:00,  5.27it/s]100%|██████████| 471/471 [01:28<00:00,  5.65it/s]100%|██████████| 471/471 [01:28<00:00,  5.33it/s]
{'eval_loss': 5.414263725280762, 'eval_model_preparation_time': 0.0051, 'eval_acc': 0.15493892724375996, 'eval_runtime': 88.5064, 'eval_samples_per_second': 85.101, 'eval_steps_per_second': 5.322}
ROUND:3
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]                                              {'loss': 6.3483, 'grad_norm': 7.397646903991699, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]  5%|▌         | 2/40 [00:00<00:12,  2.98it/s]                                              {'loss': 4.7466, 'grad_norm': 4.509067535400391, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.98it/s]  8%|▊         | 3/40 [00:01<00:12,  3.00it/s]                                              {'loss': 5.1065, 'grad_norm': 6.192017555236816, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  3.00it/s] 10%|█         | 4/40 [00:01<00:12,  2.97it/s]                                              {'loss': 3.6287, 'grad_norm': 9.080497741699219, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.97it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.96it/s]                                              {'loss': 4.01, 'grad_norm': 8.684106826782227, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.96it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.97it/s]                                              {'loss': 2.7476, 'grad_norm': 13.289227485656738, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.97it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 2.1528, 'grad_norm': 11.833049774169922, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 0.0293, 'grad_norm': 1.3174784183502197, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.76it/s]                                              {'loss': 1.3404, 'grad_norm': 7.170183181762695, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.76it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.53it/s]                                               {'loss': 2.3849, 'grad_norm': 7.77219820022583, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.53it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 1.5626, 'grad_norm': 8.699723243713379, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.4516, 'grad_norm': 5.683810234069824, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.23it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.15it/s]                                               {'loss': 1.0489, 'grad_norm': 7.268163204193115, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.15it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.3358, 'grad_norm': 5.750178337097168, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.05it/s]                                               {'loss': 0.8978, 'grad_norm': 5.7001824378967285, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.05it/s]                                               {'loss': 0.103, 'grad_norm': 3.509675979614258, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.05it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s]                                               {'loss': 0.2442, 'grad_norm': 4.330314636230469, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.53it/s]                                               {'loss': 0.7295, 'grad_norm': 4.185152530670166, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.53it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.33it/s]                                               {'loss': 0.9485, 'grad_norm': 4.160255432128906, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.33it/s] 50%|█████     | 20/40 [00:06<00:06,  3.25it/s]                                               {'loss': 0.8158, 'grad_norm': 5.0270843505859375, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.25it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.441, 'grad_norm': 4.59702730178833, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s]                                               {'loss': 0.2458, 'grad_norm': 3.2457644939422607, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.5541, 'grad_norm': 6.242760181427002, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.03, 'grad_norm': 1.2478135824203491, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.07it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s]                                               {'loss': 0.1618, 'grad_norm': 2.2499358654022217, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s]                                               {'loss': 0.2107, 'grad_norm': 2.3730111122131348, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.339, 'grad_norm': 3.0165371894836426, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s] 70%|███████   | 28/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.2059, 'grad_norm': 3.7167229652404785, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.26it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.5835, 'grad_norm': 1.7825175523757935, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.1003, 'grad_norm': 1.9826653003692627, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.2302, 'grad_norm': 5.28618049621582, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 1.3215, 'grad_norm': 18.35137367248535, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.06it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s]                                               {'loss': 0.1751, 'grad_norm': 5.126740455627441, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.54it/s]                                               {'loss': 0.4473, 'grad_norm': 0.9644222259521484, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.54it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.37it/s]                                               {'loss': 0.0709, 'grad_norm': 1.8768187761306763, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.37it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.24it/s]                                               {'loss': 0.0665, 'grad_norm': 1.2109712362289429, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.24it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.1561, 'grad_norm': 2.771538019180298, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.1265, 'grad_norm': 3.202104091644287, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.095, 'grad_norm': 1.3233349323272705, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0492, 'grad_norm': 1.5103892087936401, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.08it/s]                                               {'train_runtime': 12.2542, 'train_samples_per_second': 46.107, 'train_steps_per_second': 3.264, 'train_loss': 1.1810733600053935, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.08it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.15it/s]                                              {'loss': 4.8309, 'grad_norm': 6.149817943572998, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.15it/s]  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]                                              {'loss': 5.261, 'grad_norm': 5.118565082550049, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]  8%|▊         | 3/40 [00:00<00:12,  3.02it/s]                                              {'loss': 6.1478, 'grad_norm': 6.000679016113281, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.02it/s] 10%|█         | 4/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.6103, 'grad_norm': 6.34872579574585, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.00it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.98it/s]                                              {'loss': 3.1509, 'grad_norm': 7.711430549621582, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.98it/s] 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s]                                              {'loss': 2.3408, 'grad_norm': 10.682456016540527, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 2.7699, 'grad_norm': 10.833401679992676, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 3.5832, 'grad_norm': 52.93006896972656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s]                                              {'loss': 1.5734, 'grad_norm': 7.817941665649414, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s]                                               {'loss': 1.6729, 'grad_norm': 9.06102466583252, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s]                                               {'loss': 2.0743, 'grad_norm': 10.05984115600586, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s] 30%|███       | 12/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.4609, 'grad_norm': 10.563765525817871, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.23it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s]                                               {'loss': 1.8663, 'grad_norm': 11.516060829162598, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.0786, 'grad_norm': 5.933992385864258, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.2183, 'grad_norm': 8.225271224975586, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.5065, 'grad_norm': 21.03422737121582, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.80it/s]                                               {'loss': 0.9669, 'grad_norm': 4.98905086517334, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.80it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.8805, 'grad_norm': 7.753068923950195, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s]                                               {'loss': 1.0934, 'grad_norm': 4.544414520263672, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 0.4821, 'grad_norm': 3.7965285778045654, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.1463, 'grad_norm': 3.410064458847046, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s]                                               {'loss': 0.6924, 'grad_norm': 5.83910608291626, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 0.8009, 'grad_norm': 5.208382606506348, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 0.1501, 'grad_norm': 7.445748329162598, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.08it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s]                                               {'loss': 0.421, 'grad_norm': 7.045134544372559, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s]                                               {'loss': 0.764, 'grad_norm': 4.159515857696533, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s]                                               {'loss': 0.3749, 'grad_norm': 1.8356263637542725, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s] 70%|███████   | 28/40 [00:08<00:03,  3.20it/s]                                               {'loss': 0.3183, 'grad_norm': 2.407860040664673, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.20it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.12it/s]                                               {'loss': 0.0911, 'grad_norm': 1.3763235807418823, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.12it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.06it/s]                                               {'loss': 0.3403, 'grad_norm': 3.6643028259277344, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.06it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.01it/s]                                               {'loss': 0.2077, 'grad_norm': 3.8656890392303467, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.01it/s]                                               {'loss': 0.4713, 'grad_norm': 26.276981353759766, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.01it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.64it/s]                                               {'loss': 0.5128, 'grad_norm': 1.403496265411377, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.64it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.44it/s]                                               {'loss': 0.1038, 'grad_norm': 2.179802417755127, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.44it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.29it/s]                                               {'loss': 0.2756, 'grad_norm': 1.2435355186462402, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.29it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.19it/s]                                               {'loss': 0.2008, 'grad_norm': 3.9912209510803223, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.19it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0593, 'grad_norm': 1.0731756687164307, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.13it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.2241, 'grad_norm': 1.9963091611862183, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.08it/s] 98%|█████████▊| 39/40 [00:12<00:00,  3.04it/s]                                               {'loss': 0.1997, 'grad_norm': 3.10123872756958, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:12<00:00,  3.04it/s]                                               {'loss': 0.0511, 'grad_norm': 2.895423412322998, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.04it/s]                                               {'train_runtime': 12.2817, 'train_samples_per_second': 46.004, 'train_steps_per_second': 3.257, 'train_loss': 1.3243665389716626, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.04it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:76
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]                                              {'loss': 5.8538, 'grad_norm': 5.853329658508301, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]                                              {'loss': 6.7833, 'grad_norm': 5.913208961486816, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]  8%|▊         | 3/40 [00:00<00:11,  3.09it/s]                                              {'loss': 5.4015, 'grad_norm': 7.569301128387451, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.09it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.3704, 'grad_norm': 6.105226993560791, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.643, 'grad_norm': 9.527888298034668, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 2.7912, 'grad_norm': 10.203621864318848, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 2.3525, 'grad_norm': 11.500955581665039, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 2.4695, 'grad_norm': 78.92375183105469, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s]                                              {'loss': 2.3091, 'grad_norm': 11.48619270324707, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s]                                               {'loss': 2.7882, 'grad_norm': 13.68844985961914, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s]                                               {'loss': 2.2317, 'grad_norm': 11.733388900756836, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.6325, 'grad_norm': 8.801445960998535, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.0436, 'grad_norm': 6.40208625793457, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.3708, 'grad_norm': 7.230881214141846, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.1386, 'grad_norm': 5.9349212646484375, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.6014, 'grad_norm': 26.99513053894043, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s]                                               {'loss': 0.5471, 'grad_norm': 5.337570667266846, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 1.2573, 'grad_norm': 8.243206977844238, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s]                                               {'loss': 0.9045, 'grad_norm': 4.504742622375488, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s] 50%|█████     | 20/40 [00:06<00:06,  3.31it/s]                                               {'loss': 1.1722, 'grad_norm': 5.645539283752441, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.6444, 'grad_norm': 5.553397178649902, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.4924, 'grad_norm': 4.417610168457031, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.4635, 'grad_norm': 3.4560482501983643, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.7207, 'grad_norm': 24.973249435424805, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.77it/s]                                               {'loss': 0.501, 'grad_norm': 3.7353715896606445, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.77it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.5297, 'grad_norm': 2.0976603031158447, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s]                                               {'loss': 0.1878, 'grad_norm': 2.8027799129486084, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s] 70%|███████   | 28/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.2901, 'grad_norm': 3.7351362705230713, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.22it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.16it/s]                                               {'loss': 0.4181, 'grad_norm': 6.874916076660156, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.16it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.3942, 'grad_norm': 5.477305889129639, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.3056, 'grad_norm': 3.6600182056427, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.2875, 'grad_norm': 12.109572410583496, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.65it/s]                                               {'loss': 0.2401, 'grad_norm': 2.4581408500671387, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.65it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.1418, 'grad_norm': 1.8251268863677979, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.38it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.1652, 'grad_norm': 2.9246633052825928, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.28it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.20it/s]                                               {'loss': 0.2084, 'grad_norm': 1.6261281967163086, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.20it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0649, 'grad_norm': 3.1075141429901123, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.301, 'grad_norm': 1.1077227592468262, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.09it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.05it/s]                                               {'loss': 0.0773, 'grad_norm': 1.457334041595459, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.05it/s]                                               {'loss': 0.0171, 'grad_norm': 1.7335108518600464, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.05it/s]                                               {'train_runtime': 12.2827, 'train_samples_per_second': 46.0, 'train_steps_per_second': 3.257, 'train_loss': 1.402822463028133, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.05it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.99it/s]                                              {'loss': 5.3736, 'grad_norm': 4.264393329620361, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.99it/s]  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]                                              {'loss': 5.6874, 'grad_norm': 5.553691387176514, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]  8%|▊         | 3/40 [00:00<00:12,  3.02it/s]                                              {'loss': 5.0796, 'grad_norm': 8.91508960723877, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.02it/s] 10%|█         | 4/40 [00:01<00:11,  3.01it/s]                                              {'loss': 3.55, 'grad_norm': 8.003270149230957, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.01it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s]                                              {'loss': 3.1464, 'grad_norm': 10.166224479675293, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 4.0586, 'grad_norm': 13.094402313232422, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 4.1766, 'grad_norm': 15.963278770446777, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 2.4052, 'grad_norm': 47.19271469116211, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.08it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s]                                              {'loss': 2.1593, 'grad_norm': 9.679458618164062, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.63it/s]                                               {'loss': 1.7461, 'grad_norm': 10.29709529876709, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.63it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s]                                               {'loss': 2.0277, 'grad_norm': 10.40032958984375, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s] 30%|███       | 12/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.2633, 'grad_norm': 8.9656982421875, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.33it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.7252, 'grad_norm': 8.350420951843262, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.6849, 'grad_norm': 9.598581314086914, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 1.7157, 'grad_norm': 7.737179279327393, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.001, 'grad_norm': 0.05005840212106705, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.83it/s]                                               {'loss': 1.2241, 'grad_norm': 4.277341842651367, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s]                                               {'loss': 1.0224, 'grad_norm': 4.171726226806641, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.7598, 'grad_norm': 4.759164333343506, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 1.2862, 'grad_norm': 6.257044315338135, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.9949, 'grad_norm': 5.464879989624023, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.5713, 'grad_norm': 4.827474594116211, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.5192, 'grad_norm': 4.205913066864014, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 3.5957, 'grad_norm': 101.10783386230469, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s]                                               {'loss': 0.5576, 'grad_norm': 4.365234375, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s]                                               {'loss': 0.4366, 'grad_norm': 4.788048267364502, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.1309, 'grad_norm': 3.0696871280670166, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.2437, 'grad_norm': 2.0026357173919678, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.27it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.4646, 'grad_norm': 2.335099220275879, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.3097, 'grad_norm': 2.042174816131592, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.8853, 'grad_norm': 5.47537899017334, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 1.027, 'grad_norm': 44.01755905151367, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s]                                               {'loss': 0.6896, 'grad_norm': 1.9900624752044678, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s]                                               {'loss': 0.2843, 'grad_norm': 2.647075891494751, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s]                                               {'loss': 0.1149, 'grad_norm': 1.4268479347229004, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.1225, 'grad_norm': 2.6374804973602295, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.1563, 'grad_norm': 2.7506957054138184, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.2029, 'grad_norm': 2.8775389194488525, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.1279, 'grad_norm': 1.2623577117919922, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.0169, 'grad_norm': 0.768024206161499, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.06it/s]                                               {'train_runtime': 12.109, 'train_samples_per_second': 46.66, 'train_steps_per_second': 3.303, 'train_loss': 1.5386140858317958, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.06it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
CLIENT:56
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.18it/s]                                              {'loss': 4.2682, 'grad_norm': 5.069404602050781, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.18it/s]  5%|▌         | 2/40 [00:00<00:12,  3.12it/s]                                              {'loss': 4.6565, 'grad_norm': 5.8754143714904785, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.12it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 6.0566, 'grad_norm': 6.735191345214844, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s]                                              {'loss': 4.3839, 'grad_norm': 5.93747091293335, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 2.2891, 'grad_norm': 8.101229667663574, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s]                                              {'loss': 3.4442, 'grad_norm': 10.770679473876953, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 2.3797, 'grad_norm': 14.708324432373047, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 1.3725, 'grad_norm': 35.244293212890625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.67it/s]                                              {'loss': 0.887, 'grad_norm': 5.065649032592773, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.67it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.47it/s]                                               {'loss': 1.3992, 'grad_norm': 6.964738368988037, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.47it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.3233, 'grad_norm': 6.578341484069824, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.33it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 1.2628, 'grad_norm': 5.178401470184326, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 2.0588, 'grad_norm': 12.521370887756348, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.7722, 'grad_norm': 13.519681930541992, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.445, 'grad_norm': 10.36522388458252, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.5384, 'grad_norm': 16.27326774597168, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s]                                               {'loss': 0.4682, 'grad_norm': 3.504413604736328, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s]                                               {'loss': 1.3865, 'grad_norm': 6.833639621734619, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s]                                               {'loss': 0.433, 'grad_norm': 3.6249654293060303, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s] 50%|█████     | 20/40 [00:06<00:06,  3.31it/s]                                               {'loss': 0.796, 'grad_norm': 3.3758761882781982, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.1153, 'grad_norm': 1.7922239303588867, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.3494, 'grad_norm': 3.927269220352173, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 1.084, 'grad_norm': 5.761618137359619, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.0378, 'grad_norm': 1.8852304220199585, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s]                                               {'loss': 0.3737, 'grad_norm': 1.6831905841827393, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.4375, 'grad_norm': 4.625194072723389, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.2158, 'grad_norm': 1.9872263669967651, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s] 70%|███████   | 28/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.0653, 'grad_norm': 1.193064570426941, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.27it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.2008, 'grad_norm': 1.6199535131454468, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.1207, 'grad_norm': 1.958674669265747, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.2458, 'grad_norm': 2.5661346912384033, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.4622, 'grad_norm': 19.216848373413086, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.72it/s]                                               {'loss': 0.1283, 'grad_norm': 2.537482500076294, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.72it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s]                                               {'loss': 0.0299, 'grad_norm': 0.5801792144775391, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.37it/s]                                               {'loss': 0.0429, 'grad_norm': 0.8188786506652832, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.37it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.0287, 'grad_norm': 0.9015337824821472, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.2807, 'grad_norm': 1.3600958585739136, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1669, 'grad_norm': 1.564826488494873, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0955, 'grad_norm': 1.1175357103347778, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0083, 'grad_norm': 0.35763105750083923, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.08it/s]                                               {'train_runtime': 12.2366, 'train_samples_per_second': 46.173, 'train_steps_per_second': 3.269, 'train_loss': 1.1777653788449243, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.08it/s]100%|██████████| 40/40 [00:12<00:00,  3.27it/s]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.97it/s]                                              {'loss': 6.7908, 'grad_norm': 5.059508800506592, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.97it/s]  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]                                              {'loss': 5.8084, 'grad_norm': 5.7160820960998535, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]  8%|▊         | 3/40 [00:00<00:12,  3.00it/s]                                              {'loss': 3.7942, 'grad_norm': 5.244059085845947, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  3.00it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.9691, 'grad_norm': 7.88936710357666, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.9633, 'grad_norm': 6.844093322753906, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s]                                              {'loss': 2.7556, 'grad_norm': 10.83965015411377, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 3.1789, 'grad_norm': 17.251279830932617, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 3.7657, 'grad_norm': 44.64951705932617, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s]                                              {'loss': 1.5515, 'grad_norm': 8.20509147644043, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s]                                               {'loss': 1.2201, 'grad_norm': 7.087996959686279, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s]                                               {'loss': 1.489, 'grad_norm': 8.047226905822754, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s] 30%|███       | 12/40 [00:03<00:08,  3.25it/s]                                               {'loss': 1.9508, 'grad_norm': 10.030440330505371, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.25it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 1.2832, 'grad_norm': 6.853305339813232, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s]                                               {'loss': 1.8305, 'grad_norm': 6.8717498779296875, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.3663, 'grad_norm': 8.26025676727295, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.5134, 'grad_norm': 16.611373901367188, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s]                                               {'loss': 1.4409, 'grad_norm': 6.100161075592041, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.5499, 'grad_norm': 3.86442494392395, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s]                                               {'loss': 0.3191, 'grad_norm': 3.10770845413208, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 0.4856, 'grad_norm': 3.9059741497039795, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.377, 'grad_norm': 4.89990758895874, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.3098, 'grad_norm': 6.1354241371154785, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.2831, 'grad_norm': 3.8244755268096924, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 1.3204, 'grad_norm': 38.0573844909668, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s]                                               {'loss': 0.1218, 'grad_norm': 2.3263189792633057, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s]                                               {'loss': 0.5105, 'grad_norm': 3.067747116088867, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s]                                               {'loss': 0.0897, 'grad_norm': 2.5126874446868896, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s] 70%|███████   | 28/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.0217, 'grad_norm': 0.5654765963554382, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.24it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.16it/s]                                               {'loss': 0.0568, 'grad_norm': 1.063483715057373, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.16it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.11it/s]                                               {'loss': 0.2604, 'grad_norm': 3.033045530319214, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.11it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.4899, 'grad_norm': 2.4794435501098633, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.234, 'grad_norm': 8.705172538757324, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.06it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.74it/s]                                               {'loss': 0.1316, 'grad_norm': 1.3127658367156982, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.74it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s]                                               {'loss': 0.194, 'grad_norm': 1.2510082721710205, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.34it/s]                                               {'loss': 0.2332, 'grad_norm': 0.6287232637405396, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.34it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.24it/s]                                               {'loss': 0.0416, 'grad_norm': 1.3835886716842651, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.24it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.0706, 'grad_norm': 1.8746445178985596, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.16it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.0836, 'grad_norm': 2.109916925430298, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.0729, 'grad_norm': 1.8968042135238647, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.0144, 'grad_norm': 0.7731618881225586, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.06it/s]                                               {'train_runtime': 12.2039, 'train_samples_per_second': 46.297, 'train_steps_per_second': 3.278, 'train_loss': 1.2985837589250877, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.06it/s]100%|██████████| 40/40 [00:12<00:00,  3.28it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]                                              {'loss': 4.8204, 'grad_norm': 5.609221458435059, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]                                              {'loss': 5.0015, 'grad_norm': 3.4093642234802246, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]  8%|▊         | 3/40 [00:00<00:12,  3.06it/s]                                              {'loss': 4.6804, 'grad_norm': 6.127310276031494, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.06it/s] 10%|█         | 4/40 [00:01<00:11,  3.10it/s]                                              {'loss': 4.4174, 'grad_norm': 8.807625770568848, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.10it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s]                                              {'loss': 4.2154, 'grad_norm': 10.485419273376465, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 3.5513, 'grad_norm': 9.855489730834961, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 2.7525, 'grad_norm': 13.417890548706055, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 3.33, 'grad_norm': 68.49400329589844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.05it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s]                                              {'loss': 2.2875, 'grad_norm': 16.037992477416992, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.85it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.63it/s]                                               {'loss': 2.8514, 'grad_norm': 14.482205390930176, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.63it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.48it/s]                                               {'loss': 2.4126, 'grad_norm': 12.586315155029297, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.48it/s] 30%|███       | 12/40 [00:03<00:08,  3.34it/s]                                               {'loss': 1.8542, 'grad_norm': 8.14040756225586, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.34it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.25it/s]                                               {'loss': 1.7403, 'grad_norm': 11.388261795043945, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.25it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.18it/s]                                               {'loss': 2.156, 'grad_norm': 10.364806175231934, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.18it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.4964, 'grad_norm': 7.103835582733154, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.3908, 'grad_norm': 19.05636978149414, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s]                                               {'loss': 0.8322, 'grad_norm': 4.826783180236816, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.5623, 'grad_norm': 3.449260711669922, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s]                                               {'loss': 0.8427, 'grad_norm': 6.367323875427246, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s] 50%|█████     | 20/40 [00:05<00:06,  3.33it/s]                                               {'loss': 0.5917, 'grad_norm': 4.564393997192383, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:06,  3.33it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 1.0308, 'grad_norm': 6.087684154510498, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.9024, 'grad_norm': 6.864089012145996, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.949, 'grad_norm': 10.579415321350098, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.5021, 'grad_norm': 19.762271881103516, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.13it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s]                                               {'loss': 0.1787, 'grad_norm': 4.018615245819092, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.64it/s]                                               {'loss': 0.6601, 'grad_norm': 4.103259563446045, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.64it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.50it/s]                                               {'loss': 0.9296, 'grad_norm': 4.401895046234131, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.50it/s] 70%|███████   | 28/40 [00:08<00:03,  3.35it/s]                                               {'loss': 0.1322, 'grad_norm': 2.166508197784424, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.35it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.1923, 'grad_norm': 2.448594808578491, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.1351, 'grad_norm': 2.315227508544922, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.2229, 'grad_norm': 2.7105863094329834, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.0169, 'grad_norm': 1.2432832717895508, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s]                                               {'loss': 0.4424, 'grad_norm': 0.5117092728614807, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s]                                               {'loss': 0.0266, 'grad_norm': 0.44898712635040283, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s]                                               {'loss': 0.2182, 'grad_norm': 3.055621385574341, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s]                                               {'loss': 0.3472, 'grad_norm': 0.5271368026733398, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.0446, 'grad_norm': 1.1757121086120605, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.2408, 'grad_norm': 1.4598877429962158, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.1714, 'grad_norm': 2.7545716762542725, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.0083, 'grad_norm': 0.6264060139656067, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.11it/s]                                               {'train_runtime': 12.0205, 'train_samples_per_second': 47.003, 'train_steps_per_second': 3.328, 'train_loss': 1.4534632883500307, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.11it/s]100%|██████████| 40/40 [00:12<00:00,  3.33it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]                                              {'loss': 3.2003, 'grad_norm': 4.359708786010742, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]  5%|▌         | 2/40 [00:00<00:11,  3.17it/s]                                              {'loss': 5.0007, 'grad_norm': 5.555512428283691, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:11,  3.17it/s]  8%|▊         | 3/40 [00:00<00:12,  3.08it/s]                                              {'loss': 4.0718, 'grad_norm': 5.838133811950684, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.08it/s] 10%|█         | 4/40 [00:01<00:11,  3.01it/s]                                              {'loss': 3.0847, 'grad_norm': 7.293623924255371, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.01it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 2.6609, 'grad_norm': 6.132326126098633, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.5136, 'grad_norm': 8.668610572814941, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 2.7645, 'grad_norm': 13.942123413085938, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 0.1383, 'grad_norm': 6.440080642700195, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:07,  3.88it/s]                                              {'loss': 2.0183, 'grad_norm': 13.92300796508789, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:07,  3.88it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.62it/s]                                               {'loss': 2.0982, 'grad_norm': 12.309168815612793, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.62it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s]                                               {'loss': 0.7205, 'grad_norm': 7.238076210021973, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s] 30%|███       | 12/40 [00:03<00:08,  3.30it/s]                                               {'loss': 0.5971, 'grad_norm': 3.993143320083618, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.30it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.22it/s]                                               {'loss': 1.8538, 'grad_norm': 8.048674583435059, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.22it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s]                                               {'loss': 1.4734, 'grad_norm': 8.227009773254395, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.1264, 'grad_norm': 4.5806450843811035, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 0.6288, 'grad_norm': 14.673990249633789, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.11it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.89it/s]                                               {'loss': 1.1411, 'grad_norm': 4.536185264587402, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.89it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.63it/s]                                               {'loss': 0.5504, 'grad_norm': 4.413808345794678, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.63it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s]                                               {'loss': 0.4938, 'grad_norm': 4.013799667358398, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s] 50%|█████     | 20/40 [00:06<00:06,  3.33it/s]                                               {'loss': 0.4617, 'grad_norm': 2.808964252471924, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.33it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.24it/s]                                               {'loss': 0.1818, 'grad_norm': 4.578943729400635, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.24it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.6862, 'grad_norm': 4.8057074546813965, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.18it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.4376, 'grad_norm': 4.358611583709717, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.1188, 'grad_norm': 5.024050235748291, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.14it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.87it/s]                                               {'loss': 0.2034, 'grad_norm': 3.4393506050109863, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.87it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s]                                               {'loss': 0.2395, 'grad_norm': 3.2287607192993164, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.093, 'grad_norm': 1.5229400396347046, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.1855, 'grad_norm': 3.867225408554077, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.221, 'grad_norm': 2.572061777114868, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s]                                               {'loss': 0.3649, 'grad_norm': 1.4512579441070557, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.1667, 'grad_norm': 1.485222339630127, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.0012, 'grad_norm': 0.0622422881424427, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s]                                               {'loss': 0.0417, 'grad_norm': 0.5747784376144409, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s]                                               {'loss': 0.2943, 'grad_norm': 1.4649163484573364, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s]                                               {'loss': 0.0566, 'grad_norm': 0.9419511556625366, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.0692, 'grad_norm': 1.3575152158737183, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.1414, 'grad_norm': 1.3670076131820679, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0757, 'grad_norm': 1.5171425342559814, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.0536, 'grad_norm': 1.0915422439575195, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.1096, 'grad_norm': 11.47914981842041, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.10it/s]                                               {'train_runtime': 12.0673, 'train_samples_per_second': 46.821, 'train_steps_per_second': 3.315, 'train_loss': 1.0084960252366728, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.10it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:60
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 4.953, 'grad_norm': 5.147444725036621, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]                                              {'loss': 6.9255, 'grad_norm': 6.12667989730835, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]  8%|▊         | 3/40 [00:00<00:12,  3.04it/s]                                              {'loss': 5.8934, 'grad_norm': 8.654839515686035, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.04it/s] 10%|█         | 4/40 [00:01<00:11,  3.03it/s]                                              {'loss': 4.2217, 'grad_norm': 8.544180870056152, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.03it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.3276, 'grad_norm': 11.207202911376953, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.6414, 'grad_norm': 13.150882720947266, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 2.2508, 'grad_norm': 10.845595359802246, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 0.1084, 'grad_norm': 8.077519416809082, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s]                                              {'loss': 1.9776, 'grad_norm': 7.605221748352051, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.51it/s]                                               {'loss': 1.1583, 'grad_norm': 10.66713809967041, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.51it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 1.2036, 'grad_norm': 8.499874114990234, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.25it/s]                                               {'loss': 1.494, 'grad_norm': 12.7347993850708, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.25it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s]                                               {'loss': 1.6201, 'grad_norm': 10.338234901428223, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.2644, 'grad_norm': 8.628007888793945, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.9133, 'grad_norm': 6.178318023681641, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.0495, 'grad_norm': 2.0299017429351807, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s]                                               {'loss': 1.1438, 'grad_norm': 6.008635520935059, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s]                                               {'loss': 0.7075, 'grad_norm': 3.6686670780181885, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s]                                               {'loss': 0.3354, 'grad_norm': 4.565309047698975, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s] 50%|█████     | 20/40 [00:06<00:06,  3.32it/s]                                               {'loss': 0.1865, 'grad_norm': 3.4811880588531494, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.32it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.0918, 'grad_norm': 2.016841173171997, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.0643, 'grad_norm': 1.3539236783981323, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 0.6013, 'grad_norm': 4.775003910064697, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 4.5522, 'grad_norm': 77.78874206542969, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.13it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s]                                               {'loss': 0.4155, 'grad_norm': 4.834778785705566, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s]                                               {'loss': 0.2531, 'grad_norm': 491.15582275390625, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.1064, 'grad_norm': 2.690525770187378, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.3855, 'grad_norm': 3.8140385150909424, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.32it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.1577, 'grad_norm': 3.6295034885406494, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.2463, 'grad_norm': 4.374474048614502, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.1326, 'grad_norm': 1.6511324644088745, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.0123, 'grad_norm': 0.5809532999992371, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.13it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.89it/s]                                               {'loss': 0.0263, 'grad_norm': 0.5246460437774658, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.89it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s]                                               {'loss': 0.1728, 'grad_norm': 1.5849065780639648, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s]                                               {'loss': 0.0945, 'grad_norm': 1.316681981086731, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.1853, 'grad_norm': 4.793582916259766, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.0722, 'grad_norm': 1.7055336236953735, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0884, 'grad_norm': 2.510439872741699, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.052, 'grad_norm': 1.2832012176513672, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.1175, 'grad_norm': 4.571225643157959, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 12.0322, 'train_samples_per_second': 46.957, 'train_steps_per_second': 3.324, 'train_loss': 1.2550936648854987, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.12it/s]100%|██████████| 40/40 [00:12<00:00,  3.32it/s]
CLIENT:67
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]                                              {'loss': 7.2245, 'grad_norm': 5.86271858215332, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]                                              {'loss': 5.7105, 'grad_norm': 6.644410610198975, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]  8%|▊         | 3/40 [00:00<00:12,  3.04it/s]                                              {'loss': 4.6438, 'grad_norm': 7.571371078491211, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.04it/s] 10%|█         | 4/40 [00:01<00:11,  3.09it/s]                                              {'loss': 3.7118, 'grad_norm': 9.026165962219238, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.09it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s]                                              {'loss': 4.0822, 'grad_norm': 9.706503868103027, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.09it/s]                                              {'loss': 2.9915, 'grad_norm': 10.793364524841309, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.09it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.09it/s]                                              {'loss': 3.0232, 'grad_norm': 10.36895751953125, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.09it/s]                                              {'loss': 0.0056, 'grad_norm': 0.21513566374778748, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.09it/s] 22%|██▎       | 9/40 [00:02<00:07,  3.91it/s]                                              {'loss': 2.4875, 'grad_norm': 9.925683975219727, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:07,  3.91it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.64it/s]                                               {'loss': 1.6547, 'grad_norm': 6.52968168258667, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.64it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.48it/s]                                               {'loss': 0.9862, 'grad_norm': 6.780008316040039, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.48it/s] 30%|███       | 12/40 [00:03<00:08,  3.34it/s]                                               {'loss': 1.432, 'grad_norm': 10.294161796569824, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.34it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.1936, 'grad_norm': 7.775500297546387, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.733, 'grad_norm': 9.659708023071289, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 1.0804, 'grad_norm': 6.598761558532715, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 0.0066, 'grad_norm': 0.25171348452568054, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.13it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.83it/s]                                               {'loss': 0.4533, 'grad_norm': 9.201127052307129, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s]                                               {'loss': 0.8064, 'grad_norm': 4.235265254974365, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s]                                               {'loss': 0.6601, 'grad_norm': 4.426144599914551, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 1.4034, 'grad_norm': 5.263221263885498, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.3719, 'grad_norm': 3.2846176624298096, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.6199, 'grad_norm': 4.192973613739014, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.9106, 'grad_norm': 4.8923020362854, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 1.043, 'grad_norm': 65.2859115600586, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.14it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.87it/s]                                               {'loss': 0.25, 'grad_norm': 6.152434349060059, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.87it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s]                                               {'loss': 0.4339, 'grad_norm': 7.280030727386475, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s]                                               {'loss': 0.5752, 'grad_norm': 4.84530782699585, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s] 70%|███████   | 28/40 [00:08<00:03,  3.33it/s]                                               {'loss': 0.3289, 'grad_norm': 3.222485303878784, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.33it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.7497, 'grad_norm': 4.24394416809082, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s]                                               {'loss': 0.372, 'grad_norm': 3.8333804607391357, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 1.0241, 'grad_norm': 4.349005222320557, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.175, 'grad_norm': 13.361346244812012, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.16it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.87it/s]                                               {'loss': 0.1019, 'grad_norm': 1.5049570798873901, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.87it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.64it/s]                                               {'loss': 0.2603, 'grad_norm': 7.449164867401123, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.64it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.46it/s]                                               {'loss': 0.303, 'grad_norm': 2.1021595001220703, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.46it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.33it/s]                                               {'loss': 0.0976, 'grad_norm': 2.16709303855896, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.33it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.25it/s]                                               {'loss': 0.4002, 'grad_norm': 2.13301944732666, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.25it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.2683, 'grad_norm': 6.208298206329346, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.4911, 'grad_norm': 1.213399052619934, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.0109, 'grad_norm': 0.41108977794647217, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.16it/s]                                               {'train_runtime': 11.9429, 'train_samples_per_second': 47.308, 'train_steps_per_second': 3.349, 'train_loss': 1.3519483819021842, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.16it/s]100%|██████████| 40/40 [00:11<00:00,  3.35it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 10.95it/s]  1%|          | 4/471 [00:00<01:07,  6.93it/s]  1%|          | 5/471 [00:00<01:12,  6.44it/s]  1%|▏         | 6/471 [00:00<01:16,  6.10it/s]  1%|▏         | 7/471 [00:01<01:18,  5.88it/s]  2%|▏         | 8/471 [00:01<01:20,  5.76it/s]  2%|▏         | 9/471 [00:01<01:21,  5.68it/s]  2%|▏         | 10/471 [00:01<01:21,  5.64it/s]  2%|▏         | 11/471 [00:01<01:22,  5.58it/s]  3%|▎         | 12/471 [00:02<01:22,  5.55it/s]  3%|▎         | 13/471 [00:02<01:23,  5.51it/s]  3%|▎         | 14/471 [00:02<01:23,  5.49it/s]  3%|▎         | 15/471 [00:02<01:22,  5.50it/s]  3%|▎         | 16/471 [00:02<01:22,  5.49it/s]  4%|▎         | 17/471 [00:02<01:22,  5.49it/s]  4%|▍         | 18/471 [00:03<01:22,  5.47it/s]  4%|▍         | 19/471 [00:03<01:22,  5.47it/s]  4%|▍         | 20/471 [00:03<01:22,  5.47it/s]  4%|▍         | 21/471 [00:03<01:22,  5.46it/s]  5%|▍         | 22/471 [00:03<01:22,  5.45it/s]  5%|▍         | 23/471 [00:04<01:22,  5.45it/s]  5%|▌         | 24/471 [00:04<01:22,  5.44it/s]  5%|▌         | 25/471 [00:04<01:21,  5.47it/s]  6%|▌         | 26/471 [00:04<01:21,  5.47it/s]  6%|▌         | 27/471 [00:04<01:21,  5.46it/s]  6%|▌         | 28/471 [00:04<01:21,  5.46it/s]  6%|▌         | 29/471 [00:05<01:21,  5.45it/s]  6%|▋         | 30/471 [00:05<01:21,  5.44it/s]  7%|▋         | 31/471 [00:05<01:20,  5.45it/s]  7%|▋         | 32/471 [00:05<01:20,  5.46it/s]  7%|▋         | 33/471 [00:05<01:19,  5.50it/s]  7%|▋         | 34/471 [00:06<01:19,  5.49it/s]  7%|▋         | 35/471 [00:06<01:19,  5.47it/s]  8%|▊         | 36/471 [00:06<01:19,  5.47it/s]  8%|▊         | 37/471 [00:06<01:19,  5.45it/s]  8%|▊         | 38/471 [00:06<01:19,  5.45it/s]  8%|▊         | 39/471 [00:06<01:19,  5.45it/s]  8%|▊         | 40/471 [00:07<01:18,  5.46it/s]  9%|▊         | 41/471 [00:07<01:18,  5.47it/s]  9%|▉         | 42/471 [00:07<01:18,  5.44it/s]  9%|▉         | 43/471 [00:07<01:18,  5.44it/s]  9%|▉         | 44/471 [00:07<01:18,  5.46it/s] 10%|▉         | 45/471 [00:08<01:18,  5.45it/s] 10%|▉         | 46/471 [00:08<01:17,  5.45it/s] 10%|▉         | 47/471 [00:08<01:17,  5.46it/s] 10%|█         | 48/471 [00:08<01:17,  5.46it/s] 10%|█         | 49/471 [00:08<01:17,  5.45it/s] 11%|█         | 50/471 [00:08<01:17,  5.45it/s] 11%|█         | 51/471 [00:09<01:17,  5.44it/s] 11%|█         | 52/471 [00:09<01:16,  5.46it/s] 11%|█▏        | 53/471 [00:09<01:17,  5.42it/s] 11%|█▏        | 54/471 [00:09<01:16,  5.43it/s] 12%|█▏        | 55/471 [00:09<01:16,  5.43it/s] 12%|█▏        | 56/471 [00:10<01:16,  5.42it/s] 12%|█▏        | 57/471 [00:10<01:16,  5.44it/s] 12%|█▏        | 58/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 59/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 60/471 [00:10<01:15,  5.45it/s] 13%|█▎        | 61/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 62/471 [00:11<01:15,  5.43it/s] 13%|█▎        | 63/471 [00:11<01:15,  5.43it/s] 14%|█▎        | 64/471 [00:11<01:14,  5.44it/s] 14%|█▍        | 65/471 [00:11<01:14,  5.43it/s] 14%|█▍        | 66/471 [00:11<01:14,  5.43it/s] 14%|█▍        | 67/471 [00:12<01:14,  5.41it/s] 14%|█▍        | 68/471 [00:12<01:14,  5.42it/s] 15%|█▍        | 69/471 [00:12<01:14,  5.43it/s] 15%|█▍        | 70/471 [00:12<01:14,  5.41it/s] 15%|█▌        | 71/471 [00:12<01:13,  5.41it/s] 15%|█▌        | 72/471 [00:13<01:13,  5.41it/s] 15%|█▌        | 73/471 [00:13<01:13,  5.42it/s] 16%|█▌        | 74/471 [00:13<01:13,  5.43it/s] 16%|█▌        | 75/471 [00:13<01:13,  5.42it/s] 16%|█▌        | 76/471 [00:13<01:12,  5.42it/s] 16%|█▋        | 77/471 [00:13<01:12,  5.42it/s] 17%|█▋        | 78/471 [00:14<01:12,  5.42it/s] 17%|█▋        | 79/471 [00:14<01:12,  5.41it/s] 17%|█▋        | 80/471 [00:14<01:12,  5.41it/s] 17%|█▋        | 81/471 [00:14<01:11,  5.42it/s] 17%|█▋        | 82/471 [00:14<01:11,  5.44it/s] 18%|█▊        | 83/471 [00:15<01:11,  5.42it/s] 18%|█▊        | 84/471 [00:15<01:11,  5.42it/s] 18%|█▊        | 85/471 [00:15<01:11,  5.40it/s] 18%|█▊        | 86/471 [00:15<01:10,  5.42it/s] 18%|█▊        | 87/471 [00:15<01:10,  5.44it/s] 19%|█▊        | 88/471 [00:15<01:10,  5.44it/s] 19%|█▉        | 89/471 [00:16<01:10,  5.43it/s] 19%|█▉        | 90/471 [00:16<01:10,  5.41it/s] 19%|█▉        | 91/471 [00:16<01:09,  5.44it/s] 20%|█▉        | 92/471 [00:16<01:09,  5.45it/s] 20%|█▉        | 93/471 [00:16<01:09,  5.44it/s] 20%|█▉        | 94/471 [00:17<01:09,  5.45it/s] 20%|██        | 95/471 [00:17<01:08,  5.45it/s] 20%|██        | 96/471 [00:17<01:08,  5.44it/s] 21%|██        | 97/471 [00:17<01:08,  5.44it/s] 21%|██        | 98/471 [00:17<01:08,  5.43it/s] 21%|██        | 99/471 [00:17<01:08,  5.45it/s] 21%|██        | 100/471 [00:18<01:08,  5.45it/s] 21%|██▏       | 101/471 [00:18<01:07,  5.45it/s] 22%|██▏       | 102/471 [00:18<01:07,  5.46it/s] 22%|██▏       | 103/471 [00:18<01:07,  5.44it/s] 22%|██▏       | 104/471 [00:18<01:07,  5.42it/s] 22%|██▏       | 105/471 [00:19<01:07,  5.41it/s] 23%|██▎       | 106/471 [00:19<01:07,  5.44it/s] 23%|██▎       | 107/471 [00:19<01:06,  5.47it/s] 23%|██▎       | 108/471 [00:19<01:06,  5.45it/s] 23%|██▎       | 109/471 [00:19<01:06,  5.44it/s] 23%|██▎       | 110/471 [00:20<01:06,  5.46it/s] 24%|██▎       | 111/471 [00:20<01:06,  5.43it/s] 24%|██▍       | 112/471 [00:20<01:06,  5.44it/s] 24%|██▍       | 113/471 [00:20<01:05,  5.47it/s] 24%|██▍       | 114/471 [00:20<01:05,  5.45it/s] 24%|██▍       | 115/471 [00:20<01:05,  5.45it/s] 25%|██▍       | 116/471 [00:21<01:05,  5.42it/s] 25%|██▍       | 117/471 [00:21<01:05,  5.43it/s] 25%|██▌       | 118/471 [00:21<01:05,  5.42it/s] 25%|██▌       | 119/471 [00:21<01:04,  5.42it/s] 25%|██▌       | 120/471 [00:21<01:04,  5.41it/s] 26%|██▌       | 121/471 [00:22<01:04,  5.42it/s] 26%|██▌       | 122/471 [00:22<01:04,  5.43it/s] 26%|██▌       | 123/471 [00:22<01:04,  5.43it/s] 26%|██▋       | 124/471 [00:22<01:03,  5.42it/s] 27%|██▋       | 125/471 [00:22<01:04,  5.40it/s] 27%|██▋       | 126/471 [00:22<01:03,  5.41it/s] 27%|██▋       | 127/471 [00:23<01:03,  5.40it/s] 27%|██▋       | 128/471 [00:23<01:03,  5.42it/s] 27%|██▋       | 129/471 [00:23<01:03,  5.42it/s] 28%|██▊       | 130/471 [00:23<01:02,  5.42it/s] 28%|██▊       | 131/471 [00:23<01:02,  5.40it/s] 28%|██▊       | 132/471 [00:24<01:02,  5.40it/s] 28%|██▊       | 133/471 [00:24<01:02,  5.40it/s] 28%|██▊       | 134/471 [00:24<01:02,  5.39it/s] 29%|██▊       | 135/471 [00:24<01:02,  5.38it/s] 29%|██▉       | 136/471 [00:24<01:02,  5.39it/s] 29%|██▉       | 137/471 [00:25<01:01,  5.40it/s] 29%|██▉       | 138/471 [00:25<01:01,  5.40it/s] 30%|██▉       | 139/471 [00:25<01:01,  5.42it/s] 30%|██▉       | 140/471 [00:25<01:01,  5.39it/s] 30%|██▉       | 141/471 [00:25<01:00,  5.42it/s] 30%|███       | 142/471 [00:25<01:00,  5.41it/s] 30%|███       | 143/471 [00:26<01:00,  5.42it/s] 31%|███       | 144/471 [00:26<01:00,  5.40it/s] 31%|███       | 145/471 [00:26<01:00,  5.42it/s] 31%|███       | 146/471 [00:26<01:00,  5.41it/s] 31%|███       | 147/471 [00:26<01:00,  5.40it/s] 31%|███▏      | 148/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 149/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 150/471 [00:27<00:59,  5.37it/s] 32%|███▏      | 151/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 152/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 153/471 [00:27<00:59,  5.37it/s] 33%|███▎      | 154/471 [00:28<00:58,  5.41it/s] 33%|███▎      | 155/471 [00:28<00:58,  5.40it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.43it/s] 33%|███▎      | 157/471 [00:28<00:57,  5.42it/s] 34%|███▎      | 158/471 [00:28<00:57,  5.42it/s] 34%|███▍      | 159/471 [00:29<00:57,  5.43it/s] 34%|███▍      | 160/471 [00:29<00:57,  5.41it/s] 34%|███▍      | 161/471 [00:29<00:57,  5.41it/s] 34%|███▍      | 162/471 [00:29<00:57,  5.39it/s] 35%|███▍      | 163/471 [00:29<00:57,  5.37it/s] 35%|███▍      | 164/471 [00:30<00:56,  5.40it/s] 35%|███▌      | 165/471 [00:30<00:56,  5.39it/s] 35%|███▌      | 166/471 [00:30<00:56,  5.39it/s] 35%|███▌      | 167/471 [00:30<00:56,  5.38it/s] 36%|███▌      | 168/471 [00:30<00:56,  5.37it/s] 36%|███▌      | 169/471 [00:30<00:56,  5.38it/s] 36%|███▌      | 170/471 [00:31<00:55,  5.39it/s] 36%|███▋      | 171/471 [00:31<00:55,  5.37it/s] 37%|███▋      | 172/471 [00:31<00:55,  5.40it/s] 37%|███▋      | 173/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 174/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 175/471 [00:32<00:54,  5.38it/s] 37%|███▋      | 176/471 [00:32<00:54,  5.40it/s] 38%|███▊      | 177/471 [00:32<00:54,  5.37it/s] 38%|███▊      | 178/471 [00:32<00:54,  5.38it/s] 38%|███▊      | 179/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 180/471 [00:32<00:54,  5.38it/s] 38%|███▊      | 181/471 [00:33<00:53,  5.39it/s] 39%|███▊      | 182/471 [00:33<00:53,  5.37it/s] 39%|███▉      | 183/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 184/471 [00:33<00:53,  5.39it/s] 39%|███▉      | 185/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 186/471 [00:34<00:53,  5.37it/s] 40%|███▉      | 187/471 [00:34<00:52,  5.36it/s] 40%|███▉      | 188/471 [00:34<00:52,  5.35it/s] 40%|████      | 189/471 [00:34<00:52,  5.38it/s] 40%|████      | 190/471 [00:34<00:52,  5.37it/s] 41%|████      | 191/471 [00:35<00:52,  5.36it/s] 41%|████      | 192/471 [00:35<00:51,  5.37it/s] 41%|████      | 193/471 [00:35<00:51,  5.40it/s] 41%|████      | 194/471 [00:35<00:51,  5.38it/s] 41%|████▏     | 195/471 [00:35<00:51,  5.37it/s] 42%|████▏     | 196/471 [00:35<00:51,  5.37it/s] 42%|████▏     | 197/471 [00:36<00:50,  5.39it/s] 42%|████▏     | 198/471 [00:36<00:50,  5.41it/s] 42%|████▏     | 199/471 [00:36<00:50,  5.38it/s] 42%|████▏     | 200/471 [00:36<00:50,  5.37it/s] 43%|████▎     | 201/471 [00:36<00:50,  5.40it/s] 43%|████▎     | 202/471 [00:37<00:50,  5.38it/s] 43%|████▎     | 203/471 [00:37<00:49,  5.39it/s] 43%|████▎     | 204/471 [00:37<00:49,  5.37it/s] 44%|████▎     | 205/471 [00:37<00:49,  5.38it/s] 44%|████▎     | 206/471 [00:37<00:49,  5.38it/s] 44%|████▍     | 207/471 [00:37<00:49,  5.37it/s] 44%|████▍     | 208/471 [00:38<00:48,  5.40it/s] 44%|████▍     | 209/471 [00:38<00:48,  5.40it/s] 45%|████▍     | 210/471 [00:38<00:48,  5.41it/s] 45%|████▍     | 211/471 [00:38<00:48,  5.39it/s] 45%|████▌     | 212/471 [00:38<00:48,  5.39it/s] 45%|████▌     | 213/471 [00:39<00:47,  5.38it/s] 45%|████▌     | 214/471 [00:39<00:47,  5.37it/s] 46%|████▌     | 215/471 [00:39<00:47,  5.38it/s] 46%|████▌     | 216/471 [00:39<00:47,  5.36it/s] 46%|████▌     | 217/471 [00:39<00:47,  5.35it/s] 46%|████▋     | 218/471 [00:40<00:47,  5.34it/s] 46%|████▋     | 219/471 [00:40<00:47,  5.35it/s] 47%|████▋     | 220/471 [00:40<00:46,  5.34it/s] 47%|████▋     | 221/471 [00:40<00:46,  5.34it/s] 47%|████▋     | 222/471 [00:40<00:46,  5.37it/s] 47%|████▋     | 223/471 [00:40<00:46,  5.37it/s] 48%|████▊     | 224/471 [00:41<00:46,  5.36it/s] 48%|████▊     | 225/471 [00:41<00:45,  5.37it/s] 48%|████▊     | 226/471 [00:41<00:45,  5.35it/s] 48%|████▊     | 227/471 [00:41<00:45,  5.35it/s] 48%|████▊     | 228/471 [00:41<00:45,  5.35it/s] 49%|████▊     | 229/471 [00:42<00:45,  5.35it/s] 49%|████▉     | 230/471 [00:42<00:45,  5.34it/s] 49%|████▉     | 231/471 [00:42<00:44,  5.33it/s] 49%|████▉     | 232/471 [00:42<00:44,  5.36it/s] 49%|████▉     | 233/471 [00:42<00:44,  5.35it/s] 50%|████▉     | 234/471 [00:43<00:44,  5.34it/s] 50%|████▉     | 235/471 [00:43<00:44,  5.33it/s] 50%|█████     | 236/471 [00:43<00:43,  5.36it/s] 50%|█████     | 237/471 [00:43<00:43,  5.35it/s] 51%|█████     | 238/471 [00:43<00:43,  5.34it/s] 51%|█████     | 239/471 [00:43<00:43,  5.36it/s] 51%|█████     | 240/471 [00:44<00:43,  5.34it/s] 51%|█████     | 241/471 [00:44<00:43,  5.33it/s] 51%|█████▏    | 242/471 [00:44<00:42,  5.34it/s] 52%|█████▏    | 243/471 [00:44<00:42,  5.35it/s] 52%|█████▏    | 244/471 [00:44<00:42,  5.35it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.34it/s] 52%|█████▏    | 246/471 [00:45<00:42,  5.35it/s] 52%|█████▏    | 247/471 [00:45<00:41,  5.36it/s] 53%|█████▎    | 248/471 [00:45<00:41,  5.35it/s] 53%|█████▎    | 249/471 [00:45<00:41,  5.34it/s] 53%|█████▎    | 250/471 [00:46<00:41,  5.34it/s] 53%|█████▎    | 251/471 [00:46<00:41,  5.33it/s] 54%|█████▎    | 252/471 [00:46<00:41,  5.33it/s] 54%|█████▎    | 253/471 [00:46<00:40,  5.33it/s] 54%|█████▍    | 254/471 [00:46<00:40,  5.32it/s] 54%|█████▍    | 255/471 [00:46<00:40,  5.33it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.31it/s] 55%|█████▍    | 257/471 [00:47<00:40,  5.30it/s] 55%|█████▍    | 258/471 [00:47<00:40,  5.31it/s] 55%|█████▍    | 259/471 [00:47<00:39,  5.31it/s] 55%|█████▌    | 260/471 [00:47<00:39,  5.32it/s] 55%|█████▌    | 261/471 [00:48<00:39,  5.32it/s] 56%|█████▌    | 262/471 [00:48<00:39,  5.32it/s] 56%|█████▌    | 263/471 [00:48<00:39,  5.31it/s] 56%|█████▌    | 264/471 [00:48<00:38,  5.32it/s] 56%|█████▋    | 265/471 [00:48<00:38,  5.32it/s] 56%|█████▋    | 266/471 [00:49<00:38,  5.32it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.31it/s] 57%|█████▋    | 268/471 [00:49<00:38,  5.31it/s] 57%|█████▋    | 269/471 [00:49<00:37,  5.32it/s] 57%|█████▋    | 270/471 [00:49<00:37,  5.33it/s] 58%|█████▊    | 271/471 [00:49<00:37,  5.33it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.33it/s] 58%|█████▊    | 273/471 [00:50<00:37,  5.33it/s] 58%|█████▊    | 274/471 [00:50<00:36,  5.37it/s] 58%|█████▊    | 275/471 [00:50<00:36,  5.37it/s] 59%|█████▊    | 276/471 [00:50<00:36,  5.36it/s] 59%|█████▉    | 277/471 [00:51<00:36,  5.34it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.31it/s] 59%|█████▉    | 279/471 [00:51<00:36,  5.33it/s] 59%|█████▉    | 280/471 [00:51<00:35,  5.34it/s] 60%|█████▉    | 281/471 [00:51<00:35,  5.35it/s] 60%|█████▉    | 282/471 [00:52<00:35,  5.34it/s] 60%|██████    | 283/471 [00:52<00:35,  5.32it/s] 60%|██████    | 284/471 [00:52<00:35,  5.31it/s] 61%|██████    | 285/471 [00:52<00:34,  5.32it/s] 61%|██████    | 286/471 [00:52<00:34,  5.32it/s] 61%|██████    | 287/471 [00:52<00:34,  5.33it/s] 61%|██████    | 288/471 [00:53<00:34,  5.32it/s] 61%|██████▏   | 289/471 [00:53<00:34,  5.33it/s] 62%|██████▏   | 290/471 [00:53<00:33,  5.33it/s] 62%|██████▏   | 291/471 [00:53<00:33,  5.34it/s] 62%|██████▏   | 292/471 [00:53<00:33,  5.33it/s] 62%|██████▏   | 293/471 [00:54<00:33,  5.35it/s] 62%|██████▏   | 294/471 [00:54<00:33,  5.36it/s] 63%|██████▎   | 295/471 [00:54<00:32,  5.35it/s] 63%|██████▎   | 296/471 [00:54<00:32,  5.37it/s] 63%|██████▎   | 297/471 [00:54<00:32,  5.36it/s] 63%|██████▎   | 298/471 [00:55<00:32,  5.34it/s] 63%|██████▎   | 299/471 [00:55<00:32,  5.34it/s] 64%|██████▎   | 300/471 [00:55<00:32,  5.34it/s] 64%|██████▍   | 301/471 [00:55<00:31,  5.34it/s] 64%|██████▍   | 302/471 [00:55<00:31,  5.33it/s] 64%|██████▍   | 303/471 [00:55<00:31,  5.33it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.36it/s] 65%|██████▍   | 305/471 [00:56<00:31,  5.35it/s] 65%|██████▍   | 306/471 [00:56<00:30,  5.33it/s] 65%|██████▌   | 307/471 [00:56<00:30,  5.32it/s] 65%|██████▌   | 308/471 [00:56<00:30,  5.31it/s] 66%|██████▌   | 309/471 [00:57<00:30,  5.32it/s] 66%|██████▌   | 310/471 [00:57<00:30,  5.33it/s] 66%|██████▌   | 311/471 [00:57<00:30,  5.32it/s] 66%|██████▌   | 312/471 [00:57<00:29,  5.33it/s] 66%|██████▋   | 313/471 [00:57<00:29,  5.34it/s] 67%|██████▋   | 314/471 [00:58<00:29,  5.33it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.34it/s] 67%|██████▋   | 316/471 [00:58<00:28,  5.35it/s] 67%|██████▋   | 317/471 [00:58<00:28,  5.36it/s] 68%|██████▊   | 318/471 [00:58<00:28,  5.34it/s] 68%|██████▊   | 319/471 [00:58<00:28,  5.32it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.32it/s] 68%|██████▊   | 321/471 [00:59<00:28,  5.31it/s] 68%|██████▊   | 322/471 [00:59<00:27,  5.33it/s] 69%|██████▊   | 323/471 [00:59<00:27,  5.32it/s] 69%|██████▉   | 324/471 [00:59<00:27,  5.30it/s] 69%|██████▉   | 325/471 [01:00<00:27,  5.30it/s] 69%|██████▉   | 326/471 [01:00<00:27,  5.31it/s] 69%|██████▉   | 327/471 [01:00<00:26,  5.34it/s] 70%|██████▉   | 328/471 [01:00<00:26,  5.33it/s] 70%|██████▉   | 329/471 [01:00<00:26,  5.31it/s] 70%|███████   | 330/471 [01:01<00:26,  5.32it/s] 70%|███████   | 331/471 [01:01<00:26,  5.32it/s] 70%|███████   | 332/471 [01:01<00:26,  5.31it/s] 71%|███████   | 333/471 [01:01<00:25,  5.32it/s] 71%|███████   | 334/471 [01:01<00:25,  5.32it/s] 71%|███████   | 335/471 [01:01<00:25,  5.31it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.31it/s] 72%|███████▏  | 337/471 [01:02<00:25,  5.32it/s] 72%|███████▏  | 338/471 [01:02<00:24,  5.33it/s] 72%|███████▏  | 339/471 [01:02<00:24,  5.31it/s] 72%|███████▏  | 340/471 [01:02<00:24,  5.32it/s] 72%|███████▏  | 341/471 [01:03<00:24,  5.32it/s] 73%|███████▎  | 342/471 [01:03<00:24,  5.33it/s] 73%|███████▎  | 343/471 [01:03<00:24,  5.31it/s] 73%|███████▎  | 344/471 [01:03<00:23,  5.33it/s] 73%|███████▎  | 345/471 [01:03<00:23,  5.32it/s] 73%|███████▎  | 346/471 [01:04<00:23,  5.31it/s] 74%|███████▎  | 347/471 [01:04<00:23,  5.32it/s] 74%|███████▍  | 348/471 [01:04<00:23,  5.32it/s] 74%|███████▍  | 349/471 [01:04<00:22,  5.32it/s] 74%|███████▍  | 350/471 [01:04<00:22,  5.31it/s] 75%|███████▍  | 351/471 [01:04<00:22,  5.32it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.31it/s] 75%|███████▍  | 353/471 [01:05<00:22,  5.30it/s] 75%|███████▌  | 354/471 [01:05<00:22,  5.30it/s] 75%|███████▌  | 355/471 [01:05<00:21,  5.31it/s] 76%|███████▌  | 356/471 [01:05<00:21,  5.30it/s] 76%|███████▌  | 357/471 [01:06<00:21,  5.30it/s] 76%|███████▌  | 358/471 [01:06<00:21,  5.30it/s] 76%|███████▌  | 359/471 [01:06<00:21,  5.29it/s] 76%|███████▋  | 360/471 [01:06<00:20,  5.29it/s] 77%|███████▋  | 361/471 [01:06<00:20,  5.31it/s] 77%|███████▋  | 362/471 [01:07<00:20,  5.33it/s] 77%|███████▋  | 363/471 [01:07<00:20,  5.32it/s] 77%|███████▋  | 364/471 [01:07<00:20,  5.32it/s] 77%|███████▋  | 365/471 [01:07<00:19,  5.31it/s] 78%|███████▊  | 366/471 [01:07<00:19,  5.30it/s] 78%|███████▊  | 367/471 [01:08<00:19,  5.31it/s] 78%|███████▊  | 368/471 [01:08<00:19,  5.32it/s] 78%|███████▊  | 369/471 [01:08<00:19,  5.32it/s] 79%|███████▊  | 370/471 [01:08<00:19,  5.30it/s] 79%|███████▉  | 371/471 [01:08<00:18,  5.30it/s] 79%|███████▉  | 372/471 [01:08<00:18,  5.30it/s] 79%|███████▉  | 373/471 [01:09<00:18,  5.30it/s] 79%|███████▉  | 374/471 [01:09<00:18,  5.32it/s] 80%|███████▉  | 375/471 [01:09<00:18,  5.31it/s] 80%|███████▉  | 376/471 [01:09<00:17,  5.31it/s] 80%|████████  | 377/471 [01:09<00:17,  5.31it/s] 80%|████████  | 378/471 [01:10<00:17,  5.34it/s] 80%|████████  | 379/471 [01:10<00:17,  5.34it/s] 81%|████████  | 380/471 [01:10<00:17,  5.31it/s] 81%|████████  | 381/471 [01:10<00:16,  5.32it/s] 81%|████████  | 382/471 [01:10<00:16,  5.31it/s] 81%|████████▏ | 383/471 [01:11<00:16,  5.31it/s] 82%|████████▏ | 384/471 [01:11<00:16,  5.30it/s] 82%|████████▏ | 385/471 [01:11<00:16,  5.30it/s] 82%|████████▏ | 386/471 [01:11<00:16,  5.31it/s] 82%|████████▏ | 387/471 [01:11<00:15,  5.30it/s] 82%|████████▏ | 388/471 [01:11<00:15,  5.30it/s] 83%|████████▎ | 389/471 [01:12<00:15,  5.30it/s] 83%|████████▎ | 390/471 [01:12<00:15,  5.30it/s] 83%|████████▎ | 391/471 [01:12<00:15,  5.30it/s] 83%|████████▎ | 392/471 [01:12<00:14,  5.30it/s] 83%|████████▎ | 393/471 [01:12<00:14,  5.31it/s] 84%|████████▎ | 394/471 [01:13<00:14,  5.29it/s] 84%|████████▍ | 395/471 [01:13<00:14,  5.30it/s] 84%|████████▍ | 396/471 [01:13<00:14,  5.29it/s] 84%|████████▍ | 397/471 [01:13<00:13,  5.30it/s] 85%|████████▍ | 398/471 [01:13<00:13,  5.30it/s] 85%|████████▍ | 399/471 [01:14<00:13,  5.28it/s] 85%|████████▍ | 400/471 [01:14<00:13,  5.28it/s] 85%|████████▌ | 401/471 [01:14<00:13,  5.28it/s] 85%|████████▌ | 402/471 [01:14<00:13,  5.28it/s] 86%|████████▌ | 403/471 [01:14<00:12,  5.29it/s] 86%|████████▌ | 404/471 [01:14<00:12,  5.30it/s] 86%|████████▌ | 405/471 [01:15<00:12,  5.29it/s] 86%|████████▌ | 406/471 [01:15<00:12,  5.31it/s] 86%|████████▋ | 407/471 [01:15<00:12,  5.31it/s] 87%|████████▋ | 408/471 [01:15<00:11,  5.30it/s] 87%|████████▋ | 409/471 [01:15<00:11,  5.29it/s] 87%|████████▋ | 410/471 [01:16<00:11,  5.31it/s] 87%|████████▋ | 411/471 [01:16<00:11,  5.33it/s] 87%|████████▋ | 412/471 [01:16<00:11,  5.31it/s] 88%|████████▊ | 413/471 [01:16<00:10,  5.31it/s] 88%|████████▊ | 414/471 [01:16<00:10,  5.29it/s] 88%|████████▊ | 415/471 [01:17<00:10,  5.30it/s] 88%|████████▊ | 416/471 [01:17<00:10,  5.28it/s] 89%|████████▊ | 417/471 [01:17<00:10,  5.29it/s] 89%|████████▊ | 418/471 [01:17<00:10,  5.30it/s] 89%|████████▉ | 419/471 [01:17<00:09,  5.31it/s] 89%|████████▉ | 420/471 [01:17<00:09,  5.33it/s] 89%|████████▉ | 421/471 [01:18<00:09,  5.31it/s] 90%|████████▉ | 422/471 [01:18<00:09,  5.32it/s] 90%|████████▉ | 423/471 [01:18<00:09,  5.33it/s] 90%|█████████ | 424/471 [01:18<00:08,  5.32it/s] 90%|█████████ | 425/471 [01:18<00:08,  5.33it/s] 90%|█████████ | 426/471 [01:19<00:08,  5.31it/s] 91%|█████████ | 427/471 [01:19<00:08,  5.31it/s] 91%|█████████ | 428/471 [01:19<00:08,  5.31it/s] 91%|█████████ | 429/471 [01:19<00:07,  5.31it/s] 91%|█████████▏| 430/471 [01:19<00:07,  5.31it/s] 92%|█████████▏| 431/471 [01:20<00:07,  5.30it/s] 92%|█████████▏| 432/471 [01:20<00:07,  5.31it/s] 92%|█████████▏| 433/471 [01:20<00:07,  5.31it/s] 92%|█████████▏| 434/471 [01:20<00:06,  5.31it/s] 92%|█████████▏| 435/471 [01:20<00:06,  5.30it/s] 93%|█████████▎| 436/471 [01:21<00:06,  5.31it/s] 93%|█████████▎| 437/471 [01:21<00:06,  5.31it/s] 93%|█████████▎| 438/471 [01:21<00:06,  5.31it/s] 93%|█████████▎| 439/471 [01:21<00:06,  5.31it/s] 93%|█████████▎| 440/471 [01:21<00:05,  5.31it/s] 94%|█████████▎| 441/471 [01:21<00:05,  5.32it/s] 94%|█████████▍| 442/471 [01:22<00:05,  5.33it/s] 94%|█████████▍| 443/471 [01:22<00:05,  5.32it/s] 94%|█████████▍| 444/471 [01:22<00:05,  5.31it/s] 94%|█████████▍| 445/471 [01:22<00:04,  5.30it/s] 95%|█████████▍| 446/471 [01:22<00:04,  5.30it/s] 95%|█████████▍| 447/471 [01:23<00:04,  5.31it/s] 95%|█████████▌| 448/471 [01:23<00:04,  5.32it/s] 95%|█████████▌| 449/471 [01:23<00:04,  5.32it/s] 96%|█████████▌| 450/471 [01:23<00:03,  5.30it/s] 96%|█████████▌| 451/471 [01:23<00:03,  5.30it/s] 96%|█████████▌| 452/471 [01:24<00:03,  5.31it/s] 96%|█████████▌| 453/471 [01:24<00:03,  5.30it/s] 96%|█████████▋| 454/471 [01:24<00:03,  5.29it/s] 97%|█████████▋| 455/471 [01:24<00:03,  5.28it/s] 97%|█████████▋| 456/471 [01:24<00:02,  5.29it/s] 97%|█████████▋| 457/471 [01:24<00:02,  5.30it/s] 97%|█████████▋| 458/471 [01:25<00:02,  5.30it/s] 97%|█████████▋| 459/471 [01:25<00:02,  5.32it/s] 98%|█████████▊| 460/471 [01:25<00:02,  5.31it/s] 98%|█████████▊| 461/471 [01:25<00:01,  5.30it/s] 98%|█████████▊| 462/471 [01:25<00:01,  5.29it/s] 98%|█████████▊| 463/471 [01:26<00:01,  5.28it/s] 99%|█████████▊| 464/471 [01:26<00:01,  5.29it/s] 99%|█████████▊| 465/471 [01:26<00:01,  5.31it/s] 99%|█████████▉| 466/471 [01:26<00:00,  5.30it/s] 99%|█████████▉| 467/471 [01:26<00:00,  5.28it/s] 99%|█████████▉| 468/471 [01:27<00:00,  5.27it/s]100%|█████████▉| 469/471 [01:27<00:00,  5.28it/s]100%|█████████▉| 470/471 [01:27<00:00,  5.29it/s]100%|██████████| 471/471 [01:27<00:00,  5.65it/s]100%|██████████| 471/471 [01:27<00:00,  5.38it/s]
{'eval_loss': 5.325545787811279, 'eval_model_preparation_time': 0.005, 'eval_acc': 0.15785979819437068, 'eval_runtime': 87.7464, 'eval_samples_per_second': 85.838, 'eval_steps_per_second': 5.368}
ROUND:4
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.93it/s]                                              {'loss': 4.7725, 'grad_norm': 6.9416093826293945, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.93it/s]  5%|▌         | 2/40 [00:00<00:12,  2.96it/s]                                              {'loss': 4.4219, 'grad_norm': 5.361115455627441, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.96it/s]  8%|▊         | 3/40 [00:01<00:12,  2.98it/s]                                              {'loss': 5.171, 'grad_norm': 9.611681938171387, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.98it/s] 10%|█         | 4/40 [00:01<00:12,  2.99it/s]                                              {'loss': 2.8187, 'grad_norm': 7.504723072052002, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.99it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 3.9476, 'grad_norm': 11.776398658752441, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:02<00:11,  3.00it/s]                                              {'loss': 2.5626, 'grad_norm': 11.88652515411377, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 2.4184, 'grad_norm': 11.431709289550781, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 0.8305, 'grad_norm': 30.265989303588867, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.72it/s]                                              {'loss': 0.8963, 'grad_norm': 7.310617923736572, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.72it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.49it/s]                                               {'loss': 1.4045, 'grad_norm': 12.971263885498047, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.49it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.2349, 'grad_norm': 8.054326057434082, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.33it/s] 30%|███       | 12/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.2686, 'grad_norm': 9.769892692565918, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.24it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.0579, 'grad_norm': 5.1030402183532715, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.6745, 'grad_norm': 6.055474281311035, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.5208, 'grad_norm': 6.703797817230225, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.3646, 'grad_norm': 11.991472244262695, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s]                                               {'loss': 0.6195, 'grad_norm': 4.769659996032715, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.5925, 'grad_norm': 4.350184440612793, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 0.8059, 'grad_norm': 5.930962562561035, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.24it/s]                                               {'loss': 1.1036, 'grad_norm': 6.323359966278076, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.24it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s]                                               {'loss': 0.232, 'grad_norm': 2.6137185096740723, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.09it/s]                                               {'loss': 0.726, 'grad_norm': 4.712985992431641, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.09it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.05it/s]                                               {'loss': 0.66, 'grad_norm': 5.291775226593018, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.05it/s]                                               {'loss': 0.6604, 'grad_norm': 61.70787048339844, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.05it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s]                                               {'loss': 0.371, 'grad_norm': 2.949535369873047, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.78it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s]                                               {'loss': 0.1174, 'grad_norm': 2.081021547317505, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.55it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.7107, 'grad_norm': 9.226457595825195, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.3066, 'grad_norm': 8.904117584228516, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s]                                               {'loss': 0.4323, 'grad_norm': 5.800376892089844, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.5829, 'grad_norm': 3.5530900955200195, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.2414, 'grad_norm': 2.7753846645355225, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.06it/s]                                               {'loss': 0.7282, 'grad_norm': 27.777252197265625, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.06it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s]                                               {'loss': 0.1517, 'grad_norm': 3.761309862136841, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s]                                               {'loss': 0.085, 'grad_norm': 1.2781063318252563, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.34it/s]                                               {'loss': 0.3085, 'grad_norm': 3.2663354873657227, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.34it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.23it/s]                                               {'loss': 0.145, 'grad_norm': 3.4467833042144775, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.23it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.0783, 'grad_norm': 1.1353224515914917, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.16it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.5975, 'grad_norm': 6.996856212615967, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.2842, 'grad_norm': 3.8227784633636475, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.1706, 'grad_norm': 6.681211948394775, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]                                               {'train_runtime': 12.2416, 'train_samples_per_second': 46.154, 'train_steps_per_second': 3.268, 'train_loss': 1.1769044127315282, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]100%|██████████| 40/40 [00:12<00:00,  3.27it/s]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]                                              {'loss': 6.7345, 'grad_norm': 5.30030632019043, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]  5%|▌         | 2/40 [00:00<00:12,  2.95it/s]                                              {'loss': 3.2569, 'grad_norm': 5.962326526641846, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.95it/s]  8%|▊         | 3/40 [00:01<00:12,  3.00it/s]                                              {'loss': 3.6275, 'grad_norm': 7.0331878662109375, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  3.00it/s] 10%|█         | 4/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.8786, 'grad_norm': 11.134294509887695, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.00it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.5138, 'grad_norm': 8.338428497314453, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s] 15%|█▌        | 6/40 [00:02<00:11,  3.00it/s]                                              {'loss': 2.8619, 'grad_norm': 15.872855186462402, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 2.3688, 'grad_norm': 13.353232383728027, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 1.3338, 'grad_norm': 42.66996383666992, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.01it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s]                                              {'loss': 1.9958, 'grad_norm': 6.797947406768799, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.50it/s]                                               {'loss': 2.3062, 'grad_norm': 10.825735092163086, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.50it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s]                                               {'loss': 0.7011, 'grad_norm': 7.94110107421875, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s] 30%|███       | 12/40 [00:03<00:08,  3.27it/s]                                               {'loss': 0.9808, 'grad_norm': 8.251703262329102, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.27it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.561, 'grad_norm': 8.968179702758789, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.1945, 'grad_norm': 7.1310343742370605, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.1247, 'grad_norm': 9.41634750366211, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 2.6464, 'grad_norm': 36.157615661621094, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.09it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s]                                               {'loss': 0.11, 'grad_norm': 1.303108811378479, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s]                                               {'loss': 0.5285, 'grad_norm': 3.697972536087036, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s]                                               {'loss': 1.2794, 'grad_norm': 7.0005316734313965, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s] 50%|█████     | 20/40 [00:06<00:06,  3.29it/s]                                               {'loss': 0.4271, 'grad_norm': 5.814423561096191, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.29it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.6762, 'grad_norm': 4.039432525634766, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s]                                               {'loss': 0.8028, 'grad_norm': 4.90870475769043, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 0.8393, 'grad_norm': 4.914302825927734, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 0.2863, 'grad_norm': 9.921818733215332, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.08it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s]                                               {'loss': 0.6898, 'grad_norm': 7.292999267578125, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s]                                               {'loss': 0.0667, 'grad_norm': 1.8700876235961914, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.2255, 'grad_norm': 3.039497137069702, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.4722, 'grad_norm': 5.103113651275635, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s]                                               {'loss': 0.2981, 'grad_norm': 4.311244964599609, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.3737, 'grad_norm': 7.526591777801514, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.5984, 'grad_norm': 3.5172548294067383, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.0206, 'grad_norm': 0.8778192400932312, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.10it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.5606, 'grad_norm': 2.6871442794799805, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 0.0931, 'grad_norm': 1.2062839269638062, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.2724, 'grad_norm': 1.3828057050704956, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.1955, 'grad_norm': 1.3769513368606567, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.118, 'grad_norm': 2.4005470275878906, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1397, 'grad_norm': 3.0118703842163086, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.2683, 'grad_norm': 2.1429355144500732, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0229, 'grad_norm': 1.3603911399841309, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.08it/s]                                               {'train_runtime': 12.1438, 'train_samples_per_second': 46.526, 'train_steps_per_second': 3.294, 'train_loss': 1.2112866460345686, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.08it/s]100%|██████████| 40/40 [00:12<00:00,  3.29it/s]
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]                                              {'loss': 7.6403, 'grad_norm': 5.861875534057617, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]                                              {'loss': 3.585, 'grad_norm': 4.414401054382324, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]  8%|▊         | 3/40 [00:01<00:12,  2.98it/s]                                              {'loss': 4.7676, 'grad_norm': 8.766121864318848, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.98it/s] 10%|█         | 4/40 [00:01<00:12,  2.98it/s]                                              {'loss': 3.0393, 'grad_norm': 6.214293003082275, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.98it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 2.5238, 'grad_norm': 8.493095397949219, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s]                                              {'loss': 3.6626, 'grad_norm': 12.33907699584961, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 3.2463, 'grad_norm': 12.879399299621582, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 4.4631, 'grad_norm': 53.205604553222656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s]                                              {'loss': 1.4602, 'grad_norm': 7.5140838623046875, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s]                                               {'loss': 1.6858, 'grad_norm': 8.44725227355957, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s]                                               {'loss': 1.7315, 'grad_norm': 11.852017402648926, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.773, 'grad_norm': 13.903090476989746, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.2269, 'grad_norm': 11.206979751586914, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.7503, 'grad_norm': 11.087764739990234, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.07it/s]                                               {'loss': 1.5996, 'grad_norm': 9.744390487670898, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.07it/s]                                               {'loss': 0.5697, 'grad_norm': 18.3729305267334, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.07it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s]                                               {'loss': 0.8684, 'grad_norm': 5.073694229125977, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.55it/s]                                               {'loss': 1.1422, 'grad_norm': 6.737175464630127, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.55it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 0.6997, 'grad_norm': 4.2850141525268555, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 0.6583, 'grad_norm': 4.332808494567871, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.6627, 'grad_norm': 4.959657192230225, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.6635, 'grad_norm': 2.1921136379241943, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 1.0678, 'grad_norm': 7.0017828941345215, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.0292, 'grad_norm': 1.0957430601119995, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s]                                               {'loss': 0.8227, 'grad_norm': 3.4016621112823486, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s]                                               {'loss': 0.4212, 'grad_norm': 2.8397111892700195, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.9102, 'grad_norm': 6.021734714508057, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.3616, 'grad_norm': 3.4937620162963867, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.2003, 'grad_norm': 3.18146014213562, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.1564, 'grad_norm': 2.9596543312072754, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.3112, 'grad_norm': 4.403758525848389, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.0177, 'grad_norm': 0.908211886882782, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s]                                               {'loss': 0.4069, 'grad_norm': 2.329036235809326, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.55it/s]                                               {'loss': 0.1429, 'grad_norm': 3.3088743686676025, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.55it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.0676, 'grad_norm': 1.465638279914856, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.2832, 'grad_norm': 3.629390001296997, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.2144, 'grad_norm': 3.758362054824829, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.289, 'grad_norm': 1.1759364604949951, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.6509, 'grad_norm': 3.2464370727539062, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]100%|██████████| 40/40 [00:11<00:00,  3.80it/s]                                               {'loss': 0.4566, 'grad_norm': 11.185494422912598, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.80it/s]                                               {'train_runtime': 12.2724, 'train_samples_per_second': 46.038, 'train_steps_per_second': 3.259, 'train_loss': 1.4057235065847635, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.80it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.13it/s]                                              {'loss': 5.4603, 'grad_norm': 5.497434139251709, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.13it/s]  5%|▌         | 2/40 [00:00<00:12,  3.10it/s]                                              {'loss': 4.8062, 'grad_norm': 6.413817405700684, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.10it/s]  8%|▊         | 3/40 [00:00<00:12,  3.07it/s]                                              {'loss': 4.5457, 'grad_norm': 7.221378326416016, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.07it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.5597, 'grad_norm': 7.740871429443359, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.4645, 'grad_norm': 9.389358520507812, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.4682, 'grad_norm': 9.270652770996094, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 2.6319, 'grad_norm': 9.365514755249023, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 1.8706, 'grad_norm': 1.5791947841644287, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s]                                              {'loss': 1.2949, 'grad_norm': 6.024536609649658, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.59it/s]                                               {'loss': 1.1814, 'grad_norm': 4.505204200744629, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.59it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s]                                               {'loss': 2.6572, 'grad_norm': 7.8848042488098145, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s] 30%|███       | 12/40 [00:03<00:08,  3.33it/s]                                               {'loss': 2.6922, 'grad_norm': 6.933755874633789, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.33it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s]                                               {'loss': 0.8577, 'grad_norm': 7.078307628631592, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.23it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.5965, 'grad_norm': 6.727451324462891, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.05, 'grad_norm': 5.996621608734131, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 6.3521, 'grad_norm': 37.18704605102539, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.11it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s]                                               {'loss': 0.923, 'grad_norm': 4.420536994934082, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s]                                               {'loss': 0.6769, 'grad_norm': 4.023496627807617, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s]                                               {'loss': 0.8981, 'grad_norm': 7.9758195877075195, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 1.1397, 'grad_norm': 5.010031223297119, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.3856, 'grad_norm': 4.548084259033203, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.9211, 'grad_norm': 5.455826282501221, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.9143, 'grad_norm': 3.7808403968811035, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.1532, 'grad_norm': 6.308190822601318, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.17it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s]                                               {'loss': 0.5437, 'grad_norm': 5.422728538513184, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s]                                               {'loss': 0.7319, 'grad_norm': 1.9826667308807373, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.48it/s]                                               {'loss': 0.1327, 'grad_norm': 1.9824907779693604, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.48it/s] 70%|███████   | 28/40 [00:08<00:03,  3.33it/s]                                               {'loss': 0.1083, 'grad_norm': 2.070061445236206, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.33it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.6578, 'grad_norm': 6.824647426605225, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s]                                               {'loss': 0.5636, 'grad_norm': 0.9729170799255371, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.413, 'grad_norm': 2.6901912689208984, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.0591, 'grad_norm': 2.6900975704193115, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.16it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.84it/s]                                               {'loss': 0.0764, 'grad_norm': 0.8211487531661987, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.84it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.65it/s]                                               {'loss': 0.1533, 'grad_norm': 2.2249538898468018, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.65it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.46it/s]                                               {'loss': 0.2642, 'grad_norm': 5.253575325012207, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.46it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.35it/s]                                               {'loss': 1.113, 'grad_norm': 2.2728524208068848, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.35it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.28it/s]                                               {'loss': 0.4332, 'grad_norm': 6.868511199951172, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.28it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.0984, 'grad_norm': 1.5646721124649048, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.21it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.1217, 'grad_norm': 1.4324761629104614, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0267, 'grad_norm': 1.496946930885315, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 11.9701, 'train_samples_per_second': 47.201, 'train_steps_per_second': 3.342, 'train_loss': 1.4249516217503697, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]100%|██████████| 40/40 [00:11<00:00,  3.34it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.08it/s]                                              {'loss': 5.4458, 'grad_norm': 4.835186004638672, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.08it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 5.0494, 'grad_norm': 5.316546440124512, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:12,  3.01it/s]                                              {'loss': 3.1519, 'grad_norm': 7.191104412078857, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.01it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.568, 'grad_norm': 8.664490699768066, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.87, 'grad_norm': 8.534687042236328, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.4063, 'grad_norm': 8.243861198425293, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 3.2478, 'grad_norm': 12.117777824401855, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 2.2768, 'grad_norm': 48.562828063964844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.05it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s]                                              {'loss': 1.5373, 'grad_norm': 6.838784217834473, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s]                                               {'loss': 2.0826, 'grad_norm': 10.902444839477539, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 1.0871, 'grad_norm': 8.690069198608398, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.30it/s]                                               {'loss': 1.5085, 'grad_norm': 7.525718688964844, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.30it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.24it/s]                                               {'loss': 0.9271, 'grad_norm': 7.285865783691406, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 0.9473, 'grad_norm': 6.071099758148193, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 1.5281, 'grad_norm': 9.709272384643555, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.0104, 'grad_norm': 0.9097417593002319, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 0.6475, 'grad_norm': 3.0760607719421387, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.2174, 'grad_norm': 2.5996925830841064, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 0.6758, 'grad_norm': 10.405162811279297, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 0.7312, 'grad_norm': 6.254604339599609, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.508, 'grad_norm': 5.327925205230713, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.6401, 'grad_norm': 2.5094375610351562, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 0.4866, 'grad_norm': 4.353028774261475, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 1.2135, 'grad_norm': 67.32884979248047, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.13it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s]                                               {'loss': 0.4388, 'grad_norm': 5.015974044799805, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s]                                               {'loss': 0.2091, 'grad_norm': 5.454828262329102, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s]                                               {'loss': 0.1153, 'grad_norm': 2.9513680934906006, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s] 70%|███████   | 28/40 [00:08<00:03,  3.33it/s]                                               {'loss': 0.4068, 'grad_norm': 0.7615013122558594, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.33it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.2125, 'grad_norm': 9.104103088378906, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s]                                               {'loss': 0.3522, 'grad_norm': 3.894629716873169, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.5507, 'grad_norm': 17.95494270324707, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.0039, 'grad_norm': 0.17197838425636292, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s]                                               {'loss': 0.083, 'grad_norm': 1.734946370124817, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.64it/s]                                               {'loss': 0.5033, 'grad_norm': 2.938673734664917, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.64it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.47it/s]                                               {'loss': 0.0734, 'grad_norm': 1.243553876876831, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.47it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.35it/s]                                               {'loss': 0.06, 'grad_norm': 1.2709294557571411, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.35it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.26it/s]                                               {'loss': 0.2531, 'grad_norm': 3.4420039653778076, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.26it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.5004, 'grad_norm': 2.5003774166107178, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.20it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0844, 'grad_norm': 1.9993921518325806, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0025, 'grad_norm': 0.10506299883127213, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.14it/s]                                               {'train_runtime': 12.0549, 'train_samples_per_second': 46.869, 'train_steps_per_second': 3.318, 'train_loss': 1.1653590232366695, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.14it/s]100%|██████████| 40/40 [00:12<00:00,  3.32it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 5.2821, 'grad_norm': 4.474529266357422, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]                                              {'loss': 5.4122, 'grad_norm': 6.434473514556885, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]  8%|▊         | 3/40 [00:00<00:12,  3.03it/s]                                              {'loss': 4.6101, 'grad_norm': 9.454191207885742, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.03it/s] 10%|█         | 4/40 [00:01<00:12,  3.00it/s]                                              {'loss': 3.0378, 'grad_norm': 8.56495189666748, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  3.00it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.9713, 'grad_norm': 12.16084098815918, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.8162, 'grad_norm': 15.15933895111084, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s]                                              {'loss': 3.9935, 'grad_norm': 16.035499572753906, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.99it/s]                                              {'loss': 2.489, 'grad_norm': 52.73883819580078, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.99it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.70it/s]                                              {'loss': 1.8328, 'grad_norm': 9.71057415008545, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.70it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.49it/s]                                               {'loss': 1.423, 'grad_norm': 7.567305088043213, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.49it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s]                                               {'loss': 1.868, 'grad_norm': 10.16702651977539, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s] 30%|███       | 12/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.0696, 'grad_norm': 8.576608657836914, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.24it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.3979, 'grad_norm': 6.820553779602051, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.14it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.442, 'grad_norm': 9.17990493774414, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.6801, 'grad_norm': 8.628732681274414, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 0.0004, 'grad_norm': 0.018609214574098587, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.09it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.90it/s]                                               {'loss': 1.227, 'grad_norm': 5.104581356048584, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.90it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s]                                               {'loss': 0.9508, 'grad_norm': 4.1168532371521, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s]                                               {'loss': 0.6065, 'grad_norm': 3.8611133098602295, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s] 50%|█████     | 20/40 [00:06<00:06,  3.32it/s]                                               {'loss': 1.2483, 'grad_norm': 7.032965660095215, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.32it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.25it/s]                                               {'loss': 0.783, 'grad_norm': 4.708399772644043, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.25it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.3914, 'grad_norm': 3.3047070503234863, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.19it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.16it/s]                                               {'loss': 0.3092, 'grad_norm': 2.8805480003356934, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.16it/s]                                               {'loss': 0.6323, 'grad_norm': 52.591312408447266, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.16it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.89it/s]                                               {'loss': 0.5346, 'grad_norm': 5.519352912902832, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.89it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s]                                               {'loss': 0.4261, 'grad_norm': 7.698762893676758, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.46it/s]                                               {'loss': 0.0864, 'grad_norm': 1.8996567726135254, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.46it/s] 70%|███████   | 28/40 [00:08<00:03,  3.33it/s]                                               {'loss': 0.1998, 'grad_norm': 1.6710090637207031, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.33it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.4122, 'grad_norm': 2.496443033218384, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s]                                               {'loss': 0.2107, 'grad_norm': 1.5637730360031128, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.8138, 'grad_norm': 7.196451187133789, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.1168, 'grad_norm': 7.9851861000061035, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s]                                               {'loss': 0.6756, 'grad_norm': 2.065537214279175, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s]                                               {'loss': 0.2774, 'grad_norm': 3.320434093475342, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s]                                               {'loss': 0.1198, 'grad_norm': 1.7331275939941406, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s]                                               {'loss': 0.1113, 'grad_norm': 1.8126635551452637, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.1669, 'grad_norm': 2.860816240310669, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.2137, 'grad_norm': 2.1349220275878906, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.1218, 'grad_norm': 1.3555359840393066, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0386, 'grad_norm': 1.750380516052246, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]                                               {'train_runtime': 12.0243, 'train_samples_per_second': 46.988, 'train_steps_per_second': 3.327, 'train_loss': 1.3249983855093888, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.15it/s]100%|██████████| 40/40 [00:12<00:00,  3.33it/s]
CLIENT:19
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 5.1292, 'grad_norm': 4.564892768859863, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 5.2052, 'grad_norm': 5.867048263549805, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 4.9668, 'grad_norm': 6.991509437561035, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.03it/s]                                              {'loss': 4.7253, 'grad_norm': 9.166069984436035, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.03it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.1122, 'grad_norm': 9.852328300476074, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s]                                              {'loss': 2.2805, 'grad_norm': 9.59174919128418, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 3.799, 'grad_norm': 16.886018753051758, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 6.6086, 'grad_norm': 96.32508087158203, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.06it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.84it/s]                                              {'loss': 1.8376, 'grad_norm': 13.38187026977539, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.84it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.61it/s]                                               {'loss': 1.3159, 'grad_norm': 8.868183135986328, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.61it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s]                                               {'loss': 1.6175, 'grad_norm': 9.015058517456055, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s] 30%|███       | 12/40 [00:03<00:08,  3.39it/s]                                               {'loss': 0.6516, 'grad_norm': 4.804657936096191, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.39it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.129, 'grad_norm': 8.684869766235352, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.28it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.4764, 'grad_norm': 8.611119270324707, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.17it/s]                                               {'loss': 2.2409, 'grad_norm': 11.425342559814453, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.17it/s]                                               {'loss': 3.1826, 'grad_norm': 60.77495574951172, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.17it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.88it/s]                                               {'loss': 0.491, 'grad_norm': 3.134889841079712, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.88it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.64it/s]                                               {'loss': 0.6271, 'grad_norm': 3.7221951484680176, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.64it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.48it/s]                                               {'loss': 0.4683, 'grad_norm': 4.1247076988220215, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.48it/s] 50%|█████     | 20/40 [00:05<00:05,  3.35it/s]                                               {'loss': 0.8311, 'grad_norm': 5.000524997711182, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.35it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s]                                               {'loss': 0.7047, 'grad_norm': 5.867833614349365, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.8499, 'grad_norm': 5.750405788421631, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.5638, 'grad_norm': 6.877847194671631, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.0257, 'grad_norm': 2.151580810546875, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:06<00:05,  3.18it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.96it/s]                                               {'loss': 0.21, 'grad_norm': 2.870361566543579, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.96it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.68it/s]                                               {'loss': 0.4724, 'grad_norm': 8.899223327636719, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.68it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.50it/s]                                               {'loss': 0.1624, 'grad_norm': 2.308440685272217, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.50it/s] 70%|███████   | 28/40 [00:08<00:03,  3.36it/s]                                               {'loss': 0.2947, 'grad_norm': 4.047369956970215, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.36it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.5481, 'grad_norm': 4.539498329162598, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.28it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.2091, 'grad_norm': 3.303152561187744, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.22it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.19it/s]                                               {'loss': 0.2663, 'grad_norm': 3.3224058151245117, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.19it/s]                                               {'loss': 0.1081, 'grad_norm': 3.7566940784454346, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.19it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.91it/s]                                               {'loss': 0.1451, 'grad_norm': 2.3036186695098877, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.91it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.68it/s]                                               {'loss': 0.3027, 'grad_norm': 4.051810264587402, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.68it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s]                                               {'loss': 0.2666, 'grad_norm': 4.525145530700684, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.37it/s]                                               {'loss': 0.3935, 'grad_norm': 1.498131513595581, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.37it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.28it/s]                                               {'loss': 0.164, 'grad_norm': 0.673430860042572, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.28it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.1023, 'grad_norm': 1.3636398315429688, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.20it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0687, 'grad_norm': 0.9348975419998169, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0346, 'grad_norm': 3.121211051940918, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]                                               {'train_runtime': 11.8736, 'train_samples_per_second': 47.585, 'train_steps_per_second': 3.369, 'train_loss': 1.4397195056080818, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]100%|██████████| 40/40 [00:11<00:00,  3.37it/s]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]                                              {'loss': 5.85, 'grad_norm': 4.659451484680176, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]  5%|▌         | 2/40 [00:00<00:12,  3.10it/s]                                              {'loss': 3.817, 'grad_norm': 4.550510883331299, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.10it/s]  8%|▊         | 3/40 [00:00<00:12,  3.08it/s]                                              {'loss': 3.952, 'grad_norm': 9.107369422912598, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.08it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.1711, 'grad_norm': 7.1126885414123535, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s]                                              {'loss': 3.5778, 'grad_norm': 14.852949142456055, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.4007, 'grad_norm': 12.320941925048828, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.13it/s]                                              {'loss': 2.3193, 'grad_norm': 7.903379917144775, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.13it/s]                                              {'loss': 4.1473, 'grad_norm': 46.81931686401367, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.13it/s] 22%|██▎       | 9/40 [00:02<00:07,  3.89it/s]                                              {'loss': 1.7443, 'grad_norm': 6.345262050628662, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:07,  3.89it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.64it/s]                                               {'loss': 1.2379, 'grad_norm': 8.473176956176758, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.64it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s]                                               {'loss': 0.9357, 'grad_norm': 6.2349090576171875, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.46it/s] 30%|███       | 12/40 [00:03<00:08,  3.35it/s]                                               {'loss': 1.9298, 'grad_norm': 8.404884338378906, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.35it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.28it/s]                                               {'loss': 1.925, 'grad_norm': 11.143967628479004, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.28it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.22it/s]                                               {'loss': 0.7253, 'grad_norm': 6.479683876037598, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.22it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.19it/s]                                               {'loss': 0.7496, 'grad_norm': 5.702028751373291, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.19it/s]                                               {'loss': 3.0419, 'grad_norm': 38.18442153930664, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.19it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.94it/s]                                               {'loss': 0.4625, 'grad_norm': 3.98630690574646, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.94it/s] 45%|████▌     | 18/40 [00:05<00:05,  3.68it/s]                                               {'loss': 0.2134, 'grad_norm': 3.946897029876709, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:05,  3.68it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.50it/s]                                               {'loss': 0.7756, 'grad_norm': 2.3805294036865234, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.50it/s] 50%|█████     | 20/40 [00:05<00:05,  3.37it/s]                                               {'loss': 0.4099, 'grad_norm': 3.0341341495513916, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.37it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.29it/s]                                               {'loss': 0.3774, 'grad_norm': 5.600187301635742, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.29it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.6412, 'grad_norm': 4.987279891967773, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.23it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.3779, 'grad_norm': 3.827606439590454, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.0277, 'grad_norm': 1.17280912399292, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:06<00:05,  3.19it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.95it/s]                                               {'loss': 0.5207, 'grad_norm': 3.256795644760132, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.95it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.70it/s]                                               {'loss': 0.1943, 'grad_norm': 1.853859305381775, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.70it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.52it/s]                                               {'loss': 0.2131, 'grad_norm': 3.9353959560394287, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.52it/s] 70%|███████   | 28/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.6237, 'grad_norm': 3.48374342918396, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.39it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.1302, 'grad_norm': 2.0749728679656982, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.28it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.1754, 'grad_norm': 2.1884396076202393, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.0758, 'grad_norm': 2.1360156536102295, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.0005, 'grad_norm': 0.029586102813482285, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.16it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.94it/s]                                               {'loss': 0.4956, 'grad_norm': 2.574939250946045, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.94it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.68it/s]                                               {'loss': 0.055, 'grad_norm': 1.5230826139450073, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.68it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.49it/s]                                               {'loss': 0.0667, 'grad_norm': 1.300915241241455, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.49it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.37it/s]                                               {'loss': 0.0775, 'grad_norm': 0.839076817035675, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.37it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.27it/s]                                               {'loss': 0.0361, 'grad_norm': 1.0917727947235107, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.27it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.304, 'grad_norm': 1.6325056552886963, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.21it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.1268, 'grad_norm': 3.8831098079681396, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.0117, 'grad_norm': 1.2672996520996094, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.17it/s]                                               {'train_runtime': 11.8066, 'train_samples_per_second': 47.855, 'train_steps_per_second': 3.388, 'train_loss': 1.222931809128204, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.17it/s]100%|██████████| 40/40 [00:11<00:00,  3.39it/s]
CLIENT:94
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]                                              {'loss': 5.2737, 'grad_norm': 5.669642925262451, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]  5%|▌         | 2/40 [00:00<00:11,  3.21it/s]                                              {'loss': 4.961, 'grad_norm': 6.695623397827148, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:11,  3.21it/s]  8%|▊         | 3/40 [00:00<00:11,  3.16it/s]                                              {'loss': 4.4054, 'grad_norm': 5.897851943969727, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.16it/s] 10%|█         | 4/40 [00:01<00:11,  3.10it/s]                                              {'loss': 4.7414, 'grad_norm': 11.757726669311523, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.10it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s]                                              {'loss': 4.9983, 'grad_norm': 15.26781940460205, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 2.8783, 'grad_norm': 9.1846923828125, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.12it/s]                                              {'loss': 3.1272, 'grad_norm': 10.81279182434082, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.12it/s]                                              {'loss': 1.9313, 'grad_norm': 38.24891662597656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.12it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s]                                              {'loss': 3.1254, 'grad_norm': 11.796253204345703, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.60it/s]                                               {'loss': 1.9543, 'grad_norm': 12.232316970825195, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.60it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s]                                               {'loss': 2.3513, 'grad_norm': 9.145421028137207, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s] 30%|███       | 12/40 [00:03<00:08,  3.31it/s]                                               {'loss': 2.7236, 'grad_norm': 8.262228012084961, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.31it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.5551, 'grad_norm': 5.266603469848633, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.18it/s]                                               {'loss': 1.6285, 'grad_norm': 6.227546691894531, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.18it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.16it/s]                                               {'loss': 1.7798, 'grad_norm': 9.433645248413086, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.16it/s]                                               {'loss': 2.0124, 'grad_norm': 37.73628234863281, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.16it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.90it/s]                                               {'loss': 1.3193, 'grad_norm': 4.845826625823975, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.90it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s]                                               {'loss': 0.8611, 'grad_norm': 4.186039924621582, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.49it/s]                                               {'loss': 0.9342, 'grad_norm': 6.6089959144592285, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.49it/s] 50%|█████     | 20/40 [00:05<00:05,  3.36it/s]                                               {'loss': 0.7396, 'grad_norm': 5.939319610595703, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:05,  3.36it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s]                                               {'loss': 1.1002, 'grad_norm': 9.25461483001709, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.6422, 'grad_norm': 5.5981059074401855, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.21it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.16it/s]                                               {'loss': 1.0989, 'grad_norm': 7.104647159576416, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.16it/s]                                               {'loss': 1.2892, 'grad_norm': 26.149982452392578, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:06<00:05,  3.16it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.90it/s]                                               {'loss': 0.5962, 'grad_norm': 3.356769323348999, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.90it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s]                                               {'loss': 0.6995, 'grad_norm': 3.320521354675293, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.45it/s]                                               {'loss': 0.1925, 'grad_norm': 1.6774839162826538, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.45it/s] 70%|███████   | 28/40 [00:08<00:03,  3.34it/s]                                               {'loss': 0.7297, 'grad_norm': 4.896642684936523, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.34it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.4259, 'grad_norm': 2.338376522064209, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.4119, 'grad_norm': 2.0905885696411133, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.21it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.17it/s]                                               {'loss': 0.3255, 'grad_norm': 3.7743308544158936, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.17it/s]                                               {'loss': 3.675, 'grad_norm': 80.59664916992188, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.17it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.88it/s]                                               {'loss': 0.2402, 'grad_norm': 1.9535821676254272, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.88it/s] 85%|████████▌ | 34/40 [00:09<00:01,  3.66it/s]                                               {'loss': 0.3595, 'grad_norm': 3.0202972888946533, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:09<00:01,  3.66it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s]                                               {'loss': 0.2259, 'grad_norm': 2.0972135066986084, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.50it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.37it/s]                                               {'loss': 0.4015, 'grad_norm': 1.9851869344711304, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.37it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.27it/s]                                               {'loss': 0.2988, 'grad_norm': 1.9532041549682617, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.27it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.1523, 'grad_norm': 1.5607576370239258, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1472, 'grad_norm': 2.339482307434082, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1712, 'grad_norm': 3.3630781173706055, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.14it/s]                                               {'train_runtime': 11.879, 'train_samples_per_second': 47.563, 'train_steps_per_second': 3.367, 'train_loss': 1.6621180031448604, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.14it/s]100%|██████████| 40/40 [00:11<00:00,  3.37it/s]
CLIENT:25
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.08it/s]                                              {'loss': 5.5181, 'grad_norm': 5.991852760314941, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.08it/s]  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]                                              {'loss': 3.5894, 'grad_norm': 5.994556427001953, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.08it/s]  8%|▊         | 3/40 [00:00<00:11,  3.13it/s]                                              {'loss': 3.9845, 'grad_norm': 6.804184436798096, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.13it/s] 10%|█         | 4/40 [00:01<00:11,  3.10it/s]                                              {'loss': 4.0262, 'grad_norm': 8.9246826171875, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.10it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s]                                              {'loss': 3.6151, 'grad_norm': 8.74477767944336, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 1.3155, 'grad_norm': 7.974430561065674, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 2.1488, 'grad_norm': 13.510960578918457, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 2.8017, 'grad_norm': 55.73577880859375, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.06it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s]                                              {'loss': 0.9608, 'grad_norm': 8.6854829788208, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.58it/s]                                               {'loss': 0.6403, 'grad_norm': 6.300070762634277, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.58it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s]                                               {'loss': 1.507, 'grad_norm': 9.596600532531738, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s] 30%|███       | 12/40 [00:03<00:08,  3.30it/s]                                               {'loss': 1.1058, 'grad_norm': 7.440927028656006, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.30it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.21it/s]                                               {'loss': 1.016, 'grad_norm': 5.9860382080078125, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.21it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.1164, 'grad_norm': 5.414809226989746, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 2.0812, 'grad_norm': 8.013075828552246, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 2.5698, 'grad_norm': 15.031530380249023, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 0.2255, 'grad_norm': 3.2565219402313232, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.6125, 'grad_norm': 4.86522912979126, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s]                                               {'loss': 0.5245, 'grad_norm': 4.575216293334961, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s] 50%|█████     | 20/40 [00:06<00:06,  3.31it/s]                                               {'loss': 0.5698, 'grad_norm': 4.24727725982666, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.603, 'grad_norm': 4.903886318206787, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.4811, 'grad_norm': 4.7592244148254395, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.6181, 'grad_norm': 3.611161470413208, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.5582, 'grad_norm': 13.656229019165039, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s]                                               {'loss': 0.3098, 'grad_norm': 3.140878915786743, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s]                                               {'loss': 0.1195, 'grad_norm': 1.7959613800048828, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s]                                               {'loss': 0.2709, 'grad_norm': 2.199467658996582, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s] 70%|███████   | 28/40 [00:08<00:03,  3.34it/s]                                               {'loss': 0.213, 'grad_norm': 2.7394416332244873, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.34it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.0855, 'grad_norm': 1.6835793256759644, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s]                                               {'loss': 0.2669, 'grad_norm': 1.8713220357894897, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.2346, 'grad_norm': 2.99194598197937, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.1986, 'grad_norm': 28.844831466674805, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.87it/s]                                               {'loss': 0.1246, 'grad_norm': 1.5835721492767334, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.87it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.61it/s]                                               {'loss': 0.0902, 'grad_norm': 1.53994882106781, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.61it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s]                                               {'loss': 0.1083, 'grad_norm': 1.122886300086975, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.122, 'grad_norm': 2.5725367069244385, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.0411, 'grad_norm': 1.3892796039581299, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.1756, 'grad_norm': 7.702712535858154, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.1354, 'grad_norm': 6.267806529998779, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.1312, 'grad_norm': 6.239475250244141, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 12.0298, 'train_samples_per_second': 46.967, 'train_steps_per_second': 3.325, 'train_loss': 1.1204069435596467, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.13it/s]100%|██████████| 40/40 [00:12<00:00,  3.33it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 11.12it/s]  1%|          | 4/471 [00:00<01:06,  7.03it/s]  1%|          | 5/471 [00:00<01:11,  6.49it/s]  1%|▏         | 6/471 [00:00<01:15,  6.13it/s]  1%|▏         | 7/471 [00:01<01:18,  5.92it/s]  2%|▏         | 8/471 [00:01<01:20,  5.78it/s]  2%|▏         | 9/471 [00:01<01:20,  5.72it/s]  2%|▏         | 10/471 [00:01<01:21,  5.67it/s]  2%|▏         | 11/471 [00:01<01:21,  5.62it/s]  3%|▎         | 12/471 [00:01<01:22,  5.57it/s]  3%|▎         | 13/471 [00:02<01:22,  5.53it/s]  3%|▎         | 14/471 [00:02<01:22,  5.51it/s]  3%|▎         | 15/471 [00:02<01:22,  5.51it/s]  3%|▎         | 16/471 [00:02<01:22,  5.50it/s]  4%|▎         | 17/471 [00:02<01:22,  5.50it/s]  4%|▍         | 18/471 [00:03<01:22,  5.49it/s]  4%|▍         | 19/471 [00:03<01:22,  5.48it/s]  4%|▍         | 20/471 [00:03<01:22,  5.48it/s]  4%|▍         | 21/471 [00:03<01:22,  5.49it/s]  5%|▍         | 22/471 [00:03<01:21,  5.48it/s]  5%|▍         | 23/471 [00:04<01:21,  5.47it/s]  5%|▌         | 24/471 [00:04<01:21,  5.46it/s]  5%|▌         | 25/471 [00:04<01:21,  5.48it/s]  6%|▌         | 26/471 [00:04<01:21,  5.48it/s]  6%|▌         | 27/471 [00:04<01:21,  5.47it/s]  6%|▌         | 28/471 [00:04<01:20,  5.48it/s]  6%|▌         | 29/471 [00:05<01:20,  5.46it/s]  6%|▋         | 30/471 [00:05<01:21,  5.44it/s]  7%|▋         | 31/471 [00:05<01:20,  5.45it/s]  7%|▋         | 32/471 [00:05<01:20,  5.46it/s]  7%|▋         | 33/471 [00:05<01:19,  5.50it/s]  7%|▋         | 34/471 [00:06<01:19,  5.49it/s]  7%|▋         | 35/471 [00:06<01:19,  5.47it/s]  8%|▊         | 36/471 [00:06<01:19,  5.48it/s]  8%|▊         | 37/471 [00:06<01:19,  5.46it/s]  8%|▊         | 38/471 [00:06<01:19,  5.46it/s]  8%|▊         | 39/471 [00:06<01:19,  5.46it/s]  8%|▊         | 40/471 [00:07<01:18,  5.46it/s]  9%|▊         | 41/471 [00:07<01:18,  5.47it/s]  9%|▉         | 42/471 [00:07<01:18,  5.46it/s]  9%|▉         | 43/471 [00:07<01:18,  5.46it/s]  9%|▉         | 44/471 [00:07<01:18,  5.47it/s] 10%|▉         | 45/471 [00:08<01:17,  5.47it/s] 10%|▉         | 46/471 [00:08<01:17,  5.46it/s] 10%|▉         | 47/471 [00:08<01:17,  5.47it/s] 10%|█         | 48/471 [00:08<01:17,  5.48it/s] 10%|█         | 49/471 [00:08<01:17,  5.47it/s] 11%|█         | 50/471 [00:08<01:17,  5.45it/s] 11%|█         | 51/471 [00:09<01:17,  5.45it/s] 11%|█         | 52/471 [00:09<01:16,  5.46it/s] 11%|█▏        | 53/471 [00:09<01:16,  5.45it/s] 11%|█▏        | 54/471 [00:09<01:16,  5.46it/s] 12%|█▏        | 55/471 [00:09<01:16,  5.44it/s] 12%|█▏        | 56/471 [00:10<01:16,  5.44it/s] 12%|█▏        | 57/471 [00:10<01:16,  5.44it/s] 12%|█▏        | 58/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 59/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 60/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 61/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 62/471 [00:11<01:15,  5.45it/s] 13%|█▎        | 63/471 [00:11<01:14,  5.44it/s] 14%|█▎        | 64/471 [00:11<01:14,  5.45it/s] 14%|█▍        | 65/471 [00:11<01:14,  5.44it/s] 14%|█▍        | 66/471 [00:11<01:14,  5.43it/s] 14%|█▍        | 67/471 [00:12<01:14,  5.43it/s] 14%|█▍        | 68/471 [00:12<01:14,  5.43it/s] 15%|█▍        | 69/471 [00:12<01:13,  5.45it/s] 15%|█▍        | 70/471 [00:12<01:13,  5.43it/s] 15%|█▌        | 71/471 [00:12<01:13,  5.41it/s] 15%|█▌        | 72/471 [00:12<01:13,  5.42it/s] 15%|█▌        | 73/471 [00:13<01:13,  5.43it/s] 16%|█▌        | 74/471 [00:13<01:12,  5.45it/s] 16%|█▌        | 75/471 [00:13<01:12,  5.44it/s] 16%|█▌        | 76/471 [00:13<01:12,  5.45it/s] 16%|█▋        | 77/471 [00:13<01:12,  5.45it/s] 17%|█▋        | 78/471 [00:14<01:12,  5.43it/s] 17%|█▋        | 79/471 [00:14<01:12,  5.43it/s] 17%|█▋        | 80/471 [00:14<01:12,  5.43it/s] 17%|█▋        | 81/471 [00:14<01:11,  5.46it/s] 17%|█▋        | 82/471 [00:14<01:11,  5.47it/s] 18%|█▊        | 83/471 [00:15<01:11,  5.45it/s] 18%|█▊        | 84/471 [00:15<01:10,  5.45it/s] 18%|█▊        | 85/471 [00:15<01:10,  5.45it/s] 18%|█▊        | 86/471 [00:15<01:10,  5.43it/s] 18%|█▊        | 87/471 [00:15<01:10,  5.45it/s] 19%|█▊        | 88/471 [00:15<01:10,  5.46it/s] 19%|█▉        | 89/471 [00:16<01:10,  5.44it/s] 19%|█▉        | 90/471 [00:16<01:10,  5.44it/s] 19%|█▉        | 91/471 [00:16<01:09,  5.44it/s] 20%|█▉        | 92/471 [00:16<01:09,  5.44it/s] 20%|█▉        | 93/471 [00:16<01:09,  5.45it/s] 20%|█▉        | 94/471 [00:17<01:09,  5.45it/s] 20%|██        | 95/471 [00:17<01:08,  5.46it/s] 20%|██        | 96/471 [00:17<01:08,  5.47it/s] 21%|██        | 97/471 [00:17<01:08,  5.43it/s] 21%|██        | 98/471 [00:17<01:08,  5.44it/s] 21%|██        | 99/471 [00:17<01:08,  5.45it/s] 21%|██        | 100/471 [00:18<01:08,  5.45it/s] 21%|██▏       | 101/471 [00:18<01:07,  5.45it/s] 22%|██▏       | 102/471 [00:18<01:08,  5.43it/s] 22%|██▏       | 103/471 [00:18<01:07,  5.42it/s] 22%|██▏       | 104/471 [00:18<01:07,  5.41it/s] 22%|██▏       | 105/471 [00:19<01:07,  5.41it/s] 23%|██▎       | 106/471 [00:19<01:07,  5.43it/s] 23%|██▎       | 107/471 [00:19<01:07,  5.43it/s] 23%|██▎       | 108/471 [00:19<01:06,  5.43it/s] 23%|██▎       | 109/471 [00:19<01:06,  5.44it/s] 23%|██▎       | 110/471 [00:19<01:06,  5.46it/s] 24%|██▎       | 111/471 [00:20<01:06,  5.45it/s] 24%|██▍       | 112/471 [00:20<01:06,  5.43it/s] 24%|██▍       | 113/471 [00:20<01:05,  5.46it/s] 24%|██▍       | 114/471 [00:20<01:05,  5.45it/s] 24%|██▍       | 115/471 [00:20<01:05,  5.44it/s] 25%|██▍       | 116/471 [00:21<01:05,  5.45it/s] 25%|██▍       | 117/471 [00:21<01:05,  5.42it/s] 25%|██▌       | 118/471 [00:21<01:05,  5.42it/s] 25%|██▌       | 119/471 [00:21<01:04,  5.42it/s] 25%|██▌       | 120/471 [00:21<01:04,  5.43it/s] 26%|██▌       | 121/471 [00:21<01:04,  5.42it/s] 26%|██▌       | 122/471 [00:22<01:04,  5.42it/s] 26%|██▌       | 123/471 [00:22<01:04,  5.42it/s] 26%|██▋       | 124/471 [00:22<01:04,  5.42it/s] 27%|██▋       | 125/471 [00:22<01:03,  5.43it/s] 27%|██▋       | 126/471 [00:22<01:03,  5.42it/s] 27%|██▋       | 127/471 [00:23<01:03,  5.43it/s] 27%|██▋       | 128/471 [00:23<01:03,  5.41it/s] 27%|██▋       | 129/471 [00:23<01:02,  5.44it/s] 28%|██▊       | 130/471 [00:23<01:02,  5.44it/s] 28%|██▊       | 131/471 [00:23<01:02,  5.42it/s] 28%|██▊       | 132/471 [00:24<01:02,  5.43it/s] 28%|██▊       | 133/471 [00:24<01:02,  5.42it/s] 28%|██▊       | 134/471 [00:24<01:02,  5.41it/s] 29%|██▊       | 135/471 [00:24<01:02,  5.41it/s] 29%|██▉       | 136/471 [00:24<01:01,  5.41it/s] 29%|██▉       | 137/471 [00:24<01:01,  5.41it/s] 29%|██▉       | 138/471 [00:25<01:01,  5.41it/s] 30%|██▉       | 139/471 [00:25<01:01,  5.41it/s] 30%|██▉       | 140/471 [00:25<01:01,  5.41it/s] 30%|██▉       | 141/471 [00:25<01:00,  5.41it/s] 30%|███       | 142/471 [00:25<01:00,  5.42it/s] 30%|███       | 143/471 [00:26<01:00,  5.41it/s] 31%|███       | 144/471 [00:26<01:00,  5.41it/s] 31%|███       | 145/471 [00:26<01:00,  5.42it/s] 31%|███       | 146/471 [00:26<01:00,  5.42it/s] 31%|███       | 147/471 [00:26<01:00,  5.40it/s] 31%|███▏      | 148/471 [00:26<00:59,  5.41it/s] 32%|███▏      | 149/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 150/471 [00:27<00:59,  5.37it/s] 32%|███▏      | 151/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 152/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 153/471 [00:27<00:58,  5.40it/s] 33%|███▎      | 154/471 [00:28<00:58,  5.41it/s] 33%|███▎      | 155/471 [00:28<00:58,  5.39it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.40it/s] 33%|███▎      | 157/471 [00:28<00:57,  5.42it/s] 34%|███▎      | 158/471 [00:28<00:57,  5.43it/s] 34%|███▍      | 159/471 [00:29<00:57,  5.43it/s] 34%|███▍      | 160/471 [00:29<00:57,  5.41it/s] 34%|███▍      | 161/471 [00:29<00:57,  5.39it/s] 34%|███▍      | 162/471 [00:29<00:57,  5.38it/s] 35%|███▍      | 163/471 [00:29<00:57,  5.38it/s] 35%|███▍      | 164/471 [00:29<00:56,  5.40it/s] 35%|███▌      | 165/471 [00:30<00:56,  5.41it/s] 35%|███▌      | 166/471 [00:30<00:56,  5.38it/s] 35%|███▌      | 167/471 [00:30<00:56,  5.38it/s] 36%|███▌      | 168/471 [00:30<00:56,  5.39it/s] 36%|███▌      | 169/471 [00:30<00:56,  5.37it/s] 36%|███▌      | 170/471 [00:31<00:55,  5.41it/s] 36%|███▋      | 171/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 172/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 173/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 174/471 [00:31<00:55,  5.37it/s] 37%|███▋      | 175/471 [00:31<00:54,  5.39it/s] 37%|███▋      | 176/471 [00:32<00:54,  5.44it/s] 38%|███▊      | 177/471 [00:32<00:54,  5.40it/s] 38%|███▊      | 178/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 179/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 180/471 [00:32<00:54,  5.38it/s] 38%|███▊      | 181/471 [00:33<00:53,  5.39it/s] 39%|███▊      | 182/471 [00:33<00:53,  5.39it/s] 39%|███▉      | 183/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 184/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 185/471 [00:33<00:53,  5.37it/s] 39%|███▉      | 186/471 [00:34<00:53,  5.38it/s] 40%|███▉      | 187/471 [00:34<00:52,  5.37it/s] 40%|███▉      | 188/471 [00:34<00:52,  5.36it/s] 40%|████      | 189/471 [00:34<00:52,  5.38it/s] 40%|████      | 190/471 [00:34<00:52,  5.37it/s] 41%|████      | 191/471 [00:34<00:52,  5.36it/s] 41%|████      | 192/471 [00:35<00:51,  5.38it/s] 41%|████      | 193/471 [00:35<00:51,  5.40it/s] 41%|████      | 194/471 [00:35<00:51,  5.39it/s] 41%|████▏     | 195/471 [00:35<00:51,  5.37it/s] 42%|████▏     | 196/471 [00:35<00:51,  5.37it/s] 42%|████▏     | 197/471 [00:36<00:50,  5.40it/s] 42%|████▏     | 198/471 [00:36<00:50,  5.40it/s] 42%|████▏     | 199/471 [00:36<00:50,  5.39it/s] 42%|████▏     | 200/471 [00:36<00:50,  5.37it/s] 43%|████▎     | 201/471 [00:36<00:50,  5.40it/s] 43%|████▎     | 202/471 [00:37<00:49,  5.39it/s] 43%|████▎     | 203/471 [00:37<00:49,  5.39it/s] 43%|████▎     | 204/471 [00:37<00:49,  5.37it/s] 44%|████▎     | 205/471 [00:37<00:49,  5.38it/s] 44%|████▎     | 206/471 [00:37<00:49,  5.39it/s] 44%|████▍     | 207/471 [00:37<00:49,  5.38it/s] 44%|████▍     | 208/471 [00:38<00:48,  5.41it/s] 44%|████▍     | 209/471 [00:38<00:48,  5.41it/s] 45%|████▍     | 210/471 [00:38<00:48,  5.40it/s] 45%|████▍     | 211/471 [00:38<00:48,  5.38it/s] 45%|████▌     | 212/471 [00:38<00:48,  5.38it/s] 45%|████▌     | 213/471 [00:39<00:47,  5.38it/s] 45%|████▌     | 214/471 [00:39<00:47,  5.39it/s] 46%|████▌     | 215/471 [00:39<00:47,  5.39it/s] 46%|████▌     | 216/471 [00:39<00:47,  5.37it/s] 46%|████▌     | 217/471 [00:39<00:47,  5.37it/s] 46%|████▋     | 218/471 [00:39<00:47,  5.37it/s] 46%|████▋     | 219/471 [00:40<00:47,  5.36it/s] 47%|████▋     | 220/471 [00:40<00:46,  5.36it/s] 47%|████▋     | 221/471 [00:40<00:46,  5.35it/s] 47%|████▋     | 222/471 [00:40<00:46,  5.37it/s] 47%|████▋     | 223/471 [00:40<00:45,  5.39it/s] 48%|████▊     | 224/471 [00:41<00:45,  5.38it/s] 48%|████▊     | 225/471 [00:41<00:45,  5.37it/s] 48%|████▊     | 226/471 [00:41<00:45,  5.36it/s] 48%|████▊     | 227/471 [00:41<00:45,  5.36it/s] 48%|████▊     | 228/471 [00:41<00:45,  5.37it/s] 49%|████▊     | 229/471 [00:42<00:45,  5.36it/s] 49%|████▉     | 230/471 [00:42<00:44,  5.36it/s] 49%|████▉     | 231/471 [00:42<00:44,  5.36it/s] 49%|████▉     | 232/471 [00:42<00:44,  5.37it/s] 49%|████▉     | 233/471 [00:42<00:44,  5.38it/s] 50%|████▉     | 234/471 [00:42<00:44,  5.37it/s] 50%|████▉     | 235/471 [00:43<00:44,  5.36it/s] 50%|█████     | 236/471 [00:43<00:43,  5.38it/s] 50%|█████     | 237/471 [00:43<00:43,  5.37it/s] 51%|█████     | 238/471 [00:43<00:43,  5.36it/s] 51%|█████     | 239/471 [00:43<00:43,  5.38it/s] 51%|█████     | 240/471 [00:44<00:43,  5.37it/s] 51%|█████     | 241/471 [00:44<00:42,  5.35it/s] 51%|█████▏    | 242/471 [00:44<00:42,  5.37it/s] 52%|█████▏    | 243/471 [00:44<00:42,  5.37it/s] 52%|█████▏    | 244/471 [00:44<00:42,  5.36it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.37it/s] 52%|█████▏    | 246/471 [00:45<00:41,  5.38it/s] 52%|█████▏    | 247/471 [00:45<00:41,  5.40it/s] 53%|█████▎    | 248/471 [00:45<00:41,  5.39it/s] 53%|█████▎    | 249/471 [00:45<00:41,  5.39it/s] 53%|█████▎    | 250/471 [00:45<00:41,  5.38it/s] 53%|█████▎    | 251/471 [00:46<00:40,  5.38it/s] 54%|█████▎    | 252/471 [00:46<00:40,  5.37it/s] 54%|█████▎    | 253/471 [00:46<00:40,  5.36it/s] 54%|█████▍    | 254/471 [00:46<00:40,  5.37it/s] 54%|█████▍    | 255/471 [00:46<00:40,  5.37it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.36it/s] 55%|█████▍    | 257/471 [00:47<00:39,  5.36it/s] 55%|█████▍    | 258/471 [00:47<00:39,  5.36it/s] 55%|█████▍    | 259/471 [00:47<00:39,  5.36it/s] 55%|█████▌    | 260/471 [00:47<00:39,  5.36it/s] 55%|█████▌    | 261/471 [00:47<00:39,  5.37it/s] 56%|█████▌    | 262/471 [00:48<00:38,  5.38it/s] 56%|█████▌    | 263/471 [00:48<00:38,  5.37it/s] 56%|█████▌    | 264/471 [00:48<00:38,  5.36it/s] 56%|█████▋    | 265/471 [00:48<00:38,  5.35it/s] 56%|█████▋    | 266/471 [00:48<00:38,  5.35it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.36it/s] 57%|█████▋    | 268/471 [00:49<00:38,  5.33it/s] 57%|█████▋    | 269/471 [00:49<00:37,  5.35it/s] 57%|█████▋    | 270/471 [00:49<00:37,  5.36it/s] 58%|█████▊    | 271/471 [00:49<00:37,  5.35it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.37it/s] 58%|█████▊    | 273/471 [00:50<00:36,  5.37it/s] 58%|█████▊    | 274/471 [00:50<00:36,  5.39it/s] 58%|█████▊    | 275/471 [00:50<00:36,  5.40it/s] 59%|█████▊    | 276/471 [00:50<00:36,  5.38it/s] 59%|█████▉    | 277/471 [00:50<00:36,  5.37it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.35it/s] 59%|█████▉    | 279/471 [00:51<00:35,  5.36it/s] 59%|█████▉    | 280/471 [00:51<00:35,  5.37it/s] 60%|█████▉    | 281/471 [00:51<00:35,  5.36it/s] 60%|█████▉    | 282/471 [00:51<00:35,  5.35it/s] 60%|██████    | 283/471 [00:52<00:35,  5.33it/s] 60%|██████    | 284/471 [00:52<00:35,  5.34it/s] 61%|██████    | 285/471 [00:52<00:34,  5.33it/s] 61%|██████    | 286/471 [00:52<00:34,  5.32it/s] 61%|██████    | 287/471 [00:52<00:34,  5.32it/s] 61%|██████    | 288/471 [00:53<00:34,  5.32it/s] 61%|██████▏   | 289/471 [00:53<00:34,  5.34it/s] 62%|██████▏   | 290/471 [00:53<00:33,  5.34it/s] 62%|██████▏   | 291/471 [00:53<00:33,  5.33it/s] 62%|██████▏   | 292/471 [00:53<00:33,  5.34it/s] 62%|██████▏   | 293/471 [00:53<00:33,  5.36it/s] 62%|██████▏   | 294/471 [00:54<00:33,  5.35it/s] 63%|██████▎   | 295/471 [00:54<00:32,  5.36it/s] 63%|██████▎   | 296/471 [00:54<00:32,  5.37it/s] 63%|██████▎   | 297/471 [00:54<00:32,  5.36it/s] 63%|██████▎   | 298/471 [00:54<00:32,  5.34it/s] 63%|██████▎   | 299/471 [00:55<00:32,  5.35it/s] 64%|██████▎   | 300/471 [00:55<00:32,  5.34it/s] 64%|██████▍   | 301/471 [00:55<00:31,  5.34it/s] 64%|██████▍   | 302/471 [00:55<00:31,  5.34it/s] 64%|██████▍   | 303/471 [00:55<00:31,  5.35it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.35it/s] 65%|██████▍   | 305/471 [00:56<00:31,  5.35it/s] 65%|██████▍   | 306/471 [00:56<00:30,  5.35it/s] 65%|██████▌   | 307/471 [00:56<00:30,  5.34it/s] 65%|██████▌   | 308/471 [00:56<00:30,  5.33it/s] 66%|██████▌   | 309/471 [00:56<00:30,  5.33it/s] 66%|██████▌   | 310/471 [00:57<00:30,  5.34it/s] 66%|██████▌   | 311/471 [00:57<00:29,  5.34it/s] 66%|██████▌   | 312/471 [00:57<00:29,  5.35it/s] 66%|██████▋   | 313/471 [00:57<00:29,  5.37it/s] 67%|██████▋   | 314/471 [00:57<00:29,  5.36it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.36it/s] 67%|██████▋   | 316/471 [00:58<00:28,  5.37it/s] 67%|██████▋   | 317/471 [00:58<00:28,  5.36it/s] 68%|██████▊   | 318/471 [00:58<00:28,  5.36it/s] 68%|██████▊   | 319/471 [00:58<00:28,  5.34it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.34it/s] 68%|██████▊   | 321/471 [00:59<00:28,  5.33it/s] 68%|██████▊   | 322/471 [00:59<00:27,  5.33it/s] 69%|██████▊   | 323/471 [00:59<00:27,  5.33it/s] 69%|██████▉   | 324/471 [00:59<00:27,  5.32it/s] 69%|██████▉   | 325/471 [00:59<00:27,  5.32it/s] 69%|██████▉   | 326/471 [01:00<00:27,  5.32it/s] 69%|██████▉   | 327/471 [01:00<00:26,  5.35it/s] 70%|██████▉   | 328/471 [01:00<00:26,  5.34it/s] 70%|██████▉   | 329/471 [01:00<00:26,  5.34it/s] 70%|███████   | 330/471 [01:00<00:26,  5.35it/s] 70%|███████   | 331/471 [01:01<00:26,  5.36it/s] 70%|███████   | 332/471 [01:01<00:26,  5.34it/s] 71%|███████   | 333/471 [01:01<00:25,  5.35it/s] 71%|███████   | 334/471 [01:01<00:25,  5.35it/s] 71%|███████   | 335/471 [01:01<00:25,  5.34it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.35it/s] 72%|███████▏  | 337/471 [01:02<00:24,  5.37it/s] 72%|███████▏  | 338/471 [01:02<00:24,  5.36it/s] 72%|███████▏  | 339/471 [01:02<00:24,  5.34it/s] 72%|███████▏  | 340/471 [01:02<00:24,  5.34it/s] 72%|███████▏  | 341/471 [01:02<00:24,  5.33it/s] 73%|███████▎  | 342/471 [01:03<00:24,  5.35it/s] 73%|███████▎  | 343/471 [01:03<00:23,  5.34it/s] 73%|███████▎  | 344/471 [01:03<00:23,  5.35it/s] 73%|███████▎  | 345/471 [01:03<00:23,  5.34it/s] 73%|███████▎  | 346/471 [01:03<00:23,  5.33it/s] 74%|███████▎  | 347/471 [01:04<00:23,  5.34it/s] 74%|███████▍  | 348/471 [01:04<00:22,  5.36it/s] 74%|███████▍  | 349/471 [01:04<00:22,  5.35it/s] 74%|███████▍  | 350/471 [01:04<00:22,  5.34it/s] 75%|███████▍  | 351/471 [01:04<00:22,  5.37it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.34it/s] 75%|███████▍  | 353/471 [01:05<00:22,  5.33it/s] 75%|███████▌  | 354/471 [01:05<00:21,  5.33it/s] 75%|███████▌  | 355/471 [01:05<00:21,  5.33it/s] 76%|███████▌  | 356/471 [01:05<00:21,  5.35it/s] 76%|███████▌  | 357/471 [01:05<00:21,  5.34it/s] 76%|███████▌  | 358/471 [01:06<00:21,  5.34it/s] 76%|███████▌  | 359/471 [01:06<00:20,  5.35it/s] 76%|███████▋  | 360/471 [01:06<00:20,  5.35it/s] 77%|███████▋  | 361/471 [01:06<00:20,  5.34it/s] 77%|███████▋  | 362/471 [01:06<00:20,  5.35it/s] 77%|███████▋  | 363/471 [01:07<00:20,  5.35it/s] 77%|███████▋  | 364/471 [01:07<00:19,  5.35it/s] 77%|███████▋  | 365/471 [01:07<00:19,  5.34it/s] 78%|███████▊  | 366/471 [01:07<00:19,  5.32it/s] 78%|███████▊  | 367/471 [01:07<00:19,  5.33it/s] 78%|███████▊  | 368/471 [01:08<00:19,  5.33it/s] 78%|███████▊  | 369/471 [01:08<00:19,  5.33it/s] 79%|███████▊  | 370/471 [01:08<00:18,  5.32it/s] 79%|███████▉  | 371/471 [01:08<00:18,  5.32it/s] 79%|███████▉  | 372/471 [01:08<00:18,  5.31it/s] 79%|███████▉  | 373/471 [01:08<00:18,  5.31it/s] 79%|███████▉  | 374/471 [01:09<00:18,  5.32it/s] 80%|███████▉  | 375/471 [01:09<00:18,  5.32it/s] 80%|███████▉  | 376/471 [01:09<00:17,  5.32it/s] 80%|████████  | 377/471 [01:09<00:17,  5.33it/s] 80%|████████  | 378/471 [01:09<00:17,  5.34it/s] 80%|████████  | 379/471 [01:10<00:17,  5.32it/s] 81%|████████  | 380/471 [01:10<00:17,  5.32it/s] 81%|████████  | 381/471 [01:10<00:16,  5.33it/s] 81%|████████  | 382/471 [01:10<00:16,  5.32it/s] 81%|████████▏ | 383/471 [01:10<00:16,  5.31it/s] 82%|████████▏ | 384/471 [01:11<00:16,  5.29it/s] 82%|████████▏ | 385/471 [01:11<00:16,  5.29it/s] 82%|████████▏ | 386/471 [01:11<00:16,  5.29it/s] 82%|████████▏ | 387/471 [01:11<00:15,  5.30it/s] 82%|████████▏ | 388/471 [01:11<00:15,  5.30it/s] 83%|████████▎ | 389/471 [01:11<00:15,  5.31it/s] 83%|████████▎ | 390/471 [01:12<00:15,  5.31it/s] 83%|████████▎ | 391/471 [01:12<00:15,  5.31it/s] 83%|████████▎ | 392/471 [01:12<00:14,  5.31it/s] 83%|████████▎ | 393/471 [01:12<00:14,  5.26it/s] 84%|████████▎ | 394/471 [01:12<00:14,  5.31it/s] 84%|████████▍ | 395/471 [01:13<00:14,  5.32it/s] 84%|████████▍ | 396/471 [01:13<00:14,  5.32it/s] 84%|████████▍ | 397/471 [01:13<00:13,  5.33it/s] 85%|████████▍ | 398/471 [01:13<00:13,  5.30it/s] 85%|████████▍ | 399/471 [01:13<00:13,  5.30it/s] 85%|████████▍ | 400/471 [01:14<00:13,  5.30it/s] 85%|████████▌ | 401/471 [01:14<00:13,  5.32it/s] 85%|████████▌ | 402/471 [01:14<00:12,  5.33it/s] 86%|████████▌ | 403/471 [01:14<00:12,  5.31it/s] 86%|████████▌ | 404/471 [01:14<00:12,  5.32it/s] 86%|████████▌ | 405/471 [01:14<00:12,  5.30it/s] 86%|████████▌ | 406/471 [01:15<00:12,  5.33it/s] 86%|████████▋ | 407/471 [01:15<00:11,  5.36it/s] 87%|████████▋ | 408/471 [01:15<00:11,  5.33it/s] 87%|████████▋ | 409/471 [01:15<00:11,  5.31it/s] 87%|████████▋ | 410/471 [01:15<00:11,  5.32it/s] 87%|████████▋ | 411/471 [01:16<00:11,  5.34it/s] 87%|████████▋ | 412/471 [01:16<00:11,  5.33it/s] 88%|████████▊ | 413/471 [01:16<00:10,  5.33it/s] 88%|████████▊ | 414/471 [01:16<00:10,  5.33it/s] 88%|████████▊ | 415/471 [01:16<00:10,  5.32it/s] 88%|████████▊ | 416/471 [01:17<00:10,  5.31it/s] 89%|████████▊ | 417/471 [01:17<00:10,  5.32it/s] 89%|████████▊ | 418/471 [01:17<00:09,  5.31it/s] 89%|████████▉ | 419/471 [01:17<00:09,  5.32it/s] 89%|████████▉ | 420/471 [01:17<00:09,  5.35it/s] 89%|████████▉ | 421/471 [01:17<00:09,  5.34it/s] 90%|████████▉ | 422/471 [01:18<00:09,  5.34it/s] 90%|████████▉ | 423/471 [01:18<00:08,  5.34it/s] 90%|█████████ | 424/471 [01:18<00:08,  5.33it/s] 90%|█████████ | 425/471 [01:18<00:08,  5.34it/s] 90%|█████████ | 426/471 [01:18<00:08,  5.33it/s] 91%|█████████ | 427/471 [01:19<00:08,  5.33it/s] 91%|█████████ | 428/471 [01:19<00:08,  5.32it/s] 91%|█████████ | 429/471 [01:19<00:07,  5.32it/s] 91%|█████████▏| 430/471 [01:19<00:07,  5.32it/s] 92%|█████████▏| 431/471 [01:19<00:07,  5.30it/s] 92%|█████████▏| 432/471 [01:20<00:07,  5.31it/s] 92%|█████████▏| 433/471 [01:20<00:07,  5.32it/s] 92%|█████████▏| 434/471 [01:20<00:06,  5.32it/s] 92%|█████████▏| 435/471 [01:20<00:06,  5.31it/s] 93%|█████████▎| 436/471 [01:20<00:06,  5.32it/s] 93%|█████████▎| 437/471 [01:20<00:06,  5.31it/s] 93%|█████████▎| 438/471 [01:21<00:06,  5.31it/s] 93%|█████████▎| 439/471 [01:21<00:06,  5.32it/s] 93%|█████████▎| 440/471 [01:21<00:05,  5.34it/s] 94%|█████████▎| 441/471 [01:21<00:05,  5.33it/s] 94%|█████████▍| 442/471 [01:21<00:05,  5.34it/s] 94%|█████████▍| 443/471 [01:22<00:05,  5.33it/s] 94%|█████████▍| 444/471 [01:22<00:05,  5.33it/s] 94%|█████████▍| 445/471 [01:22<00:04,  5.33it/s] 95%|█████████▍| 446/471 [01:22<00:04,  5.31it/s] 95%|█████████▍| 447/471 [01:22<00:04,  5.32it/s] 95%|█████████▌| 448/471 [01:23<00:04,  5.34it/s] 95%|█████████▌| 449/471 [01:23<00:04,  5.33it/s] 96%|█████████▌| 450/471 [01:23<00:03,  5.32it/s] 96%|█████████▌| 451/471 [01:23<00:03,  5.32it/s] 96%|█████████▌| 452/471 [01:23<00:03,  5.32it/s] 96%|█████████▌| 453/471 [01:23<00:03,  5.33it/s] 96%|█████████▋| 454/471 [01:24<00:03,  5.31it/s] 97%|█████████▋| 455/471 [01:24<00:03,  5.29it/s] 97%|█████████▋| 456/471 [01:24<00:02,  5.30it/s] 97%|█████████▋| 457/471 [01:24<00:02,  5.30it/s] 97%|█████████▋| 458/471 [01:24<00:02,  5.31it/s] 97%|█████████▋| 459/471 [01:25<00:02,  5.34it/s] 98%|█████████▊| 460/471 [01:25<00:02,  5.33it/s] 98%|█████████▊| 461/471 [01:25<00:01,  5.31it/s] 98%|█████████▊| 462/471 [01:25<00:01,  5.30it/s] 98%|█████████▊| 463/471 [01:25<00:01,  5.30it/s] 99%|█████████▊| 464/471 [01:26<00:01,  5.31it/s] 99%|█████████▊| 465/471 [01:26<00:01,  5.32it/s] 99%|█████████▉| 466/471 [01:26<00:00,  5.31it/s] 99%|█████████▉| 467/471 [01:26<00:00,  5.29it/s] 99%|█████████▉| 468/471 [01:26<00:00,  5.28it/s]100%|█████████▉| 469/471 [01:26<00:00,  5.29it/s]100%|█████████▉| 470/471 [01:27<00:00,  5.30it/s]100%|██████████| 471/471 [01:27<00:00,  5.67it/s]100%|██████████| 471/471 [01:27<00:00,  5.39it/s]
{'eval_loss': 5.164374828338623, 'eval_model_preparation_time': 0.0055, 'eval_acc': 0.16423260754115773, 'eval_runtime': 87.5059, 'eval_samples_per_second': 86.074, 'eval_steps_per_second': 5.382}
ROUND:5
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.95it/s]                                              {'loss': 7.454, 'grad_norm': 6.488739967346191, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.95it/s]  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]                                              {'loss': 3.3475, 'grad_norm': 5.111725807189941, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]  8%|▊         | 3/40 [00:01<00:12,  2.97it/s]                                              {'loss': 4.1044, 'grad_norm': 10.628190994262695, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.97it/s] 10%|█         | 4/40 [00:01<00:12,  2.97it/s]                                              {'loss': 2.7639, 'grad_norm': 8.357196807861328, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.97it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.96it/s]                                              {'loss': 2.2317, 'grad_norm': 9.808574676513672, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.96it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.96it/s]                                              {'loss': 3.3769, 'grad_norm': 12.721625328063965, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.96it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 2.7986, 'grad_norm': 13.10664176940918, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 4.5205, 'grad_norm': 56.199275970458984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s]                                              {'loss': 1.1844, 'grad_norm': 4.847656726837158, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.83it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s]                                               {'loss': 1.3949, 'grad_norm': 8.845734596252441, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s]                                               {'loss': 1.5432, 'grad_norm': 11.139036178588867, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.39it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 1.3099, 'grad_norm': 12.243230819702148, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s]                                               {'loss': 0.9531, 'grad_norm': 8.76264476776123, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.5034, 'grad_norm': 12.402750015258789, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 1.136, 'grad_norm': 8.336462020874023, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.4614, 'grad_norm': 15.707826614379883, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.06it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.80it/s]                                               {'loss': 0.7649, 'grad_norm': 4.386669635772705, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.80it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s]                                               {'loss': 0.8091, 'grad_norm': 5.4684906005859375, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s]                                               {'loss': 0.6703, 'grad_norm': 5.6363525390625, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s] 50%|█████     | 20/40 [00:06<00:06,  3.26it/s]                                               {'loss': 0.6099, 'grad_norm': 4.384517669677734, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.26it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.4357, 'grad_norm': 4.182895660400391, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.5806, 'grad_norm': 2.410588026046753, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.8944, 'grad_norm': 6.845919609069824, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.0486, 'grad_norm': 1.998226284980774, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s]                                               {'loss': 0.7323, 'grad_norm': 3.4141597747802734, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.81it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s]                                               {'loss': 0.3157, 'grad_norm': 2.2246475219726562, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s]                                               {'loss': 0.8008, 'grad_norm': 5.403348445892334, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s] 70%|███████   | 28/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.231, 'grad_norm': 1.9906820058822632, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.27it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.2264, 'grad_norm': 3.338736057281494, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.11it/s]                                               {'loss': 0.1491, 'grad_norm': 2.6874923706054688, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.11it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.1799, 'grad_norm': 2.98463773727417, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.0693, 'grad_norm': 3.824765920639038, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.07it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.78it/s]                                               {'loss': 0.3806, 'grad_norm': 2.8143815994262695, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.78it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s]                                               {'loss': 0.0781, 'grad_norm': 1.7546766996383667, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.34it/s]                                               {'loss': 0.0681, 'grad_norm': 1.634386420249939, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.34it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.23it/s]                                               {'loss': 0.3833, 'grad_norm': 5.464772701263428, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.23it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1225, 'grad_norm': 2.274322748184204, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.2632, 'grad_norm': 0.7907474040985107, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.08it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.03it/s]                                               {'loss': 0.7009, 'grad_norm': 4.1473612785339355, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.03it/s]                                               {'loss': 0.1514, 'grad_norm': 4.368105888366699, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.03it/s]                                               {'train_runtime': 12.2949, 'train_samples_per_second': 45.954, 'train_steps_per_second': 3.253, 'train_loss': 1.2437500612810255, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.03it/s]100%|██████████| 40/40 [00:12<00:00,  3.25it/s]
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.96it/s]                                              {'loss': 4.132, 'grad_norm': 4.911755084991455, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.96it/s]  5%|▌         | 2/40 [00:00<00:12,  2.98it/s]                                              {'loss': 4.4592, 'grad_norm': 8.363295555114746, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.98it/s]  8%|▊         | 3/40 [00:01<00:12,  2.99it/s]                                              {'loss': 4.9123, 'grad_norm': 12.08668327331543, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.99it/s] 10%|█         | 4/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.8006, 'grad_norm': 11.025677680969238, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.00it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.7616, 'grad_norm': 11.57247543334961, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.0654, 'grad_norm': 12.389500617980957, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 2.3319, 'grad_norm': 10.495360374450684, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 5.6123, 'grad_norm': 49.55158233642578, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.71it/s]                                              {'loss': 1.3782, 'grad_norm': 7.510138034820557, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.71it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s]                                               {'loss': 2.0375, 'grad_norm': 11.431571006774902, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 1.4668, 'grad_norm': 5.949201583862305, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.27it/s]                                               {'loss': 0.796, 'grad_norm': 5.881062984466553, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.27it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.23it/s]                                               {'loss': 1.1692, 'grad_norm': 7.426214694976807, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.23it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.3078, 'grad_norm': 11.653654098510742, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.8987, 'grad_norm': 7.924548625946045, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.0445, 'grad_norm': 2.2597877979278564, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.78it/s]                                               {'loss': 0.4733, 'grad_norm': 4.321865558624268, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.78it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.55it/s]                                               {'loss': 0.4951, 'grad_norm': 4.388482570648193, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.55it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s]                                               {'loss': 0.4889, 'grad_norm': 4.042619705200195, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s] 50%|█████     | 20/40 [00:06<00:06,  3.26it/s]                                               {'loss': 0.3089, 'grad_norm': 2.9666600227355957, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.26it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.577, 'grad_norm': 2.67964243888855, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.1717, 'grad_norm': 3.2333908081054688, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.4376, 'grad_norm': 4.739598274230957, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.1928, 'grad_norm': 6.4983367919921875, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s]                                               {'loss': 0.1325, 'grad_norm': 2.206393003463745, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.6519, 'grad_norm': 6.034316062927246, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.1046, 'grad_norm': 1.7046698331832886, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s] 70%|███████   | 28/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.2158, 'grad_norm': 12.329336166381836, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.29it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.089, 'grad_norm': 1.2315576076507568, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.10it/s]                                               {'loss': 0.2866, 'grad_norm': 3.880439281463623, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.10it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.2227, 'grad_norm': 4.224794864654541, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.0176, 'grad_norm': 1.0467039346694946, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.07it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.78it/s]                                               {'loss': 0.0501, 'grad_norm': 0.9305461645126343, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.78it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.54it/s]                                               {'loss': 0.0307, 'grad_norm': 0.9060952067375183, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.54it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s]                                               {'loss': 0.0299, 'grad_norm': 0.6829596161842346, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s]                                               {'loss': 0.4318, 'grad_norm': 1.127099633216858, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.0426, 'grad_norm': 1.3555083274841309, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.0459, 'grad_norm': 1.1791505813598633, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.06, 'grad_norm': 1.728492259979248, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.0486, 'grad_norm': 3.7351863384246826, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.07it/s]                                               {'train_runtime': 12.1827, 'train_samples_per_second': 46.377, 'train_steps_per_second': 3.283, 'train_loss': 1.1194915954023599, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]100%|██████████| 40/40 [00:12<00:00,  3.28it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]                                              {'loss': 3.9852, 'grad_norm': 5.367492198944092, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]                                              {'loss': 3.7875, 'grad_norm': 6.091452598571777, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]  8%|▊         | 3/40 [00:00<00:12,  3.04it/s]                                              {'loss': 3.2877, 'grad_norm': 6.67678165435791, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.04it/s] 10%|█         | 4/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.0546, 'grad_norm': 9.48294448852539, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.03it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.1227, 'grad_norm': 10.035337448120117, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s]                                              {'loss': 2.5075, 'grad_norm': 10.04693603515625, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 3.4407, 'grad_norm': 13.842074394226074, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 0.1059, 'grad_norm': 4.570206165313721, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.01it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s]                                              {'loss': 0.7603, 'grad_norm': 7.535871982574463, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s]                                               {'loss': 1.6725, 'grad_norm': 9.42405891418457, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s]                                               {'loss': 1.8637, 'grad_norm': 6.2416791915893555, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s] 30%|███       | 12/40 [00:03<00:08,  3.30it/s]                                               {'loss': 0.6612, 'grad_norm': 4.221776485443115, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.30it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.23it/s]                                               {'loss': 2.0581, 'grad_norm': 10.585330963134766, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.23it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s]                                               {'loss': 0.4881, 'grad_norm': 5.450201511383057, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.7591, 'grad_norm': 8.0078125, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.7432, 'grad_norm': 36.11758041381836, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.78it/s]                                               {'loss': 0.8507, 'grad_norm': 12.035390853881836, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.78it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s]                                               {'loss': 0.847, 'grad_norm': 5.557439804077148, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s]                                               {'loss': 1.1263, 'grad_norm': 4.0375494956970215, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s] 50%|█████     | 20/40 [00:06<00:06,  3.31it/s]                                               {'loss': 0.6437, 'grad_norm': 2.7175381183624268, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.7645, 'grad_norm': 2.1295149326324463, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s]                                               {'loss': 0.4359, 'grad_norm': 3.01747989654541, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.06it/s]                                               {'loss': 0.6026, 'grad_norm': 6.079092502593994, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.06it/s]                                               {'loss': 0.0506, 'grad_norm': 1.7548160552978516, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.06it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.69it/s]                                               {'loss': 0.7345, 'grad_norm': 4.500195026397705, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.69it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.48it/s]                                               {'loss': 0.716, 'grad_norm': 2.5473792552948, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.48it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s]                                               {'loss': 0.4423, 'grad_norm': 2.1742610931396484, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s] 70%|███████   | 28/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.0696, 'grad_norm': 1.6413737535476685, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.26it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.1654, 'grad_norm': 2.8303987979888916, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.1778, 'grad_norm': 1.4625966548919678, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.6292, 'grad_norm': 6.227938175201416, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.0091, 'grad_norm': 0.5672551989555359, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.76it/s]                                               {'loss': 0.3384, 'grad_norm': 1.76059889793396, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.76it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s]                                               {'loss': 0.2278, 'grad_norm': 1.2582595348358154, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.35it/s]                                               {'loss': 0.1308, 'grad_norm': 1.3735429048538208, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.35it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s]                                               {'loss': 0.6845, 'grad_norm': 3.89101505279541, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.1453, 'grad_norm': 1.005979299545288, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.46, 'grad_norm': 0.989403247833252, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.307, 'grad_norm': 3.3260130882263184, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.0173, 'grad_norm': 0.7205399870872498, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.09it/s]                                               {'train_runtime': 12.1584, 'train_samples_per_second': 46.47, 'train_steps_per_second': 3.29, 'train_loss': 1.096855424065143, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.09it/s]100%|██████████| 40/40 [00:12<00:00,  3.29it/s]
CLIENT:15
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.94it/s]                                              {'loss': 6.174, 'grad_norm': 7.136500358581543, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.94it/s]  5%|▌         | 2/40 [00:00<00:13,  2.92it/s]                                              {'loss': 3.5828, 'grad_norm': 5.868222713470459, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.92it/s]  8%|▊         | 3/40 [00:01<00:12,  2.98it/s]                                              {'loss': 2.9717, 'grad_norm': 5.393133640289307, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.98it/s] 10%|█         | 4/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.3007, 'grad_norm': 9.754125595092773, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.00it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s]                                              {'loss': 2.7446, 'grad_norm': 9.36236572265625, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.95it/s]                                              {'loss': 2.9657, 'grad_norm': 12.670750617980957, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.95it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 2.5978, 'grad_norm': 8.405172348022461, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 0.1026, 'grad_norm': 5.913646221160889, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s]                                              {'loss': 1.242, 'grad_norm': 5.836080074310303, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s]                                               {'loss': 0.638, 'grad_norm': 3.57840633392334, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s]                                               {'loss': 1.3092, 'grad_norm': 7.0868940353393555, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s] 30%|███       | 12/40 [00:03<00:08,  3.32it/s]                                               {'loss': 2.1254, 'grad_norm': 7.155248641967773, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.32it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.24it/s]                                               {'loss': 0.6428, 'grad_norm': 5.0817999839782715, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.4009, 'grad_norm': 8.659478187561035, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.1086, 'grad_norm': 11.311731338500977, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.7986, 'grad_norm': 49.409976959228516, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.73it/s]                                               {'loss': 0.3759, 'grad_norm': 2.461296558380127, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.73it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s]                                               {'loss': 0.5124, 'grad_norm': 4.924946308135986, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 0.5094, 'grad_norm': 2.603050470352173, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 0.2265, 'grad_norm': 2.2331812381744385, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.2988, 'grad_norm': 5.193656921386719, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.5252, 'grad_norm': 3.11350154876709, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.14it/s]                                               {'loss': 1.2746, 'grad_norm': 2.462099552154541, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.14it/s]                                               {'loss': 0.1209, 'grad_norm': 7.167654991149902, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.14it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s]                                               {'loss': 0.7382, 'grad_norm': 3.7286739349365234, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.86it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s]                                               {'loss': 0.1368, 'grad_norm': 1.5113521814346313, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.0367, 'grad_norm': 0.6592353582382202, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.0406, 'grad_norm': 0.7425246238708496, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.32it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.2727, 'grad_norm': 2.6508235931396484, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.20it/s]                                               {'loss': 0.7384, 'grad_norm': 1.1260392665863037, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.20it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.2119, 'grad_norm': 2.3580000400543213, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.1524, 'grad_norm': 16.896581649780273, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.16it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.89it/s]                                               {'loss': 0.1032, 'grad_norm': 1.984879493713379, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.89it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.65it/s]                                               {'loss': 0.1104, 'grad_norm': 2.4125874042510986, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.65it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.47it/s]                                               {'loss': 0.5718, 'grad_norm': 1.7342171669006348, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.47it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s]                                               {'loss': 0.5262, 'grad_norm': 0.35688966512680054, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.27it/s]                                               {'loss': 0.2506, 'grad_norm': 2.1893041133880615, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.27it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.1574, 'grad_norm': 2.674456834793091, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.21it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.029, 'grad_norm': 0.5415513515472412, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0734, 'grad_norm': 5.210515975952148, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]                                               {'train_runtime': 12.0547, 'train_samples_per_second': 46.87, 'train_steps_per_second': 3.318, 'train_loss': 1.067469533579424, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.15it/s]100%|██████████| 40/40 [00:12<00:00,  3.32it/s]
CLIENT:38
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.90it/s]                                              {'loss': 4.9401, 'grad_norm': 5.752043724060059, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.90it/s]  5%|▌         | 2/40 [00:00<00:13,  2.89it/s]                                              {'loss': 3.5936, 'grad_norm': 7.1046295166015625, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.89it/s]  8%|▊         | 3/40 [00:01<00:12,  2.92it/s]                                              {'loss': 3.6732, 'grad_norm': 8.915484428405762, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.92it/s] 10%|█         | 4/40 [00:01<00:12,  2.99it/s]                                              {'loss': 2.8654, 'grad_norm': 10.689255714416504, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.99it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s]                                              {'loss': 4.2007, 'grad_norm': 19.52532196044922, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s]                                              {'loss': 4.6309, 'grad_norm': 19.255779266357422, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.92it/s]                                              {'loss': 3.6997, 'grad_norm': 14.121920585632324, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.92it/s] 20%|██        | 8/40 [00:02<00:08,  3.60it/s]                                              {'loss': 1.4295, 'grad_norm': 37.53952407836914, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.60it/s] 22%|██▎       | 9/40 [00:02<00:09,  3.36it/s]                                              {'loss': 1.3358, 'grad_norm': 13.395663261413574, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:09,  3.36it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.18it/s]                                               {'loss': 1.2729, 'grad_norm': 10.15484619140625, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.18it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.13it/s]                                               {'loss': 2.1486, 'grad_norm': 11.653247833251953, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.13it/s] 30%|███       | 12/40 [00:03<00:09,  3.10it/s]                                               {'loss': 2.2066, 'grad_norm': 13.203085899353027, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:09,  3.10it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.04it/s]                                               {'loss': 2.6225, 'grad_norm': 15.097920417785645, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.04it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.03it/s]                                               {'loss': 1.3818, 'grad_norm': 9.176828384399414, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.03it/s] 38%|███▊      | 15/40 [00:04<00:08,  2.99it/s]                                               {'loss': 0.6951, 'grad_norm': 6.424543857574463, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  2.99it/s]                                               {'loss': 0.3071, 'grad_norm': 15.013980865478516, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:08,  2.99it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.789, 'grad_norm': 5.825674057006836, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.57it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.40it/s]                                               {'loss': 0.8016, 'grad_norm': 8.179232597351074, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.40it/s] 48%|████▊     | 19/40 [00:06<00:06,  3.28it/s]                                               {'loss': 1.1271, 'grad_norm': 12.534423828125, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:06,  3.28it/s] 50%|█████     | 20/40 [00:06<00:06,  3.18it/s]                                               {'loss': 0.7393, 'grad_norm': 11.079530715942383, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.18it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.12it/s]                                               {'loss': 0.5316, 'grad_norm': 6.070312976837158, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.12it/s] 55%|█████▌    | 22/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.7163, 'grad_norm': 7.716054916381836, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:05,  3.07it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.04it/s]                                               {'loss': 0.4325, 'grad_norm': 4.780054569244385, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.04it/s]                                               {'loss': 0.4857, 'grad_norm': 26.351863861083984, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.04it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.74it/s]                                               {'loss': 0.4482, 'grad_norm': 3.3983216285705566, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.74it/s] 65%|██████▌   | 26/40 [00:08<00:03,  3.53it/s]                                               {'loss': 0.2693, 'grad_norm': 4.128622531890869, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:03,  3.53it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s]                                               {'loss': 0.3023, 'grad_norm': 3.227424383163452, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s] 70%|███████   | 28/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.2791, 'grad_norm': 1.6970165967941284, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.26it/s] 72%|███████▎  | 29/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.2696, 'grad_norm': 5.987735271453857, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:09<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.4851, 'grad_norm': 10.188603401184082, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.119, 'grad_norm': 1.8346229791641235, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.0827, 'grad_norm': 3.1250534057617188, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:10<00:01,  3.81it/s]                                               {'loss': 0.036, 'grad_norm': 0.5579349398612976, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:10<00:01,  3.81it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s]                                               {'loss': 0.3732, 'grad_norm': 7.593456745147705, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s]                                               {'loss': 0.135, 'grad_norm': 2.610835313796997, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s] 90%|█████████ | 36/40 [00:11<00:01,  3.27it/s]                                               {'loss': 0.0476, 'grad_norm': 1.0304222106933594, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:11<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.1682, 'grad_norm': 2.0831263065338135, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.2417, 'grad_norm': 5.667722225189209, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s] 98%|█████████▊| 39/40 [00:12<00:00,  3.07it/s]                                               {'loss': 0.167, 'grad_norm': 3.4710984230041504, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:12<00:00,  3.07it/s]                                               {'loss': 0.1762, 'grad_norm': 8.13190746307373, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]                                               {'train_runtime': 12.4708, 'train_samples_per_second': 45.306, 'train_steps_per_second': 3.207, 'train_loss': 1.2556628142483532, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]100%|██████████| 40/40 [00:12<00:00,  3.21it/s]
CLIENT:11
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]                                              {'loss': 4.5349, 'grad_norm': 5.819437026977539, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]                                              {'loss': 5.5104, 'grad_norm': 6.746723651885986, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]  8%|▊         | 3/40 [00:00<00:11,  3.15it/s]                                              {'loss': 3.9914, 'grad_norm': 8.345677375793457, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.15it/s] 10%|█         | 4/40 [00:01<00:11,  3.10it/s]                                              {'loss': 2.9251, 'grad_norm': 10.189408302307129, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.10it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s]                                              {'loss': 2.675, 'grad_norm': 12.134563446044922, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s]                                              {'loss': 2.5967, 'grad_norm': 13.130805015563965, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 3.3026, 'grad_norm': 14.292984962463379, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 1.6312, 'grad_norm': 38.80671310424805, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.69it/s]                                              {'loss': 1.0421, 'grad_norm': 8.26917552947998, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.69it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.48it/s]                                               {'loss': 1.2343, 'grad_norm': 5.673670291900635, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.48it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 2.4889, 'grad_norm': 10.22464656829834, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 0.8974, 'grad_norm': 7.037238597869873, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.3601, 'grad_norm': 6.839092254638672, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.3438, 'grad_norm': 8.608283042907715, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.5965, 'grad_norm': 6.372560501098633, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.0046, 'grad_norm': 0.20065940916538239, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.68it/s]                                               {'loss': 1.0702, 'grad_norm': 7.580295085906982, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.68it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s]                                               {'loss': 0.7697, 'grad_norm': 3.8214502334594727, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s]                                               {'loss': 0.7066, 'grad_norm': 2.827052593231201, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s] 50%|█████     | 20/40 [00:06<00:06,  3.27it/s]                                               {'loss': 0.7502, 'grad_norm': 5.332389831542969, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.6785, 'grad_norm': 4.9075927734375, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.2827, 'grad_norm': 5.089662551879883, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.14it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.9168, 'grad_norm': 9.197553634643555, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.776, 'grad_norm': 19.653444290161133, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.4113, 'grad_norm': 3.210569381713867, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s]                                               {'loss': 0.4432, 'grad_norm': 4.7558393478393555, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.62it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.2961, 'grad_norm': 2.412113904953003, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s] 70%|███████   | 28/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.3085, 'grad_norm': 2.3088431358337402, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.29it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s]                                               {'loss': 0.2773, 'grad_norm': 2.5906500816345215, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.445, 'grad_norm': 2.282278537750244, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.1547, 'grad_norm': 3.201554298400879, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.095, 'grad_norm': 3.213738203048706, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s]                                               {'loss': 0.1009, 'grad_norm': 2.21162748336792, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s]                                               {'loss': 0.2091, 'grad_norm': 1.439371943473816, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.2862, 'grad_norm': 3.4952309131622314, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.1227, 'grad_norm': 2.5562567710876465, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.1411, 'grad_norm': 3.216994285583496, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.379, 'grad_norm': 2.7651078701019287, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.2721, 'grad_norm': 5.357218265533447, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 1.522, 'grad_norm': 12.546119689941406, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 12.1169, 'train_samples_per_second': 46.629, 'train_steps_per_second': 3.301, 'train_loss': 1.2137465749285183, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.13it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
CLIENT:40
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]                                              {'loss': 5.6146, 'grad_norm': 5.985747814178467, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]  5%|▌         | 2/40 [00:00<00:12,  3.15it/s]                                              {'loss': 4.9885, 'grad_norm': 6.385258674621582, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.15it/s]  8%|▊         | 3/40 [00:00<00:11,  3.11it/s]                                              {'loss': 3.5564, 'grad_norm': 10.081291198730469, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.11it/s] 10%|█         | 4/40 [00:01<00:11,  3.08it/s]                                              {'loss': 3.2747, 'grad_norm': 8.646657943725586, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.08it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.5354, 'grad_norm': 18.633981704711914, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.04it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s]                                              {'loss': 1.9585, 'grad_norm': 11.707539558410645, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 3.1813, 'grad_norm': 12.234731674194336, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 2.9993, 'grad_norm': 57.013999938964844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.05it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s]                                              {'loss': 1.8374, 'grad_norm': 10.202295303344727, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.58it/s]                                               {'loss': 1.6983, 'grad_norm': 7.950694561004639, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.58it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s]                                               {'loss': 1.6903, 'grad_norm': 6.697524547576904, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.41it/s] 30%|███       | 12/40 [00:03<00:08,  3.27it/s]                                               {'loss': 1.4836, 'grad_norm': 7.485721111297607, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.27it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.2754, 'grad_norm': 7.058995246887207, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s]                                               {'loss': 1.4842, 'grad_norm': 6.832770347595215, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.0768, 'grad_norm': 6.947951316833496, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.1005, 'grad_norm': 44.72376251220703, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.09it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s]                                               {'loss': 0.3388, 'grad_norm': 2.7465176582336426, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 0.7043, 'grad_norm': 4.962794303894043, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s]                                               {'loss': 0.7357, 'grad_norm': 5.085415363311768, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 0.3653, 'grad_norm': 3.4578824043273926, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.5653, 'grad_norm': 3.9365267753601074, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.5594, 'grad_norm': 3.4821557998657227, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.4951, 'grad_norm': 4.3456878662109375, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.0145, 'grad_norm': 0.9306128025054932, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s]                                               {'loss': 0.1357, 'grad_norm': 1.3979166746139526, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s]                                               {'loss': 0.1897, 'grad_norm': 2.3175511360168457, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s]                                               {'loss': 0.3516, 'grad_norm': 1.719638466835022, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.40it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.3403, 'grad_norm': 1.8100274801254272, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.5254, 'grad_norm': 1.500541090965271, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s]                                               {'loss': 0.1478, 'grad_norm': 3.4542551040649414, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.15it/s]                                               {'loss': 0.1905, 'grad_norm': 4.062093257904053, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.15it/s]                                               {'loss': 0.1725, 'grad_norm': 4.695553302764893, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.15it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s]                                               {'loss': 0.2631, 'grad_norm': 1.3318730592727661, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s]                                               {'loss': 0.2552, 'grad_norm': 0.5697659254074097, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.1023, 'grad_norm': 2.30247163772583, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.2464, 'grad_norm': 0.7782149910926819, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.11, 'grad_norm': 1.9724072217941284, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.3546, 'grad_norm': 2.898236036300659, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.0369, 'grad_norm': 0.8789457082748413, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.0353, 'grad_norm': 1.6950730085372925, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.09it/s]                                               {'train_runtime': 12.1031, 'train_samples_per_second': 46.682, 'train_steps_per_second': 3.305, 'train_loss': 1.1997753439936787, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.09it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
CLIENT:45
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]                                              {'loss': 4.5145, 'grad_norm': 5.7757978439331055, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]                                              {'loss': 4.9209, 'grad_norm': 8.410866737365723, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]  8%|▊         | 3/40 [00:00<00:11,  3.10it/s]                                              {'loss': 2.8245, 'grad_norm': 8.220738410949707, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.10it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 2.0492, 'grad_norm': 10.530402183532715, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s]                                              {'loss': 2.025, 'grad_norm': 11.06454849243164, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.08it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.08it/s]                                              {'loss': 3.2093, 'grad_norm': 13.556042671203613, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.08it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 2.6223, 'grad_norm': 11.52427864074707, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 8.648, 'grad_norm': 71.73332214355469, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.08it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s]                                              {'loss': 1.6893, 'grad_norm': 10.075090408325195, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.57it/s]                                               {'loss': 1.3829, 'grad_norm': 8.310073852539062, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.57it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s]                                               {'loss': 1.2641, 'grad_norm': 10.026811599731445, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s] 30%|███       | 12/40 [00:03<00:08,  3.30it/s]                                               {'loss': 0.7687, 'grad_norm': 4.613767623901367, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.30it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.19it/s]                                               {'loss': 1.317, 'grad_norm': 8.355301856994629, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s]                                               {'loss': 0.758, 'grad_norm': 4.936613082885742, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.13it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.1445, 'grad_norm': 6.2216010093688965, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.0176, 'grad_norm': 0.9833033680915833, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s]                                               {'loss': 0.7411, 'grad_norm': 4.6369428634643555, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.79it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s]                                               {'loss': 0.3203, 'grad_norm': 2.5319137573242188, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.6515, 'grad_norm': 4.295383930206299, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 0.4669, 'grad_norm': 5.083150386810303, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 1.1443, 'grad_norm': 7.462156772613525, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.373, 'grad_norm': 1.8755722045898438, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.18it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 0.5128, 'grad_norm': 4.221859931945801, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 0.0797, 'grad_norm': 5.266146183013916, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.13it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s]                                               {'loss': 0.5936, 'grad_norm': 4.292099475860596, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s]                                               {'loss': 0.1989, 'grad_norm': 3.3586885929107666, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.2841, 'grad_norm': 3.4106533527374268, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s] 70%|███████   | 28/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.0907, 'grad_norm': 2.5123181343078613, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.32it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.0466, 'grad_norm': 0.913672149181366, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.4509, 'grad_norm': 3.665836811065674, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.6442, 'grad_norm': 2.1353631019592285, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.16it/s]                                               {'loss': 0.0009, 'grad_norm': 0.05212220177054405, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.16it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.88it/s]                                               {'loss': 0.0939, 'grad_norm': 1.534441351890564, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.88it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s]                                               {'loss': 0.0521, 'grad_norm': 0.8102396726608276, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.63it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s]                                               {'loss': 0.1421, 'grad_norm': 1.7187618017196655, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.45it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.2721, 'grad_norm': 1.4518009424209595, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.2768, 'grad_norm': 1.6076148748397827, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.3335, 'grad_norm': 3.9922633171081543, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.4203, 'grad_norm': 3.850464344024658, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0095, 'grad_norm': 0.6319970488548279, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 12.0523, 'train_samples_per_second': 46.879, 'train_steps_per_second': 3.319, 'train_loss': 1.183895411618869, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.13it/s]100%|██████████| 40/40 [00:12<00:00,  3.32it/s]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.09it/s]                                              {'loss': 4.1976, 'grad_norm': 5.470822334289551, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.09it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 4.5676, 'grad_norm': 8.065166473388672, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:11,  3.09it/s]                                              {'loss': 4.177, 'grad_norm': 8.134246826171875, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.09it/s] 10%|█         | 4/40 [00:01<00:11,  3.15it/s]                                              {'loss': 3.7149, 'grad_norm': 12.667845726013184, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.15it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.11it/s]                                              {'loss': 2.8466, 'grad_norm': 11.273207664489746, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.11it/s] 15%|█▌        | 6/40 [00:01<00:10,  3.10it/s]                                              {'loss': 2.574, 'grad_norm': 9.381731033325195, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:10,  3.10it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 2.3923, 'grad_norm': 8.664294242858887, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.08it/s]                                              {'loss': 2.98, 'grad_norm': 65.06587982177734, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.08it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.84it/s]                                              {'loss': 1.4455, 'grad_norm': 8.038371086120605, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.84it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.66it/s]                                               {'loss': 1.3323, 'grad_norm': 5.473042964935303, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.66it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.47it/s]                                               {'loss': 1.4591, 'grad_norm': 5.854007244110107, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.47it/s] 30%|███       | 12/40 [00:03<00:08,  3.32it/s]                                               {'loss': 1.1091, 'grad_norm': 9.545220375061035, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.32it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.1193, 'grad_norm': 7.020694255828857, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.24it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s]                                               {'loss': 0.9851, 'grad_norm': 6.480000019073486, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.19it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 1.2044, 'grad_norm': 5.874259948730469, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.1717, 'grad_norm': 5.0569610595703125, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.87it/s]                                               {'loss': 0.8982, 'grad_norm': 4.30882453918457, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.87it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.2545, 'grad_norm': 3.4841060638427734, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s]                                               {'loss': 0.7769, 'grad_norm': 6.526277542114258, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s] 50%|█████     | 20/40 [00:05<00:06,  3.33it/s]                                               {'loss': 0.2458, 'grad_norm': 2.7085108757019043, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:06,  3.33it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.4341, 'grad_norm': 6.661046981811523, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.285, 'grad_norm': 3.726546049118042, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.4324, 'grad_norm': 4.938530921936035, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.0064, 'grad_norm': 0.415747731924057, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.13it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.1588, 'grad_norm': 1.672898292541504, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s]                                               {'loss': 0.5132, 'grad_norm': 5.734340190887451, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:07<00:03,  3.46it/s]                                               {'loss': 0.5142, 'grad_norm': 1.7571619749069214, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:07<00:03,  3.46it/s] 70%|███████   | 28/40 [00:08<00:03,  3.33it/s]                                               {'loss': 0.2266, 'grad_norm': 2.0971646308898926, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.33it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.0522, 'grad_norm': 1.0570368766784668, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.24it/s] 75%|███████▌  | 30/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.1803, 'grad_norm': 3.878192663192749, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:08<00:03,  3.18it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.15it/s]                                               {'loss': 0.1352, 'grad_norm': 5.5584187507629395, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.15it/s]                                               {'loss': 0.401, 'grad_norm': 17.67205047607422, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.15it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s]                                               {'loss': 0.0676, 'grad_norm': 1.6509729623794556, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.64it/s]                                               {'loss': 0.0704, 'grad_norm': 0.8758156895637512, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.64it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.47it/s]                                               {'loss': 0.0268, 'grad_norm': 0.5318965911865234, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.47it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s]                                               {'loss': 0.0529, 'grad_norm': 1.2001841068267822, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s] 92%|█████████▎| 37/40 [00:10<00:00,  3.26it/s]                                               {'loss': 0.0394, 'grad_norm': 1.467763900756836, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:10<00:00,  3.26it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.2446, 'grad_norm': 7.795532703399658, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.5951, 'grad_norm': 3.292848825454712, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0028, 'grad_norm': 0.1393321305513382, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]                                               {'train_runtime': 11.9237, 'train_samples_per_second': 47.385, 'train_steps_per_second': 3.355, 'train_loss': 1.0722697162418626, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]100%|██████████| 40/40 [00:11<00:00,  3.35it/s]
CLIENT:62
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 5.366, 'grad_norm': 6.8204450607299805, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]                                              {'loss': 4.9129, 'grad_norm': 7.749794960021973, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]  8%|▊         | 3/40 [00:00<00:12,  3.06it/s]                                              {'loss': 3.6159, 'grad_norm': 8.68155574798584, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.06it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 4.8643, 'grad_norm': 18.740385055541992, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s]                                              {'loss': 3.935, 'grad_norm': 12.381589889526367, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s]                                              {'loss': 2.6504, 'grad_norm': 10.621145248413086, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.03it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 3.9585, 'grad_norm': 9.328226089477539, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 4.3745, 'grad_norm': 33.61211395263672, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s]                                              {'loss': 0.9668, 'grad_norm': 7.168918132781982, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.50it/s]                                               {'loss': 1.6214, 'grad_norm': 8.603404998779297, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.50it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.32it/s]                                               {'loss': 1.4643, 'grad_norm': 8.41224479675293, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.32it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 1.1646, 'grad_norm': 6.838589191436768, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s]                                               {'loss': 1.6226, 'grad_norm': 7.355550289154053, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s]                                               {'loss': 0.8948, 'grad_norm': 6.5798163414001465, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.924, 'grad_norm': 8.056538581848145, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.7508, 'grad_norm': 30.456254959106445, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s]                                               {'loss': 1.1911, 'grad_norm': 8.339944839477539, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.66it/s]                                               {'loss': 0.7447, 'grad_norm': 5.397860050201416, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.66it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.48it/s]                                               {'loss': 0.4515, 'grad_norm': 5.602063179016113, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.48it/s] 50%|█████     | 20/40 [00:06<00:05,  3.36it/s]                                               {'loss': 0.5537, 'grad_norm': 3.7378578186035156, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:05,  3.36it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.27it/s]                                               {'loss': 0.2702, 'grad_norm': 4.764370918273926, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.27it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.553, 'grad_norm': 9.239506721496582, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.19it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.15it/s]                                               {'loss': 0.4066, 'grad_norm': 4.622900009155273, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.15it/s]                                               {'loss': 0.0158, 'grad_norm': 1.180281400680542, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.15it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.91it/s]                                               {'loss': 0.3048, 'grad_norm': 2.313760757446289, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.91it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.67it/s]                                               {'loss': 0.446, 'grad_norm': 6.768977165222168, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.67it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.50it/s]                                               {'loss': 0.2398, 'grad_norm': 2.4882495403289795, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.50it/s] 70%|███████   | 28/40 [00:08<00:03,  3.36it/s]                                               {'loss': 0.4971, 'grad_norm': 11.356221199035645, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.36it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.0912, 'grad_norm': 1.8070417642593384, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.26it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s]                                               {'loss': 0.1066, 'grad_norm': 2.216712236404419, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.19it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.5095, 'grad_norm': 5.825440406799316, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.13it/s]                                               {'loss': 0.3849, 'grad_norm': 13.724138259887695, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.13it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.3216, 'grad_norm': 2.966695547103882, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s]                                               {'loss': 0.0633, 'grad_norm': 0.9601894021034241, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s]                                               {'loss': 0.0594, 'grad_norm': 1.4889805316925049, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s]                                               {'loss': 0.329, 'grad_norm': 1.100653052330017, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.34it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s]                                               {'loss': 0.0729, 'grad_norm': 1.2392301559448242, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.24it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.3532, 'grad_norm': 6.850634574890137, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0669, 'grad_norm': 1.458919882774353, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.1875, 'grad_norm': 6.449477672576904, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]                                               {'train_runtime': 11.9753, 'train_samples_per_second': 47.18, 'train_steps_per_second': 3.34, 'train_loss': 1.3326843470800669, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.15it/s]100%|██████████| 40/40 [00:11<00:00,  3.34it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 11.01it/s]  1%|          | 4/471 [00:00<01:07,  6.94it/s]  1%|          | 5/471 [00:00<01:12,  6.43it/s]  1%|▏         | 6/471 [00:00<01:16,  6.07it/s]  1%|▏         | 7/471 [00:01<01:19,  5.87it/s]  2%|▏         | 8/471 [00:01<01:20,  5.73it/s]  2%|▏         | 9/471 [00:01<01:21,  5.66it/s]  2%|▏         | 10/471 [00:01<01:22,  5.62it/s]  2%|▏         | 11/471 [00:01<01:22,  5.58it/s]  3%|▎         | 12/471 [00:02<01:22,  5.53it/s]  3%|▎         | 13/471 [00:02<01:23,  5.50it/s]  3%|▎         | 14/471 [00:02<01:23,  5.47it/s]  3%|▎         | 15/471 [00:02<01:23,  5.47it/s]  3%|▎         | 16/471 [00:02<01:23,  5.47it/s]  4%|▎         | 17/471 [00:02<01:23,  5.47it/s]  4%|▍         | 18/471 [00:03<01:23,  5.45it/s]  4%|▍         | 19/471 [00:03<01:22,  5.45it/s]  4%|▍         | 20/471 [00:03<01:23,  5.43it/s]  4%|▍         | 21/471 [00:03<01:22,  5.44it/s]  5%|▍         | 22/471 [00:03<01:22,  5.42it/s]  5%|▍         | 23/471 [00:04<01:22,  5.43it/s]  5%|▌         | 24/471 [00:04<01:22,  5.42it/s]  5%|▌         | 25/471 [00:04<01:21,  5.44it/s]  6%|▌         | 26/471 [00:04<01:21,  5.45it/s]  6%|▌         | 27/471 [00:04<01:21,  5.43it/s]  6%|▌         | 28/471 [00:04<01:21,  5.44it/s]  6%|▌         | 29/471 [00:05<01:21,  5.43it/s]  6%|▋         | 30/471 [00:05<01:21,  5.43it/s]  7%|▋         | 31/471 [00:05<01:20,  5.44it/s]  7%|▋         | 32/471 [00:05<01:20,  5.44it/s]  7%|▋         | 33/471 [00:05<01:19,  5.48it/s]  7%|▋         | 34/471 [00:06<01:19,  5.48it/s]  7%|▋         | 35/471 [00:06<01:19,  5.47it/s]  8%|▊         | 36/471 [00:06<01:19,  5.46it/s]  8%|▊         | 37/471 [00:06<01:19,  5.45it/s]  8%|▊         | 38/471 [00:06<01:19,  5.44it/s]  8%|▊         | 39/471 [00:06<01:19,  5.44it/s]  8%|▊         | 40/471 [00:07<01:19,  5.44it/s]  9%|▊         | 41/471 [00:07<01:19,  5.43it/s]  9%|▉         | 42/471 [00:07<01:18,  5.44it/s]  9%|▉         | 43/471 [00:07<01:18,  5.43it/s]  9%|▉         | 44/471 [00:07<01:18,  5.45it/s] 10%|▉         | 45/471 [00:08<01:18,  5.45it/s] 10%|▉         | 46/471 [00:08<01:18,  5.43it/s] 10%|▉         | 47/471 [00:08<01:17,  5.45it/s] 10%|█         | 48/471 [00:08<01:17,  5.46it/s] 10%|█         | 49/471 [00:08<01:17,  5.44it/s] 11%|█         | 50/471 [00:08<01:17,  5.45it/s] 11%|█         | 51/471 [00:09<01:17,  5.43it/s] 11%|█         | 52/471 [00:09<01:17,  5.43it/s] 11%|█▏        | 53/471 [00:09<01:17,  5.42it/s] 11%|█▏        | 54/471 [00:09<01:16,  5.42it/s] 12%|█▏        | 55/471 [00:09<01:16,  5.43it/s] 12%|█▏        | 56/471 [00:10<01:16,  5.41it/s] 12%|█▏        | 57/471 [00:10<01:16,  5.43it/s] 12%|█▏        | 58/471 [00:10<01:16,  5.42it/s] 13%|█▎        | 59/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 60/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 61/471 [00:11<01:15,  5.43it/s] 13%|█▎        | 62/471 [00:11<01:15,  5.43it/s] 13%|█▎        | 63/471 [00:11<01:15,  5.42it/s] 14%|█▎        | 64/471 [00:11<01:15,  5.42it/s] 14%|█▍        | 65/471 [00:11<01:14,  5.42it/s] 14%|█▍        | 66/471 [00:11<01:14,  5.42it/s] 14%|█▍        | 67/471 [00:12<01:14,  5.41it/s] 14%|█▍        | 68/471 [00:12<01:14,  5.42it/s] 15%|█▍        | 69/471 [00:12<01:14,  5.42it/s] 15%|█▍        | 70/471 [00:12<01:14,  5.42it/s] 15%|█▌        | 71/471 [00:12<01:14,  5.40it/s] 15%|█▌        | 72/471 [00:13<01:13,  5.41it/s] 15%|█▌        | 73/471 [00:13<01:13,  5.40it/s] 16%|█▌        | 74/471 [00:13<01:13,  5.43it/s] 16%|█▌        | 75/471 [00:13<01:13,  5.42it/s] 16%|█▌        | 76/471 [00:13<01:12,  5.42it/s] 16%|█▋        | 77/471 [00:13<01:12,  5.41it/s] 17%|█▋        | 78/471 [00:14<01:12,  5.41it/s] 17%|█▋        | 79/471 [00:14<01:12,  5.40it/s] 17%|█▋        | 80/471 [00:14<01:12,  5.41it/s] 17%|█▋        | 81/471 [00:14<01:11,  5.42it/s] 17%|█▋        | 82/471 [00:14<01:11,  5.43it/s] 18%|█▊        | 83/471 [00:15<01:11,  5.43it/s] 18%|█▊        | 84/471 [00:15<01:11,  5.42it/s] 18%|█▊        | 85/471 [00:15<01:11,  5.42it/s] 18%|█▊        | 86/471 [00:15<01:11,  5.41it/s] 18%|█▊        | 87/471 [00:15<01:10,  5.43it/s] 19%|█▊        | 88/471 [00:16<01:10,  5.43it/s] 19%|█▉        | 89/471 [00:16<01:10,  5.42it/s] 19%|█▉        | 90/471 [00:16<01:10,  5.40it/s] 19%|█▉        | 91/471 [00:16<01:10,  5.42it/s] 20%|█▉        | 92/471 [00:16<01:09,  5.43it/s] 20%|█▉        | 93/471 [00:16<01:09,  5.42it/s] 20%|█▉        | 94/471 [00:17<01:09,  5.43it/s] 20%|██        | 95/471 [00:17<01:09,  5.43it/s] 20%|██        | 96/471 [00:17<01:08,  5.44it/s] 21%|██        | 97/471 [00:17<01:09,  5.41it/s] 21%|██        | 98/471 [00:17<01:08,  5.41it/s] 21%|██        | 99/471 [00:18<01:08,  5.41it/s] 21%|██        | 100/471 [00:18<01:08,  5.44it/s] 21%|██▏       | 101/471 [00:18<01:07,  5.45it/s] 22%|██▏       | 102/471 [00:18<01:07,  5.43it/s] 22%|██▏       | 103/471 [00:18<01:07,  5.41it/s] 22%|██▏       | 104/471 [00:18<01:08,  5.39it/s] 22%|██▏       | 105/471 [00:19<01:08,  5.37it/s] 23%|██▎       | 106/471 [00:19<01:07,  5.40it/s] 23%|██▎       | 107/471 [00:19<01:07,  5.42it/s] 23%|██▎       | 108/471 [00:19<01:06,  5.42it/s] 23%|██▎       | 109/471 [00:19<01:06,  5.41it/s] 23%|██▎       | 110/471 [00:20<01:06,  5.42it/s] 24%|██▎       | 111/471 [00:20<01:06,  5.40it/s] 24%|██▍       | 112/471 [00:20<01:06,  5.39it/s] 24%|██▍       | 113/471 [00:20<01:05,  5.43it/s] 24%|██▍       | 114/471 [00:20<01:05,  5.41it/s] 24%|██▍       | 115/471 [00:20<01:05,  5.40it/s] 25%|██▍       | 116/471 [00:21<01:05,  5.40it/s] 25%|██▍       | 117/471 [00:21<01:05,  5.38it/s] 25%|██▌       | 118/471 [00:21<01:05,  5.38it/s] 25%|██▌       | 119/471 [00:21<01:05,  5.39it/s] 25%|██▌       | 120/471 [00:21<01:05,  5.38it/s] 26%|██▌       | 121/471 [00:22<01:04,  5.39it/s] 26%|██▌       | 122/471 [00:22<01:04,  5.39it/s] 26%|██▌       | 123/471 [00:22<01:04,  5.40it/s] 26%|██▋       | 124/471 [00:22<01:04,  5.37it/s] 27%|██▋       | 125/471 [00:22<01:04,  5.37it/s] 27%|██▋       | 126/471 [00:23<01:03,  5.39it/s] 27%|██▋       | 127/471 [00:23<01:03,  5.39it/s] 27%|██▋       | 128/471 [00:23<01:03,  5.39it/s] 27%|██▋       | 129/471 [00:23<01:03,  5.40it/s] 28%|██▊       | 130/471 [00:23<01:03,  5.39it/s] 28%|██▊       | 131/471 [00:23<01:03,  5.38it/s] 28%|██▊       | 132/471 [00:24<01:02,  5.39it/s] 28%|██▊       | 133/471 [00:24<01:02,  5.39it/s] 28%|██▊       | 134/471 [00:24<01:02,  5.39it/s] 29%|██▊       | 135/471 [00:24<01:02,  5.39it/s] 29%|██▉       | 136/471 [00:24<01:02,  5.38it/s] 29%|██▉       | 137/471 [00:25<01:01,  5.40it/s] 29%|██▉       | 138/471 [00:25<01:01,  5.39it/s] 30%|██▉       | 139/471 [00:25<01:01,  5.41it/s] 30%|██▉       | 140/471 [00:25<01:01,  5.39it/s] 30%|██▉       | 141/471 [00:25<01:01,  5.40it/s] 30%|███       | 142/471 [00:26<01:00,  5.40it/s] 30%|███       | 143/471 [00:26<01:00,  5.41it/s] 31%|███       | 144/471 [00:26<01:00,  5.39it/s] 31%|███       | 145/471 [00:26<01:00,  5.42it/s] 31%|███       | 146/471 [00:26<01:00,  5.39it/s] 31%|███       | 147/471 [00:26<01:00,  5.38it/s] 31%|███▏      | 148/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 149/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 150/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 151/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 152/471 [00:27<00:59,  5.38it/s] 32%|███▏      | 153/471 [00:28<00:59,  5.37it/s] 33%|███▎      | 154/471 [00:28<00:58,  5.39it/s] 33%|███▎      | 155/471 [00:28<00:58,  5.40it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.40it/s] 33%|███▎      | 157/471 [00:28<00:58,  5.39it/s] 34%|███▎      | 158/471 [00:28<00:58,  5.39it/s] 34%|███▍      | 159/471 [00:29<00:57,  5.41it/s] 34%|███▍      | 160/471 [00:29<00:57,  5.40it/s] 34%|███▍      | 161/471 [00:29<00:57,  5.40it/s] 34%|███▍      | 162/471 [00:29<00:57,  5.38it/s] 35%|███▍      | 163/471 [00:29<00:57,  5.37it/s] 35%|███▍      | 164/471 [00:30<00:57,  5.38it/s] 35%|███▌      | 165/471 [00:30<00:56,  5.38it/s] 35%|███▌      | 166/471 [00:30<00:56,  5.38it/s] 35%|███▌      | 167/471 [00:30<00:56,  5.37it/s] 36%|███▌      | 168/471 [00:30<00:56,  5.36it/s] 36%|███▌      | 169/471 [00:31<00:56,  5.36it/s] 36%|███▌      | 170/471 [00:31<00:56,  5.37it/s] 36%|███▋      | 171/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 172/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 173/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 174/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 175/471 [00:32<00:55,  5.36it/s] 37%|███▋      | 176/471 [00:32<00:54,  5.38it/s] 38%|███▊      | 177/471 [00:32<00:54,  5.37it/s] 38%|███▊      | 178/471 [00:32<00:54,  5.37it/s] 38%|███▊      | 179/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 180/471 [00:33<00:54,  5.37it/s] 38%|███▊      | 181/471 [00:33<00:54,  5.37it/s] 39%|███▊      | 182/471 [00:33<00:53,  5.37it/s] 39%|███▉      | 183/471 [00:33<00:53,  5.36it/s] 39%|███▉      | 184/471 [00:33<00:53,  5.37it/s] 39%|███▉      | 185/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 186/471 [00:34<00:53,  5.37it/s] 40%|███▉      | 187/471 [00:34<00:53,  5.36it/s] 40%|███▉      | 188/471 [00:34<00:52,  5.35it/s] 40%|████      | 189/471 [00:34<00:52,  5.35it/s] 40%|████      | 190/471 [00:34<00:52,  5.37it/s] 41%|████      | 191/471 [00:35<00:52,  5.36it/s] 41%|████      | 192/471 [00:35<00:52,  5.36it/s] 41%|████      | 193/471 [00:35<00:51,  5.39it/s] 41%|████      | 194/471 [00:35<00:51,  5.38it/s] 41%|████▏     | 195/471 [00:35<00:51,  5.37it/s] 42%|████▏     | 196/471 [00:36<00:51,  5.36it/s] 42%|████▏     | 197/471 [00:36<00:50,  5.38it/s] 42%|████▏     | 198/471 [00:36<00:50,  5.39it/s] 42%|████▏     | 199/471 [00:36<00:50,  5.38it/s] 42%|████▏     | 200/471 [00:36<00:50,  5.35it/s] 43%|████▎     | 201/471 [00:36<00:50,  5.38it/s] 43%|████▎     | 202/471 [00:37<00:50,  5.36it/s] 43%|████▎     | 203/471 [00:37<00:50,  5.36it/s] 43%|████▎     | 204/471 [00:37<00:49,  5.37it/s] 44%|████▎     | 205/471 [00:37<00:49,  5.37it/s] 44%|████▎     | 206/471 [00:37<00:49,  5.37it/s] 44%|████▍     | 207/471 [00:38<00:49,  5.37it/s] 44%|████▍     | 208/471 [00:38<00:48,  5.38it/s] 44%|████▍     | 209/471 [00:38<00:48,  5.40it/s] 45%|████▍     | 210/471 [00:38<00:48,  5.39it/s] 45%|████▍     | 211/471 [00:38<00:48,  5.39it/s] 45%|████▌     | 212/471 [00:39<00:48,  5.37it/s] 45%|████▌     | 213/471 [00:39<00:48,  5.37it/s] 45%|████▌     | 214/471 [00:39<00:47,  5.37it/s] 46%|████▌     | 215/471 [00:39<00:47,  5.36it/s] 46%|████▌     | 216/471 [00:39<00:47,  5.34it/s] 46%|████▌     | 217/471 [00:39<00:47,  5.34it/s] 46%|████▋     | 218/471 [00:40<00:47,  5.34it/s] 46%|████▋     | 219/471 [00:40<00:47,  5.34it/s] 47%|████▋     | 220/471 [00:40<00:47,  5.33it/s] 47%|████▋     | 221/471 [00:40<00:46,  5.33it/s] 47%|████▋     | 222/471 [00:40<00:46,  5.36it/s] 47%|████▋     | 223/471 [00:41<00:46,  5.37it/s] 48%|████▊     | 224/471 [00:41<00:45,  5.37it/s] 48%|████▊     | 225/471 [00:41<00:45,  5.35it/s] 48%|████▊     | 226/471 [00:41<00:45,  5.34it/s] 48%|████▊     | 227/471 [00:41<00:45,  5.33it/s] 48%|████▊     | 228/471 [00:42<00:45,  5.33it/s] 49%|████▊     | 229/471 [00:42<00:45,  5.35it/s] 49%|████▉     | 230/471 [00:42<00:45,  5.33it/s] 49%|████▉     | 231/471 [00:42<00:45,  5.33it/s] 49%|████▉     | 232/471 [00:42<00:44,  5.35it/s] 49%|████▉     | 233/471 [00:42<00:44,  5.36it/s] 50%|████▉     | 234/471 [00:43<00:44,  5.36it/s] 50%|████▉     | 235/471 [00:43<00:44,  5.36it/s] 50%|█████     | 236/471 [00:43<00:43,  5.36it/s] 50%|█████     | 237/471 [00:43<00:43,  5.37it/s] 51%|█████     | 238/471 [00:43<00:43,  5.37it/s] 51%|█████     | 239/471 [00:44<00:43,  5.37it/s] 51%|█████     | 240/471 [00:44<00:42,  5.37it/s] 51%|█████     | 241/471 [00:44<00:42,  5.35it/s] 51%|█████▏    | 242/471 [00:44<00:42,  5.36it/s] 52%|█████▏    | 243/471 [00:44<00:42,  5.36it/s] 52%|█████▏    | 244/471 [00:45<00:42,  5.36it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.35it/s] 52%|█████▏    | 246/471 [00:45<00:41,  5.36it/s] 52%|█████▏    | 247/471 [00:45<00:41,  5.37it/s] 53%|█████▎    | 248/471 [00:45<00:41,  5.37it/s] 53%|█████▎    | 249/471 [00:45<00:41,  5.36it/s] 53%|█████▎    | 250/471 [00:46<00:41,  5.35it/s] 53%|█████▎    | 251/471 [00:46<00:41,  5.35it/s] 54%|█████▎    | 252/471 [00:46<00:40,  5.35it/s] 54%|█████▎    | 253/471 [00:46<00:40,  5.36it/s] 54%|█████▍    | 254/471 [00:46<00:40,  5.35it/s] 54%|█████▍    | 255/471 [00:47<00:40,  5.35it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.35it/s] 55%|█████▍    | 257/471 [00:47<00:40,  5.34it/s] 55%|█████▍    | 258/471 [00:47<00:39,  5.35it/s] 55%|█████▍    | 259/471 [00:47<00:39,  5.36it/s] 55%|█████▌    | 260/471 [00:47<00:39,  5.35it/s] 55%|█████▌    | 261/471 [00:48<00:39,  5.35it/s] 56%|█████▌    | 262/471 [00:48<00:38,  5.37it/s] 56%|█████▌    | 263/471 [00:48<00:38,  5.36it/s] 56%|█████▌    | 264/471 [00:48<00:38,  5.36it/s] 56%|█████▋    | 265/471 [00:48<00:38,  5.36it/s] 56%|█████▋    | 266/471 [00:49<00:38,  5.35it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.34it/s] 57%|█████▋    | 268/471 [00:49<00:38,  5.34it/s] 57%|█████▋    | 269/471 [00:49<00:37,  5.35it/s] 57%|█████▋    | 270/471 [00:49<00:37,  5.35it/s] 58%|█████▊    | 271/471 [00:50<00:37,  5.34it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.37it/s] 58%|█████▊    | 273/471 [00:50<00:36,  5.37it/s] 58%|█████▊    | 274/471 [00:50<00:36,  5.40it/s] 58%|█████▊    | 275/471 [00:50<00:36,  5.39it/s] 59%|█████▊    | 276/471 [00:50<00:36,  5.37it/s] 59%|█████▉    | 277/471 [00:51<00:36,  5.37it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.34it/s] 59%|█████▉    | 279/471 [00:51<00:35,  5.36it/s] 59%|█████▉    | 280/471 [00:51<00:35,  5.36it/s] 60%|█████▉    | 281/471 [00:51<00:35,  5.35it/s] 60%|█████▉    | 282/471 [00:52<00:35,  5.34it/s] 60%|██████    | 283/471 [00:52<00:35,  5.33it/s] 60%|██████    | 284/471 [00:52<00:35,  5.33it/s] 61%|██████    | 285/471 [00:52<00:34,  5.34it/s] 61%|██████    | 286/471 [00:52<00:34,  5.33it/s] 61%|██████    | 287/471 [00:53<00:34,  5.32it/s] 61%|██████    | 288/471 [00:53<00:34,  5.30it/s] 61%|██████▏   | 289/471 [00:53<00:34,  5.34it/s] 62%|██████▏   | 290/471 [00:53<00:33,  5.35it/s] 62%|██████▏   | 291/471 [00:53<00:33,  5.34it/s] 62%|██████▏   | 292/471 [00:53<00:33,  5.35it/s] 62%|██████▏   | 293/471 [00:54<00:33,  5.34it/s] 62%|██████▏   | 294/471 [00:54<00:33,  5.34it/s] 63%|██████▎   | 295/471 [00:54<00:32,  5.35it/s] 63%|██████▎   | 296/471 [00:54<00:32,  5.37it/s] 63%|██████▎   | 297/471 [00:54<00:32,  5.37it/s] 63%|██████▎   | 298/471 [00:55<00:32,  5.35it/s] 63%|██████▎   | 299/471 [00:55<00:32,  5.34it/s] 64%|██████▎   | 300/471 [00:55<00:32,  5.34it/s] 64%|██████▍   | 301/471 [00:55<00:31,  5.33it/s] 64%|██████▍   | 302/471 [00:55<00:31,  5.34it/s] 64%|██████▍   | 303/471 [00:56<00:31,  5.35it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.35it/s] 65%|██████▍   | 305/471 [00:56<00:31,  5.35it/s] 65%|██████▍   | 306/471 [00:56<00:30,  5.34it/s] 65%|██████▌   | 307/471 [00:56<00:30,  5.34it/s] 65%|██████▌   | 308/471 [00:56<00:30,  5.32it/s] 66%|██████▌   | 309/471 [00:57<00:30,  5.32it/s] 66%|██████▌   | 310/471 [00:57<00:30,  5.32it/s] 66%|██████▌   | 311/471 [00:57<00:29,  5.34it/s] 66%|██████▌   | 312/471 [00:57<00:29,  5.34it/s] 66%|██████▋   | 313/471 [00:57<00:29,  5.34it/s] 67%|██████▋   | 314/471 [00:58<00:29,  5.34it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.34it/s] 67%|██████▋   | 316/471 [00:58<00:28,  5.35it/s] 67%|██████▋   | 317/471 [00:58<00:28,  5.36it/s] 68%|██████▊   | 318/471 [00:58<00:28,  5.35it/s] 68%|██████▊   | 319/471 [00:59<00:28,  5.33it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.33it/s] 68%|██████▊   | 321/471 [00:59<00:28,  5.33it/s] 68%|██████▊   | 322/471 [00:59<00:27,  5.34it/s] 69%|██████▊   | 323/471 [00:59<00:27,  5.32it/s] 69%|██████▉   | 324/471 [00:59<00:27,  5.29it/s] 69%|██████▉   | 325/471 [01:00<00:27,  5.31it/s] 69%|██████▉   | 326/471 [01:00<00:27,  5.31it/s] 69%|██████▉   | 327/471 [01:00<00:27,  5.33it/s] 70%|██████▉   | 328/471 [01:00<00:26,  5.34it/s] 70%|██████▉   | 329/471 [01:00<00:26,  5.32it/s] 70%|███████   | 330/471 [01:01<00:26,  5.34it/s] 70%|███████   | 331/471 [01:01<00:26,  5.35it/s] 70%|███████   | 332/471 [01:01<00:26,  5.33it/s] 71%|███████   | 333/471 [01:01<00:25,  5.34it/s] 71%|███████   | 334/471 [01:01<00:25,  5.33it/s] 71%|███████   | 335/471 [01:02<00:25,  5.32it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.35it/s] 72%|███████▏  | 337/471 [01:02<00:25,  5.36it/s] 72%|███████▏  | 338/471 [01:02<00:24,  5.36it/s] 72%|███████▏  | 339/471 [01:02<00:24,  5.34it/s] 72%|███████▏  | 340/471 [01:02<00:24,  5.34it/s] 72%|███████▏  | 341/471 [01:03<00:24,  5.34it/s] 73%|███████▎  | 342/471 [01:03<00:24,  5.36it/s] 73%|███████▎  | 343/471 [01:03<00:23,  5.33it/s] 73%|███████▎  | 344/471 [01:03<00:23,  5.35it/s] 73%|███████▎  | 345/471 [01:03<00:23,  5.34it/s] 73%|███████▎  | 346/471 [01:04<00:23,  5.34it/s] 74%|███████▎  | 347/471 [01:04<00:23,  5.35it/s] 74%|███████▍  | 348/471 [01:04<00:23,  5.33it/s] 74%|███████▍  | 349/471 [01:04<00:22,  5.33it/s] 74%|███████▍  | 350/471 [01:04<00:22,  5.32it/s] 75%|███████▍  | 351/471 [01:05<00:22,  5.34it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.32it/s] 75%|███████▍  | 353/471 [01:05<00:22,  5.31it/s] 75%|███████▌  | 354/471 [01:05<00:22,  5.31it/s] 75%|███████▌  | 355/471 [01:05<00:21,  5.32it/s] 76%|███████▌  | 356/471 [01:05<00:21,  5.32it/s] 76%|███████▌  | 357/471 [01:06<00:21,  5.31it/s] 76%|███████▌  | 358/471 [01:06<00:21,  5.31it/s] 76%|███████▌  | 359/471 [01:06<00:21,  5.31it/s] 76%|███████▋  | 360/471 [01:06<00:20,  5.33it/s] 77%|███████▋  | 361/471 [01:06<00:20,  5.33it/s] 77%|███████▋  | 362/471 [01:07<00:20,  5.32it/s] 77%|███████▋  | 363/471 [01:07<00:20,  5.32it/s] 77%|███████▋  | 364/471 [01:07<00:20,  5.33it/s] 77%|███████▋  | 365/471 [01:07<00:19,  5.34it/s] 78%|███████▊  | 366/471 [01:07<00:19,  5.31it/s] 78%|███████▊  | 367/471 [01:08<00:19,  5.31it/s] 78%|███████▊  | 368/471 [01:08<00:19,  5.31it/s] 78%|███████▊  | 369/471 [01:08<00:19,  5.33it/s] 79%|███████▊  | 370/471 [01:08<00:18,  5.33it/s] 79%|███████▉  | 371/471 [01:08<00:18,  5.32it/s] 79%|███████▉  | 372/471 [01:08<00:18,  5.31it/s] 79%|███████▉  | 373/471 [01:09<00:18,  5.30it/s] 79%|███████▉  | 374/471 [01:09<00:18,  5.32it/s] 80%|███████▉  | 375/471 [01:09<00:17,  5.34it/s] 80%|███████▉  | 376/471 [01:09<00:17,  5.33it/s] 80%|████████  | 377/471 [01:09<00:17,  5.32it/s] 80%|████████  | 378/471 [01:10<00:17,  5.33it/s] 80%|████████  | 379/471 [01:10<00:17,  5.32it/s] 81%|████████  | 380/471 [01:10<00:17,  5.32it/s] 81%|████████  | 381/471 [01:10<00:16,  5.33it/s] 81%|████████  | 382/471 [01:10<00:16,  5.31it/s] 81%|████████▏ | 383/471 [01:11<00:16,  5.30it/s] 82%|████████▏ | 384/471 [01:11<00:16,  5.29it/s] 82%|████████▏ | 385/471 [01:11<00:16,  5.29it/s] 82%|████████▏ | 386/471 [01:11<00:16,  5.31it/s] 82%|████████▏ | 387/471 [01:11<00:15,  5.32it/s] 82%|████████▏ | 388/471 [01:11<00:15,  5.30it/s] 83%|████████▎ | 389/471 [01:12<00:15,  5.32it/s] 83%|████████▎ | 390/471 [01:12<00:15,  5.31it/s] 83%|████████▎ | 391/471 [01:12<00:15,  5.32it/s] 83%|████████▎ | 392/471 [01:12<00:14,  5.33it/s] 83%|████████▎ | 393/471 [01:12<00:14,  5.33it/s] 84%|████████▎ | 394/471 [01:13<00:14,  5.32it/s] 84%|████████▍ | 395/471 [01:13<00:14,  5.32it/s] 84%|████████▍ | 396/471 [01:13<00:14,  5.32it/s] 84%|████████▍ | 397/471 [01:13<00:13,  5.35it/s] 85%|████████▍ | 398/471 [01:13<00:13,  5.32it/s] 85%|████████▍ | 399/471 [01:14<00:13,  5.31it/s] 85%|████████▍ | 400/471 [01:14<00:13,  5.31it/s] 85%|████████▌ | 401/471 [01:14<00:13,  5.31it/s] 85%|████████▌ | 402/471 [01:14<00:12,  5.32it/s] 86%|████████▌ | 403/471 [01:14<00:12,  5.33it/s] 86%|████████▌ | 404/471 [01:14<00:12,  5.33it/s] 86%|████████▌ | 405/471 [01:15<00:12,  5.31it/s] 86%|████████▌ | 406/471 [01:15<00:12,  5.32it/s] 86%|████████▋ | 407/471 [01:15<00:11,  5.35it/s] 87%|████████▋ | 408/471 [01:15<00:11,  5.34it/s] 87%|████████▋ | 409/471 [01:15<00:11,  5.32it/s] 87%|████████▋ | 410/471 [01:16<00:11,  5.34it/s] 87%|████████▋ | 411/471 [01:16<00:11,  5.35it/s] 87%|████████▋ | 412/471 [01:16<00:11,  5.33it/s] 88%|████████▊ | 413/471 [01:16<00:10,  5.33it/s] 88%|████████▊ | 414/471 [01:16<00:10,  5.32it/s] 88%|████████▊ | 415/471 [01:17<00:10,  5.34it/s] 88%|████████▊ | 416/471 [01:17<00:10,  5.31it/s] 89%|████████▊ | 417/471 [01:17<00:10,  5.32it/s] 89%|████████▊ | 418/471 [01:17<00:09,  5.30it/s] 89%|████████▉ | 419/471 [01:17<00:09,  5.32it/s] 89%|████████▉ | 420/471 [01:17<00:09,  5.37it/s] 89%|████████▉ | 421/471 [01:18<00:09,  5.35it/s] 90%|████████▉ | 422/471 [01:18<00:09,  5.34it/s] 90%|████████▉ | 423/471 [01:18<00:08,  5.34it/s] 90%|█████████ | 424/471 [01:18<00:08,  5.33it/s] 90%|█████████ | 425/471 [01:18<00:08,  5.35it/s] 90%|█████████ | 426/471 [01:19<00:08,  5.34it/s] 91%|█████████ | 427/471 [01:19<00:08,  5.34it/s] 91%|█████████ | 428/471 [01:19<00:08,  5.32it/s] 91%|█████████ | 429/471 [01:19<00:07,  5.31it/s] 91%|█████████▏| 430/471 [01:19<00:07,  5.31it/s] 92%|█████████▏| 431/471 [01:20<00:07,  5.31it/s] 92%|█████████▏| 432/471 [01:20<00:07,  5.33it/s] 92%|█████████▏| 433/471 [01:20<00:07,  5.32it/s] 92%|█████████▏| 434/471 [01:20<00:06,  5.30it/s] 92%|█████████▏| 435/471 [01:20<00:06,  5.31it/s] 93%|█████████▎| 436/471 [01:21<00:06,  5.32it/s] 93%|█████████▎| 437/471 [01:21<00:06,  5.32it/s] 93%|█████████▎| 438/471 [01:21<00:06,  5.33it/s] 93%|█████████▎| 439/471 [01:21<00:06,  5.31it/s] 93%|█████████▎| 440/471 [01:21<00:05,  5.32it/s] 94%|█████████▎| 441/471 [01:21<00:05,  5.33it/s] 94%|█████████▍| 442/471 [01:22<00:05,  5.35it/s] 94%|█████████▍| 443/471 [01:22<00:05,  5.34it/s] 94%|█████████▍| 444/471 [01:22<00:05,  5.32it/s] 94%|█████████▍| 445/471 [01:22<00:04,  5.32it/s] 95%|█████████▍| 446/471 [01:22<00:04,  5.31it/s] 95%|█████████▍| 447/471 [01:23<00:04,  5.33it/s] 95%|█████████▌| 448/471 [01:23<00:04,  5.34it/s] 95%|█████████▌| 449/471 [01:23<00:04,  5.33it/s] 96%|█████████▌| 450/471 [01:23<00:03,  5.32it/s] 96%|█████████▌| 451/471 [01:23<00:03,  5.31it/s] 96%|█████████▌| 452/471 [01:24<00:03,  5.33it/s] 96%|█████████▌| 453/471 [01:24<00:03,  5.32it/s] 96%|█████████▋| 454/471 [01:24<00:03,  5.31it/s] 97%|█████████▋| 455/471 [01:24<00:03,  5.30it/s] 97%|█████████▋| 456/471 [01:24<00:02,  5.31it/s] 97%|█████████▋| 457/471 [01:24<00:02,  5.33it/s] 97%|█████████▋| 458/471 [01:25<00:02,  5.33it/s] 97%|█████████▋| 459/471 [01:25<00:02,  5.34it/s] 98%|█████████▊| 460/471 [01:25<00:02,  5.34it/s] 98%|█████████▊| 461/471 [01:25<00:01,  5.32it/s] 98%|█████████▊| 462/471 [01:25<00:01,  5.32it/s] 98%|█████████▊| 463/471 [01:26<00:01,  5.32it/s] 99%|█████████▊| 464/471 [01:26<00:01,  5.31it/s] 99%|█████████▊| 465/471 [01:26<00:01,  5.33it/s] 99%|█████████▉| 466/471 [01:26<00:00,  5.32it/s] 99%|█████████▉| 467/471 [01:26<00:00,  5.31it/s] 99%|█████████▉| 468/471 [01:27<00:00,  5.30it/s]100%|█████████▉| 469/471 [01:27<00:00,  5.31it/s]100%|█████████▉| 470/471 [01:27<00:00,  5.31it/s]100%|██████████| 471/471 [01:27<00:00,  5.69it/s]100%|██████████| 471/471 [01:27<00:00,  5.38it/s]
{'eval_loss': 4.9866228103637695, 'eval_model_preparation_time': 0.0052, 'eval_acc': 0.17365905469994689, 'eval_runtime': 87.7091, 'eval_samples_per_second': 85.875, 'eval_steps_per_second': 5.37}
ROUND:6
CLIENT:69
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.16it/s]                                              {'loss': 5.9216, 'grad_norm': 6.76437520980835, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.16it/s]  5%|▌         | 2/40 [00:00<00:12,  3.10it/s]                                              {'loss': 4.5058, 'grad_norm': 7.5470380783081055, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.10it/s]  8%|▊         | 3/40 [00:00<00:12,  3.03it/s]                                              {'loss': 4.0909, 'grad_norm': 10.186708450317383, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.03it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 3.086, 'grad_norm': 11.509868621826172, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.4744, 'grad_norm': 15.864190101623535, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s]                                              {'loss': 3.0637, 'grad_norm': 13.369693756103516, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 1.6435, 'grad_norm': 14.01697063446045, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 6.3, 'grad_norm': 1.8230292797088623, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s]                                              {'loss': 1.4121, 'grad_norm': 8.33203411102295, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s]                                               {'loss': 1.3173, 'grad_norm': 6.465996742248535, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s]                                               {'loss': 0.9776, 'grad_norm': 6.95526647567749, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s] 30%|███       | 12/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.1004, 'grad_norm': 7.529671669006348, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.24it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.5656, 'grad_norm': 8.700732231140137, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.16it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.7498, 'grad_norm': 5.545388698577881, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 1.6402, 'grad_norm': 11.330795288085938, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.4675, 'grad_norm': 10.139183044433594, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.06it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s]                                               {'loss': 0.7391, 'grad_norm': 3.580707311630249, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s]                                               {'loss': 0.5876, 'grad_norm': 4.559941291809082, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.36it/s]                                               {'loss': 0.3666, 'grad_norm': 3.3840839862823486, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.36it/s] 50%|█████     | 20/40 [00:06<00:06,  3.25it/s]                                               {'loss': 0.4569, 'grad_norm': 4.581291675567627, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.25it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.7082, 'grad_norm': 3.618882894515991, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s]                                               {'loss': 0.9432, 'grad_norm': 7.234958648681641, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.4198, 'grad_norm': 7.370693683624268, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.07it/s]                                               {'loss': 0.8815, 'grad_norm': 17.226747512817383, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.07it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.73it/s]                                               {'loss': 0.6676, 'grad_norm': 1.726249098777771, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.73it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.52it/s]                                               {'loss': 0.1959, 'grad_norm': 1.419883370399475, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.52it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s]                                               {'loss': 0.6468, 'grad_norm': 2.5541446208953857, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.37it/s] 70%|███████   | 28/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.4664, 'grad_norm': 10.777708053588867, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.24it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.15it/s]                                               {'loss': 0.2034, 'grad_norm': 2.011533737182617, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.15it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.09it/s]                                               {'loss': 0.0476, 'grad_norm': 0.7353079319000244, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.09it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.03it/s]                                               {'loss': 0.1192, 'grad_norm': 2.186241388320923, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.03it/s]                                               {'loss': 0.1555, 'grad_norm': 4.649735450744629, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.03it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s]                                               {'loss': 0.1337, 'grad_norm': 1.6261954307556152, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s]                                               {'loss': 0.1945, 'grad_norm': 2.3224072456359863, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s]                                               {'loss': 0.1055, 'grad_norm': 1.8287053108215332, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s]                                               {'loss': 0.5088, 'grad_norm': 2.074343204498291, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.043, 'grad_norm': 1.1498494148254395, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.15it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.2413, 'grad_norm': 0.852759063243866, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.07it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.01it/s]                                               {'loss': 0.2838, 'grad_norm': 0.6865765452384949, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.01it/s]100%|██████████| 40/40 [00:12<00:00,  3.78it/s]                                               {'loss': 0.0563, 'grad_norm': 1.57072913646698, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.78it/s]                                               {'train_runtime': 12.4033, 'train_samples_per_second': 45.552, 'train_steps_per_second': 3.225, 'train_loss': 1.2372132246382535, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.78it/s]100%|██████████| 40/40 [00:12<00:00,  3.22it/s]
CLIENT:74
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]                                              {'loss': 3.7831, 'grad_norm': 7.730563163757324, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.11it/s]  5%|▌         | 2/40 [00:00<00:12,  3.05it/s]                                              {'loss': 5.233, 'grad_norm': 7.725841999053955, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.05it/s]  8%|▊         | 3/40 [00:00<00:12,  3.01it/s]                                              {'loss': 3.8295, 'grad_norm': 12.36058235168457, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.01it/s] 10%|█         | 4/40 [00:01<00:12,  2.99it/s]                                              {'loss': 2.7899, 'grad_norm': 13.472932815551758, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.99it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.0556, 'grad_norm': 11.943195343017578, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.4743, 'grad_norm': 17.177900314331055, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:11,  3.00it/s]                                              {'loss': 2.1627, 'grad_norm': 16.589109420776367, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  3.00it/s]                                              {'loss': 1.0647, 'grad_norm': 34.78665542602539, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s]                                              {'loss': 0.9104, 'grad_norm': 11.057683944702148, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s]                                               {'loss': 1.2223, 'grad_norm': 9.302772521972656, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s]                                               {'loss': 1.0199, 'grad_norm': 9.65326976776123, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s] 30%|███       | 12/40 [00:03<00:08,  3.25it/s]                                               {'loss': 0.9265, 'grad_norm': 9.917825698852539, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.25it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 0.4526, 'grad_norm': 3.6821045875549316, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s]                                               {'loss': 0.924, 'grad_norm': 6.850822448730469, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.07it/s]                                               {'loss': 1.0192, 'grad_norm': 8.447864532470703, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.07it/s]                                               {'loss': 0.0823, 'grad_norm': 4.486348628997803, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.07it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.78it/s]                                               {'loss': 0.1886, 'grad_norm': 4.209574222564697, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.78it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s]                                               {'loss': 0.8874, 'grad_norm': 5.536529541015625, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s]                                               {'loss': 0.3037, 'grad_norm': 2.9652559757232666, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s] 50%|█████     | 20/40 [00:06<00:06,  3.29it/s]                                               {'loss': 0.2622, 'grad_norm': 3.9335525035858154, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.29it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.5415, 'grad_norm': 7.504117012023926, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.6156, 'grad_norm': 4.669146537780762, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 0.1326, 'grad_norm': 3.3463194370269775, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.08it/s]                                               {'loss': 0.0128, 'grad_norm': 0.9724599719047546, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.08it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.74it/s]                                               {'loss': 0.3478, 'grad_norm': 4.1998772621154785, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.74it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.52it/s]                                               {'loss': 0.2121, 'grad_norm': 4.548370361328125, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.52it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s]                                               {'loss': 0.2769, 'grad_norm': 2.271437406539917, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s] 70%|███████   | 28/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.2606, 'grad_norm': 6.874584674835205, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.29it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.2369, 'grad_norm': 3.837683916091919, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.0909, 'grad_norm': 1.7175664901733398, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.2128, 'grad_norm': 1.5055315494537354, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.1188, 'grad_norm': 8.38259220123291, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s]                                               {'loss': 0.0295, 'grad_norm': 0.4817589521408081, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.55it/s]                                               {'loss': 0.0337, 'grad_norm': 0.642882227897644, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.55it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.2153, 'grad_norm': 2.013701915740967, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.0622, 'grad_norm': 0.9721275568008423, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.1761, 'grad_norm': 2.101492166519165, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.2266, 'grad_norm': 5.617427349090576, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.1193, 'grad_norm': 1.3647955656051636, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.0596, 'grad_norm': 1.0411674976348877, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.06it/s]                                               {'train_runtime': 12.3435, 'train_samples_per_second': 45.773, 'train_steps_per_second': 3.241, 'train_loss': 0.8893466099398211, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.06it/s]100%|██████████| 40/40 [00:12<00:00,  3.24it/s]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]                                              {'loss': 2.6641, 'grad_norm': 4.87153434753418, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.07it/s]  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]                                              {'loss': 3.4425, 'grad_norm': 6.79764461517334, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]  8%|▊         | 3/40 [00:00<00:12,  2.99it/s]                                              {'loss': 2.4077, 'grad_norm': 10.008665084838867, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  2.99it/s] 10%|█         | 4/40 [00:01<00:12,  2.98it/s]                                              {'loss': 2.0825, 'grad_norm': 8.813031196594238, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.98it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 2.116, 'grad_norm': 15.357028007507324, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.99it/s]                                              {'loss': 1.6489, 'grad_norm': 10.046972274780273, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.99it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 3.0111, 'grad_norm': 16.429458618164062, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 0.0172, 'grad_norm': 1.0286619663238525, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.78it/s]                                              {'loss': 0.9786, 'grad_norm': 5.797062397003174, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.78it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.61it/s]                                               {'loss': 0.9273, 'grad_norm': 11.348219871520996, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.61it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 0.8509, 'grad_norm': 6.879189491271973, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 0.8679, 'grad_norm': 7.121683597564697, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s]                                               {'loss': 0.998, 'grad_norm': 8.56291389465332, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.20it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 0.5565, 'grad_norm': 8.037110328674316, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.0966, 'grad_norm': 6.513455390930176, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.11it/s]                                               {'loss': 0.0193, 'grad_norm': 1.1127208471298218, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.11it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s]                                               {'loss': 0.5566, 'grad_norm': 1.487622618675232, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.0765, 'grad_norm': 1.098844289779663, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.6917, 'grad_norm': 8.869034767150879, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 0.2487, 'grad_norm': 3.9950478076934814, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s]                                               {'loss': 0.4524, 'grad_norm': 4.238097190856934, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.23it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.3939, 'grad_norm': 3.5605828762054443, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.2793, 'grad_norm': 3.7904810905456543, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.5801, 'grad_norm': 50.74856948852539, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.4339, 'grad_norm': 2.165431499481201, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s]                                               {'loss': 0.4318, 'grad_norm': 6.714413642883301, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s]                                               {'loss': 0.2324, 'grad_norm': 6.091038703918457, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s] 70%|███████   | 28/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.176, 'grad_norm': 4.564577102661133, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.29it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s]                                               {'loss': 0.1172, 'grad_norm': 3.358511209487915, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.09, 'grad_norm': 1.6631745100021362, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.2079, 'grad_norm': 2.2757601737976074, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.001, 'grad_norm': 0.05730820447206497, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s]                                               {'loss': 0.0941, 'grad_norm': 1.6481913328170776, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s]                                               {'loss': 0.0784, 'grad_norm': 1.4735063314437866, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s]                                               {'loss': 0.0419, 'grad_norm': 0.8106746673583984, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s]                                               {'loss': 0.155, 'grad_norm': 1.428725004196167, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.1069, 'grad_norm': 1.7058087587356567, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.0577, 'grad_norm': 1.366261601448059, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.4272, 'grad_norm': 1.2693458795547485, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.125, 'grad_norm': 9.190343856811523, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.06it/s]                                               {'train_runtime': 12.2583, 'train_samples_per_second': 46.091, 'train_steps_per_second': 3.263, 'train_loss': 0.7435144976363517, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.06it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 5.2261, 'grad_norm': 6.615525722503662, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]                                              {'loss': 5.5442, 'grad_norm': 9.181611061096191, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]  8%|▊         | 3/40 [00:00<00:12,  3.00it/s]                                              {'loss': 3.9725, 'grad_norm': 12.047550201416016, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.00it/s] 10%|█         | 4/40 [00:01<00:11,  3.01it/s]                                              {'loss': 3.0207, 'grad_norm': 11.716957092285156, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.01it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.2762, 'grad_norm': 15.067716598510742, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s] 15%|█▌        | 6/40 [00:01<00:11,  2.99it/s]                                              {'loss': 2.2519, 'grad_norm': 9.897335052490234, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.99it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 2.5127, 'grad_norm': 12.862399101257324, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 5.9355, 'grad_norm': 54.346134185791016, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s]                                              {'loss': 1.4226, 'grad_norm': 6.653619289398193, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s]                                               {'loss': 1.5848, 'grad_norm': 8.356925964355469, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 1.3936, 'grad_norm': 6.09218692779541, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.24it/s]                                               {'loss': 0.8785, 'grad_norm': 5.945469379425049, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.24it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 1.5401, 'grad_norm': 6.548683166503906, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.9412, 'grad_norm': 7.782291889190674, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.7463, 'grad_norm': 9.877164840698242, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.2706, 'grad_norm': 11.187322616577148, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s]                                               {'loss': 0.3819, 'grad_norm': 2.7346060276031494, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 1.0883, 'grad_norm': 6.023556232452393, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.5566, 'grad_norm': 6.918776035308838, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 0.8363, 'grad_norm': 3.8244476318359375, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 1.0762, 'grad_norm': 7.512996673583984, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.4571, 'grad_norm': 3.2903289794921875, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.7058, 'grad_norm': 5.216816425323486, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 1.0354, 'grad_norm': 48.138240814208984, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s]                                               {'loss': 0.4113, 'grad_norm': 3.85382080078125, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s]                                               {'loss': 0.341, 'grad_norm': 2.414179801940918, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s]                                               {'loss': 0.2501, 'grad_norm': 2.637889862060547, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s] 70%|███████   | 28/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.6803, 'grad_norm': 1.5737085342407227, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.29it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.2453, 'grad_norm': 3.010590076446533, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.2069, 'grad_norm': 1.9643760919570923, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.5969, 'grad_norm': 1.3369379043579102, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.6029, 'grad_norm': 21.89226531982422, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.10it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s]                                               {'loss': 0.1554, 'grad_norm': 1.675161361694336, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 1.1662, 'grad_norm': 1.9215062856674194, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.1141, 'grad_norm': 1.4898736476898193, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.1104, 'grad_norm': 1.5323439836502075, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.0773, 'grad_norm': 1.6644657850265503, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.1233, 'grad_norm': 2.987025499343872, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.1188, 'grad_norm': 1.6394373178482056, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0025, 'grad_norm': 0.13579948246479034, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.08it/s]                                               {'train_runtime': 12.3094, 'train_samples_per_second': 45.9, 'train_steps_per_second': 3.25, 'train_loss': 1.3214437315182295, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.08it/s]100%|██████████| 40/40 [00:12<00:00,  3.25it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.00it/s]                                              {'loss': 4.2888, 'grad_norm': 5.172638893127441, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.00it/s]  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]                                              {'loss': 2.9793, 'grad_norm': 6.1757731437683105, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]  8%|▊         | 3/40 [00:01<00:12,  2.97it/s]                                              {'loss': 3.6, 'grad_norm': 10.449361801147461, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.97it/s] 10%|█         | 4/40 [00:01<00:12,  2.97it/s]                                              {'loss': 2.4818, 'grad_norm': 10.463977813720703, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.97it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.8229, 'grad_norm': 11.795507431030273, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.4522, 'grad_norm': 11.473250389099121, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 1.7918, 'grad_norm': 11.3631591796875, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 2.4968, 'grad_norm': 99.75846099853516, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.01it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s]                                              {'loss': 1.0449, 'grad_norm': 8.137162208557129, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.51it/s]                                               {'loss': 1.6154, 'grad_norm': 10.209552764892578, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.51it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 1.0633, 'grad_norm': 8.202913284301758, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.25it/s]                                               {'loss': 0.8753, 'grad_norm': 5.719566822052002, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.25it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.0033, 'grad_norm': 13.772662162780762, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 0.7853, 'grad_norm': 4.6127705574035645, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.9096, 'grad_norm': 10.98331069946289, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.0722, 'grad_norm': 3.2007739543914795, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s]                                               {'loss': 0.5014, 'grad_norm': 3.1397557258605957, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.81it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s]                                               {'loss': 0.3654, 'grad_norm': 3.441377639770508, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.58it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.5177, 'grad_norm': 7.210594654083252, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.29it/s]                                               {'loss': 0.2334, 'grad_norm': 2.1528334617614746, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.29it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.433, 'grad_norm': 3.698495388031006, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.4879, 'grad_norm': 2.355154275894165, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.64, 'grad_norm': 6.578577041625977, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 2.5747, 'grad_norm': 21.0797061920166, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s]                                               {'loss': 0.4704, 'grad_norm': 7.795652866363525, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s]                                               {'loss': 0.5708, 'grad_norm': 6.004444599151611, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.2309, 'grad_norm': 2.1531612873077393, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.4507, 'grad_norm': 3.455709218978882, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.1236, 'grad_norm': 1.4013941287994385, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.1828, 'grad_norm': 2.750190019607544, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.0526, 'grad_norm': 1.8224327564239502, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.1104, 'grad_norm': 3.324218511581421, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.2214, 'grad_norm': 2.1325900554656982, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.0464, 'grad_norm': 1.0291014909744263, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.0625, 'grad_norm': 1.650357961654663, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s]                                               {'loss': 0.1343, 'grad_norm': 1.8142023086547852, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.29it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.2785, 'grad_norm': 0.6691814661026001, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0297, 'grad_norm': 0.6710619926452637, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.4666, 'grad_norm': 4.739439964294434, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]100%|██████████| 40/40 [00:11<00:00,  3.84it/s]                                               {'loss': 0.0465, 'grad_norm': 2.238028049468994, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.84it/s]                                               {'train_runtime': 12.3085, 'train_samples_per_second': 45.903, 'train_steps_per_second': 3.25, 'train_loss': 0.9878673829138279, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.84it/s]100%|██████████| 40/40 [00:12<00:00,  3.25it/s]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 6.3475, 'grad_norm': 6.536667823791504, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]                                              {'loss': 4.7718, 'grad_norm': 8.483248710632324, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.02it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 2.6751, 'grad_norm': 7.210063457489014, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.762, 'grad_norm': 9.90687370300293, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.01it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.7401, 'grad_norm': 15.595706939697266, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 1.8975, 'grad_norm': 9.664169311523438, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 1.9869, 'grad_norm': 13.793615341186523, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.98it/s]                                              {'loss': 3.165, 'grad_norm': 54.11400604248047, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.98it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s]                                              {'loss': 1.2959, 'grad_norm': 9.793047904968262, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s]                                               {'loss': 0.6832, 'grad_norm': 6.305853366851807, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s]                                               {'loss': 0.8593, 'grad_norm': 4.182618618011475, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.35it/s] 30%|███       | 12/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.1353, 'grad_norm': 9.562265396118164, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.23it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.0241, 'grad_norm': 7.454425811767578, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.16it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.3867, 'grad_norm': 7.687282085418701, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.05it/s]                                               {'loss': 0.9078, 'grad_norm': 10.179027557373047, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.05it/s]                                               {'loss': 0.1565, 'grad_norm': 5.945154190063477, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.05it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.74it/s]                                               {'loss': 0.9926, 'grad_norm': 5.104314804077148, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.74it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.51it/s]                                               {'loss': 0.3097, 'grad_norm': 3.6076059341430664, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.51it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.35it/s]                                               {'loss': 0.2236, 'grad_norm': 3.7834107875823975, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.35it/s] 50%|█████     | 20/40 [00:06<00:06,  3.24it/s]                                               {'loss': 0.3039, 'grad_norm': 4.400969982147217, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.24it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.3335, 'grad_norm': 5.097995758056641, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s]                                               {'loss': 0.0905, 'grad_norm': 1.6431397199630737, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.12it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.1807, 'grad_norm': 3.432992458343506, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.216, 'grad_norm': 11.921737670898438, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.80it/s]                                               {'loss': 0.1964, 'grad_norm': 4.6759114265441895, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.80it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s]                                               {'loss': 0.6901, 'grad_norm': 8.610987663269043, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.59it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s]                                               {'loss': 0.2401, 'grad_norm': 6.7749457359313965, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.0222, 'grad_norm': 0.6746022701263428, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.0547, 'grad_norm': 1.1841282844543457, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.1605, 'grad_norm': 2.6185028553009033, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.3018, 'grad_norm': 2.094758987426758, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.6002, 'grad_norm': 29.997344970703125, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s]                                               {'loss': 0.1147, 'grad_norm': 1.451657772064209, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.55it/s]                                               {'loss': 0.1759, 'grad_norm': 2.729689598083496, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.55it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s]                                               {'loss': 0.257, 'grad_norm': 1.4143471717834473, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.26it/s]                                               {'loss': 0.0286, 'grad_norm': 0.912921667098999, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.26it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.1641, 'grad_norm': 3.792647123336792, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.178, 'grad_norm': 4.980544090270996, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0502, 'grad_norm': 1.2048226594924927, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0348, 'grad_norm': 1.8227900266647339, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.08it/s]                                               {'train_runtime': 12.2137, 'train_samples_per_second': 46.26, 'train_steps_per_second': 3.275, 'train_loss': 0.9928594520781189, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.08it/s]100%|██████████| 40/40 [00:12<00:00,  3.28it/s]
CLIENT:32
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]                                              {'loss': 5.0355, 'grad_norm': 5.86257266998291, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]                                              {'loss': 5.869, 'grad_norm': 8.520334243774414, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]  8%|▊         | 3/40 [00:00<00:12,  3.01it/s]                                              {'loss': 3.4309, 'grad_norm': 10.886438369750977, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.01it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.4375, 'grad_norm': 9.707247734069824, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.2441, 'grad_norm': 15.122749328613281, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s]                                              {'loss': 2.5895, 'grad_norm': 17.757631301879883, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 2.6997, 'grad_norm': 15.399526596069336, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.06it/s]                                              {'loss': 1.3965, 'grad_norm': 66.59969329833984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.06it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.77it/s]                                              {'loss': 1.7737, 'grad_norm': 14.52630615234375, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.77it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s]                                               {'loss': 2.4542, 'grad_norm': 15.424881935119629, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 1.6193, 'grad_norm': 14.934429168701172, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.31it/s]                                               {'loss': 1.9458, 'grad_norm': 8.11603832244873, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.31it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s]                                               {'loss': 1.3349, 'grad_norm': 8.182371139526367, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.2435, 'grad_norm': 5.6331987380981445, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 1.6229, 'grad_norm': 8.543066024780273, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.1642, 'grad_norm': 4.977856636047363, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.85it/s]                                               {'loss': 1.2671, 'grad_norm': 6.567714214324951, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.85it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.7424, 'grad_norm': 4.893669128417969, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s]                                               {'loss': 0.9522, 'grad_norm': 5.63753604888916, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.38it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 0.6903, 'grad_norm': 3.794874906539917, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.9117, 'grad_norm': 6.2243757247924805, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.9401, 'grad_norm': 7.339041233062744, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s]                                               {'loss': 0.546, 'grad_norm': 5.657547950744629, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.13it/s] 60%|██████    | 24/40 [00:07<00:04,  3.90it/s]                                               {'loss': 3.4365, 'grad_norm': 1.6430754661560059, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:04,  3.90it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.64it/s]                                               {'loss': 0.2452, 'grad_norm': 2.388096570968628, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.64it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.44it/s]                                               {'loss': 0.5617, 'grad_norm': 2.772218704223633, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.44it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.4689, 'grad_norm': 3.4375622272491455, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.32it/s] 70%|███████   | 28/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.3813, 'grad_norm': 3.1647017002105713, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.24it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.1959, 'grad_norm': 2.116755485534668, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.1443, 'grad_norm': 2.2165839672088623, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.411, 'grad_norm': 3.2905075550079346, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.8999, 'grad_norm': 13.353608131408691, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.84it/s]                                               {'loss': 0.1608, 'grad_norm': 2.652783155441284, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.84it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s]                                               {'loss': 0.2314, 'grad_norm': 3.0280966758728027, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s]                                               {'loss': 0.3158, 'grad_norm': 2.0555953979492188, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.44it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s]                                               {'loss': 0.2873, 'grad_norm': 1.6587438583374023, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.32it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s]                                               {'loss': 0.1219, 'grad_norm': 1.7037286758422852, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.23it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.3114, 'grad_norm': 0.9125533699989319, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.19it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1248, 'grad_norm': 1.7983304262161255, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0063, 'grad_norm': 0.35555633902549744, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.14it/s]                                               {'train_runtime': 12.0741, 'train_samples_per_second': 46.794, 'train_steps_per_second': 3.313, 'train_loss': 1.330390112590976, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.14it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 4.2583, 'grad_norm': 7.963486671447754, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 3.9279, 'grad_norm': 6.729485988616943, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:12,  3.06it/s]                                              {'loss': 3.8046, 'grad_norm': 10.426274299621582, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.06it/s] 10%|█         | 4/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.4189, 'grad_norm': 11.472392082214355, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.05it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.06it/s]                                              {'loss': 2.9489, 'grad_norm': 14.704558372497559, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.06it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s]                                              {'loss': 1.8056, 'grad_norm': 11.75008487701416, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.07it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.11it/s]                                              {'loss': 1.8386, 'grad_norm': 12.477618217468262, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.11it/s]                                              {'loss': 0.5326, 'grad_norm': 26.207244873046875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.11it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s]                                              {'loss': 0.7104, 'grad_norm': 9.286659240722656, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.86it/s] 25%|██▌       | 10/40 [00:02<00:08,  3.62it/s]                                               {'loss': 1.6672, 'grad_norm': 19.03432846069336, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:08,  3.62it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s]                                               {'loss': 0.9773, 'grad_norm': 8.057817459106445, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s] 30%|███       | 12/40 [00:03<00:08,  3.33it/s]                                               {'loss': 1.2943, 'grad_norm': 11.812034606933594, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.33it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.26it/s]                                               {'loss': 0.9607, 'grad_norm': 6.9367475509643555, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.26it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.20it/s]                                               {'loss': 1.3073, 'grad_norm': 6.776196002960205, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.20it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.15it/s]                                               {'loss': 1.3046, 'grad_norm': 8.162993431091309, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.15it/s]                                               {'loss': 0.3204, 'grad_norm': 10.906839370727539, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.15it/s] 42%|████▎     | 17/40 [00:04<00:05,  3.89it/s]                                               {'loss': 0.5077, 'grad_norm': 3.8188774585723877, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:04<00:05,  3.89it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.64it/s]                                               {'loss': 0.5231, 'grad_norm': 4.551742076873779, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.64it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s]                                               {'loss': 0.809, 'grad_norm': 6.762905120849609, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.46it/s] 50%|█████     | 20/40 [00:05<00:06,  3.31it/s]                                               {'loss': 1.0384, 'grad_norm': 5.727038860321045, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:05<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.2996, 'grad_norm': 3.6484286785125732, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.7783, 'grad_norm': 4.384067058563232, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.12it/s]                                               {'loss': 0.5573, 'grad_norm': 4.769469261169434, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.12it/s]                                               {'loss': 0.7252, 'grad_norm': 61.675933837890625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.3824, 'grad_norm': 4.124469757080078, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s]                                               {'loss': 0.132, 'grad_norm': 2.2824783325195312, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.7167, 'grad_norm': 10.184449195861816, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.34it/s]                                               {'loss': 0.3384, 'grad_norm': 6.897180557250977, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.34it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.4273, 'grad_norm': 5.611151218414307, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.4778, 'grad_norm': 3.7026712894439697, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.1708, 'grad_norm': 2.254396438598633, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.3776, 'grad_norm': 18.361406326293945, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s]                                               {'loss': 0.0639, 'grad_norm': 1.278559923171997, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s]                                               {'loss': 0.068, 'grad_norm': 1.1909432411193848, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.3554, 'grad_norm': 4.566308975219727, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.1887, 'grad_norm': 3.982146739959717, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.063, 'grad_norm': 0.857221782207489, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.551, 'grad_norm': 5.304117202758789, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.17it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.1853, 'grad_norm': 2.9409615993499756, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.0566, 'grad_norm': 3.1985785961151123, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 11.9878, 'train_samples_per_second': 47.131, 'train_steps_per_second': 3.337, 'train_loss': 0.9967802623286843, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]100%|██████████| 40/40 [00:11<00:00,  3.34it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]                                              {'loss': 2.8871, 'grad_norm': 4.746311664581299, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]                                              {'loss': 4.1422, 'grad_norm': 8.171232223510742, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]  8%|▊         | 3/40 [00:00<00:12,  3.02it/s]                                              {'loss': 2.9907, 'grad_norm': 8.421428680419922, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.02it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.1087, 'grad_norm': 10.415090560913086, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.2231, 'grad_norm': 13.012425422668457, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.2291, 'grad_norm': 16.740304946899414, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 2.6293, 'grad_norm': 14.114686965942383, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 1.2197, 'grad_norm': 40.339141845703125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:07,  3.90it/s]                                              {'loss': 1.0429, 'grad_norm': 6.040516376495361, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:07,  3.90it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.63it/s]                                               {'loss': 0.8879, 'grad_norm': 5.778118133544922, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.63it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s]                                               {'loss': 0.5105, 'grad_norm': 4.013084411621094, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s] 30%|███       | 12/40 [00:03<00:08,  3.29it/s]                                               {'loss': 0.3228, 'grad_norm': 3.0794715881347656, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.29it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s]                                               {'loss': 1.2235, 'grad_norm': 8.114777565002441, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.21it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s]                                               {'loss': 0.7782, 'grad_norm': 7.565125942230225, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.7496, 'grad_norm': 6.280704975128174, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.2727, 'grad_norm': 10.910306930541992, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 0.6022, 'grad_norm': 3.898371458053589, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 0.3287, 'grad_norm': 5.19924259185791, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s]                                               {'loss': 0.224, 'grad_norm': 3.9843852519989014, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.41it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 0.2693, 'grad_norm': 3.7001054286956787, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.1193, 'grad_norm': 2.8814728260040283, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.4072, 'grad_norm': 4.139857769012451, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.296, 'grad_norm': 3.121896266937256, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.1058, 'grad_norm': 5.566313743591309, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s]                                               {'loss': 0.1415, 'grad_norm': 2.132188081741333, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s]                                               {'loss': 0.2079, 'grad_norm': 3.5737602710723877, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s]                                               {'loss': 0.1423, 'grad_norm': 2.7923660278320312, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.41it/s] 70%|███████   | 28/40 [00:08<00:03,  3.27it/s]                                               {'loss': 0.0294, 'grad_norm': 0.4385721683502197, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.27it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s]                                               {'loss': 0.1125, 'grad_norm': 1.9924476146697998, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.11it/s]                                               {'loss': 0.2976, 'grad_norm': 1.8902748823165894, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.11it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.1244, 'grad_norm': 1.2700918912887573, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.07it/s]                                               {'loss': 0.0003, 'grad_norm': 0.017012162134051323, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.07it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s]                                               {'loss': 0.038, 'grad_norm': 0.851703405380249, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.79it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s]                                               {'loss': 0.3664, 'grad_norm': 4.5465407371521, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.56it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s]                                               {'loss': 0.0452, 'grad_norm': 1.1716792583465576, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s]                                               {'loss': 0.0419, 'grad_norm': 0.9353002905845642, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.25it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.081, 'grad_norm': 0.9313117265701294, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.16it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.0751, 'grad_norm': 1.8582051992416382, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.02it/s]                                               {'loss': 0.0453, 'grad_norm': 0.8730790019035339, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.02it/s]                                               {'loss': 0.0034, 'grad_norm': 0.2617427706718445, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.02it/s]                                               {'train_runtime': 12.258, 'train_samples_per_second': 46.092, 'train_steps_per_second': 3.263, 'train_loss': 0.7580656260011892, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.02it/s]100%|██████████| 40/40 [00:12<00:00,  3.26it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 4.9526, 'grad_norm': 5.186520576477051, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]                                              {'loss': 4.4582, 'grad_norm': 8.54004955291748, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.09it/s]  8%|▊         | 3/40 [00:00<00:12,  3.07it/s]                                              {'loss': 3.5985, 'grad_norm': 10.345346450805664, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.07it/s] 10%|█         | 4/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.0836, 'grad_norm': 10.283682823181152, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.05it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.06it/s]                                              {'loss': 2.7118, 'grad_norm': 17.056406021118164, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.06it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 3.0476, 'grad_norm': 16.59916877746582, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.07it/s]                                              {'loss': 3.5996, 'grad_norm': 17.575366973876953, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.07it/s]                                              {'loss': 4.7512, 'grad_norm': 69.69647216796875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.07it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s]                                              {'loss': 1.2486, 'grad_norm': 9.254036903381348, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s]                                               {'loss': 1.4103, 'grad_norm': 10.094939231872559, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s]                                               {'loss': 1.893, 'grad_norm': 14.669088363647461, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.42it/s] 30%|███       | 12/40 [00:03<00:08,  3.31it/s]                                               {'loss': 0.7439, 'grad_norm': 6.760897159576416, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.31it/s] 32%|███▎      | 13/40 [00:03<00:08,  3.22it/s]                                               {'loss': 1.256, 'grad_norm': 7.688088893890381, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:08,  3.22it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s]                                               {'loss': 1.1528, 'grad_norm': 8.624707221984863, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.16it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 1.7538, 'grad_norm': 11.433147430419922, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 0.002, 'grad_norm': 0.12042859941720963, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.13it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.90it/s]                                               {'loss': 1.4181, 'grad_norm': 6.8694586753845215, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.90it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s]                                               {'loss': 0.9712, 'grad_norm': 5.676161766052246, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.65it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s]                                               {'loss': 0.6358, 'grad_norm': 3.701310157775879, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s] 50%|█████     | 20/40 [00:06<00:06,  3.33it/s]                                               {'loss': 1.2974, 'grad_norm': 6.989832401275635, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.33it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.24it/s]                                               {'loss': 0.8318, 'grad_norm': 4.353324890136719, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.24it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.3637, 'grad_norm': 4.562851428985596, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.18it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.3094, 'grad_norm': 2.8890652656555176, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.14it/s]                                               {'loss': 0.0866, 'grad_norm': 12.973281860351562, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.14it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s]                                               {'loss': 0.4082, 'grad_norm': 3.424245595932007, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s]                                               {'loss': 0.5155, 'grad_norm': 7.563292503356934, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.1815, 'grad_norm': 3.8122169971466064, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.31it/s]                                               {'loss': 0.2478, 'grad_norm': 4.3508148193359375, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.31it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.4602, 'grad_norm': 4.322582721710205, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.229, 'grad_norm': 2.187192678451538, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.9175, 'grad_norm': 4.525830268859863, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.1731, 'grad_norm': 12.85353946685791, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s]                                               {'loss': 0.8497, 'grad_norm': 3.085078001022339, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.3687, 'grad_norm': 3.241917371749878, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s]                                               {'loss': 0.156, 'grad_norm': 1.6837676763534546, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.39it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.26it/s]                                               {'loss': 0.1734, 'grad_norm': 2.062000036239624, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.26it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.4453, 'grad_norm': 5.869107723236084, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.5554, 'grad_norm': 6.5580644607543945, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.12it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.1685, 'grad_norm': 1.8238730430603027, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.1371, 'grad_norm': 7.577714443206787, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.09it/s]                                               {'train_runtime': 12.0621, 'train_samples_per_second': 46.841, 'train_steps_per_second': 3.316, 'train_loss': 1.2641142669774126, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.09it/s]100%|██████████| 40/40 [00:12<00:00,  3.32it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 11.09it/s]  1%|          | 4/471 [00:00<01:06,  6.98it/s]  1%|          | 5/471 [00:00<01:12,  6.45it/s]  1%|▏         | 6/471 [00:00<01:16,  6.09it/s]  1%|▏         | 7/471 [00:01<01:18,  5.89it/s]  2%|▏         | 8/471 [00:01<01:20,  5.76it/s]  2%|▏         | 9/471 [00:01<01:21,  5.68it/s]  2%|▏         | 10/471 [00:01<01:21,  5.63it/s]  2%|▏         | 11/471 [00:01<01:22,  5.58it/s]  3%|▎         | 12/471 [00:02<01:22,  5.54it/s]  3%|▎         | 13/471 [00:02<01:23,  5.50it/s]  3%|▎         | 14/471 [00:02<01:23,  5.50it/s]  3%|▎         | 15/471 [00:02<01:22,  5.51it/s]  3%|▎         | 16/471 [00:02<01:22,  5.49it/s]  4%|▎         | 17/471 [00:02<01:22,  5.48it/s]  4%|▍         | 18/471 [00:03<01:22,  5.47it/s]  4%|▍         | 19/471 [00:03<01:22,  5.45it/s]  4%|▍         | 20/471 [00:03<01:22,  5.46it/s]  4%|▍         | 21/471 [00:03<01:22,  5.48it/s]  5%|▍         | 22/471 [00:03<01:22,  5.47it/s]  5%|▍         | 23/471 [00:04<01:21,  5.48it/s]  5%|▌         | 24/471 [00:04<01:21,  5.46it/s]  5%|▌         | 25/471 [00:04<01:21,  5.46it/s]  6%|▌         | 26/471 [00:04<01:21,  5.46it/s]  6%|▌         | 27/471 [00:04<01:21,  5.47it/s]  6%|▌         | 28/471 [00:04<01:20,  5.48it/s]  6%|▌         | 29/471 [00:05<01:20,  5.47it/s]  6%|▋         | 30/471 [00:05<01:21,  5.44it/s]  7%|▋         | 31/471 [00:05<01:20,  5.46it/s]  7%|▋         | 32/471 [00:05<01:20,  5.46it/s]  7%|▋         | 33/471 [00:05<01:19,  5.50it/s]  7%|▋         | 34/471 [00:06<01:19,  5.51it/s]  7%|▋         | 35/471 [00:06<01:19,  5.48it/s]  8%|▊         | 36/471 [00:06<01:19,  5.49it/s]  8%|▊         | 37/471 [00:06<01:19,  5.46it/s]  8%|▊         | 38/471 [00:06<01:19,  5.46it/s]  8%|▊         | 39/471 [00:06<01:19,  5.47it/s]  8%|▊         | 40/471 [00:07<01:18,  5.46it/s]  9%|▊         | 41/471 [00:07<01:18,  5.46it/s]  9%|▉         | 42/471 [00:07<01:18,  5.45it/s]  9%|▉         | 43/471 [00:07<01:18,  5.44it/s]  9%|▉         | 44/471 [00:07<01:18,  5.47it/s] 10%|▉         | 45/471 [00:08<01:17,  5.48it/s] 10%|▉         | 46/471 [00:08<01:17,  5.46it/s] 10%|▉         | 47/471 [00:08<01:17,  5.46it/s] 10%|█         | 48/471 [00:08<01:17,  5.47it/s] 10%|█         | 49/471 [00:08<01:17,  5.47it/s] 11%|█         | 50/471 [00:08<01:17,  5.46it/s] 11%|█         | 51/471 [00:09<01:16,  5.46it/s] 11%|█         | 52/471 [00:09<01:16,  5.46it/s] 11%|█▏        | 53/471 [00:09<01:16,  5.44it/s] 11%|█▏        | 54/471 [00:09<01:16,  5.45it/s] 12%|█▏        | 55/471 [00:09<01:16,  5.44it/s] 12%|█▏        | 56/471 [00:10<01:16,  5.44it/s] 12%|█▏        | 57/471 [00:10<01:16,  5.44it/s] 12%|█▏        | 58/471 [00:10<01:16,  5.43it/s] 13%|█▎        | 59/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 60/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 61/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 62/471 [00:11<01:15,  5.42it/s] 13%|█▎        | 63/471 [00:11<01:15,  5.43it/s] 14%|█▎        | 64/471 [00:11<01:14,  5.43it/s] 14%|█▍        | 65/471 [00:11<01:14,  5.42it/s] 14%|█▍        | 66/471 [00:11<01:14,  5.42it/s] 14%|█▍        | 67/471 [00:12<01:14,  5.41it/s] 14%|█▍        | 68/471 [00:12<01:14,  5.40it/s] 15%|█▍        | 69/471 [00:12<01:14,  5.42it/s] 15%|█▍        | 70/471 [00:12<01:14,  5.41it/s] 15%|█▌        | 71/471 [00:12<01:13,  5.41it/s] 15%|█▌        | 72/471 [00:13<01:13,  5.42it/s] 15%|█▌        | 73/471 [00:13<01:13,  5.40it/s] 16%|█▌        | 74/471 [00:13<01:13,  5.43it/s] 16%|█▌        | 75/471 [00:13<01:13,  5.40it/s] 16%|█▌        | 76/471 [00:13<01:12,  5.42it/s] 16%|█▋        | 77/471 [00:13<01:12,  5.42it/s] 17%|█▋        | 78/471 [00:14<01:12,  5.43it/s] 17%|█▋        | 79/471 [00:14<01:12,  5.40it/s] 17%|█▋        | 80/471 [00:14<01:12,  5.41it/s] 17%|█▋        | 81/471 [00:14<01:12,  5.41it/s] 17%|█▋        | 82/471 [00:14<01:11,  5.43it/s] 18%|█▊        | 83/471 [00:15<01:11,  5.44it/s] 18%|█▊        | 84/471 [00:15<01:11,  5.42it/s] 18%|█▊        | 85/471 [00:15<01:11,  5.42it/s] 18%|█▊        | 86/471 [00:15<01:11,  5.40it/s] 18%|█▊        | 87/471 [00:15<01:10,  5.42it/s] 19%|█▊        | 88/471 [00:15<01:10,  5.42it/s] 19%|█▉        | 89/471 [00:16<01:10,  5.43it/s] 19%|█▉        | 90/471 [00:16<01:10,  5.42it/s] 19%|█▉        | 91/471 [00:16<01:09,  5.44it/s] 20%|█▉        | 92/471 [00:16<01:09,  5.44it/s] 20%|█▉        | 93/471 [00:16<01:09,  5.41it/s] 20%|█▉        | 94/471 [00:17<01:09,  5.43it/s] 20%|██        | 95/471 [00:17<01:09,  5.44it/s] 20%|██        | 96/471 [00:17<01:09,  5.43it/s] 21%|██        | 97/471 [00:17<01:09,  5.41it/s] 21%|██        | 98/471 [00:17<01:08,  5.42it/s] 21%|██        | 99/471 [00:17<01:08,  5.43it/s] 21%|██        | 100/471 [00:18<01:08,  5.44it/s] 21%|██▏       | 101/471 [00:18<01:08,  5.43it/s] 22%|██▏       | 102/471 [00:18<01:07,  5.43it/s] 22%|██▏       | 103/471 [00:18<01:07,  5.43it/s] 22%|██▏       | 104/471 [00:18<01:07,  5.40it/s] 22%|██▏       | 105/471 [00:19<01:08,  5.38it/s] 23%|██▎       | 106/471 [00:19<01:07,  5.41it/s] 23%|██▎       | 107/471 [00:19<01:06,  5.43it/s] 23%|██▎       | 108/471 [00:19<01:06,  5.44it/s] 23%|██▎       | 109/471 [00:19<01:06,  5.44it/s] 23%|██▎       | 110/471 [00:20<01:06,  5.46it/s] 24%|██▎       | 111/471 [00:20<01:06,  5.42it/s] 24%|██▍       | 112/471 [00:20<01:06,  5.42it/s] 24%|██▍       | 113/471 [00:20<01:05,  5.45it/s] 24%|██▍       | 114/471 [00:20<01:05,  5.44it/s] 24%|██▍       | 115/471 [00:20<01:05,  5.44it/s] 25%|██▍       | 116/471 [00:21<01:05,  5.41it/s] 25%|██▍       | 117/471 [00:21<01:05,  5.41it/s] 25%|██▌       | 118/471 [00:21<01:05,  5.40it/s] 25%|██▌       | 119/471 [00:21<01:05,  5.41it/s] 25%|██▌       | 120/471 [00:21<01:04,  5.40it/s] 26%|██▌       | 121/471 [00:22<01:04,  5.42it/s] 26%|██▌       | 122/471 [00:22<01:04,  5.42it/s] 26%|██▌       | 123/471 [00:22<01:04,  5.43it/s] 26%|██▋       | 124/471 [00:22<01:04,  5.40it/s] 27%|██▋       | 125/471 [00:22<01:03,  5.41it/s] 27%|██▋       | 126/471 [00:22<01:03,  5.41it/s] 27%|██▋       | 127/471 [00:23<01:03,  5.41it/s] 27%|██▋       | 128/471 [00:23<01:03,  5.41it/s] 27%|██▋       | 129/471 [00:23<01:03,  5.42it/s] 28%|██▊       | 130/471 [00:23<01:02,  5.43it/s] 28%|██▊       | 131/471 [00:23<01:02,  5.42it/s] 28%|██▊       | 132/471 [00:24<01:02,  5.41it/s] 28%|██▊       | 133/471 [00:24<01:02,  5.41it/s] 28%|██▊       | 134/471 [00:24<01:02,  5.40it/s] 29%|██▊       | 135/471 [00:24<01:02,  5.40it/s] 29%|██▉       | 136/471 [00:24<01:02,  5.40it/s] 29%|██▉       | 137/471 [00:25<01:01,  5.40it/s] 29%|██▉       | 138/471 [00:25<01:01,  5.39it/s] 30%|██▉       | 139/471 [00:25<01:01,  5.42it/s] 30%|██▉       | 140/471 [00:25<01:01,  5.40it/s] 30%|██▉       | 141/471 [00:25<01:00,  5.42it/s] 30%|███       | 142/471 [00:25<01:00,  5.43it/s] 30%|███       | 143/471 [00:26<01:00,  5.41it/s] 31%|███       | 144/471 [00:26<01:00,  5.40it/s] 31%|███       | 145/471 [00:26<01:00,  5.42it/s] 31%|███       | 146/471 [00:26<00:59,  5.43it/s] 31%|███       | 147/471 [00:26<00:59,  5.41it/s] 31%|███▏      | 148/471 [00:27<00:59,  5.41it/s] 32%|███▏      | 149/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 150/471 [00:27<00:59,  5.37it/s] 32%|███▏      | 151/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 152/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 153/471 [00:27<00:59,  5.38it/s] 33%|███▎      | 154/471 [00:28<00:58,  5.40it/s] 33%|███▎      | 155/471 [00:28<00:58,  5.41it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.40it/s] 33%|███▎      | 157/471 [00:28<00:57,  5.42it/s] 34%|███▎      | 158/471 [00:28<00:57,  5.42it/s] 34%|███▍      | 159/471 [00:29<00:57,  5.42it/s] 34%|███▍      | 160/471 [00:29<00:57,  5.40it/s] 34%|███▍      | 161/471 [00:29<00:57,  5.40it/s] 34%|███▍      | 162/471 [00:29<00:57,  5.39it/s] 35%|███▍      | 163/471 [00:29<00:57,  5.39it/s] 35%|███▍      | 164/471 [00:30<00:56,  5.39it/s] 35%|███▌      | 165/471 [00:30<00:56,  5.39it/s] 35%|███▌      | 166/471 [00:30<00:56,  5.38it/s] 35%|███▌      | 167/471 [00:30<00:56,  5.37it/s] 36%|███▌      | 168/471 [00:30<00:56,  5.38it/s] 36%|███▌      | 169/471 [00:30<00:56,  5.38it/s] 36%|███▌      | 170/471 [00:31<00:55,  5.40it/s] 36%|███▋      | 171/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 172/471 [00:31<00:55,  5.39it/s] 37%|███▋      | 173/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 174/471 [00:31<00:55,  5.37it/s] 37%|███▋      | 175/471 [00:32<00:54,  5.38it/s] 37%|███▋      | 176/471 [00:32<00:54,  5.40it/s] 38%|███▊      | 177/471 [00:32<00:54,  5.40it/s] 38%|███▊      | 178/471 [00:32<00:54,  5.39it/s] 38%|███▊      | 179/471 [00:32<00:54,  5.40it/s] 38%|███▊      | 180/471 [00:32<00:53,  5.39it/s] 38%|███▊      | 181/471 [00:33<00:53,  5.39it/s] 39%|███▊      | 182/471 [00:33<00:53,  5.40it/s] 39%|███▉      | 183/471 [00:33<00:53,  5.39it/s] 39%|███▉      | 184/471 [00:33<00:53,  5.40it/s] 39%|███▉      | 185/471 [00:33<00:53,  5.39it/s] 39%|███▉      | 186/471 [00:34<00:52,  5.39it/s] 40%|███▉      | 187/471 [00:34<00:52,  5.37it/s] 40%|███▉      | 188/471 [00:34<00:52,  5.37it/s] 40%|████      | 189/471 [00:34<00:52,  5.40it/s] 40%|████      | 190/471 [00:34<00:52,  5.40it/s] 41%|████      | 191/471 [00:35<00:51,  5.39it/s] 41%|████      | 192/471 [00:35<00:51,  5.37it/s] 41%|████      | 193/471 [00:35<00:51,  5.41it/s] 41%|████      | 194/471 [00:35<00:51,  5.40it/s] 41%|████▏     | 195/471 [00:35<00:51,  5.40it/s] 42%|████▏     | 196/471 [00:35<00:50,  5.39it/s] 42%|████▏     | 197/471 [00:36<00:50,  5.42it/s] 42%|████▏     | 198/471 [00:36<00:50,  5.40it/s] 42%|████▏     | 199/471 [00:36<00:50,  5.39it/s] 42%|████▏     | 200/471 [00:36<00:50,  5.39it/s] 43%|████▎     | 201/471 [00:36<00:49,  5.41it/s] 43%|████▎     | 202/471 [00:37<00:49,  5.41it/s] 43%|████▎     | 203/471 [00:37<00:49,  5.39it/s] 43%|████▎     | 204/471 [00:37<00:49,  5.39it/s] 44%|████▎     | 205/471 [00:37<00:49,  5.40it/s] 44%|████▎     | 206/471 [00:37<00:49,  5.40it/s] 44%|████▍     | 207/471 [00:37<00:48,  5.39it/s] 44%|████▍     | 208/471 [00:38<00:48,  5.43it/s] 44%|████▍     | 209/471 [00:38<00:48,  5.43it/s] 45%|████▍     | 210/471 [00:38<00:48,  5.42it/s] 45%|████▍     | 211/471 [00:38<00:47,  5.42it/s] 45%|████▌     | 212/471 [00:38<00:47,  5.41it/s] 45%|████▌     | 213/471 [00:39<00:47,  5.40it/s] 45%|████▌     | 214/471 [00:39<00:47,  5.39it/s] 46%|████▌     | 215/471 [00:39<00:47,  5.39it/s] 46%|████▌     | 216/471 [00:39<00:47,  5.41it/s] 46%|████▌     | 217/471 [00:39<00:46,  5.41it/s] 46%|████▋     | 218/471 [00:40<00:46,  5.39it/s] 46%|████▋     | 219/471 [00:40<00:46,  5.38it/s] 47%|████▋     | 220/471 [00:40<00:46,  5.37it/s] 47%|████▋     | 221/471 [00:40<00:46,  5.38it/s] 47%|████▋     | 222/471 [00:40<00:46,  5.39it/s] 47%|████▋     | 223/471 [00:40<00:45,  5.40it/s] 48%|████▊     | 224/471 [00:41<00:45,  5.39it/s] 48%|████▊     | 225/471 [00:41<00:45,  5.39it/s] 48%|████▊     | 226/471 [00:41<00:45,  5.37it/s] 48%|████▊     | 227/471 [00:41<00:45,  5.38it/s] 48%|████▊     | 228/471 [00:41<00:45,  5.38it/s] 49%|████▊     | 229/471 [00:42<00:45,  5.37it/s] 49%|████▉     | 230/471 [00:42<00:44,  5.37it/s] 49%|████▉     | 231/471 [00:42<00:44,  5.36it/s] 49%|████▉     | 232/471 [00:42<00:44,  5.38it/s] 49%|████▉     | 233/471 [00:42<00:44,  5.39it/s] 50%|████▉     | 234/471 [00:42<00:44,  5.37it/s] 50%|████▉     | 235/471 [00:43<00:43,  5.37it/s] 50%|█████     | 236/471 [00:43<00:43,  5.39it/s] 50%|█████     | 237/471 [00:43<00:43,  5.38it/s] 51%|█████     | 238/471 [00:43<00:43,  5.38it/s] 51%|█████     | 239/471 [00:43<00:43,  5.38it/s] 51%|█████     | 240/471 [00:44<00:42,  5.38it/s] 51%|█████     | 241/471 [00:44<00:42,  5.36it/s] 51%|█████▏    | 242/471 [00:44<00:42,  5.37it/s] 52%|█████▏    | 243/471 [00:44<00:42,  5.37it/s] 52%|█████▏    | 244/471 [00:44<00:42,  5.35it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.35it/s] 52%|█████▏    | 246/471 [00:45<00:41,  5.37it/s] 52%|█████▏    | 247/471 [00:45<00:41,  5.38it/s] 53%|█████▎    | 248/471 [00:45<00:41,  5.39it/s] 53%|█████▎    | 249/471 [00:45<00:41,  5.37it/s] 53%|█████▎    | 250/471 [00:45<00:41,  5.37it/s] 53%|█████▎    | 251/471 [00:46<00:40,  5.37it/s] 54%|█████▎    | 252/471 [00:46<00:40,  5.36it/s] 54%|█████▎    | 253/471 [00:46<00:40,  5.35it/s] 54%|█████▍    | 254/471 [00:46<00:40,  5.36it/s] 54%|█████▍    | 255/471 [00:46<00:40,  5.37it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.36it/s] 55%|█████▍    | 257/471 [00:47<00:39,  5.36it/s] 55%|█████▍    | 258/471 [00:47<00:39,  5.36it/s] 55%|█████▍    | 259/471 [00:47<00:39,  5.35it/s] 55%|█████▌    | 260/471 [00:47<00:39,  5.34it/s] 55%|█████▌    | 261/471 [00:48<00:39,  5.34it/s] 56%|█████▌    | 262/471 [00:48<00:38,  5.37it/s] 56%|█████▌    | 263/471 [00:48<00:38,  5.37it/s] 56%|█████▌    | 264/471 [00:48<00:38,  5.36it/s] 56%|█████▋    | 265/471 [00:48<00:38,  5.34it/s] 56%|█████▋    | 266/471 [00:48<00:38,  5.33it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.34it/s] 57%|█████▋    | 268/471 [00:49<00:37,  5.35it/s] 57%|█████▋    | 269/471 [00:49<00:37,  5.35it/s] 57%|█████▋    | 270/471 [00:49<00:37,  5.36it/s] 58%|█████▊    | 271/471 [00:49<00:37,  5.35it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.36it/s] 58%|█████▊    | 273/471 [00:50<00:36,  5.38it/s] 58%|█████▊    | 274/471 [00:50<00:36,  5.40it/s] 58%|█████▊    | 275/471 [00:50<00:36,  5.41it/s] 59%|█████▊    | 276/471 [00:50<00:36,  5.38it/s] 59%|█████▉    | 277/471 [00:51<00:36,  5.36it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.36it/s] 59%|█████▉    | 279/471 [00:51<00:35,  5.37it/s] 59%|█████▉    | 280/471 [00:51<00:35,  5.37it/s] 60%|█████▉    | 281/471 [00:51<00:35,  5.37it/s] 60%|█████▉    | 282/471 [00:51<00:35,  5.36it/s] 60%|██████    | 283/471 [00:52<00:35,  5.34it/s] 60%|██████    | 284/471 [00:52<00:34,  5.36it/s] 61%|██████    | 285/471 [00:52<00:34,  5.35it/s] 61%|██████    | 286/471 [00:52<00:34,  5.34it/s] 61%|██████    | 287/471 [00:52<00:34,  5.33it/s] 61%|██████    | 288/471 [00:53<00:34,  5.33it/s] 61%|██████▏   | 289/471 [00:53<00:33,  5.36it/s] 62%|██████▏   | 290/471 [00:53<00:33,  5.37it/s] 62%|██████▏   | 291/471 [00:53<00:33,  5.36it/s] 62%|██████▏   | 292/471 [00:53<00:33,  5.35it/s] 62%|██████▏   | 293/471 [00:53<00:33,  5.37it/s] 62%|██████▏   | 294/471 [00:54<00:32,  5.38it/s] 63%|██████▎   | 295/471 [00:54<00:32,  5.39it/s] 63%|██████▎   | 296/471 [00:54<00:32,  5.40it/s] 63%|██████▎   | 297/471 [00:54<00:32,  5.39it/s] 63%|██████▎   | 298/471 [00:54<00:32,  5.38it/s] 63%|██████▎   | 299/471 [00:55<00:32,  5.37it/s] 64%|██████▎   | 300/471 [00:55<00:31,  5.37it/s] 64%|██████▍   | 301/471 [00:55<00:31,  5.38it/s] 64%|██████▍   | 302/471 [00:55<00:31,  5.36it/s] 64%|██████▍   | 303/471 [00:55<00:31,  5.36it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.37it/s] 65%|██████▍   | 305/471 [00:56<00:30,  5.36it/s] 65%|██████▍   | 306/471 [00:56<00:30,  5.36it/s] 65%|██████▌   | 307/471 [00:56<00:30,  5.35it/s] 65%|██████▌   | 308/471 [00:56<00:30,  5.33it/s] 66%|██████▌   | 309/471 [00:56<00:30,  5.33it/s] 66%|██████▌   | 310/471 [00:57<00:30,  5.35it/s] 66%|██████▌   | 311/471 [00:57<00:29,  5.36it/s] 66%|██████▌   | 312/471 [00:57<00:29,  5.36it/s] 66%|██████▋   | 313/471 [00:57<00:29,  5.37it/s] 67%|██████▋   | 314/471 [00:57<00:29,  5.36it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.36it/s] 67%|██████▋   | 316/471 [00:58<00:28,  5.38it/s] 67%|██████▋   | 317/471 [00:58<00:28,  5.38it/s] 68%|██████▊   | 318/471 [00:58<00:28,  5.38it/s] 68%|██████▊   | 319/471 [00:58<00:28,  5.36it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.35it/s] 68%|██████▊   | 321/471 [00:59<00:28,  5.34it/s] 68%|██████▊   | 322/471 [00:59<00:27,  5.36it/s] 69%|██████▊   | 323/471 [00:59<00:27,  5.34it/s] 69%|██████▉   | 324/471 [00:59<00:27,  5.33it/s] 69%|██████▉   | 325/471 [00:59<00:27,  5.33it/s] 69%|██████▉   | 326/471 [01:00<00:27,  5.34it/s] 69%|██████▉   | 327/471 [01:00<00:26,  5.35it/s] 70%|██████▉   | 328/471 [01:00<00:26,  5.34it/s] 70%|██████▉   | 329/471 [01:00<00:26,  5.34it/s] 70%|███████   | 330/471 [01:00<00:26,  5.37it/s] 70%|███████   | 331/471 [01:01<00:26,  5.36it/s] 70%|███████   | 332/471 [01:01<00:26,  5.34it/s] 71%|███████   | 333/471 [01:01<00:25,  5.36it/s] 71%|███████   | 334/471 [01:01<00:25,  5.35it/s] 71%|███████   | 335/471 [01:01<00:25,  5.34it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.35it/s] 72%|███████▏  | 337/471 [01:02<00:24,  5.36it/s] 72%|███████▏  | 338/471 [01:02<00:24,  5.37it/s] 72%|███████▏  | 339/471 [01:02<00:24,  5.35it/s] 72%|███████▏  | 340/471 [01:02<00:24,  5.35it/s] 72%|███████▏  | 341/471 [01:02<00:24,  5.34it/s] 73%|███████▎  | 342/471 [01:03<00:24,  5.36it/s] 73%|███████▎  | 343/471 [01:03<00:23,  5.35it/s] 73%|███████▎  | 344/471 [01:03<00:23,  5.36it/s] 73%|███████▎  | 345/471 [01:03<00:23,  5.36it/s] 73%|███████▎  | 346/471 [01:03<00:23,  5.34it/s] 74%|███████▎  | 347/471 [01:04<00:23,  5.35it/s] 74%|███████▍  | 348/471 [01:04<00:22,  5.36it/s] 74%|███████▍  | 349/471 [01:04<00:22,  5.35it/s] 74%|███████▍  | 350/471 [01:04<00:22,  5.34it/s] 75%|███████▍  | 351/471 [01:04<00:22,  5.36it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.35it/s] 75%|███████▍  | 353/471 [01:05<00:22,  5.33it/s] 75%|███████▌  | 354/471 [01:05<00:21,  5.34it/s] 75%|███████▌  | 355/471 [01:05<00:21,  5.33it/s] 76%|███████▌  | 356/471 [01:05<00:21,  5.35it/s] 76%|███████▌  | 357/471 [01:05<00:21,  5.34it/s] 76%|███████▌  | 358/471 [01:06<00:21,  5.34it/s] 76%|███████▌  | 359/471 [01:06<00:20,  5.34it/s] 76%|███████▋  | 360/471 [01:06<00:20,  5.35it/s] 77%|███████▋  | 361/471 [01:06<00:20,  5.36it/s] 77%|███████▋  | 362/471 [01:06<00:20,  5.37it/s] 77%|███████▋  | 363/471 [01:07<00:20,  5.35it/s] 77%|███████▋  | 364/471 [01:07<00:19,  5.36it/s] 77%|███████▋  | 365/471 [01:07<00:19,  5.37it/s] 78%|███████▊  | 366/471 [01:07<00:19,  5.34it/s] 78%|███████▊  | 367/471 [01:07<00:19,  5.34it/s] 78%|███████▊  | 368/471 [01:07<00:19,  5.36it/s] 78%|███████▊  | 369/471 [01:08<00:19,  5.36it/s] 79%|███████▊  | 370/471 [01:08<00:18,  5.35it/s] 79%|███████▉  | 371/471 [01:08<00:18,  5.35it/s] 79%|███████▉  | 372/471 [01:08<00:18,  5.36it/s] 79%|███████▉  | 373/471 [01:08<00:18,  5.33it/s] 79%|███████▉  | 374/471 [01:09<00:18,  5.35it/s] 80%|███████▉  | 375/471 [01:09<00:17,  5.37it/s] 80%|███████▉  | 376/471 [01:09<00:17,  5.36it/s] 80%|████████  | 377/471 [01:09<00:17,  5.38it/s] 80%|████████  | 378/471 [01:09<00:17,  5.39it/s] 80%|████████  | 379/471 [01:10<00:17,  5.38it/s] 81%|████████  | 380/471 [01:10<00:16,  5.37it/s] 81%|████████  | 381/471 [01:10<00:16,  5.37it/s] 81%|████████  | 382/471 [01:10<00:16,  5.37it/s] 81%|████████▏ | 383/471 [01:10<00:16,  5.36it/s] 82%|████████▏ | 384/471 [01:10<00:16,  5.34it/s] 82%|████████▏ | 385/471 [01:11<00:16,  5.34it/s] 82%|████████▏ | 386/471 [01:11<00:15,  5.34it/s] 82%|████████▏ | 387/471 [01:11<00:15,  5.34it/s] 82%|████████▏ | 388/471 [01:11<00:15,  5.33it/s] 83%|████████▎ | 389/471 [01:11<00:15,  5.35it/s] 83%|████████▎ | 390/471 [01:12<00:15,  5.35it/s] 83%|████████▎ | 391/471 [01:12<00:14,  5.34it/s] 83%|████████▎ | 392/471 [01:12<00:14,  5.35it/s] 83%|████████▎ | 393/471 [01:12<00:14,  5.36it/s] 84%|████████▎ | 394/471 [01:12<00:14,  5.35it/s] 84%|████████▍ | 395/471 [01:13<00:14,  5.34it/s] 84%|████████▍ | 396/471 [01:13<00:14,  5.34it/s] 84%|████████▍ | 397/471 [01:13<00:13,  5.36it/s] 85%|████████▍ | 398/471 [01:13<00:13,  5.35it/s] 85%|████████▍ | 399/471 [01:13<00:13,  5.33it/s] 85%|████████▍ | 400/471 [01:13<00:13,  5.33it/s] 85%|████████▌ | 401/471 [01:14<00:13,  5.35it/s] 85%|████████▌ | 402/471 [01:14<00:12,  5.34it/s] 86%|████████▌ | 403/471 [01:14<00:12,  5.34it/s] 86%|████████▌ | 404/471 [01:14<00:12,  5.34it/s] 86%|████████▌ | 405/471 [01:14<00:12,  5.34it/s] 86%|████████▌ | 406/471 [01:15<00:12,  5.35it/s] 86%|████████▋ | 407/471 [01:15<00:11,  5.36it/s] 87%|████████▋ | 408/471 [01:15<00:11,  5.35it/s] 87%|████████▋ | 409/471 [01:15<00:11,  5.33it/s] 87%|████████▋ | 410/471 [01:15<00:11,  5.34it/s] 87%|████████▋ | 411/471 [01:16<00:11,  5.38it/s] 87%|████████▋ | 412/471 [01:16<00:10,  5.36it/s] 88%|████████▊ | 413/471 [01:16<00:10,  5.36it/s] 88%|████████▊ | 414/471 [01:16<00:10,  5.35it/s] 88%|████████▊ | 415/471 [01:16<00:10,  5.34it/s] 88%|████████▊ | 416/471 [01:16<00:10,  5.33it/s] 89%|████████▊ | 417/471 [01:17<00:10,  5.34it/s] 89%|████████▊ | 418/471 [01:17<00:09,  5.35it/s] 89%|████████▉ | 419/471 [01:17<00:09,  5.35it/s] 89%|████████▉ | 420/471 [01:17<00:09,  5.37it/s] 89%|████████▉ | 421/471 [01:17<00:09,  5.36it/s] 90%|████████▉ | 422/471 [01:18<00:09,  5.35it/s] 90%|████████▉ | 423/471 [01:18<00:08,  5.37it/s] 90%|█████████ | 424/471 [01:18<00:08,  5.36it/s] 90%|█████████ | 425/471 [01:18<00:08,  5.36it/s] 90%|█████████ | 426/471 [01:18<00:08,  5.35it/s] 91%|█████████ | 427/471 [01:19<00:08,  5.36it/s] 91%|█████████ | 428/471 [01:19<00:08,  5.35it/s] 91%|█████████ | 429/471 [01:19<00:07,  5.36it/s] 91%|█████████▏| 430/471 [01:19<00:07,  5.36it/s] 92%|█████████▏| 431/471 [01:19<00:07,  5.34it/s] 92%|█████████▏| 432/471 [01:19<00:07,  5.34it/s] 92%|█████████▏| 433/471 [01:20<00:07,  5.35it/s] 92%|█████████▏| 434/471 [01:20<00:06,  5.34it/s] 92%|█████████▏| 435/471 [01:20<00:06,  5.34it/s] 93%|█████████▎| 436/471 [01:20<00:06,  5.34it/s] 93%|█████████▎| 437/471 [01:20<00:06,  5.35it/s] 93%|█████████▎| 438/471 [01:21<00:06,  5.35it/s] 93%|█████████▎| 439/471 [01:21<00:05,  5.35it/s] 93%|█████████▎| 440/471 [01:21<00:05,  5.36it/s] 94%|█████████▎| 441/471 [01:21<00:05,  5.36it/s] 94%|█████████▍| 442/471 [01:21<00:05,  5.39it/s] 94%|█████████▍| 443/471 [01:22<00:05,  5.37it/s] 94%|█████████▍| 444/471 [01:22<00:05,  5.36it/s] 94%|█████████▍| 445/471 [01:22<00:04,  5.36it/s] 95%|█████████▍| 446/471 [01:22<00:04,  5.35it/s] 95%|█████████▍| 447/471 [01:22<00:04,  5.35it/s] 95%|█████████▌| 448/471 [01:22<00:04,  5.37it/s] 95%|█████████▌| 449/471 [01:23<00:04,  5.37it/s] 96%|█████████▌| 450/471 [01:23<00:03,  5.35it/s] 96%|█████████▌| 451/471 [01:23<00:03,  5.35it/s] 96%|█████████▌| 452/471 [01:23<00:03,  5.36it/s] 96%|█████████▌| 453/471 [01:23<00:03,  5.35it/s] 96%|█████████▋| 454/471 [01:24<00:03,  5.34it/s] 97%|█████████▋| 455/471 [01:24<00:02,  5.33it/s] 97%|█████████▋| 456/471 [01:24<00:02,  5.35it/s] 97%|█████████▋| 457/471 [01:24<00:02,  5.34it/s] 97%|█████████▋| 458/471 [01:24<00:02,  5.36it/s] 97%|█████████▋| 459/471 [01:24<00:02,  5.38it/s] 98%|█████████▊| 460/471 [01:25<00:02,  5.37it/s] 98%|█████████▊| 461/471 [01:25<00:01,  5.36it/s] 98%|█████████▊| 462/471 [01:25<00:01,  5.35it/s] 98%|█████████▊| 463/471 [01:25<00:01,  5.35it/s] 99%|█████████▊| 464/471 [01:25<00:01,  5.36it/s] 99%|█████████▊| 465/471 [01:26<00:01,  5.36it/s] 99%|█████████▉| 466/471 [01:26<00:00,  5.35it/s] 99%|█████████▉| 467/471 [01:26<00:00,  5.34it/s] 99%|█████████▉| 468/471 [01:26<00:00,  5.32it/s]100%|█████████▉| 469/471 [01:26<00:00,  5.34it/s]100%|█████████▉| 470/471 [01:27<00:00,  5.34it/s]100%|██████████| 471/471 [01:27<00:00,  5.73it/s]100%|██████████| 471/471 [01:27<00:00,  5.40it/s]
{'eval_loss': 4.706509590148926, 'eval_model_preparation_time': 0.0053, 'eval_acc': 0.18520977164099842, 'eval_runtime': 87.3704, 'eval_samples_per_second': 86.208, 'eval_steps_per_second': 5.391}
ROUND:7
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]                                              {'loss': 5.1529, 'grad_norm': 6.736262321472168, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]                                              {'loss': 4.7514, 'grad_norm': 8.083250999450684, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 3.4207, 'grad_norm': 9.94272518157959, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.3222, 'grad_norm': 12.84333324432373, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.02it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.1936, 'grad_norm': 14.689923286437988, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 3.7968, 'grad_norm': 15.483001708984375, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 2.8151, 'grad_norm': 16.920854568481445, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 4.2999, 'grad_norm': 71.80584716796875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.01it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.68it/s]                                              {'loss': 1.7182, 'grad_norm': 9.002922058105469, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.68it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.49it/s]                                               {'loss': 0.8311, 'grad_norm': 8.988286018371582, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.49it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 0.9657, 'grad_norm': 6.293181419372559, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.23it/s]                                               {'loss': 1.4279, 'grad_norm': 7.6371026039123535, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.23it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.1031, 'grad_norm': 7.467525005340576, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.12it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.8522, 'grad_norm': 10.109601020812988, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.09it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 1.0584, 'grad_norm': 7.430873394012451, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.0724, 'grad_norm': 3.4447386264801025, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.06it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s]                                               {'loss': 0.4682, 'grad_norm': 4.459206581115723, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 0.2574, 'grad_norm': 4.22113561630249, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.6679, 'grad_norm': 8.007023811340332, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 1.0495, 'grad_norm': 7.350260257720947, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.2928, 'grad_norm': 3.7818803787231445, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.6319, 'grad_norm': 7.62190055847168, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.6326, 'grad_norm': 3.2785346508026123, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.1239, 'grad_norm': 9.336459159851074, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.6344, 'grad_norm': 9.73978328704834, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s]                                               {'loss': 0.1606, 'grad_norm': 2.37514328956604, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s]                                               {'loss': 0.0591, 'grad_norm': 0.8603599667549133, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s] 70%|███████   | 28/40 [00:08<00:03,  3.31it/s]                                               {'loss': 0.3026, 'grad_norm': 4.383337497711182, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.31it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.6921, 'grad_norm': 6.098229885101318, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.2389, 'grad_norm': 2.2130439281463623, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.1071, 'grad_norm': 2.1860101222991943, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.2336, 'grad_norm': 6.828961372375488, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s]                                               {'loss': 0.0346, 'grad_norm': 0.5370295643806458, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s]                                               {'loss': 0.0702, 'grad_norm': 2.205091953277588, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s]                                               {'loss': 0.056, 'grad_norm': 0.8101117610931396, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.43it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.0385, 'grad_norm': 0.5670753717422485, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.2515, 'grad_norm': 2.919708490371704, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.2985, 'grad_norm': 4.646147727966309, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.2493, 'grad_norm': 2.317054271697998, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.3286, 'grad_norm': 15.817886352539062, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.11it/s]                                               {'train_runtime': 12.1106, 'train_samples_per_second': 46.653, 'train_steps_per_second': 3.303, 'train_loss': 1.1915379796177148, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.11it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 4.0839, 'grad_norm': 7.334343433380127, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]                                              {'loss': 3.9415, 'grad_norm': 7.9707465171813965, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]  8%|▊         | 3/40 [00:00<00:12,  3.07it/s]                                              {'loss': 3.8905, 'grad_norm': 11.426373481750488, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.07it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s]                                              {'loss': 2.1864, 'grad_norm': 12.24020004272461, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 1.5151, 'grad_norm': 11.377409934997559, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.143, 'grad_norm': 24.808340072631836, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 2.7071, 'grad_norm': 17.44676399230957, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.05it/s]                                              {'loss': 1.3852, 'grad_norm': 71.8704605102539, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.05it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s]                                              {'loss': 1.0638, 'grad_norm': 11.491721153259277, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.80it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s]                                               {'loss': 1.2961, 'grad_norm': 15.151103973388672, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.55it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 1.4012, 'grad_norm': 13.692273139953613, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.24it/s]                                               {'loss': 1.002, 'grad_norm': 10.74459171295166, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.24it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 1.2753, 'grad_norm': 13.733087539672852, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.7102, 'grad_norm': 7.2436676025390625, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 1.2083, 'grad_norm': 12.743011474609375, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.06it/s]                                               {'loss': 0.1245, 'grad_norm': 9.91876220703125, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.06it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.74it/s]                                               {'loss': 0.6852, 'grad_norm': 5.61377477645874, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.74it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s]                                               {'loss': 0.5261, 'grad_norm': 5.538735389709473, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.52it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s]                                               {'loss': 0.892, 'grad_norm': 4.1403021812438965, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.37it/s] 50%|█████     | 20/40 [00:06<00:06,  3.24it/s]                                               {'loss': 0.5697, 'grad_norm': 5.260969161987305, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.24it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s]                                               {'loss': 0.1578, 'grad_norm': 2.9484775066375732, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.16it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s]                                               {'loss': 0.4932, 'grad_norm': 4.797402381896973, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.6747, 'grad_norm': 5.819701194763184, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.057, 'grad_norm': 3.5893006324768066, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s]                                               {'loss': 0.2342, 'grad_norm': 4.392470836639404, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s]                                               {'loss': 0.601, 'grad_norm': 3.766663074493408, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s]                                               {'loss': 0.3895, 'grad_norm': 3.9422354698181152, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.38it/s] 70%|███████   | 28/40 [00:08<00:03,  3.26it/s]                                               {'loss': 0.214, 'grad_norm': 1.742372989654541, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.26it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s]                                               {'loss': 0.1945, 'grad_norm': 6.9714202880859375, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.18it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.2812, 'grad_norm': 2.2687184810638428, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.1856, 'grad_norm': 5.086339473724365, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.0411, 'grad_norm': 3.1674530506134033, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s]                                               {'loss': 0.4237, 'grad_norm': 0.9907029271125793, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 0.041, 'grad_norm': 1.0810997486114502, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.2057, 'grad_norm': 1.279429316520691, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.0507, 'grad_norm': 1.093834638595581, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.0596, 'grad_norm': 1.3243649005889893, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.1708, 'grad_norm': 1.6367206573486328, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.212, 'grad_norm': 1.6676286458969116, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.07it/s]                                               {'loss': 0.0619, 'grad_norm': 2.7280473709106445, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.07it/s]                                               {'train_runtime': 12.1992, 'train_samples_per_second': 46.314, 'train_steps_per_second': 3.279, 'train_loss': 0.9339071425609291, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]100%|██████████| 40/40 [00:12<00:00,  3.28it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]                                              {'loss': 4.23, 'grad_norm': 7.276371479034424, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]                                              {'loss': 4.2393, 'grad_norm': 5.241989612579346, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]  8%|▊         | 3/40 [00:00<00:11,  3.13it/s]                                              {'loss': 3.1778, 'grad_norm': 11.828640937805176, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.13it/s] 10%|█         | 4/40 [00:01<00:11,  3.09it/s]                                              {'loss': 1.5938, 'grad_norm': 11.021523475646973, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.09it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s]                                              {'loss': 2.5903, 'grad_norm': 14.68642807006836, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.1193, 'grad_norm': 15.357028007507324, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 2.7329, 'grad_norm': 22.230180740356445, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 5.9554, 'grad_norm': 137.73239135742188, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s]                                              {'loss': 1.278, 'grad_norm': 12.422441482543945, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s]                                               {'loss': 2.0361, 'grad_norm': 18.00554847717285, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s]                                               {'loss': 1.9893, 'grad_norm': 13.795406341552734, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s] 30%|███       | 12/40 [00:03<00:08,  3.29it/s]                                               {'loss': 1.6085, 'grad_norm': 11.734513282775879, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.29it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 1.481, 'grad_norm': 12.32029914855957, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s]                                               {'loss': 1.4502, 'grad_norm': 10.544859886169434, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.10it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.04it/s]                                               {'loss': 0.9418, 'grad_norm': 6.06468391418457, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.04it/s]                                               {'loss': 0.0843, 'grad_norm': 4.509584426879883, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.04it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.74it/s]                                               {'loss': 0.9204, 'grad_norm': 6.385101318359375, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.74it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s]                                               {'loss': 0.5741, 'grad_norm': 5.468204498291016, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.50it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.35it/s]                                               {'loss': 0.5919, 'grad_norm': 4.641960620880127, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.35it/s] 50%|█████     | 20/40 [00:06<00:06,  3.25it/s]                                               {'loss': 0.6714, 'grad_norm': 5.492578983306885, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.25it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.985, 'grad_norm': 7.345109939575195, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 1.291, 'grad_norm': 8.074318885803223, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.8764, 'grad_norm': 5.660415172576904, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.6161, 'grad_norm': 22.655193328857422, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s]                                               {'loss': 0.2777, 'grad_norm': 5.513012886047363, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s]                                               {'loss': 0.7103, 'grad_norm': 6.820521354675293, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.56it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.9487, 'grad_norm': 5.189458847045898, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.09, 'grad_norm': 1.5734717845916748, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.2996, 'grad_norm': 6.087067127227783, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.2529, 'grad_norm': 6.129310607910156, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.1678, 'grad_norm': 2.491935968399048, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.014, 'grad_norm': 1.1043992042541504, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s]                                               {'loss': 0.4574, 'grad_norm': 0.840034544467926, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.80it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 0.0455, 'grad_norm': 1.1507737636566162, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s]                                               {'loss': 0.3767, 'grad_norm': 4.628227233886719, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.3653, 'grad_norm': 0.8700252771377563, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.1624, 'grad_norm': 7.1356072425842285, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.3601, 'grad_norm': 3.945371150970459, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.2487, 'grad_norm': 3.5212960243225098, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.1107, 'grad_norm': 9.280036926269531, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.10it/s]                                               {'train_runtime': 12.1128, 'train_samples_per_second': 46.645, 'train_steps_per_second': 3.302, 'train_loss': 1.2230513578746467, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.10it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]                                              {'loss': 5.955, 'grad_norm': 7.466118335723877, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.05it/s]  5%|▌         | 2/40 [00:00<00:12,  3.05it/s]                                              {'loss': 2.3321, 'grad_norm': 6.958648204803467, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.05it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 2.5551, 'grad_norm': 11.157187461853027, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.05it/s]                                              {'loss': 3.0181, 'grad_norm': 14.953802108764648, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.05it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s]                                              {'loss': 3.0736, 'grad_norm': 17.684009552001953, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.05it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s]                                              {'loss': 1.8453, 'grad_norm': 11.63023567199707, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.05it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 2.0117, 'grad_norm': 14.157899856567383, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 1.0344, 'grad_norm': 42.31340026855469, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.03it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s]                                              {'loss': 1.0258, 'grad_norm': 11.380008697509766, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.82it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s]                                               {'loss': 1.9753, 'grad_norm': 8.028284072875977, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.57it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s]                                               {'loss': 0.7681, 'grad_norm': 8.211278915405273, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s] 30%|███       | 12/40 [00:03<00:08,  3.24it/s]                                               {'loss': 0.9545, 'grad_norm': 8.307826042175293, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.24it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.2434, 'grad_norm': 8.91309928894043, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.12it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s]                                               {'loss': 0.5105, 'grad_norm': 8.270986557006836, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.11it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.4717, 'grad_norm': 7.2910614013671875, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 3.5028, 'grad_norm': 29.473976135253906, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 0.7928, 'grad_norm': 4.027982711791992, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.6173, 'grad_norm': 2.747272491455078, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s]                                               {'loss': 1.1585, 'grad_norm': 5.126736164093018, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s] 50%|█████     | 20/40 [00:06<00:06,  3.32it/s]                                               {'loss': 0.5272, 'grad_norm': 4.898804664611816, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.32it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.4634, 'grad_norm': 4.629438400268555, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.642, 'grad_norm': 5.457519054412842, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.259, 'grad_norm': 5.242956638336182, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.11it/s]                                               {'loss': 0.0158, 'grad_norm': 0.8613443970680237, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.11it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s]                                               {'loss': 0.6635, 'grad_norm': 7.134524822235107, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s]                                               {'loss': 0.7822, 'grad_norm': 4.397466659545898, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.3405, 'grad_norm': 2.8355064392089844, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.3957, 'grad_norm': 7.311153411865234, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.7613, 'grad_norm': 1.8541396856307983, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.2347, 'grad_norm': 3.186994791030884, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.0693, 'grad_norm': 1.5086499452590942, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.0191, 'grad_norm': 1.3435794115066528, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.10it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s]                                               {'loss': 0.1186, 'grad_norm': 2.0985209941864014, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.81it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s]                                               {'loss': 0.2385, 'grad_norm': 5.869233131408691, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.57it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s]                                               {'loss': 0.44, 'grad_norm': 1.3689706325531006, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.4128, 'grad_norm': 2.8473639488220215, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.0927, 'grad_norm': 2.3413584232330322, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.4477, 'grad_norm': 4.042038917541504, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.6046, 'grad_norm': 4.234714508056641, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0597, 'grad_norm': 2.714533805847168, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 12.0674, 'train_samples_per_second': 46.82, 'train_steps_per_second': 3.315, 'train_loss': 1.0858542622998357, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.12it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:44
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.82it/s]                                              {'loss': 4.406, 'grad_norm': 8.360119819641113, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.82it/s]  5%|▌         | 2/40 [00:00<00:13,  2.91it/s]                                              {'loss': 3.8174, 'grad_norm': 8.44028091430664, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.91it/s]  8%|▊         | 3/40 [00:01<00:12,  2.99it/s]                                              {'loss': 3.3588, 'grad_norm': 10.841267585754395, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.99it/s] 10%|█         | 4/40 [00:01<00:12,  2.99it/s]                                              {'loss': 3.2361, 'grad_norm': 13.229981422424316, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.99it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.4383, 'grad_norm': 10.99316692352295, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s] 15%|█▌        | 6/40 [00:02<00:11,  3.02it/s]                                              {'loss': 2.4685, 'grad_norm': 18.729331970214844, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 1.9665, 'grad_norm': 15.591887474060059, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 4.7624, 'grad_norm': 80.61127471923828, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s]                                              {'loss': 0.9368, 'grad_norm': 7.049830913543701, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.74it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.50it/s]                                               {'loss': 1.2954, 'grad_norm': 8.879998207092285, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.50it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s]                                               {'loss': 1.7897, 'grad_norm': 10.895590782165527, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.36it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 0.9766, 'grad_norm': 7.7713704109191895, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s]                                               {'loss': 1.1535, 'grad_norm': 7.346421241760254, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.17it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.4597, 'grad_norm': 8.573553085327148, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 1.0268, 'grad_norm': 8.127740859985352, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.4787, 'grad_norm': 13.78954029083252, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s]                                               {'loss': 0.7132, 'grad_norm': 8.737009048461914, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s]                                               {'loss': 0.9501, 'grad_norm': 5.822631359100342, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s]                                               {'loss': 0.9543, 'grad_norm': 6.245727062225342, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s] 50%|█████     | 20/40 [00:06<00:06,  3.32it/s]                                               {'loss': 0.447, 'grad_norm': 5.154378890991211, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.32it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 0.5292, 'grad_norm': 4.554722309112549, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.4087, 'grad_norm': 5.6933674812316895, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.7008, 'grad_norm': 5.486992359161377, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.1415, 'grad_norm': 10.330178260803223, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s]                                               {'loss': 0.3626, 'grad_norm': 1.5906246900558472, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.82it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s]                                               {'loss': 0.5052, 'grad_norm': 4.39427375793457, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.60it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.5011, 'grad_norm': 5.3573198318481445, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.31it/s]                                               {'loss': 0.339, 'grad_norm': 4.142232894897461, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.31it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s]                                               {'loss': 0.8587, 'grad_norm': 8.40280532836914, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.3402, 'grad_norm': 3.2759251594543457, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.14it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.2656, 'grad_norm': 2.9592292308807373, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.9961, 'grad_norm': 17.491348266601562, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.083, 'grad_norm': 2.4414823055267334, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 0.1177, 'grad_norm': 1.3524454832077026, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.377, 'grad_norm': 2.458491563796997, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s]                                               {'loss': 0.2354, 'grad_norm': 14.377991676330566, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.31it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.2873, 'grad_norm': 3.1893293857574463, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.1325, 'grad_norm': 1.6818702220916748, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.4499, 'grad_norm': 6.6125617027282715, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.0778, 'grad_norm': 3.739835739135742, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.11it/s]                                               {'train_runtime': 12.127, 'train_samples_per_second': 46.59, 'train_steps_per_second': 3.298, 'train_loss': 1.1586193604394794, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.11it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]                                              {'loss': 2.4276, 'grad_norm': 5.0803446769714355, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.98it/s]  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]                                              {'loss': 3.1351, 'grad_norm': 8.959419250488281, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]  8%|▊         | 3/40 [00:01<00:12,  2.98it/s]                                              {'loss': 1.9043, 'grad_norm': 9.582438468933105, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.98it/s] 10%|█         | 4/40 [00:01<00:12,  2.96it/s]                                              {'loss': 1.7402, 'grad_norm': 9.150299072265625, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.96it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 1.8475, 'grad_norm': 13.314005851745605, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.99it/s]                                              {'loss': 1.4044, 'grad_norm': 10.910981178283691, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.99it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s]                                              {'loss': 2.7327, 'grad_norm': 18.38698387145996, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s] 20%|██        | 8/40 [00:02<00:08,  3.80it/s]                                              {'loss': 0.0103, 'grad_norm': 0.6098089814186096, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.80it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.52it/s]                                              {'loss': 0.8315, 'grad_norm': 5.932007312774658, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.52it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.34it/s]                                               {'loss': 0.7353, 'grad_norm': 10.030521392822266, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.34it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.22it/s]                                               {'loss': 0.6189, 'grad_norm': 6.451929569244385, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.22it/s] 30%|███       | 12/40 [00:03<00:08,  3.16it/s]                                               {'loss': 0.6716, 'grad_norm': 6.080600261688232, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.16it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.8155, 'grad_norm': 7.450659275054932, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.10it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.09it/s]                                               {'loss': 0.3279, 'grad_norm': 5.3335394859313965, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.09it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.07it/s]                                               {'loss': 1.0007, 'grad_norm': 6.2073564529418945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.07it/s]                                               {'loss': 0.0147, 'grad_norm': 0.8547504544258118, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.07it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s]                                               {'loss': 0.5309, 'grad_norm': 1.9782824516296387, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s]                                               {'loss': 0.0518, 'grad_norm': 0.8219326734542847, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.59it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.3175, 'grad_norm': 6.12568473815918, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.29it/s]                                               {'loss': 0.1541, 'grad_norm': 3.3478808403015137, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.29it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s]                                               {'loss': 0.227, 'grad_norm': 3.1293845176696777, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.20it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.3266, 'grad_norm': 2.803088665008545, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.15it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.2279, 'grad_norm': 4.3454389572143555, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.148, 'grad_norm': 13.402191162109375, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.4135, 'grad_norm': 0.8826940059661865, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s]                                               {'loss': 0.318, 'grad_norm': 6.603937149047852, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s]                                               {'loss': 0.109, 'grad_norm': 3.2630646228790283, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.43it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.0522, 'grad_norm': 1.264085054397583, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s]                                               {'loss': 0.0956, 'grad_norm': 1.818371295928955, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.23it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.1046, 'grad_norm': 2.299978733062744, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.17it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.1687, 'grad_norm': 1.4814810752868652, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.12it/s]                                               {'loss': 0.0007, 'grad_norm': 0.040221258997917175, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.12it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s]                                               {'loss': 0.0287, 'grad_norm': 0.4734881818294525, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.85it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s]                                               {'loss': 0.0455, 'grad_norm': 1.3447942733764648, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.60it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s]                                               {'loss': 0.0546, 'grad_norm': 1.3096307516098022, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.1195, 'grad_norm': 1.240409016609192, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.0628, 'grad_norm': 1.3186020851135254, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s]                                               {'loss': 0.0547, 'grad_norm': 1.4425222873687744, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.15it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.384, 'grad_norm': 1.235873818397522, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0944, 'grad_norm': 6.100592613220215, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 12.1434, 'train_samples_per_second': 46.527, 'train_steps_per_second': 3.294, 'train_loss': 0.607713134905498, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.12it/s]100%|██████████| 40/40 [00:12<00:00,  3.29it/s]
CLIENT:24
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]                                              {'loss': 4.887, 'grad_norm': 6.948032379150391, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]  5%|▌         | 2/40 [00:00<00:12,  3.11it/s]                                              {'loss': 4.4191, 'grad_norm': 10.442423820495605, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.11it/s]  8%|▊         | 3/40 [00:00<00:12,  3.05it/s]                                              {'loss': 3.5864, 'grad_norm': 10.825387001037598, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.05it/s] 10%|█         | 4/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.0368, 'grad_norm': 10.381440162658691, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.01it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.0595, 'grad_norm': 11.529227256774902, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.01it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s]                                              {'loss': 2.902, 'grad_norm': 15.887551307678223, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 2.437, 'grad_norm': 14.71657657623291, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 5.3902, 'grad_norm': 51.0776481628418, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s]                                              {'loss': 1.3603, 'grad_norm': 9.816235542297363, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.73it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s]                                               {'loss': 1.7305, 'grad_norm': 9.736797332763672, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.52it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s]                                               {'loss': 1.3421, 'grad_norm': 8.937479019165039, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s] 30%|███       | 12/40 [00:03<00:08,  3.27it/s]                                               {'loss': 0.8527, 'grad_norm': 10.500489234924316, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.27it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.2221, 'grad_norm': 6.745957374572754, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.4146, 'grad_norm': 8.648768424987793, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.986, 'grad_norm': 8.465192794799805, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.10it/s]                                               {'loss': 0.0517, 'grad_norm': 2.1647253036499023, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.10it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 0.7693, 'grad_norm': 9.838045120239258, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s]                                               {'loss': 0.6528, 'grad_norm': 4.894550800323486, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s]                                               {'loss': 0.7589, 'grad_norm': 4.553811550140381, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.43it/s] 50%|█████     | 20/40 [00:06<00:05,  3.34it/s]                                               {'loss': 0.7384, 'grad_norm': 7.5134501457214355, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:05,  3.34it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s]                                               {'loss': 0.6678, 'grad_norm': 3.0477190017700195, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.26it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.5851, 'grad_norm': 7.946580410003662, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 1.0114, 'grad_norm': 12.204066276550293, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 1.2175, 'grad_norm': 17.802753448486328, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s]                                               {'loss': 0.4626, 'grad_norm': 16.76434898376465, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s]                                               {'loss': 0.8151, 'grad_norm': 4.547765254974365, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.57it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s]                                               {'loss': 0.4158, 'grad_norm': 5.41044282913208, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.39it/s] 70%|███████   | 28/40 [00:08<00:03,  3.28it/s]                                               {'loss': 0.4041, 'grad_norm': 3.999785900115967, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.28it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s]                                               {'loss': 0.4878, 'grad_norm': 4.985039710998535, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.20it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s]                                               {'loss': 0.4094, 'grad_norm': 5.317264556884766, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.12it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.3138, 'grad_norm': 4.098649501800537, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.08it/s]                                               {'loss': 0.4592, 'grad_norm': 11.207011222839355, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s]                                               {'loss': 0.2327, 'grad_norm': 2.09384822845459, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.75it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.53it/s]                                               {'loss': 0.1721, 'grad_norm': 2.8791816234588623, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.53it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.37it/s]                                               {'loss': 0.2047, 'grad_norm': 2.9323768615722656, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.37it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.5416, 'grad_norm': 3.2859644889831543, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s]                                               {'loss': 0.1697, 'grad_norm': 4.3931684494018555, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.21it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s]                                               {'loss': 0.2737, 'grad_norm': 4.276188850402832, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.16it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.2781, 'grad_norm': 1.0156725645065308, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.12it/s]                                               {'loss': 0.0571, 'grad_norm': 3.052093029022217, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.12it/s]                                               {'train_runtime': 12.0984, 'train_samples_per_second': 46.701, 'train_steps_per_second': 3.306, 'train_loss': 1.2194225710816682, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.12it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:98
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]                                              {'loss': 6.3763, 'grad_norm': 8.497774124145508, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.04it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 3.1744, 'grad_norm': 7.023244857788086, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:11,  3.16it/s]                                              {'loss': 2.1567, 'grad_norm': 10.911216735839844, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.16it/s] 10%|█         | 4/40 [00:01<00:11,  3.13it/s]                                              {'loss': 1.8704, 'grad_norm': 12.699254035949707, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.13it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s]                                              {'loss': 4.1005, 'grad_norm': 15.604007720947266, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.09it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s]                                              {'loss': 1.0089, 'grad_norm': 9.642753601074219, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.06it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 1.0415, 'grad_norm': 8.890769004821777, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.04it/s]                                              {'loss': 7.0121, 'grad_norm': 99.47636413574219, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.04it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s]                                              {'loss': 0.8768, 'grad_norm': 12.269326210021973, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s]                                               {'loss': 1.3333, 'grad_norm': 10.18152141571045, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s]                                               {'loss': 0.9626, 'grad_norm': 7.666626453399658, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.38it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 0.7828, 'grad_norm': 6.228351593017578, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.2596, 'grad_norm': 7.478862285614014, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 0.6943, 'grad_norm': 4.914662837982178, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.515, 'grad_norm': 4.627777576446533, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.14it/s]                                               {'loss': 0.0503, 'grad_norm': 8.683005332946777, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s]                                               {'loss': 0.154, 'grad_norm': 2.428093910217285, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.86it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.2959, 'grad_norm': 1.4002052545547485, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.61it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s]                                               {'loss': 0.9515, 'grad_norm': 5.571615695953369, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.45it/s] 50%|█████     | 20/40 [00:06<00:06,  3.33it/s]                                               {'loss': 0.5744, 'grad_norm': 5.79343318939209, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.33it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.24it/s]                                               {'loss': 0.138, 'grad_norm': 3.239863157272339, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.24it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s]                                               {'loss': 0.1194, 'grad_norm': 2.032709836959839, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.17it/s] 57%|█████▊    | 23/40 [00:06<00:05,  3.15it/s]                                               {'loss': 1.0311, 'grad_norm': 3.201704740524292, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:06<00:05,  3.15it/s]                                               {'loss': 0.0074, 'grad_norm': 0.38091254234313965, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.15it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s]                                               {'loss': 0.1133, 'grad_norm': 2.181917667388916, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.88it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s]                                               {'loss': 0.0543, 'grad_norm': 1.134132981300354, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.65it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.47it/s]                                               {'loss': 0.5239, 'grad_norm': 1.1863696575164795, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.47it/s] 70%|███████   | 28/40 [00:08<00:03,  3.35it/s]                                               {'loss': 0.3321, 'grad_norm': 1.5014652013778687, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.35it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.3503, 'grad_norm': 1.0697009563446045, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s]                                               {'loss': 0.0797, 'grad_norm': 1.1793105602264404, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.1793, 'grad_norm': 4.2133307456970215, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.0937, 'grad_norm': 5.9459452629089355, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.76it/s]                                               {'loss': 0.4452, 'grad_norm': 2.062889337539673, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.76it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s]                                               {'loss': 0.0984, 'grad_norm': 2.298948287963867, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.52it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s]                                               {'loss': 0.2494, 'grad_norm': 3.100968599319458, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.38it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.0313, 'grad_norm': 0.9949051141738892, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s]                                               {'loss': 0.0704, 'grad_norm': 1.399837613105774, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.22it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.219, 'grad_norm': 0.5183376669883728, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.18it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.1675, 'grad_norm': 4.506629467010498, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.2045, 'grad_norm': 10.689513206481934, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]                                               {'train_runtime': 11.9975, 'train_samples_per_second': 47.093, 'train_steps_per_second': 3.334, 'train_loss': 0.9924947203835472, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.13it/s]100%|██████████| 40/40 [00:11<00:00,  3.33it/s]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 3.6575, 'grad_norm': 7.078134536743164, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]                                              {'loss': 3.1497, 'grad_norm': 10.255061149597168, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.04it/s]  8%|▊         | 3/40 [00:00<00:12,  3.06it/s]                                              {'loss': 2.7892, 'grad_norm': 9.17502498626709, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.06it/s] 10%|█         | 4/40 [00:01<00:11,  3.04it/s]                                              {'loss': 3.3993, 'grad_norm': 17.366086959838867, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.04it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s]                                              {'loss': 2.0822, 'grad_norm': 13.06847095489502, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.03it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 1.9955, 'grad_norm': 13.962037086486816, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 1.5321, 'grad_norm': 13.477619171142578, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.03it/s]                                              {'loss': 2.939, 'grad_norm': 62.576393127441406, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.03it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s]                                              {'loss': 1.1784, 'grad_norm': 10.171679496765137, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s]                                               {'loss': 1.1425, 'grad_norm': 9.270529747009277, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.56it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s]                                               {'loss': 0.8375, 'grad_norm': 8.935396194458008, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s] 30%|███       | 12/40 [00:03<00:08,  3.26it/s]                                               {'loss': 1.2373, 'grad_norm': 9.030732154846191, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.26it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s]                                               {'loss': 0.5116, 'grad_norm': 6.164061546325684, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.18it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s]                                               {'loss': 0.2064, 'grad_norm': 1.4875566959381104, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.17it/s] 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 0.9797, 'grad_norm': 5.701688289642334, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:07,  3.13it/s]                                               {'loss': 4.2141, 'grad_norm': 61.626670837402344, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.13it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s]                                               {'loss': 0.1182, 'grad_norm': 2.2272284030914307, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.84it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s]                                               {'loss': 0.5119, 'grad_norm': 2.5829579830169678, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.34it/s]                                               {'loss': 0.3416, 'grad_norm': 6.12923526763916, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.34it/s] 50%|█████     | 20/40 [00:06<00:06,  3.23it/s]                                               {'loss': 0.8555, 'grad_norm': 2.8247599601745605, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.23it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.2556, 'grad_norm': 4.088031768798828, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s]                                               {'loss': 0.136, 'grad_norm': 2.406311273574829, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.13it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.499, 'grad_norm': 4.0917158126831055, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 1.1822, 'grad_norm': 29.478008270263672, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s]                                               {'loss': 0.3452, 'grad_norm': 2.9143753051757812, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s]                                               {'loss': 0.1599, 'grad_norm': 2.744624137878418, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s]                                               {'loss': 0.1247, 'grad_norm': 2.5766348838806152, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.45it/s] 70%|███████   | 28/40 [00:08<00:03,  3.32it/s]                                               {'loss': 0.0944, 'grad_norm': 3.480346918106079, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.32it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s]                                               {'loss': 0.2418, 'grad_norm': 3.2294633388519287, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.25it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s]                                               {'loss': 0.5503, 'grad_norm': 3.805598497390747, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.18it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.264, 'grad_norm': 1.711288332939148, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.14it/s]                                               {'loss': 0.0477, 'grad_norm': 2.946377992630005, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.0784, 'grad_norm': 2.0074048042297363, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s]                                               {'loss': 0.077, 'grad_norm': 1.5273500680923462, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.58it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s]                                               {'loss': 0.4601, 'grad_norm': 2.263967752456665, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.42it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s]                                               {'loss': 0.1526, 'grad_norm': 3.148056983947754, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.30it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s]                                               {'loss': 0.3987, 'grad_norm': 2.598173141479492, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.19it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.1436, 'grad_norm': 1.4919589757919312, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.11it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.2077, 'grad_norm': 1.0365978479385376, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.08it/s]                                               {'loss': 0.0078, 'grad_norm': 0.6869329214096069, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.08it/s]                                               {'train_runtime': 12.0868, 'train_samples_per_second': 46.745, 'train_steps_per_second': 3.309, 'train_loss': 0.9776514488621615, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.08it/s]100%|██████████| 40/40 [00:12<00:00,  3.31it/s]
CLIENT:95
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]                                              {'loss': 5.7705, 'grad_norm': 7.34446382522583, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.01it/s]  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]                                              {'loss': 4.2631, 'grad_norm': 8.98028564453125, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.01it/s]  8%|▊         | 3/40 [00:00<00:12,  3.01it/s]                                              {'loss': 4.0281, 'grad_norm': 11.141677856445312, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.01it/s] 10%|█         | 4/40 [00:01<00:11,  3.03it/s]                                              {'loss': 3.1243, 'grad_norm': 13.781204223632812, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.03it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s]                                              {'loss': 1.309, 'grad_norm': 9.36240005493164, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.02it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.6174, 'grad_norm': 18.25814437866211, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 2.1513, 'grad_norm': 20.799083709716797, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 6.138, 'grad_norm': 80.91756439208984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.02it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.84it/s]                                              {'loss': 1.5907, 'grad_norm': 14.517220497131348, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.84it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s]                                               {'loss': 0.9836, 'grad_norm': 8.890689849853516, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.58it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s]                                               {'loss': 1.3459, 'grad_norm': 10.25886344909668, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.40it/s] 30%|███       | 12/40 [00:03<00:08,  3.28it/s]                                               {'loss': 0.8631, 'grad_norm': 10.90754222869873, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.28it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s]                                               {'loss': 1.3226, 'grad_norm': 8.74465560913086, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.19it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.81, 'grad_norm': 7.853260517120361, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.12it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 0.9927, 'grad_norm': 6.549416542053223, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 0.6763, 'grad_norm': 24.23268699645996, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.09it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s]                                               {'loss': 0.4317, 'grad_norm': 5.081595420837402, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.82it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s]                                               {'loss': 0.6319, 'grad_norm': 5.722494602203369, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.56it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 0.2848, 'grad_norm': 2.9167115688323975, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 0.8827, 'grad_norm': 8.528907775878906, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.17it/s]                                               {'loss': 0.382, 'grad_norm': 3.9150502681732178, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.17it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s]                                               {'loss': 0.4264, 'grad_norm': 7.890993118286133, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.3697, 'grad_norm': 3.621922492980957, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 1.0363, 'grad_norm': 13.514681816101074, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s]                                               {'loss': 0.1101, 'grad_norm': 1.8937605619430542, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s]                                               {'loss': 0.3277, 'grad_norm': 4.144649028778076, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s]                                               {'loss': 0.0953, 'grad_norm': 1.448464035987854, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.44it/s] 70%|███████   | 28/40 [00:08<00:03,  3.31it/s]                                               {'loss': 0.0837, 'grad_norm': 1.9551039934158325, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.31it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.1985, 'grad_norm': 4.274300575256348, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s]                                               {'loss': 0.1103, 'grad_norm': 2.9100914001464844, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.15it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.4772, 'grad_norm': 3.480743408203125, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.10it/s]                                               {'loss': 0.0655, 'grad_norm': 2.299851179122925, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.10it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s]                                               {'loss': 0.0659, 'grad_norm': 2.0843887329101562, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.86it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.203, 'grad_norm': 5.125853061676025, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s]                                               {'loss': 0.0478, 'grad_norm': 1.0870683193206787, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.26it/s]                                               {'loss': 0.0214, 'grad_norm': 0.32609134912490845, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.26it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s]                                               {'loss': 0.2673, 'grad_norm': 0.7470458745956421, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s]                                               {'loss': 0.153, 'grad_norm': 2.1841788291931152, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.13it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.1051, 'grad_norm': 2.8626739978790283, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.11it/s]                                               {'loss': 0.0881, 'grad_norm': 5.319919586181641, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.11it/s]                                               {'train_runtime': 12.1261, 'train_samples_per_second': 46.594, 'train_steps_per_second': 3.299, 'train_loss': 1.1463018892332912, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.11it/s]100%|██████████| 40/40 [00:12<00:00,  3.30it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:42, 10.98it/s]  1%|          | 4/471 [00:00<01:07,  6.91it/s]  1%|          | 5/471 [00:00<01:12,  6.39it/s]  1%|▏         | 6/471 [00:00<01:16,  6.06it/s]  1%|▏         | 7/471 [00:01<01:19,  5.82it/s]  2%|▏         | 8/471 [00:01<01:21,  5.71it/s]  2%|▏         | 9/471 [00:01<01:22,  5.63it/s]  2%|▏         | 10/471 [00:01<01:22,  5.59it/s]  2%|▏         | 11/471 [00:01<01:22,  5.56it/s]  3%|▎         | 12/471 [00:02<01:23,  5.52it/s]  3%|▎         | 13/471 [00:02<01:23,  5.47it/s]  3%|▎         | 14/471 [00:02<01:23,  5.46it/s]  3%|▎         | 15/471 [00:02<01:23,  5.46it/s]  3%|▎         | 16/471 [00:02<01:23,  5.46it/s]  4%|▎         | 17/471 [00:02<01:22,  5.47it/s]  4%|▍         | 18/471 [00:03<01:23,  5.44it/s]  4%|▍         | 19/471 [00:03<01:22,  5.45it/s]  4%|▍         | 20/471 [00:03<01:22,  5.44it/s]  4%|▍         | 21/471 [00:03<01:22,  5.44it/s]  5%|▍         | 22/471 [00:03<01:22,  5.44it/s]  5%|▍         | 23/471 [00:04<01:22,  5.43it/s]  5%|▌         | 24/471 [00:04<01:22,  5.43it/s]  5%|▌         | 25/471 [00:04<01:22,  5.43it/s]  6%|▌         | 26/471 [00:04<01:21,  5.44it/s]  6%|▌         | 27/471 [00:04<01:21,  5.43it/s]  6%|▌         | 28/471 [00:04<01:21,  5.42it/s]  6%|▌         | 29/471 [00:05<01:21,  5.44it/s]  6%|▋         | 30/471 [00:05<01:21,  5.41it/s]  7%|▋         | 31/471 [00:05<01:21,  5.42it/s]  7%|▋         | 32/471 [00:05<01:20,  5.42it/s]  7%|▋         | 33/471 [00:05<01:20,  5.46it/s]  7%|▋         | 34/471 [00:06<01:19,  5.48it/s]  7%|▋         | 35/471 [00:06<01:19,  5.47it/s]  8%|▊         | 36/471 [00:06<01:19,  5.46it/s]  8%|▊         | 37/471 [00:06<01:19,  5.44it/s]  8%|▊         | 38/471 [00:06<01:19,  5.41it/s]  8%|▊         | 39/471 [00:06<01:19,  5.43it/s]  8%|▊         | 40/471 [00:07<01:19,  5.43it/s]  9%|▊         | 41/471 [00:07<01:19,  5.43it/s]  9%|▉         | 42/471 [00:07<01:19,  5.43it/s]  9%|▉         | 43/471 [00:07<01:19,  5.42it/s]  9%|▉         | 44/471 [00:07<01:18,  5.43it/s] 10%|▉         | 45/471 [00:08<01:18,  5.42it/s] 10%|▉         | 46/471 [00:08<01:18,  5.43it/s] 10%|▉         | 47/471 [00:08<01:17,  5.44it/s] 10%|█         | 48/471 [00:08<01:17,  5.44it/s] 10%|█         | 49/471 [00:08<01:17,  5.44it/s] 11%|█         | 50/471 [00:09<01:17,  5.42it/s] 11%|█         | 51/471 [00:09<01:17,  5.43it/s] 11%|█         | 52/471 [00:09<01:17,  5.43it/s] 11%|█▏        | 53/471 [00:09<01:17,  5.41it/s] 11%|█▏        | 54/471 [00:09<01:17,  5.41it/s] 12%|█▏        | 55/471 [00:09<01:16,  5.42it/s] 12%|█▏        | 56/471 [00:10<01:16,  5.40it/s] 12%|█▏        | 57/471 [00:10<01:16,  5.43it/s] 12%|█▏        | 58/471 [00:10<01:15,  5.44it/s] 13%|█▎        | 59/471 [00:10<01:16,  5.41it/s] 13%|█▎        | 60/471 [00:10<01:15,  5.43it/s] 13%|█▎        | 61/471 [00:11<01:15,  5.42it/s] 13%|█▎        | 62/471 [00:11<01:15,  5.42it/s] 13%|█▎        | 63/471 [00:11<01:15,  5.42it/s] 14%|█▎        | 64/471 [00:11<01:15,  5.42it/s] 14%|█▍        | 65/471 [00:11<01:14,  5.41it/s] 14%|█▍        | 66/471 [00:11<01:14,  5.41it/s] 14%|█▍        | 67/471 [00:12<01:14,  5.41it/s] 14%|█▍        | 68/471 [00:12<01:14,  5.42it/s] 15%|█▍        | 69/471 [00:12<01:14,  5.42it/s] 15%|█▍        | 70/471 [00:12<01:14,  5.41it/s] 15%|█▌        | 71/471 [00:12<01:14,  5.40it/s] 15%|█▌        | 72/471 [00:13<01:13,  5.41it/s] 15%|█▌        | 73/471 [00:13<01:13,  5.40it/s] 16%|█▌        | 74/471 [00:13<01:13,  5.42it/s] 16%|█▌        | 75/471 [00:13<01:13,  5.41it/s] 16%|█▌        | 76/471 [00:13<01:13,  5.40it/s] 16%|█▋        | 77/471 [00:13<01:12,  5.41it/s] 17%|█▋        | 78/471 [00:14<01:12,  5.41it/s] 17%|█▋        | 79/471 [00:14<01:12,  5.39it/s] 17%|█▋        | 80/471 [00:14<01:12,  5.39it/s] 17%|█▋        | 81/471 [00:14<01:12,  5.39it/s] 17%|█▋        | 82/471 [00:14<01:11,  5.41it/s] 18%|█▊        | 83/471 [00:15<01:11,  5.40it/s] 18%|█▊        | 84/471 [00:15<01:11,  5.41it/s] 18%|█▊        | 85/471 [00:15<01:11,  5.39it/s] 18%|█▊        | 86/471 [00:15<01:11,  5.39it/s] 18%|█▊        | 87/471 [00:15<01:11,  5.40it/s] 19%|█▊        | 88/471 [00:16<01:10,  5.41it/s] 19%|█▉        | 89/471 [00:16<01:10,  5.41it/s] 19%|█▉        | 90/471 [00:16<01:10,  5.39it/s] 19%|█▉        | 91/471 [00:16<01:10,  5.40it/s] 20%|█▉        | 92/471 [00:16<01:10,  5.40it/s] 20%|█▉        | 93/471 [00:16<01:10,  5.39it/s] 20%|█▉        | 94/471 [00:17<01:09,  5.41it/s] 20%|██        | 95/471 [00:17<01:09,  5.41it/s] 20%|██        | 96/471 [00:17<01:09,  5.41it/s] 21%|██        | 97/471 [00:17<01:09,  5.40it/s] 21%|██        | 98/471 [00:17<01:09,  5.40it/s] 21%|██        | 99/471 [00:18<01:08,  5.42it/s] 21%|██        | 100/471 [00:18<01:08,  5.43it/s] 21%|██▏       | 101/471 [00:18<01:08,  5.42it/s] 22%|██▏       | 102/471 [00:18<01:08,  5.41it/s] 22%|██▏       | 103/471 [00:18<01:08,  5.39it/s] 22%|██▏       | 104/471 [00:18<01:08,  5.38it/s] 22%|██▏       | 105/471 [00:19<01:07,  5.38it/s] 23%|██▎       | 106/471 [00:19<01:07,  5.41it/s] 23%|██▎       | 107/471 [00:19<01:07,  5.43it/s] 23%|██▎       | 108/471 [00:19<01:06,  5.43it/s] 23%|██▎       | 109/471 [00:19<01:06,  5.41it/s] 23%|██▎       | 110/471 [00:20<01:06,  5.44it/s] 24%|██▎       | 111/471 [00:20<01:06,  5.41it/s] 24%|██▍       | 112/471 [00:20<01:06,  5.41it/s] 24%|██▍       | 113/471 [00:20<01:05,  5.43it/s] 24%|██▍       | 114/471 [00:20<01:05,  5.42it/s] 24%|██▍       | 115/471 [00:21<01:05,  5.42it/s] 25%|██▍       | 116/471 [00:21<01:05,  5.41it/s] 25%|██▍       | 117/471 [00:21<01:05,  5.40it/s] 25%|██▌       | 118/471 [00:21<01:05,  5.40it/s] 25%|██▌       | 119/471 [00:21<01:05,  5.39it/s] 25%|██▌       | 120/471 [00:21<01:05,  5.39it/s] 26%|██▌       | 121/471 [00:22<01:04,  5.39it/s] 26%|██▌       | 122/471 [00:22<01:04,  5.40it/s] 26%|██▌       | 123/471 [00:22<01:04,  5.40it/s] 26%|██▋       | 124/471 [00:22<01:04,  5.39it/s] 27%|██▋       | 125/471 [00:22<01:04,  5.39it/s] 27%|██▋       | 126/471 [00:23<01:04,  5.38it/s] 27%|██▋       | 127/471 [00:23<01:03,  5.39it/s] 27%|██▋       | 128/471 [00:23<01:03,  5.38it/s] 27%|██▋       | 129/471 [00:23<01:03,  5.39it/s] 28%|██▊       | 130/471 [00:23<01:03,  5.38it/s] 28%|██▊       | 131/471 [00:23<01:03,  5.38it/s] 28%|██▊       | 132/471 [00:24<01:02,  5.38it/s] 28%|██▊       | 133/471 [00:24<01:02,  5.37it/s] 28%|██▊       | 134/471 [00:24<01:03,  5.35it/s] 29%|██▊       | 135/471 [00:24<01:02,  5.36it/s] 29%|██▉       | 136/471 [00:24<01:02,  5.36it/s] 29%|██▉       | 137/471 [00:25<01:02,  5.36it/s] 29%|██▉       | 138/471 [00:25<01:02,  5.36it/s] 30%|██▉       | 139/471 [00:25<01:01,  5.37it/s] 30%|██▉       | 140/471 [00:25<01:01,  5.37it/s] 30%|██▉       | 141/471 [00:25<01:01,  5.39it/s] 30%|███       | 142/471 [00:26<01:01,  5.38it/s] 30%|███       | 143/471 [00:26<01:00,  5.39it/s] 31%|███       | 144/471 [00:26<01:01,  5.36it/s] 31%|███       | 145/471 [00:26<01:00,  5.39it/s] 31%|███       | 146/471 [00:26<01:00,  5.38it/s] 31%|███       | 147/471 [00:26<01:00,  5.37it/s] 31%|███▏      | 148/471 [00:27<00:59,  5.39it/s] 32%|███▏      | 149/471 [00:27<01:00,  5.35it/s] 32%|███▏      | 150/471 [00:27<01:00,  5.35it/s] 32%|███▏      | 151/471 [00:27<00:59,  5.35it/s] 32%|███▏      | 152/471 [00:27<00:59,  5.35it/s] 32%|███▏      | 153/471 [00:28<00:59,  5.35it/s] 33%|███▎      | 154/471 [00:28<00:58,  5.39it/s] 33%|███▎      | 155/471 [00:28<00:58,  5.38it/s] 33%|███▎      | 156/471 [00:28<00:58,  5.38it/s] 33%|███▎      | 157/471 [00:28<00:58,  5.38it/s] 34%|███▎      | 158/471 [00:29<00:57,  5.41it/s] 34%|███▍      | 159/471 [00:29<00:57,  5.41it/s] 34%|███▍      | 160/471 [00:29<00:57,  5.40it/s] 34%|███▍      | 161/471 [00:29<00:57,  5.38it/s] 34%|███▍      | 162/471 [00:29<00:57,  5.37it/s] 35%|███▍      | 163/471 [00:29<00:57,  5.37it/s] 35%|███▍      | 164/471 [00:30<00:57,  5.38it/s] 35%|███▌      | 165/471 [00:30<00:56,  5.37it/s] 35%|███▌      | 166/471 [00:30<00:56,  5.37it/s] 35%|███▌      | 167/471 [00:30<00:56,  5.36it/s] 36%|███▌      | 168/471 [00:30<00:56,  5.36it/s] 36%|███▌      | 169/471 [00:31<00:56,  5.35it/s] 36%|███▌      | 170/471 [00:31<00:56,  5.36it/s] 36%|███▋      | 171/471 [00:31<00:55,  5.36it/s] 37%|███▋      | 172/471 [00:31<00:55,  5.38it/s] 37%|███▋      | 173/471 [00:31<00:55,  5.36it/s] 37%|███▋      | 174/471 [00:32<00:55,  5.36it/s] 37%|███▋      | 175/471 [00:32<00:55,  5.36it/s] 37%|███▋      | 176/471 [00:32<00:55,  5.36it/s] 38%|███▊      | 177/471 [00:32<00:54,  5.35it/s] 38%|███▊      | 178/471 [00:32<00:54,  5.36it/s] 38%|███▊      | 179/471 [00:32<00:54,  5.37it/s] 38%|███▊      | 180/471 [00:33<00:54,  5.36it/s] 38%|███▊      | 181/471 [00:33<00:54,  5.36it/s] 39%|███▊      | 182/471 [00:33<00:54,  5.35it/s] 39%|███▉      | 183/471 [00:33<00:53,  5.35it/s] 39%|███▉      | 184/471 [00:33<00:53,  5.38it/s] 39%|███▉      | 185/471 [00:34<00:53,  5.36it/s] 39%|███▉      | 186/471 [00:34<00:53,  5.35it/s] 40%|███▉      | 187/471 [00:34<00:53,  5.35it/s] 40%|███▉      | 188/471 [00:34<00:53,  5.34it/s] 40%|████      | 189/471 [00:34<00:52,  5.34it/s] 40%|████      | 190/471 [00:34<00:52,  5.35it/s] 41%|████      | 191/471 [00:35<00:52,  5.34it/s] 41%|████      | 192/471 [00:35<00:52,  5.34it/s] 41%|████      | 193/471 [00:35<00:51,  5.35it/s] 41%|████      | 194/471 [00:35<00:51,  5.36it/s] 41%|████▏     | 195/471 [00:35<00:51,  5.35it/s] 42%|████▏     | 196/471 [00:36<00:51,  5.34it/s] 42%|████▏     | 197/471 [00:36<00:50,  5.38it/s] 42%|████▏     | 198/471 [00:36<00:50,  5.36it/s] 42%|████▏     | 199/471 [00:36<00:50,  5.35it/s] 42%|████▏     | 200/471 [00:36<00:50,  5.37it/s] 43%|████▎     | 201/471 [00:37<00:50,  5.38it/s] 43%|████▎     | 202/471 [00:37<00:50,  5.37it/s] 43%|████▎     | 203/471 [00:37<00:50,  5.36it/s] 43%|████▎     | 204/471 [00:37<00:49,  5.34it/s] 44%|████▎     | 205/471 [00:37<00:49,  5.35it/s] 44%|████▎     | 206/471 [00:37<00:49,  5.35it/s] 44%|████▍     | 207/471 [00:38<00:49,  5.34it/s] 44%|████▍     | 208/471 [00:38<00:49,  5.36it/s] 44%|████▍     | 209/471 [00:38<00:48,  5.38it/s] 45%|████▍     | 210/471 [00:38<00:48,  5.39it/s] 45%|████▍     | 211/471 [00:38<00:48,  5.38it/s] 45%|████▌     | 212/471 [00:39<00:48,  5.36it/s] 45%|████▌     | 213/471 [00:39<00:48,  5.35it/s] 45%|████▌     | 214/471 [00:39<00:47,  5.36it/s] 46%|████▌     | 215/471 [00:39<00:47,  5.37it/s] 46%|████▌     | 216/471 [00:39<00:47,  5.36it/s] 46%|████▌     | 217/471 [00:40<00:47,  5.36it/s] 46%|████▋     | 218/471 [00:40<00:47,  5.34it/s] 46%|████▋     | 219/471 [00:40<00:47,  5.34it/s] 47%|████▋     | 220/471 [00:40<00:47,  5.34it/s] 47%|████▋     | 221/471 [00:40<00:46,  5.34it/s] 47%|████▋     | 222/471 [00:40<00:46,  5.36it/s] 47%|████▋     | 223/471 [00:41<00:46,  5.36it/s] 48%|████▊     | 224/471 [00:41<00:46,  5.37it/s] 48%|████▊     | 225/471 [00:41<00:45,  5.35it/s] 48%|████▊     | 226/471 [00:41<00:45,  5.35it/s] 48%|████▊     | 227/471 [00:41<00:45,  5.35it/s] 48%|████▊     | 228/471 [00:42<00:45,  5.35it/s] 49%|████▊     | 229/471 [00:42<00:45,  5.34it/s] 49%|████▉     | 230/471 [00:42<00:45,  5.34it/s] 49%|████▉     | 231/471 [00:42<00:44,  5.36it/s] 49%|████▉     | 232/471 [00:42<00:44,  5.37it/s] 49%|████▉     | 233/471 [00:43<00:44,  5.38it/s] 50%|████▉     | 234/471 [00:43<00:44,  5.36it/s] 50%|████▉     | 235/471 [00:43<00:44,  5.34it/s] 50%|█████     | 236/471 [00:43<00:43,  5.35it/s] 50%|█████     | 237/471 [00:43<00:43,  5.36it/s] 51%|█████     | 238/471 [00:43<00:43,  5.35it/s] 51%|█████     | 239/471 [00:44<00:43,  5.37it/s] 51%|█████     | 240/471 [00:44<00:43,  5.35it/s] 51%|█████     | 241/471 [00:44<00:43,  5.33it/s] 51%|█████▏    | 242/471 [00:44<00:42,  5.35it/s] 52%|█████▏    | 243/471 [00:44<00:42,  5.38it/s] 52%|█████▏    | 244/471 [00:45<00:42,  5.36it/s] 52%|█████▏    | 245/471 [00:45<00:42,  5.36it/s] 52%|█████▏    | 246/471 [00:45<00:41,  5.37it/s] 52%|█████▏    | 247/471 [00:45<00:41,  5.38it/s] 53%|█████▎    | 248/471 [00:45<00:41,  5.38it/s] 53%|█████▎    | 249/471 [00:46<00:41,  5.36it/s] 53%|█████▎    | 250/471 [00:46<00:41,  5.35it/s] 53%|█████▎    | 251/471 [00:46<00:41,  5.36it/s] 54%|█████▎    | 252/471 [00:46<00:40,  5.35it/s] 54%|█████▎    | 253/471 [00:46<00:40,  5.33it/s] 54%|█████▍    | 254/471 [00:46<00:40,  5.34it/s] 54%|█████▍    | 255/471 [00:47<00:40,  5.36it/s] 54%|█████▍    | 256/471 [00:47<00:40,  5.35it/s] 55%|█████▍    | 257/471 [00:47<00:40,  5.33it/s] 55%|█████▍    | 258/471 [00:47<00:39,  5.34it/s] 55%|█████▍    | 259/471 [00:47<00:39,  5.35it/s] 55%|█████▌    | 260/471 [00:48<00:39,  5.34it/s] 55%|█████▌    | 261/471 [00:48<00:39,  5.35it/s] 56%|█████▌    | 262/471 [00:48<00:38,  5.37it/s] 56%|█████▌    | 263/471 [00:48<00:38,  5.34it/s] 56%|█████▌    | 264/471 [00:48<00:38,  5.33it/s] 56%|█████▋    | 265/471 [00:49<00:38,  5.33it/s] 56%|█████▋    | 266/471 [00:49<00:38,  5.33it/s] 57%|█████▋    | 267/471 [00:49<00:38,  5.33it/s] 57%|█████▋    | 268/471 [00:49<00:38,  5.33it/s] 57%|█████▋    | 269/471 [00:49<00:37,  5.33it/s] 57%|█████▋    | 270/471 [00:49<00:37,  5.43it/s] 58%|█████▊    | 271/471 [00:50<00:37,  5.39it/s] 58%|█████▊    | 272/471 [00:50<00:37,  5.37it/s] 58%|█████▊    | 273/471 [00:50<00:36,  5.36it/s] 58%|█████▊    | 274/471 [00:50<00:36,  5.38it/s] 58%|█████▊    | 275/471 [00:50<00:36,  5.37it/s] 59%|█████▊    | 276/471 [00:51<00:36,  5.37it/s] 59%|█████▉    | 277/471 [00:51<00:36,  5.37it/s] 59%|█████▉    | 278/471 [00:51<00:36,  5.35it/s] 59%|█████▉    | 279/471 [00:51<00:35,  5.34it/s] 59%|█████▉    | 280/471 [00:51<00:35,  5.34it/s] 60%|█████▉    | 281/471 [00:51<00:35,  5.34it/s] 60%|█████▉    | 282/471 [00:52<00:35,  5.34it/s] 60%|██████    | 283/471 [00:52<00:35,  5.33it/s] 60%|██████    | 284/471 [00:52<00:35,  5.32it/s] 61%|██████    | 285/471 [00:52<00:34,  5.33it/s] 61%|██████    | 286/471 [00:52<00:34,  5.34it/s] 61%|██████    | 287/471 [00:53<00:34,  5.33it/s] 61%|██████    | 288/471 [00:53<00:34,  5.32it/s] 61%|██████▏   | 289/471 [00:53<00:34,  5.35it/s] 62%|██████▏   | 290/471 [00:53<00:33,  5.35it/s] 62%|██████▏   | 291/471 [00:53<00:33,  5.34it/s] 62%|██████▏   | 292/471 [00:54<00:33,  5.35it/s] 62%|██████▏   | 293/471 [00:54<00:33,  5.37it/s] 62%|██████▏   | 294/471 [00:54<00:33,  5.36it/s] 63%|██████▎   | 295/471 [00:54<00:32,  5.37it/s] 63%|██████▎   | 296/471 [00:54<00:32,  5.37it/s] 63%|██████▎   | 297/471 [00:54<00:32,  5.38it/s] 63%|██████▎   | 298/471 [00:55<00:32,  5.36it/s] 63%|██████▎   | 299/471 [00:55<00:32,  5.35it/s] 64%|██████▎   | 300/471 [00:55<00:31,  5.35it/s] 64%|██████▍   | 301/471 [00:55<00:31,  5.36it/s] 64%|██████▍   | 302/471 [00:55<00:31,  5.35it/s] 64%|██████▍   | 303/471 [00:56<00:31,  5.34it/s] 65%|██████▍   | 304/471 [00:56<00:31,  5.34it/s] 65%|██████▍   | 305/471 [00:56<00:31,  5.35it/s] 65%|██████▍   | 306/471 [00:56<00:30,  5.34it/s] 65%|██████▌   | 307/471 [00:56<00:30,  5.33it/s] 65%|██████▌   | 308/471 [00:57<00:30,  5.32it/s] 66%|██████▌   | 309/471 [00:57<00:30,  5.33it/s] 66%|██████▌   | 310/471 [00:57<00:30,  5.34it/s] 66%|██████▌   | 311/471 [00:57<00:29,  5.34it/s] 66%|██████▌   | 312/471 [00:57<00:29,  5.35it/s] 66%|██████▋   | 313/471 [00:57<00:29,  5.36it/s] 67%|██████▋   | 314/471 [00:58<00:29,  5.34it/s] 67%|██████▋   | 315/471 [00:58<00:29,  5.34it/s] 67%|██████▋   | 316/471 [00:58<00:28,  5.37it/s] 67%|██████▋   | 317/471 [00:58<00:28,  5.37it/s] 68%|██████▊   | 318/471 [00:58<00:28,  5.36it/s] 68%|██████▊   | 319/471 [00:59<00:28,  5.34it/s] 68%|██████▊   | 320/471 [00:59<00:28,  5.32it/s] 68%|██████▊   | 321/471 [00:59<00:28,  5.31it/s] 68%|██████▊   | 322/471 [00:59<00:28,  5.32it/s] 69%|██████▊   | 323/471 [00:59<00:27,  5.31it/s] 69%|██████▉   | 324/471 [01:00<00:27,  5.31it/s] 69%|██████▉   | 325/471 [01:00<00:27,  5.33it/s] 69%|██████▉   | 326/471 [01:00<00:27,  5.32it/s] 69%|██████▉   | 327/471 [01:00<00:27,  5.33it/s] 70%|██████▉   | 328/471 [01:00<00:26,  5.33it/s] 70%|██████▉   | 329/471 [01:00<00:26,  5.34it/s] 70%|███████   | 330/471 [01:01<00:26,  5.35it/s] 70%|███████   | 331/471 [01:01<00:26,  5.35it/s] 70%|███████   | 332/471 [01:01<00:26,  5.33it/s] 71%|███████   | 333/471 [01:01<00:25,  5.34it/s] 71%|███████   | 334/471 [01:01<00:25,  5.33it/s] 71%|███████   | 335/471 [01:02<00:25,  5.33it/s] 71%|███████▏  | 336/471 [01:02<00:25,  5.34it/s] 72%|███████▏  | 337/471 [01:02<00:24,  5.36it/s] 72%|███████▏  | 338/471 [01:02<00:24,  5.35it/s] 72%|███████▏  | 339/471 [01:02<00:24,  5.34it/s] 72%|███████▏  | 340/471 [01:03<00:24,  5.35it/s] 72%|███████▏  | 341/471 [01:03<00:24,  5.34it/s] 73%|███████▎  | 342/471 [01:03<00:24,  5.35it/s] 73%|███████▎  | 343/471 [01:03<00:23,  5.34it/s] 73%|███████▎  | 344/471 [01:03<00:23,  5.35it/s] 73%|███████▎  | 345/471 [01:03<00:23,  5.34it/s] 73%|███████▎  | 346/471 [01:04<00:23,  5.33it/s] 74%|███████▎  | 347/471 [01:04<00:23,  5.36it/s] 74%|███████▍  | 348/471 [01:04<00:23,  5.34it/s] 74%|███████▍  | 349/471 [01:04<00:22,  5.34it/s] 74%|███████▍  | 350/471 [01:04<00:22,  5.34it/s] 75%|███████▍  | 351/471 [01:05<00:22,  5.36it/s] 75%|███████▍  | 352/471 [01:05<00:22,  5.35it/s] 75%|███████▍  | 353/471 [01:05<00:22,  5.34it/s] 75%|███████▌  | 354/471 [01:05<00:21,  5.34it/s] 75%|███████▌  | 355/471 [01:05<00:21,  5.33it/s] 76%|███████▌  | 356/471 [01:06<00:21,  5.32it/s] 76%|███████▌  | 357/471 [01:06<00:21,  5.33it/s] 76%|███████▌  | 358/471 [01:06<00:21,  5.35it/s] 76%|███████▌  | 359/471 [01:06<00:20,  5.34it/s] 76%|███████▋  | 360/471 [01:06<00:20,  5.33it/s] 77%|███████▋  | 361/471 [01:06<00:20,  5.34it/s] 77%|███████▋  | 362/471 [01:07<00:20,  5.34it/s] 77%|███████▋  | 363/471 [01:07<00:20,  5.35it/s] 77%|███████▋  | 364/471 [01:07<00:19,  5.36it/s] 77%|███████▋  | 365/471 [01:07<00:19,  5.35it/s] 78%|███████▊  | 366/471 [01:07<00:19,  5.33it/s] 78%|███████▊  | 367/471 [01:08<00:19,  5.32it/s] 78%|███████▊  | 368/471 [01:08<00:19,  5.33it/s] 78%|███████▊  | 369/471 [01:08<00:19,  5.36it/s] 79%|███████▊  | 370/471 [01:08<00:18,  5.34it/s] 79%|███████▉  | 371/471 [01:08<00:18,  5.33it/s] 79%|███████▉  | 372/471 [01:09<00:18,  5.33it/s] 79%|███████▉  | 373/471 [01:09<00:18,  5.33it/s] 79%|███████▉  | 374/471 [01:09<00:18,  5.34it/s] 80%|███████▉  | 375/471 [01:09<00:17,  5.34it/s] 80%|███████▉  | 376/471 [01:09<00:17,  5.34it/s] 80%|████████  | 377/471 [01:09<00:17,  5.35it/s] 80%|████████  | 378/471 [01:10<00:17,  5.35it/s] 80%|████████  | 379/471 [01:10<00:17,  5.34it/s] 81%|████████  | 380/471 [01:10<00:17,  5.34it/s] 81%|████████  | 381/471 [01:10<00:16,  5.35it/s] 81%|████████  | 382/471 [01:10<00:16,  5.34it/s] 81%|████████▏ | 383/471 [01:11<00:16,  5.33it/s] 82%|████████▏ | 384/471 [01:11<00:16,  5.32it/s] 82%|████████▏ | 385/471 [01:11<00:16,  5.31it/s] 82%|████████▏ | 386/471 [01:11<00:15,  5.32it/s] 82%|████████▏ | 387/471 [01:11<00:15,  5.32it/s] 82%|████████▏ | 388/471 [01:12<00:15,  5.31it/s] 83%|████████▎ | 389/471 [01:12<00:15,  5.33it/s] 83%|████████▎ | 390/471 [01:12<00:15,  5.33it/s] 83%|████████▎ | 391/471 [01:12<00:15,  5.32it/s] 83%|████████▎ | 392/471 [01:12<00:14,  5.32it/s] 83%|████████▎ | 393/471 [01:12<00:14,  5.33it/s] 84%|████████▎ | 394/471 [01:13<00:14,  5.33it/s] 84%|████████▍ | 395/471 [01:13<00:14,  5.33it/s] 84%|████████▍ | 396/471 [01:13<00:14,  5.32it/s] 84%|████████▍ | 397/471 [01:13<00:13,  5.33it/s] 85%|████████▍ | 398/471 [01:13<00:13,  5.33it/s] 85%|████████▍ | 399/471 [01:14<00:13,  5.32it/s] 85%|████████▍ | 400/471 [01:14<00:13,  5.32it/s] 85%|████████▌ | 401/471 [01:14<00:13,  5.32it/s] 85%|████████▌ | 402/471 [01:14<00:12,  5.32it/s] 86%|████████▌ | 403/471 [01:14<00:12,  5.32it/s] 86%|████████▌ | 404/471 [01:15<00:12,  5.33it/s] 86%|████████▌ | 405/471 [01:15<00:12,  5.32it/s] 86%|████████▌ | 406/471 [01:15<00:12,  5.33it/s] 86%|████████▋ | 407/471 [01:15<00:11,  5.35it/s] 87%|████████▋ | 408/471 [01:15<00:11,  5.33it/s] 87%|████████▋ | 409/471 [01:15<00:11,  5.33it/s] 87%|████████▋ | 410/471 [01:16<00:11,  5.33it/s] 87%|████████▋ | 411/471 [01:16<00:11,  5.35it/s] 87%|████████▋ | 412/471 [01:16<00:11,  5.34it/s] 88%|████████▊ | 413/471 [01:16<00:10,  5.34it/s] 88%|████████▊ | 414/471 [01:16<00:10,  5.34it/s] 88%|████████▊ | 415/471 [01:17<00:10,  5.35it/s] 88%|████████▊ | 416/471 [01:17<00:10,  5.33it/s] 89%|████████▊ | 417/471 [01:17<00:10,  5.33it/s] 89%|████████▊ | 418/471 [01:17<00:09,  5.33it/s] 89%|████████▉ | 419/471 [01:17<00:09,  5.36it/s] 89%|████████▉ | 420/471 [01:18<00:09,  5.37it/s] 89%|████████▉ | 421/471 [01:18<00:09,  5.36it/s] 90%|████████▉ | 422/471 [01:18<00:09,  5.36it/s] 90%|████████▉ | 423/471 [01:18<00:08,  5.36it/s] 90%|█████████ | 424/471 [01:18<00:08,  5.36it/s] 90%|█████████ | 425/471 [01:18<00:08,  5.36it/s] 90%|█████████ | 426/471 [01:19<00:08,  5.34it/s] 91%|█████████ | 427/471 [01:19<00:08,  5.33it/s] 91%|█████████ | 428/471 [01:19<00:08,  5.33it/s] 91%|█████████ | 429/471 [01:19<00:07,  5.34it/s] 91%|█████████▏| 430/471 [01:19<00:07,  5.33it/s] 92%|█████████▏| 431/471 [01:20<00:07,  5.31it/s] 92%|█████████▏| 432/471 [01:20<00:07,  5.32it/s] 92%|█████████▏| 433/471 [01:20<00:07,  5.33it/s] 92%|█████████▏| 434/471 [01:20<00:06,  5.33it/s] 92%|█████████▏| 435/471 [01:20<00:06,  5.32it/s] 93%|█████████▎| 436/471 [01:21<00:06,  5.33it/s] 93%|█████████▎| 437/471 [01:21<00:06,  5.33it/s] 93%|█████████▎| 438/471 [01:21<00:06,  5.34it/s] 93%|█████████▎| 439/471 [01:21<00:06,  5.33it/s] 93%|█████████▎| 440/471 [01:21<00:05,  5.34it/s] 94%|█████████▎| 441/471 [01:21<00:05,  5.35it/s] 94%|█████████▍| 442/471 [01:22<00:05,  5.35it/s] 94%|█████████▍| 443/471 [01:22<00:05,  5.35it/s] 94%|█████████▍| 444/471 [01:22<00:05,  5.35it/s] 94%|█████████▍| 445/471 [01:22<00:04,  5.34it/s] 95%|█████████▍| 446/471 [01:22<00:04,  5.33it/s] 95%|█████████▍| 447/471 [01:23<00:04,  5.33it/s] 95%|█████████▌| 448/471 [01:23<00:04,  5.35it/s] 95%|█████████▌| 449/471 [01:23<00:04,  5.35it/s] 96%|█████████▌| 450/471 [01:23<00:03,  5.33it/s] 96%|█████████▌| 451/471 [01:23<00:03,  5.34it/s] 96%|█████████▌| 452/471 [01:24<00:03,  5.36it/s] 96%|█████████▌| 453/471 [01:24<00:03,  5.33it/s] 96%|█████████▋| 454/471 [01:24<00:03,  5.32it/s] 97%|█████████▋| 455/471 [01:24<00:03,  5.31it/s] 97%|█████████▋| 456/471 [01:24<00:02,  5.33it/s] 97%|█████████▋| 457/471 [01:24<00:02,  5.34it/s] 97%|█████████▋| 458/471 [01:25<00:02,  5.32it/s] 97%|█████████▋| 459/471 [01:25<00:02,  5.34it/s] 98%|█████████▊| 460/471 [01:25<00:02,  5.34it/s] 98%|█████████▊| 461/471 [01:25<00:01,  5.33it/s] 98%|█████████▊| 462/471 [01:25<00:01,  5.33it/s] 98%|█████████▊| 463/471 [01:26<00:01,  5.33it/s] 99%|█████████▊| 464/471 [01:26<00:01,  5.33it/s] 99%|█████████▊| 465/471 [01:26<00:01,  5.34it/s] 99%|█████████▉| 466/471 [01:26<00:00,  5.32it/s] 99%|█████████▉| 467/471 [01:26<00:00,  5.31it/s] 99%|█████████▉| 468/471 [01:27<00:00,  5.31it/s]100%|█████████▉| 469/471 [01:27<00:00,  5.32it/s]100%|█████████▉| 470/471 [01:27<00:00,  5.34it/s]100%|██████████| 471/471 [01:27<00:00,  5.70it/s]100%|██████████| 471/471 [01:27<00:00,  5.38it/s]
{'eval_loss': 4.3974928855896, 'eval_model_preparation_time': 0.0052, 'eval_acc': 0.20525756771109932, 'eval_runtime': 87.714, 'eval_samples_per_second': 85.87, 'eval_steps_per_second': 5.37}
ROUND:8
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]                                              {'loss': 4.9311, 'grad_norm': 6.973622798919678, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.06it/s]  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]                                              {'loss': 2.6457, 'grad_norm': 8.396171569824219, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.06it/s]  8%|▊         | 3/40 [00:00<00:12,  3.02it/s]                                              {'loss': 2.6097, 'grad_norm': 11.329730987548828, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.02it/s] 10%|█         | 4/40 [00:01<00:11,  3.00it/s]                                              {'loss': 2.2469, 'grad_norm': 12.24313735961914, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.00it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s]                                              {'loss': 3.3644, 'grad_norm': 20.397537231445312, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.00it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s]                                              {'loss': 2.7903, 'grad_norm': 18.519792556762695, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.01it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 1.4658, 'grad_norm': 14.251459121704102, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.00it/s]                                              {'loss': 5.2675, 'grad_norm': 69.4424819946289, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s]                                              {'loss': 1.6499, 'grad_norm': 15.187832832336426, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.75it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s]                                               {'loss': 1.7758, 'grad_norm': 11.000505447387695, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.54it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s]                                               {'loss': 1.011, 'grad_norm': 9.789469718933105, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.37it/s] 30%|███       | 12/40 [00:03<00:08,  3.30it/s]                                               {'loss': 1.075, 'grad_norm': 8.936735153198242, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.30it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.23it/s]                                               {'loss': 1.7045, 'grad_norm': 12.12729549407959, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.23it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s]                                               {'loss': 0.8175, 'grad_norm': 7.480144023895264, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.15it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 1.4361, 'grad_norm': 10.974925994873047, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.12it/s]                                               {'loss': 0.2265, 'grad_norm': 11.307156562805176, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.87it/s]                                               {'loss': 1.1617, 'grad_norm': 5.406728744506836, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.87it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s]                                               {'loss': 1.0599, 'grad_norm': 7.236710071563721, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.62it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s]                                               {'loss': 0.47, 'grad_norm': 5.347142219543457, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.44it/s] 50%|█████     | 20/40 [00:06<00:06,  3.31it/s]                                               {'loss': 0.6884, 'grad_norm': 8.02486515045166, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.31it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s]                                               {'loss': 0.8029, 'grad_norm': 6.3647589683532715, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.21it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s]                                               {'loss': 0.9515, 'grad_norm': 8.618169784545898, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.05it/s]                                               {'loss': 0.584, 'grad_norm': 5.624777317047119, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.05it/s]                                               {'loss': 0.3629, 'grad_norm': 15.782824516296387, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.05it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s]                                               {'loss': 0.3007, 'grad_norm': 3.659364700317383, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.79it/s] 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s]                                               {'loss': 0.6169, 'grad_norm': 4.473645210266113, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:03,  3.58it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s]                                               {'loss': 0.1458, 'grad_norm': 2.0305607318878174, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s] 70%|███████   | 28/40 [00:08<00:03,  3.29it/s]                                               {'loss': 0.4851, 'grad_norm': 5.187361717224121, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.29it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s]                                               {'loss': 0.8279, 'grad_norm': 13.715155601501465, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s]                                               {'loss': 0.2617, 'grad_norm': 2.62692928314209, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.16it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.3183, 'grad_norm': 5.742106914520264, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.0305, 'grad_norm': 1.9607325792312622, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s]                                               {'loss': 0.1702, 'grad_norm': 2.904266119003296, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.82it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.1812, 'grad_norm': 2.7284321784973145, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.2724, 'grad_norm': 2.6883418560028076, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.41it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s]                                               {'loss': 0.1532, 'grad_norm': 3.2933881282806396, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.28it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s]                                               {'loss': 0.5493, 'grad_norm': 1.8231947422027588, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.20it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.1048, 'grad_norm': 2.0313332080841064, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.14it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.4331, 'grad_norm': 3.3635528087615967, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.7204, 'grad_norm': 20.32071876525879, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.09it/s]                                               {'train_runtime': 12.2247, 'train_samples_per_second': 46.218, 'train_steps_per_second': 3.272, 'train_loss': 1.1667612403631211, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.09it/s]100%|██████████| 40/40 [00:12<00:00,  3.27it/s]
CLIENT:49
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.12it/s]                                              {'loss': 6.2207, 'grad_norm': 8.173360824584961, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.12it/s]  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]                                              {'loss': 3.6082, 'grad_norm': 8.404424667358398, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.07it/s]  8%|▊         | 3/40 [00:00<00:12,  3.01it/s]                                              {'loss': 2.1855, 'grad_norm': 9.531576156616211, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.01it/s] 10%|█         | 4/40 [00:01<00:12,  2.97it/s]                                              {'loss': 2.8221, 'grad_norm': 16.113107681274414, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.97it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.93it/s]                                              {'loss': 3.8647, 'grad_norm': 21.54718017578125, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.93it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s]                                              {'loss': 2.4009, 'grad_norm': 15.781144142150879, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s]                                              {'loss': 2.0965, 'grad_norm': 12.474929809570312, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s]                                              {'loss': 2.9469, 'grad_norm': 61.151153564453125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.96it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s]                                              {'loss': 0.9316, 'grad_norm': 6.9520134925842285, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.81it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.61it/s]                                               {'loss': 1.6693, 'grad_norm': 13.961920738220215, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.61it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s]                                               {'loss': 1.0705, 'grad_norm': 7.227197647094727, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.44it/s] 30%|███       | 12/40 [00:03<00:08,  3.32it/s]                                               {'loss': 1.3424, 'grad_norm': 10.11668872833252, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.32it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.22it/s]                                               {'loss': 1.2086, 'grad_norm': 6.056330680847168, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.22it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s]                                               {'loss': 1.2809, 'grad_norm': 8.116910934448242, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.14it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 1.0963, 'grad_norm': 8.005176544189453, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.1712, 'grad_norm': 9.646305084228516, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.08it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s]                                               {'loss': 0.6572, 'grad_norm': 4.3486433029174805, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.83it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s]                                               {'loss': 0.4457, 'grad_norm': 3.8941850662231445, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.57it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s]                                               {'loss': 0.6687, 'grad_norm': 5.389245986938477, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.40it/s] 50%|█████     | 20/40 [00:06<00:06,  3.29it/s]                                               {'loss': 0.5675, 'grad_norm': 5.75698709487915, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.29it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s]                                               {'loss': 1.1858, 'grad_norm': 13.398992538452148, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.22it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s]                                               {'loss': 0.3491, 'grad_norm': 6.75633430480957, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.16it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.6552, 'grad_norm': 2.9655263423919678, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.12it/s]                                               {'loss': 1.0319, 'grad_norm': 46.5653076171875, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.12it/s] 62%|██████▎   | 25/40 [00:07<00:04,  3.71it/s]                                               {'loss': 0.4851, 'grad_norm': 6.188264846801758, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:04,  3.71it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.48it/s]                                               {'loss': 0.1627, 'grad_norm': 2.0015506744384766, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.48it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.34it/s]                                               {'loss': 0.7305, 'grad_norm': 2.487522840499878, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.34it/s] 70%|███████   | 28/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.1451, 'grad_norm': 1.9689191579818726, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.24it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s]                                               {'loss': 0.3753, 'grad_norm': 1.4098844528198242, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.19it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.1299, 'grad_norm': 2.4273030757904053, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.3912, 'grad_norm': 5.2820940017700195, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.11it/s]                                               {'loss': 0.0147, 'grad_norm': 1.0606789588928223, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.11it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s]                                               {'loss': 0.4796, 'grad_norm': 2.0848987102508545, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.83it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s]                                               {'loss': 0.0761, 'grad_norm': 2.2939980030059814, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.59it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s]                                               {'loss': 0.0509, 'grad_norm': 0.6810416579246521, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.40it/s] 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s]                                               {'loss': 0.2481, 'grad_norm': 4.443165302276611, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:10<00:01,  3.27it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s]                                               {'loss': 0.5063, 'grad_norm': 1.1376525163650513, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.17it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.0697, 'grad_norm': 1.4906466007232666, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.09it/s] 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.0666, 'grad_norm': 2.5821526050567627, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:11<00:00,  3.06it/s]                                               {'loss': 0.0386, 'grad_norm': 2.593541145324707, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:11<00:00,  3.06it/s]                                               {'train_runtime': 12.1678, 'train_samples_per_second': 46.434, 'train_steps_per_second': 3.287, 'train_loss': 1.1111981006339193, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.06it/s]100%|██████████| 40/40 [00:12<00:00,  3.29it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]                                              {'loss': 3.9242, 'grad_norm': 6.971576690673828, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]                                              {'loss': 2.2969, 'grad_norm': 8.629340171813965, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.03it/s]  8%|▊         | 3/40 [00:00<00:12,  3.08it/s]                                              {'loss': 1.5567, 'grad_norm': 13.986434936523438, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.08it/s] 10%|█         | 4/40 [00:01<00:11,  3.07it/s]                                              {'loss': 1.8803, 'grad_norm': 12.737147331237793, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.07it/s] 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s]                                              {'loss': 1.858, 'grad_norm': 13.426767349243164, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  3.07it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s]                                              {'loss': 2.3323, 'grad_norm': 16.308917999267578, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.04it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 2.3337, 'grad_norm': 19.277925491333008, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s] 20%|██        | 8/40 [00:02<00:08,  3.85it/s]                                              {'loss': 6.0235, 'grad_norm': 65.58071899414062, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.85it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.62it/s]                                              {'loss': 0.5835, 'grad_norm': 8.198430061340332, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.62it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.38it/s]                                               {'loss': 1.0904, 'grad_norm': 12.503131866455078, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.38it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.28it/s]                                               {'loss': 0.9945, 'grad_norm': 9.902023315429688, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.28it/s] 30%|███       | 12/40 [00:03<00:08,  3.20it/s]                                               {'loss': 1.091, 'grad_norm': 11.838310241699219, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:08,  3.20it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.14it/s]                                               {'loss': 0.3229, 'grad_norm': 4.512629508972168, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.14it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s]                                               {'loss': 0.65, 'grad_norm': 4.732297420501709, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.08it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.0239, 'grad_norm': 4.84207010269165, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.09it/s]                                               {'loss': 1.2748, 'grad_norm': 25.820953369140625, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.09it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.85it/s]                                               {'loss': 0.6351, 'grad_norm': 5.060149192810059, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.85it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s]                                               {'loss': 0.1915, 'grad_norm': 2.7480313777923584, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.60it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s]                                               {'loss': 0.4595, 'grad_norm': 2.454535961151123, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.42it/s] 50%|█████     | 20/40 [00:06<00:06,  3.30it/s]                                               {'loss': 0.3399, 'grad_norm': 2.812237024307251, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.30it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s]                                               {'loss': 0.298, 'grad_norm': 4.601568222045898, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.19it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s]                                               {'loss': 0.3991, 'grad_norm': 5.354479789733887, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.11it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.1196, 'grad_norm': 3.627995252609253, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.09it/s]                                               {'loss': 0.0444, 'grad_norm': 2.2482047080993652, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.09it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.75it/s]                                               {'loss': 0.039, 'grad_norm': 0.916060209274292, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.75it/s] 65%|██████▌   | 26/40 [00:07<00:04,  3.45it/s]                                               {'loss': 0.3257, 'grad_norm': 4.421142101287842, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:07<00:04,  3.45it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s]                                               {'loss': 0.2276, 'grad_norm': 3.536741256713867, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s] 70%|███████   | 28/40 [00:08<00:03,  3.09it/s]                                               {'loss': 0.2037, 'grad_norm': 1.8636633157730103, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.09it/s] 72%|███████▎  | 29/40 [00:08<00:03,  3.06it/s]                                               {'loss': 0.1808, 'grad_norm': 3.5726187229156494, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:08<00:03,  3.06it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.07it/s]                                               {'loss': 0.1094, 'grad_norm': 1.8773407936096191, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.07it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.03it/s]                                               {'loss': 0.0824, 'grad_norm': 1.5101951360702515, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.03it/s]                                               {'loss': 0.011, 'grad_norm': 0.7256073355674744, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.03it/s] 82%|████████▎ | 33/40 [00:09<00:01,  3.64it/s]                                               {'loss': 0.1247, 'grad_norm': 5.361229419708252, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:09<00:01,  3.64it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.41it/s]                                               {'loss': 0.0312, 'grad_norm': 0.6343207359313965, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.41it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.26it/s]                                               {'loss': 0.2244, 'grad_norm': 1.5081297159194946, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.26it/s] 90%|█████████ | 36/40 [00:11<00:01,  3.17it/s]                                               {'loss': 0.0298, 'grad_norm': 0.6006067991256714, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:11<00:01,  3.17it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.0245, 'grad_norm': 0.523160994052887, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.09it/s] 95%|█████████▌| 38/40 [00:11<00:00,  2.98it/s]                                               {'loss': 0.2848, 'grad_norm': 5.626791477203369, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  2.98it/s] 98%|█████████▊| 39/40 [00:12<00:00,  3.00it/s]                                               {'loss': 0.186, 'grad_norm': 1.7087953090667725, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:12<00:00,  3.00it/s]100%|██████████| 40/40 [00:12<00:00,  3.58it/s]                                               {'loss': 0.0011, 'grad_norm': 0.05723308399319649, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.58it/s]                                               {'train_runtime': 12.663, 'train_samples_per_second': 44.618, 'train_steps_per_second': 3.159, 'train_loss': 0.8452491992531577, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.58it/s]100%|██████████| 40/40 [00:12<00:00,  3.16it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.93it/s]                                              {'loss': 5.369, 'grad_norm': 7.4523186683654785, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.93it/s]  5%|▌         | 2/40 [00:00<00:12,  2.95it/s]                                              {'loss': 4.1447, 'grad_norm': 9.910660743713379, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.95it/s]  8%|▊         | 3/40 [00:01<00:12,  2.94it/s]                                              {'loss': 3.8528, 'grad_norm': 9.47475814819336, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.94it/s] 10%|█         | 4/40 [00:01<00:12,  2.88it/s]                                              {'loss': 2.4582, 'grad_norm': 13.484743118286133, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.88it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.87it/s]                                              {'loss': 2.6856, 'grad_norm': 16.724458694458008, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.87it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.80it/s]                                              {'loss': 2.4988, 'grad_norm': 23.67990493774414, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.80it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.82it/s]                                              {'loss': 1.7856, 'grad_norm': 18.460758209228516, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.82it/s] 20%|██        | 8/40 [00:02<00:10,  3.19it/s]                                              {'loss': 3.1814, 'grad_norm': 125.89653778076172, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.19it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.01it/s]                                              {'loss': 1.5192, 'grad_norm': 17.863109588623047, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.01it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.92it/s]                                               {'loss': 2.0664, 'grad_norm': 22.04347801208496, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.92it/s] 28%|██▊       | 11/40 [00:03<00:10,  2.85it/s]                                               {'loss': 2.2549, 'grad_norm': 24.070919036865234, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:10,  2.85it/s] 30%|███       | 12/40 [00:04<00:10,  2.76it/s]                                               {'loss': 0.9334, 'grad_norm': 13.339190483093262, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.76it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.77it/s]                                               {'loss': 1.439, 'grad_norm': 15.595077514648438, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.77it/s] 35%|███▌      | 14/40 [00:04<00:09,  2.87it/s]                                               {'loss': 1.9507, 'grad_norm': 10.377850532531738, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:09,  2.87it/s] 38%|███▊      | 15/40 [00:05<00:08,  2.89it/s]                                               {'loss': 1.0671, 'grad_norm': 9.813568115234375, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  2.89it/s] 40%|████      | 16/40 [00:05<00:07,  3.27it/s]                                               {'loss': 0.3384, 'grad_norm': 11.723711013793945, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.27it/s] 42%|████▎     | 17/40 [00:05<00:07,  3.19it/s]                                               {'loss': 1.1648, 'grad_norm': 7.53639554977417, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:07,  3.19it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.18it/s]                                               {'loss': 0.8424, 'grad_norm': 7.397622108459473, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.18it/s] 48%|████▊     | 19/40 [00:06<00:06,  3.13it/s]                                               {'loss': 0.9548, 'grad_norm': 5.872426986694336, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:06,  3.13it/s] 50%|█████     | 20/40 [00:06<00:06,  3.05it/s]                                               {'loss': 1.3431, 'grad_norm': 6.053163051605225, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.05it/s] 52%|█████▎    | 21/40 [00:07<00:06,  3.02it/s]                                               {'loss': 1.0234, 'grad_norm': 6.671091079711914, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  3.02it/s] 55%|█████▌    | 22/40 [00:07<00:05,  3.01it/s]                                               {'loss': 1.0653, 'grad_norm': 7.960617542266846, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:05,  3.01it/s] 57%|█████▊    | 23/40 [00:07<00:05,  2.99it/s]                                               {'loss': 0.9297, 'grad_norm': 8.850029945373535, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  2.99it/s]                                               {'loss': 0.7335, 'grad_norm': 24.44085693359375, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  2.99it/s] 62%|██████▎   | 25/40 [00:08<00:04,  3.75it/s]                                               {'loss': 0.2494, 'grad_norm': 3.9865641593933105, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:04,  3.75it/s] 65%|██████▌   | 26/40 [00:08<00:03,  3.54it/s]                                               {'loss': 0.7402, 'grad_norm': 4.446560382843018, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:03,  3.54it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.35it/s]                                               {'loss': 0.4905, 'grad_norm': 5.337135314941406, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.35it/s] 70%|███████   | 28/40 [00:09<00:03,  3.23it/s]                                               {'loss': 0.4182, 'grad_norm': 5.604877471923828, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:09<00:03,  3.23it/s] 72%|███████▎  | 29/40 [00:09<00:03,  3.14it/s]                                               {'loss': 0.6275, 'grad_norm': 4.149158477783203, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:09<00:03,  3.14it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.08it/s]                                               {'loss': 0.3477, 'grad_norm': 6.013528347015381, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.08it/s] 78%|███████▊  | 31/40 [00:10<00:02,  3.06it/s]                                               {'loss': 0.4778, 'grad_norm': 5.406025409698486, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:10<00:02,  3.06it/s]                                               {'loss': 0.0083, 'grad_norm': 0.32585909962654114, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:10<00:02,  3.06it/s] 82%|████████▎ | 33/40 [00:10<00:01,  3.73it/s]                                               {'loss': 0.2323, 'grad_norm': 2.3894639015197754, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:10<00:01,  3.73it/s] 85%|████████▌ | 34/40 [00:11<00:02,  2.80it/s]                                               {'loss': 0.1297, 'grad_norm': 2.4556021690368652, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:11<00:02,  2.80it/s] 88%|████████▊ | 35/40 [00:11<00:02,  2.47it/s]                                               {'loss': 0.2211, 'grad_norm': 1.946953535079956, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:11<00:02,  2.47it/s] 90%|█████████ | 36/40 [00:12<00:01,  2.17it/s]                                               {'loss': 0.9339, 'grad_norm': 10.324444770812988, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:12<00:01,  2.17it/s] 92%|█████████▎| 37/40 [00:12<00:01,  2.01it/s]                                               {'loss': 0.1241, 'grad_norm': 1.674376130104065, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:12<00:01,  2.01it/s] 95%|█████████▌| 38/40 [00:13<00:01,  1.78it/s]                                               {'loss': 0.3657, 'grad_norm': 1.8065786361694336, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:01,  1.78it/s] 98%|█████████▊| 39/40 [00:14<00:00,  1.70it/s]                                               {'loss': 0.2937, 'grad_norm': 3.9640915393829346, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  1.70it/s]                                               {'loss': 0.2255, 'grad_norm': 10.714446067810059, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  1.70it/s]                                               {'train_runtime': 14.6487, 'train_samples_per_second': 38.57, 'train_steps_per_second': 2.731, 'train_loss': 1.2871905974112452, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  1.70it/s]100%|██████████| 40/40 [00:14<00:00,  2.73it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:25,  1.52it/s]                                              {'loss': 3.9135, 'grad_norm': 7.791612148284912, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:25,  1.52it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]                                              {'loss': 3.9298, 'grad_norm': 6.209997177124023, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:01<00:24,  1.54it/s]                                              {'loss': 2.5368, 'grad_norm': 14.089262962341309, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.54it/s] 10%|█         | 4/40 [00:02<00:24,  1.49it/s]                                              {'loss': 1.3019, 'grad_norm': 10.544544219970703, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.49it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s]                                              {'loss': 2.305, 'grad_norm': 15.605732917785645, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.54it/s]                                              {'loss': 1.925, 'grad_norm': 14.984029769897461, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.54it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s]                                              {'loss': 2.182, 'grad_norm': 17.80510902404785, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s]                                              {'loss': 4.6279, 'grad_norm': 135.14170837402344, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 0.9301, 'grad_norm': 9.725844383239746, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.83it/s]                                               {'loss': 1.5468, 'grad_norm': 12.927936553955078, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.83it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.69it/s]                                               {'loss': 1.7157, 'grad_norm': 13.81142520904541, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.69it/s] 30%|███       | 12/40 [00:07<00:16,  1.69it/s]                                               {'loss': 1.4292, 'grad_norm': 10.232412338256836, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.69it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.60it/s]                                               {'loss': 1.2759, 'grad_norm': 13.211544036865234, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.60it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s]                                               {'loss': 1.4305, 'grad_norm': 10.695257186889648, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s] 38%|███▊      | 15/40 [00:09<00:15,  1.58it/s]                                               {'loss': 0.9276, 'grad_norm': 6.806110858917236, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:15,  1.58it/s]                                               {'loss': 0.0243, 'grad_norm': 1.6180506944656372, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.58it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s]                                               {'loss': 0.8014, 'grad_norm': 7.6615777015686035, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.77it/s]                                               {'loss': 0.4929, 'grad_norm': 5.002838611602783, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.77it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s]                                               {'loss': 0.3733, 'grad_norm': 2.9216785430908203, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s] 50%|█████     | 20/40 [00:12<00:12,  1.62it/s]                                               {'loss': 0.5179, 'grad_norm': 5.46342134475708, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.62it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.60it/s]                                               {'loss': 0.7355, 'grad_norm': 6.330175876617432, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.60it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s]                                               {'loss': 1.0554, 'grad_norm': 7.9728522300720215, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.51it/s]                                               {'loss': 0.7665, 'grad_norm': 4.693110942840576, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.51it/s]                                               {'loss': 0.4124, 'grad_norm': 18.54433822631836, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.51it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.93it/s]                                               {'loss': 0.3102, 'grad_norm': 5.267649173736572, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  1.93it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.77it/s]                                               {'loss': 0.6986, 'grad_norm': 6.775295257568359, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.77it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.67it/s]                                               {'loss': 0.9007, 'grad_norm': 5.589955806732178, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.67it/s] 70%|███████   | 28/40 [00:16<00:07,  1.67it/s]                                               {'loss': 0.1434, 'grad_norm': 2.7319650650024414, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.67it/s] 72%|███████▎  | 29/40 [00:17<00:07,  1.57it/s]                                               {'loss': 0.2838, 'grad_norm': 5.349609375, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:07,  1.57it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.54it/s]                                               {'loss': 0.0625, 'grad_norm': 1.9139868021011353, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.54it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.56it/s]                                               {'loss': 0.1177, 'grad_norm': 1.9008593559265137, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.56it/s] 80%|████████  | 32/40 [00:19<00:03,  2.05it/s]                                               {'loss': 0.0091, 'grad_norm': 0.6799413561820984, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:03,  2.05it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.81it/s]                                               {'loss': 0.4437, 'grad_norm': 0.6729093790054321, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.81it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.67it/s]                                               {'loss': 0.0644, 'grad_norm': 1.8365134000778198, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.67it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.66it/s]                                               {'loss': 0.2355, 'grad_norm': 2.646341323852539, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.66it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.55it/s]                                               {'loss': 0.3591, 'grad_norm': 1.0165804624557495, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.55it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.68it/s]                                               {'loss': 0.059, 'grad_norm': 0.8955332636833191, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.68it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.93it/s]                                               {'loss': 0.297, 'grad_norm': 2.786846399307251, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.93it/s] 98%|█████████▊| 39/40 [00:22<00:00,  2.13it/s]                                               {'loss': 0.1746, 'grad_norm': 1.9742426872253418, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  2.13it/s]                                               {'loss': 0.0178, 'grad_norm': 1.1864925622940063, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.13it/s]                                               {'train_runtime': 23.4496, 'train_samples_per_second': 24.094, 'train_steps_per_second': 1.706, 'train_loss': 1.0333540716208518, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.13it/s]100%|██████████| 40/40 [00:23<00:00,  1.71it/s]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.85it/s]                                              {'loss': 3.614, 'grad_norm': 5.6658124923706055, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.85it/s]  5%|▌         | 2/40 [00:00<00:13,  2.92it/s]                                              {'loss': 2.5158, 'grad_norm': 7.248479843139648, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.92it/s]  8%|▊         | 3/40 [00:01<00:12,  2.91it/s]                                              {'loss': 2.7115, 'grad_norm': 13.339393615722656, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.91it/s] 10%|█         | 4/40 [00:01<00:12,  2.93it/s]                                              {'loss': 2.1373, 'grad_norm': 14.060894012451172, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.93it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.89it/s]                                              {'loss': 1.1954, 'grad_norm': 13.614418029785156, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.89it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.89it/s]                                              {'loss': 1.7088, 'grad_norm': 8.411279678344727, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.89it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.90it/s]                                              {'loss': 2.4845, 'grad_norm': 21.50754737854004, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.90it/s] 20%|██        | 8/40 [00:02<00:08,  3.61it/s]                                              {'loss': 0.0186, 'grad_norm': 1.2592679262161255, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.61it/s] 22%|██▎       | 9/40 [00:02<00:09,  3.41it/s]                                              {'loss': 1.726, 'grad_norm': 12.329872131347656, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:09,  3.41it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.62it/s]                                               {'loss': 0.6492, 'grad_norm': 9.24573040008545, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.62it/s] 28%|██▊       | 11/40 [00:04<00:13,  2.20it/s]                                               {'loss': 1.2967, 'grad_norm': 13.042724609375, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:13,  2.20it/s] 30%|███       | 12/40 [00:04<00:14,  1.92it/s]                                               {'loss': 1.0099, 'grad_norm': 9.246788024902344, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:14,  1.92it/s] 32%|███▎      | 13/40 [00:05<00:14,  1.84it/s]                                               {'loss': 0.6044, 'grad_norm': 10.61617374420166, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:14,  1.84it/s] 35%|███▌      | 14/40 [00:06<00:15,  1.69it/s]                                               {'loss': 0.6445, 'grad_norm': 4.073302745819092, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:15,  1.69it/s] 38%|███▊      | 15/40 [00:06<00:15,  1.61it/s]                                               {'loss': 1.0314, 'grad_norm': 5.588661193847656, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:15,  1.61it/s] 40%|████      | 16/40 [00:06<00:11,  2.16it/s]                                               {'loss': 2.2073, 'grad_norm': 25.467134475708008, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:11,  2.16it/s] 42%|████▎     | 17/40 [00:07<00:11,  1.96it/s]                                               {'loss': 0.5738, 'grad_norm': 3.6735799312591553, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:11,  1.96it/s] 45%|████▌     | 18/40 [00:08<00:12,  1.78it/s]                                               {'loss': 0.4645, 'grad_norm': 3.6626384258270264, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:12,  1.78it/s] 48%|████▊     | 19/40 [00:08<00:12,  1.66it/s]                                               {'loss': 0.7441, 'grad_norm': 8.459633827209473, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:12,  1.66it/s] 50%|█████     | 20/40 [00:09<00:12,  1.66it/s]                                               {'loss': 0.6243, 'grad_norm': 6.3419013023376465, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:12,  1.66it/s] 52%|█████▎    | 21/40 [00:10<00:12,  1.57it/s]                                               {'loss': 0.5887, 'grad_norm': 4.4641852378845215, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.60it/s]                                               {'loss': 0.4738, 'grad_norm': 4.22088098526001, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.60it/s] 57%|█████▊    | 23/40 [00:11<00:10,  1.55it/s]                                               {'loss': 0.641, 'grad_norm': 6.390641212463379, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:10,  1.55it/s]                                               {'loss': 0.4073, 'grad_norm': 14.927408218383789, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:10,  1.55it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.90it/s]                                               {'loss': 0.64, 'grad_norm': 1.6568530797958374, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.90it/s] 65%|██████▌   | 26/40 [00:12<00:07,  1.83it/s]                                               {'loss': 0.1235, 'grad_norm': 2.2219722270965576, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:07,  1.83it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.70it/s]                                               {'loss': 0.3145, 'grad_norm': 5.231980800628662, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.70it/s] 70%|███████   | 28/40 [00:14<00:07,  1.63it/s]                                               {'loss': 0.0933, 'grad_norm': 1.5286569595336914, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.63it/s] 72%|███████▎  | 29/40 [00:14<00:06,  1.65it/s]                                               {'loss': 0.243, 'grad_norm': 3.333277702331543, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:06,  1.65it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.56it/s]                                               {'loss': 0.2878, 'grad_norm': 2.388760805130005, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.55it/s]                                               {'loss': 0.2883, 'grad_norm': 3.892232894897461, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.55it/s] 80%|████████  | 32/40 [00:16<00:03,  2.06it/s]                                               {'loss': 1.2195, 'grad_norm': 16.124094009399414, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:03,  2.06it/s] 82%|████████▎ | 33/40 [00:16<00:03,  1.92it/s]                                               {'loss': 0.2011, 'grad_norm': 1.845323920249939, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:03,  1.92it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.72it/s]                                               {'loss': 0.2888, 'grad_norm': 0.6640095710754395, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.72it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.73it/s]                                               {'loss': 0.4857, 'grad_norm': 1.5648976564407349, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.73it/s] 90%|█████████ | 36/40 [00:18<00:02,  1.62it/s]                                               {'loss': 0.1319, 'grad_norm': 4.215842247009277, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s]                                               {'loss': 0.069, 'grad_norm': 1.4653375148773193, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.57it/s]                                               {'loss': 0.1359, 'grad_norm': 4.6859130859375, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.57it/s] 98%|█████████▊| 39/40 [00:20<00:00,  1.52it/s]                                               {'loss': 0.0392, 'grad_norm': 0.7462906241416931, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  1.52it/s]                                               {'loss': 0.0033, 'grad_norm': 0.15728773176670074, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.52it/s]                                               {'train_runtime': 21.2233, 'train_samples_per_second': 26.622, 'train_steps_per_second': 1.885, 'train_loss': 0.8659379379299935, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.52it/s]100%|██████████| 40/40 [00:21<00:00,  1.88it/s]
CLIENT:87
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]                                              {'loss': 4.6248, 'grad_norm': 9.099506378173828, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.45it/s]  5%|▌         | 2/40 [00:01<00:19,  1.94it/s]                                              {'loss': 2.9143, 'grad_norm': 8.936782836914062, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:19,  1.94it/s]  8%|▊         | 3/40 [00:01<00:16,  2.29it/s]                                              {'loss': 1.7867, 'grad_norm': 9.404934883117676, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.29it/s] 10%|█         | 4/40 [00:01<00:14,  2.52it/s]                                              {'loss': 1.4255, 'grad_norm': 11.348982810974121, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.52it/s] 12%|█▎        | 5/40 [00:02<00:13,  2.64it/s]                                              {'loss': 1.3557, 'grad_norm': 10.025094032287598, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.64it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.73it/s]                                              {'loss': 1.302, 'grad_norm': 15.457710266113281, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.73it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.79it/s]                                              {'loss': 0.8959, 'grad_norm': 10.522385597229004, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.79it/s] 20%|██        | 8/40 [00:02<00:08,  3.60it/s]                                              {'loss': 0.8649, 'grad_norm': 39.0887336730957, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.60it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.41it/s]                                              {'loss': 0.9119, 'grad_norm': 17.896366119384766, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.41it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.22it/s]                                               {'loss': 0.9183, 'grad_norm': 14.006887435913086, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.22it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.13it/s]                                               {'loss': 0.9399, 'grad_norm': 11.752433776855469, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.13it/s] 30%|███       | 12/40 [00:04<00:09,  3.06it/s]                                               {'loss': 0.6559, 'grad_norm': 9.430232048034668, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  3.06it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.04it/s]                                               {'loss': 0.7877, 'grad_norm': 8.272680282592773, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.04it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.01it/s]                                               {'loss': 0.7486, 'grad_norm': 5.890249729156494, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.01it/s] 38%|███▊      | 15/40 [00:05<00:08,  3.00it/s]                                               {'loss': 0.9954, 'grad_norm': 9.104218482971191, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  3.00it/s]                                               {'loss': 0.109, 'grad_norm': 3.279254913330078, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.00it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.66it/s]                                               {'loss': 0.4284, 'grad_norm': 4.269002437591553, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.66it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.43it/s]                                               {'loss': 0.5587, 'grad_norm': 4.066585540771484, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.43it/s] 48%|████▊     | 19/40 [00:06<00:06,  3.25it/s]                                               {'loss': 0.2898, 'grad_norm': 2.8891780376434326, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:06,  3.25it/s] 50%|█████     | 20/40 [00:06<00:06,  3.16it/s]                                               {'loss': 0.5382, 'grad_norm': 4.623886585235596, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.16it/s] 52%|█████▎    | 21/40 [00:07<00:06,  3.06it/s]                                               {'loss': 0.5695, 'grad_norm': 3.923776388168335, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  3.06it/s] 55%|█████▌    | 22/40 [00:07<00:06,  2.98it/s]                                               {'loss': 0.2497, 'grad_norm': 3.2324705123901367, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:06,  2.98it/s] 57%|█████▊    | 23/40 [00:07<00:05,  2.95it/s]                                               {'loss': 0.5414, 'grad_norm': 13.667336463928223, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  2.95it/s]                                               {'loss': 0.7158, 'grad_norm': 33.245113372802734, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  2.95it/s] 62%|██████▎   | 25/40 [00:08<00:04,  3.37it/s]                                               {'loss': 0.1768, 'grad_norm': 2.212826728820801, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:04,  3.37it/s] 65%|██████▌   | 26/40 [00:08<00:05,  2.55it/s]                                               {'loss': 0.2611, 'grad_norm': 2.0145320892333984, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:09<00:06,  2.12it/s]                                               {'loss': 0.1311, 'grad_norm': 2.41111159324646, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:06,  2.12it/s] 70%|███████   | 28/40 [00:10<00:05,  2.00it/s]                                               {'loss': 0.1551, 'grad_norm': 1.4975107908248901, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.00it/s] 72%|███████▎  | 29/40 [00:10<00:06,  1.77it/s]                                               {'loss': 0.2177, 'grad_norm': 3.538327217102051, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:06,  1.77it/s] 75%|███████▌  | 30/40 [00:11<00:05,  1.69it/s]                                               {'loss': 0.1506, 'grad_norm': 4.111445426940918, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:05,  1.69it/s] 78%|███████▊  | 31/40 [00:12<00:05,  1.63it/s]                                               {'loss': 0.2042, 'grad_norm': 2.5666096210479736, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:05,  1.63it/s]                                               {'loss': 0.0036, 'grad_norm': 0.20843644440174103, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:04,  1.63it/s] 82%|████████▎ | 33/40 [00:13<00:03,  1.94it/s]                                               {'loss': 0.2837, 'grad_norm': 1.2367645502090454, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:03,  1.94it/s] 85%|████████▌ | 34/40 [00:13<00:03,  1.82it/s]                                               {'loss': 0.1966, 'grad_norm': 4.861472129821777, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:03,  1.82it/s] 88%|████████▊ | 35/40 [00:14<00:02,  1.72it/s]                                               {'loss': 0.0811, 'grad_norm': 0.9885125160217285, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  1.72it/s] 90%|█████████ | 36/40 [00:15<00:02,  1.61it/s]                                               {'loss': 0.0664, 'grad_norm': 1.5378867387771606, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:15<00:01,  1.65it/s]                                               {'loss': 0.0566, 'grad_norm': 2.362170696258545, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  1.65it/s] 95%|█████████▌| 38/40 [00:16<00:01,  1.55it/s]                                               {'loss': 0.0822, 'grad_norm': 2.086350917816162, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:01,  1.55it/s] 98%|█████████▊| 39/40 [00:17<00:00,  1.53it/s]                                               {'loss': 0.1464, 'grad_norm': 1.2119591236114502, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  1.53it/s]100%|██████████| 40/40 [00:17<00:00,  2.01it/s]                                               {'loss': 0.0506, 'grad_norm': 3.764570951461792, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.01it/s]                                               {'train_runtime': 17.5158, 'train_samples_per_second': 32.257, 'train_steps_per_second': 2.284, 'train_loss': 0.6847846598830074, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.01it/s]100%|██████████| 40/40 [00:17<00:00,  2.28it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:23,  1.69it/s]                                              {'loss': 3.7275, 'grad_norm': 5.977548122406006, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:23,  1.69it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]                                              {'loss': 2.6899, 'grad_norm': 7.908116340637207, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:01<00:24,  1.52it/s]                                              {'loss': 2.143, 'grad_norm': 12.080965042114258, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.52it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 1.4621, 'grad_norm': 10.97183895111084, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s]                                              {'loss': 1.7637, 'grad_norm': 12.034911155700684, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.50it/s]                                              {'loss': 2.3617, 'grad_norm': 16.429027557373047, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 1.5689, 'grad_norm': 16.664033889770508, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 1.7779, 'grad_norm': 104.98004150390625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 0.8659, 'grad_norm': 9.237483024597168, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.82it/s]                                               {'loss': 1.4738, 'grad_norm': 10.91163444519043, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.82it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.66it/s]                                               {'loss': 0.6617, 'grad_norm': 6.607625961303711, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.66it/s] 30%|███       | 12/40 [00:07<00:17,  1.62it/s]                                               {'loss': 0.9131, 'grad_norm': 8.534743309020996, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.62it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s]                                               {'loss': 0.6448, 'grad_norm': 7.414021015167236, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.53it/s]                                               {'loss': 0.6242, 'grad_norm': 4.951500415802002, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.53it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.5347, 'grad_norm': 7.206315517425537, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.2113, 'grad_norm': 12.399019241333008, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.54it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s]                                               {'loss': 0.4934, 'grad_norm': 5.063276767730713, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.74it/s]                                               {'loss': 0.4865, 'grad_norm': 7.043197154998779, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.74it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.70it/s]                                               {'loss': 0.8117, 'grad_norm': 14.05225944519043, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.70it/s] 50%|█████     | 20/40 [00:12<00:12,  1.61it/s]                                               {'loss': 0.5002, 'grad_norm': 6.396540641784668, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.61it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.58it/s]                                               {'loss': 0.5233, 'grad_norm': 4.48384952545166, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.58it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s]                                               {'loss': 0.5625, 'grad_norm': 3.8947360515594482, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.54it/s]                                               {'loss': 0.6674, 'grad_norm': 10.398550987243652, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.54it/s] 60%|██████    | 24/40 [00:14<00:08,  1.96it/s]                                               {'loss': 2.8816, 'grad_norm': 34.24937438964844, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:08,  1.96it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.78it/s]                                               {'loss': 0.7579, 'grad_norm': 12.648433685302734, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.78it/s] 65%|██████▌   | 26/40 [00:15<00:08,  1.72it/s]                                               {'loss': 0.6078, 'grad_norm': 6.8826584815979, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:08,  1.72it/s] 68%|██████▊   | 27/40 [00:16<00:08,  1.59it/s]                                               {'loss': 0.3414, 'grad_norm': 5.232969760894775, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:08,  1.59it/s] 70%|███████   | 28/40 [00:17<00:07,  1.54it/s]                                               {'loss': 0.4106, 'grad_norm': 2.773103713989258, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.54it/s] 72%|███████▎  | 29/40 [00:17<00:07,  1.56it/s]                                               {'loss': 0.1323, 'grad_norm': 1.7384721040725708, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:07,  1.56it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.49it/s]                                               {'loss': 0.2651, 'grad_norm': 4.031732082366943, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.49it/s] 78%|███████▊  | 31/40 [00:19<00:06,  1.49it/s]                                               {'loss': 0.0239, 'grad_norm': 0.5361711382865906, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:06,  1.49it/s] 80%|████████  | 32/40 [00:19<00:04,  1.94it/s]                                               {'loss': 0.2907, 'grad_norm': 9.455561637878418, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:04,  1.94it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.85it/s]                                               {'loss': 0.2875, 'grad_norm': 2.3938004970550537, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.85it/s] 85%|████████▌ | 34/40 [00:20<00:02,  2.07it/s]                                               {'loss': 0.0686, 'grad_norm': 2.2232511043548584, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:02,  2.07it/s] 88%|████████▊ | 35/40 [00:20<00:02,  2.24it/s]                                               {'loss': 0.1459, 'grad_norm': 3.8505239486694336, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  2.24it/s] 90%|█████████ | 36/40 [00:21<00:01,  2.40it/s]                                               {'loss': 0.1725, 'grad_norm': 1.8773406744003296, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:21<00:01,  2.52it/s]                                               {'loss': 0.3094, 'grad_norm': 0.9896755218505859, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  2.52it/s] 95%|█████████▌| 38/40 [00:21<00:00,  2.61it/s]                                               {'loss': 0.0718, 'grad_norm': 1.8593803644180298, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:00,  2.61it/s] 98%|█████████▊| 39/40 [00:22<00:00,  2.69it/s]                                               {'loss': 0.2267, 'grad_norm': 3.114741086959839, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  2.69it/s]100%|██████████| 40/40 [00:22<00:00,  3.44it/s]                                               {'loss': 0.0379, 'grad_norm': 2.818563461303711, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  3.44it/s]                                               {'train_runtime': 22.5078, 'train_samples_per_second': 25.102, 'train_steps_per_second': 1.777, 'train_loss': 0.8625106120016426, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  3.44it/s]100%|██████████| 40/40 [00:22<00:00,  1.78it/s]
CLIENT:99
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]                                              {'loss': 5.641, 'grad_norm': 8.605731964111328, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:23,  1.61it/s]                                              {'loss': 3.6131, 'grad_norm': 11.823065757751465, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:23,  1.61it/s]  8%|▊         | 3/40 [00:01<00:24,  1.49it/s]                                              {'loss': 3.0574, 'grad_norm': 11.561541557312012, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 1.4418, 'grad_norm': 13.047794342041016, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.52it/s]                                              {'loss': 1.398, 'grad_norm': 14.673571586608887, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.52it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.48it/s]                                              {'loss': 1.9198, 'grad_norm': 11.036087989807129, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s]                                              {'loss': 1.2976, 'grad_norm': 11.259586334228516, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s] 20%|██        | 8/40 [00:05<00:20,  1.53it/s]                                              {'loss': 0.8365, 'grad_norm': 8.025193214416504, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:20,  1.53it/s] 22%|██▎       | 9/40 [00:05<00:20,  1.54it/s]                                              {'loss': 1.0179, 'grad_norm': 9.515430450439453, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:20,  1.54it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.52it/s]                                               {'loss': 0.8866, 'grad_norm': 10.795616149902344, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:19,  1.52it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.49it/s]                                               {'loss': 0.7341, 'grad_norm': 11.2102689743042, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.49it/s] 30%|███       | 12/40 [00:07<00:18,  1.54it/s]                                               {'loss': 1.2949, 'grad_norm': 6.264039516448975, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:18,  1.54it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.50it/s]                                               {'loss': 0.6143, 'grad_norm': 7.196408748626709, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.50it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s]                                               {'loss': 0.5087, 'grad_norm': 5.697060585021973, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.48it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.4878, 'grad_norm': 5.775969505310059, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s] 40%|████      | 16/40 [00:10<00:15,  1.51it/s]                                               {'loss': 0.468, 'grad_norm': 4.948324680328369, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:15,  1.51it/s] 42%|████▎     | 17/40 [00:11<00:15,  1.52it/s]                                               {'loss': 0.2826, 'grad_norm': 3.1225013732910156, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:15,  1.52it/s] 45%|████▌     | 18/40 [00:11<00:14,  1.52it/s]                                               {'loss': 0.6318, 'grad_norm': 6.42733907699585, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:14,  1.52it/s] 48%|████▊     | 19/40 [00:12<00:14,  1.48it/s]                                               {'loss': 0.3483, 'grad_norm': 4.7000837326049805, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:14,  1.48it/s] 50%|█████     | 20/40 [00:13<00:12,  1.56it/s]                                               {'loss': 0.1109, 'grad_norm': 2.5192391872406006, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:12,  1.56it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.49it/s]                                               {'loss': 0.3103, 'grad_norm': 4.023808479309082, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.49it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.51it/s]                                               {'loss': 0.4637, 'grad_norm': 7.278774261474609, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.51it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.51it/s]                                               {'loss': 0.7281, 'grad_norm': 3.9536855220794678, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:11,  1.51it/s] 60%|██████    | 24/40 [00:15<00:10,  1.50it/s]                                               {'loss': 0.2094, 'grad_norm': 2.7793264389038086, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.50it/s] 62%|██████▎   | 25/40 [00:16<00:09,  1.54it/s]                                               {'loss': 0.156, 'grad_norm': 1.0446168184280396, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:09,  1.54it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.51it/s]                                               {'loss': 0.182, 'grad_norm': 4.5851826667785645, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:09,  1.51it/s] 68%|██████▊   | 27/40 [00:17<00:08,  1.50it/s]                                               {'loss': 0.0833, 'grad_norm': 1.6540182828903198, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:08,  1.50it/s] 70%|███████   | 28/40 [00:18<00:07,  1.54it/s]                                               {'loss': 0.6469, 'grad_norm': 1.502498745918274, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:07,  1.54it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.49it/s]                                               {'loss': 0.0332, 'grad_norm': 1.0179716348648071, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.49it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.50it/s]                                               {'loss': 0.1898, 'grad_norm': 2.93215274810791, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.50it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s]                                               {'loss': 0.1594, 'grad_norm': 3.412567377090454, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:06,  1.49it/s] 80%|████████  | 32/40 [00:21<00:05,  1.53it/s]                                               {'loss': 0.0649, 'grad_norm': 1.133435606956482, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.53it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.56it/s]                                               {'loss': 0.568, 'grad_norm': 1.1313056945800781, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.56it/s] 85%|████████▌ | 34/40 [00:22<00:04,  1.49it/s]                                               {'loss': 0.0389, 'grad_norm': 1.5598973035812378, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:04,  1.49it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.49it/s]                                               {'loss': 0.0834, 'grad_norm': 4.351546287536621, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.49it/s] 90%|█████████ | 36/40 [00:23<00:02,  1.50it/s]                                               {'loss': 0.1488, 'grad_norm': 0.5482916235923767, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:23<00:02,  1.50it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s]                                               {'loss': 0.0444, 'grad_norm': 0.9272676706314087, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.48it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.52it/s]                                               {'loss': 0.0354, 'grad_norm': 1.381645679473877, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.52it/s] 98%|█████████▊| 39/40 [00:25<00:00,  1.49it/s]                                               {'loss': 0.0218, 'grad_norm': 0.69510817527771, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:25<00:00,  1.49it/s]100%|██████████| 40/40 [00:26<00:00,  1.51it/s]                                               {'loss': 0.0347, 'grad_norm': 0.8687757849693298, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.51it/s]                                               {'train_runtime': 26.7223, 'train_samples_per_second': 23.763, 'train_steps_per_second': 1.497, 'train_loss': 0.7698392775841058, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.51it/s]100%|██████████| 40/40 [00:26<00:00,  1.50it/s]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.83it/s]                                              {'loss': 0.0412, 'grad_norm': 0.6885024309158325, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.83it/s]  5%|▌         | 2/40 [00:00<00:13,  2.91it/s]                                              {'loss': 0.1571, 'grad_norm': 3.678081750869751, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.91it/s]  8%|▊         | 3/40 [00:01<00:12,  2.96it/s]                                              {'loss': 0.1024, 'grad_norm': 3.688072443008423, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.96it/s] 10%|█         | 4/40 [00:01<00:12,  2.96it/s]                                              {'loss': 0.0168, 'grad_norm': 0.2624635696411133, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.96it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.94it/s]                                              {'loss': 0.0308, 'grad_norm': 0.9836360812187195, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.94it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.93it/s]                                              {'loss': 0.0257, 'grad_norm': 0.4994489252567291, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.93it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.91it/s]                                              {'loss': 0.0512, 'grad_norm': 1.3066288232803345, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.91it/s] 20%|██        | 8/40 [00:02<00:08,  3.72it/s]                                              {'loss': 0.0085, 'grad_norm': 0.3258494734764099, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:08,  3.72it/s] 22%|██▎       | 9/40 [00:02<00:09,  3.40it/s]                                              {'loss': 0.0039, 'grad_norm': 0.06905518472194672, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:09,  3.40it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.24it/s]                                               {'loss': 0.004, 'grad_norm': 0.0538325272500515, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.24it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.12it/s]                                               {'loss': 0.0121, 'grad_norm': 0.33627599477767944, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.12it/s] 30%|███       | 12/40 [00:03<00:09,  3.03it/s]                                               {'loss': 0.0086, 'grad_norm': 0.4220518469810486, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:09,  3.03it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.01it/s]                                               {'loss': 0.0053, 'grad_norm': 0.11252052336931229, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.01it/s] 35%|███▌      | 14/40 [00:04<00:10,  2.51it/s]                                               {'loss': 0.0061, 'grad_norm': 0.07652159035205841, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:10,  2.51it/s] 38%|███▊      | 15/40 [00:05<00:11,  2.11it/s]                                               {'loss': 0.0115, 'grad_norm': 0.16603749990463257, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:11,  2.11it/s]                                               {'loss': 0.0001, 'grad_norm': 0.00404738076031208, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:11,  2.11it/s] 42%|████▎     | 17/40 [00:06<00:10,  2.29it/s]                                               {'loss': 0.0062, 'grad_norm': 0.06664946675300598, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:10,  2.29it/s] 45%|████▌     | 18/40 [00:06<00:10,  2.03it/s]                                               {'loss': 0.0029, 'grad_norm': 0.03795710951089859, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:10,  2.03it/s] 48%|████▊     | 19/40 [00:07<00:11,  1.87it/s]                                               {'loss': 0.0034, 'grad_norm': 0.03547671064734459, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:11,  1.87it/s] 50%|█████     | 20/40 [00:08<00:11,  1.72it/s]                                               {'loss': 0.0024, 'grad_norm': 0.03600332885980606, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:11,  1.72it/s] 52%|█████▎    | 21/40 [00:08<00:11,  1.69it/s]                                               {'loss': 0.0035, 'grad_norm': 0.042836084961891174, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:11,  1.69it/s] 55%|█████▌    | 22/40 [00:09<00:11,  1.61it/s]                                               {'loss': 0.0032, 'grad_norm': 0.04972686618566513, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:11,  1.61it/s] 57%|█████▊    | 23/40 [00:10<00:11,  1.54it/s]                                               {'loss': 0.0019, 'grad_norm': 0.023521415889263153, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:11,  1.54it/s]                                               {'loss': 0.0, 'grad_norm': 2.038035972873331e-06, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:10,  1.54it/s] 62%|██████▎   | 25/40 [00:11<00:07,  1.91it/s]                                               {'loss': 0.0018, 'grad_norm': 0.021098842844367027, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:11<00:07,  1.77it/s]                                               {'loss': 0.0038, 'grad_norm': 0.04413055256009102, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:07,  1.77it/s] 68%|██████▊   | 27/40 [00:12<00:07,  1.70it/s]                                               {'loss': 0.0042, 'grad_norm': 0.04362594708800316, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:07,  1.70it/s] 70%|███████   | 28/40 [00:12<00:07,  1.68it/s]                                               {'loss': 0.0031, 'grad_norm': 0.039528753608465195, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:07,  1.68it/s] 72%|███████▎  | 29/40 [00:13<00:06,  1.59it/s]                                               {'loss': 0.0023, 'grad_norm': 0.029368089511990547, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:14<00:06,  1.58it/s]                                               {'loss': 0.002, 'grad_norm': 0.023818980902433395, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:14<00:06,  1.58it/s] 78%|███████▊  | 31/40 [00:15<00:05,  1.55it/s]                                               {'loss': 0.0025, 'grad_norm': 0.03338000178337097, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:05,  1.55it/s]                                               {'loss': 0.0008, 'grad_norm': 0.025903599336743355, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:15<00:05,  1.55it/s] 82%|████████▎ | 33/40 [00:15<00:03,  1.88it/s]                                               {'loss': 0.0023, 'grad_norm': 0.020109940320253372, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:15<00:03,  1.88it/s] 85%|████████▌ | 34/40 [00:16<00:03,  1.79it/s]                                               {'loss': 0.0027, 'grad_norm': 0.03757519647479057, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:16<00:03,  1.79it/s] 88%|████████▊ | 35/40 [00:17<00:02,  1.69it/s]                                               {'loss': 0.0025, 'grad_norm': 0.023689666762948036, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:17<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:17<00:02,  1.60it/s]                                               {'loss': 0.0016, 'grad_norm': 0.022013770416378975, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:17<00:02,  1.60it/s] 92%|█████████▎| 37/40 [00:18<00:01,  1.61it/s]                                               {'loss': 0.0023, 'grad_norm': 0.0233757346868515, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:18<00:01,  1.61it/s] 95%|█████████▌| 38/40 [00:19<00:01,  1.54it/s]                                               {'loss': 0.0028, 'grad_norm': 0.028220057487487793, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:19<00:01,  1.54it/s] 98%|█████████▊| 39/40 [00:19<00:00,  1.57it/s]                                               {'loss': 0.0072, 'grad_norm': 0.08858445286750793, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:19<00:00,  1.57it/s]                                               {'loss': 0.0013, 'grad_norm': 0.036815326660871506, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  1.57it/s]                                               {'train_runtime': 20.0968, 'train_samples_per_second': 28.114, 'train_steps_per_second': 1.99, 'train_loss': 0.013808297496507116, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.57it/s]100%|██████████| 40/40 [00:20<00:00,  1.99it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:21,  5.75it/s]  1%|          | 3/471 [00:00<02:06,  3.69it/s]  1%|          | 4/471 [00:01<02:17,  3.39it/s]  1%|          | 5/471 [00:01<02:21,  3.29it/s]  1%|▏         | 6/471 [00:01<02:37,  2.95it/s]  1%|▏         | 7/471 [00:02<02:37,  2.94it/s]  2%|▏         | 8/471 [00:02<02:30,  3.08it/s]  2%|▏         | 9/471 [00:02<02:41,  2.86it/s]  2%|▏         | 10/471 [00:03<02:43,  2.82it/s]  2%|▏         | 11/471 [00:03<02:39,  2.89it/s]  3%|▎         | 12/471 [00:03<02:40,  2.86it/s]  3%|▎         | 13/471 [00:04<02:46,  2.76it/s]  3%|▎         | 14/471 [00:04<02:40,  2.85it/s]  3%|▎         | 15/471 [00:04<02:29,  3.04it/s]  3%|▎         | 16/471 [00:05<02:40,  2.84it/s]  4%|▎         | 17/471 [00:05<02:41,  2.82it/s]  4%|▍         | 18/471 [00:05<02:36,  2.89it/s]  4%|▍         | 19/471 [00:06<02:37,  2.87it/s]  4%|▍         | 20/471 [00:06<02:43,  2.77it/s]  4%|▍         | 21/471 [00:07<02:38,  2.84it/s]  5%|▍         | 22/471 [00:07<02:36,  2.87it/s]  5%|▍         | 23/471 [00:07<02:44,  2.72it/s]  5%|▌         | 24/471 [00:08<02:38,  2.82it/s]  5%|▌         | 25/471 [00:08<02:33,  2.91it/s]  6%|▌         | 26/471 [00:08<02:42,  2.74it/s]  6%|▌         | 27/471 [00:09<02:39,  2.79it/s]  6%|▌         | 28/471 [00:09<02:30,  2.95it/s]  6%|▌         | 29/471 [00:09<02:39,  2.77it/s]  6%|▋         | 30/471 [00:10<02:40,  2.75it/s]  7%|▋         | 31/471 [00:10<02:34,  2.84it/s]  7%|▋         | 32/471 [00:10<02:34,  2.85it/s]  7%|▋         | 33/471 [00:11<02:39,  2.75it/s]  7%|▋         | 34/471 [00:11<02:33,  2.85it/s]  7%|▋         | 35/471 [00:12<02:31,  2.87it/s]  8%|▊         | 36/471 [00:12<02:39,  2.72it/s]  8%|▊         | 37/471 [00:12<02:34,  2.82it/s]  8%|▊         | 38/471 [00:13<02:26,  2.96it/s]  8%|▊         | 39/471 [00:13<02:05,  3.44it/s]  8%|▊         | 40/471 [00:13<01:52,  3.83it/s]  9%|▊         | 41/471 [00:13<01:43,  4.17it/s]  9%|▉         | 42/471 [00:13<01:36,  4.43it/s]  9%|▉         | 43/471 [00:14<01:31,  4.66it/s]  9%|▉         | 44/471 [00:14<01:28,  4.85it/s] 10%|▉         | 45/471 [00:14<01:25,  4.97it/s] 10%|▉         | 46/471 [00:14<01:23,  5.06it/s] 10%|▉         | 47/471 [00:14<01:22,  5.13it/s] 10%|█         | 48/471 [00:14<01:21,  5.19it/s] 10%|█         | 49/471 [00:15<01:20,  5.22it/s] 11%|█         | 50/471 [00:15<01:20,  5.24it/s] 11%|█         | 51/471 [00:15<01:19,  5.25it/s] 11%|█         | 52/471 [00:15<01:19,  5.26it/s] 11%|█▏        | 53/471 [00:15<01:19,  5.26it/s] 11%|█▏        | 54/471 [00:16<01:20,  5.20it/s] 12%|█▏        | 55/471 [00:16<01:20,  5.18it/s] 12%|█▏        | 56/471 [00:16<01:20,  5.18it/s] 12%|█▏        | 57/471 [00:16<01:19,  5.18it/s] 12%|█▏        | 58/471 [00:16<01:19,  5.19it/s] 13%|█▎        | 59/471 [00:17<01:18,  5.22it/s] 13%|█▎        | 60/471 [00:17<01:18,  5.23it/s] 13%|█▎        | 61/471 [00:17<01:20,  5.11it/s] 13%|█▎        | 62/471 [00:17<01:46,  3.86it/s] 13%|█▎        | 63/471 [00:18<01:58,  3.43it/s] 14%|█▎        | 64/471 [00:18<02:03,  3.31it/s] 14%|█▍        | 65/471 [00:18<02:08,  3.16it/s] 14%|█▍        | 66/471 [00:19<02:18,  2.93it/s] 14%|█▍        | 67/471 [00:19<02:15,  2.99it/s] 14%|█▍        | 68/471 [00:19<02:13,  3.02it/s] 15%|█▍        | 69/471 [00:20<02:22,  2.82it/s] 15%|█▍        | 70/471 [00:20<02:19,  2.88it/s] 15%|█▌        | 71/471 [00:20<02:14,  2.98it/s] 15%|█▌        | 72/471 [00:21<02:22,  2.79it/s] 15%|█▌        | 73/471 [00:21<02:22,  2.80it/s] 16%|█▌        | 74/471 [00:22<02:15,  2.92it/s] 16%|█▌        | 75/471 [00:22<02:19,  2.83it/s] 16%|█▌        | 76/471 [00:22<02:23,  2.76it/s] 16%|█▋        | 77/471 [00:23<02:18,  2.85it/s] 17%|█▋        | 78/471 [00:23<02:17,  2.86it/s] 17%|█▋        | 79/471 [00:23<02:23,  2.73it/s] 17%|█▋        | 80/471 [00:24<02:17,  2.84it/s] 17%|█▋        | 81/471 [00:24<02:15,  2.88it/s] 17%|█▋        | 82/471 [00:24<02:22,  2.73it/s] 18%|█▊        | 83/471 [00:25<02:17,  2.81it/s] 18%|█▊        | 84/471 [00:25<02:11,  2.94it/s] 18%|█▊        | 85/471 [00:25<02:13,  2.89it/s] 18%|█▊        | 86/471 [00:26<02:18,  2.78it/s] 18%|█▊        | 87/471 [00:26<02:13,  2.87it/s] 19%|█▊        | 88/471 [00:27<02:11,  2.91it/s] 19%|█▉        | 89/471 [00:27<02:19,  2.74it/s] 19%|█▉        | 90/471 [00:27<02:15,  2.82it/s] 19%|█▉        | 91/471 [00:28<02:10,  2.92it/s] 20%|█▉        | 92/471 [00:28<02:17,  2.75it/s] 20%|█▉        | 93/471 [00:28<02:14,  2.80it/s] 20%|█▉        | 94/471 [00:29<02:06,  2.98it/s] 20%|██        | 95/471 [00:29<02:14,  2.80it/s] 20%|██        | 96/471 [00:29<02:15,  2.77it/s] 21%|██        | 97/471 [00:30<02:11,  2.85it/s] 21%|██        | 98/471 [00:30<02:11,  2.84it/s] 21%|██        | 99/471 [00:30<02:15,  2.75it/s] 21%|██        | 100/471 [00:31<02:10,  2.84it/s] 21%|██▏       | 101/471 [00:31<02:08,  2.89it/s] 22%|██▏       | 102/471 [00:32<02:15,  2.71it/s] 22%|██▏       | 103/471 [00:32<02:10,  2.81it/s] 22%|██▏       | 104/471 [00:32<02:01,  3.01it/s] 22%|██▏       | 105/471 [00:33<02:10,  2.80it/s] 23%|██▎       | 106/471 [00:33<02:10,  2.79it/s] 23%|██▎       | 107/471 [00:33<02:06,  2.87it/s] 23%|██▎       | 108/471 [00:34<01:57,  3.10it/s] 23%|██▎       | 109/471 [00:34<02:06,  2.86it/s] 23%|██▎       | 110/471 [00:34<02:06,  2.86it/s] 24%|██▎       | 111/471 [00:35<02:00,  2.98it/s] 24%|██▍       | 112/471 [00:35<02:00,  2.97it/s] 24%|██▍       | 113/471 [00:35<02:07,  2.81it/s] 24%|██▍       | 114/471 [00:36<02:04,  2.88it/s] 24%|██▍       | 115/471 [00:36<02:00,  2.95it/s] 25%|██▍       | 116/471 [00:36<02:08,  2.76it/s] 25%|██▍       | 117/471 [00:37<02:05,  2.83it/s] 25%|██▌       | 118/471 [00:37<01:57,  3.00it/s] 25%|██▌       | 119/471 [00:37<02:05,  2.80it/s] 25%|██▌       | 120/471 [00:38<02:05,  2.79it/s] 26%|██▌       | 121/471 [00:38<02:01,  2.88it/s] 26%|██▌       | 122/471 [00:38<02:01,  2.88it/s] 26%|██▌       | 123/471 [00:39<02:05,  2.77it/s] 26%|██▋       | 124/471 [00:39<02:01,  2.85it/s] 27%|██▋       | 125/471 [00:39<01:58,  2.92it/s] 27%|██▋       | 126/471 [00:40<02:05,  2.75it/s] 27%|██▋       | 127/471 [00:40<02:01,  2.83it/s] 27%|██▋       | 128/471 [00:41<01:55,  2.98it/s] 27%|██▋       | 129/471 [00:41<02:02,  2.79it/s] 28%|██▊       | 130/471 [00:41<02:02,  2.78it/s] 28%|██▊       | 131/471 [00:42<01:57,  2.90it/s] 28%|██▊       | 132/471 [00:42<01:50,  3.08it/s] 28%|██▊       | 133/471 [00:42<01:58,  2.85it/s] 28%|██▊       | 134/471 [00:43<01:58,  2.85it/s] 29%|██▊       | 135/471 [00:43<01:52,  2.99it/s] 29%|██▉       | 136/471 [00:43<01:55,  2.89it/s] 29%|██▉       | 137/471 [00:44<01:59,  2.79it/s] 29%|██▉       | 138/471 [00:44<01:56,  2.87it/s] 30%|██▉       | 139/471 [00:44<01:55,  2.89it/s] 30%|██▉       | 140/471 [00:45<02:00,  2.75it/s] 30%|██▉       | 141/471 [00:45<01:56,  2.83it/s] 30%|███       | 142/471 [00:45<01:53,  2.89it/s] 30%|███       | 143/471 [00:46<02:00,  2.72it/s] 31%|███       | 144/471 [00:46<01:56,  2.80it/s] 31%|███       | 145/471 [00:46<01:51,  2.94it/s] 31%|███       | 146/471 [00:47<01:58,  2.75it/s] 31%|███       | 147/471 [00:47<01:56,  2.78it/s] 31%|███▏      | 148/471 [00:48<01:49,  2.94it/s] 32%|███▏      | 149/471 [00:48<01:50,  2.91it/s] 32%|███▏      | 150/471 [00:48<01:55,  2.78it/s] 32%|███▏      | 151/471 [00:49<01:51,  2.86it/s] 32%|███▏      | 152/471 [00:49<01:50,  2.89it/s] 32%|███▏      | 153/471 [00:49<01:56,  2.73it/s] 33%|███▎      | 154/471 [00:50<01:52,  2.82it/s] 33%|███▎      | 155/471 [00:50<01:47,  2.95it/s] 33%|███▎      | 156/471 [00:50<01:47,  2.94it/s] 33%|███▎      | 157/471 [00:51<01:51,  2.81it/s] 34%|███▎      | 158/471 [00:51<01:48,  2.89it/s] 34%|███▍      | 159/471 [00:51<01:46,  2.92it/s] 34%|███▍      | 160/471 [00:52<01:53,  2.75it/s] 34%|███▍      | 161/471 [00:52<01:49,  2.82it/s] 34%|███▍      | 162/471 [00:52<01:46,  2.91it/s] 35%|███▍      | 163/471 [00:53<01:52,  2.74it/s] 35%|███▍      | 164/471 [00:53<01:49,  2.79it/s] 35%|███▌      | 165/471 [00:54<01:44,  2.94it/s] 35%|███▌      | 166/471 [00:54<01:50,  2.77it/s] 35%|███▌      | 167/471 [00:54<01:50,  2.75it/s] 36%|███▌      | 168/471 [00:55<01:47,  2.83it/s] 36%|███▌      | 169/471 [00:55<01:47,  2.82it/s] 36%|███▌      | 170/471 [00:55<01:50,  2.73it/s] 36%|███▋      | 171/471 [00:56<01:46,  2.83it/s] 37%|███▋      | 172/471 [00:56<01:43,  2.88it/s] 37%|███▋      | 173/471 [00:56<01:49,  2.72it/s] 37%|███▋      | 174/471 [00:57<01:45,  2.82it/s] 37%|███▋      | 175/471 [00:57<01:41,  2.91it/s] 37%|███▋      | 176/471 [00:58<01:47,  2.75it/s] 38%|███▊      | 177/471 [00:58<01:44,  2.80it/s] 38%|███▊      | 178/471 [00:58<01:39,  2.96it/s] 38%|███▊      | 179/471 [00:58<01:28,  3.31it/s] 38%|███▊      | 180/471 [00:59<01:18,  3.73it/s] 38%|███▊      | 181/471 [00:59<01:11,  4.07it/s] 39%|███▊      | 182/471 [00:59<01:06,  4.36it/s] 39%|███▉      | 183/471 [00:59<01:02,  4.60it/s] 39%|███▉      | 184/471 [00:59<00:59,  4.80it/s] 39%|███▉      | 185/471 [00:59<00:57,  4.94it/s] 39%|███▉      | 186/471 [01:00<00:56,  5.04it/s] 40%|███▉      | 187/471 [01:00<00:55,  5.09it/s] 40%|███▉      | 188/471 [01:00<00:55,  5.14it/s] 40%|████      | 189/471 [01:00<00:55,  5.12it/s] 40%|████      | 190/471 [01:00<00:54,  5.13it/s] 41%|████      | 191/471 [01:01<00:54,  5.14it/s] 41%|████      | 192/471 [01:01<00:53,  5.17it/s] 41%|████      | 193/471 [01:01<00:53,  5.23it/s] 41%|████      | 194/471 [01:01<00:53,  5.22it/s] 41%|████▏     | 195/471 [01:01<00:53,  5.16it/s] 42%|████▏     | 196/471 [01:02<01:04,  4.24it/s] 42%|████▏     | 197/471 [01:02<01:17,  3.54it/s] 42%|████▏     | 198/471 [01:02<01:20,  3.39it/s] 42%|████▏     | 199/471 [01:03<01:22,  3.31it/s] 42%|████▏     | 200/471 [01:03<01:30,  2.98it/s] 43%|████▎     | 201/471 [01:04<01:30,  2.98it/s] 43%|████▎     | 202/471 [01:04<01:26,  3.10it/s] 43%|████▎     | 203/471 [01:04<01:33,  2.87it/s] 43%|████▎     | 204/471 [01:05<01:34,  2.82it/s] 44%|████▎     | 205/471 [01:05<01:31,  2.91it/s] 44%|████▎     | 206/471 [01:05<01:31,  2.88it/s] 44%|████▍     | 207/471 [01:06<01:35,  2.76it/s] 44%|████▍     | 208/471 [01:06<01:31,  2.86it/s] 44%|████▍     | 209/471 [01:06<01:30,  2.90it/s] 45%|████▍     | 210/471 [01:07<01:35,  2.74it/s] 45%|████▍     | 211/471 [01:07<01:31,  2.83it/s] 45%|████▌     | 212/471 [01:07<01:28,  2.92it/s] 45%|████▌     | 213/471 [01:08<01:33,  2.76it/s] 45%|████▌     | 214/471 [01:08<01:31,  2.81it/s] 46%|████▌     | 215/471 [01:08<01:27,  2.93it/s] 46%|████▌     | 216/471 [01:09<01:32,  2.76it/s] 46%|████▌     | 217/471 [01:09<01:32,  2.76it/s] 46%|████▋     | 218/471 [01:10<01:29,  2.84it/s] 46%|████▋     | 219/471 [01:10<01:24,  2.97it/s] 47%|████▋     | 220/471 [01:10<01:30,  2.77it/s] 47%|████▋     | 221/471 [01:11<01:28,  2.82it/s] 47%|████▋     | 222/471 [01:11<01:24,  2.96it/s] 47%|████▋     | 223/471 [01:11<01:28,  2.79it/s] 48%|████▊     | 224/471 [01:12<01:28,  2.78it/s] 48%|████▊     | 225/471 [01:12<01:25,  2.87it/s] 48%|████▊     | 226/471 [01:12<01:26,  2.84it/s] 48%|████▊     | 227/471 [01:13<01:28,  2.75it/s] 48%|████▊     | 228/471 [01:13<01:25,  2.85it/s] 49%|████▊     | 229/471 [01:13<01:23,  2.88it/s] 49%|████▉     | 230/471 [01:14<01:28,  2.73it/s] 49%|████▉     | 231/471 [01:14<01:24,  2.83it/s] 49%|████▉     | 232/471 [01:14<01:21,  2.94it/s] 49%|████▉     | 233/471 [01:15<01:26,  2.76it/s] 50%|████▉     | 234/471 [01:15<01:25,  2.79it/s] 50%|████▉     | 235/471 [01:16<01:20,  2.94it/s] 50%|█████     | 236/471 [01:16<01:24,  2.78it/s] 50%|█████     | 237/471 [01:16<01:24,  2.75it/s] 51%|█████     | 238/471 [01:17<01:21,  2.84it/s] 51%|█████     | 239/471 [01:17<01:21,  2.83it/s] 51%|█████     | 240/471 [01:17<01:24,  2.73it/s] 51%|█████     | 241/471 [01:18<01:21,  2.83it/s] 51%|█████▏    | 242/471 [01:18<01:16,  3.00it/s] 52%|█████▏    | 243/471 [01:18<01:21,  2.80it/s] 52%|█████▏    | 244/471 [01:19<01:21,  2.79it/s] 52%|█████▏    | 245/471 [01:19<01:18,  2.90it/s] 52%|█████▏    | 246/471 [01:19<01:18,  2.85it/s] 52%|█████▏    | 247/471 [01:20<01:21,  2.76it/s] 53%|█████▎    | 248/471 [01:20<01:18,  2.84it/s] 53%|█████▎    | 249/471 [01:20<01:17,  2.85it/s] 53%|█████▎    | 250/471 [01:21<01:21,  2.72it/s] 53%|█████▎    | 251/471 [01:21<01:18,  2.81it/s] 54%|█████▎    | 252/471 [01:22<01:16,  2.88it/s] 54%|█████▎    | 253/471 [01:22<01:20,  2.71it/s] 54%|█████▍    | 254/471 [01:22<01:17,  2.80it/s] 54%|█████▍    | 255/471 [01:23<01:11,  3.03it/s] 54%|█████▍    | 256/471 [01:23<01:16,  2.82it/s] 55%|█████▍    | 257/471 [01:23<01:17,  2.76it/s] 55%|█████▍    | 258/471 [01:24<01:14,  2.87it/s] 55%|█████▍    | 259/471 [01:24<01:13,  2.90it/s] 55%|█████▌    | 260/471 [01:24<01:17,  2.74it/s] 55%|█████▌    | 261/471 [01:25<01:15,  2.80it/s] 56%|█████▌    | 262/471 [01:25<01:15,  2.77it/s] 56%|█████▌    | 263/471 [01:26<01:17,  2.70it/s] 56%|█████▌    | 264/471 [01:26<01:14,  2.79it/s] 56%|█████▋    | 265/471 [01:26<01:08,  3.00it/s] 56%|█████▋    | 266/471 [01:27<01:11,  2.87it/s] 57%|█████▋    | 267/471 [01:27<01:13,  2.79it/s] 57%|█████▋    | 268/471 [01:27<01:11,  2.86it/s] 57%|█████▋    | 269/471 [01:28<01:10,  2.88it/s] 57%|█████▋    | 270/471 [01:28<01:13,  2.74it/s] 58%|█████▊    | 271/471 [01:28<01:10,  2.83it/s] 58%|█████▊    | 272/471 [01:29<01:08,  2.91it/s] 58%|█████▊    | 273/471 [01:29<01:12,  2.73it/s] 58%|█████▊    | 274/471 [01:29<01:10,  2.80it/s] 58%|█████▊    | 275/471 [01:30<01:04,  3.03it/s] 59%|█████▊    | 276/471 [01:30<01:07,  2.91it/s] 59%|█████▉    | 277/471 [01:30<01:09,  2.79it/s] 59%|█████▉    | 278/471 [01:31<01:07,  2.87it/s] 59%|█████▉    | 279/471 [01:31<01:02,  3.06it/s] 59%|█████▉    | 280/471 [01:31<01:08,  2.81it/s] 60%|█████▉    | 281/471 [01:32<01:06,  2.86it/s] 60%|█████▉    | 282/471 [01:32<01:03,  2.98it/s] 60%|██████    | 283/471 [01:32<01:07,  2.79it/s] 60%|██████    | 284/471 [01:33<01:07,  2.79it/s] 61%|██████    | 285/471 [01:33<01:04,  2.90it/s] 61%|██████    | 286/471 [01:34<01:06,  2.80it/s] 61%|██████    | 287/471 [01:34<01:07,  2.74it/s] 61%|██████    | 288/471 [01:34<01:04,  2.83it/s] 61%|██████▏   | 289/471 [01:34<00:58,  3.13it/s] 62%|██████▏   | 290/471 [01:35<01:01,  2.93it/s] 62%|██████▏   | 291/471 [01:35<01:03,  2.84it/s] 62%|██████▏   | 292/471 [01:36<01:01,  2.91it/s] 62%|██████▏   | 293/471 [01:36<01:01,  2.89it/s] 62%|██████▏   | 294/471 [01:36<01:03,  2.77it/s] 63%|██████▎   | 295/471 [01:37<01:01,  2.86it/s] 63%|██████▎   | 296/471 [01:37<01:00,  2.91it/s] 63%|██████▎   | 297/471 [01:37<01:03,  2.73it/s] 63%|██████▎   | 298/471 [01:38<01:01,  2.83it/s] 63%|██████▎   | 299/471 [01:38<00:58,  2.92it/s] 64%|██████▎   | 300/471 [01:38<01:02,  2.75it/s] 64%|██████▍   | 301/471 [01:39<01:00,  2.79it/s] 64%|██████▍   | 302/471 [01:39<00:57,  2.93it/s] 64%|██████▍   | 303/471 [01:40<01:00,  2.76it/s] 65%|██████▍   | 304/471 [01:40<01:00,  2.75it/s] 65%|██████▍   | 305/471 [01:40<00:58,  2.84it/s] 65%|██████▍   | 306/471 [01:41<00:58,  2.83it/s] 65%|██████▌   | 307/471 [01:41<01:00,  2.73it/s] 65%|██████▌   | 308/471 [01:41<00:58,  2.81it/s] 66%|██████▌   | 309/471 [01:42<00:56,  2.86it/s] 66%|██████▌   | 310/471 [01:42<00:59,  2.70it/s] 66%|██████▌   | 311/471 [01:42<00:57,  2.80it/s] 66%|██████▌   | 312/471 [01:43<00:54,  2.94it/s] 66%|██████▋   | 313/471 [01:43<00:46,  3.43it/s] 67%|██████▋   | 314/471 [01:43<00:41,  3.82it/s] 67%|██████▋   | 315/471 [01:43<00:37,  4.17it/s] 67%|██████▋   | 316/471 [01:43<00:34,  4.45it/s] 67%|██████▋   | 317/471 [01:44<00:32,  4.67it/s] 68%|██████▊   | 318/471 [01:44<00:31,  4.85it/s] 68%|██████▊   | 319/471 [01:44<00:30,  4.98it/s] 68%|██████▊   | 320/471 [01:44<00:30,  4.99it/s] 68%|██████▊   | 321/471 [01:44<00:29,  5.05it/s] 68%|██████▊   | 322/471 [01:45<00:29,  5.08it/s] 69%|██████▊   | 323/471 [01:45<00:29,  5.09it/s] 69%|██████▉   | 324/471 [01:45<00:28,  5.14it/s] 69%|██████▉   | 325/471 [01:45<00:28,  5.13it/s] 69%|██████▉   | 326/471 [01:45<00:34,  4.26it/s] 69%|██████▉   | 327/471 [01:46<00:40,  3.53it/s] 70%|██████▉   | 328/471 [01:46<00:42,  3.37it/s] 70%|██████▉   | 329/471 [01:47<00:43,  3.29it/s] 70%|███████   | 330/471 [01:47<00:47,  2.98it/s] 70%|███████   | 331/471 [01:47<00:47,  2.96it/s] 70%|███████   | 332/471 [01:48<00:45,  3.08it/s] 71%|███████   | 333/471 [01:48<00:48,  2.86it/s] 71%|███████   | 334/471 [01:48<00:48,  2.80it/s] 71%|███████   | 335/471 [01:49<00:47,  2.86it/s] 71%|███████▏  | 336/471 [01:49<00:47,  2.86it/s] 72%|███████▏  | 337/471 [01:49<00:48,  2.76it/s] 72%|███████▏  | 338/471 [01:50<00:46,  2.84it/s] 72%|███████▏  | 339/471 [01:50<00:45,  2.88it/s] 72%|███████▏  | 340/471 [01:51<00:48,  2.73it/s] 72%|███████▏  | 341/471 [01:51<00:46,  2.82it/s] 73%|███████▎  | 342/471 [01:51<00:44,  2.92it/s] 73%|███████▎  | 343/471 [01:52<00:46,  2.75it/s] 73%|███████▎  | 344/471 [01:52<00:45,  2.80it/s] 73%|███████▎  | 345/471 [01:52<00:42,  2.94it/s] 73%|███████▎  | 346/471 [01:53<00:44,  2.78it/s] 74%|███████▎  | 347/471 [01:53<00:44,  2.76it/s] 74%|███████▍  | 348/471 [01:53<00:43,  2.85it/s] 74%|███████▍  | 349/471 [01:54<00:40,  2.99it/s] 74%|███████▍  | 350/471 [01:54<00:43,  2.78it/s] 75%|███████▍  | 351/471 [01:54<00:42,  2.84it/s] 75%|███████▍  | 352/471 [01:55<00:39,  2.99it/s] 75%|███████▍  | 353/471 [01:55<00:42,  2.80it/s] 75%|███████▌  | 354/471 [01:55<00:42,  2.77it/s] 75%|███████▌  | 355/471 [01:56<00:40,  2.86it/s] 76%|███████▌  | 356/471 [01:56<00:40,  2.85it/s] 76%|███████▌  | 357/471 [01:56<00:41,  2.75it/s] 76%|███████▌  | 358/471 [01:57<00:39,  2.85it/s] 76%|███████▌  | 359/471 [01:57<00:38,  2.87it/s] 76%|███████▋  | 360/471 [01:58<00:40,  2.72it/s] 77%|███████▋  | 361/471 [01:58<00:39,  2.81it/s] 77%|███████▋  | 362/471 [01:58<00:37,  2.89it/s] 77%|███████▋  | 363/471 [01:59<00:39,  2.72it/s] 77%|███████▋  | 364/471 [01:59<00:38,  2.77it/s] 77%|███████▋  | 365/471 [01:59<00:36,  2.90it/s] 78%|███████▊  | 366/471 [02:00<00:38,  2.74it/s] 78%|███████▊  | 367/471 [02:00<00:38,  2.73it/s] 78%|███████▊  | 368/471 [02:00<00:36,  2.82it/s] 78%|███████▊  | 369/471 [02:01<00:35,  2.85it/s] 79%|███████▊  | 370/471 [02:01<00:36,  2.73it/s] 79%|███████▉  | 371/471 [02:01<00:35,  2.81it/s] 79%|███████▉  | 372/471 [02:02<00:32,  3.02it/s] 79%|███████▉  | 373/471 [02:02<00:34,  2.82it/s] 79%|███████▉  | 374/471 [02:03<00:34,  2.79it/s] 80%|███████▉  | 375/471 [02:03<00:33,  2.87it/s] 80%|███████▉  | 376/471 [02:03<00:33,  2.85it/s] 80%|████████  | 377/471 [02:04<00:34,  2.73it/s] 80%|████████  | 378/471 [02:04<00:32,  2.83it/s] 80%|████████  | 379/471 [02:04<00:31,  2.88it/s] 81%|████████  | 380/471 [02:05<00:33,  2.70it/s] 81%|████████  | 381/471 [02:05<00:32,  2.81it/s] 81%|████████  | 382/471 [02:05<00:29,  2.98it/s] 81%|████████▏ | 383/471 [02:06<00:31,  2.78it/s] 82%|████████▏ | 384/471 [02:06<00:31,  2.77it/s] 82%|████████▏ | 385/471 [02:06<00:29,  2.88it/s] 82%|████████▏ | 386/471 [02:07<00:30,  2.78it/s] 82%|████████▏ | 387/471 [02:07<00:30,  2.73it/s] 82%|████████▏ | 388/471 [02:08<00:29,  2.82it/s] 83%|████████▎ | 389/471 [02:08<00:28,  2.84it/s] 83%|████████▎ | 390/471 [02:08<00:29,  2.71it/s] 83%|████████▎ | 391/471 [02:09<00:28,  2.81it/s] 83%|████████▎ | 392/471 [02:09<00:27,  2.87it/s] 83%|████████▎ | 393/471 [02:09<00:28,  2.71it/s] 84%|████████▎ | 394/471 [02:10<00:27,  2.80it/s] 84%|████████▍ | 395/471 [02:10<00:25,  2.93it/s] 84%|████████▍ | 396/471 [02:10<00:25,  2.89it/s] 84%|████████▍ | 397/471 [02:11<00:26,  2.77it/s] 85%|████████▍ | 398/471 [02:11<00:25,  2.86it/s] 85%|████████▍ | 399/471 [02:11<00:25,  2.88it/s] 85%|████████▍ | 400/471 [02:12<00:26,  2.71it/s] 85%|████████▌ | 401/471 [02:12<00:24,  2.80it/s] 85%|████████▌ | 402/471 [02:12<00:23,  2.89it/s] 86%|████████▌ | 403/471 [02:13<00:24,  2.72it/s] 86%|████████▌ | 404/471 [02:13<00:24,  2.77it/s] 86%|████████▌ | 405/471 [02:14<00:22,  2.92it/s] 86%|████████▌ | 406/471 [02:14<00:23,  2.75it/s] 86%|████████▋ | 407/471 [02:14<00:23,  2.74it/s] 87%|████████▋ | 408/471 [02:15<00:22,  2.83it/s] 87%|████████▋ | 409/471 [02:15<00:21,  2.82it/s] 87%|████████▋ | 410/471 [02:15<00:22,  2.72it/s] 87%|████████▋ | 411/471 [02:16<00:21,  2.79it/s] 87%|████████▋ | 412/471 [02:16<00:20,  2.83it/s] 88%|████████▊ | 413/471 [02:16<00:21,  2.69it/s] 88%|████████▊ | 414/471 [02:17<00:20,  2.79it/s] 88%|████████▊ | 415/471 [02:17<00:19,  2.86it/s] 88%|████████▊ | 416/471 [02:18<00:20,  2.68it/s] 89%|████████▊ | 417/471 [02:18<00:19,  2.76it/s] 89%|████████▊ | 418/471 [02:18<00:18,  2.90it/s] 89%|████████▉ | 419/471 [02:19<00:17,  2.91it/s] 89%|████████▉ | 420/471 [02:19<00:18,  2.75it/s] 89%|████████▉ | 421/471 [02:19<00:17,  2.83it/s] 90%|████████▉ | 422/471 [02:20<00:16,  2.89it/s] 90%|████████▉ | 423/471 [02:20<00:17,  2.72it/s] 90%|█████████ | 424/471 [02:20<00:16,  2.79it/s] 90%|█████████ | 425/471 [02:21<00:15,  2.91it/s] 90%|█████████ | 426/471 [02:21<00:16,  2.73it/s] 91%|█████████ | 427/471 [02:21<00:16,  2.75it/s] 91%|█████████ | 428/471 [02:22<00:14,  2.87it/s] 91%|█████████ | 429/471 [02:22<00:15,  2.78it/s] 91%|█████████▏| 430/471 [02:23<00:15,  2.72it/s] 92%|█████████▏| 431/471 [02:23<00:14,  2.81it/s] 92%|█████████▏| 432/471 [02:23<00:13,  2.84it/s] 92%|█████████▏| 433/471 [02:24<00:14,  2.71it/s] 92%|█████████▏| 434/471 [02:24<00:13,  2.79it/s] 92%|█████████▏| 435/471 [02:24<00:12,  2.85it/s] 93%|█████████▎| 436/471 [02:25<00:13,  2.69it/s] 93%|█████████▎| 437/471 [02:25<00:12,  2.77it/s] 93%|█████████▎| 438/471 [02:25<00:11,  2.89it/s] 93%|█████████▎| 439/471 [02:26<00:11,  2.73it/s] 93%|█████████▎| 440/471 [02:26<00:11,  2.76it/s] 94%|█████████▎| 441/471 [02:26<00:10,  2.90it/s] 94%|█████████▍| 442/471 [02:27<00:08,  3.24it/s] 94%|█████████▍| 443/471 [02:27<00:07,  3.66it/s] 94%|█████████▍| 444/471 [02:27<00:06,  4.00it/s] 94%|█████████▍| 445/471 [02:27<00:06,  4.29it/s] 95%|█████████▍| 446/471 [02:27<00:05,  4.54it/s] 95%|█████████▍| 447/471 [02:28<00:05,  4.74it/s] 95%|█████████▌| 448/471 [02:28<00:04,  4.90it/s] 95%|█████████▌| 449/471 [02:28<00:04,  5.00it/s] 96%|█████████▌| 450/471 [02:28<00:04,  5.05it/s] 96%|█████████▌| 451/471 [02:28<00:03,  5.11it/s] 96%|█████████▌| 452/471 [02:29<00:03,  5.15it/s] 96%|█████████▌| 453/471 [02:29<00:03,  5.16it/s] 96%|█████████▋| 454/471 [02:29<00:03,  5.18it/s] 97%|█████████▋| 455/471 [02:29<00:03,  5.18it/s] 97%|█████████▋| 456/471 [02:29<00:02,  5.20it/s] 97%|█████████▋| 457/471 [02:30<00:02,  5.20it/s] 97%|█████████▋| 458/471 [02:30<00:02,  5.22it/s] 97%|█████████▋| 459/471 [02:30<00:02,  5.22it/s] 98%|█████████▊| 460/471 [02:30<00:02,  5.17it/s] 98%|█████████▊| 461/471 [02:30<00:01,  5.15it/s] 98%|█████████▊| 462/471 [02:30<00:01,  5.15it/s] 98%|█████████▊| 463/471 [02:31<00:01,  5.14it/s] 99%|█████████▊| 464/471 [02:31<00:01,  5.19it/s] 99%|█████████▊| 465/471 [02:31<00:01,  5.16it/s] 99%|█████████▉| 466/471 [02:31<00:01,  4.33it/s] 99%|█████████▉| 467/471 [02:32<00:01,  3.53it/s] 99%|█████████▉| 468/471 [02:32<00:00,  3.36it/s]100%|█████████▉| 469/471 [02:32<00:00,  3.29it/s]100%|█████████▉| 470/471 [02:33<00:00,  2.96it/s]100%|██████████| 471/471 [02:33<00:00,  3.13it/s]100%|██████████| 471/471 [02:33<00:00,  3.07it/s]
{'eval_loss': 4.098967552185059, 'eval_model_preparation_time': 0.0053, 'eval_acc': 0.2261019649495486, 'eval_runtime': 153.9537, 'eval_samples_per_second': 48.924, 'eval_steps_per_second': 3.059}
ROUND:9
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.50it/s]                                              {'loss': 2.302, 'grad_norm': 5.833338260650635, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.50it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]                                              {'loss': 2.8608, 'grad_norm': 9.82258415222168, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:02<00:24,  1.50it/s]                                              {'loss': 1.9284, 'grad_norm': 10.85079288482666, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s]                                              {'loss': 1.8127, 'grad_norm': 14.80526351928711, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.42it/s]                                              {'loss': 1.4743, 'grad_norm': 15.07240104675293, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.42it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s]                                              {'loss': 1.3547, 'grad_norm': 12.190223693847656, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s]                                              {'loss': 2.4865, 'grad_norm': 17.131803512573242, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s]                                              {'loss': 2.4705, 'grad_norm': 68.83854675292969, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.82it/s]                                              {'loss': 1.189, 'grad_norm': 10.20161247253418, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.82it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.79it/s]                                               {'loss': 1.2614, 'grad_norm': 15.969493865966797, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.79it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.66it/s]                                               {'loss': 0.344, 'grad_norm': 4.232731342315674, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.66it/s] 30%|███       | 12/40 [00:07<00:17,  1.64it/s]                                               {'loss': 0.3027, 'grad_norm': 9.335538864135742, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.64it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.7872, 'grad_norm': 8.405670166015625, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.51it/s]                                               {'loss': 0.6096, 'grad_norm': 8.691603660583496, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.51it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.56it/s]                                               {'loss': 0.499, 'grad_norm': 4.746501445770264, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.56it/s]                                               {'loss': 0.3868, 'grad_norm': 13.739577293395996, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.56it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.7258, 'grad_norm': 5.167963981628418, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.75it/s]                                               {'loss': 0.3382, 'grad_norm': 6.970688819885254, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.75it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.71it/s]                                               {'loss': 0.4111, 'grad_norm': 6.253495693206787, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.71it/s] 50%|█████     | 20/40 [00:12<00:12,  1.60it/s]                                               {'loss': 0.1999, 'grad_norm': 2.5611038208007812, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.60it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s]                                               {'loss': 0.1684, 'grad_norm': 4.698432445526123, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.54it/s]                                               {'loss': 0.3202, 'grad_norm': 5.158275604248047, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.54it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.54it/s]                                               {'loss': 0.4227, 'grad_norm': 6.232266426086426, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.54it/s] 60%|██████    | 24/40 [00:14<00:07,  2.04it/s]                                               {'loss': 0.1646, 'grad_norm': 13.585986137390137, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:07,  2.04it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.93it/s]                                               {'loss': 0.2815, 'grad_norm': 4.902697563171387, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.93it/s] 65%|██████▌   | 26/40 [00:15<00:08,  1.70it/s]                                               {'loss': 0.1179, 'grad_norm': 2.349600076675415, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:08,  1.70it/s] 68%|██████▊   | 27/40 [00:16<00:08,  1.62it/s]                                               {'loss': 0.0872, 'grad_norm': 1.8962856531143188, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:08,  1.62it/s] 70%|███████   | 28/40 [00:17<00:07,  1.57it/s]                                               {'loss': 0.0555, 'grad_norm': 1.0061448812484741, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.57it/s] 72%|███████▎  | 29/40 [00:17<00:07,  1.51it/s]                                               {'loss': 0.1618, 'grad_norm': 2.909519910812378, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:07,  1.51it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.51it/s]                                               {'loss': 0.2775, 'grad_norm': 0.7964377403259277, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.51it/s] 78%|███████▊  | 31/40 [00:19<00:06,  1.49it/s]                                               {'loss': 0.1265, 'grad_norm': 1.122168779373169, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:06,  1.49it/s] 80%|████████  | 32/40 [00:19<00:04,  1.96it/s]                                               {'loss': 0.0005, 'grad_norm': 0.031229883432388306, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:04,  1.96it/s] 82%|████████▎ | 33/40 [00:20<00:04,  1.72it/s]                                               {'loss': 0.0379, 'grad_norm': 1.2921011447906494, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.61it/s]                                               {'loss': 0.2606, 'grad_norm': 0.6601591110229492, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.61it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.63it/s]                                               {'loss': 0.122, 'grad_norm': 2.7303149700164795, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.63it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.57it/s]                                               {'loss': 0.129, 'grad_norm': 4.361917495727539, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.57it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.61it/s]                                               {'loss': 0.1453, 'grad_norm': 2.069662570953369, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.61it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.52it/s]                                               {'loss': 0.0288, 'grad_norm': 0.5914379358291626, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.52it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]                                               {'loss': 0.0663, 'grad_norm': 1.9193286895751953, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]100%|██████████| 40/40 [00:24<00:00,  2.03it/s]                                               {'loss': 0.0014, 'grad_norm': 0.08053155243396759, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.03it/s]                                               {'train_runtime': 24.5261, 'train_samples_per_second': 23.037, 'train_steps_per_second': 1.631, 'train_loss': 0.6680053137519281, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.03it/s]100%|██████████| 40/40 [00:24<00:00,  1.63it/s]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.99it/s]                                              {'loss': 4.6645, 'grad_norm': 10.677119255065918, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.99it/s]  5%|▌         | 2/40 [00:00<00:12,  2.95it/s]                                              {'loss': 2.8733, 'grad_norm': 10.233404159545898, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.95it/s]  8%|▊         | 3/40 [00:01<00:12,  2.91it/s]                                              {'loss': 3.7048, 'grad_norm': 11.917430877685547, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.91it/s] 10%|█         | 4/40 [00:01<00:12,  2.86it/s]                                              {'loss': 2.9574, 'grad_norm': 14.760828018188477, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.86it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.86it/s]                                              {'loss': 1.8665, 'grad_norm': 12.456665992736816, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.86it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s]                                              {'loss': 1.3504, 'grad_norm': 13.34132194519043, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.73it/s]                                              {'loss': 1.5742, 'grad_norm': 21.299299240112305, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.73it/s] 20%|██        | 8/40 [00:02<00:09,  3.43it/s]                                              {'loss': 4.4688, 'grad_norm': 69.1979751586914, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.43it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.46it/s]                                              {'loss': 1.1097, 'grad_norm': 9.269959449768066, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.46it/s] 25%|██▌       | 10/40 [00:03<00:15,  1.98it/s]                                               {'loss': 0.9106, 'grad_norm': 8.908795356750488, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:15,  1.98it/s] 28%|██▊       | 11/40 [00:04<00:15,  1.86it/s]                                               {'loss': 1.4317, 'grad_norm': 10.997918128967285, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:15,  1.86it/s] 30%|███       | 12/40 [00:05<00:16,  1.71it/s]                                               {'loss': 0.9718, 'grad_norm': 5.9148759841918945, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:16,  1.71it/s] 32%|███▎      | 13/40 [00:05<00:16,  1.62it/s]                                               {'loss': 0.7241, 'grad_norm': 4.4871320724487305, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.62it/s] 35%|███▌      | 14/40 [00:06<00:15,  1.66it/s]                                               {'loss': 1.0382, 'grad_norm': 6.940767765045166, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:15,  1.66it/s] 38%|███▊      | 15/40 [00:07<00:16,  1.55it/s]                                               {'loss': 1.5789, 'grad_norm': 9.599976539611816, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:16,  1.55it/s] 40%|████      | 16/40 [00:07<00:11,  2.04it/s]                                               {'loss': 0.6227, 'grad_norm': 20.92945098876953, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:11,  2.04it/s] 42%|████▎     | 17/40 [00:08<00:12,  1.85it/s]                                               {'loss': 0.7415, 'grad_norm': 5.297884941101074, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:12,  1.85it/s] 45%|████▌     | 18/40 [00:08<00:12,  1.79it/s]                                               {'loss': 0.6274, 'grad_norm': 6.40538215637207, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:12,  1.79it/s] 48%|████▊     | 19/40 [00:09<00:12,  1.63it/s]                                               {'loss': 0.4911, 'grad_norm': 3.3566372394561768, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:12,  1.63it/s] 50%|█████     | 20/40 [00:10<00:12,  1.65it/s]                                               {'loss': 1.0092, 'grad_norm': 3.3719282150268555, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:10<00:12,  1.57it/s]                                               {'loss': 0.3002, 'grad_norm': 3.331467866897583, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:11<00:11,  1.51it/s]                                               {'loss': 0.2153, 'grad_norm': 3.142716407775879, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:11,  1.51it/s] 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s]                                               {'loss': 0.6366, 'grad_norm': 10.84874439239502, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s]                                               {'loss': 0.0695, 'grad_norm': 4.606415271759033, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.57it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.90it/s]                                               {'loss': 0.6059, 'grad_norm': 6.39621114730835, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.90it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.75it/s]                                               {'loss': 0.2624, 'grad_norm': 3.4284780025482178, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.75it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.74it/s]                                               {'loss': 0.1283, 'grad_norm': 1.538092017173767, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.74it/s] 70%|███████   | 28/40 [00:14<00:07,  1.61it/s]                                               {'loss': 0.1304, 'grad_norm': 2.099144458770752, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.61it/s] 72%|███████▎  | 29/40 [00:15<00:06,  1.59it/s]                                               {'loss': 0.7222, 'grad_norm': 1.925047755241394, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.57it/s]                                               {'loss': 0.3912, 'grad_norm': 3.3246350288391113, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.57it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.51it/s]                                               {'loss': 0.1683, 'grad_norm': 1.7160660028457642, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.51it/s]                                               {'loss': 0.0693, 'grad_norm': 6.4799957275390625, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.51it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.94it/s]                                               {'loss': 0.0723, 'grad_norm': 1.1511026620864868, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.94it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.78it/s]                                               {'loss': 0.6434, 'grad_norm': 1.7415393590927124, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.78it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.67it/s]                                               {'loss': 0.2605, 'grad_norm': 7.792067050933838, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.67it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.67it/s]                                               {'loss': 0.0614, 'grad_norm': 2.90278959274292, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.67it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.57it/s]                                               {'loss': 0.0803, 'grad_norm': 1.45003080368042, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.56it/s]                                               {'loss': 0.3835, 'grad_norm': 1.4254980087280273, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.55it/s]                                               {'loss': 0.1802, 'grad_norm': 1.3015671968460083, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.55it/s]                                               {'loss': 0.0729, 'grad_norm': 5.212237358093262, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.55it/s]                                               {'train_runtime': 21.8998, 'train_samples_per_second': 25.799, 'train_steps_per_second': 1.827, 'train_loss': 1.0042711746878923, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.55it/s]100%|██████████| 40/40 [00:21<00:00,  1.83it/s]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.40it/s]                                              {'loss': 5.3671, 'grad_norm': 9.456794738769531, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.40it/s]  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]                                              {'loss': 1.6215, 'grad_norm': 8.830925941467285, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]  8%|▊         | 3/40 [00:02<00:25,  1.46it/s]                                              {'loss': 1.5366, 'grad_norm': 9.254182815551758, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.46it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 1.5685, 'grad_norm': 11.803293228149414, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 1.9169, 'grad_norm': 15.130593299865723, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s]                                              {'loss': 1.6014, 'grad_norm': 15.26473331451416, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s]                                              {'loss': 2.9597, 'grad_norm': 17.76548957824707, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s]                                              {'loss': 5.0775, 'grad_norm': 75.94129943847656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.52it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.89it/s]                                              {'loss': 1.3213, 'grad_norm': 9.533956527709961, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.89it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s]                                               {'loss': 1.2575, 'grad_norm': 11.382616996765137, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s]                                               {'loss': 0.5999, 'grad_norm': 8.378411293029785, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s] 30%|███       | 12/40 [00:07<00:17,  1.61it/s]                                               {'loss': 0.6665, 'grad_norm': 7.191239833831787, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.9445, 'grad_norm': 5.85167121887207, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.57it/s]                                               {'loss': 0.808, 'grad_norm': 7.008759021759033, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.57it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 0.6819, 'grad_norm': 6.480397701263428, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 1.5395, 'grad_norm': 38.190128326416016, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.52it/s] 42%|████▎     | 17/40 [00:10<00:11,  2.05it/s]                                               {'loss': 0.2443, 'grad_norm': 4.213041305541992, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:11,  2.05it/s] 45%|████▌     | 18/40 [00:10<00:09,  2.24it/s]                                               {'loss': 0.4227, 'grad_norm': 2.307317018508911, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:09,  2.24it/s] 48%|████▊     | 19/40 [00:10<00:08,  2.38it/s]                                               {'loss': 0.7452, 'grad_norm': 3.649735450744629, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:08,  2.38it/s] 50%|█████     | 20/40 [00:11<00:08,  2.50it/s]                                               {'loss': 0.7483, 'grad_norm': 7.623336315155029, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:08,  2.50it/s] 52%|█████▎    | 21/40 [00:11<00:07,  2.59it/s]                                               {'loss': 0.6471, 'grad_norm': 7.746983051300049, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:07,  2.59it/s] 55%|█████▌    | 22/40 [00:11<00:06,  2.65it/s]                                               {'loss': 0.4559, 'grad_norm': 4.614222526550293, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:06,  2.65it/s] 57%|█████▊    | 23/40 [00:12<00:06,  2.60it/s]                                               {'loss': 0.7125, 'grad_norm': 5.192258834838867, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:06,  2.60it/s] 60%|██████    | 24/40 [00:12<00:04,  3.28it/s]                                               {'loss': 0.1639, 'grad_norm': 7.089840412139893, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:04,  3.28it/s] 62%|██████▎   | 25/40 [00:13<00:06,  2.30it/s]                                               {'loss': 0.5602, 'grad_norm': 4.9558610916137695, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:06,  2.30it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.90it/s]                                               {'loss': 0.0824, 'grad_norm': 2.186110258102417, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.90it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.69it/s]                                               {'loss': 0.208, 'grad_norm': 3.2115492820739746, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.69it/s] 70%|███████   | 28/40 [00:15<00:07,  1.58it/s]                                               {'loss': 0.3772, 'grad_norm': 3.3476812839508057, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.58it/s] 72%|███████▎  | 29/40 [00:16<00:07,  1.50it/s]                                               {'loss': 0.0949, 'grad_norm': 1.6073282957077026, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:07,  1.50it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.46it/s]                                               {'loss': 0.2884, 'grad_norm': 2.47894287109375, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.46it/s] 78%|███████▊  | 31/40 [00:17<00:06,  1.42it/s]                                               {'loss': 0.389, 'grad_norm': 2.7627131938934326, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:06,  1.42it/s] 80%|████████  | 32/40 [00:17<00:04,  1.91it/s]                                               {'loss': 0.0123, 'grad_norm': 0.6888371109962463, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:04,  1.91it/s] 82%|████████▎ | 33/40 [00:18<00:04,  1.71it/s]                                               {'loss': 0.5368, 'grad_norm': 3.8594930171966553, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:04,  1.71it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.57it/s]                                               {'loss': 0.0471, 'grad_norm': 0.703224241733551, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.57it/s] 88%|████████▊ | 35/40 [00:19<00:03,  1.50it/s]                                               {'loss': 0.2928, 'grad_norm': 3.5126781463623047, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.44it/s]                                               {'loss': 0.1162, 'grad_norm': 1.7084901332855225, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:21<00:02,  1.41it/s]                                               {'loss': 0.0442, 'grad_norm': 1.032350778579712, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:02,  1.41it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.39it/s]                                               {'loss': 0.0385, 'grad_norm': 1.206937551498413, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.37it/s]                                               {'loss': 0.2038, 'grad_norm': 2.3197057247161865, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.37it/s]100%|██████████| 40/40 [00:22<00:00,  1.85it/s]                                               {'loss': 0.0738, 'grad_norm': 7.671229362487793, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.85it/s]                                               {'train_runtime': 23.2075, 'train_samples_per_second': 24.346, 'train_steps_per_second': 1.724, 'train_loss': 0.9243463983992115, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.85it/s]100%|██████████| 40/40 [00:23<00:00,  1.72it/s]
CLIENT:5
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.35it/s]                                              {'loss': 4.4939, 'grad_norm': 7.5742316246032715, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.35it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 3.1678, 'grad_norm': 8.732340812683105, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:02<00:27,  1.35it/s]                                              {'loss': 2.219, 'grad_norm': 10.203380584716797, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.35it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 1.4765, 'grad_norm': 10.445884704589844, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.35it/s]                                              {'loss': 2.2138, 'grad_norm': 12.928900718688965, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.4432, 'grad_norm': 19.54109764099121, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.5222, 'grad_norm': 14.659764289855957, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s] 20%|██        | 8/40 [00:05<00:17,  1.84it/s]                                              {'loss': 3.2733, 'grad_norm': 125.40829467773438, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:17,  1.84it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.65it/s]                                              {'loss': 0.6919, 'grad_norm': 10.83117389678955, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.65it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.54it/s]                                               {'loss': 1.0425, 'grad_norm': 6.877182483673096, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:19,  1.54it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s]                                               {'loss': 0.2634, 'grad_norm': 6.42448091506958, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.43it/s]                                               {'loss': 0.6078, 'grad_norm': 8.058427810668945, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.43it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.40it/s]                                               {'loss': 0.7664, 'grad_norm': 5.220520973205566, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.40it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.38it/s]                                               {'loss': 0.829, 'grad_norm': 7.275211811065674, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.38it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.37it/s]                                               {'loss': 1.7853, 'grad_norm': 10.502320289611816, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.37it/s]                                               {'loss': 8.2781, 'grad_norm': 2.3816754817962646, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.37it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s]                                               {'loss': 0.6349, 'grad_norm': 3.088493824005127, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s]                                               {'loss': 1.3405, 'grad_norm': 8.529077529907227, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.54it/s]                                               {'loss': 0.3967, 'grad_norm': 5.5184006690979, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.54it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s]                                               {'loss': 0.3821, 'grad_norm': 4.682187080383301, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.44it/s]                                               {'loss': 0.5832, 'grad_norm': 4.886760234832764, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.44it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s]                                               {'loss': 0.807, 'grad_norm': 6.882109642028809, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.5826, 'grad_norm': 4.401793956756592, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 2.2329, 'grad_norm': 68.43209838867188, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.39it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s]                                               {'loss': 0.178, 'grad_norm': 3.1759274005889893, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.62it/s]                                               {'loss': 0.6466, 'grad_norm': 2.8591699600219727, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.62it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s]                                               {'loss': 0.4366, 'grad_norm': 9.906017303466797, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s]                                               {'loss': 0.1491, 'grad_norm': 3.1959433555603027, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.5051, 'grad_norm': 3.215928792953491, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.6752, 'grad_norm': 3.5049099922180176, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.1961, 'grad_norm': 2.5519344806671143, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.0558, 'grad_norm': 2.6285252571105957, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s]                                               {'loss': 0.2677, 'grad_norm': 1.2921923398971558, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s]                                               {'loss': 0.0852, 'grad_norm': 1.7130498886108398, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s]                                               {'loss': 0.4454, 'grad_norm': 1.2758983373641968, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s]                                               {'loss': 0.0807, 'grad_norm': 2.620173454284668, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s]                                               {'loss': 0.033, 'grad_norm': 1.1814045906066895, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s]                                               {'loss': 0.5329, 'grad_norm': 5.654897689819336, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.40it/s]                                               {'loss': 0.6029, 'grad_norm': 3.4171438217163086, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.40it/s]                                               {'loss': 0.0053, 'grad_norm': 0.3630889654159546, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.40it/s]                                               {'train_runtime': 26.7169, 'train_samples_per_second': 21.148, 'train_steps_per_second': 1.497, 'train_loss': 1.1482438662089407, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.40it/s]100%|██████████| 40/40 [00:26<00:00,  1.50it/s]
CLIENT:52
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]                                              {'loss': 5.5699, 'grad_norm': 9.776742935180664, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 4.1078, 'grad_norm': 12.951272964477539, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:02<00:27,  1.34it/s]                                              {'loss': 1.5332, 'grad_norm': 12.583206176757812, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.34it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 2.1649, 'grad_norm': 11.81904411315918, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 1.7577, 'grad_norm': 13.117240905761719, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.263, 'grad_norm': 16.289356231689453, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 1.9695, 'grad_norm': 20.081451416015625, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 2.5329, 'grad_norm': 43.31354522705078, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.34it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s]                                              {'loss': 0.8636, 'grad_norm': 8.08762264251709, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s]                                               {'loss': 0.9556, 'grad_norm': 12.379800796508789, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s]                                               {'loss': 0.8078, 'grad_norm': 16.90895652770996, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s]                                               {'loss': 1.3037, 'grad_norm': 9.647852897644043, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s]                                               {'loss': 0.6025, 'grad_norm': 7.835564613342285, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s]                                               {'loss': 0.7285, 'grad_norm': 5.197009563446045, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 1.5378, 'grad_norm': 10.609983444213867, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.0972, 'grad_norm': 4.846235752105713, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.38it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s]                                               {'loss': 0.2604, 'grad_norm': 3.512808084487915, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s]                                               {'loss': 0.3519, 'grad_norm': 3.3285932540893555, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.53it/s]                                               {'loss': 0.5293, 'grad_norm': 4.995197296142578, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.53it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s]                                               {'loss': 0.3724, 'grad_norm': 4.224089622497559, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.468, 'grad_norm': 6.33186674118042, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s]                                               {'loss': 1.328, 'grad_norm': 5.879990100860596, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.2245, 'grad_norm': 2.7695043087005615, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.13, 'grad_norm': 2.685669422149658, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.39it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.72it/s]                                               {'loss': 0.15, 'grad_norm': 4.917099952697754, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.72it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s]                                               {'loss': 0.214, 'grad_norm': 5.614812850952148, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s]                                               {'loss': 0.3526, 'grad_norm': 4.916069984436035, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s]                                               {'loss': 0.2956, 'grad_norm': 2.3789894580841064, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.28, 'grad_norm': 2.2426745891571045, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.3756, 'grad_norm': 1.7787230014801025, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.3156, 'grad_norm': 3.5051188468933105, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.0909, 'grad_norm': 4.937765598297119, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.71it/s]                                               {'loss': 0.085, 'grad_norm': 1.453844428062439, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.71it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s]                                               {'loss': 0.0518, 'grad_norm': 0.9671931266784668, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.52it/s]                                               {'loss': 0.4348, 'grad_norm': 2.3566627502441406, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.52it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s]                                               {'loss': 0.3701, 'grad_norm': 0.6040281653404236, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.43it/s]                                               {'loss': 0.0964, 'grad_norm': 3.264620304107666, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.40it/s]                                               {'loss': 0.0335, 'grad_norm': 0.7681760787963867, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.40it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.0419, 'grad_norm': 1.1234713792800903, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.0452, 'grad_norm': 2.6331074237823486, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]                                               {'train_runtime': 26.7825, 'train_samples_per_second': 21.096, 'train_steps_per_second': 1.494, 'train_loss': 0.8673279739916324, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
CLIENT:41
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]                                              {'loss': 4.1986, 'grad_norm': 7.374874114990234, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 1.931, 'grad_norm': 9.802267074584961, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:02<00:27,  1.35it/s]                                              {'loss': 2.0797, 'grad_norm': 10.004546165466309, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.35it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 2.6206, 'grad_norm': 17.099769592285156, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s]                                              {'loss': 1.4216, 'grad_norm': 9.016487121582031, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 2.1179, 'grad_norm': 13.885763168334961, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.6556, 'grad_norm': 10.247244834899902, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 0.2587, 'grad_norm': 19.576650619506836, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.35it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.72it/s]                                              {'loss': 1.1399, 'grad_norm': 10.655074119567871, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.72it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s]                                               {'loss': 0.6917, 'grad_norm': 11.698062896728516, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s] 28%|██▊       | 11/40 [00:07<00:18,  1.53it/s]                                               {'loss': 1.2344, 'grad_norm': 8.230291366577148, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:18,  1.53it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s]                                               {'loss': 0.8527, 'grad_norm': 8.74753475189209, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.44it/s]                                               {'loss': 1.7104, 'grad_norm': 10.409331321716309, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s]                                               {'loss': 0.5803, 'grad_norm': 13.235699653625488, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 0.3392, 'grad_norm': 5.097151279449463, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 0.0004, 'grad_norm': 0.015147288329899311, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.39it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s]                                               {'loss': 0.5387, 'grad_norm': 5.492025852203369, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.61it/s]                                               {'loss': 0.7547, 'grad_norm': 1.930129051208496, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.61it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.55it/s]                                               {'loss': 1.0016, 'grad_norm': 10.285379409790039, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.55it/s] 50%|█████     | 20/40 [00:13<00:13,  1.49it/s]                                               {'loss': 0.2828, 'grad_norm': 3.4233436584472656, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.49it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s]                                               {'loss': 0.8917, 'grad_norm': 6.600080966949463, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.45it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.42it/s]                                               {'loss': 0.2239, 'grad_norm': 3.3088600635528564, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:12,  1.42it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.189, 'grad_norm': 3.4414916038513184, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.2141, 'grad_norm': 9.577921867370605, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.40it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.73it/s]                                               {'loss': 1.043, 'grad_norm': 1.981201171875, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.73it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s]                                               {'loss': 0.06, 'grad_norm': 2.452579975128174, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s]                                               {'loss': 0.3547, 'grad_norm': 5.976986408233643, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s] 70%|███████   | 28/40 [00:18<00:08,  1.49it/s]                                               {'loss': 0.4667, 'grad_norm': 13.079813957214355, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.49it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.5047, 'grad_norm': 5.066267967224121, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.0637, 'grad_norm': 2.0671041011810303, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.42it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.40it/s]                                               {'loss': 0.1239, 'grad_norm': 1.1968787908554077, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:06,  1.40it/s]                                               {'loss': 0.0369, 'grad_norm': 1.483344554901123, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.40it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.73it/s]                                               {'loss': 0.2099, 'grad_norm': 6.045201778411865, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.73it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s]                                               {'loss': 0.0766, 'grad_norm': 0.7275171875953674, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.54it/s]                                               {'loss': 0.2403, 'grad_norm': 6.173137664794922, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.54it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.49it/s]                                               {'loss': 1.1077, 'grad_norm': 5.897414207458496, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.49it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.45it/s]                                               {'loss': 0.1096, 'grad_norm': 3.7041714191436768, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.42it/s]                                               {'loss': 0.3748, 'grad_norm': 1.8165833950042725, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.42it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.40it/s]                                               {'loss': 0.5223, 'grad_norm': 1.3102681636810303, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.40it/s]                                               {'loss': 0.2251, 'grad_norm': 11.207274436950684, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.40it/s]                                               {'train_runtime': 26.5597, 'train_samples_per_second': 21.273, 'train_steps_per_second': 1.506, 'train_loss': 0.8112250641410356, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.40it/s]100%|██████████| 40/40 [00:26<00:00,  1.51it/s]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]                                              {'loss': 5.3507, 'grad_norm': 9.360027313232422, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 3.1546, 'grad_norm': 10.496909141540527, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:02<00:27,  1.34it/s]                                              {'loss': 1.7358, 'grad_norm': 9.967315673828125, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.34it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 1.7052, 'grad_norm': 16.090301513671875, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s]                                              {'loss': 1.5708, 'grad_norm': 16.252395629882812, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.3982, 'grad_norm': 14.941076278686523, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 1.0558, 'grad_norm': 12.676372528076172, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 3.9784, 'grad_norm': 79.43921661376953, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.34it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s]                                              {'loss': 1.0104, 'grad_norm': 10.360054016113281, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s]                                               {'loss': 1.0603, 'grad_norm': 12.540434837341309, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s]                                               {'loss': 0.7031, 'grad_norm': 5.0981340408325195, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s]                                               {'loss': 0.8844, 'grad_norm': 8.792418479919434, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s]                                               {'loss': 0.9071, 'grad_norm': 7.471432685852051, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.39it/s]                                               {'loss': 0.8453, 'grad_norm': 6.702751159667969, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.39it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.6304, 'grad_norm': 6.667879104614258, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.011, 'grad_norm': 0.560177206993103, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.38it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.70it/s]                                               {'loss': 0.8976, 'grad_norm': 4.927480220794678, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.70it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s]                                               {'loss': 0.2867, 'grad_norm': 3.577659845352173, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.51it/s]                                               {'loss': 0.1037, 'grad_norm': 2.129979372024536, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.51it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s]                                               {'loss': 0.2091, 'grad_norm': 3.013493776321411, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.42it/s]                                               {'loss': 0.2303, 'grad_norm': 5.527609348297119, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.42it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.1563, 'grad_norm': 3.702155828475952, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.2489, 'grad_norm': 5.83120059967041, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.0959, 'grad_norm': 6.733575820922852, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s]                                               {'loss': 0.1579, 'grad_norm': 5.221235275268555, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s]                                               {'loss': 0.5297, 'grad_norm': 7.541969299316406, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s]                                               {'loss': 0.1366, 'grad_norm': 4.0238871574401855, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s] 70%|███████   | 28/40 [00:18<00:08,  1.47it/s]                                               {'loss': 0.0148, 'grad_norm': 0.38828805088996887, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.0806, 'grad_norm': 2.395474672317505, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.1637, 'grad_norm': 2.327806234359741, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.3147, 'grad_norm': 3.192366123199463, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.3913, 'grad_norm': 16.433176040649414, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.71it/s]                                               {'loss': 0.0643, 'grad_norm': 1.0178707838058472, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.71it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s]                                               {'loss': 0.1859, 'grad_norm': 3.6322762966156006, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.52it/s]                                               {'loss': 0.2456, 'grad_norm': 1.0929993391036987, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.52it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s]                                               {'loss': 0.0258, 'grad_norm': 0.9357837438583374, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s]                                               {'loss': 0.0998, 'grad_norm': 3.2781929969787598, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s]                                               {'loss': 0.071, 'grad_norm': 1.294697880744934, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.0278, 'grad_norm': 0.8290236592292786, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.0927, 'grad_norm': 6.76617431640625, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]                                               {'train_runtime': 26.8147, 'train_samples_per_second': 21.071, 'train_steps_per_second': 1.492, 'train_loss': 0.7708081491524353, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]                                              {'loss': 3.0331, 'grad_norm': 9.023351669311523, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 2.3557, 'grad_norm': 9.596696853637695, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:02<00:27,  1.34it/s]                                              {'loss': 2.1958, 'grad_norm': 11.690229415893555, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.34it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 2.5119, 'grad_norm': 17.644628524780273, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s]                                              {'loss': 1.711, 'grad_norm': 20.141616821289062, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.3242, 'grad_norm': 15.295971870422363, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.7316, 'grad_norm': 17.358543395996094, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.972, 'grad_norm': 64.4931411743164, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.35it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s]                                              {'loss': 1.1134, 'grad_norm': 11.126382827758789, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s]                                               {'loss': 0.8748, 'grad_norm': 11.004048347473145, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s]                                               {'loss': 0.671, 'grad_norm': 8.883685111999512, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s] 30%|███       | 12/40 [00:08<00:18,  1.47it/s]                                               {'loss': 0.923, 'grad_norm': 8.563732147216797, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:18,  1.47it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s]                                               {'loss': 0.352, 'grad_norm': 4.884032249450684, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s]                                               {'loss': 0.3208, 'grad_norm': 4.750868797302246, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.39it/s]                                               {'loss': 0.911, 'grad_norm': 7.071133613586426, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.39it/s]                                               {'loss': 2.8736, 'grad_norm': 51.364192962646484, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.39it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s]                                               {'loss': 0.1834, 'grad_norm': 3.0851826667785645, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s]                                               {'loss': 0.6448, 'grad_norm': 6.680932521820068, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.53it/s]                                               {'loss': 0.254, 'grad_norm': 3.8158857822418213, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.53it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s]                                               {'loss': 0.8571, 'grad_norm': 3.3993613719940186, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.1952, 'grad_norm': 3.9953267574310303, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.2518, 'grad_norm': 5.818423271179199, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.4555, 'grad_norm': 2.8914506435394287, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 1.3515, 'grad_norm': 50.30488204956055, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.39it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s]                                               {'loss': 0.3714, 'grad_norm': 3.177995443344116, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s]                                               {'loss': 0.1727, 'grad_norm': 3.683344841003418, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s]                                               {'loss': 0.105, 'grad_norm': 1.5813214778900146, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s]                                               {'loss': 0.0408, 'grad_norm': 0.9324069023132324, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.1874, 'grad_norm': 1.1965218782424927, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.4902, 'grad_norm': 1.6921204328536987, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.257, 'grad_norm': 1.568830966949463, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.0021, 'grad_norm': 0.12284163385629654, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s]                                               {'loss': 0.0214, 'grad_norm': 1.0188509225845337, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s]                                               {'loss': 0.0727, 'grad_norm': 2.247772693634033, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.54it/s]                                               {'loss': 0.4092, 'grad_norm': 0.8673362135887146, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.54it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s]                                               {'loss': 0.0896, 'grad_norm': 2.0519049167633057, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s]                                               {'loss': 0.3621, 'grad_norm': 1.8036245107650757, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s]                                               {'loss': 0.1607, 'grad_norm': 2.494986057281494, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.1967, 'grad_norm': 0.9877474308013916, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.0002, 'grad_norm': 0.03482488915324211, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]                                               {'train_runtime': 26.701, 'train_samples_per_second': 21.16, 'train_steps_per_second': 1.498, 'train_loss': 0.8001845169063018, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]100%|██████████| 40/40 [00:26<00:00,  1.50it/s]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]                                              {'loss': 3.0111, 'grad_norm': 8.735159873962402, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 2.9605, 'grad_norm': 9.60812759399414, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:02<00:27,  1.34it/s]                                              {'loss': 2.5403, 'grad_norm': 12.529945373535156, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.34it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 2.1585, 'grad_norm': 16.327335357666016, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 2.8207, 'grad_norm': 18.586606979370117, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.35it/s]                                              {'loss': 1.7262, 'grad_norm': 13.217931747436523, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.35it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 1.4182, 'grad_norm': 12.540127754211426, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 0.2689, 'grad_norm': 16.20142364501953, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.34it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s]                                              {'loss': 0.4367, 'grad_norm': 7.510594367980957, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s]                                               {'loss': 1.4716, 'grad_norm': 19.464906692504883, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s]                                               {'loss': 0.762, 'grad_norm': 7.74871301651001, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s]                                               {'loss': 0.9449, 'grad_norm': 10.374567031860352, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.42it/s]                                               {'loss': 0.9589, 'grad_norm': 10.647161483764648, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.42it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s]                                               {'loss': 1.6814, 'grad_norm': 8.854408264160156, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.8985, 'grad_norm': 5.342546463012695, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.4466, 'grad_norm': 17.9575138092041, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.38it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s]                                               {'loss': 0.543, 'grad_norm': 4.603665828704834, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s]                                               {'loss': 0.6443, 'grad_norm': 6.08673095703125, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s]                                               {'loss': 0.6493, 'grad_norm': 5.948376655578613, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s]                                               {'loss': 0.4907, 'grad_norm': 3.7537829875946045, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.1417, 'grad_norm': 2.1230573654174805, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.4788, 'grad_norm': 5.0420403480529785, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.5355, 'grad_norm': 6.155580520629883, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.2467, 'grad_norm': 22.362701416015625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.70it/s]                                               {'loss': 0.3407, 'grad_norm': 4.5252604484558105, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.70it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s]                                               {'loss': 0.1332, 'grad_norm': 3.1277999877929688, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s]                                               {'loss': 0.405, 'grad_norm': 5.469966411590576, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s] 70%|███████   | 28/40 [00:18<00:08,  1.47it/s]                                               {'loss': 0.1296, 'grad_norm': 2.6015381813049316, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.43it/s]                                               {'loss': 0.2866, 'grad_norm': 2.9217004776000977, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.43it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.39it/s]                                               {'loss': 0.3506, 'grad_norm': 3.1969192028045654, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.1331, 'grad_norm': 1.5822556018829346, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 1.1503, 'grad_norm': 33.1245231628418, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.71it/s]                                               {'loss': 0.1109, 'grad_norm': 2.9554107189178467, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.71it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s]                                               {'loss': 0.0474, 'grad_norm': 0.8944501280784607, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.52it/s]                                               {'loss': 0.1655, 'grad_norm': 1.9677361249923706, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.52it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s]                                               {'loss': 0.0644, 'grad_norm': 1.5567874908447266, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s]                                               {'loss': 0.0878, 'grad_norm': 1.3336915969848633, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s]                                               {'loss': 0.3475, 'grad_norm': 4.714609146118164, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.171, 'grad_norm': 3.600330114364624, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.0302, 'grad_norm': 1.4279710054397583, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]                                               {'train_runtime': 26.8333, 'train_samples_per_second': 21.056, 'train_steps_per_second': 1.491, 'train_loss': 0.8047238869126886, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]                                              {'loss': 4.2335, 'grad_norm': 8.996963500976562, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]                                              {'loss': 4.2567, 'grad_norm': 15.048792839050293, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:01<00:19,  1.87it/s]                                              {'loss': 2.6777, 'grad_norm': 15.142395973205566, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:19,  1.87it/s] 10%|█         | 4/40 [00:02<00:16,  2.19it/s]                                              {'loss': 1.9735, 'grad_norm': 11.47037410736084, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:16,  2.19it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.40it/s]                                              {'loss': 2.4922, 'grad_norm': 18.99622917175293, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.40it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.54it/s]                                              {'loss': 1.8374, 'grad_norm': 14.009410858154297, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.54it/s] 18%|█▊        | 7/40 [00:03<00:12,  2.66it/s]                                              {'loss': 2.4982, 'grad_norm': 17.547773361206055, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:12,  2.66it/s]                                              {'loss': 4.4358, 'grad_norm': 76.40312957763672, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:12,  2.66it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.35it/s]                                              {'loss': 1.6182, 'grad_norm': 13.605348587036133, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.35it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.19it/s]                                               {'loss': 1.6293, 'grad_norm': 10.938248634338379, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.19it/s] 28%|██▊       | 11/40 [00:04<00:09,  3.10it/s]                                               {'loss': 1.2481, 'grad_norm': 8.435409545898438, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:09,  3.10it/s] 30%|███       | 12/40 [00:04<00:09,  3.01it/s]                                               {'loss': 0.739, 'grad_norm': 7.973113059997559, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  3.01it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s]                                               {'loss': 1.008, 'grad_norm': 6.966165065765381, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s] 35%|███▌      | 14/40 [00:05<00:12,  2.04it/s]                                               {'loss': 0.8605, 'grad_norm': 9.21387767791748, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:12,  2.04it/s] 38%|███▊      | 15/40 [00:06<00:13,  1.80it/s]                                               {'loss': 1.3342, 'grad_norm': 5.136328220367432, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:13,  1.80it/s]                                               {'loss': 0.2832, 'grad_norm': 11.463197708129883, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:13,  1.80it/s] 42%|████▎     | 17/40 [00:07<00:11,  2.05it/s]                                               {'loss': 0.5296, 'grad_norm': 4.7298455238342285, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:11,  2.05it/s] 45%|████▌     | 18/40 [00:08<00:11,  1.92it/s]                                               {'loss': 1.0052, 'grad_norm': 4.499431610107422, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:11,  1.92it/s] 48%|████▊     | 19/40 [00:08<00:11,  1.76it/s]                                               {'loss': 0.5459, 'grad_norm': 6.29868745803833, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:11,  1.76it/s] 50%|█████     | 20/40 [00:09<00:12,  1.64it/s]                                               {'loss': 0.6101, 'grad_norm': 4.907182216644287, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:12,  1.64it/s] 52%|█████▎    | 21/40 [00:10<00:11,  1.66it/s]                                               {'loss': 0.9545, 'grad_norm': 6.023172855377197, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:11,  1.66it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.56it/s]                                               {'loss': 0.7397, 'grad_norm': 5.853281497955322, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.56it/s] 57%|█████▊    | 23/40 [00:11<00:11,  1.53it/s]                                               {'loss': 0.67, 'grad_norm': 5.017075538635254, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:11,  1.53it/s] 60%|██████    | 24/40 [00:11<00:07,  2.03it/s]                                               {'loss': 0.1989, 'grad_norm': 11.940253257751465, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:07,  2.03it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.91it/s]                                               {'loss': 0.3284, 'grad_norm': 5.946559906005859, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:12<00:08,  1.71it/s]                                               {'loss': 0.3358, 'grad_norm': 3.860065460205078, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:08,  1.71it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.69it/s]                                               {'loss': 0.2031, 'grad_norm': 3.822730779647827, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.69it/s] 70%|███████   | 28/40 [00:14<00:07,  1.58it/s]                                               {'loss': 0.7173, 'grad_norm': 3.1994214057922363, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.58it/s] 72%|███████▎  | 29/40 [00:15<00:07,  1.52it/s]                                               {'loss': 0.2958, 'grad_norm': 2.760103225708008, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:07,  1.52it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.56it/s]                                               {'loss': 0.1654, 'grad_norm': 2.5550498962402344, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:16<00:06,  1.49it/s]                                               {'loss': 0.6823, 'grad_norm': 5.303301811218262, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:06,  1.49it/s]                                               {'loss': 0.2912, 'grad_norm': 11.320101737976074, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.85it/s]                                               {'loss': 0.1139, 'grad_norm': 1.1593130826950073, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.85it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.80it/s]                                               {'loss': 1.1931, 'grad_norm': 3.804332733154297, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.80it/s] 88%|████████▊ | 35/40 [00:18<00:03,  1.65it/s]                                               {'loss': 0.097, 'grad_norm': 1.4238975048065186, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:03,  1.65it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.60it/s]                                               {'loss': 0.1517, 'grad_norm': 1.7767281532287598, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.60it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.57it/s]                                               {'loss': 0.1418, 'grad_norm': 3.67440128326416, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.53it/s]                                               {'loss': 0.0649, 'grad_norm': 1.0153263807296753, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.53it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]                                               {'loss': 0.2726, 'grad_norm': 3.619222402572632, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]                                               {'loss': 0.0331, 'grad_norm': 1.745992660522461, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.57it/s]                                               {'train_runtime': 21.4254, 'train_samples_per_second': 26.371, 'train_steps_per_second': 1.867, 'train_loss': 1.0866726683452725, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.57it/s]100%|██████████| 40/40 [00:21<00:00,  1.87it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:37,  4.82it/s]  1%|          | 3/471 [00:00<02:04,  3.76it/s]  1%|          | 4/471 [00:01<02:10,  3.57it/s]  1%|          | 5/471 [00:01<02:31,  3.07it/s]  1%|▏         | 6/471 [00:01<02:38,  2.93it/s]  1%|▏         | 7/471 [00:02<02:36,  2.97it/s]  2%|▏         | 8/471 [00:02<02:39,  2.90it/s]  2%|▏         | 9/471 [00:02<02:46,  2.77it/s]  2%|▏         | 10/471 [00:03<02:40,  2.86it/s]  2%|▏         | 11/471 [00:03<02:40,  2.87it/s]  3%|▎         | 12/471 [00:04<02:49,  2.71it/s]  3%|▎         | 13/471 [00:04<02:43,  2.80it/s]  3%|▎         | 14/471 [00:04<02:39,  2.87it/s]  3%|▎         | 15/471 [00:05<02:49,  2.70it/s]  3%|▎         | 16/471 [00:05<02:45,  2.76it/s]  4%|▎         | 17/471 [00:05<02:34,  2.95it/s]  4%|▍         | 18/471 [00:06<02:32,  2.97it/s]  4%|▍         | 19/471 [00:06<02:43,  2.77it/s]  4%|▍         | 20/471 [00:06<02:39,  2.83it/s]  4%|▍         | 21/471 [00:07<02:33,  2.93it/s]  5%|▍         | 22/471 [00:07<02:43,  2.74it/s]  5%|▍         | 23/471 [00:07<02:42,  2.76it/s]  5%|▌         | 24/471 [00:08<02:34,  2.89it/s]  5%|▌         | 25/471 [00:08<02:39,  2.79it/s]  6%|▌         | 26/471 [00:08<02:43,  2.72it/s]  6%|▌         | 27/471 [00:09<02:37,  2.82it/s]  6%|▌         | 28/471 [00:09<02:34,  2.86it/s]  6%|▌         | 29/471 [00:10<02:43,  2.70it/s]  6%|▋         | 30/471 [00:10<02:38,  2.79it/s]  7%|▋         | 31/471 [00:10<02:32,  2.88it/s]  7%|▋         | 32/471 [00:11<02:41,  2.72it/s]  7%|▋         | 33/471 [00:11<02:37,  2.79it/s]  7%|▋         | 34/471 [00:11<02:28,  2.94it/s]  7%|▋         | 35/471 [00:12<02:38,  2.75it/s]  8%|▊         | 36/471 [00:12<02:39,  2.74it/s]  8%|▊         | 37/471 [00:12<02:33,  2.82it/s]  8%|▊         | 38/471 [00:13<02:34,  2.80it/s]  8%|▊         | 39/471 [00:13<02:40,  2.70it/s]  8%|▊         | 40/471 [00:13<02:35,  2.78it/s]  9%|▊         | 41/471 [00:14<02:22,  3.01it/s]  9%|▉         | 42/471 [00:14<02:04,  3.45it/s]  9%|▉         | 43/471 [00:14<01:52,  3.82it/s]  9%|▉         | 44/471 [00:14<01:42,  4.15it/s] 10%|▉         | 45/471 [00:15<01:36,  4.42it/s] 10%|▉         | 46/471 [00:15<01:31,  4.63it/s] 10%|▉         | 47/471 [00:15<01:28,  4.82it/s] 10%|█         | 48/471 [00:15<01:25,  4.92it/s] 10%|█         | 49/471 [00:15<01:24,  4.99it/s] 11%|█         | 50/471 [00:15<01:23,  5.04it/s] 11%|█         | 51/471 [00:16<01:22,  5.09it/s] 11%|█         | 52/471 [00:16<01:21,  5.15it/s] 11%|█▏        | 53/471 [00:16<01:20,  5.16it/s] 11%|█▏        | 54/471 [00:16<01:20,  5.16it/s] 12%|█▏        | 55/471 [00:16<01:20,  5.16it/s] 12%|█▏        | 56/471 [00:17<01:21,  5.09it/s] 12%|█▏        | 57/471 [00:17<01:21,  5.09it/s] 12%|█▏        | 58/471 [00:17<01:20,  5.10it/s] 13%|█▎        | 59/471 [00:17<01:21,  5.09it/s] 13%|█▎        | 60/471 [00:17<01:20,  5.12it/s] 13%|█▎        | 61/471 [00:18<01:20,  5.11it/s] 13%|█▎        | 62/471 [00:18<01:20,  5.08it/s] 13%|█▎        | 63/471 [00:18<01:38,  4.15it/s] 14%|█▎        | 64/471 [00:19<01:57,  3.47it/s] 14%|█▍        | 65/471 [00:19<02:02,  3.33it/s] 14%|█▍        | 66/471 [00:19<02:02,  3.31it/s] 14%|█▍        | 67/471 [00:20<02:16,  2.96it/s] 14%|█▍        | 68/471 [00:20<02:17,  2.92it/s] 15%|█▍        | 69/471 [00:20<02:12,  3.04it/s] 15%|█▍        | 70/471 [00:21<02:21,  2.84it/s] 15%|█▌        | 71/471 [00:21<02:24,  2.77it/s] 15%|█▌        | 72/471 [00:21<02:20,  2.85it/s] 15%|█▌        | 73/471 [00:22<02:20,  2.83it/s] 16%|█▌        | 74/471 [00:22<02:25,  2.72it/s] 16%|█▌        | 75/471 [00:22<02:20,  2.81it/s] 16%|█▌        | 76/471 [00:23<02:18,  2.86it/s] 16%|█▋        | 77/471 [00:23<02:26,  2.69it/s] 17%|█▋        | 78/471 [00:24<02:20,  2.79it/s] 17%|█▋        | 79/471 [00:24<02:15,  2.89it/s] 17%|█▋        | 80/471 [00:24<02:23,  2.72it/s] 17%|█▋        | 81/471 [00:25<02:21,  2.75it/s] 17%|█▋        | 82/471 [00:25<02:14,  2.88it/s] 18%|█▊        | 83/471 [00:25<02:20,  2.77it/s] 18%|█▊        | 84/471 [00:26<02:22,  2.71it/s] 18%|█▊        | 85/471 [00:26<02:17,  2.80it/s] 18%|█▊        | 86/471 [00:26<02:11,  2.93it/s] 18%|█▊        | 87/471 [00:27<02:19,  2.75it/s] 19%|█▊        | 88/471 [00:27<02:18,  2.78it/s] 19%|█▉        | 89/471 [00:27<02:11,  2.91it/s] 19%|█▉        | 90/471 [00:28<02:17,  2.77it/s] 19%|█▉        | 91/471 [00:28<02:19,  2.73it/s] 20%|█▉        | 92/471 [00:29<02:14,  2.82it/s] 20%|█▉        | 93/471 [00:29<02:14,  2.81it/s] 20%|█▉        | 94/471 [00:29<02:19,  2.70it/s] 20%|██        | 95/471 [00:30<02:14,  2.79it/s] 20%|██        | 96/471 [00:30<02:11,  2.85it/s] 21%|██        | 97/471 [00:30<02:19,  2.68it/s] 21%|██        | 98/471 [00:31<02:14,  2.78it/s] 21%|██        | 99/471 [00:31<02:08,  2.90it/s] 21%|██        | 100/471 [00:31<02:15,  2.73it/s] 21%|██▏       | 101/471 [00:32<02:14,  2.76it/s] 22%|██▏       | 102/471 [00:32<02:07,  2.88it/s] 22%|██▏       | 103/471 [00:33<02:12,  2.78it/s] 22%|██▏       | 104/471 [00:33<02:15,  2.72it/s] 22%|██▏       | 105/471 [00:33<02:10,  2.81it/s] 23%|██▎       | 106/471 [00:34<02:08,  2.84it/s] 23%|██▎       | 107/471 [00:34<02:14,  2.72it/s] 23%|██▎       | 108/471 [00:34<02:09,  2.81it/s] 23%|██▎       | 109/471 [00:35<02:01,  2.98it/s] 23%|██▎       | 110/471 [00:35<02:06,  2.85it/s] 24%|██▎       | 111/471 [00:35<02:09,  2.77it/s] 24%|██▍       | 112/471 [00:36<02:06,  2.84it/s] 24%|██▍       | 113/471 [00:36<02:05,  2.85it/s] 24%|██▍       | 114/471 [00:36<02:11,  2.71it/s] 24%|██▍       | 115/471 [00:37<02:06,  2.81it/s] 25%|██▍       | 116/471 [00:37<02:03,  2.87it/s] 25%|██▍       | 117/471 [00:38<02:10,  2.70it/s] 25%|██▌       | 118/471 [00:38<02:06,  2.79it/s] 25%|██▌       | 119/471 [00:38<02:00,  2.92it/s] 25%|██▌       | 120/471 [00:39<02:08,  2.74it/s] 26%|██▌       | 121/471 [00:39<02:07,  2.75it/s] 26%|██▌       | 122/471 [00:39<02:00,  2.88it/s] 26%|██▌       | 123/471 [00:40<02:04,  2.79it/s] 26%|██▋       | 124/471 [00:40<02:07,  2.72it/s] 27%|██▋       | 125/471 [00:40<02:03,  2.81it/s] 27%|██▋       | 126/471 [00:41<02:02,  2.82it/s] 27%|██▋       | 127/471 [00:41<02:07,  2.70it/s] 27%|██▋       | 128/471 [00:41<02:02,  2.79it/s] 27%|██▋       | 129/471 [00:42<01:59,  2.87it/s] 28%|██▊       | 130/471 [00:42<02:06,  2.70it/s] 28%|██▊       | 131/471 [00:43<02:02,  2.78it/s] 28%|██▊       | 132/471 [00:43<01:55,  2.93it/s] 28%|██▊       | 133/471 [00:43<01:50,  3.05it/s] 28%|██▊       | 134/471 [00:44<01:59,  2.81it/s] 29%|██▊       | 135/471 [00:44<01:57,  2.86it/s] 29%|██▉       | 136/471 [00:44<01:51,  3.00it/s] 29%|██▉       | 137/471 [00:45<02:00,  2.78it/s] 29%|██▉       | 138/471 [00:45<02:00,  2.77it/s] 30%|██▉       | 139/471 [00:45<01:56,  2.86it/s] 30%|██▉       | 140/471 [00:46<01:57,  2.83it/s] 30%|██▉       | 141/471 [00:46<02:00,  2.73it/s] 30%|███       | 142/471 [00:46<01:56,  2.83it/s] 30%|███       | 143/471 [00:47<01:54,  2.86it/s] 31%|███       | 144/471 [00:47<02:00,  2.71it/s] 31%|███       | 145/471 [00:47<01:55,  2.81it/s] 31%|███       | 146/471 [00:48<01:51,  2.91it/s] 31%|███       | 147/471 [00:48<01:58,  2.73it/s] 31%|███▏      | 148/471 [00:49<01:56,  2.77it/s] 32%|███▏      | 149/471 [00:49<01:50,  2.92it/s] 32%|███▏      | 150/471 [00:49<01:56,  2.75it/s] 32%|███▏      | 151/471 [00:50<01:57,  2.73it/s] 32%|███▏      | 152/471 [00:50<01:52,  2.83it/s] 32%|███▏      | 153/471 [00:50<01:53,  2.81it/s] 33%|███▎      | 154/471 [00:51<01:56,  2.72it/s] 33%|███▎      | 155/471 [00:51<01:52,  2.80it/s] 33%|███▎      | 156/471 [00:51<01:44,  3.01it/s] 33%|███▎      | 157/471 [00:52<01:51,  2.81it/s] 34%|███▎      | 158/471 [00:52<01:52,  2.78it/s] 34%|███▍      | 159/471 [00:52<01:49,  2.86it/s] 34%|███▍      | 160/471 [00:53<01:49,  2.84it/s] 34%|███▍      | 161/471 [00:53<01:53,  2.73it/s] 34%|███▍      | 162/471 [00:53<01:49,  2.83it/s] 35%|███▍      | 163/471 [00:54<01:47,  2.87it/s] 35%|███▍      | 164/471 [00:54<01:52,  2.73it/s] 35%|███▌      | 165/471 [00:55<01:48,  2.82it/s] 35%|███▌      | 166/471 [00:55<01:44,  2.92it/s] 35%|███▌      | 167/471 [00:55<01:50,  2.75it/s] 36%|███▌      | 168/471 [00:56<01:48,  2.78it/s] 36%|███▌      | 169/471 [00:56<01:43,  2.93it/s] 36%|███▌      | 170/471 [00:56<01:47,  2.79it/s] 36%|███▋      | 171/471 [00:57<01:49,  2.74it/s] 37%|███▋      | 172/471 [00:57<01:46,  2.82it/s] 37%|███▋      | 173/471 [00:57<01:45,  2.83it/s] 37%|███▋      | 174/471 [00:58<01:49,  2.70it/s] 37%|███▋      | 175/471 [00:58<01:45,  2.80it/s] 37%|███▋      | 176/471 [00:58<01:42,  2.88it/s] 38%|███▊      | 177/471 [00:59<01:48,  2.71it/s] 38%|███▊      | 178/471 [00:59<01:45,  2.79it/s] 38%|███▊      | 179/471 [01:00<01:39,  2.92it/s] 38%|███▊      | 180/471 [01:00<01:26,  3.35it/s] 38%|███▊      | 181/471 [01:00<01:17,  3.75it/s] 39%|███▊      | 182/471 [01:00<01:10,  4.09it/s] 39%|███▉      | 183/471 [01:00<01:05,  4.37it/s] 39%|███▉      | 184/471 [01:00<01:02,  4.61it/s] 39%|███▉      | 185/471 [01:01<00:59,  4.80it/s] 39%|███▉      | 186/471 [01:01<00:57,  4.93it/s] 40%|███▉      | 187/471 [01:01<00:56,  5.02it/s] 40%|███▉      | 188/471 [01:01<00:55,  5.07it/s] 40%|████      | 189/471 [01:01<00:54,  5.13it/s] 40%|████      | 190/471 [01:02<00:55,  5.09it/s] 41%|████      | 191/471 [01:02<00:55,  5.09it/s] 41%|████      | 192/471 [01:02<00:54,  5.11it/s] 41%|████      | 193/471 [01:02<00:53,  5.15it/s] 41%|████      | 194/471 [01:02<00:53,  5.19it/s] 41%|████▏     | 195/471 [01:03<00:53,  5.11it/s] 42%|████▏     | 196/471 [01:03<01:02,  4.38it/s] 42%|████▏     | 197/471 [01:03<01:16,  3.56it/s] 42%|████▏     | 198/471 [01:04<01:20,  3.40it/s] 42%|████▏     | 199/471 [01:04<01:20,  3.37it/s] 42%|████▏     | 200/471 [01:04<01:30,  3.00it/s] 43%|████▎     | 201/471 [01:05<01:31,  2.94it/s] 43%|████▎     | 202/471 [01:05<01:28,  3.04it/s] 43%|████▎     | 203/471 [01:05<01:33,  2.87it/s] 43%|████▎     | 204/471 [01:06<01:36,  2.78it/s] 44%|████▎     | 205/471 [01:06<01:33,  2.86it/s] 44%|████▎     | 206/471 [01:06<01:32,  2.88it/s] 44%|████▍     | 207/471 [01:07<01:36,  2.73it/s] 44%|████▍     | 208/471 [01:07<01:33,  2.82it/s] 44%|████▍     | 209/471 [01:08<01:30,  2.89it/s] 45%|████▍     | 210/471 [01:08<01:35,  2.72it/s] 45%|████▍     | 211/471 [01:08<01:33,  2.79it/s] 45%|████▌     | 212/471 [01:09<01:29,  2.91it/s] 45%|████▌     | 213/471 [01:09<01:34,  2.73it/s] 45%|████▌     | 214/471 [01:09<01:33,  2.75it/s] 46%|████▌     | 215/471 [01:10<01:29,  2.87it/s] 46%|████▌     | 216/471 [01:10<01:32,  2.77it/s] 46%|████▌     | 217/471 [01:10<01:33,  2.71it/s] 46%|████▋     | 218/471 [01:11<01:30,  2.80it/s] 46%|████▋     | 219/471 [01:11<01:26,  2.93it/s] 47%|████▋     | 220/471 [01:12<01:31,  2.75it/s] 47%|████▋     | 221/471 [01:12<01:30,  2.77it/s] 47%|████▋     | 222/471 [01:12<01:25,  2.92it/s] 47%|████▋     | 223/471 [01:13<01:30,  2.76it/s] 48%|████▊     | 224/471 [01:13<01:30,  2.74it/s] 48%|████▊     | 225/471 [01:13<01:26,  2.84it/s] 48%|████▊     | 226/471 [01:14<01:26,  2.84it/s] 48%|████▊     | 227/471 [01:14<01:29,  2.74it/s] 48%|████▊     | 228/471 [01:14<01:26,  2.82it/s] 49%|████▊     | 229/471 [01:15<01:22,  2.94it/s] 49%|████▉     | 230/471 [01:15<01:28,  2.74it/s] 49%|████▉     | 231/471 [01:15<01:25,  2.80it/s] 49%|████▉     | 232/471 [01:16<01:20,  2.99it/s] 49%|████▉     | 233/471 [01:16<01:25,  2.79it/s] 50%|████▉     | 234/471 [01:16<01:25,  2.76it/s] 50%|████▉     | 235/471 [01:17<01:22,  2.85it/s] 50%|█████     | 236/471 [01:17<01:22,  2.84it/s] 50%|█████     | 237/471 [01:18<01:25,  2.74it/s] 51%|█████     | 238/471 [01:18<01:22,  2.83it/s] 51%|█████     | 239/471 [01:18<01:20,  2.87it/s] 51%|█████     | 240/471 [01:19<01:25,  2.71it/s] 51%|█████     | 241/471 [01:19<01:22,  2.80it/s] 51%|█████▏    | 242/471 [01:19<01:17,  2.94it/s] 52%|█████▏    | 243/471 [01:20<01:18,  2.89it/s] 52%|█████▏    | 244/471 [01:20<01:21,  2.78it/s] 52%|█████▏    | 245/471 [01:20<01:19,  2.85it/s] 52%|█████▏    | 246/471 [01:21<01:17,  2.89it/s] 52%|█████▏    | 247/471 [01:21<01:21,  2.73it/s] 53%|█████▎    | 248/471 [01:21<01:18,  2.83it/s] 53%|█████▎    | 249/471 [01:22<01:16,  2.91it/s] 53%|█████▎    | 250/471 [01:22<01:20,  2.74it/s] 53%|█████▎    | 251/471 [01:23<01:18,  2.79it/s] 54%|█████▎    | 252/471 [01:23<01:14,  2.93it/s] 54%|█████▎    | 253/471 [01:23<01:19,  2.75it/s] 54%|█████▍    | 254/471 [01:24<01:19,  2.74it/s] 54%|█████▍    | 255/471 [01:24<01:16,  2.83it/s] 54%|█████▍    | 256/471 [01:24<01:16,  2.81it/s] 55%|█████▍    | 257/471 [01:25<01:18,  2.72it/s] 55%|█████▍    | 258/471 [01:25<01:15,  2.82it/s] 55%|█████▍    | 259/471 [01:25<01:13,  2.87it/s] 55%|█████▌    | 260/471 [01:26<01:17,  2.71it/s] 55%|█████▌    | 261/471 [01:26<01:15,  2.80it/s] 56%|█████▌    | 262/471 [01:26<01:12,  2.89it/s] 56%|█████▌    | 263/471 [01:27<01:16,  2.72it/s] 56%|█████▌    | 264/471 [01:27<01:14,  2.78it/s] 56%|█████▋    | 265/471 [01:27<01:09,  2.96it/s] 56%|█████▋    | 266/471 [01:28<01:09,  2.94it/s] 57%|█████▋    | 267/471 [01:28<01:13,  2.77it/s] 57%|█████▋    | 268/471 [01:29<01:11,  2.85it/s] 57%|█████▋    | 269/471 [01:29<01:08,  2.94it/s] 57%|█████▋    | 270/471 [01:29<01:12,  2.76it/s] 58%|█████▊    | 271/471 [01:30<01:11,  2.81it/s] 58%|█████▊    | 272/471 [01:30<01:07,  2.95it/s] 58%|█████▊    | 273/471 [01:30<01:11,  2.78it/s] 58%|█████▊    | 274/471 [01:31<01:11,  2.77it/s] 58%|█████▊    | 275/471 [01:31<01:08,  2.87it/s] 59%|█████▊    | 276/471 [01:31<01:08,  2.85it/s] 59%|█████▉    | 277/471 [01:32<01:10,  2.76it/s] 59%|█████▉    | 278/471 [01:32<01:08,  2.84it/s] 59%|█████▉    | 279/471 [01:32<01:06,  2.88it/s] 59%|█████▉    | 280/471 [01:33<01:10,  2.72it/s] 60%|█████▉    | 281/471 [01:33<01:07,  2.80it/s] 60%|█████▉    | 282/471 [01:33<01:05,  2.89it/s] 60%|██████    | 283/471 [01:34<01:08,  2.73it/s] 60%|██████    | 284/471 [01:34<01:07,  2.77it/s] 61%|██████    | 285/471 [01:35<01:03,  2.91it/s] 61%|██████    | 286/471 [01:35<01:07,  2.75it/s] 61%|██████    | 287/471 [01:35<01:07,  2.73it/s] 61%|██████    | 288/471 [01:36<01:04,  2.82it/s] 61%|██████▏   | 289/471 [01:36<01:01,  2.95it/s] 62%|██████▏   | 290/471 [01:36<01:05,  2.78it/s] 62%|██████▏   | 291/471 [01:37<01:03,  2.83it/s] 62%|██████▏   | 292/471 [01:37<01:01,  2.93it/s] 62%|██████▏   | 293/471 [01:37<01:04,  2.77it/s] 62%|██████▏   | 294/471 [01:38<01:03,  2.77it/s] 63%|██████▎   | 295/471 [01:38<01:01,  2.88it/s] 63%|██████▎   | 296/471 [01:38<01:01,  2.84it/s] 63%|██████▎   | 297/471 [01:39<01:03,  2.76it/s] 63%|██████▎   | 298/471 [01:39<01:01,  2.83it/s] 63%|██████▎   | 299/471 [01:40<01:00,  2.86it/s] 64%|██████▎   | 300/471 [01:40<01:03,  2.71it/s] 64%|██████▍   | 301/471 [01:40<01:00,  2.80it/s] 64%|██████▍   | 302/471 [01:41<00:59,  2.86it/s] 64%|██████▍   | 303/471 [01:41<01:02,  2.71it/s] 65%|██████▍   | 304/471 [01:41<00:59,  2.80it/s] 65%|██████▍   | 305/471 [01:42<00:56,  2.93it/s] 65%|██████▍   | 306/471 [01:42<00:59,  2.76it/s] 65%|██████▌   | 307/471 [01:42<00:59,  2.76it/s] 65%|██████▌   | 308/471 [01:43<00:56,  2.88it/s] 66%|██████▌   | 309/471 [01:43<00:58,  2.78it/s] 66%|██████▌   | 310/471 [01:43<00:58,  2.74it/s] 66%|██████▌   | 311/471 [01:44<00:56,  2.84it/s] 66%|██████▌   | 312/471 [01:44<00:50,  3.16it/s] 66%|██████▋   | 313/471 [01:44<00:43,  3.61it/s] 67%|██████▋   | 314/471 [01:44<00:39,  3.96it/s] 67%|██████▋   | 315/471 [01:45<00:36,  4.27it/s] 67%|██████▋   | 316/471 [01:45<00:34,  4.53it/s] 67%|██████▋   | 317/471 [01:45<00:32,  4.75it/s] 68%|██████▊   | 318/471 [01:45<00:31,  4.91it/s] 68%|██████▊   | 319/471 [01:45<00:30,  5.02it/s] 68%|██████▊   | 320/471 [01:46<00:29,  5.08it/s] 68%|██████▊   | 321/471 [01:46<00:29,  5.13it/s] 68%|██████▊   | 322/471 [01:46<00:28,  5.17it/s] 69%|██████▊   | 323/471 [01:46<00:28,  5.20it/s] 69%|██████▉   | 324/471 [01:46<00:28,  5.22it/s] 69%|██████▉   | 325/471 [01:46<00:27,  5.24it/s] 69%|██████▉   | 326/471 [01:47<00:27,  5.26it/s] 69%|██████▉   | 327/471 [01:47<00:27,  5.28it/s] 70%|██████▉   | 328/471 [01:47<00:27,  5.28it/s] 70%|██████▉   | 329/471 [01:47<00:27,  5.19it/s] 70%|███████   | 330/471 [01:47<00:27,  5.21it/s] 70%|███████   | 331/471 [01:48<00:26,  5.21it/s] 70%|███████   | 332/471 [01:48<00:26,  5.19it/s] 71%|███████   | 333/471 [01:48<00:26,  5.24it/s] 71%|███████   | 334/471 [01:48<00:26,  5.18it/s] 71%|███████   | 335/471 [01:49<00:30,  4.47it/s] 71%|███████▏  | 336/471 [01:49<00:37,  3.60it/s] 72%|███████▏  | 337/471 [01:49<00:39,  3.42it/s] 72%|███████▏  | 338/471 [01:50<00:39,  3.38it/s] 72%|███████▏  | 339/471 [01:50<00:43,  3.02it/s] 72%|███████▏  | 340/471 [01:50<00:44,  2.96it/s] 72%|███████▏  | 341/471 [01:51<00:42,  3.03it/s] 73%|███████▎  | 342/471 [01:51<00:44,  2.89it/s] 73%|███████▎  | 343/471 [01:51<00:45,  2.80it/s] 73%|███████▎  | 344/471 [01:52<00:44,  2.88it/s] 73%|███████▎  | 345/471 [01:52<00:43,  2.88it/s] 73%|███████▎  | 346/471 [01:52<00:45,  2.73it/s] 74%|███████▎  | 347/471 [01:53<00:43,  2.83it/s] 74%|███████▍  | 348/471 [01:53<00:42,  2.89it/s] 74%|███████▍  | 349/471 [01:54<00:44,  2.72it/s] 74%|███████▍  | 350/471 [01:54<00:42,  2.82it/s] 75%|███████▍  | 351/471 [01:54<00:40,  2.96it/s] 75%|███████▍  | 352/471 [01:55<00:42,  2.78it/s] 75%|███████▍  | 353/471 [01:55<00:42,  2.79it/s] 75%|███████▌  | 354/471 [01:55<00:40,  2.91it/s] 75%|███████▌  | 355/471 [01:56<00:41,  2.81it/s] 76%|███████▌  | 356/471 [01:56<00:41,  2.76it/s] 76%|███████▌  | 357/471 [01:56<00:39,  2.86it/s] 76%|███████▌  | 358/471 [01:57<00:37,  3.00it/s] 76%|███████▌  | 359/471 [01:57<00:40,  2.80it/s] 76%|███████▋  | 360/471 [01:57<00:39,  2.82it/s] 77%|███████▋  | 361/471 [01:58<00:37,  2.95it/s] 77%|███████▋  | 362/471 [01:58<00:38,  2.82it/s] 77%|███████▋  | 363/471 [01:58<00:39,  2.76it/s] 77%|███████▋  | 364/471 [01:59<00:37,  2.85it/s] 77%|███████▋  | 365/471 [01:59<00:37,  2.86it/s] 78%|███████▊  | 366/471 [02:00<00:38,  2.73it/s] 78%|███████▊  | 367/471 [02:00<00:36,  2.83it/s] 78%|███████▊  | 368/471 [02:00<00:35,  2.89it/s] 78%|███████▊  | 369/471 [02:01<00:37,  2.74it/s] 79%|███████▊  | 370/471 [02:01<00:35,  2.82it/s] 79%|███████▉  | 371/471 [02:01<00:34,  2.94it/s] 79%|███████▉  | 372/471 [02:02<00:35,  2.76it/s] 79%|███████▉  | 373/471 [02:02<00:35,  2.78it/s] 79%|███████▉  | 374/471 [02:02<00:33,  2.92it/s] 80%|███████▉  | 375/471 [02:03<00:34,  2.82it/s] 80%|███████▉  | 376/471 [02:03<00:34,  2.75it/s] 80%|████████  | 377/471 [02:03<00:32,  2.86it/s] 80%|████████  | 378/471 [02:04<00:32,  2.87it/s] 80%|████████  | 379/471 [02:04<00:33,  2.73it/s] 81%|████████  | 380/471 [02:04<00:32,  2.83it/s] 81%|████████  | 381/471 [02:05<00:29,  3.01it/s] 81%|████████  | 382/471 [02:05<00:31,  2.87it/s] 81%|████████▏ | 383/471 [02:06<00:31,  2.79it/s] 82%|████████▏ | 384/471 [02:06<00:30,  2.87it/s] 82%|████████▏ | 385/471 [02:06<00:30,  2.86it/s] 82%|████████▏ | 386/471 [02:07<00:30,  2.74it/s] 82%|████████▏ | 387/471 [02:07<00:29,  2.84it/s] 82%|████████▏ | 388/471 [02:07<00:28,  2.90it/s] 83%|████████▎ | 389/471 [02:08<00:29,  2.75it/s] 83%|████████▎ | 390/471 [02:08<00:28,  2.82it/s] 83%|████████▎ | 391/471 [02:08<00:27,  2.95it/s] 83%|████████▎ | 392/471 [02:09<00:28,  2.78it/s] 83%|████████▎ | 393/471 [02:09<00:28,  2.78it/s] 84%|████████▎ | 394/471 [02:09<00:26,  2.89it/s] 84%|████████▍ | 395/471 [02:10<00:26,  2.85it/s] 84%|████████▍ | 396/471 [02:10<00:27,  2.75it/s] 84%|████████▍ | 397/471 [02:10<00:25,  2.85it/s] 85%|████████▍ | 398/471 [02:11<00:25,  2.87it/s] 85%|████████▍ | 399/471 [02:11<00:26,  2.73it/s] 85%|████████▍ | 400/471 [02:12<00:25,  2.82it/s] 85%|████████▌ | 401/471 [02:12<00:24,  2.90it/s] 85%|████████▌ | 402/471 [02:12<00:25,  2.73it/s] 86%|████████▌ | 403/471 [02:13<00:24,  2.81it/s] 86%|████████▌ | 404/471 [02:13<00:22,  2.95it/s] 86%|████████▌ | 405/471 [02:13<00:22,  2.94it/s] 86%|████████▌ | 406/471 [02:14<00:23,  2.79it/s] 86%|████████▋ | 407/471 [02:14<00:22,  2.88it/s] 87%|████████▋ | 408/471 [02:14<00:21,  2.95it/s] 87%|████████▋ | 409/471 [02:15<00:22,  2.77it/s] 87%|████████▋ | 410/471 [02:15<00:21,  2.84it/s] 87%|████████▋ | 411/471 [02:15<00:20,  2.98it/s] 87%|████████▋ | 412/471 [02:16<00:21,  2.79it/s] 88%|████████▊ | 413/471 [02:16<00:20,  2.79it/s] 88%|████████▊ | 414/471 [02:16<00:19,  2.89it/s] 88%|████████▊ | 415/471 [02:17<00:19,  2.85it/s] 88%|████████▊ | 416/471 [02:17<00:19,  2.75it/s] 89%|████████▊ | 417/471 [02:17<00:18,  2.85it/s] 89%|████████▊ | 418/471 [02:18<00:18,  2.87it/s] 89%|████████▉ | 419/471 [02:18<00:19,  2.73it/s] 89%|████████▉ | 420/471 [02:19<00:18,  2.83it/s] 89%|████████▉ | 421/471 [02:19<00:17,  2.91it/s] 90%|████████▉ | 422/471 [02:19<00:17,  2.74it/s] 90%|████████▉ | 423/471 [02:20<00:17,  2.81it/s] 90%|█████████ | 424/471 [02:20<00:15,  2.96it/s] 90%|█████████ | 425/471 [02:20<00:16,  2.79it/s] 90%|█████████ | 426/471 [02:21<00:16,  2.78it/s] 91%|█████████ | 427/471 [02:21<00:15,  2.88it/s] 91%|█████████ | 428/471 [02:21<00:13,  3.07it/s] 91%|█████████ | 429/471 [02:22<00:14,  2.83it/s] 91%|█████████▏| 430/471 [02:22<00:14,  2.85it/s] 92%|█████████▏| 431/471 [02:22<00:13,  3.00it/s] 92%|█████████▏| 432/471 [02:23<00:13,  2.85it/s] 92%|█████████▏| 433/471 [02:23<00:13,  2.77it/s] 92%|█████████▏| 434/471 [02:23<00:13,  2.84it/s] 92%|█████████▏| 435/471 [02:24<00:12,  2.84it/s] 93%|█████████▎| 436/471 [02:24<00:12,  2.73it/s] 93%|█████████▎| 437/471 [02:25<00:12,  2.83it/s] 93%|█████████▎| 438/471 [02:25<00:11,  2.88it/s] 93%|█████████▎| 439/471 [02:25<00:11,  2.71it/s] 93%|█████████▎| 440/471 [02:26<00:11,  2.81it/s] 94%|█████████▎| 441/471 [02:26<00:10,  2.92it/s] 94%|█████████▍| 442/471 [02:26<00:10,  2.71it/s] 94%|█████████▍| 443/471 [02:27<00:10,  2.79it/s] 94%|█████████▍| 444/471 [02:27<00:09,  2.94it/s] 94%|█████████▍| 445/471 [02:27<00:09,  2.76it/s] 95%|█████████▍| 446/471 [02:28<00:09,  2.76it/s] 95%|█████████▍| 447/471 [02:28<00:08,  2.87it/s] 95%|█████████▌| 448/471 [02:28<00:07,  2.95it/s] 95%|█████████▌| 449/471 [02:29<00:07,  2.79it/s] 96%|█████████▌| 450/471 [02:29<00:07,  2.87it/s] 96%|█████████▌| 451/471 [02:29<00:06,  3.03it/s] 96%|█████████▌| 452/471 [02:30<00:05,  3.51it/s] 96%|█████████▌| 453/471 [02:30<00:04,  3.88it/s] 96%|█████████▋| 454/471 [02:30<00:04,  4.21it/s] 97%|█████████▋| 455/471 [02:30<00:03,  4.47it/s] 97%|█████████▋| 456/471 [02:30<00:03,  4.69it/s] 97%|█████████▋| 457/471 [02:31<00:02,  4.85it/s] 97%|█████████▋| 458/471 [02:31<00:02,  4.99it/s] 97%|█████████▋| 459/471 [02:31<00:02,  5.11it/s] 98%|█████████▊| 460/471 [02:31<00:02,  5.12it/s] 98%|█████████▊| 461/471 [02:31<00:01,  5.17it/s] 98%|█████████▊| 462/471 [02:31<00:01,  5.21it/s] 98%|█████████▊| 463/471 [02:32<00:01,  5.26it/s] 99%|█████████▊| 464/471 [02:32<00:01,  5.24it/s] 99%|█████████▊| 465/471 [02:32<00:01,  5.29it/s] 99%|█████████▉| 466/471 [02:32<00:00,  5.30it/s] 99%|█████████▉| 467/471 [02:32<00:00,  5.28it/s] 99%|█████████▉| 468/471 [02:33<00:00,  5.28it/s]100%|█████████▉| 469/471 [02:33<00:00,  5.28it/s]100%|█████████▉| 470/471 [02:33<00:00,  5.26it/s]100%|██████████| 471/471 [02:33<00:00,  5.65it/s]100%|██████████| 471/471 [02:33<00:00,  3.07it/s]
{'eval_loss': 3.7295217514038086, 'eval_model_preparation_time': 0.0051, 'eval_acc': 0.25265533722782796, 'eval_runtime': 153.9809, 'eval_samples_per_second': 48.915, 'eval_steps_per_second': 3.059}
ROUND:10
CLIENT:26
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.58it/s]                                              {'loss': 5.3351, 'grad_norm': 11.210938453674316, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.58it/s]  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]                                              {'loss': 2.0968, 'grad_norm': 8.92482852935791, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]  8%|▊         | 3/40 [00:02<00:24,  1.48it/s]                                              {'loss': 1.9237, 'grad_norm': 10.672161102294922, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.48it/s] 10%|█         | 4/40 [00:02<00:22,  1.58it/s]                                              {'loss': 1.735, 'grad_norm': 14.038208961486816, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:22,  1.58it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s]                                              {'loss': 1.7432, 'grad_norm': 14.838132858276367, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.51it/s]                                              {'loss': 1.6912, 'grad_norm': 12.28031063079834, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.51it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s]                                              {'loss': 2.2526, 'grad_norm': 14.135414123535156, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s] 20%|██        | 8/40 [00:04<00:15,  2.02it/s]                                              {'loss': 6.008, 'grad_norm': 87.1463394165039, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.02it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.79it/s]                                              {'loss': 1.0297, 'grad_norm': 10.650755882263184, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.79it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s]                                               {'loss': 0.7424, 'grad_norm': 6.890232563018799, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s]                                               {'loss': 1.3061, 'grad_norm': 11.096977233886719, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s] 30%|███       | 12/40 [00:07<00:17,  1.57it/s]                                               {'loss': 0.4999, 'grad_norm': 2.7605960369110107, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.57it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.8053, 'grad_norm': 6.015315055847168, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.54it/s]                                               {'loss': 0.5871, 'grad_norm': 5.302842617034912, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.54it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.50it/s]                                               {'loss': 1.2999, 'grad_norm': 7.979082107543945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.50it/s]                                               {'loss': 0.511, 'grad_norm': 8.063417434692383, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.50it/s] 42%|████▎     | 17/40 [00:10<00:11,  1.92it/s]                                               {'loss': 0.3271, 'grad_norm': 3.083529233932495, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:11,  1.92it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.78it/s]                                               {'loss': 0.3042, 'grad_norm': 3.040616750717163, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.78it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.66it/s]                                               {'loss': 0.8034, 'grad_norm': 7.102262020111084, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.66it/s] 50%|█████     | 20/40 [00:12<00:12,  1.66it/s]                                               {'loss': 0.5903, 'grad_norm': 7.710798740386963, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.66it/s] 52%|█████▎    | 21/40 [00:12<00:12,  1.58it/s]                                               {'loss': 0.2987, 'grad_norm': 4.02249813079834, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:12,  1.58it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.55it/s]                                               {'loss': 0.6293, 'grad_norm': 5.151461124420166, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.55it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.4568, 'grad_norm': 5.471643924713135, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.0983, 'grad_norm': 5.413337230682373, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.56it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.89it/s]                                               {'loss': 0.0362, 'grad_norm': 0.9237082600593567, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.89it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s]                                               {'loss': 0.3047, 'grad_norm': 7.415008068084717, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.70it/s]                                               {'loss': 0.3317, 'grad_norm': 6.3979339599609375, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.70it/s] 70%|███████   | 28/40 [00:17<00:07,  1.61it/s]                                               {'loss': 0.3702, 'grad_norm': 4.7855143547058105, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.61it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.64it/s]                                               {'loss': 0.3741, 'grad_norm': 3.385463237762451, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.64it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s]                                               {'loss': 0.2742, 'grad_norm': 3.686121940612793, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.55it/s]                                               {'loss': 0.6825, 'grad_norm': 3.19281005859375, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.55it/s] 80%|████████  | 32/40 [00:19<00:03,  2.06it/s]                                               {'loss': 0.016, 'grad_norm': 1.1365013122558594, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:03,  2.06it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.93it/s]                                               {'loss': 0.2781, 'grad_norm': 7.898726940155029, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.93it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.71it/s]                                               {'loss': 0.108, 'grad_norm': 2.676382064819336, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.71it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.65it/s]                                               {'loss': 0.2696, 'grad_norm': 4.633811950683594, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.65it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s]                                               {'loss': 0.3117, 'grad_norm': 1.096509337425232, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.59it/s]                                               {'loss': 0.1641, 'grad_norm': 2.9826560020446777, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.59it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.62it/s]                                               {'loss': 0.1339, 'grad_norm': 3.6227846145629883, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.62it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]                                               {'loss': 0.1069, 'grad_norm': 2.0814361572265625, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]100%|██████████| 40/40 [00:23<00:00,  2.07it/s]                                               {'loss': 0.1811, 'grad_norm': 8.615594863891602, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.07it/s]                                               {'train_runtime': 24.156, 'train_samples_per_second': 23.39, 'train_steps_per_second': 1.656, 'train_loss': 0.9254481893032789, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.07it/s]100%|██████████| 40/40 [00:24<00:00,  1.66it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.77it/s]                                              {'loss': 4.7023, 'grad_norm': 9.747506141662598, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.77it/s]  5%|▌         | 2/40 [00:00<00:13,  2.80it/s]                                              {'loss': 3.1338, 'grad_norm': 11.65187931060791, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.80it/s]  8%|▊         | 3/40 [00:01<00:12,  2.86it/s]                                              {'loss': 2.8789, 'grad_norm': 10.724233627319336, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.86it/s] 10%|█         | 4/40 [00:01<00:12,  2.83it/s]                                              {'loss': 2.0669, 'grad_norm': 14.9299955368042, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.83it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.85it/s]                                              {'loss': 1.7244, 'grad_norm': 20.821727752685547, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.85it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.85it/s]                                              {'loss': 2.0198, 'grad_norm': 22.72237205505371, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.85it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.86it/s]                                              {'loss': 1.863, 'grad_norm': 20.94976043701172, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.86it/s]                                              {'loss': 1.7952, 'grad_norm': 91.33585357666016, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.86it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.67it/s]                                              {'loss': 1.3471, 'grad_norm': 19.597919464111328, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.67it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.62it/s]                                               {'loss': 2.0103, 'grad_norm': 18.376142501831055, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.62it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.26it/s]                                               {'loss': 1.1831, 'grad_norm': 15.787955284118652, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.26it/s] 30%|███       | 12/40 [00:04<00:14,  1.95it/s]                                               {'loss': 0.5253, 'grad_norm': 6.120227336883545, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:14,  1.95it/s] 32%|███▎      | 13/40 [00:05<00:15,  1.77it/s]                                               {'loss': 0.8962, 'grad_norm': 10.612883567810059, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:15,  1.77it/s] 35%|███▌      | 14/40 [00:06<00:14,  1.76it/s]                                               {'loss': 1.6784, 'grad_norm': 26.280916213989258, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:14,  1.76it/s] 38%|███▊      | 15/40 [00:06<00:15,  1.62it/s]                                               {'loss': 0.7775, 'grad_norm': 5.841262340545654, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:15,  1.62it/s]                                               {'loss': 0.1972, 'grad_norm': 7.847394943237305, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:14,  1.62it/s] 42%|████▎     | 17/40 [00:07<00:11,  1.96it/s]                                               {'loss': 1.4121, 'grad_norm': 12.443891525268555, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:11,  1.96it/s] 45%|████▌     | 18/40 [00:08<00:11,  1.89it/s]                                               {'loss': 0.6973, 'grad_norm': 28.384557723999023, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:11,  1.89it/s] 48%|████▊     | 19/40 [00:08<00:12,  1.72it/s]                                               {'loss': 0.6104, 'grad_norm': 5.002181053161621, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:12,  1.72it/s] 50%|█████     | 20/40 [00:09<00:12,  1.66it/s]                                               {'loss': 1.225, 'grad_norm': 5.396994590759277, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:12,  1.66it/s] 52%|█████▎    | 21/40 [00:10<00:11,  1.61it/s]                                               {'loss': 0.7853, 'grad_norm': 5.152384281158447, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:11,  1.61it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.57it/s]                                               {'loss': 0.9236, 'grad_norm': 7.822929382324219, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:11<00:10,  1.63it/s]                                               {'loss': 0.8416, 'grad_norm': 8.690675735473633, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:10,  1.63it/s] 60%|██████    | 24/40 [00:11<00:07,  2.14it/s]                                               {'loss': 0.2994, 'grad_norm': 10.391111373901367, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:07,  2.14it/s] 62%|██████▎   | 25/40 [00:12<00:08,  1.85it/s]                                               {'loss': 0.1629, 'grad_norm': 1.6431756019592285, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:08,  1.85it/s] 65%|██████▌   | 26/40 [00:13<00:08,  1.71it/s]                                               {'loss': 0.8319, 'grad_norm': 9.300677299499512, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:08,  1.71it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.70it/s]                                               {'loss': 0.3391, 'grad_norm': 4.734594345092773, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.70it/s] 70%|███████   | 28/40 [00:14<00:07,  1.58it/s]                                               {'loss': 0.4346, 'grad_norm': 7.765801429748535, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.58it/s] 72%|███████▎  | 29/40 [00:15<00:07,  1.56it/s]                                               {'loss': 0.6122, 'grad_norm': 5.265128135681152, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:07,  1.56it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.55it/s]                                               {'loss': 0.1497, 'grad_norm': 3.8041155338287354, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.55it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.51it/s]                                               {'loss': 0.382, 'grad_norm': 5.256545066833496, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.51it/s]                                               {'loss': 0.1471, 'grad_norm': 8.813749313354492, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.51it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.89it/s]                                               {'loss': 0.2328, 'grad_norm': 2.8929672241210938, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.89it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.79it/s]                                               {'loss': 0.1088, 'grad_norm': 2.323178768157959, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.79it/s] 88%|████████▊ | 35/40 [00:18<00:03,  1.67it/s]                                               {'loss': 0.2024, 'grad_norm': 3.018660306930542, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:03,  1.67it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.64it/s]                                               {'loss': 0.7148, 'grad_norm': 10.636516571044922, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.64it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s]                                               {'loss': 0.111, 'grad_norm': 1.4414280652999878, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.53it/s]                                               {'loss': 0.3872, 'grad_norm': 4.240980625152588, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.53it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]                                               {'loss': 0.3332, 'grad_norm': 5.892779350280762, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]100%|██████████| 40/40 [00:21<00:00,  2.08it/s]                                               {'loss': 0.4846, 'grad_norm': 19.95535659790039, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.08it/s]                                               {'train_runtime': 21.5179, 'train_samples_per_second': 26.257, 'train_steps_per_second': 1.859, 'train_loss': 1.0307022025808692, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.08it/s]100%|██████████| 40/40 [00:21<00:00,  1.86it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:25,  1.51it/s]                                              {'loss': 3.2763, 'grad_norm': 8.93812370300293, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:25,  1.51it/s]  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]                                              {'loss': 3.373, 'grad_norm': 8.63823127746582, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s]                                              {'loss': 1.6811, 'grad_norm': 13.136470794677734, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:23,  1.50it/s]                                              {'loss': 1.203, 'grad_norm': 13.964057922363281, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.50it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 2.2962, 'grad_norm': 20.650297164916992, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s]                                              {'loss': 1.8087, 'grad_norm': 16.62980079650879, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:20,  1.57it/s]                                              {'loss': 1.7889, 'grad_norm': 15.73081111907959, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:20,  1.57it/s]                                              {'loss': 3.374, 'grad_norm': 118.56883239746094, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:20,  1.57it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.37it/s]                                              {'loss': 0.7507, 'grad_norm': 6.356728553771973, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.37it/s] 25%|██▌       | 10/40 [00:05<00:11,  2.51it/s]                                               {'loss': 1.3934, 'grad_norm': 10.9437255859375, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:11,  2.51it/s] 28%|██▊       | 11/40 [00:05<00:11,  2.63it/s]                                               {'loss': 1.4801, 'grad_norm': 15.833518981933594, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:11,  2.63it/s] 30%|███       | 12/40 [00:05<00:10,  2.70it/s]                                               {'loss': 1.6018, 'grad_norm': 17.21205711364746, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:10,  2.70it/s] 32%|███▎      | 13/40 [00:06<00:09,  2.76it/s]                                               {'loss': 1.1738, 'grad_norm': 13.981045722961426, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:09,  2.76it/s] 35%|███▌      | 14/40 [00:06<00:09,  2.79it/s]                                               {'loss': 1.2115, 'grad_norm': 11.20828914642334, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:09,  2.79it/s] 38%|███▊      | 15/40 [00:07<00:08,  2.80it/s]                                               {'loss': 0.8623, 'grad_norm': 7.11452579498291, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:08,  2.80it/s]                                               {'loss': 0.0062, 'grad_norm': 0.4393036961555481, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:07,  2.95it/s]                                               {'loss': 0.7754, 'grad_norm': 7.332317352294922, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:07,  2.95it/s] 45%|████▌     | 18/40 [00:08<00:09,  2.41it/s]                                               {'loss': 0.2254, 'grad_norm': 3.190934419631958, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:09,  2.41it/s] 48%|████▊     | 19/40 [00:08<00:10,  2.06it/s]                                               {'loss': 0.4045, 'grad_norm': 9.60367488861084, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:10,  2.06it/s] 50%|█████     | 20/40 [00:09<00:10,  1.94it/s]                                               {'loss': 0.3504, 'grad_norm': 5.48054313659668, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:10,  1.94it/s] 52%|█████▎    | 21/40 [00:10<00:10,  1.75it/s]                                               {'loss': 0.4675, 'grad_norm': 4.042982578277588, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:10,  1.75it/s] 55%|█████▌    | 22/40 [00:10<00:10,  1.65it/s]                                               {'loss': 0.781, 'grad_norm': 7.658268928527832, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:10,  1.65it/s] 57%|█████▊    | 23/40 [00:11<00:10,  1.65it/s]                                               {'loss': 0.6439, 'grad_norm': 6.506425857543945, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:10,  1.65it/s]                                               {'loss': 0.2209, 'grad_norm': 10.426530838012695, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:09,  1.65it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.95it/s]                                               {'loss': 0.4444, 'grad_norm': 7.491307258605957, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.95it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.81it/s]                                               {'loss': 0.7097, 'grad_norm': 7.858357906341553, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.81it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.77it/s]                                               {'loss': 0.9153, 'grad_norm': 4.9749531745910645, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.77it/s] 70%|███████   | 28/40 [00:14<00:07,  1.64it/s]                                               {'loss': 0.3204, 'grad_norm': 5.444485664367676, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.64it/s] 72%|███████▎  | 29/40 [00:14<00:06,  1.65it/s]                                               {'loss': 0.2942, 'grad_norm': 4.825541973114014, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:06,  1.65it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.57it/s]                                               {'loss': 0.0527, 'grad_norm': 1.4088432788848877, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.57it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.53it/s]                                               {'loss': 0.137, 'grad_norm': 2.3867692947387695, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.53it/s]                                               {'loss': 0.0022, 'grad_norm': 0.12117128819227219, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.53it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.93it/s]                                               {'loss': 0.4317, 'grad_norm': 0.5230199098587036, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.93it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.77it/s]                                               {'loss': 0.0425, 'grad_norm': 1.1863189935684204, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.68it/s]                                               {'loss': 0.2949, 'grad_norm': 3.6001272201538086, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.68it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.67it/s]                                               {'loss': 0.3553, 'grad_norm': 0.7726695537567139, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.67it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.57it/s]                                               {'loss': 0.1358, 'grad_norm': 4.946189880371094, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.56it/s]                                               {'loss': 0.418, 'grad_norm': 5.562319755554199, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.54it/s]                                               {'loss': 0.2088, 'grad_norm': 3.431759834289551, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.54it/s]                                               {'loss': 0.0516, 'grad_norm': 4.137948513031006, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.54it/s]                                               {'train_runtime': 21.4763, 'train_samples_per_second': 26.308, 'train_steps_per_second': 1.863, 'train_loss': 0.8991103687847499, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.54it/s]100%|██████████| 40/40 [00:21<00:00,  1.86it/s]
CLIENT:86
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.38it/s]                                              {'loss': 3.8088, 'grad_norm': 9.217304229736328, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.38it/s]  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]                                              {'loss': 3.4494, 'grad_norm': 12.853209495544434, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s]                                              {'loss': 1.4009, 'grad_norm': 9.584178924560547, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:25,  1.42it/s]                                              {'loss': 1.7838, 'grad_norm': 11.626188278198242, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:25,  1.42it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s]                                              {'loss': 1.3924, 'grad_norm': 10.190619468688965, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s]                                              {'loss': 1.0268, 'grad_norm': 8.403051376342773, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s]                                              {'loss': 1.7967, 'grad_norm': 13.162816047668457, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s]                                              {'loss': 9.1357, 'grad_norm': 101.08654022216797, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.93it/s]                                              {'loss': 0.8051, 'grad_norm': 5.6521759033203125, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.93it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s]                                               {'loss': 0.8451, 'grad_norm': 7.567854404449463, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s]                                               {'loss': 0.5197, 'grad_norm': 5.678178310394287, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s] 30%|███       | 12/40 [00:07<00:17,  1.61it/s]                                               {'loss': 0.5302, 'grad_norm': 4.553271293640137, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.54it/s]                                               {'loss': 0.3971, 'grad_norm': 4.148176193237305, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.54it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.56it/s]                                               {'loss': 0.2274, 'grad_norm': 2.830441474914551, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.56it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 0.4398, 'grad_norm': 7.302028656005859, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 0.9989, 'grad_norm': 41.33376693725586, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.52it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.85it/s]                                               {'loss': 0.2771, 'grad_norm': 2.4615254402160645, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.85it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.77it/s]                                               {'loss': 0.2541, 'grad_norm': 7.2591328620910645, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.77it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.66it/s]                                               {'loss': 0.1513, 'grad_norm': 2.9679744243621826, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.66it/s] 50%|█████     | 20/40 [00:12<00:12,  1.58it/s]                                               {'loss': 0.1051, 'grad_norm': 2.104712724685669, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.58it/s] 52%|█████▎    | 21/40 [00:13<00:11,  1.61it/s]                                               {'loss': 0.1717, 'grad_norm': 2.495697498321533, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:11,  1.61it/s] 55%|█████▌    | 22/40 [00:13<00:09,  1.84it/s]                                               {'loss': 0.0904, 'grad_norm': 1.1959724426269531, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:09,  1.84it/s] 57%|█████▊    | 23/40 [00:13<00:08,  2.06it/s]                                               {'loss': 0.082, 'grad_norm': 1.9284939765930176, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:08,  2.06it/s]                                               {'loss': 0.0178, 'grad_norm': 0.4480012059211731, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:07,  2.06it/s] 62%|██████▎   | 25/40 [00:14<00:05,  2.80it/s]                                               {'loss': 0.1077, 'grad_norm': 3.2850258350372314, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:05,  2.80it/s] 65%|██████▌   | 26/40 [00:14<00:04,  2.83it/s]                                               {'loss': 0.0468, 'grad_norm': 1.036574125289917, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:04,  2.83it/s] 68%|██████▊   | 27/40 [00:14<00:04,  2.85it/s]                                               {'loss': 0.0343, 'grad_norm': 1.0924757719039917, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:04,  2.85it/s] 70%|███████   | 28/40 [00:15<00:04,  2.86it/s]                                               {'loss': 0.0195, 'grad_norm': 0.5410100817680359, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:04,  2.86it/s] 72%|███████▎  | 29/40 [00:15<00:03,  2.83it/s]                                               {'loss': 0.0558, 'grad_norm': 1.3741503953933716, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:03,  2.83it/s] 75%|███████▌  | 30/40 [00:15<00:03,  2.83it/s]                                               {'loss': 0.204, 'grad_norm': 2.4284701347351074, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:03,  2.83it/s] 78%|███████▊  | 31/40 [00:16<00:03,  2.85it/s]                                               {'loss': 0.0473, 'grad_norm': 0.8533777594566345, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:03,  2.85it/s]                                               {'loss': 0.0312, 'grad_norm': 0.8951460719108582, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:16<00:02,  3.48it/s]                                               {'loss': 0.0482, 'grad_norm': 1.9943956136703491, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:02,  3.48it/s] 85%|████████▌ | 34/40 [00:17<00:02,  2.54it/s]                                               {'loss': 0.0664, 'grad_norm': 1.0795488357543945, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:02,  2.54it/s] 88%|████████▊ | 35/40 [00:18<00:02,  2.14it/s]                                               {'loss': 0.0097, 'grad_norm': 0.2777051031589508, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  2.14it/s] 90%|█████████ | 36/40 [00:18<00:02,  1.92it/s]                                               {'loss': 0.0832, 'grad_norm': 5.0197343826293945, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:02,  1.92it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.75it/s]                                               {'loss': 0.0672, 'grad_norm': 1.599880337715149, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.75it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.72it/s]                                               {'loss': 0.2233, 'grad_norm': 5.235777378082275, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.72it/s] 98%|█████████▊| 39/40 [00:20<00:00,  1.62it/s]                                               {'loss': 0.0174, 'grad_norm': 0.3225647509098053, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  1.62it/s]                                               {'loss': 0.0002, 'grad_norm': 0.010632204823195934, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.62it/s]                                               {'train_runtime': 21.0858, 'train_samples_per_second': 26.795, 'train_steps_per_second': 1.897, 'train_loss': 0.7692466572876583, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.62it/s]100%|██████████| 40/40 [00:21<00:00,  1.90it/s]
CLIENT:76
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]                                              {'loss': 3.5104, 'grad_norm': 9.269376754760742, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]  5%|▌         | 2/40 [00:01<00:24,  1.57it/s]                                              {'loss': 3.372, 'grad_norm': 11.832758903503418, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.57it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s]                                              {'loss': 1.9467, 'grad_norm': 12.065406799316406, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.49it/s]                                              {'loss': 1.4861, 'grad_norm': 14.62570858001709, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.49it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s]                                              {'loss': 2.5613, 'grad_norm': 21.17161750793457, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s]                                              {'loss': 2.0875, 'grad_norm': 20.124717712402344, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s]                                              {'loss': 1.3116, 'grad_norm': 12.09943675994873, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s]                                              {'loss': 4.7411, 'grad_norm': 78.04631042480469, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.49it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.88it/s]                                              {'loss': 0.8329, 'grad_norm': 10.644477844238281, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.88it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s]                                               {'loss': 1.0452, 'grad_norm': 10.683356285095215, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s] 28%|██▊       | 11/40 [00:06<00:16,  1.73it/s]                                               {'loss': 0.837, 'grad_norm': 7.579843521118164, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:16,  1.73it/s] 30%|███       | 12/40 [00:07<00:17,  1.61it/s]                                               {'loss': 0.8934, 'grad_norm': 8.630258560180664, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s]                                               {'loss': 0.6112, 'grad_norm': 5.05048131942749, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s]                                               {'loss': 0.8545, 'grad_norm': 7.403392791748047, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.49it/s]                                               {'loss': 0.4607, 'grad_norm': 5.455170154571533, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.49it/s]                                               {'loss': 0.0844, 'grad_norm': 5.9203057289123535, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.49it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.16, 'grad_norm': 3.4983372688293457, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s]                                               {'loss': 0.3825, 'grad_norm': 3.347649097442627, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.64it/s]                                               {'loss': 0.4441, 'grad_norm': 3.071133852005005, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.64it/s] 50%|█████     | 20/40 [00:12<00:12,  1.64it/s]                                               {'loss': 0.812, 'grad_norm': 9.524612426757812, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.64it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s]                                               {'loss': 0.1794, 'grad_norm': 2.651031255722046, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.51it/s]                                               {'loss': 0.3393, 'grad_norm': 5.811954021453857, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.51it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.1886, 'grad_norm': 2.827145576477051, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.3483, 'grad_norm': 22.349679946899414, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.56it/s] 62%|██████▎   | 25/40 [00:14<00:06,  2.25it/s]                                               {'loss': 0.1629, 'grad_norm': 2.0966687202453613, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:06,  2.25it/s] 65%|██████▌   | 26/40 [00:15<00:05,  2.39it/s]                                               {'loss': 0.4266, 'grad_norm': 2.058497667312622, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:05,  2.39it/s] 68%|██████▊   | 27/40 [00:15<00:05,  2.51it/s]                                               {'loss': 0.1308, 'grad_norm': 3.0250442028045654, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:05,  2.51it/s] 70%|███████   | 28/40 [00:15<00:04,  2.59it/s]                                               {'loss': 0.0791, 'grad_norm': 1.8309122323989868, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:04,  2.59it/s] 72%|███████▎  | 29/40 [00:16<00:04,  2.66it/s]                                               {'loss': 0.22, 'grad_norm': 5.605910301208496, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:04,  2.66it/s] 75%|███████▌  | 30/40 [00:16<00:03,  2.73it/s]                                               {'loss': 0.2308, 'grad_norm': 3.984309434890747, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:03,  2.73it/s] 78%|███████▊  | 31/40 [00:16<00:03,  2.75it/s]                                               {'loss': 0.084, 'grad_norm': 1.774901032447815, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:03,  2.75it/s]                                               {'loss': 0.2247, 'grad_norm': 11.608196258544922, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:02,  2.75it/s] 82%|████████▎ | 33/40 [00:17<00:02,  3.41it/s]                                               {'loss': 0.1834, 'grad_norm': 2.2436208724975586, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:02,  3.41it/s] 85%|████████▌ | 34/40 [00:17<00:02,  2.98it/s]                                               {'loss': 0.0447, 'grad_norm': 1.0642539262771606, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:02,  2.98it/s] 88%|████████▊ | 35/40 [00:18<00:02,  2.34it/s]                                               {'loss': 0.0607, 'grad_norm': 1.0478862524032593, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  2.34it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.97it/s]                                               {'loss': 0.0813, 'grad_norm': 1.5204143524169922, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.97it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.89it/s]                                               {'loss': 0.0415, 'grad_norm': 1.015918493270874, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.89it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.70it/s]                                               {'loss': 0.2794, 'grad_norm': 1.2325011491775513, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.70it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.63it/s]                                               {'loss': 0.048, 'grad_norm': 1.9595669507980347, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.63it/s]100%|██████████| 40/40 [00:21<00:00,  2.16it/s]                                               {'loss': 0.0099, 'grad_norm': 0.7689659595489502, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.16it/s]                                               {'train_runtime': 21.5304, 'train_samples_per_second': 26.242, 'train_steps_per_second': 1.858, 'train_loss': 0.7949506816687062, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.16it/s]100%|██████████| 40/40 [00:21<00:00,  1.86it/s]
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]                                              {'loss': 3.6058, 'grad_norm': 9.668071746826172, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:26,  1.42it/s]                                              {'loss': 3.1895, 'grad_norm': 10.53475570678711, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.42it/s]  8%|▊         | 3/40 [00:02<00:24,  1.49it/s]                                              {'loss': 2.0264, 'grad_norm': 10.015686988830566, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s]                                              {'loss': 1.7072, 'grad_norm': 9.404746055603027, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s]                                              {'loss': 1.8018, 'grad_norm': 15.464454650878906, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.51it/s]                                              {'loss': 1.6194, 'grad_norm': 11.739361763000488, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.51it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 2.3259, 'grad_norm': 16.33666229248047, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 1.8161, 'grad_norm': 1.5595017671585083, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.82it/s]                                              {'loss': 0.9178, 'grad_norm': 11.519970893859863, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.82it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.80it/s]                                               {'loss': 0.83, 'grad_norm': 5.197554588317871, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.80it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.65it/s]                                               {'loss': 1.5844, 'grad_norm': 10.22686767578125, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.65it/s] 30%|███       | 12/40 [00:07<00:17,  1.62it/s]                                               {'loss': 1.7146, 'grad_norm': 7.27540922164917, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.62it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.6314, 'grad_norm': 9.035724639892578, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.51it/s]                                               {'loss': 1.0763, 'grad_norm': 6.504470348358154, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.51it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.4943, 'grad_norm': 5.645166397094727, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 1.8045, 'grad_norm': 36.964149475097656, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.54it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s]                                               {'loss': 0.5806, 'grad_norm': 4.197142124176025, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.73it/s]                                               {'loss': 0.3989, 'grad_norm': 3.8143041133880615, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.73it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.70it/s]                                               {'loss': 0.7041, 'grad_norm': 6.598702430725098, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.70it/s] 50%|█████     | 20/40 [00:12<00:12,  1.61it/s]                                               {'loss': 0.8128, 'grad_norm': 6.323305606842041, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.61it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.55it/s]                                               {'loss': 0.2937, 'grad_norm': 5.5794677734375, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.55it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.59it/s]                                               {'loss': 0.7311, 'grad_norm': 6.67482852935791, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.59it/s] 57%|█████▊    | 23/40 [00:14<00:09,  1.80it/s]                                               {'loss': 1.0343, 'grad_norm': 10.234766006469727, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:09,  1.80it/s]                                               {'loss': 0.0405, 'grad_norm': 2.35513973236084, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:08,  1.80it/s] 62%|██████▎   | 25/40 [00:14<00:05,  2.55it/s]                                               {'loss': 0.3229, 'grad_norm': 4.213584899902344, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:05,  2.55it/s] 65%|██████▌   | 26/40 [00:14<00:05,  2.64it/s]                                               {'loss': 0.833, 'grad_norm': 7.934391498565674, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:05,  2.64it/s] 68%|██████▊   | 27/40 [00:15<00:04,  2.71it/s]                                               {'loss': 0.2882, 'grad_norm': 5.303821086883545, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:04,  2.71it/s] 70%|███████   | 28/40 [00:15<00:04,  2.73it/s]                                               {'loss': 0.0809, 'grad_norm': 1.767042875289917, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:04,  2.73it/s] 72%|███████▎  | 29/40 [00:15<00:03,  2.77it/s]                                               {'loss': 0.4609, 'grad_norm': 3.762840509414673, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:03,  2.77it/s] 75%|███████▌  | 30/40 [00:16<00:03,  2.81it/s]                                               {'loss': 0.6646, 'grad_norm': 3.294283390045166, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:03,  2.81it/s] 78%|███████▊  | 31/40 [00:16<00:03,  2.29it/s]                                               {'loss': 0.4751, 'grad_norm': 4.0116400718688965, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:03,  2.29it/s]                                               {'loss': 0.309, 'grad_norm': 16.620574951171875, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:03,  2.29it/s] 82%|████████▎ | 33/40 [00:17<00:02,  2.50it/s]                                               {'loss': 0.1184, 'grad_norm': 1.9770714044570923, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:02,  2.50it/s] 85%|████████▌ | 34/40 [00:18<00:02,  2.09it/s]                                               {'loss': 0.1647, 'grad_norm': 2.1011133193969727, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:02,  2.09it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.86it/s]                                               {'loss': 0.2873, 'grad_norm': 2.4721662998199463, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.86it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.80it/s]                                               {'loss': 1.1379, 'grad_norm': 1.967352032661438, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.80it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.65it/s]                                               {'loss': 0.2201, 'grad_norm': 2.178248167037964, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.65it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.61it/s]                                               {'loss': 0.1332, 'grad_norm': 2.5133235454559326, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.61it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]                                               {'loss': 0.0869, 'grad_norm': 1.414398193359375, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]                                               {'loss': 0.0018, 'grad_norm': 0.1159089207649231, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.57it/s]                                               {'train_runtime': 21.9674, 'train_samples_per_second': 25.72, 'train_steps_per_second': 1.821, 'train_loss': 0.9331512797885807, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.57it/s]100%|██████████| 40/40 [00:21<00:00,  1.82it/s]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]                                              {'loss': 2.5537, 'grad_norm': 8.687479972839355, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:27,  1.40it/s]                                              {'loss': 2.4562, 'grad_norm': 11.18813705444336, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:27,  1.40it/s]  8%|▊         | 3/40 [00:02<00:24,  1.53it/s]                                              {'loss': 2.1856, 'grad_norm': 13.943133354187012, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.53it/s] 10%|█         | 4/40 [00:02<00:25,  1.44it/s]                                              {'loss': 2.0967, 'grad_norm': 17.748218536376953, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:25,  1.44it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s]                                              {'loss': 2.9409, 'grad_norm': 20.468067169189453, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s]                                              {'loss': 1.8097, 'grad_norm': 17.20551109313965, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s]                                              {'loss': 1.3575, 'grad_norm': 12.682879447937012, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:23,  1.43it/s]                                              {'loss': 0.3257, 'grad_norm': 19.843183517456055, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:22,  1.43it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.82it/s]                                              {'loss': 0.4747, 'grad_norm': 7.964259147644043, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.82it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s]                                               {'loss': 0.9755, 'grad_norm': 15.422555923461914, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.63it/s]                                               {'loss': 0.7396, 'grad_norm': 8.552107810974121, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.63it/s] 30%|███       | 12/40 [00:07<00:17,  1.64it/s]                                               {'loss': 0.9526, 'grad_norm': 9.999253273010254, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.64it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.56it/s]                                               {'loss': 0.8654, 'grad_norm': 6.460957050323486, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.56it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s]                                               {'loss': 1.3983, 'grad_norm': 10.362446784973145, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.56it/s]                                               {'loss': 0.7752, 'grad_norm': 4.892413139343262, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.56it/s] 40%|████      | 16/40 [00:09<00:11,  2.08it/s]                                               {'loss': 0.4287, 'grad_norm': 18.541229248046875, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:11,  2.08it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.82it/s]                                               {'loss': 0.4359, 'grad_norm': 5.974663257598877, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.82it/s] 45%|████▌     | 18/40 [00:11<00:13,  1.67it/s]                                               {'loss': 0.413, 'grad_norm': 4.1637678146362305, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:13,  1.67it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s]                                               {'loss': 0.6039, 'grad_norm': 6.198780059814453, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s] 50%|█████     | 20/40 [00:12<00:12,  1.55it/s]                                               {'loss': 0.522, 'grad_norm': 4.777952671051025, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.55it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.53it/s]                                               {'loss': 0.1656, 'grad_norm': 2.790431022644043, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.53it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.51it/s]                                               {'loss': 0.4044, 'grad_norm': 4.82480001449585, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.51it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.50it/s]                                               {'loss': 0.5449, 'grad_norm': 7.515633583068848, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.50it/s]                                               {'loss': 2.8385, 'grad_norm': 96.34734344482422, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.50it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.91it/s]                                               {'loss': 0.2773, 'grad_norm': 4.067089080810547, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:15<00:08,  1.75it/s]                                               {'loss': 0.0943, 'grad_norm': 1.8769131898880005, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:08,  1.75it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.65it/s]                                               {'loss': 0.5173, 'grad_norm': 6.714391231536865, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.65it/s] 70%|███████   | 28/40 [00:17<00:07,  1.66it/s]                                               {'loss': 0.0998, 'grad_norm': 2.5167293548583984, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.66it/s] 72%|███████▎  | 29/40 [00:17<00:07,  1.56it/s]                                               {'loss': 0.2487, 'grad_norm': 3.3423798084259033, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:07,  1.56it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.55it/s]                                               {'loss': 0.3712, 'grad_norm': 3.0230424404144287, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.55it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s]                                               {'loss': 0.1148, 'grad_norm': 1.9284387826919556, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s]                                               {'loss': 0.1709, 'grad_norm': 13.695317268371582, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.52it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.84it/s]                                               {'loss': 0.0996, 'grad_norm': 2.078134775161743, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.84it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.74it/s]                                               {'loss': 0.0658, 'grad_norm': 2.5256030559539795, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.74it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.67it/s]                                               {'loss': 0.1511, 'grad_norm': 1.9471461772918701, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.67it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.84it/s]                                               {'loss': 0.0997, 'grad_norm': 2.9159581661224365, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.84it/s] 92%|█████████▎| 37/40 [00:22<00:01,  2.05it/s]                                               {'loss': 0.0916, 'grad_norm': 1.5006271600723267, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  2.05it/s] 95%|█████████▌| 38/40 [00:22<00:00,  2.24it/s]                                               {'loss': 0.3477, 'grad_norm': 3.541135311126709, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:00,  2.24it/s] 98%|█████████▊| 39/40 [00:22<00:00,  2.39it/s]                                               {'loss': 0.1683, 'grad_norm': 2.8141977787017822, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  2.39it/s]                                               {'loss': 0.0293, 'grad_norm': 1.585087776184082, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.39it/s]                                               {'train_runtime': 23.2421, 'train_samples_per_second': 24.309, 'train_steps_per_second': 1.721, 'train_loss': 0.7802938098087907, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.39it/s]100%|██████████| 40/40 [00:23<00:00,  1.72it/s]
CLIENT:48
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]                                              {'loss': 3.0899, 'grad_norm': 7.945018768310547, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 2.6441, 'grad_norm': 9.783244132995605, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:02<00:27,  1.35it/s]                                              {'loss': 2.3118, 'grad_norm': 12.755817413330078, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.35it/s] 10%|█         | 4/40 [00:02<00:26,  1.36it/s]                                              {'loss': 3.4388, 'grad_norm': 20.609830856323242, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.36it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 1.0856, 'grad_norm': 11.290627479553223, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.36it/s]                                              {'loss': 2.0383, 'grad_norm': 16.264331817626953, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.36it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.8675, 'grad_norm': 15.925479888916016, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 4.1919, 'grad_norm': 104.66845703125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.35it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s]                                              {'loss': 0.4527, 'grad_norm': 5.930522441864014, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s]                                               {'loss': 0.9561, 'grad_norm': 9.73810863494873, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s]                                               {'loss': 0.9324, 'grad_norm': 9.577392578125, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s]                                               {'loss': 1.0658, 'grad_norm': 7.817007541656494, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.44it/s]                                               {'loss': 1.3278, 'grad_norm': 8.816333770751953, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:18,  1.44it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s]                                               {'loss': 0.4214, 'grad_norm': 4.4843010902404785, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 0.7598, 'grad_norm': 7.647045135498047, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 3.3292, 'grad_norm': 68.77877807617188, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.39it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s]                                               {'loss': 0.2792, 'grad_norm': 4.421179294586182, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.62it/s]                                               {'loss': 0.9382, 'grad_norm': 4.080682277679443, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.62it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.54it/s]                                               {'loss': 0.5379, 'grad_norm': 3.516176223754883, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.54it/s] 50%|█████     | 20/40 [00:13<00:13,  1.49it/s]                                               {'loss': 0.1535, 'grad_norm': 2.418483257293701, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.49it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.44it/s]                                               {'loss': 0.2712, 'grad_norm': 3.508537530899048, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.44it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s]                                               {'loss': 0.1677, 'grad_norm': 2.763007640838623, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.3546, 'grad_norm': 1.6911855936050415, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.1081, 'grad_norm': 5.542616367340088, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s]                                               {'loss': 0.3139, 'grad_norm': 1.0910820960998535, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.71it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s]                                               {'loss': 0.3511, 'grad_norm': 6.812330722808838, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s]                                               {'loss': 0.4194, 'grad_norm': 4.569118022918701, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s] 70%|███████   | 28/40 [00:18<00:08,  1.47it/s]                                               {'loss': 0.0621, 'grad_norm': 1.949638843536377, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.0955, 'grad_norm': 2.4620349407196045, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.2914, 'grad_norm': 9.879667282104492, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.40it/s]                                               {'loss': 0.4539, 'grad_norm': 3.308915853500366, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.40it/s]                                               {'loss': 0.507, 'grad_norm': 32.181121826171875, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.40it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s]                                               {'loss': 0.1434, 'grad_norm': 0.642512321472168, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s]                                               {'loss': 0.5039, 'grad_norm': 5.167394638061523, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s]                                               {'loss': 0.1154, 'grad_norm': 2.3563740253448486, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s]                                               {'loss': 0.3236, 'grad_norm': 3.7405121326446533, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s]                                               {'loss': 0.3758, 'grad_norm': 3.1274094581604004, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.42it/s]                                               {'loss': 0.3318, 'grad_norm': 3.97448468208313, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.42it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.0843, 'grad_norm': 2.57008695602417, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.0274, 'grad_norm': 1.7777485847473145, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]                                               {'train_runtime': 26.6882, 'train_samples_per_second': 21.17, 'train_steps_per_second': 1.499, 'train_loss': 0.9280811544507742, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]100%|██████████| 40/40 [00:26<00:00,  1.50it/s]
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.35it/s]                                              {'loss': 4.0685, 'grad_norm': 9.914416313171387, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.35it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 3.0616, 'grad_norm': 12.981451988220215, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:02<00:27,  1.34it/s]                                              {'loss': 1.8128, 'grad_norm': 13.334659576416016, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.34it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 3.1645, 'grad_norm': 21.513050079345703, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 2.0965, 'grad_norm': 16.09077262878418, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.36it/s]                                              {'loss': 2.1598, 'grad_norm': 14.355609893798828, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.36it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.0547, 'grad_norm': 14.408987045288086, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.7232, 'grad_norm': 63.80894470214844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.35it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s]                                              {'loss': 1.5595, 'grad_norm': 15.99846076965332, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s]                                               {'loss': 0.9976, 'grad_norm': 12.8150053024292, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s]                                               {'loss': 0.579, 'grad_norm': 7.572920322418213, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s]                                               {'loss': 0.8832, 'grad_norm': 7.277734756469727, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s]                                               {'loss': 0.7467, 'grad_norm': 6.403908729553223, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s]                                               {'loss': 1.0049, 'grad_norm': 6.678781509399414, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 1.165, 'grad_norm': 9.081939697265625, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 0.2444, 'grad_norm': 13.009976387023926, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.39it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s]                                               {'loss': 0.3066, 'grad_norm': 5.220696449279785, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.61it/s]                                               {'loss': 0.1646, 'grad_norm': 2.5072896480560303, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.61it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s]                                               {'loss': 0.8326, 'grad_norm': 8.453898429870605, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s]                                               {'loss': 0.9125, 'grad_norm': 9.721701622009277, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.3857, 'grad_norm': 5.878178119659424, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s]                                               {'loss': 0.3467, 'grad_norm': 6.426072597503662, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.5584, 'grad_norm': 3.1019551753997803, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.0496, 'grad_norm': 4.3327226638793945, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.70it/s]                                               {'loss': 0.212, 'grad_norm': 6.26287317276001, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.70it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s]                                               {'loss': 0.2418, 'grad_norm': 5.338083267211914, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s]                                               {'loss': 0.0778, 'grad_norm': 1.9593188762664795, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s] 70%|███████   | 28/40 [00:18<00:08,  1.47it/s]                                               {'loss': 0.1597, 'grad_norm': 3.552022695541382, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.6643, 'grad_norm': 6.9475836753845215, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.40it/s]                                               {'loss': 0.2772, 'grad_norm': 5.97957706451416, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.2009, 'grad_norm': 7.982181072235107, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.1078, 'grad_norm': 3.0049118995666504, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s]                                               {'loss': 0.0774, 'grad_norm': 1.8692307472229004, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s]                                               {'loss': 0.0559, 'grad_norm': 2.1284379959106445, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s]                                               {'loss': 0.2519, 'grad_norm': 3.8437795639038086, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s]                                               {'loss': 0.1525, 'grad_norm': 2.8961715698242188, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s]                                               {'loss': 0.3302, 'grad_norm': 4.941653251647949, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s]                                               {'loss': 0.1598, 'grad_norm': 3.465782642364502, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.2901, 'grad_norm': 2.1575558185577393, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.1141, 'grad_norm': 4.764651298522949, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]                                               {'train_runtime': 26.7559, 'train_samples_per_second': 21.117, 'train_steps_per_second': 1.495, 'train_loss': 0.8313022741116584, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]100%|██████████| 40/40 [00:26<00:00,  1.50it/s]
CLIENT:67
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.38it/s]                                              {'loss': 4.7975, 'grad_norm': 11.048670768737793, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.38it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 2.9628, 'grad_norm': 11.138339042663574, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:02<00:27,  1.35it/s]                                              {'loss': 1.5886, 'grad_norm': 11.275789260864258, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.35it/s] 10%|█         | 4/40 [00:02<00:26,  1.35it/s]                                              {'loss': 1.8452, 'grad_norm': 15.754518508911133, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.35it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 2.8957, 'grad_norm': 24.28508758544922, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.35it/s]                                              {'loss': 1.3237, 'grad_norm': 13.843552589416504, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.35it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 2.1662, 'grad_norm': 16.562911987304688, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 0.0127, 'grad_norm': 0.8886818289756775, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.35it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s]                                              {'loss': 1.108, 'grad_norm': 7.434057235717773, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.71it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s]                                               {'loss': 0.8768, 'grad_norm': 6.152453422546387, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.60it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.53it/s]                                               {'loss': 0.7529, 'grad_norm': 7.726224899291992, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.53it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s]                                               {'loss': 0.413, 'grad_norm': 5.323158264160156, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.43it/s]                                               {'loss': 1.0866, 'grad_norm': 9.950185775756836, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:18,  1.43it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s]                                               {'loss': 0.9315, 'grad_norm': 7.239716529846191, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.41it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 0.7206, 'grad_norm': 6.610281467437744, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:17,  1.39it/s]                                               {'loss': 0.0064, 'grad_norm': 0.37939754128456116, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.39it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s]                                               {'loss': 0.2609, 'grad_norm': 4.525179862976074, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.72it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s]                                               {'loss': 0.3081, 'grad_norm': 3.707345485687256, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s]                                               {'loss': 0.159, 'grad_norm': 2.0827391147613525, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s] 50%|█████     | 20/40 [00:13<00:13,  1.46it/s]                                               {'loss': 0.491, 'grad_norm': 4.943978786468506, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.1558, 'grad_norm': 2.8919296264648438, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s]                                               {'loss': 0.5385, 'grad_norm': 4.202813625335693, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.41it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.5737, 'grad_norm': 4.714684963226318, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s] 60%|██████    | 24/40 [00:15<00:08,  1.86it/s]                                               {'loss': 0.3425, 'grad_norm': 26.285198211669922, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:08,  1.86it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.67it/s]                                               {'loss': 0.0656, 'grad_norm': 2.6027588844299316, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.67it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.55it/s]                                               {'loss': 0.0652, 'grad_norm': 1.144457459449768, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:09,  1.55it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s]                                               {'loss': 0.1301, 'grad_norm': 1.916120171546936, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.47it/s] 70%|███████   | 28/40 [00:18<00:08,  1.43it/s]                                               {'loss': 0.0785, 'grad_norm': 1.2334554195404053, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.43it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.41it/s]                                               {'loss': 0.1484, 'grad_norm': 1.7474052906036377, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.39it/s]                                               {'loss': 0.1983, 'grad_norm': 2.0112037658691406, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.38it/s]                                               {'loss': 0.9156, 'grad_norm': 4.968420028686523, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.38it/s] 80%|████████  | 32/40 [00:21<00:04,  1.85it/s]                                               {'loss': 0.2707, 'grad_norm': 19.49378204345703, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:04,  1.85it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.66it/s]                                               {'loss': 0.0761, 'grad_norm': 1.8542428016662598, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.66it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.55it/s]                                               {'loss': 0.0764, 'grad_norm': 1.9283045530319214, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.55it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s]                                               {'loss': 0.1414, 'grad_norm': 2.390342950820923, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.48it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.43it/s]                                               {'loss': 0.0354, 'grad_norm': 0.8849459886550903, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.43it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.41it/s]                                               {'loss': 0.3458, 'grad_norm': 1.3066757917404175, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.41it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.39it/s]                                               {'loss': 0.0933, 'grad_norm': 2.7080371379852295, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.4758, 'grad_norm': 2.28902006149292, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.0109, 'grad_norm': 0.5297757387161255, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]                                               {'train_runtime': 26.8323, 'train_samples_per_second': 21.057, 'train_steps_per_second': 1.491, 'train_loss': 0.7361331560998223, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:31,  5.14it/s]  1%|          | 3/471 [00:00<02:08,  3.65it/s]  1%|          | 4/471 [00:01<02:30,  3.11it/s]  1%|          | 5/471 [00:01<02:39,  2.92it/s]  1%|▏         | 6/471 [00:01<02:45,  2.81it/s]  1%|▏         | 7/471 [00:02<02:50,  2.73it/s]  2%|▏         | 8/471 [00:02<02:54,  2.65it/s]  2%|▏         | 9/471 [00:03<02:56,  2.61it/s]  2%|▏         | 10/471 [00:03<02:57,  2.60it/s]  2%|▏         | 11/471 [00:03<02:59,  2.57it/s]  3%|▎         | 12/471 [00:04<02:58,  2.57it/s]  3%|▎         | 13/471 [00:04<02:57,  2.58it/s]  3%|▎         | 14/471 [00:05<02:57,  2.58it/s]  3%|▎         | 15/471 [00:05<02:58,  2.55it/s]  3%|▎         | 16/471 [00:05<02:57,  2.56it/s]  4%|▎         | 17/471 [00:06<02:57,  2.56it/s]  4%|▍         | 18/471 [00:06<02:57,  2.55it/s]  4%|▍         | 19/471 [00:07<02:56,  2.56it/s]  4%|▍         | 20/471 [00:07<02:55,  2.57it/s]  4%|▍         | 21/471 [00:07<02:54,  2.58it/s]  5%|▍         | 22/471 [00:08<02:55,  2.56it/s]  5%|▍         | 23/471 [00:08<02:54,  2.57it/s]  5%|▌         | 24/471 [00:08<02:53,  2.57it/s]  5%|▌         | 25/471 [00:09<02:54,  2.56it/s]  6%|▌         | 26/471 [00:09<02:53,  2.56it/s]  6%|▌         | 27/471 [00:10<02:52,  2.57it/s]  6%|▌         | 28/471 [00:10<02:52,  2.56it/s]  6%|▌         | 29/471 [00:10<02:52,  2.56it/s]  6%|▋         | 30/471 [00:11<02:52,  2.56it/s]  7%|▋         | 31/471 [00:11<02:51,  2.57it/s]  7%|▋         | 32/471 [00:12<02:52,  2.55it/s]  7%|▋         | 33/471 [00:12<02:50,  2.57it/s]  7%|▋         | 34/471 [00:12<02:50,  2.57it/s]  7%|▋         | 35/471 [00:13<02:49,  2.57it/s]  8%|▊         | 36/471 [00:13<02:50,  2.55it/s]  8%|▊         | 37/471 [00:14<02:49,  2.56it/s]  8%|▊         | 38/471 [00:14<02:47,  2.58it/s]  8%|▊         | 39/471 [00:14<02:48,  2.56it/s]  8%|▊         | 40/471 [00:15<02:48,  2.56it/s]  9%|▊         | 41/471 [00:15<02:47,  2.57it/s]  9%|▉         | 42/471 [00:15<02:46,  2.58it/s]  9%|▉         | 43/471 [00:16<02:46,  2.56it/s]  9%|▉         | 44/471 [00:16<02:46,  2.57it/s] 10%|▉         | 45/471 [00:17<02:45,  2.57it/s] 10%|▉         | 46/471 [00:17<02:45,  2.56it/s] 10%|▉         | 47/471 [00:17<02:44,  2.58it/s] 10%|█         | 48/471 [00:18<02:43,  2.58it/s] 10%|█         | 49/471 [00:18<02:43,  2.58it/s] 11%|█         | 50/471 [00:19<02:44,  2.57it/s] 11%|█         | 51/471 [00:19<02:42,  2.58it/s] 11%|█         | 52/471 [00:19<02:41,  2.59it/s] 11%|█▏        | 53/471 [00:20<02:42,  2.57it/s] 11%|█▏        | 54/471 [00:20<02:42,  2.57it/s] 12%|█▏        | 55/471 [00:21<02:41,  2.57it/s] 12%|█▏        | 56/471 [00:21<02:41,  2.57it/s] 12%|█▏        | 57/471 [00:21<02:41,  2.57it/s] 12%|█▏        | 58/471 [00:22<02:40,  2.58it/s] 13%|█▎        | 59/471 [00:22<02:39,  2.58it/s] 13%|█▎        | 60/471 [00:23<02:40,  2.56it/s] 13%|█▎        | 61/471 [00:23<02:39,  2.57it/s] 13%|█▎        | 62/471 [00:23<02:38,  2.57it/s] 13%|█▎        | 63/471 [00:24<02:38,  2.57it/s] 14%|█▎        | 64/471 [00:24<02:38,  2.57it/s] 14%|█▍        | 65/471 [00:24<02:37,  2.58it/s] 14%|█▍        | 66/471 [00:25<02:37,  2.58it/s] 14%|█▍        | 67/471 [00:25<02:37,  2.56it/s] 14%|█▍        | 68/471 [00:26<02:36,  2.57it/s] 15%|█▍        | 69/471 [00:26<02:35,  2.58it/s] 15%|█▍        | 70/471 [00:26<02:37,  2.55it/s] 15%|█▌        | 71/471 [00:27<02:35,  2.57it/s] 15%|█▌        | 72/471 [00:27<02:34,  2.58it/s] 15%|█▌        | 73/471 [00:28<02:33,  2.59it/s] 16%|█▌        | 74/471 [00:28<02:34,  2.57it/s] 16%|█▌        | 75/471 [00:28<02:34,  2.56it/s] 16%|█▌        | 76/471 [00:29<02:34,  2.56it/s] 16%|█▋        | 77/471 [00:29<02:34,  2.55it/s] 17%|█▋        | 78/471 [00:30<02:33,  2.56it/s] 17%|█▋        | 79/471 [00:30<02:32,  2.57it/s] 17%|█▋        | 80/471 [00:30<02:31,  2.58it/s] 17%|█▋        | 81/471 [00:31<02:31,  2.57it/s] 17%|█▋        | 82/471 [00:31<02:30,  2.58it/s] 18%|█▊        | 83/471 [00:31<02:30,  2.59it/s] 18%|█▊        | 84/471 [00:32<02:30,  2.57it/s] 18%|█▊        | 85/471 [00:32<02:29,  2.58it/s] 18%|█▊        | 86/471 [00:33<02:28,  2.59it/s] 18%|█▊        | 87/471 [00:33<02:28,  2.59it/s] 19%|█▊        | 88/471 [00:33<02:28,  2.57it/s] 19%|█▉        | 89/471 [00:34<02:28,  2.57it/s] 19%|█▉        | 90/471 [00:34<02:27,  2.58it/s] 19%|█▉        | 91/471 [00:35<02:28,  2.55it/s] 20%|█▉        | 92/471 [00:35<02:27,  2.57it/s] 20%|█▉        | 93/471 [00:35<02:26,  2.57it/s] 20%|█▉        | 94/471 [00:36<02:26,  2.58it/s] 20%|██        | 95/471 [00:36<02:25,  2.59it/s] 20%|██        | 96/471 [00:36<02:25,  2.58it/s] 21%|██        | 97/471 [00:37<02:24,  2.59it/s] 21%|██        | 98/471 [00:37<02:24,  2.57it/s] 21%|██        | 99/471 [00:38<02:24,  2.58it/s] 21%|██        | 100/471 [00:38<02:22,  2.59it/s] 21%|██▏       | 101/471 [00:38<02:24,  2.56it/s] 22%|██▏       | 102/471 [00:39<02:24,  2.56it/s] 22%|██▏       | 103/471 [00:39<02:23,  2.57it/s] 22%|██▏       | 104/471 [00:40<02:22,  2.57it/s] 22%|██▏       | 105/471 [00:40<02:23,  2.55it/s] 23%|██▎       | 106/471 [00:40<02:21,  2.58it/s] 23%|██▎       | 107/471 [00:41<02:20,  2.58it/s] 23%|██▎       | 108/471 [00:41<02:21,  2.56it/s] 23%|██▎       | 109/471 [00:42<02:20,  2.57it/s] 23%|██▎       | 110/471 [00:42<02:20,  2.57it/s] 24%|██▎       | 111/471 [00:42<02:20,  2.56it/s] 24%|██▍       | 112/471 [00:43<02:20,  2.55it/s] 24%|██▍       | 113/471 [00:43<02:19,  2.56it/s] 24%|██▍       | 114/471 [00:43<02:19,  2.57it/s] 24%|██▍       | 115/471 [00:44<02:19,  2.55it/s] 25%|██▍       | 116/471 [00:44<02:18,  2.56it/s] 25%|██▍       | 117/471 [00:45<02:17,  2.57it/s] 25%|██▌       | 118/471 [00:45<02:16,  2.58it/s] 25%|██▌       | 119/471 [00:45<02:17,  2.56it/s] 25%|██▌       | 120/471 [00:46<02:17,  2.56it/s] 26%|██▌       | 121/471 [00:46<02:16,  2.56it/s] 26%|██▌       | 122/471 [00:47<02:16,  2.55it/s] 26%|██▌       | 123/471 [00:47<02:15,  2.56it/s] 26%|██▋       | 124/471 [00:47<02:15,  2.56it/s] 27%|██▋       | 125/471 [00:48<02:15,  2.56it/s] 27%|██▋       | 126/471 [00:48<02:15,  2.54it/s] 27%|██▋       | 127/471 [00:49<02:15,  2.54it/s] 27%|██▋       | 128/471 [00:49<02:14,  2.55it/s] 27%|██▋       | 129/471 [00:49<02:14,  2.55it/s] 28%|██▊       | 130/471 [00:50<02:12,  2.56it/s] 28%|██▊       | 131/471 [00:50<02:12,  2.57it/s] 28%|██▊       | 132/471 [00:51<02:11,  2.57it/s] 28%|██▊       | 133/471 [00:51<02:12,  2.54it/s] 28%|██▊       | 134/471 [00:51<02:12,  2.55it/s] 29%|██▊       | 135/471 [00:52<02:11,  2.56it/s] 29%|██▉       | 136/471 [00:52<02:12,  2.52it/s] 29%|██▉       | 137/471 [00:52<02:10,  2.55it/s] 29%|██▉       | 138/471 [00:53<02:09,  2.56it/s] 30%|██▉       | 139/471 [00:53<02:08,  2.59it/s] 30%|██▉       | 140/471 [00:54<02:09,  2.56it/s] 30%|██▉       | 141/471 [00:54<02:07,  2.58it/s] 30%|███       | 142/471 [00:54<02:06,  2.59it/s] 30%|███       | 143/471 [00:55<02:07,  2.58it/s] 31%|███       | 144/471 [00:55<02:06,  2.58it/s] 31%|███       | 145/471 [00:56<02:05,  2.60it/s] 31%|███       | 146/471 [00:56<02:04,  2.61it/s] 31%|███       | 147/471 [00:56<02:06,  2.57it/s] 31%|███▏      | 148/471 [00:57<02:05,  2.58it/s] 32%|███▏      | 149/471 [00:57<02:04,  2.58it/s] 32%|███▏      | 150/471 [00:58<02:05,  2.56it/s] 32%|███▏      | 151/471 [00:58<02:04,  2.57it/s] 32%|███▏      | 152/471 [00:58<02:03,  2.58it/s] 32%|███▏      | 153/471 [00:59<02:03,  2.57it/s] 33%|███▎      | 154/471 [00:59<02:03,  2.57it/s] 33%|███▎      | 155/471 [00:59<02:02,  2.58it/s] 33%|███▎      | 156/471 [01:00<02:01,  2.59it/s] 33%|███▎      | 157/471 [01:00<02:02,  2.56it/s] 34%|███▎      | 158/471 [01:01<02:01,  2.58it/s] 34%|███▍      | 159/471 [01:01<02:00,  2.59it/s] 34%|███▍      | 160/471 [01:01<02:00,  2.57it/s] 34%|███▍      | 161/471 [01:02<02:00,  2.58it/s] 34%|███▍      | 162/471 [01:02<02:00,  2.57it/s] 35%|███▍      | 163/471 [01:03<01:59,  2.57it/s] 35%|███▍      | 164/471 [01:03<01:59,  2.57it/s] 35%|███▌      | 165/471 [01:03<01:58,  2.57it/s] 35%|███▌      | 166/471 [01:04<01:58,  2.57it/s] 35%|███▌      | 167/471 [01:04<01:59,  2.55it/s] 36%|███▌      | 168/471 [01:05<01:58,  2.56it/s] 36%|███▌      | 169/471 [01:05<01:57,  2.57it/s] 36%|███▌      | 170/471 [01:05<01:56,  2.58it/s] 36%|███▋      | 171/471 [01:06<01:57,  2.55it/s] 37%|███▋      | 172/471 [01:06<01:56,  2.56it/s] 37%|███▋      | 173/471 [01:06<01:55,  2.58it/s] 37%|███▋      | 174/471 [01:07<01:55,  2.56it/s] 37%|███▋      | 175/471 [01:07<01:54,  2.57it/s] 37%|███▋      | 176/471 [01:08<01:54,  2.58it/s] 38%|███▊      | 177/471 [01:08<01:53,  2.58it/s] 38%|███▊      | 178/471 [01:08<01:54,  2.55it/s] 38%|███▊      | 179/471 [01:09<01:54,  2.56it/s] 38%|███▊      | 180/471 [01:09<01:53,  2.56it/s] 38%|███▊      | 181/471 [01:10<01:54,  2.54it/s] 39%|███▊      | 182/471 [01:10<01:53,  2.55it/s] 39%|███▉      | 183/471 [01:10<01:52,  2.56it/s] 39%|███▉      | 184/471 [01:11<01:51,  2.57it/s] 39%|███▉      | 185/471 [01:11<01:52,  2.55it/s] 39%|███▉      | 186/471 [01:12<01:51,  2.56it/s] 40%|███▉      | 187/471 [01:12<01:50,  2.56it/s] 40%|███▉      | 188/471 [01:12<01:50,  2.55it/s] 40%|████      | 189/471 [01:13<01:49,  2.58it/s] 40%|████      | 190/471 [01:13<01:48,  2.58it/s] 41%|████      | 191/471 [01:13<01:48,  2.57it/s] 41%|████      | 192/471 [01:14<01:49,  2.55it/s] 41%|████      | 193/471 [01:14<01:48,  2.56it/s] 41%|████      | 194/471 [01:15<01:47,  2.57it/s] 41%|████▏     | 195/471 [01:15<01:48,  2.55it/s] 42%|████▏     | 196/471 [01:15<01:46,  2.57it/s] 42%|████▏     | 197/471 [01:16<01:46,  2.58it/s] 42%|████▏     | 198/471 [01:16<01:45,  2.58it/s] 42%|████▏     | 199/471 [01:17<01:45,  2.57it/s] 42%|████▏     | 200/471 [01:17<01:45,  2.57it/s] 43%|████▎     | 201/471 [01:17<01:44,  2.58it/s] 43%|████▎     | 202/471 [01:18<01:44,  2.56it/s] 43%|████▎     | 203/471 [01:18<01:44,  2.57it/s] 43%|████▎     | 204/471 [01:19<01:43,  2.58it/s] 44%|████▎     | 205/471 [01:19<01:43,  2.56it/s] 44%|████▎     | 206/471 [01:19<01:43,  2.57it/s] 44%|████▍     | 207/471 [01:20<01:42,  2.58it/s] 44%|████▍     | 208/471 [01:20<01:41,  2.59it/s] 44%|████▍     | 209/471 [01:20<01:42,  2.56it/s] 45%|████▍     | 210/471 [01:21<01:41,  2.57it/s] 45%|████▍     | 211/471 [01:21<01:40,  2.57it/s] 45%|████▌     | 212/471 [01:22<01:41,  2.56it/s] 45%|████▌     | 213/471 [01:22<01:40,  2.56it/s] 45%|████▌     | 214/471 [01:22<01:40,  2.57it/s] 46%|████▌     | 215/471 [01:23<01:39,  2.58it/s] 46%|████▌     | 216/471 [01:23<01:39,  2.56it/s] 46%|████▌     | 217/471 [01:24<01:39,  2.56it/s] 46%|████▋     | 218/471 [01:24<01:38,  2.57it/s] 46%|████▋     | 219/471 [01:24<01:38,  2.55it/s] 47%|████▋     | 220/471 [01:25<01:37,  2.56it/s] 47%|████▋     | 221/471 [01:25<01:37,  2.58it/s] 47%|████▋     | 222/471 [01:26<01:36,  2.57it/s] 47%|████▋     | 223/471 [01:26<01:36,  2.57it/s] 48%|████▊     | 224/471 [01:26<01:36,  2.57it/s] 48%|████▊     | 225/471 [01:27<01:35,  2.57it/s] 48%|████▊     | 226/471 [01:27<01:36,  2.55it/s] 48%|████▊     | 227/471 [01:28<01:35,  2.56it/s] 48%|████▊     | 228/471 [01:28<01:34,  2.58it/s] 49%|████▊     | 229/471 [01:28<01:35,  2.55it/s] 49%|████▉     | 230/471 [01:29<01:34,  2.55it/s] 49%|████▉     | 231/471 [01:29<01:34,  2.55it/s] 49%|████▉     | 232/471 [01:29<01:33,  2.55it/s] 49%|████▉     | 233/471 [01:30<01:33,  2.54it/s] 50%|████▉     | 234/471 [01:30<01:33,  2.54it/s] 50%|████▉     | 235/471 [01:31<01:32,  2.55it/s] 50%|█████     | 236/471 [01:31<01:32,  2.54it/s] 50%|█████     | 237/471 [01:31<01:31,  2.56it/s] 51%|█████     | 238/471 [01:32<01:31,  2.56it/s] 51%|█████     | 239/471 [01:32<01:30,  2.57it/s] 51%|█████     | 240/471 [01:33<01:31,  2.53it/s] 51%|█████     | 241/471 [01:33<01:30,  2.55it/s] 51%|█████▏    | 242/471 [01:33<01:30,  2.53it/s] 52%|█████▏    | 243/471 [01:34<01:29,  2.55it/s] 52%|█████▏    | 244/471 [01:34<01:30,  2.52it/s] 52%|█████▏    | 245/471 [01:35<01:29,  2.53it/s] 52%|█████▏    | 246/471 [01:35<01:28,  2.54it/s] 52%|█████▏    | 247/471 [01:35<01:28,  2.54it/s] 53%|█████▎    | 248/471 [01:36<01:27,  2.55it/s] 53%|█████▎    | 249/471 [01:36<01:26,  2.55it/s] 53%|█████▎    | 250/471 [01:37<01:26,  2.55it/s] 53%|█████▎    | 251/471 [01:37<01:26,  2.54it/s] 54%|█████▎    | 252/471 [01:37<01:25,  2.55it/s] 54%|█████▎    | 253/471 [01:38<01:25,  2.54it/s] 54%|█████▍    | 254/471 [01:38<01:26,  2.51it/s] 54%|█████▍    | 255/471 [01:39<01:25,  2.52it/s] 54%|█████▍    | 256/471 [01:39<01:24,  2.56it/s] 55%|█████▍    | 257/471 [01:39<01:24,  2.54it/s] 55%|█████▍    | 258/471 [01:40<01:23,  2.56it/s] 55%|█████▍    | 259/471 [01:40<01:22,  2.56it/s] 55%|█████▌    | 260/471 [01:40<01:21,  2.58it/s] 55%|█████▌    | 261/471 [01:41<01:22,  2.55it/s] 56%|█████▌    | 262/471 [01:41<01:22,  2.54it/s] 56%|█████▌    | 263/471 [01:42<01:21,  2.55it/s] 56%|█████▌    | 264/471 [01:42<01:21,  2.53it/s] 56%|█████▋    | 265/471 [01:42<01:21,  2.53it/s] 56%|█████▋    | 266/471 [01:43<01:20,  2.54it/s] 57%|█████▋    | 267/471 [01:43<01:19,  2.55it/s] 57%|█████▋    | 268/471 [01:44<01:20,  2.53it/s] 57%|█████▋    | 269/471 [01:44<01:19,  2.53it/s] 57%|█████▋    | 270/471 [01:44<01:19,  2.52it/s] 58%|█████▊    | 271/471 [01:45<01:19,  2.51it/s] 58%|█████▊    | 272/471 [01:45<01:16,  2.59it/s] 58%|█████▊    | 273/471 [01:46<01:16,  2.59it/s] 58%|█████▊    | 274/471 [01:46<01:16,  2.56it/s] 58%|█████▊    | 275/471 [01:46<01:17,  2.54it/s] 59%|█████▊    | 276/471 [01:47<01:16,  2.54it/s] 59%|█████▉    | 277/471 [01:47<01:16,  2.55it/s] 59%|█████▉    | 278/471 [01:48<01:16,  2.53it/s] 59%|█████▉    | 279/471 [01:48<01:15,  2.53it/s] 59%|█████▉    | 280/471 [01:48<01:15,  2.54it/s] 60%|█████▉    | 281/471 [01:49<01:14,  2.53it/s] 60%|█████▉    | 282/471 [01:49<01:15,  2.52it/s] 60%|██████    | 283/471 [01:50<01:14,  2.53it/s] 60%|██████    | 284/471 [01:50<01:13,  2.53it/s] 61%|██████    | 285/471 [01:50<01:13,  2.52it/s] 61%|██████    | 286/471 [01:51<01:12,  2.54it/s] 61%|██████    | 287/471 [01:51<01:12,  2.54it/s] 61%|██████    | 288/471 [01:51<01:11,  2.55it/s] 61%|██████▏   | 289/471 [01:52<01:11,  2.54it/s] 62%|██████▏   | 290/471 [01:52<01:11,  2.53it/s] 62%|██████▏   | 291/471 [01:53<01:10,  2.54it/s] 62%|██████▏   | 292/471 [01:53<01:10,  2.53it/s] 62%|██████▏   | 293/471 [01:53<01:09,  2.55it/s] 62%|██████▏   | 294/471 [01:54<01:09,  2.56it/s] 63%|██████▎   | 295/471 [01:54<01:08,  2.56it/s] 63%|██████▎   | 296/471 [01:55<01:08,  2.54it/s] 63%|██████▎   | 297/471 [01:55<01:08,  2.55it/s] 63%|██████▎   | 298/471 [01:55<01:07,  2.55it/s] 63%|██████▎   | 299/471 [01:56<01:07,  2.54it/s] 64%|██████▎   | 300/471 [01:56<01:07,  2.54it/s] 64%|██████▍   | 301/471 [01:57<01:06,  2.55it/s] 64%|██████▍   | 302/471 [01:57<01:05,  2.57it/s] 64%|██████▍   | 303/471 [01:57<01:06,  2.54it/s] 65%|██████▍   | 304/471 [01:58<01:04,  2.57it/s] 65%|██████▍   | 305/471 [01:58<01:04,  2.58it/s] 65%|██████▍   | 306/471 [01:59<01:04,  2.55it/s] 65%|██████▌   | 307/471 [01:59<01:04,  2.55it/s] 65%|██████▌   | 308/471 [01:59<01:04,  2.54it/s] 66%|██████▌   | 309/471 [02:00<01:04,  2.51it/s] 66%|██████▌   | 310/471 [02:00<01:03,  2.53it/s] 66%|██████▌   | 311/471 [02:01<01:02,  2.55it/s] 66%|██████▌   | 312/471 [02:01<01:02,  2.55it/s] 66%|██████▋   | 313/471 [02:01<01:02,  2.53it/s] 67%|██████▋   | 314/471 [02:02<01:01,  2.54it/s] 67%|██████▋   | 315/471 [02:02<01:01,  2.55it/s] 67%|██████▋   | 316/471 [02:03<01:01,  2.54it/s] 67%|██████▋   | 317/471 [02:03<01:00,  2.53it/s] 68%|██████▊   | 318/471 [02:03<01:00,  2.54it/s] 68%|██████▊   | 319/471 [02:04<01:00,  2.53it/s] 68%|██████▊   | 320/471 [02:04<00:59,  2.52it/s] 68%|██████▊   | 321/471 [02:04<00:59,  2.53it/s] 68%|██████▊   | 322/471 [02:05<00:58,  2.53it/s] 69%|██████▊   | 323/471 [02:05<00:58,  2.51it/s] 69%|██████▉   | 324/471 [02:06<00:58,  2.52it/s] 69%|██████▉   | 325/471 [02:06<00:57,  2.54it/s] 69%|██████▉   | 326/471 [02:06<00:57,  2.54it/s] 69%|██████▉   | 327/471 [02:07<00:57,  2.52it/s] 70%|██████▉   | 328/471 [02:07<00:56,  2.53it/s] 70%|██████▉   | 329/471 [02:08<00:56,  2.53it/s] 70%|███████   | 330/471 [02:08<00:55,  2.53it/s] 70%|███████   | 331/471 [02:08<00:55,  2.53it/s] 70%|███████   | 332/471 [02:09<00:54,  2.53it/s] 71%|███████   | 333/471 [02:09<00:50,  2.73it/s] 71%|███████   | 334/471 [02:09<00:43,  3.18it/s] 71%|███████   | 335/471 [02:10<00:37,  3.59it/s] 71%|███████▏  | 336/471 [02:10<00:34,  3.96it/s] 72%|███████▏  | 337/471 [02:10<00:31,  4.28it/s] 72%|███████▏  | 338/471 [02:10<00:29,  4.54it/s] 72%|███████▏  | 339/471 [02:10<00:27,  4.72it/s] 72%|███████▏  | 340/471 [02:10<00:27,  4.79it/s] 72%|███████▏  | 341/471 [02:11<00:26,  4.89it/s] 73%|███████▎  | 342/471 [02:11<00:26,  4.96it/s] 73%|███████▎  | 343/471 [02:11<00:25,  5.01it/s] 73%|███████▎  | 344/471 [02:11<00:24,  5.08it/s] 73%|███████▎  | 345/471 [02:11<00:24,  5.07it/s] 73%|███████▎  | 346/471 [02:12<00:26,  4.66it/s] 74%|███████▎  | 347/471 [02:12<00:33,  3.67it/s] 74%|███████▍  | 348/471 [02:12<00:36,  3.37it/s] 74%|███████▍  | 349/471 [02:13<00:36,  3.35it/s] 74%|███████▍  | 350/471 [02:13<00:39,  3.06it/s] 75%|███████▍  | 351/471 [02:14<00:41,  2.91it/s] 75%|███████▍  | 352/471 [02:14<00:40,  2.94it/s] 75%|███████▍  | 353/471 [02:14<00:40,  2.89it/s] 75%|███████▌  | 354/471 [02:15<00:42,  2.74it/s] 75%|███████▌  | 355/471 [02:15<00:41,  2.82it/s] 76%|███████▌  | 356/471 [02:15<00:40,  2.86it/s] 76%|███████▌  | 357/471 [02:16<00:42,  2.69it/s] 76%|███████▌  | 358/471 [02:16<00:40,  2.79it/s] 76%|███████▌  | 359/471 [02:16<00:38,  2.91it/s] 76%|███████▋  | 360/471 [02:17<00:40,  2.73it/s] 77%|███████▋  | 361/471 [02:17<00:40,  2.75it/s] 77%|███████▋  | 362/471 [02:17<00:38,  2.85it/s] 77%|███████▋  | 363/471 [02:18<00:38,  2.77it/s] 77%|███████▋  | 364/471 [02:18<00:39,  2.72it/s] 77%|███████▋  | 365/471 [02:19<00:37,  2.82it/s] 78%|███████▊  | 366/471 [02:19<00:37,  2.82it/s] 78%|███████▊  | 367/471 [02:19<00:38,  2.69it/s] 78%|███████▊  | 368/471 [02:20<00:36,  2.80it/s] 78%|███████▊  | 369/471 [02:20<00:34,  2.98it/s] 79%|███████▊  | 370/471 [02:20<00:35,  2.83it/s] 79%|███████▉  | 371/471 [02:21<00:36,  2.76it/s] 79%|███████▉  | 372/471 [02:21<00:34,  2.83it/s] 79%|███████▉  | 373/471 [02:21<00:34,  2.82it/s] 79%|███████▉  | 374/471 [02:22<00:35,  2.70it/s] 80%|███████▉  | 375/471 [02:22<00:34,  2.79it/s] 80%|███████▉  | 376/471 [02:22<00:33,  2.85it/s] 80%|████████  | 377/471 [02:23<00:34,  2.69it/s] 80%|████████  | 378/471 [02:23<00:33,  2.78it/s] 80%|████████  | 379/471 [02:24<00:31,  2.90it/s] 81%|████████  | 380/471 [02:24<00:33,  2.72it/s] 81%|████████  | 381/471 [02:24<00:32,  2.74it/s] 81%|████████  | 382/471 [02:25<00:30,  2.88it/s] 81%|████████▏ | 383/471 [02:25<00:31,  2.77it/s] 82%|████████▏ | 384/471 [02:25<00:32,  2.71it/s] 82%|████████▏ | 385/471 [02:26<00:30,  2.80it/s] 82%|████████▏ | 386/471 [02:26<00:30,  2.80it/s] 82%|████████▏ | 387/471 [02:27<00:31,  2.68it/s] 82%|████████▏ | 388/471 [02:27<00:29,  2.78it/s] 83%|████████▎ | 389/471 [02:27<00:28,  2.83it/s] 83%|████████▎ | 390/471 [02:28<00:30,  2.67it/s] 83%|████████▎ | 391/471 [02:28<00:28,  2.77it/s] 83%|████████▎ | 392/471 [02:28<00:27,  2.90it/s] 83%|████████▎ | 393/471 [02:29<00:27,  2.85it/s] 84%|████████▎ | 394/471 [02:29<00:28,  2.73it/s] 84%|████████▍ | 395/471 [02:29<00:27,  2.81it/s] 84%|████████▍ | 396/471 [02:30<00:26,  2.83it/s] 84%|████████▍ | 397/471 [02:30<00:27,  2.69it/s] 85%|████████▍ | 398/471 [02:30<00:26,  2.77it/s] 85%|████████▍ | 399/471 [02:31<00:25,  2.86it/s] 85%|████████▍ | 400/471 [02:31<00:26,  2.70it/s] 85%|████████▌ | 401/471 [02:32<00:25,  2.75it/s] 85%|████████▌ | 402/471 [02:32<00:23,  2.90it/s] 86%|████████▌ | 403/471 [02:32<00:24,  2.74it/s] 86%|████████▌ | 404/471 [02:33<00:24,  2.72it/s] 86%|████████▌ | 405/471 [02:33<00:23,  2.81it/s] 86%|████████▌ | 406/471 [02:33<00:22,  2.83it/s] 86%|████████▋ | 407/471 [02:34<00:23,  2.72it/s] 87%|████████▋ | 408/471 [02:34<00:22,  2.83it/s] 87%|████████▋ | 409/471 [02:34<00:21,  2.87it/s] 87%|████████▋ | 410/471 [02:35<00:22,  2.71it/s] 87%|████████▋ | 411/471 [02:35<00:21,  2.80it/s] 87%|████████▋ | 412/471 [02:35<00:20,  2.88it/s] 88%|████████▊ | 413/471 [02:36<00:21,  2.71it/s] 88%|████████▊ | 414/471 [02:36<00:20,  2.75it/s] 88%|████████▊ | 415/471 [02:36<00:19,  2.92it/s] 88%|████████▊ | 416/471 [02:37<00:18,  2.92it/s] 89%|████████▊ | 417/471 [02:37<00:19,  2.74it/s] 89%|████████▊ | 418/471 [02:38<00:18,  2.81it/s] 89%|████████▉ | 419/471 [02:38<00:17,  2.90it/s] 89%|████████▉ | 420/471 [02:38<00:18,  2.73it/s] 89%|████████▉ | 421/471 [02:39<00:18,  2.77it/s] 90%|████████▉ | 422/471 [02:39<00:16,  2.93it/s] 90%|████████▉ | 423/471 [02:39<00:17,  2.78it/s] 90%|█████████ | 424/471 [02:40<00:17,  2.73it/s] 90%|█████████ | 425/471 [02:40<00:16,  2.83it/s] 90%|█████████ | 426/471 [02:40<00:15,  2.82it/s] 91%|█████████ | 427/471 [02:41<00:16,  2.71it/s] 91%|█████████ | 428/471 [02:41<00:15,  2.80it/s] 91%|█████████ | 429/471 [02:41<00:14,  2.86it/s] 91%|█████████▏| 430/471 [02:42<00:15,  2.70it/s] 92%|█████████▏| 431/471 [02:42<00:14,  2.78it/s] 92%|█████████▏| 432/471 [02:43<00:13,  2.90it/s] 92%|█████████▏| 433/471 [02:43<00:13,  2.73it/s] 92%|█████████▏| 434/471 [02:43<00:13,  2.75it/s] 92%|█████████▏| 435/471 [02:44<00:12,  2.86it/s] 93%|█████████▎| 436/471 [02:44<00:12,  2.79it/s] 93%|█████████▎| 437/471 [02:44<00:12,  2.72it/s] 93%|█████████▎| 438/471 [02:45<00:11,  2.82it/s] 93%|█████████▎| 439/471 [02:45<00:10,  2.97it/s] 93%|█████████▎| 440/471 [02:45<00:11,  2.78it/s] 94%|█████████▎| 441/471 [02:46<00:10,  2.80it/s] 94%|█████████▍| 442/471 [02:46<00:09,  2.91it/s] 94%|█████████▍| 443/471 [02:46<00:09,  2.81it/s] 94%|█████████▍| 444/471 [02:47<00:09,  2.74it/s] 94%|█████████▍| 445/471 [02:47<00:09,  2.83it/s] 95%|█████████▍| 446/471 [02:48<00:08,  2.83it/s] 95%|█████████▍| 447/471 [02:48<00:08,  2.71it/s] 95%|█████████▌| 448/471 [02:48<00:08,  2.80it/s] 95%|█████████▌| 449/471 [02:49<00:07,  2.87it/s] 96%|█████████▌| 450/471 [02:49<00:07,  2.71it/s] 96%|█████████▌| 451/471 [02:49<00:07,  2.76it/s] 96%|█████████▌| 452/471 [02:50<00:06,  2.91it/s] 96%|█████████▌| 453/471 [02:50<00:06,  2.74it/s] 96%|█████████▋| 454/471 [02:50<00:06,  2.74it/s] 97%|█████████▋| 455/471 [02:51<00:05,  2.82it/s] 97%|█████████▋| 456/471 [02:51<00:05,  2.82it/s] 97%|█████████▋| 457/471 [02:52<00:05,  2.72it/s] 97%|█████████▋| 458/471 [02:52<00:04,  2.82it/s] 97%|█████████▋| 459/471 [02:52<00:04,  2.87it/s] 98%|█████████▊| 460/471 [02:53<00:04,  2.70it/s] 98%|█████████▊| 461/471 [02:53<00:03,  2.78it/s] 98%|█████████▊| 462/471 [02:53<00:03,  2.91it/s] 98%|█████████▊| 463/471 [02:53<00:02,  3.39it/s] 99%|█████████▊| 464/471 [02:54<00:01,  3.78it/s] 99%|█████████▊| 465/471 [02:54<00:01,  4.13it/s] 99%|█████████▉| 466/471 [02:54<00:01,  4.40it/s] 99%|█████████▉| 467/471 [02:54<00:00,  4.61it/s] 99%|█████████▉| 468/471 [02:54<00:00,  4.78it/s]100%|█████████▉| 469/471 [02:55<00:00,  4.91it/s]100%|█████████▉| 470/471 [02:55<00:00,  5.01it/s]100%|██████████| 471/471 [02:55<00:00,  5.42it/s]100%|██████████| 471/471 [02:55<00:00,  2.68it/s]
{'eval_loss': 3.4107911586761475, 'eval_model_preparation_time': 0.0052, 'eval_acc': 0.2776155071694105, 'eval_runtime': 175.8429, 'eval_samples_per_second': 42.834, 'eval_steps_per_second': 2.679}
ROUND:11
CLIENT:23
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:04,  1.65s/it]                                              {'loss': 4.2332, 'grad_norm': 14.913223266601562, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:04,  1.65s/it]  5%|▌         | 2/40 [00:02<00:39,  1.05s/it]                                              {'loss': 3.1997, 'grad_norm': 11.709840774536133, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.05s/it]  8%|▊         | 3/40 [00:02<00:32,  1.13it/s]                                              {'loss': 1.7888, 'grad_norm': 13.460051536560059, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.13it/s] 10%|█         | 4/40 [00:03<00:29,  1.22it/s]                                              {'loss': 1.2397, 'grad_norm': 11.672269821166992, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:29,  1.22it/s] 12%|█▎        | 5/40 [00:04<00:25,  1.39it/s]                                              {'loss': 1.5765, 'grad_norm': 15.198850631713867, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:25,  1.39it/s] 15%|█▌        | 6/40 [00:04<00:20,  1.68it/s]                                              {'loss': 2.3037, 'grad_norm': 11.406373977661133, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:20,  1.68it/s] 18%|█▊        | 7/40 [00:05<00:18,  1.75it/s]                                              {'loss': 1.7696, 'grad_norm': 16.013296127319336, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:18,  1.75it/s]                                              {'loss': 2.3258, 'grad_norm': 93.1993179321289, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:18,  1.75it/s] 22%|██▎       | 9/40 [00:05<00:14,  2.12it/s]                                              {'loss': 1.2189, 'grad_norm': 14.158885955810547, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:14,  2.12it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.87it/s]                                               {'loss': 1.2762, 'grad_norm': 13.472612380981445, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.87it/s] 28%|██▊       | 11/40 [00:07<00:16,  1.78it/s]                                               {'loss': 1.2731, 'grad_norm': 12.224595069885254, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:16,  1.78it/s] 30%|███       | 12/40 [00:07<00:16,  1.66it/s]                                               {'loss': 0.4711, 'grad_norm': 7.083619117736816, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.66it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s]                                               {'loss': 1.0103, 'grad_norm': 12.715428352355957, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.60it/s]                                               {'loss': 0.5347, 'grad_norm': 6.244898319244385, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.60it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 1.0306, 'grad_norm': 5.347306728363037, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 0.2707, 'grad_norm': 5.445531368255615, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:15,  1.52it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.86it/s]                                               {'loss': 0.7597, 'grad_norm': 5.957448482513428, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.86it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.80it/s]                                               {'loss': 0.1861, 'grad_norm': 3.7699341773986816, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.80it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.67it/s]                                               {'loss': 0.2635, 'grad_norm': 4.242050647735596, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.67it/s] 50%|█████     | 20/40 [00:12<00:12,  1.65it/s]                                               {'loss': 0.4801, 'grad_norm': 6.5008955001831055, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:13<00:11,  1.60it/s]                                               {'loss': 0.6955, 'grad_norm': 4.8468732833862305, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:11,  1.60it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.4481, 'grad_norm': 5.0856499671936035, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.53it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.57it/s]                                               {'loss': 0.5845, 'grad_norm': 5.984469890594482, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.57it/s]                                               {'loss': 0.0318, 'grad_norm': 1.679170846939087, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.57it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.89it/s]                                               {'loss': 0.1601, 'grad_norm': 4.7719340324401855, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.89it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.75it/s]                                               {'loss': 0.9134, 'grad_norm': 15.156977653503418, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.75it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.73it/s]                                               {'loss': 0.2684, 'grad_norm': 7.769573211669922, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.73it/s] 70%|███████   | 28/40 [00:17<00:07,  1.61it/s]                                               {'loss': 0.1722, 'grad_norm': 3.091271162033081, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.61it/s] 72%|███████▎  | 29/40 [00:18<00:07,  1.57it/s]                                               {'loss': 0.2147, 'grad_norm': 3.844115972518921, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:07,  1.57it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s]                                               {'loss': 0.5303, 'grad_norm': 3.329648494720459, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.51it/s]                                               {'loss': 0.3158, 'grad_norm': 6.525116920471191, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.51it/s]                                               {'loss': 0.014, 'grad_norm': 0.7154106497764587, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.51it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.93it/s]                                               {'loss': 0.4837, 'grad_norm': 2.607917547225952, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.93it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.78it/s]                                               {'loss': 0.3979, 'grad_norm': 2.633310079574585, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.78it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.67it/s]                                               {'loss': 0.1871, 'grad_norm': 7.345527648925781, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.67it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.68it/s]                                               {'loss': 0.0637, 'grad_norm': 2.013728618621826, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.68it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s]                                               {'loss': 0.0624, 'grad_norm': 1.966043472290039, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s]                                               {'loss': 0.1911, 'grad_norm': 4.328982830047607, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.54it/s]                                               {'loss': 0.1501, 'grad_norm': 3.1381568908691406, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.54it/s]                                               {'loss': 0.0073, 'grad_norm': 0.5341195464134216, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.54it/s]                                               {'train_runtime': 24.6211, 'train_samples_per_second': 22.948, 'train_steps_per_second': 1.625, 'train_loss': 0.8276028458029032, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.54it/s]100%|██████████| 40/40 [00:24<00:00,  1.62it/s]
CLIENT:81
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.82it/s]                                              {'loss': 2.3845, 'grad_norm': 8.235753059387207, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.82it/s]  5%|▌         | 2/40 [00:00<00:13,  2.87it/s]                                              {'loss': 1.0077, 'grad_norm': 8.019211769104004, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.87it/s]  8%|▊         | 3/40 [00:01<00:13,  2.73it/s]                                              {'loss': 2.0518, 'grad_norm': 10.285809516906738, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.73it/s] 10%|█         | 4/40 [00:01<00:12,  2.77it/s]                                              {'loss': 1.8729, 'grad_norm': 12.116316795349121, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.77it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.81it/s]                                              {'loss': 1.0873, 'grad_norm': 10.424818992614746, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.81it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.63it/s]                                              {'loss': 1.4668, 'grad_norm': 13.183693885803223, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.63it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.71it/s]                                              {'loss': 2.0114, 'grad_norm': 14.56365966796875, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.71it/s]                                              {'loss': 0.1915, 'grad_norm': 11.028823852539062, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.71it/s] 22%|██▎       | 9/40 [00:02<00:09,  3.43it/s]                                              {'loss': 0.442, 'grad_norm': 5.7298583984375, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:09,  3.43it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.27it/s]                                               {'loss': 0.4033, 'grad_norm': 9.259936332702637, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.27it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.16it/s]                                               {'loss': 0.5003, 'grad_norm': 9.497314453125, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.16it/s] 30%|███       | 12/40 [00:04<00:08,  3.11it/s]                                               {'loss': 1.1668, 'grad_norm': 2.69746470451355, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:08,  3.11it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.04it/s]                                               {'loss': 0.4834, 'grad_norm': 7.854161739349365, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.04it/s] 35%|███▌      | 14/40 [00:04<00:08,  2.94it/s]                                               {'loss': 0.608, 'grad_norm': 7.619217395782471, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  2.94it/s] 38%|███▊      | 15/40 [00:05<00:08,  2.91it/s]                                               {'loss': 0.3561, 'grad_norm': 3.698840618133545, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  2.91it/s] 40%|████      | 16/40 [00:05<00:06,  3.65it/s]                                               {'loss': 0.0112, 'grad_norm': 1.187014102935791, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:06,  3.65it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.38it/s]                                               {'loss': 0.2876, 'grad_norm': 4.308204174041748, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.38it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.25it/s]                                               {'loss': 0.2328, 'grad_norm': 4.551371097564697, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.25it/s] 48%|████▊     | 19/40 [00:06<00:06,  3.14it/s]                                               {'loss': 0.093, 'grad_norm': 2.5215389728546143, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:06,  3.14it/s] 50%|█████     | 20/40 [00:06<00:06,  3.00it/s]                                               {'loss': 0.054, 'grad_norm': 1.4804224967956543, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.00it/s] 52%|█████▎    | 21/40 [00:06<00:06,  2.95it/s]                                               {'loss': 0.1278, 'grad_norm': 3.5532290935516357, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  2.95it/s] 55%|█████▌    | 22/40 [00:07<00:06,  2.91it/s]                                               {'loss': 0.5897, 'grad_norm': 2.6359801292419434, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:06,  2.91it/s] 57%|█████▊    | 23/40 [00:07<00:05,  2.94it/s]                                               {'loss': 0.7461, 'grad_norm': 12.02038860321045, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  2.94it/s]                                               {'loss': 0.0141, 'grad_norm': 1.0078191757202148, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  2.94it/s] 62%|██████▎   | 25/40 [00:08<00:04,  3.62it/s]                                               {'loss': 0.0251, 'grad_norm': 0.826088547706604, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:04,  3.62it/s] 65%|██████▌   | 26/40 [00:08<00:04,  3.36it/s]                                               {'loss': 0.0505, 'grad_norm': 1.4886491298675537, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:04,  3.36it/s] 68%|██████▊   | 27/40 [00:08<00:04,  3.23it/s]                                               {'loss': 0.1365, 'grad_norm': 2.9028327465057373, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:04,  3.23it/s] 70%|███████   | 28/40 [00:09<00:03,  3.19it/s]                                               {'loss': 0.0719, 'grad_norm': 1.597327709197998, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:09<00:03,  3.19it/s] 72%|███████▎  | 29/40 [00:09<00:03,  3.10it/s]                                               {'loss': 0.5375, 'grad_norm': 1.8417439460754395, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:09<00:03,  3.10it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.05it/s]                                               {'loss': 0.5486, 'grad_norm': 1.0483895540237427, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.05it/s] 78%|███████▊  | 31/40 [00:10<00:03,  2.99it/s]                                               {'loss': 0.1183, 'grad_norm': 3.6551125049591064, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:10<00:03,  2.99it/s] 80%|████████  | 32/40 [00:10<00:02,  3.62it/s]                                               {'loss': 0.0309, 'grad_norm': 1.6937721967697144, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:10<00:02,  3.62it/s] 82%|████████▎ | 33/40 [00:10<00:02,  3.36it/s]                                               {'loss': 0.0157, 'grad_norm': 0.6917716264724731, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:10<00:02,  3.36it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.15it/s]                                               {'loss': 0.0356, 'grad_norm': 1.0399978160858154, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.15it/s] 88%|████████▊ | 35/40 [00:11<00:01,  3.07it/s]                                               {'loss': 0.008, 'grad_norm': 0.291479229927063, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:11<00:01,  3.07it/s] 90%|█████████ | 36/40 [00:11<00:01,  2.69it/s]                                               {'loss': 0.5151, 'grad_norm': 0.351436972618103, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:11<00:01,  2.69it/s] 92%|█████████▎| 37/40 [00:12<00:01,  2.16it/s]                                               {'loss': 0.5238, 'grad_norm': 0.5332430005073547, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:12<00:01,  2.16it/s] 95%|█████████▌| 38/40 [00:13<00:01,  1.84it/s]                                               {'loss': 0.0124, 'grad_norm': 0.48880237340927124, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:01,  1.84it/s] 98%|█████████▊| 39/40 [00:13<00:00,  1.83it/s]                                               {'loss': 0.0476, 'grad_norm': 1.274657130241394, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:13<00:00,  1.83it/s]                                               {'loss': 0.0316, 'grad_norm': 1.3541991710662842, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:13<00:00,  1.83it/s]                                               {'train_runtime': 14.0872, 'train_samples_per_second': 40.107, 'train_steps_per_second': 2.839, 'train_loss': 0.5224823139375075, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  1.83it/s]100%|██████████| 40/40 [00:14<00:00,  2.84it/s]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]                                              {'loss': 0.0167, 'grad_norm': 0.3188803791999817, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:25,  1.52it/s]                                              {'loss': 0.1803, 'grad_norm': 4.584946632385254, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.52it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s]                                              {'loss': 0.0336, 'grad_norm': 1.3258215188980103, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:23,  1.52it/s]                                              {'loss': 0.0243, 'grad_norm': 0.5615228414535522, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.52it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.52it/s]                                              {'loss': 0.0264, 'grad_norm': 0.8813267946243286, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.52it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s]                                              {'loss': 0.0279, 'grad_norm': 0.46897417306900024, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.54it/s]                                              {'loss': 0.0515, 'grad_norm': 1.1595163345336914, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.54it/s]                                              {'loss': 0.0188, 'grad_norm': 0.7198808789253235, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:20,  1.54it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.90it/s]                                              {'loss': 0.0037, 'grad_norm': 0.06540223956108093, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.90it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s]                                               {'loss': 0.0082, 'grad_norm': 0.14423619210720062, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s] 28%|██▊       | 11/40 [00:06<00:16,  1.73it/s]                                               {'loss': 0.015, 'grad_norm': 0.30088409781455994, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:16,  1.73it/s] 30%|███       | 12/40 [00:07<00:17,  1.62it/s]                                               {'loss': 0.0047, 'grad_norm': 0.07858279347419739, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.62it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.0039, 'grad_norm': 0.06576994061470032, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.57it/s]                                               {'loss': 0.0071, 'grad_norm': 0.11220524460077286, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.57it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.51it/s]                                               {'loss': 0.0125, 'grad_norm': 0.18416661024093628, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.51it/s]                                               {'loss': 0.0003, 'grad_norm': 0.014172295108437538, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.51it/s] 42%|████▎     | 17/40 [00:10<00:11,  1.94it/s]                                               {'loss': 0.0055, 'grad_norm': 0.07125217467546463, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:11,  1.94it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.79it/s]                                               {'loss': 0.0023, 'grad_norm': 0.024602437391877174, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.79it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s]                                               {'loss': 0.0036, 'grad_norm': 0.05245288088917732, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s] 50%|█████     | 20/40 [00:12<00:12,  1.66it/s]                                               {'loss': 0.0024, 'grad_norm': 0.03141995146870613, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.66it/s] 52%|█████▎    | 21/40 [00:12<00:12,  1.58it/s]                                               {'loss': 0.0031, 'grad_norm': 0.03541279211640358, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:12,  1.58it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.55it/s]                                               {'loss': 0.0028, 'grad_norm': 0.039345283061265945, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.55it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.0023, 'grad_norm': 0.02936997264623642, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.0, 'grad_norm': 2.241634547317517e-06, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.56it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.88it/s]                                               {'loss': 0.0018, 'grad_norm': 0.021165302023291588, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.88it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.76it/s]                                               {'loss': 0.0041, 'grad_norm': 0.05325911194086075, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.76it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.70it/s]                                               {'loss': 0.0053, 'grad_norm': 0.06640303879976273, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.70it/s] 70%|███████   | 28/40 [00:17<00:07,  1.61it/s]                                               {'loss': 0.0026, 'grad_norm': 0.0306813046336174, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.61it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.68it/s]                                               {'loss': 0.0026, 'grad_norm': 0.036325350403785706, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.68it/s] 75%|███████▌  | 30/40 [00:17<00:05,  1.90it/s]                                               {'loss': 0.0023, 'grad_norm': 0.027011826634407043, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:05,  1.90it/s] 78%|███████▊  | 31/40 [00:18<00:04,  2.11it/s]                                               {'loss': 0.0022, 'grad_norm': 0.027379045262932777, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:04,  2.11it/s]                                               {'loss': 0.0016, 'grad_norm': 0.05486682429909706, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:03,  2.11it/s] 82%|████████▎ | 33/40 [00:18<00:02,  2.87it/s]                                               {'loss': 0.002, 'grad_norm': 0.01964523084461689, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:02,  2.87it/s] 85%|████████▌ | 34/40 [00:18<00:02,  2.88it/s]                                               {'loss': 0.0023, 'grad_norm': 0.03191694989800453, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:02,  2.88it/s] 88%|████████▊ | 35/40 [00:19<00:01,  2.90it/s]                                               {'loss': 0.0023, 'grad_norm': 0.023345259949564934, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:01,  2.90it/s] 90%|█████████ | 36/40 [00:19<00:01,  2.88it/s]                                               {'loss': 0.0017, 'grad_norm': 0.023695511743426323, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:01,  2.88it/s] 92%|█████████▎| 37/40 [00:20<00:01,  2.87it/s]                                               {'loss': 0.0021, 'grad_norm': 0.021973485127091408, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  2.87it/s] 95%|█████████▌| 38/40 [00:20<00:00,  2.87it/s]                                               {'loss': 0.0028, 'grad_norm': 0.02998507022857666, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:00,  2.87it/s] 98%|█████████▊| 39/40 [00:20<00:00,  2.90it/s]                                               {'loss': 0.0068, 'grad_norm': 0.08405361324548721, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  2.90it/s]                                               {'loss': 0.0014, 'grad_norm': 0.04051319882273674, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  2.90it/s]                                               {'train_runtime': 21.0, 'train_samples_per_second': 26.905, 'train_steps_per_second': 1.905, 'train_loss': 0.012517455046326908, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  2.90it/s]100%|██████████| 40/40 [00:20<00:00,  1.90it/s]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:00,  1.55s/it]                                              {'loss': 1.6097, 'grad_norm': 5.770157814025879, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:00,  1.55s/it]  5%|▌         | 2/40 [00:02<00:40,  1.07s/it]                                              {'loss': 1.7953, 'grad_norm': 10.75525188446045, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:40,  1.07s/it]  8%|▊         | 3/40 [00:02<00:32,  1.14it/s]                                              {'loss': 1.5903, 'grad_norm': 12.81699275970459, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.14it/s] 10%|█         | 4/40 [00:03<00:28,  1.26it/s]                                              {'loss': 1.1691, 'grad_norm': 10.941573143005371, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:28,  1.26it/s] 12%|█▎        | 5/40 [00:04<00:26,  1.31it/s]                                              {'loss': 1.6529, 'grad_norm': 13.971766471862793, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:26,  1.31it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s]                                              {'loss': 1.8214, 'grad_norm': 36.266456604003906, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.40it/s]                                              {'loss': 2.6066, 'grad_norm': 26.858089447021484, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.40it/s] 20%|██        | 8/40 [00:05<00:17,  1.87it/s]                                              {'loss': 0.0157, 'grad_norm': 0.9501929879188538, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:17,  1.87it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s]                                              {'loss': 0.7714, 'grad_norm': 6.257412433624268, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s] 25%|██▌       | 10/40 [00:07<00:18,  1.66it/s]                                               {'loss': 0.4061, 'grad_norm': 8.710871696472168, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:18,  1.66it/s] 28%|██▊       | 11/40 [00:07<00:18,  1.57it/s]                                               {'loss': 0.6247, 'grad_norm': 5.85418701171875, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:18,  1.57it/s] 30%|███       | 12/40 [00:08<00:18,  1.52it/s]                                               {'loss': 0.6728, 'grad_norm': 6.62406063079834, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:18,  1.52it/s] 32%|███▎      | 13/40 [00:09<00:17,  1.57it/s]                                               {'loss': 0.8201, 'grad_norm': 10.223078727722168, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s]                                               {'loss': 0.387, 'grad_norm': 6.333371639251709, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s]                                               {'loss': 1.1419, 'grad_norm': 10.060851097106934, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s]                                               {'loss': 0.0122, 'grad_norm': 0.6418304443359375, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:15,  1.50it/s] 42%|████▎     | 17/40 [00:11<00:11,  1.94it/s]                                               {'loss': 0.5706, 'grad_norm': 2.4108967781066895, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:11,  1.94it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s]                                               {'loss': 0.0779, 'grad_norm': 1.6198577880859375, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.73it/s]                                               {'loss': 0.3, 'grad_norm': 5.667440891265869, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.73it/s] 50%|█████     | 20/40 [00:13<00:12,  1.64it/s]                                               {'loss': 0.0603, 'grad_norm': 1.0478864908218384, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:12,  1.64it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s]                                               {'loss': 0.1811, 'grad_norm': 4.246673107147217, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.61it/s]                                               {'loss': 0.3189, 'grad_norm': 2.79622483253479, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.61it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.53it/s]                                               {'loss': 0.2444, 'grad_norm': 2.5975446701049805, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:11,  1.53it/s]                                               {'loss': 0.1457, 'grad_norm': 11.832472801208496, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.87it/s]                                               {'loss': 0.4143, 'grad_norm': 0.8921967148780823, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.87it/s] 65%|██████▌   | 26/40 [00:16<00:07,  1.83it/s]                                               {'loss': 0.1836, 'grad_norm': 1.831235647201538, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:07,  1.83it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.68it/s]                                               {'loss': 0.058, 'grad_norm': 1.4482709169387817, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.68it/s] 70%|███████   | 28/40 [00:18<00:07,  1.63it/s]                                               {'loss': 0.0322, 'grad_norm': 0.6658561825752258, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:07,  1.63it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.60it/s]                                               {'loss': 0.0539, 'grad_norm': 1.9780583381652832, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.60it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.54it/s]                                               {'loss': 0.0295, 'grad_norm': 1.7347017526626587, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.54it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.60it/s]                                               {'loss': 0.1416, 'grad_norm': 3.6859219074249268, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.60it/s]                                               {'loss': 0.0007, 'grad_norm': 0.03809722885489464, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:20<00:04,  1.60it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.91it/s]                                               {'loss': 0.0226, 'grad_norm': 0.49502384662628174, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.76it/s]                                               {'loss': 0.032, 'grad_norm': 0.9230476021766663, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:22<00:02,  1.73it/s]                                               {'loss': 0.0457, 'grad_norm': 1.3485115766525269, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:22<00:02,  1.73it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.61it/s]                                               {'loss': 0.0688, 'grad_norm': 1.0417722463607788, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.58it/s]                                               {'loss': 0.066, 'grad_norm': 1.467686653137207, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:24<00:01,  1.56it/s]                                               {'loss': 0.0675, 'grad_norm': 3.4543204307556152, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:24<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]                                               {'loss': 0.4795, 'grad_norm': 8.216487884521484, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]                                               {'loss': 0.0046, 'grad_norm': 0.2880759537220001, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.52it/s]                                               {'train_runtime': 25.1153, 'train_samples_per_second': 22.496, 'train_steps_per_second': 1.593, 'train_loss': 0.5174136590954731, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.52it/s]100%|██████████| 40/40 [00:25<00:00,  1.59it/s]
CLIENT:62
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:59,  1.51s/it]                                              {'loss': 3.4916, 'grad_norm': 10.298429489135742, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:59,  1.51s/it]  5%|▌         | 2/40 [00:02<00:37,  1.00it/s]                                              {'loss': 2.0955, 'grad_norm': 10.83434009552002, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.00it/s]  8%|▊         | 3/40 [00:02<00:30,  1.19it/s]                                              {'loss': 2.1665, 'grad_norm': 16.26392936706543, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:30,  1.19it/s] 10%|█         | 4/40 [00:03<00:28,  1.28it/s]                                              {'loss': 3.0746, 'grad_norm': 20.248779296875, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:28,  1.28it/s] 12%|█▎        | 5/40 [00:04<00:24,  1.46it/s]                                              {'loss': 1.8893, 'grad_norm': 13.90838623046875, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:19,  1.76it/s]                                              {'loss': 0.7604, 'grad_norm': 10.206818580627441, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:19,  1.76it/s] 18%|█▊        | 7/40 [00:04<00:16,  1.96it/s]                                              {'loss': 3.088, 'grad_norm': 22.31537437438965, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:16,  1.96it/s]                                              {'loss': 0.4752, 'grad_norm': 29.33883285522461, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.96it/s] 22%|██▎       | 9/40 [00:05<00:14,  2.20it/s]                                              {'loss': 0.9404, 'grad_norm': 15.713007926940918, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:14,  2.20it/s] 25%|██▌       | 10/40 [00:06<00:15,  1.92it/s]                                               {'loss': 0.6877, 'grad_norm': 8.123178482055664, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:15,  1.92it/s] 28%|██▊       | 11/40 [00:06<00:15,  1.85it/s]                                               {'loss': 0.9973, 'grad_norm': 12.144966125488281, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:15,  1.85it/s] 30%|███       | 12/40 [00:07<00:16,  1.69it/s]                                               {'loss': 0.627, 'grad_norm': 9.2708158493042, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.69it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.64it/s]                                               {'loss': 0.7819, 'grad_norm': 6.364950180053711, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.64it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.60it/s]                                               {'loss': 0.557, 'grad_norm': 7.365572929382324, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.60it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.9858, 'grad_norm': 13.665151596069336, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.6161, 'grad_norm': 27.832088470458984, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.54it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.91it/s]                                               {'loss': 0.6288, 'grad_norm': 8.479458808898926, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.91it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.80it/s]                                               {'loss': 0.4394, 'grad_norm': 8.364119529724121, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.80it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.70it/s]                                               {'loss': 0.2302, 'grad_norm': 2.5976767539978027, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.70it/s] 50%|█████     | 20/40 [00:12<00:11,  1.73it/s]                                               {'loss': 0.4183, 'grad_norm': 2.843616247177124, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:11,  1.73it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.61it/s]                                               {'loss': 0.2705, 'grad_norm': 6.272226810455322, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.61it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.58it/s]                                               {'loss': 0.2091, 'grad_norm': 4.440194606781006, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.58it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.3329, 'grad_norm': 4.521093845367432, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.0319, 'grad_norm': 2.133876085281372, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.56it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.89it/s]                                               {'loss': 0.2172, 'grad_norm': 8.353629112243652, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.89it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.79it/s]                                               {'loss': 0.4352, 'grad_norm': 5.110340595245361, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.79it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.72it/s]                                               {'loss': 0.2689, 'grad_norm': 3.939087152481079, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.72it/s] 70%|███████   | 28/40 [00:17<00:07,  1.62it/s]                                               {'loss': 0.1214, 'grad_norm': 3.0331993103027344, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.62it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.62it/s]                                               {'loss': 0.0692, 'grad_norm': 2.204252243041992, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.62it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s]                                               {'loss': 0.0564, 'grad_norm': 1.530148983001709, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s]                                               {'loss': 0.2015, 'grad_norm': 6.101389408111572, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s]                                               {'loss': 0.0157, 'grad_norm': 1.1456940174102783, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.52it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.96it/s]                                               {'loss': 0.0614, 'grad_norm': 2.1643218994140625, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.96it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.77it/s]                                               {'loss': 0.0479, 'grad_norm': 1.6066229343414307, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.71it/s]                                               {'loss': 0.3137, 'grad_norm': 12.254599571228027, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.71it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.65it/s]                                               {'loss': 0.3075, 'grad_norm': 0.6822286248207092, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.65it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s]                                               {'loss': 0.0735, 'grad_norm': 2.308645725250244, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.59it/s]                                               {'loss': 0.2018, 'grad_norm': 3.3883421421051025, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.59it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]                                               {'loss': 0.0526, 'grad_norm': 1.437878131866455, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]                                               {'loss': 0.1564, 'grad_norm': 6.935935020446777, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.54it/s]                                               {'train_runtime': 24.1924, 'train_samples_per_second': 23.354, 'train_steps_per_second': 1.653, 'train_loss': 0.7098900764249265, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.54it/s]100%|██████████| 40/40 [00:24<00:00,  1.65it/s]
CLIENT:46
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]                                              {'loss': 3.9125, 'grad_norm': 9.665696144104004, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.02it/s]  5%|▌         | 2/40 [00:00<00:12,  2.98it/s]                                              {'loss': 0.9992, 'grad_norm': 8.170275688171387, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.98it/s]  8%|▊         | 3/40 [00:01<00:12,  2.95it/s]                                              {'loss': 1.473, 'grad_norm': 11.345841407775879, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.95it/s] 10%|█         | 4/40 [00:01<00:12,  2.94it/s]                                              {'loss': 1.9574, 'grad_norm': 15.15755558013916, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.94it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s]                                              {'loss': 2.0588, 'grad_norm': 16.191953659057617, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.95it/s] 15%|█▌        | 6/40 [00:02<00:11,  3.02it/s]                                              {'loss': 1.3089, 'grad_norm': 15.40276050567627, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  3.02it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s]                                              {'loss': 1.023, 'grad_norm': 16.064193725585938, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.02it/s] 20%|██        | 8/40 [00:02<00:09,  3.55it/s]                                              {'loss': 1.1396, 'grad_norm': 59.59921646118164, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.55it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.71it/s]                                              {'loss': 0.3717, 'grad_norm': 6.413853645324707, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.71it/s] 25%|██▌       | 10/40 [00:03<00:13,  2.23it/s]                                               {'loss': 0.8648, 'grad_norm': 11.429813385009766, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:13,  2.23it/s] 28%|██▊       | 11/40 [00:04<00:15,  1.91it/s]                                               {'loss': 0.5771, 'grad_norm': 4.978897571563721, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:15,  1.91it/s] 30%|███       | 12/40 [00:05<00:15,  1.82it/s]                                               {'loss': 0.5944, 'grad_norm': 6.552232265472412, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:15,  1.82it/s] 32%|███▎      | 13/40 [00:05<00:15,  1.71it/s]                                               {'loss': 0.8868, 'grad_norm': 5.265035629272461, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:15,  1.71it/s] 35%|███▌      | 14/40 [00:06<00:16,  1.61it/s]                                               {'loss': 1.1549, 'grad_norm': 6.485177516937256, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:16,  1.61it/s] 38%|███▊      | 15/40 [00:06<00:15,  1.64it/s]                                               {'loss': 1.4013, 'grad_norm': 8.454392433166504, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:15,  1.64it/s]                                               {'loss': 0.2365, 'grad_norm': 8.562525749206543, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:14,  1.64it/s] 42%|████▎     | 17/40 [00:07<00:11,  1.99it/s]                                               {'loss': 0.6809, 'grad_norm': 8.961759567260742, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:11,  1.99it/s] 45%|████▌     | 18/40 [00:08<00:12,  1.81it/s]                                               {'loss': 0.3593, 'grad_norm': 5.5981950759887695, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:12,  1.81it/s] 48%|████▊     | 19/40 [00:09<00:11,  1.77it/s]                                               {'loss': 0.8276, 'grad_norm': 3.1480984687805176, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:11,  1.77it/s] 50%|█████     | 20/40 [00:09<00:12,  1.67it/s]                                               {'loss': 0.3559, 'grad_norm': 4.8798441886901855, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:12,  1.67it/s] 52%|█████▎    | 21/40 [00:10<00:11,  1.65it/s]                                               {'loss': 0.3487, 'grad_norm': 3.2718331813812256, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:11,  1.65it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.61it/s]                                               {'loss': 0.4338, 'grad_norm': 5.816847801208496, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.61it/s] 57%|█████▊    | 23/40 [00:11<00:10,  1.56it/s]                                               {'loss': 0.3281, 'grad_norm': 7.016822338104248, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:10,  1.56it/s]                                               {'loss': 0.0094, 'grad_norm': 0.5626218914985657, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:10,  1.56it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.95it/s]                                               {'loss': 0.0837, 'grad_norm': 0.9083567261695862, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.95it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.82it/s]                                               {'loss': 0.2238, 'grad_norm': 2.9902732372283936, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.82it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.71it/s]                                               {'loss': 0.7216, 'grad_norm': 2.9693830013275146, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.71it/s] 70%|███████   | 28/40 [00:14<00:07,  1.69it/s]                                               {'loss': 0.1543, 'grad_norm': 3.3560550212860107, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.69it/s] 72%|███████▎  | 29/40 [00:15<00:06,  1.62it/s]                                               {'loss': 0.1424, 'grad_norm': 1.9754481315612793, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:06,  1.62it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.57it/s]                                               {'loss': 0.0353, 'grad_norm': 0.8386984467506409, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.57it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.62it/s]                                               {'loss': 0.1223, 'grad_norm': 3.133573055267334, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.62it/s]                                               {'loss': 0.0195, 'grad_norm': 1.4838593006134033, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:04,  1.62it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.93it/s]                                               {'loss': 0.1034, 'grad_norm': 3.205467939376831, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.93it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.83it/s]                                               {'loss': 0.1473, 'grad_norm': 5.38232421875, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.83it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.74it/s]                                               {'loss': 0.0365, 'grad_norm': 0.9867768883705139, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.74it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.63it/s]                                               {'loss': 0.5421, 'grad_norm': 1.0803601741790771, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.63it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.63it/s]                                               {'loss': 0.1165, 'grad_norm': 4.841970920562744, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.63it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.59it/s]                                               {'loss': 0.1078, 'grad_norm': 1.7397300004959106, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.59it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.55it/s]                                               {'loss': 0.0668, 'grad_norm': 2.712202310562134, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.55it/s]                                               {'loss': 0.2675, 'grad_norm': 13.81479263305664, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.55it/s]                                               {'train_runtime': 21.3855, 'train_samples_per_second': 26.42, 'train_steps_per_second': 1.87, 'train_loss': 0.6548604144947603, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.55it/s]100%|██████████| 40/40 [00:21<00:00,  1.87it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:00,  1.55s/it]                                              {'loss': 2.8118, 'grad_norm': 7.116497993469238, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:00,  1.55s/it]  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]                                              {'loss': 2.2047, 'grad_norm': 10.618159294128418, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]  8%|▊         | 3/40 [00:02<00:32,  1.13it/s]                                              {'loss': 1.526, 'grad_norm': 10.756291389465332, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.13it/s] 10%|█         | 4/40 [00:03<00:27,  1.31it/s]                                              {'loss': 1.0481, 'grad_norm': 11.041781425476074, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.31it/s] 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s]                                              {'loss': 1.0839, 'grad_norm': 10.449792861938477, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s]                                              {'loss': 1.4489, 'grad_norm': 13.356389999389648, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s] 18%|█▊        | 7/40 [00:05<00:22,  1.45it/s]                                              {'loss': 1.3387, 'grad_norm': 20.265655517578125, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:22,  1.45it/s]                                              {'loss': 3.0172, 'grad_norm': 139.96078491210938, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:16,  1.83it/s]                                              {'loss': 0.9365, 'grad_norm': 14.242265701293945, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:16,  1.83it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s]                                               {'loss': 1.1931, 'grad_norm': 12.151541709899902, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.68it/s]                                               {'loss': 0.2298, 'grad_norm': 4.711686134338379, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.68it/s] 30%|███       | 12/40 [00:07<00:15,  1.87it/s]                                               {'loss': 0.5963, 'grad_norm': 6.965381622314453, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:15,  1.87it/s] 32%|███▎      | 13/40 [00:08<00:13,  2.07it/s]                                               {'loss': 0.3284, 'grad_norm': 4.359169006347656, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:13,  2.07it/s] 35%|███▌      | 14/40 [00:08<00:11,  2.28it/s]                                               {'loss': 0.6074, 'grad_norm': 8.16877555847168, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:11,  2.28it/s] 38%|███▊      | 15/40 [00:09<00:10,  2.44it/s]                                               {'loss': 0.4797, 'grad_norm': 7.806748390197754, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:10,  2.44it/s]                                               {'loss': 0.1812, 'grad_norm': 10.681906700134277, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:09,  2.44it/s] 42%|████▎     | 17/40 [00:09<00:07,  3.16it/s]                                               {'loss': 0.3989, 'grad_norm': 5.285719394683838, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:07,  3.16it/s] 45%|████▌     | 18/40 [00:09<00:07,  3.02it/s]                                               {'loss': 0.2344, 'grad_norm': 4.023495674133301, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:07,  3.02it/s] 48%|████▊     | 19/40 [00:10<00:06,  3.02it/s]                                               {'loss': 0.4689, 'grad_norm': 10.131760597229004, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:06,  3.02it/s] 50%|█████     | 20/40 [00:10<00:06,  2.98it/s]                                               {'loss': 0.3568, 'grad_norm': 7.847817420959473, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:06,  2.98it/s] 52%|█████▎    | 21/40 [00:10<00:06,  2.92it/s]                                               {'loss': 0.2777, 'grad_norm': 3.453618288040161, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:06,  2.92it/s] 55%|█████▌    | 22/40 [00:11<00:06,  2.95it/s]                                               {'loss': 0.4577, 'grad_norm': 3.712904214859009, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:06,  2.95it/s] 57%|█████▊    | 23/40 [00:11<00:05,  2.95it/s]                                               {'loss': 0.35, 'grad_norm': 5.975584983825684, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:05,  2.95it/s]                                               {'loss': 1.4985, 'grad_norm': 19.228656768798828, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:05,  2.95it/s] 62%|██████▎   | 25/40 [00:11<00:04,  3.50it/s]                                               {'loss': 0.4442, 'grad_norm': 8.887022972106934, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:04,  3.50it/s] 65%|██████▌   | 26/40 [00:12<00:04,  3.33it/s]                                               {'loss': 0.4078, 'grad_norm': 5.4953837394714355, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:04,  3.33it/s] 68%|██████▊   | 27/40 [00:12<00:04,  3.21it/s]                                               {'loss': 0.1455, 'grad_norm': 2.310086727142334, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:04,  3.21it/s] 70%|███████   | 28/40 [00:12<00:03,  3.14it/s]                                               {'loss': 0.3668, 'grad_norm': 2.579561233520508, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:03,  3.14it/s] 72%|███████▎  | 29/40 [00:13<00:03,  3.10it/s]                                               {'loss': 0.0975, 'grad_norm': 1.770182490348816, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:03,  3.10it/s] 75%|███████▌  | 30/40 [00:13<00:03,  3.03it/s]                                               {'loss': 0.419, 'grad_norm': 10.17789363861084, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:03,  3.03it/s] 78%|███████▊  | 31/40 [00:14<00:02,  3.01it/s]                                               {'loss': 0.0174, 'grad_norm': 1.9408208131790161, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:02,  3.01it/s]                                               {'loss': 0.4609, 'grad_norm': 12.71547794342041, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  3.01it/s] 82%|████████▎ | 33/40 [00:14<00:01,  3.63it/s]                                               {'loss': 0.2676, 'grad_norm': 3.0981814861297607, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:01,  3.63it/s] 85%|████████▌ | 34/40 [00:14<00:01,  3.39it/s]                                               {'loss': 0.0861, 'grad_norm': 2.059047222137451, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:01,  3.39it/s] 88%|████████▊ | 35/40 [00:15<00:01,  3.20it/s]                                               {'loss': 0.0759, 'grad_norm': 2.01108717918396, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:01,  3.20it/s] 90%|█████████ | 36/40 [00:15<00:01,  3.12it/s]                                               {'loss': 0.1112, 'grad_norm': 1.6133332252502441, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  3.12it/s] 92%|█████████▎| 37/40 [00:15<00:00,  3.04it/s]                                               {'loss': 0.2856, 'grad_norm': 0.9415214657783508, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:00,  3.04it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.26it/s]                                               {'loss': 0.0442, 'grad_norm': 1.768229603767395, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.26it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.01it/s]                                               {'loss': 0.2592, 'grad_norm': 6.162243366241455, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.01it/s]                                               {'loss': 0.0064, 'grad_norm': 0.40849894285202026, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.01it/s]                                               {'train_runtime': 17.4678, 'train_samples_per_second': 32.345, 'train_steps_per_second': 2.29, 'train_loss': 0.6642455595778302, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.01it/s]100%|██████████| 40/40 [00:17<00:00,  2.29it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:01,  1.56s/it]                                              {'loss': 4.2592, 'grad_norm': 11.26321029663086, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:01,  1.56s/it]  5%|▌         | 2/40 [00:02<00:39,  1.03s/it]                                              {'loss': 2.7027, 'grad_norm': 11.914176940917969, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.03s/it]  8%|▊         | 3/40 [00:02<00:32,  1.14it/s]                                              {'loss': 2.5555, 'grad_norm': 11.370305061340332, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.14it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 1.8243, 'grad_norm': 18.401262283325195, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s]                                              {'loss': 1.4649, 'grad_norm': 18.213150024414062, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s]                                              {'loss': 1.7637, 'grad_norm': 22.18126678466797, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.43it/s]                                              {'loss': 1.5982, 'grad_norm': 18.858352661132812, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.43it/s]                                              {'loss': 0.8829, 'grad_norm': 75.87115478515625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.43it/s] 22%|██▎       | 9/40 [00:06<00:17,  1.81it/s]                                              {'loss': 0.8683, 'grad_norm': 13.208767890930176, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:17,  1.81it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s]                                               {'loss': 1.6481, 'grad_norm': 14.308425903320312, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.68it/s]                                               {'loss': 0.9882, 'grad_norm': 12.707358360290527, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.68it/s] 30%|███       | 12/40 [00:08<00:17,  1.59it/s]                                               {'loss': 0.5986, 'grad_norm': 9.34256649017334, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.59it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s]                                               {'loss': 0.7637, 'grad_norm': 7.970456600189209, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.55it/s]                                               {'loss': 1.3114, 'grad_norm': 9.398890495300293, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.55it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s]                                               {'loss': 0.7331, 'grad_norm': 6.695660591125488, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s]                                               {'loss': 0.1227, 'grad_norm': 4.973635196685791, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:16,  1.50it/s] 42%|████▎     | 17/40 [00:11<00:11,  1.93it/s]                                               {'loss': 1.0256, 'grad_norm': 10.157838821411133, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:11,  1.93it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.78it/s]                                               {'loss': 0.7016, 'grad_norm': 6.52763032913208, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.78it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.68it/s]                                               {'loss': 0.5435, 'grad_norm': 5.1310882568359375, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.68it/s] 50%|█████     | 20/40 [00:13<00:11,  1.68it/s]                                               {'loss': 0.9265, 'grad_norm': 4.947085857391357, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:11,  1.68it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s]                                               {'loss': 0.7305, 'grad_norm': 7.104471683502197, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.56it/s]                                               {'loss': 0.5075, 'grad_norm': 7.463201522827148, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.56it/s] 57%|█████▊    | 23/40 [00:15<00:10,  1.55it/s]                                               {'loss': 0.5391, 'grad_norm': 6.935664653778076, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:10,  1.55it/s]                                               {'loss': 1.4027, 'grad_norm': 60.04890823364258, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.55it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.87it/s]                                               {'loss': 0.1193, 'grad_norm': 1.6257717609405518, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.87it/s] 65%|██████▌   | 26/40 [00:16<00:07,  1.77it/s]                                               {'loss': 0.3977, 'grad_norm': 3.1032791137695312, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:07,  1.77it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.69it/s]                                               {'loss': 0.2477, 'grad_norm': 3.4859511852264404, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.69it/s] 70%|███████   | 28/40 [00:17<00:07,  1.61it/s]                                               {'loss': 0.1826, 'grad_norm': 3.205247163772583, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.61it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.66it/s]                                               {'loss': 0.3065, 'grad_norm': 2.801090955734253, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.66it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.56it/s]                                               {'loss': 0.2226, 'grad_norm': 4.901795387268066, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.55it/s]                                               {'loss': 0.3987, 'grad_norm': 7.117311954498291, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.55it/s]                                               {'loss': 0.0072, 'grad_norm': 0.4233632981777191, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.55it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.96it/s]                                               {'loss': 0.1486, 'grad_norm': 2.898031711578369, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.96it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.77it/s]                                               {'loss': 0.0562, 'grad_norm': 1.9945769309997559, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.71it/s]                                               {'loss': 0.1335, 'grad_norm': 3.988065719604492, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.71it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.64it/s]                                               {'loss': 0.5198, 'grad_norm': 13.715442657470703, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.64it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.56it/s]                                               {'loss': 0.098, 'grad_norm': 1.5882377624511719, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.56it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s]                                               {'loss': 0.2934, 'grad_norm': 4.09061336517334, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.53it/s]                                               {'loss': 0.1549, 'grad_norm': 2.9850032329559326, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.53it/s]                                               {'loss': 0.1163, 'grad_norm': 7.394840717315674, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.53it/s]                                               {'train_runtime': 24.9556, 'train_samples_per_second': 22.64, 'train_steps_per_second': 1.603, 'train_loss': 0.8466367063345388, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.53it/s]100%|██████████| 40/40 [00:24<00:00,  1.60it/s]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.89it/s]                                              {'loss': 3.676, 'grad_norm': 11.202606201171875, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.89it/s]  5%|▌         | 2/40 [00:00<00:13,  2.76it/s]                                              {'loss': 1.9812, 'grad_norm': 8.990713119506836, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.76it/s]  8%|▊         | 3/40 [00:01<00:13,  2.81it/s]                                              {'loss': 3.1579, 'grad_norm': 14.587117195129395, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.81it/s] 10%|█         | 4/40 [00:01<00:14,  2.50it/s]                                              {'loss': 2.2477, 'grad_norm': 16.10707664489746, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.50it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.00it/s]                                              {'loss': 1.5151, 'grad_norm': 13.619460105895996, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.00it/s] 15%|█▌        | 6/40 [00:02<00:18,  1.89it/s]                                              {'loss': 1.5124, 'grad_norm': 18.099096298217773, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:18,  1.89it/s] 18%|█▊        | 7/40 [00:03<00:18,  1.77it/s]                                              {'loss': 1.0476, 'grad_norm': 15.336485862731934, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:18,  1.77it/s]                                              {'loss': 5.5362, 'grad_norm': 82.01880645751953, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:18,  1.77it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.09it/s]                                              {'loss': 1.1576, 'grad_norm': 10.241567611694336, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.09it/s] 25%|██▌       | 10/40 [00:04<00:15,  1.91it/s]                                               {'loss': 0.799, 'grad_norm': 10.38964557647705, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:15,  1.91it/s] 28%|██▊       | 11/40 [00:05<00:16,  1.80it/s]                                               {'loss': 1.1712, 'grad_norm': 10.481616973876953, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:16,  1.80it/s] 30%|███       | 12/40 [00:06<00:16,  1.69it/s]                                               {'loss': 0.7941, 'grad_norm': 6.769099235534668, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:16,  1.69it/s] 32%|███▎      | 13/40 [00:06<00:16,  1.67it/s]                                               {'loss': 0.7932, 'grad_norm': 7.141999244689941, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.67it/s] 35%|███▌      | 14/40 [00:07<00:16,  1.60it/s]                                               {'loss': 0.9839, 'grad_norm': 6.651144504547119, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:16,  1.60it/s] 38%|███▊      | 15/40 [00:08<00:16,  1.54it/s]                                               {'loss': 1.4236, 'grad_norm': 10.49515438079834, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:16,  1.54it/s]                                               {'loss': 1.5486, 'grad_norm': 42.63490676879883, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:15,  1.54it/s] 42%|████▎     | 17/40 [00:08<00:11,  2.04it/s]                                               {'loss': 0.8044, 'grad_norm': 5.697047710418701, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:11,  2.04it/s] 45%|████▌     | 18/40 [00:09<00:11,  1.98it/s]                                               {'loss': 0.4148, 'grad_norm': 4.863821029663086, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:11,  1.98it/s] 48%|████▊     | 19/40 [00:09<00:11,  1.86it/s]                                               {'loss': 0.413, 'grad_norm': 3.0714898109436035, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:11,  1.86it/s] 50%|█████     | 20/40 [00:10<00:11,  1.72it/s]                                               {'loss': 0.8851, 'grad_norm': 3.6109986305236816, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:11,  1.72it/s] 52%|█████▎    | 21/40 [00:11<00:11,  1.70it/s]                                               {'loss': 0.2566, 'grad_norm': 3.8920016288757324, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:11,  1.70it/s] 55%|█████▌    | 22/40 [00:11<00:11,  1.60it/s]                                               {'loss': 0.271, 'grad_norm': 6.116384983062744, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:11,  1.60it/s] 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s]                                               {'loss': 0.4835, 'grad_norm': 6.518466472625732, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s]                                               {'loss': 0.11, 'grad_norm': 11.898351669311523, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.57it/s] 62%|██████▎   | 25/40 [00:13<00:07,  1.98it/s]                                               {'loss': 0.5676, 'grad_norm': 7.526551723480225, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:07,  1.98it/s] 65%|██████▌   | 26/40 [00:14<00:07,  1.81it/s]                                               {'loss': 0.3627, 'grad_norm': 11.023468017578125, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:07,  1.81it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.71it/s]                                               {'loss': 0.148, 'grad_norm': 3.2400636672973633, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.71it/s] 70%|███████   | 28/40 [00:15<00:07,  1.69it/s]                                               {'loss': 0.1185, 'grad_norm': 2.581791877746582, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.69it/s] 72%|███████▎  | 29/40 [00:16<00:06,  1.59it/s]                                               {'loss': 0.7607, 'grad_norm': 3.8393125534057617, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.63it/s]                                               {'loss': 0.3592, 'grad_norm': 1.9731550216674805, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.63it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.56it/s]                                               {'loss': 0.1543, 'grad_norm': 2.2339160442352295, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.56it/s]                                               {'loss': 0.0862, 'grad_norm': 6.861868858337402, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.56it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.88it/s]                                               {'loss': 0.1434, 'grad_norm': 1.8873846530914307, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.88it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.83it/s]                                               {'loss': 0.7201, 'grad_norm': 4.76561164855957, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.83it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.70it/s]                                               {'loss': 0.1436, 'grad_norm': 4.7625322341918945, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.70it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.63it/s]                                               {'loss': 0.1065, 'grad_norm': 3.06179141998291, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.63it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.65it/s]                                               {'loss': 0.1287, 'grad_norm': 4.284242630004883, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.65it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.56it/s]                                               {'loss': 0.4364, 'grad_norm': 2.810788869857788, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.56it/s]                                               {'loss': 0.3183, 'grad_norm': 4.29340124130249, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.56it/s]                                               {'loss': 0.0295, 'grad_norm': 1.5659286975860596, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.56it/s]                                               {'train_runtime': 22.4179, 'train_samples_per_second': 25.203, 'train_steps_per_second': 1.784, 'train_loss': 0.939188471948728, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.56it/s]100%|██████████| 40/40 [00:22<00:00,  1.78it/s]
CLIENT:11
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.48it/s]                                              {'loss': 2.9959, 'grad_norm': 8.852907180786133, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.48it/s]  5%|▌         | 2/40 [00:01<00:24,  1.54it/s]                                              {'loss': 2.9485, 'grad_norm': 11.742622375488281, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.54it/s]  8%|▊         | 3/40 [00:02<00:24,  1.49it/s]                                              {'loss': 1.6879, 'grad_norm': 10.974173545837402, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:23,  1.53it/s]                                              {'loss': 2.8906, 'grad_norm': 17.851253509521484, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.53it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 2.3864, 'grad_norm': 19.94845199584961, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s]                                              {'loss': 1.5528, 'grad_norm': 12.460237503051758, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s]                                              {'loss': 1.7367, 'grad_norm': 14.276817321777344, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s]                                              {'loss': 0.7451, 'grad_norm': 50.23582458496094, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:20,  1.53it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.90it/s]                                              {'loss': 0.6091, 'grad_norm': 7.214632034301758, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.90it/s] 25%|██▌       | 10/40 [00:05<00:15,  1.99it/s]                                               {'loss': 0.8932, 'grad_norm': 9.499256134033203, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:15,  1.99it/s] 28%|██▊       | 11/40 [00:06<00:13,  2.17it/s]                                               {'loss': 1.5182, 'grad_norm': 12.390120506286621, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:13,  2.17it/s] 30%|███       | 12/40 [00:06<00:11,  2.35it/s]                                               {'loss': 0.7713, 'grad_norm': 6.740706443786621, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:11,  2.35it/s] 32%|███▎      | 13/40 [00:06<00:10,  2.49it/s]                                               {'loss': 0.9103, 'grad_norm': 7.521919250488281, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:10,  2.49it/s] 35%|███▌      | 14/40 [00:07<00:10,  2.59it/s]                                               {'loss': 1.0317, 'grad_norm': 8.040085792541504, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:10,  2.59it/s] 38%|███▊      | 15/40 [00:07<00:09,  2.70it/s]                                               {'loss': 1.02, 'grad_norm': 5.406603813171387, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:09,  2.70it/s]                                               {'loss': 0.0147, 'grad_norm': 0.6921075582504272, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.70it/s] 42%|████▎     | 17/40 [00:07<00:06,  3.43it/s]                                               {'loss': 0.5143, 'grad_norm': 3.822770833969116, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:06,  3.43it/s] 45%|████▌     | 18/40 [00:08<00:06,  3.22it/s]                                               {'loss': 0.4396, 'grad_norm': 3.365614414215088, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:06,  3.22it/s] 48%|████▊     | 19/40 [00:08<00:06,  3.05it/s]                                               {'loss': 0.5168, 'grad_norm': 4.791943073272705, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:06,  3.05it/s] 50%|█████     | 20/40 [00:09<00:06,  2.96it/s]                                               {'loss': 0.6133, 'grad_norm': 6.530002117156982, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:06,  2.96it/s] 52%|█████▎    | 21/40 [00:09<00:06,  2.90it/s]                                               {'loss': 0.6003, 'grad_norm': 7.171969890594482, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:06,  2.90it/s] 55%|█████▌    | 22/40 [00:09<00:06,  2.88it/s]                                               {'loss': 0.177, 'grad_norm': 4.606264114379883, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:06,  2.88it/s] 57%|█████▊    | 23/40 [00:10<00:05,  2.89it/s]                                               {'loss': 0.5968, 'grad_norm': 9.894607543945312, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:05,  2.89it/s]                                               {'loss': 0.4772, 'grad_norm': 20.28545570373535, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.89it/s] 62%|██████▎   | 25/40 [00:10<00:04,  3.45it/s]                                               {'loss': 0.2242, 'grad_norm': 3.2140328884124756, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:04,  3.45it/s] 65%|██████▌   | 26/40 [00:10<00:04,  3.22it/s]                                               {'loss': 0.3789, 'grad_norm': 5.114704132080078, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  3.22it/s] 68%|██████▊   | 27/40 [00:11<00:04,  3.09it/s]                                               {'loss': 0.2331, 'grad_norm': 2.046003580093384, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:04,  3.09it/s] 70%|███████   | 28/40 [00:11<00:03,  3.03it/s]                                               {'loss': 0.3725, 'grad_norm': 5.175339221954346, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:03,  3.03it/s] 72%|███████▎  | 29/40 [00:11<00:03,  3.01it/s]                                               {'loss': 0.1709, 'grad_norm': 2.077409029006958, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:03,  3.01it/s] 75%|███████▌  | 30/40 [00:12<00:03,  2.98it/s]                                               {'loss': 0.3432, 'grad_norm': 1.7595678567886353, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:03,  2.98it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.97it/s]                                               {'loss': 0.2203, 'grad_norm': 5.865971088409424, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.97it/s]                                               {'loss': 0.112, 'grad_norm': 5.137431621551514, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.97it/s] 82%|████████▎ | 33/40 [00:13<00:01,  3.61it/s]                                               {'loss': 0.0987, 'grad_norm': 2.7338197231292725, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:01,  3.61it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.40it/s]                                               {'loss': 0.1663, 'grad_norm': 0.9923632740974426, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.40it/s] 88%|████████▊ | 35/40 [00:13<00:01,  3.25it/s]                                               {'loss': 0.2086, 'grad_norm': 4.975458145141602, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  3.25it/s] 90%|█████████ | 36/40 [00:14<00:01,  3.10it/s]                                               {'loss': 0.0471, 'grad_norm': 1.0228290557861328, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  3.10it/s] 92%|█████████▎| 37/40 [00:14<00:00,  3.02it/s]                                               {'loss': 0.0598, 'grad_norm': 1.3487176895141602, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:00,  3.02it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.97it/s]                                               {'loss': 0.361, 'grad_norm': 3.2640414237976074, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.97it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.96it/s]                                               {'loss': 0.2714, 'grad_norm': 4.287322044372559, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.96it/s]100%|██████████| 40/40 [00:15<00:00,  3.61it/s]                                               {'loss': 1.5888, 'grad_norm': 16.67308807373047, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.61it/s]                                               {'train_runtime': 15.6301, 'train_samples_per_second': 36.148, 'train_steps_per_second': 2.559, 'train_loss': 0.812612341181375, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.61it/s]100%|██████████| 40/40 [00:15<00:00,  2.56it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:12,  6.48it/s]  1%|          | 3/471 [00:00<01:57,  3.99it/s]  1%|          | 4/471 [00:01<02:20,  3.33it/s]  1%|          | 5/471 [00:01<02:25,  3.21it/s]  1%|▏         | 6/471 [00:01<02:30,  3.10it/s]  1%|▏         | 7/471 [00:02<02:42,  2.86it/s]  2%|▏         | 8/471 [00:02<02:38,  2.92it/s]  2%|▏         | 9/471 [00:02<02:34,  2.99it/s]  2%|▏         | 10/471 [00:03<02:45,  2.79it/s]  2%|▏         | 11/471 [00:03<02:42,  2.83it/s]  3%|▎         | 12/471 [00:03<02:35,  2.95it/s]  3%|▎         | 13/471 [00:04<02:45,  2.77it/s]  3%|▎         | 14/471 [00:04<02:46,  2.75it/s]  3%|▎         | 15/471 [00:04<02:41,  2.83it/s]  3%|▎         | 16/471 [00:05<02:33,  2.96it/s]  4%|▎         | 17/471 [00:05<02:44,  2.76it/s]  4%|▍         | 18/471 [00:06<02:40,  2.82it/s]  4%|▍         | 19/471 [00:06<02:33,  2.95it/s]  4%|▍         | 20/471 [00:06<02:43,  2.76it/s]  4%|▍         | 21/471 [00:07<02:43,  2.75it/s]  5%|▍         | 22/471 [00:07<02:38,  2.84it/s]  5%|▍         | 23/471 [00:07<02:38,  2.83it/s]  5%|▌         | 24/471 [00:08<02:43,  2.73it/s]  5%|▌         | 25/471 [00:08<02:38,  2.82it/s]  6%|▌         | 26/471 [00:08<02:35,  2.86it/s]  6%|▌         | 27/471 [00:09<02:43,  2.71it/s]  6%|▌         | 28/471 [00:09<02:38,  2.80it/s]  6%|▌         | 29/471 [00:09<02:32,  2.90it/s]  6%|▋         | 30/471 [00:10<02:41,  2.73it/s]  7%|▋         | 31/471 [00:10<02:39,  2.76it/s]  7%|▋         | 32/471 [00:10<02:31,  2.90it/s]  7%|▋         | 33/471 [00:11<02:37,  2.78it/s]  7%|▋         | 34/471 [00:11<02:39,  2.73it/s]  7%|▋         | 35/471 [00:12<02:35,  2.81it/s]  8%|▊         | 36/471 [00:12<02:34,  2.82it/s]  8%|▊         | 37/471 [00:12<02:41,  2.69it/s]  8%|▊         | 38/471 [00:13<02:35,  2.79it/s]  8%|▊         | 39/471 [00:13<02:24,  2.98it/s]  8%|▊         | 40/471 [00:13<02:33,  2.81it/s]  9%|▊         | 41/471 [00:14<02:35,  2.76it/s]  9%|▉         | 42/471 [00:14<02:31,  2.84it/s]  9%|▉         | 43/471 [00:14<02:30,  2.84it/s]  9%|▉         | 44/471 [00:15<02:37,  2.72it/s] 10%|▉         | 45/471 [00:15<02:31,  2.81it/s] 10%|▉         | 46/471 [00:15<02:27,  2.88it/s] 10%|▉         | 47/471 [00:16<02:36,  2.71it/s] 10%|█         | 48/471 [00:16<02:31,  2.79it/s] 10%|█         | 49/471 [00:17<02:24,  2.92it/s] 11%|█         | 50/471 [00:17<02:33,  2.74it/s] 11%|█         | 51/471 [00:17<02:33,  2.74it/s] 11%|█         | 52/471 [00:18<02:27,  2.84it/s] 11%|█▏        | 53/471 [00:18<02:29,  2.80it/s] 11%|█▏        | 54/471 [00:18<02:34,  2.71it/s] 12%|█▏        | 55/471 [00:19<02:28,  2.80it/s] 12%|█▏        | 56/471 [00:19<02:27,  2.81it/s] 12%|█▏        | 57/471 [00:20<02:33,  2.70it/s] 12%|█▏        | 58/471 [00:20<02:27,  2.79it/s] 13%|█▎        | 59/471 [00:20<02:25,  2.84it/s] 13%|█▎        | 60/471 [00:21<02:33,  2.69it/s] 13%|█▎        | 61/471 [00:21<02:28,  2.76it/s] 13%|█▎        | 62/471 [00:21<02:21,  2.90it/s] 13%|█▎        | 63/471 [00:22<02:21,  2.89it/s] 14%|█▎        | 64/471 [00:22<02:28,  2.74it/s] 14%|█▍        | 65/471 [00:22<02:23,  2.82it/s] 14%|█▍        | 66/471 [00:23<02:21,  2.86it/s] 14%|█▍        | 67/471 [00:23<02:29,  2.70it/s] 14%|█▍        | 68/471 [00:23<02:24,  2.79it/s] 15%|█▍        | 69/471 [00:24<02:18,  2.90it/s] 15%|█▍        | 70/471 [00:24<02:27,  2.73it/s] 15%|█▌        | 71/471 [00:25<02:25,  2.75it/s] 15%|█▌        | 72/471 [00:25<02:19,  2.86it/s] 15%|█▌        | 73/471 [00:25<02:23,  2.78it/s] 16%|█▌        | 74/471 [00:26<02:26,  2.72it/s] 16%|█▌        | 75/471 [00:26<02:21,  2.79it/s] 16%|█▌        | 76/471 [00:26<02:20,  2.82it/s] 16%|█▋        | 77/471 [00:27<02:26,  2.69it/s] 17%|█▋        | 78/471 [00:27<02:21,  2.77it/s] 17%|█▋        | 79/471 [00:27<02:18,  2.84it/s] 17%|█▋        | 80/471 [00:28<02:26,  2.68it/s] 17%|█▋        | 81/471 [00:28<02:20,  2.77it/s] 17%|█▋        | 82/471 [00:28<02:14,  2.90it/s] 18%|█▊        | 83/471 [00:29<02:22,  2.73it/s] 18%|█▊        | 84/471 [00:29<02:21,  2.74it/s] 18%|█▊        | 85/471 [00:30<02:15,  2.85it/s] 18%|█▊        | 86/471 [00:30<02:00,  3.21it/s] 18%|█▊        | 87/471 [00:30<01:45,  3.63it/s] 19%|█▊        | 88/471 [00:30<01:35,  4.00it/s] 19%|█▉        | 89/471 [00:30<01:28,  4.30it/s] 19%|█▉        | 90/471 [00:30<01:23,  4.54it/s] 19%|█▉        | 91/471 [00:31<01:20,  4.75it/s] 20%|█▉        | 92/471 [00:31<01:17,  4.90it/s] 20%|█▉        | 93/471 [00:31<01:15,  4.99it/s] 20%|█▉        | 94/471 [00:31<01:14,  5.09it/s] 20%|██        | 95/471 [00:31<01:12,  5.16it/s] 20%|██        | 96/471 [00:32<01:12,  5.18it/s] 21%|██        | 97/471 [00:32<01:12,  5.18it/s] 21%|██        | 98/471 [00:32<01:11,  5.21it/s] 21%|██        | 99/471 [00:32<01:11,  5.23it/s] 21%|██        | 100/471 [00:32<01:10,  5.26it/s] 21%|██▏       | 101/471 [00:33<01:10,  5.26it/s] 22%|██▏       | 102/471 [00:33<01:10,  5.25it/s] 22%|██▏       | 103/471 [00:33<01:10,  5.25it/s] 22%|██▏       | 104/471 [00:33<01:09,  5.24it/s] 22%|██▏       | 105/471 [00:33<01:09,  5.25it/s] 23%|██▎       | 106/471 [00:34<01:09,  5.27it/s] 23%|██▎       | 107/471 [00:34<01:09,  5.26it/s] 23%|██▎       | 108/471 [00:34<01:09,  5.25it/s] 23%|██▎       | 109/471 [00:34<01:08,  5.29it/s] 23%|██▎       | 110/471 [00:34<01:08,  5.27it/s] 24%|██▎       | 111/471 [00:34<01:08,  5.29it/s] 24%|██▍       | 112/471 [00:35<01:08,  5.28it/s] 24%|██▍       | 113/471 [00:35<01:07,  5.29it/s] 24%|██▍       | 114/471 [00:35<01:07,  5.30it/s] 24%|██▍       | 115/471 [00:35<01:07,  5.29it/s] 25%|██▍       | 116/471 [00:35<01:07,  5.28it/s] 25%|██▍       | 117/471 [00:36<01:07,  5.27it/s] 25%|██▌       | 118/471 [00:36<01:07,  5.20it/s] 25%|██▌       | 119/471 [00:36<01:07,  5.19it/s] 25%|██▌       | 120/471 [00:36<01:07,  5.19it/s] 26%|██▌       | 121/471 [00:36<01:07,  5.20it/s] 26%|██▌       | 122/471 [00:37<01:06,  5.23it/s] 26%|██▌       | 123/471 [00:37<01:06,  5.26it/s] 26%|██▋       | 124/471 [00:37<01:06,  5.26it/s] 27%|██▋       | 125/471 [00:37<01:06,  5.23it/s] 27%|██▋       | 126/471 [00:37<01:05,  5.24it/s] 27%|██▋       | 127/471 [00:38<01:05,  5.23it/s] 27%|██▋       | 128/471 [00:38<01:05,  5.24it/s] 27%|██▋       | 129/471 [00:38<01:04,  5.27it/s] 28%|██▊       | 130/471 [00:38<01:05,  5.20it/s] 28%|██▊       | 131/471 [00:38<01:05,  5.17it/s] 28%|██▊       | 132/471 [00:39<01:05,  5.17it/s] 28%|██▊       | 133/471 [00:39<01:05,  5.15it/s] 28%|██▊       | 134/471 [00:39<01:04,  5.19it/s] 29%|██▊       | 135/471 [00:39<01:05,  5.16it/s] 29%|██▉       | 136/471 [00:39<01:11,  4.67it/s] 29%|██▉       | 137/471 [00:40<01:30,  3.69it/s] 29%|██▉       | 138/471 [00:40<01:38,  3.39it/s] 30%|██▉       | 139/471 [00:40<01:38,  3.37it/s] 30%|██▉       | 140/471 [00:41<01:44,  3.16it/s] 30%|██▉       | 141/471 [00:41<01:52,  2.94it/s] 30%|███       | 142/471 [00:41<01:50,  2.97it/s] 30%|███       | 143/471 [00:42<01:50,  2.96it/s] 31%|███       | 144/471 [00:42<01:58,  2.77it/s] 31%|███       | 145/471 [00:43<01:53,  2.86it/s] 31%|███       | 146/471 [00:43<01:51,  2.92it/s] 31%|███       | 147/471 [00:43<01:57,  2.75it/s] 31%|███▏      | 148/471 [00:44<01:55,  2.81it/s] 32%|███▏      | 149/471 [00:44<01:49,  2.95it/s] 32%|███▏      | 150/471 [00:44<01:55,  2.77it/s] 32%|███▏      | 151/471 [00:45<01:56,  2.75it/s] 32%|███▏      | 152/471 [00:45<01:52,  2.84it/s] 32%|███▏      | 153/471 [00:45<01:52,  2.82it/s] 33%|███▎      | 154/471 [00:46<01:56,  2.73it/s] 33%|███▎      | 155/471 [00:46<01:51,  2.83it/s] 33%|███▎      | 156/471 [00:46<01:49,  2.87it/s] 33%|███▎      | 157/471 [00:47<01:56,  2.70it/s] 34%|███▎      | 158/471 [00:47<01:52,  2.79it/s] 34%|███▍      | 159/471 [00:48<01:46,  2.93it/s] 34%|███▍      | 160/471 [00:48<01:48,  2.87it/s] 34%|███▍      | 161/471 [00:48<01:51,  2.77it/s] 34%|███▍      | 162/471 [00:49<01:48,  2.85it/s] 35%|███▍      | 163/471 [00:49<01:47,  2.87it/s] 35%|███▍      | 164/471 [00:49<01:53,  2.72it/s] 35%|███▌      | 165/471 [00:50<01:48,  2.81it/s] 35%|███▌      | 166/471 [00:50<01:45,  2.90it/s] 35%|███▌      | 167/471 [00:50<01:51,  2.73it/s] 36%|███▌      | 168/471 [00:51<01:48,  2.78it/s] 36%|███▌      | 169/471 [00:51<01:42,  2.94it/s] 36%|███▌      | 170/471 [00:51<01:48,  2.78it/s] 36%|███▋      | 171/471 [00:52<01:49,  2.74it/s] 37%|███▋      | 172/471 [00:52<01:45,  2.84it/s] 37%|███▋      | 173/471 [00:53<01:44,  2.84it/s] 37%|███▋      | 174/471 [00:53<01:49,  2.72it/s] 37%|███▋      | 175/471 [00:53<01:45,  2.81it/s] 37%|███▋      | 176/471 [00:54<01:42,  2.87it/s] 38%|███▊      | 177/471 [00:54<01:48,  2.70it/s] 38%|███▊      | 178/471 [00:54<01:45,  2.79it/s] 38%|███▊      | 179/471 [00:55<01:40,  2.90it/s] 38%|███▊      | 180/471 [00:55<01:46,  2.73it/s] 38%|███▊      | 181/471 [00:55<01:45,  2.76it/s] 39%|███▊      | 182/471 [00:56<01:40,  2.89it/s] 39%|███▉      | 183/471 [00:56<01:38,  2.94it/s] 39%|███▉      | 184/471 [00:56<01:44,  2.76it/s] 39%|███▉      | 185/471 [00:57<01:41,  2.83it/s] 39%|███▉      | 186/471 [00:57<01:37,  2.93it/s] 40%|███▉      | 187/471 [00:58<01:43,  2.75it/s] 40%|███▉      | 188/471 [00:58<01:42,  2.76it/s] 40%|████      | 189/471 [00:58<01:37,  2.91it/s] 40%|████      | 190/471 [00:59<01:40,  2.79it/s] 41%|████      | 191/471 [00:59<01:42,  2.73it/s] 41%|████      | 192/471 [00:59<01:39,  2.82it/s] 41%|████      | 193/471 [01:00<01:38,  2.83it/s] 41%|████      | 194/471 [01:00<01:42,  2.71it/s] 41%|████▏     | 195/471 [01:00<01:38,  2.80it/s] 42%|████▏     | 196/471 [01:01<01:34,  2.90it/s] 42%|████▏     | 197/471 [01:01<01:40,  2.73it/s] 42%|████▏     | 198/471 [01:01<01:37,  2.80it/s] 42%|████▏     | 199/471 [01:02<01:32,  2.94it/s] 42%|████▏     | 200/471 [01:02<01:38,  2.76it/s] 43%|████▎     | 201/471 [01:03<01:37,  2.77it/s] 43%|████▎     | 202/471 [01:03<01:33,  2.87it/s] 43%|████▎     | 203/471 [01:03<01:34,  2.82it/s] 43%|████▎     | 204/471 [01:04<01:37,  2.73it/s] 44%|████▎     | 205/471 [01:04<01:34,  2.83it/s] 44%|████▎     | 206/471 [01:04<01:27,  3.01it/s] 44%|████▍     | 207/471 [01:05<01:34,  2.80it/s] 44%|████▍     | 208/471 [01:05<01:34,  2.79it/s] 44%|████▍     | 209/471 [01:05<01:30,  2.88it/s] 45%|████▍     | 210/471 [01:06<01:31,  2.86it/s] 45%|████▍     | 211/471 [01:06<01:34,  2.75it/s] 45%|████▌     | 212/471 [01:06<01:31,  2.84it/s] 45%|████▌     | 213/471 [01:07<01:29,  2.88it/s] 45%|████▌     | 214/471 [01:07<01:34,  2.72it/s] 46%|████▌     | 215/471 [01:07<01:31,  2.81it/s] 46%|████▌     | 216/471 [01:08<01:25,  2.97it/s] 46%|████▌     | 217/471 [01:08<01:31,  2.77it/s] 46%|████▋     | 218/471 [01:09<01:31,  2.77it/s] 46%|████▋     | 219/471 [01:09<01:27,  2.89it/s] 47%|████▋     | 220/471 [01:09<01:29,  2.80it/s] 47%|████▋     | 221/471 [01:10<01:31,  2.74it/s] 47%|████▋     | 222/471 [01:10<01:27,  2.83it/s] 47%|████▋     | 223/471 [01:10<01:27,  2.84it/s] 48%|████▊     | 224/471 [01:11<01:30,  2.72it/s] 48%|████▊     | 225/471 [01:11<01:27,  2.80it/s] 48%|████▊     | 226/471 [01:11<01:25,  2.86it/s] 48%|████▊     | 227/471 [01:12<01:30,  2.70it/s] 48%|████▊     | 228/471 [01:12<01:27,  2.79it/s] 49%|████▊     | 229/471 [01:12<01:22,  2.92it/s] 49%|████▉     | 230/471 [01:13<01:23,  2.89it/s] 49%|████▉     | 231/471 [01:13<01:26,  2.77it/s] 49%|████▉     | 232/471 [01:13<01:23,  2.85it/s] 49%|████▉     | 233/471 [01:14<01:21,  2.93it/s] 50%|████▉     | 234/471 [01:14<01:26,  2.74it/s] 50%|████▉     | 235/471 [01:15<01:24,  2.81it/s] 50%|█████     | 236/471 [01:15<01:20,  2.93it/s] 50%|█████     | 237/471 [01:15<01:25,  2.75it/s] 51%|█████     | 238/471 [01:16<01:24,  2.75it/s] 51%|█████     | 239/471 [01:16<01:21,  2.85it/s] 51%|█████     | 240/471 [01:16<01:22,  2.80it/s] 51%|█████     | 241/471 [01:17<01:24,  2.72it/s] 51%|█████▏    | 242/471 [01:17<01:21,  2.82it/s] 52%|█████▏    | 243/471 [01:17<01:20,  2.84it/s] 52%|█████▏    | 244/471 [01:18<01:23,  2.70it/s] 52%|█████▏    | 245/471 [01:18<01:20,  2.81it/s] 52%|█████▏    | 246/471 [01:18<01:17,  2.91it/s] 52%|█████▏    | 247/471 [01:19<01:21,  2.75it/s] 53%|█████▎    | 248/471 [01:19<01:19,  2.80it/s] 53%|█████▎    | 249/471 [01:19<01:15,  2.93it/s] 53%|█████▎    | 250/471 [01:20<01:19,  2.76it/s] 53%|█████▎    | 251/471 [01:20<01:19,  2.75it/s] 54%|█████▎    | 252/471 [01:21<01:17,  2.84it/s] 54%|█████▎    | 253/471 [01:21<01:08,  3.18it/s] 54%|█████▍    | 254/471 [01:21<01:00,  3.61it/s] 54%|█████▍    | 255/471 [01:21<00:54,  3.96it/s] 54%|█████▍    | 256/471 [01:21<00:50,  4.27it/s] 55%|█████▍    | 257/471 [01:22<00:47,  4.54it/s] 55%|█████▍    | 258/471 [01:22<00:45,  4.73it/s] 55%|█████▍    | 259/471 [01:22<00:44,  4.81it/s] 55%|█████▌    | 260/471 [01:22<00:42,  4.93it/s] 55%|█████▌    | 261/471 [01:22<00:42,  4.99it/s] 56%|█████▌    | 262/471 [01:23<00:41,  5.05it/s] 56%|█████▌    | 263/471 [01:23<00:40,  5.08it/s] 56%|█████▌    | 264/471 [01:23<00:40,  5.11it/s] 56%|█████▋    | 265/471 [01:23<00:48,  4.25it/s] 56%|█████▋    | 266/471 [01:24<00:57,  3.55it/s] 57%|█████▋    | 267/471 [01:24<01:04,  3.16it/s] 57%|█████▋    | 268/471 [01:24<01:08,  2.97it/s] 57%|█████▋    | 269/471 [01:25<01:10,  2.85it/s] 57%|█████▋    | 270/471 [01:25<01:12,  2.77it/s] 58%|█████▊    | 271/471 [01:26<01:14,  2.70it/s] 58%|█████▊    | 272/471 [01:26<01:14,  2.67it/s] 58%|█████▊    | 273/471 [01:26<01:14,  2.65it/s] 58%|█████▊    | 274/471 [01:27<01:15,  2.62it/s] 58%|█████▊    | 275/471 [01:27<01:14,  2.61it/s] 59%|█████▊    | 276/471 [01:28<01:14,  2.61it/s] 59%|█████▉    | 277/471 [01:28<01:15,  2.58it/s] 59%|█████▉    | 278/471 [01:28<01:14,  2.59it/s] 59%|█████▉    | 279/471 [01:29<01:13,  2.60it/s] 59%|█████▉    | 280/471 [01:29<01:13,  2.60it/s] 60%|█████▉    | 281/471 [01:29<01:13,  2.58it/s] 60%|█████▉    | 282/471 [01:30<01:13,  2.58it/s] 60%|██████    | 283/471 [01:30<01:12,  2.58it/s] 60%|██████    | 284/471 [01:31<01:13,  2.56it/s] 61%|██████    | 285/471 [01:31<01:12,  2.57it/s] 61%|██████    | 286/471 [01:31<01:11,  2.57it/s] 61%|██████    | 287/471 [01:32<01:11,  2.57it/s] 61%|██████    | 288/471 [01:32<01:11,  2.55it/s] 61%|██████▏   | 289/471 [01:33<01:11,  2.56it/s] 62%|██████▏   | 290/471 [01:33<01:10,  2.57it/s] 62%|██████▏   | 291/471 [01:33<01:10,  2.55it/s] 62%|██████▏   | 292/471 [01:34<01:09,  2.57it/s] 62%|██████▏   | 293/471 [01:34<01:09,  2.58it/s] 62%|██████▏   | 294/471 [01:35<01:08,  2.58it/s] 63%|██████▎   | 295/471 [01:35<01:08,  2.55it/s] 63%|██████▎   | 296/471 [01:35<01:08,  2.56it/s] 63%|██████▎   | 297/471 [01:36<01:07,  2.57it/s] 63%|██████▎   | 298/471 [01:36<01:07,  2.55it/s] 63%|██████▎   | 299/471 [01:37<01:07,  2.56it/s] 64%|██████▎   | 300/471 [01:37<01:06,  2.56it/s] 64%|██████▍   | 301/471 [01:37<01:05,  2.58it/s] 64%|██████▍   | 302/471 [01:38<01:06,  2.56it/s] 64%|██████▍   | 303/471 [01:38<01:05,  2.56it/s] 65%|██████▍   | 304/471 [01:38<01:05,  2.57it/s] 65%|██████▍   | 305/471 [01:39<01:05,  2.55it/s] 65%|██████▍   | 306/471 [01:39<01:04,  2.55it/s] 65%|██████▌   | 307/471 [01:40<01:04,  2.56it/s] 65%|██████▌   | 308/471 [01:40<01:03,  2.57it/s] 66%|██████▌   | 309/471 [01:40<01:03,  2.55it/s] 66%|██████▌   | 310/471 [01:41<01:02,  2.56it/s] 66%|██████▌   | 311/471 [01:41<01:01,  2.58it/s] 66%|██████▌   | 312/471 [01:42<01:01,  2.57it/s] 66%|██████▋   | 313/471 [01:42<01:01,  2.58it/s] 67%|██████▋   | 314/471 [01:42<01:01,  2.57it/s] 67%|██████▋   | 315/471 [01:43<01:00,  2.58it/s] 67%|██████▋   | 316/471 [01:43<01:00,  2.56it/s] 67%|██████▋   | 317/471 [01:44<00:59,  2.57it/s] 68%|██████▊   | 318/471 [01:44<00:59,  2.57it/s] 68%|██████▊   | 319/471 [01:44<00:59,  2.56it/s] 68%|██████▊   | 320/471 [01:45<00:58,  2.57it/s] 68%|██████▊   | 321/471 [01:45<00:58,  2.56it/s] 68%|██████▊   | 322/471 [01:45<00:58,  2.56it/s] 69%|██████▊   | 323/471 [01:46<00:58,  2.55it/s] 69%|██████▉   | 324/471 [01:46<00:57,  2.55it/s] 69%|██████▉   | 325/471 [01:47<00:56,  2.57it/s] 69%|██████▉   | 326/471 [01:47<00:56,  2.55it/s] 69%|██████▉   | 327/471 [01:47<00:56,  2.57it/s] 70%|██████▉   | 328/471 [01:48<00:55,  2.57it/s] 70%|██████▉   | 329/471 [01:48<00:55,  2.55it/s] 70%|███████   | 330/471 [01:49<00:54,  2.59it/s] 70%|███████   | 331/471 [01:49<00:54,  2.59it/s] 70%|███████   | 332/471 [01:49<00:53,  2.58it/s] 71%|███████   | 333/471 [01:50<00:53,  2.56it/s] 71%|███████   | 334/471 [01:50<00:53,  2.57it/s] 71%|███████   | 335/471 [01:51<00:52,  2.58it/s] 71%|███████▏  | 336/471 [01:51<00:52,  2.56it/s] 72%|███████▏  | 337/471 [01:51<00:52,  2.57it/s] 72%|███████▏  | 338/471 [01:52<00:51,  2.57it/s] 72%|███████▏  | 339/471 [01:52<00:51,  2.57it/s] 72%|███████▏  | 340/471 [01:52<00:51,  2.56it/s] 72%|███████▏  | 341/471 [01:53<00:50,  2.57it/s] 73%|███████▎  | 342/471 [01:53<00:50,  2.58it/s] 73%|███████▎  | 343/471 [01:54<00:50,  2.55it/s] 73%|███████▎  | 344/471 [01:54<00:49,  2.56it/s] 73%|███████▎  | 345/471 [01:54<00:48,  2.57it/s] 73%|███████▎  | 346/471 [01:55<00:48,  2.57it/s] 74%|███████▎  | 347/471 [01:55<00:48,  2.57it/s] 74%|███████▍  | 348/471 [01:56<00:47,  2.58it/s] 74%|███████▍  | 349/471 [01:56<00:47,  2.58it/s] 74%|███████▍  | 350/471 [01:56<00:47,  2.56it/s] 75%|███████▍  | 351/471 [01:57<00:46,  2.57it/s] 75%|███████▍  | 352/471 [01:57<00:46,  2.57it/s] 75%|███████▍  | 353/471 [01:58<00:46,  2.55it/s] 75%|███████▌  | 354/471 [01:58<00:45,  2.56it/s] 75%|███████▌  | 355/471 [01:58<00:45,  2.56it/s] 76%|███████▌  | 356/471 [01:59<00:44,  2.56it/s] 76%|███████▌  | 357/471 [01:59<00:44,  2.55it/s] 76%|███████▌  | 358/471 [02:00<00:44,  2.56it/s] 76%|███████▌  | 359/471 [02:00<00:43,  2.57it/s] 76%|███████▋  | 360/471 [02:00<00:43,  2.55it/s] 77%|███████▋  | 361/471 [02:01<00:42,  2.56it/s] 77%|███████▋  | 362/471 [02:01<00:42,  2.57it/s] 77%|███████▋  | 363/471 [02:01<00:42,  2.56it/s] 77%|███████▋  | 364/471 [02:02<00:42,  2.54it/s] 77%|███████▋  | 365/471 [02:02<00:41,  2.54it/s] 78%|███████▊  | 366/471 [02:03<00:41,  2.56it/s] 78%|███████▊  | 367/471 [02:03<00:40,  2.55it/s] 78%|███████▊  | 368/471 [02:03<00:40,  2.57it/s] 78%|███████▊  | 369/471 [02:04<00:39,  2.58it/s] 79%|███████▊  | 370/471 [02:04<00:39,  2.57it/s] 79%|███████▉  | 371/471 [02:05<00:38,  2.57it/s] 79%|███████▉  | 372/471 [02:05<00:38,  2.60it/s] 79%|███████▉  | 373/471 [02:05<00:37,  2.59it/s] 79%|███████▉  | 374/471 [02:06<00:37,  2.57it/s] 80%|███████▉  | 375/471 [02:06<00:37,  2.57it/s] 80%|███████▉  | 376/471 [02:07<00:37,  2.57it/s] 80%|████████  | 377/471 [02:07<00:36,  2.56it/s] 80%|████████  | 378/471 [02:07<00:36,  2.57it/s] 80%|████████  | 379/471 [02:08<00:35,  2.57it/s] 81%|████████  | 380/471 [02:08<00:35,  2.58it/s] 81%|████████  | 381/471 [02:08<00:35,  2.56it/s] 81%|████████  | 382/471 [02:09<00:34,  2.57it/s] 81%|████████▏ | 383/471 [02:09<00:34,  2.57it/s] 82%|████████▏ | 384/471 [02:10<00:34,  2.54it/s] 82%|████████▏ | 385/471 [02:10<00:33,  2.55it/s] 82%|████████▏ | 386/471 [02:10<00:33,  2.56it/s] 82%|████████▏ | 387/471 [02:11<00:32,  2.57it/s] 82%|████████▏ | 388/471 [02:11<00:32,  2.56it/s] 83%|████████▎ | 389/471 [02:12<00:31,  2.57it/s] 83%|████████▎ | 390/471 [02:12<00:31,  2.58it/s] 83%|████████▎ | 391/471 [02:12<00:31,  2.55it/s] 83%|████████▎ | 392/471 [02:13<00:30,  2.55it/s] 83%|████████▎ | 393/471 [02:13<00:30,  2.57it/s] 84%|████████▎ | 394/471 [02:14<00:29,  2.57it/s] 84%|████████▍ | 395/471 [02:14<00:29,  2.56it/s] 84%|████████▍ | 396/471 [02:14<00:29,  2.56it/s] 84%|████████▍ | 397/471 [02:15<00:28,  2.57it/s] 85%|████████▍ | 398/471 [02:15<00:28,  2.56it/s] 85%|████████▍ | 399/471 [02:15<00:28,  2.56it/s] 85%|████████▍ | 400/471 [02:16<00:27,  2.57it/s] 85%|████████▌ | 401/471 [02:16<00:27,  2.56it/s] 85%|████████▌ | 402/471 [02:17<00:26,  2.57it/s] 86%|████████▌ | 403/471 [02:17<00:26,  2.58it/s] 86%|████████▌ | 404/471 [02:17<00:25,  2.58it/s] 86%|████████▌ | 405/471 [02:18<00:25,  2.56it/s] 86%|████████▌ | 406/471 [02:18<00:25,  2.56it/s] 86%|████████▋ | 407/471 [02:19<00:24,  2.57it/s] 87%|████████▋ | 408/471 [02:19<00:24,  2.54it/s] 87%|████████▋ | 409/471 [02:19<00:24,  2.54it/s] 87%|████████▋ | 410/471 [02:20<00:23,  2.55it/s] 87%|████████▋ | 411/471 [02:20<00:23,  2.55it/s] 87%|████████▋ | 412/471 [02:21<00:23,  2.53it/s] 88%|████████▊ | 413/471 [02:21<00:22,  2.54it/s] 88%|████████▊ | 414/471 [02:21<00:22,  2.55it/s] 88%|████████▊ | 415/471 [02:22<00:22,  2.54it/s] 88%|████████▊ | 416/471 [02:22<00:21,  2.54it/s] 89%|████████▊ | 417/471 [02:23<00:21,  2.55it/s] 89%|████████▊ | 418/471 [02:23<00:20,  2.56it/s] 89%|████████▉ | 419/471 [02:23<00:20,  2.55it/s] 89%|████████▉ | 420/471 [02:24<00:19,  2.56it/s] 89%|████████▉ | 421/471 [02:24<00:19,  2.56it/s] 90%|████████▉ | 422/471 [02:24<00:19,  2.55it/s] 90%|████████▉ | 423/471 [02:25<00:18,  2.56it/s] 90%|█████████ | 424/471 [02:25<00:18,  2.56it/s] 90%|█████████ | 425/471 [02:26<00:17,  2.56it/s] 90%|█████████ | 426/471 [02:26<00:17,  2.54it/s] 91%|█████████ | 427/471 [02:26<00:17,  2.55it/s] 91%|█████████ | 428/471 [02:27<00:16,  2.56it/s] 91%|█████████ | 429/471 [02:27<00:16,  2.54it/s] 91%|█████████▏| 430/471 [02:28<00:16,  2.56it/s] 92%|█████████▏| 431/471 [02:28<00:15,  2.57it/s] 92%|█████████▏| 432/471 [02:28<00:15,  2.59it/s] 92%|█████████▏| 433/471 [02:29<00:14,  2.57it/s] 92%|█████████▏| 434/471 [02:29<00:14,  2.57it/s] 92%|█████████▏| 435/471 [02:30<00:14,  2.57it/s] 93%|█████████▎| 436/471 [02:30<00:13,  2.56it/s] 93%|█████████▎| 437/471 [02:30<00:13,  2.56it/s] 93%|█████████▎| 438/471 [02:31<00:12,  2.56it/s] 93%|█████████▎| 439/471 [02:31<00:12,  2.56it/s] 93%|█████████▎| 440/471 [02:32<00:12,  2.57it/s] 94%|█████████▎| 441/471 [02:32<00:11,  2.56it/s] 94%|█████████▍| 442/471 [02:32<00:11,  2.56it/s] 94%|█████████▍| 443/471 [02:33<00:10,  2.55it/s] 94%|█████████▍| 444/471 [02:33<00:10,  2.55it/s] 94%|█████████▍| 445/471 [02:33<00:10,  2.56it/s] 95%|█████████▍| 446/471 [02:34<00:09,  2.54it/s] 95%|█████████▍| 447/471 [02:34<00:09,  2.55it/s] 95%|█████████▌| 448/471 [02:35<00:08,  2.56it/s] 95%|█████████▌| 449/471 [02:35<00:08,  2.56it/s] 96%|█████████▌| 450/471 [02:35<00:08,  2.54it/s] 96%|█████████▌| 451/471 [02:36<00:07,  2.55it/s] 96%|█████████▌| 452/471 [02:36<00:07,  2.57it/s] 96%|█████████▌| 453/471 [02:37<00:07,  2.53it/s] 96%|█████████▋| 454/471 [02:37<00:06,  2.52it/s] 97%|█████████▋| 455/471 [02:37<00:06,  2.54it/s] 97%|█████████▋| 456/471 [02:38<00:05,  2.54it/s] 97%|█████████▋| 457/471 [02:38<00:05,  2.53it/s] 97%|█████████▋| 458/471 [02:39<00:05,  2.55it/s] 97%|█████████▋| 459/471 [02:39<00:04,  2.55it/s] 98%|█████████▊| 460/471 [02:39<00:04,  2.54it/s] 98%|█████████▊| 461/471 [02:40<00:03,  2.54it/s] 98%|█████████▊| 462/471 [02:40<00:03,  2.55it/s] 98%|█████████▊| 463/471 [02:41<00:03,  2.56it/s] 99%|█████████▊| 464/471 [02:41<00:02,  2.55it/s] 99%|█████████▊| 465/471 [02:41<00:02,  2.57it/s] 99%|█████████▉| 466/471 [02:42<00:01,  2.57it/s] 99%|█████████▉| 467/471 [02:42<00:01,  2.54it/s] 99%|█████████▉| 468/471 [02:43<00:01,  2.55it/s]100%|█████████▉| 469/471 [02:43<00:00,  2.57it/s]100%|█████████▉| 470/471 [02:43<00:00,  2.57it/s]100%|██████████| 471/471 [02:44<00:00,  2.74it/s]100%|██████████| 471/471 [02:44<00:00,  2.87it/s]
{'eval_loss': 3.2054994106292725, 'eval_model_preparation_time': 0.0052, 'eval_acc': 0.29686670207116306, 'eval_runtime': 164.4425, 'eval_samples_per_second': 45.803, 'eval_steps_per_second': 2.864}
ROUND:12
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]                                              {'loss': 2.4425, 'grad_norm': 10.674217224121094, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 2.0003, 'grad_norm': 11.66405963897705, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:02<00:27,  1.35it/s]                                              {'loss': 2.1144, 'grad_norm': 14.174759864807129, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.35it/s] 10%|█         | 4/40 [00:02<00:26,  1.36it/s]                                              {'loss': 2.1857, 'grad_norm': 18.89584732055664, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.36it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 1.2627, 'grad_norm': 20.51463508605957, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.8601, 'grad_norm': 28.765697479248047, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 2.2714, 'grad_norm': 19.66883659362793, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 0.407, 'grad_norm': 27.14104461669922, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.34it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s]                                              {'loss': 0.6799, 'grad_norm': 14.415109634399414, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s]                                               {'loss': 1.0513, 'grad_norm': 8.60888671875, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s]                                               {'loss': 2.062, 'grad_norm': 17.446882247924805, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.52it/s] 30%|███       | 12/40 [00:08<00:19,  1.46it/s]                                               {'loss': 0.1071, 'grad_norm': 2.752781391143799, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.46it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s]                                               {'loss': 1.0978, 'grad_norm': 9.388392448425293, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:18,  1.43it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s]                                               {'loss': 1.5731, 'grad_norm': 15.122725486755371, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 1.3321, 'grad_norm': 10.228059768676758, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 2.1811, 'grad_norm': 68.74504089355469, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.38it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s]                                               {'loss': 0.5076, 'grad_norm': 4.4294962882995605, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.71it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.61it/s]                                               {'loss': 0.5469, 'grad_norm': 4.35294246673584, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.61it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.54it/s]                                               {'loss': 1.0742, 'grad_norm': 7.933480739593506, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.54it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s]                                               {'loss': 0.2633, 'grad_norm': 4.2397613525390625, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.6771, 'grad_norm': 8.258373260498047, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 1.2822, 'grad_norm': 8.806007385253906, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.2828, 'grad_norm': 7.180505752563477, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.0132, 'grad_norm': 0.9078086614608765, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.39it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.72it/s]                                               {'loss': 0.0279, 'grad_norm': 0.6464662551879883, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.72it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s]                                               {'loss': 0.2518, 'grad_norm': 5.890488147735596, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.61it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s]                                               {'loss': 0.4109, 'grad_norm': 6.737286567687988, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s] 70%|███████   | 28/40 [00:18<00:08,  1.48it/s]                                               {'loss': 0.5968, 'grad_norm': 8.831097602844238, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.48it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s]                                               {'loss': 0.5365, 'grad_norm': 3.2327423095703125, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.1828, 'grad_norm': 2.881106376647949, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.41it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.4623, 'grad_norm': 2.46934175491333, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.0292, 'grad_norm': 1.6336872577667236, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:21<00:04,  1.73it/s]                                               {'loss': 0.286, 'grad_norm': 1.3351083993911743, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:04,  1.73it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s]                                               {'loss': 0.139, 'grad_norm': 1.6914160251617432, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.61it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s]                                               {'loss': 0.2135, 'grad_norm': 4.862783432006836, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s]                                               {'loss': 0.0381, 'grad_norm': 1.0777587890625, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s]                                               {'loss': 0.41, 'grad_norm': 0.4481787085533142, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.40it/s]                                               {'loss': 0.0976, 'grad_norm': 2.8230350017547607, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.40it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.4074, 'grad_norm': 3.738149881362915, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.39it/s]                                               {'loss': 0.0001, 'grad_norm': 0.009423356503248215, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]                                               {'train_runtime': 26.7797, 'train_samples_per_second': 21.098, 'train_steps_per_second': 1.494, 'train_loss': 0.8341422047371452, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.39it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
CLIENT:84
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]                                              {'loss': 2.1174, 'grad_norm': 7.29079008102417, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 2.2568, 'grad_norm': 8.759197235107422, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:02<00:27,  1.33it/s]                                              {'loss': 1.4975, 'grad_norm': 12.201393127441406, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.33it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 1.5686, 'grad_norm': 14.346922874450684, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s]                                              {'loss': 1.5899, 'grad_norm': 14.632741928100586, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s]                                              {'loss': 1.261, 'grad_norm': 11.271190643310547, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 1.7094, 'grad_norm': 13.442831993103027, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s] 20%|██        | 8/40 [00:06<00:24,  1.29it/s]                                              {'loss': 5.7939, 'grad_norm': 77.7587661743164, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:24,  1.29it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.30it/s]                                              {'loss': 0.736, 'grad_norm': 12.216585159301758, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.30it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s]                                               {'loss': 0.5669, 'grad_norm': 9.130859375, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s] 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s]                                               {'loss': 0.9234, 'grad_norm': 9.667635917663574, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s] 30%|███       | 12/40 [00:09<00:21,  1.33it/s]                                               {'loss': 0.6924, 'grad_norm': 5.785431861877441, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.33it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s]                                               {'loss': 1.1203, 'grad_norm': 7.5747222900390625, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.33it/s]                                               {'loss': 0.2937, 'grad_norm': 4.431458473205566, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.33it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.6162, 'grad_norm': 5.074451923370361, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.03, 'grad_norm': 1.6125599145889282, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.33it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s]                                               {'loss': 0.3343, 'grad_norm': 2.1820907592773438, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.57it/s]                                               {'loss': 0.5277, 'grad_norm': 3.7104172706604004, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s]                                               {'loss': 0.1457, 'grad_norm': 2.773843288421631, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.7355, 'grad_norm': 2.8383021354675293, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s]                                               {'loss': 0.2044, 'grad_norm': 4.418139934539795, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.2996, 'grad_norm': 6.691320419311523, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 0.1814, 'grad_norm': 3.2464804649353027, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 0.0055, 'grad_norm': 0.3528646230697632, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s]                                               {'loss': 0.0652, 'grad_norm': 2.1996026039123535, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s]                                               {'loss': 0.1226, 'grad_norm': 2.336517095565796, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.52it/s]                                               {'loss': 0.5845, 'grad_norm': 3.475837230682373, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.52it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.2735, 'grad_norm': 1.3059115409851074, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.0819, 'grad_norm': 1.78876793384552, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s]                                               {'loss': 0.4072, 'grad_norm': 3.675807476043701, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.38it/s]                                               {'loss': 0.177, 'grad_norm': 4.24805212020874, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.38it/s]                                               {'loss': 0.0271, 'grad_norm': 1.8487879037857056, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.38it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s]                                               {'loss': 0.0204, 'grad_norm': 0.7474680542945862, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s]                                               {'loss': 0.0436, 'grad_norm': 2.5613279342651367, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s]                                               {'loss': 0.2095, 'grad_norm': 1.9509313106536865, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.46it/s]                                               {'loss': 0.1294, 'grad_norm': 4.429158687591553, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s]                                               {'loss': 0.3702, 'grad_norm': 1.2012873888015747, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s]                                               {'loss': 0.2189, 'grad_norm': 0.46936240792274475, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.38it/s]                                               {'loss': 0.0182, 'grad_norm': 0.5870333313941956, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.38it/s]                                               {'loss': 3.1205, 'grad_norm': 1.7496241331100464, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.38it/s]                                               {'train_runtime': 27.6553, 'train_samples_per_second': 20.43, 'train_steps_per_second': 1.446, 'train_loss': 0.7769293133402243, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.38it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:04,  1.67s/it]                                              {'loss': 2.8727, 'grad_norm': 8.6560640335083, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:04,  1.67s/it]  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]                                              {'loss': 1.6875, 'grad_norm': 9.798897743225098, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.13s/it]  8%|▊         | 3/40 [00:03<00:35,  1.04it/s]                                              {'loss': 1.7247, 'grad_norm': 9.828195571899414, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:35,  1.04it/s] 10%|█         | 4/40 [00:03<00:31,  1.13it/s]                                              {'loss': 0.9799, 'grad_norm': 11.609844207763672, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:31,  1.13it/s] 12%|█▎        | 5/40 [00:04<00:29,  1.19it/s]                                              {'loss': 1.0861, 'grad_norm': 15.075804710388184, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:29,  1.19it/s] 15%|█▌        | 6/40 [00:05<00:27,  1.24it/s]                                              {'loss': 2.3623, 'grad_norm': 29.916547775268555, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:27,  1.24it/s] 18%|█▊        | 7/40 [00:06<00:26,  1.26it/s]                                              {'loss': 2.0211, 'grad_norm': 15.471029281616211, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:06<00:26,  1.26it/s]                                              {'loss': 0.4322, 'grad_norm': 32.82009506225586, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:25,  1.26it/s] 22%|██▎       | 9/40 [00:07<00:19,  1.63it/s]                                              {'loss': 0.9982, 'grad_norm': 12.627375602722168, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:07<00:19,  1.63it/s] 25%|██▌       | 10/40 [00:07<00:19,  1.54it/s]                                               {'loss': 1.5664, 'grad_norm': 17.1259822845459, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:19,  1.54it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.47it/s]                                               {'loss': 1.4712, 'grad_norm': 14.051321029663086, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.47it/s] 30%|███       | 12/40 [00:09<00:19,  1.42it/s]                                               {'loss': 0.8195, 'grad_norm': 9.300102233886719, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:19,  1.42it/s] 32%|███▎      | 13/40 [00:10<00:19,  1.41it/s]                                               {'loss': 1.435, 'grad_norm': 11.098800659179688, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:10<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.7252, 'grad_norm': 6.526065349578857, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:18,  1.38it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.36it/s]                                               {'loss': 0.3462, 'grad_norm': 7.873684406280518, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.36it/s]                                               {'loss': 0.2207, 'grad_norm': 12.403003692626953, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.36it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.68it/s]                                               {'loss': 0.5451, 'grad_norm': 4.942049026489258, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.68it/s] 45%|████▌     | 18/40 [00:13<00:13,  1.57it/s]                                               {'loss': 0.2823, 'grad_norm': 3.1867525577545166, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:13,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.50it/s]                                               {'loss': 0.779, 'grad_norm': 3.8187737464904785, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.50it/s] 50%|█████     | 20/40 [00:14<00:13,  1.44it/s]                                               {'loss': 0.4796, 'grad_norm': 5.925521373748779, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s]                                               {'loss': 0.1719, 'grad_norm': 3.5517702102661133, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s]                                               {'loss': 0.485, 'grad_norm': 9.444486618041992, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:17<00:12,  1.36it/s]                                               {'loss': 0.6999, 'grad_norm': 9.708706855773926, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:17<00:12,  1.36it/s]                                               {'loss': 0.0292, 'grad_norm': 2.220860719680786, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:17<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s]                                               {'loss': 0.2609, 'grad_norm': 5.889121055603027, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.57it/s]                                               {'loss': 0.6906, 'grad_norm': 8.729631423950195, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.57it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s]                                               {'loss': 0.2991, 'grad_norm': 4.06217622756958, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s] 70%|███████   | 28/40 [00:20<00:08,  1.44it/s]                                               {'loss': 0.4349, 'grad_norm': 6.820756912231445, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:20<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.0899, 'grad_norm': 2.0375728607177734, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s]                                               {'loss': 0.2577, 'grad_norm': 2.5270259380340576, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.1416, 'grad_norm': 2.8028299808502197, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.0638, 'grad_norm': 4.9047675132751465, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.37it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s]                                               {'loss': 0.4094, 'grad_norm': 1.0613349676132202, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s]                                               {'loss': 0.0967, 'grad_norm': 3.705575942993164, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s]                                               {'loss': 0.1435, 'grad_norm': 0.5335253477096558, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.46it/s]                                               {'loss': 0.1905, 'grad_norm': 5.501952171325684, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.41it/s]                                               {'loss': 0.0877, 'grad_norm': 2.2208962440490723, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.41it/s] 95%|█████████▌| 38/40 [00:27<00:01,  1.39it/s]                                               {'loss': 0.2841, 'grad_norm': 3.0872011184692383, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:27<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.36it/s]                                               {'loss': 0.3481, 'grad_norm': 4.497158050537109, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.36it/s]                                               {'loss': 0.0156, 'grad_norm': 0.8998981714248657, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.36it/s]                                               {'train_runtime': 28.1113, 'train_samples_per_second': 20.099, 'train_steps_per_second': 1.423, 'train_loss': 0.7008691195864231, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.36it/s]100%|██████████| 40/40 [00:28<00:00,  1.42it/s]
CLIENT:81
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]                                              {'loss': 2.158, 'grad_norm': 8.238277435302734, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]                                              {'loss': 0.9268, 'grad_norm': 8.306300163269043, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]  8%|▊         | 3/40 [00:02<00:27,  1.33it/s]                                              {'loss': 1.8283, 'grad_norm': 10.36950969696045, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.33it/s] 10%|█         | 4/40 [00:03<00:27,  1.32it/s]                                              {'loss': 1.769, 'grad_norm': 12.727448463439941, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.32it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s]                                              {'loss': 1.0073, 'grad_norm': 10.627645492553711, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s]                                              {'loss': 1.2736, 'grad_norm': 12.389910697937012, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.32it/s]                                              {'loss': 1.9281, 'grad_norm': 15.942487716674805, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.32it/s] 20%|██        | 8/40 [00:06<00:24,  1.31it/s]                                              {'loss': 0.1383, 'grad_norm': 9.132024765014648, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:24,  1.31it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s]                                              {'loss': 0.4613, 'grad_norm': 7.272812366485596, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s]                                               {'loss': 0.5036, 'grad_norm': 12.357222557067871, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s] 28%|██▊       | 11/40 [00:08<00:21,  1.32it/s]                                               {'loss': 0.5444, 'grad_norm': 10.104269981384277, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:21,  1.32it/s] 30%|███       | 12/40 [00:09<00:21,  1.32it/s]                                               {'loss': 1.1498, 'grad_norm': 2.605266571044922, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.32it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.32it/s]                                               {'loss': 0.4476, 'grad_norm': 7.992527484893799, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.32it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s]                                               {'loss': 0.4257, 'grad_norm': 7.753041744232178, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.32it/s]                                               {'loss': 0.2907, 'grad_norm': 3.4632019996643066, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.32it/s]                                               {'loss': 0.0329, 'grad_norm': 4.972703456878662, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.32it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.65it/s]                                               {'loss': 0.3378, 'grad_norm': 5.837924480438232, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.65it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s]                                               {'loss': 0.15, 'grad_norm': 3.3404510021209717, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s]                                               {'loss': 0.0696, 'grad_norm': 2.403726816177368, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s] 50%|█████     | 20/40 [00:14<00:13,  1.44it/s]                                               {'loss': 0.0456, 'grad_norm': 1.429118037223816, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s]                                               {'loss': 0.1534, 'grad_norm': 4.551484107971191, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s]                                               {'loss': 0.6694, 'grad_norm': 5.019440650939941, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.7463, 'grad_norm': 6.066819667816162, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.0036, 'grad_norm': 0.23294730484485626, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s]                                               {'loss': 0.0169, 'grad_norm': 0.4622736871242523, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.57it/s]                                               {'loss': 0.0409, 'grad_norm': 1.0743738412857056, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.57it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s]                                               {'loss': 0.1417, 'grad_norm': 3.4213666915893555, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s]                                               {'loss': 0.1104, 'grad_norm': 3.8646950721740723, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.5696, 'grad_norm': 3.234732151031494, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s]                                               {'loss': 0.5559, 'grad_norm': 1.5451329946517944, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.0652, 'grad_norm': 2.367380380630493, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.0137, 'grad_norm': 0.6903828382492065, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.37it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.68it/s]                                               {'loss': 0.0298, 'grad_norm': 2.1901679039001465, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.68it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s]                                               {'loss': 0.0246, 'grad_norm': 0.5319112539291382, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s]                                               {'loss': 0.0389, 'grad_norm': 1.6279098987579346, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s]                                               {'loss': 0.5207, 'grad_norm': 0.4088353216648102, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.42it/s]                                               {'loss': 0.5392, 'grad_norm': 0.7299131155014038, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s]                                               {'loss': 0.0371, 'grad_norm': 1.3852866888046265, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0852, 'grad_norm': 7.900970458984375, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]100%|██████████| 40/40 [00:27<00:00,  1.78it/s]                                               {'loss': 0.0144, 'grad_norm': 0.7368288040161133, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.78it/s]                                               {'train_runtime': 28.0111, 'train_samples_per_second': 20.171, 'train_steps_per_second': 1.428, 'train_loss': 0.4966257324500475, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.78it/s]100%|██████████| 40/40 [00:28<00:00,  1.43it/s]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:41,  1.06s/it]                                              {'loss': 3.3565, 'grad_norm': 10.844499588012695, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:41,  1.06s/it]  5%|▌         | 2/40 [00:01<00:33,  1.14it/s]                                              {'loss': 1.7827, 'grad_norm': 8.498268127441406, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:33,  1.14it/s]  8%|▊         | 3/40 [00:02<00:30,  1.22it/s]                                              {'loss': 2.8809, 'grad_norm': 14.100020408630371, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:30,  1.22it/s] 10%|█         | 4/40 [00:03<00:28,  1.26it/s]                                              {'loss': 1.9665, 'grad_norm': 15.678459167480469, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:28,  1.26it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s]                                              {'loss': 1.6232, 'grad_norm': 18.360841751098633, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s] 15%|█▌        | 6/40 [00:04<00:19,  1.79it/s]                                              {'loss': 1.6281, 'grad_norm': 18.067832946777344, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:19,  1.79it/s] 18%|█▊        | 7/40 [00:04<00:16,  2.05it/s]                                              {'loss': 0.9997, 'grad_norm': 14.06130599975586, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:16,  2.05it/s]                                              {'loss': 4.9877, 'grad_norm': 89.22640228271484, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.05it/s] 22%|██▎       | 9/40 [00:04<00:10,  2.85it/s]                                              {'loss': 1.0697, 'grad_norm': 8.8605318069458, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:10,  2.85it/s] 25%|██▌       | 10/40 [00:05<00:10,  2.83it/s]                                               {'loss': 0.6247, 'grad_norm': 10.612127304077148, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:10,  2.83it/s] 28%|██▊       | 11/40 [00:05<00:10,  2.86it/s]                                               {'loss': 1.2545, 'grad_norm': 11.637492179870605, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:10,  2.86it/s] 30%|███       | 12/40 [00:06<00:11,  2.41it/s]                                               {'loss': 0.6943, 'grad_norm': 5.342621803283691, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:11,  2.41it/s] 32%|███▎      | 13/40 [00:06<00:13,  2.08it/s]                                               {'loss': 0.6874, 'grad_norm': 5.843751430511475, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:13,  2.08it/s] 35%|███▌      | 14/40 [00:07<00:13,  1.93it/s]                                               {'loss': 1.0164, 'grad_norm': 6.6567816734313965, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:13,  1.93it/s] 38%|███▊      | 15/40 [00:08<00:13,  1.82it/s]                                               {'loss': 1.2646, 'grad_norm': 10.457091331481934, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:13,  1.82it/s]                                               {'loss': 1.3483, 'grad_norm': 41.7437858581543, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:13,  1.82it/s] 42%|████▎     | 17/40 [00:08<00:11,  2.07it/s]                                               {'loss': 0.5893, 'grad_norm': 4.643109321594238, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:11,  2.07it/s] 45%|████▌     | 18/40 [00:09<00:11,  1.87it/s]                                               {'loss': 0.3215, 'grad_norm': 5.0801286697387695, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:11,  1.87it/s] 48%|████▊     | 19/40 [00:10<00:11,  1.77it/s]                                               {'loss': 0.4096, 'grad_norm': 3.6319854259490967, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:11,  1.77it/s] 50%|█████     | 20/40 [00:10<00:12,  1.65it/s]                                               {'loss': 0.9095, 'grad_norm': 4.848634243011475, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:11<00:11,  1.62it/s]                                               {'loss': 0.2161, 'grad_norm': 4.076196193695068, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:11,  1.62it/s] 55%|█████▌    | 22/40 [00:12<00:11,  1.56it/s]                                               {'loss': 0.2377, 'grad_norm': 4.886269569396973, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:11,  1.56it/s] 57%|█████▊    | 23/40 [00:12<00:11,  1.51it/s]                                               {'loss': 0.4727, 'grad_norm': 5.768786907196045, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:11,  1.51it/s]                                               {'loss': 0.3482, 'grad_norm': 35.3716926574707, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:10,  1.51it/s] 62%|██████▎   | 25/40 [00:13<00:07,  1.93it/s]                                               {'loss': 0.5809, 'grad_norm': 7.753991603851318, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:07,  1.93it/s] 65%|██████▌   | 26/40 [00:14<00:07,  1.76it/s]                                               {'loss': 0.1375, 'grad_norm': 2.014068841934204, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:07,  1.76it/s] 68%|██████▊   | 27/40 [00:15<00:07,  1.67it/s]                                               {'loss': 0.1441, 'grad_norm': 2.5475361347198486, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:07,  1.67it/s] 70%|███████   | 28/40 [00:15<00:07,  1.67it/s]                                               {'loss': 0.0835, 'grad_norm': 1.2393821477890015, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.67it/s] 72%|███████▎  | 29/40 [00:16<00:07,  1.56it/s]                                               {'loss': 0.7704, 'grad_norm': 4.322685241699219, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:07,  1.56it/s] 75%|███████▌  | 30/40 [00:17<00:06,  1.55it/s]                                               {'loss': 0.3315, 'grad_norm': 1.4587122201919556, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:06,  1.55it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.53it/s]                                               {'loss': 0.1167, 'grad_norm': 1.7279565334320068, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.53it/s]                                               {'loss': 0.0657, 'grad_norm': 4.630225658416748, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.53it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.85it/s]                                               {'loss': 0.0636, 'grad_norm': 1.3274836540222168, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.85it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.76it/s]                                               {'loss': 0.6248, 'grad_norm': 2.539232015609741, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.67it/s]                                               {'loss': 0.0783, 'grad_norm': 2.0133979320526123, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.67it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.58it/s]                                               {'loss': 0.0456, 'grad_norm': 1.0356658697128296, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.58it/s] 92%|█████████▎| 37/40 [00:21<00:01,  1.63it/s]                                               {'loss': 0.0889, 'grad_norm': 1.9986870288848877, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  1.63it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.53it/s]                                               {'loss': 0.3574, 'grad_norm': 2.002908229827881, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.53it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.53it/s]                                               {'loss': 0.2674, 'grad_norm': 4.678142070770264, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.53it/s]                                               {'loss': 0.0427, 'grad_norm': 2.5943491458892822, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.53it/s]                                               {'train_runtime': 22.8971, 'train_samples_per_second': 24.676, 'train_steps_per_second': 1.747, 'train_loss': 0.862215222325176, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.53it/s]100%|██████████| 40/40 [00:22<00:00,  1.75it/s]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.37it/s]                                              {'loss': 3.3905, 'grad_norm': 13.481538772583008, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.37it/s]  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]                                              {'loss': 2.6867, 'grad_norm': 12.205697059631348, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:22,  1.68it/s]  8%|▊         | 3/40 [00:01<00:17,  2.10it/s]                                              {'loss': 2.2742, 'grad_norm': 15.667459487915039, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.10it/s] 10%|█         | 4/40 [00:01<00:15,  2.36it/s]                                              {'loss': 1.5051, 'grad_norm': 11.831094741821289, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.36it/s] 12%|█▎        | 5/40 [00:02<00:13,  2.53it/s]                                              {'loss': 1.8709, 'grad_norm': 14.969928741455078, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.53it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.67it/s]                                              {'loss': 1.5355, 'grad_norm': 12.249359130859375, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.67it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.75it/s]                                              {'loss': 1.7257, 'grad_norm': 18.203889846801758, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.75it/s] 20%|██        | 8/40 [00:03<00:08,  3.56it/s]                                              {'loss': 0.0046, 'grad_norm': 0.321354478597641, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:08,  3.56it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.36it/s]                                              {'loss': 1.3251, 'grad_norm': 7.44204044342041, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.36it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.22it/s]                                               {'loss': 0.839, 'grad_norm': 9.896321296691895, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.22it/s] 28%|██▊       | 11/40 [00:04<00:09,  3.10it/s]                                               {'loss': 0.5939, 'grad_norm': 5.413048267364502, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:09,  3.10it/s] 30%|███       | 12/40 [00:04<00:09,  3.00it/s]                                               {'loss': 0.8139, 'grad_norm': 5.984309673309326, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  3.00it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.97it/s]                                               {'loss': 0.598, 'grad_norm': 5.292850017547607, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.97it/s] 35%|███▌      | 14/40 [00:05<00:08,  2.94it/s]                                               {'loss': 0.751, 'grad_norm': 7.1863226890563965, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:08,  2.94it/s] 38%|███▊      | 15/40 [00:05<00:08,  2.93it/s]                                               {'loss': 0.6982, 'grad_norm': 5.839543342590332, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  2.93it/s]                                               {'loss': 0.01, 'grad_norm': 0.4701055884361267, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:08,  2.93it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.61it/s]                                               {'loss': 0.2118, 'grad_norm': 5.291858196258545, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.61it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.68it/s]                                               {'loss': 0.4692, 'grad_norm': 12.654585838317871, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.68it/s] 48%|████▊     | 19/40 [00:07<00:09,  2.32it/s]                                               {'loss': 0.6829, 'grad_norm': 13.117192268371582, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:09,  2.32it/s] 50%|█████     | 20/40 [00:07<00:10,  1.95it/s]                                               {'loss': 0.6862, 'grad_norm': 4.7537713050842285, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:10,  1.95it/s] 52%|█████▎    | 21/40 [00:08<00:10,  1.79it/s]                                               {'loss': 0.4276, 'grad_norm': 7.041797161102295, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:10,  1.79it/s] 55%|█████▌    | 22/40 [00:09<00:10,  1.71it/s]                                               {'loss': 0.1005, 'grad_norm': 1.7297935485839844, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:10,  1.71it/s] 57%|█████▊    | 23/40 [00:09<00:10,  1.61it/s]                                               {'loss': 0.3167, 'grad_norm': 13.7305269241333, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:10,  1.61it/s]                                               {'loss': 0.0036, 'grad_norm': 0.16773109138011932, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:09,  1.61it/s] 62%|██████▎   | 25/40 [00:10<00:07,  1.95it/s]                                               {'loss': 0.3148, 'grad_norm': 3.7215030193328857, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:07,  1.95it/s] 65%|██████▌   | 26/40 [00:11<00:07,  1.85it/s]                                               {'loss': 0.1782, 'grad_norm': 5.409885883331299, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:07,  1.85it/s] 68%|██████▊   | 27/40 [00:12<00:07,  1.70it/s]                                               {'loss': 0.357, 'grad_norm': 3.8264334201812744, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:07,  1.70it/s] 70%|███████   | 28/40 [00:12<00:07,  1.65it/s]                                               {'loss': 0.1599, 'grad_norm': 3.033198356628418, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:07,  1.65it/s] 72%|███████▎  | 29/40 [00:13<00:06,  1.60it/s]                                               {'loss': 0.5789, 'grad_norm': 2.34786319732666, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:06,  1.60it/s] 75%|███████▌  | 30/40 [00:14<00:06,  1.57it/s]                                               {'loss': 0.0672, 'grad_norm': 1.4805129766464233, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:14<00:06,  1.57it/s] 78%|███████▊  | 31/40 [00:14<00:05,  1.57it/s]                                               {'loss': 0.358, 'grad_norm': 7.481378078460693, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:05,  1.57it/s]                                               {'loss': 0.505, 'grad_norm': 17.40235137939453, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:05,  1.57it/s] 82%|████████▎ | 33/40 [00:15<00:03,  1.89it/s]                                               {'loss': 0.1729, 'grad_norm': 2.8978607654571533, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:15<00:03,  1.89it/s] 85%|████████▌ | 34/40 [00:16<00:03,  1.77it/s]                                               {'loss': 0.4671, 'grad_norm': 1.7690799236297607, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:16<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:16<00:02,  1.72it/s]                                               {'loss': 0.1358, 'grad_norm': 4.411426544189453, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:16<00:02,  1.72it/s] 90%|█████████ | 36/40 [00:17<00:02,  1.61it/s]                                               {'loss': 0.0646, 'grad_norm': 0.7666206359863281, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:17<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:18<00:01,  1.59it/s]                                               {'loss': 0.1275, 'grad_norm': 2.0381109714508057, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:18<00:01,  1.59it/s] 95%|█████████▌| 38/40 [00:18<00:01,  1.57it/s]                                               {'loss': 0.0706, 'grad_norm': 1.1603957414627075, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:18<00:01,  1.57it/s] 98%|█████████▊| 39/40 [00:19<00:00,  1.51it/s]                                               {'loss': 0.0975, 'grad_norm': 2.112548351287842, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:19<00:00,  1.51it/s]                                               {'loss': 0.0589, 'grad_norm': 2.1683197021484375, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  1.51it/s]                                               {'train_runtime': 19.803, 'train_samples_per_second': 28.531, 'train_steps_per_second': 2.02, 'train_loss': 0.6808677279041149, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  1.51it/s]100%|██████████| 40/40 [00:19<00:00,  2.02it/s]
CLIENT:36
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.37it/s]                                              {'loss': 3.6666, 'grad_norm': 11.37071418762207, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.37it/s]  5%|▌         | 2/40 [00:01<00:25,  1.50it/s]                                              {'loss': 1.7627, 'grad_norm': 9.420823097229004, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.50it/s]  8%|▊         | 3/40 [00:02<00:25,  1.47it/s]                                              {'loss': 1.1923, 'grad_norm': 8.982269287109375, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.47it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s]                                              {'loss': 1.3634, 'grad_norm': 8.435033798217773, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.52it/s]                                              {'loss': 1.1101, 'grad_norm': 14.115278244018555, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.52it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s]                                              {'loss': 1.0862, 'grad_norm': 13.687652587890625, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s]                                              {'loss': 1.7186, 'grad_norm': 11.44809627532959, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s]                                              {'loss': 0.0011, 'grad_norm': 0.06034949794411659, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.91it/s]                                              {'loss': 0.7401, 'grad_norm': 11.79702377319336, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.91it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s]                                               {'loss': 1.0044, 'grad_norm': 8.704111099243164, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s] 28%|██▊       | 11/40 [00:06<00:16,  1.71it/s]                                               {'loss': 0.6317, 'grad_norm': 7.5058817863464355, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:16,  1.71it/s] 30%|███       | 12/40 [00:07<00:17,  1.61it/s]                                               {'loss': 0.6173, 'grad_norm': 6.117931365966797, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.55it/s]                                               {'loss': 1.2822, 'grad_norm': 8.240248680114746, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.55it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.59it/s]                                               {'loss': 0.5877, 'grad_norm': 7.352715969085693, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.59it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 0.3406, 'grad_norm': 5.223340034484863, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 0.0617, 'grad_norm': 2.806908369064331, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.52it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.2047, 'grad_norm': 1.7446130514144897, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.82it/s]                                               {'loss': 0.5758, 'grad_norm': 5.383716106414795, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.82it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.68it/s]                                               {'loss': 0.7688, 'grad_norm': 4.263843059539795, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.68it/s] 50%|█████     | 20/40 [00:12<00:12,  1.62it/s]                                               {'loss': 0.1468, 'grad_norm': 3.085395336151123, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.62it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.58it/s]                                               {'loss': 0.1604, 'grad_norm': 3.6114234924316406, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.58it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.53it/s]                                               {'loss': 0.216, 'grad_norm': 5.479809761047363, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.53it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.61it/s]                                               {'loss': 0.4546, 'grad_norm': 3.3774828910827637, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.61it/s]                                               {'loss': 0.1664, 'grad_norm': 7.5775299072265625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:09,  1.61it/s] 62%|██████▎   | 25/40 [00:14<00:06,  2.30it/s]                                               {'loss': 0.4755, 'grad_norm': 1.8798631429672241, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:06,  2.30it/s] 65%|██████▌   | 26/40 [00:15<00:05,  2.40it/s]                                               {'loss': 0.417, 'grad_norm': 4.164880275726318, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:05,  2.40it/s] 68%|██████▊   | 27/40 [00:15<00:05,  2.48it/s]                                               {'loss': 0.0738, 'grad_norm': 1.8334579467773438, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:05,  2.48it/s] 70%|███████   | 28/40 [00:15<00:04,  2.58it/s]                                               {'loss': 0.1486, 'grad_norm': 3.166869640350342, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:04,  2.58it/s] 72%|███████▎  | 29/40 [00:16<00:04,  2.64it/s]                                               {'loss': 0.2174, 'grad_norm': 6.3625898361206055, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:04,  2.64it/s] 75%|███████▌  | 30/40 [00:16<00:03,  2.67it/s]                                               {'loss': 0.06, 'grad_norm': 1.5188171863555908, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:03,  2.67it/s] 78%|███████▊  | 31/40 [00:16<00:03,  2.73it/s]                                               {'loss': 0.4305, 'grad_norm': 4.76818323135376, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:03,  2.73it/s]                                               {'loss': 0.1436, 'grad_norm': 8.465779304504395, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:02,  2.73it/s] 82%|████████▎ | 33/40 [00:17<00:02,  3.27it/s]                                               {'loss': 0.2151, 'grad_norm': 2.362081289291382, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:02,  3.27it/s] 85%|████████▌ | 34/40 [00:17<00:01,  3.16it/s]                                               {'loss': 0.0539, 'grad_norm': 0.7362682819366455, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:01,  3.16it/s] 88%|████████▊ | 35/40 [00:17<00:01,  3.01it/s]                                               {'loss': 0.3552, 'grad_norm': 0.9297298789024353, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:17<00:01,  3.01it/s] 90%|█████████ | 36/40 [00:18<00:01,  2.94it/s]                                               {'loss': 0.2198, 'grad_norm': 4.456845283508301, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:01,  2.94it/s] 92%|█████████▎| 37/40 [00:18<00:01,  2.89it/s]                                               {'loss': 0.2659, 'grad_norm': 6.1913838386535645, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:18<00:01,  2.89it/s] 95%|█████████▌| 38/40 [00:19<00:00,  2.85it/s]                                               {'loss': 0.2694, 'grad_norm': 0.7835853099822998, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:19<00:00,  2.85it/s] 98%|█████████▊| 39/40 [00:19<00:00,  2.84it/s]                                               {'loss': 0.0336, 'grad_norm': 1.019693374633789, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:19<00:00,  2.84it/s]100%|██████████| 40/40 [00:19<00:00,  3.44it/s]                                               {'loss': 0.0095, 'grad_norm': 0.8518854379653931, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  3.44it/s]                                               {'train_runtime': 19.8501, 'train_samples_per_second': 28.463, 'train_steps_per_second': 2.015, 'train_loss': 0.5812233075819677, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  3.44it/s]100%|██████████| 40/40 [00:19<00:00,  2.02it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:46,  1.20s/it]                                              {'loss': 2.5432, 'grad_norm': 9.797529220581055, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:46,  1.20s/it]  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]                                              {'loss': 1.3195, 'grad_norm': 9.812501907348633, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]  8%|▊         | 3/40 [00:02<00:28,  1.29it/s]                                              {'loss': 1.1697, 'grad_norm': 17.23253059387207, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.29it/s] 10%|█         | 4/40 [00:03<00:26,  1.38it/s]                                              {'loss': 1.4588, 'grad_norm': 12.099058151245117, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:26,  1.38it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s]                                              {'loss': 1.4193, 'grad_norm': 11.324222564697266, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s]                                              {'loss': 1.9193, 'grad_norm': 16.98545265197754, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:05<00:21,  1.54it/s]                                              {'loss': 1.8517, 'grad_norm': 15.445610046386719, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:21,  1.54it/s]                                              {'loss': 6.1854, 'grad_norm': 81.87521362304688, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:20,  1.54it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.90it/s]                                              {'loss': 0.498, 'grad_norm': 9.221757888793945, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.90it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s]                                               {'loss': 0.6055, 'grad_norm': 7.48533821105957, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s] 28%|██▊       | 11/40 [00:07<00:16,  1.75it/s]                                               {'loss': 0.7563, 'grad_norm': 8.517937660217285, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:16,  1.75it/s] 30%|███       | 12/40 [00:07<00:17,  1.63it/s]                                               {'loss': 0.5872, 'grad_norm': 11.699588775634766, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.63it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s]                                               {'loss': 0.1885, 'grad_norm': 4.426573276519775, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.57it/s]                                               {'loss': 0.8156, 'grad_norm': 6.964953422546387, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.57it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 1.0382, 'grad_norm': 7.576408863067627, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 1.0467, 'grad_norm': 25.882858276367188, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.54it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.92it/s]                                               {'loss': 0.3178, 'grad_norm': 2.8699846267700195, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.92it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.82it/s]                                               {'loss': 0.1654, 'grad_norm': 3.3366823196411133, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.82it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.69it/s]                                               {'loss': 0.4349, 'grad_norm': 2.5641489028930664, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.69it/s] 50%|█████     | 20/40 [00:12<00:11,  1.70it/s]                                               {'loss': 0.4823, 'grad_norm': 11.720560073852539, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:11,  1.70it/s] 52%|█████▎    | 21/40 [00:13<00:11,  1.61it/s]                                               {'loss': 0.2952, 'grad_norm': 5.120422840118408, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:11,  1.61it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s]                                               {'loss': 0.1985, 'grad_norm': 3.039656162261963, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.59it/s]                                               {'loss': 0.1502, 'grad_norm': 3.7968575954437256, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.59it/s]                                               {'loss': 0.1439, 'grad_norm': 8.373042106628418, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.59it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.92it/s]                                               {'loss': 0.03, 'grad_norm': 0.7759370803833008, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.92it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.79it/s]                                               {'loss': 0.3678, 'grad_norm': 5.266758918762207, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.79it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.74it/s]                                               {'loss': 0.2396, 'grad_norm': 4.122109889984131, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.74it/s] 70%|███████   | 28/40 [00:17<00:07,  1.63it/s]                                               {'loss': 0.239, 'grad_norm': 2.3846399784088135, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.63it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.60it/s]                                               {'loss': 0.3617, 'grad_norm': 5.745733261108398, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.60it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.59it/s]                                               {'loss': 0.1476, 'grad_norm': 4.483847618103027, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.59it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.54it/s]                                               {'loss': 0.0515, 'grad_norm': 0.7735106348991394, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.54it/s]                                               {'loss': 0.0459, 'grad_norm': 2.815791368484497, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.54it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.97it/s]                                               {'loss': 0.0786, 'grad_norm': 4.130770206451416, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.97it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.81it/s]                                               {'loss': 0.0629, 'grad_norm': 2.338712453842163, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.81it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.70it/s]                                               {'loss': 0.2757, 'grad_norm': 3.4608209133148193, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.70it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.71it/s]                                               {'loss': 0.0315, 'grad_norm': 0.8802586793899536, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.71it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.60it/s]                                               {'loss': 0.107, 'grad_norm': 3.6416661739349365, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.60it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s]                                               {'loss': 0.2589, 'grad_norm': 3.693936586380005, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.57it/s]                                               {'loss': 0.1598, 'grad_norm': 0.43689092993736267, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.57it/s]                                               {'loss': 0.0005, 'grad_norm': 0.02415861375629902, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.57it/s]                                               {'train_runtime': 24.1832, 'train_samples_per_second': 23.363, 'train_steps_per_second': 1.654, 'train_loss': 0.7012307477023569, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.57it/s]100%|██████████| 40/40 [00:24<00:00,  1.65it/s]
CLIENT:69
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]                                              {'loss': 3.7002, 'grad_norm': 9.219576835632324, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:23,  1.60it/s]                                              {'loss': 1.4665, 'grad_norm': 7.891352653503418, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:23,  1.60it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s]                                              {'loss': 2.231, 'grad_norm': 15.655858993530273, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.49it/s]                                              {'loss': 1.7576, 'grad_norm': 16.58506202697754, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.49it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.51it/s]                                              {'loss': 1.4201, 'grad_norm': 15.874772071838379, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.51it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.49it/s]                                              {'loss': 1.9799, 'grad_norm': 17.404727935791016, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.49it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s]                                              {'loss': 1.2774, 'grad_norm': 13.513873100280762, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s]                                              {'loss': 6.1918, 'grad_norm': 2.9353764057159424, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:20,  1.53it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.93it/s]                                              {'loss': 0.836, 'grad_norm': 7.1720499992370605, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.93it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.11it/s]                                               {'loss': 1.0786, 'grad_norm': 8.587543487548828, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.11it/s] 28%|██▊       | 11/40 [00:06<00:12,  2.28it/s]                                               {'loss': 0.5717, 'grad_norm': 4.676341533660889, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:12,  2.28it/s] 30%|███       | 12/40 [00:06<00:14,  2.00it/s]                                               {'loss': 0.6486, 'grad_norm': 7.695517539978027, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:14,  2.00it/s] 32%|███▎      | 13/40 [00:07<00:14,  1.91it/s]                                               {'loss': 1.0417, 'grad_norm': 6.96267032623291, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:14,  1.91it/s] 35%|███▌      | 14/40 [00:08<00:15,  1.71it/s]                                               {'loss': 0.6609, 'grad_norm': 6.249190330505371, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:15,  1.71it/s] 38%|███▊      | 15/40 [00:08<00:15,  1.65it/s]                                               {'loss': 0.9305, 'grad_norm': 9.596807479858398, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:15,  1.65it/s] 40%|████      | 16/40 [00:08<00:11,  2.15it/s]                                               {'loss': 0.224, 'grad_norm': 5.414126396179199, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:11,  2.15it/s] 42%|████▎     | 17/40 [00:09<00:11,  1.98it/s]                                               {'loss': 0.7037, 'grad_norm': 6.342778205871582, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:11,  1.98it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s]                                               {'loss': 0.5932, 'grad_norm': 7.175544738769531, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:10<00:12,  1.66it/s]                                               {'loss': 0.1622, 'grad_norm': 2.580753803253174, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:12,  1.66it/s] 50%|█████     | 20/40 [00:11<00:12,  1.65it/s]                                               {'loss': 0.2482, 'grad_norm': 3.2682909965515137, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:12<00:12,  1.56it/s]                                               {'loss': 0.5578, 'grad_norm': 3.3535115718841553, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:12,  1.56it/s] 55%|█████▌    | 22/40 [00:12<00:11,  1.57it/s]                                               {'loss': 0.5479, 'grad_norm': 2.653733968734741, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:13<00:11,  1.54it/s]                                               {'loss': 0.3007, 'grad_norm': 7.944900989532471, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:11,  1.54it/s]                                               {'loss': 0.323, 'grad_norm': 11.735054016113281, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:10,  1.54it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.91it/s]                                               {'loss': 0.6047, 'grad_norm': 2.8574867248535156, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:14<00:07,  1.86it/s]                                               {'loss': 0.1103, 'grad_norm': 1.2047165632247925, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:07,  1.86it/s] 68%|██████▊   | 27/40 [00:15<00:07,  1.70it/s]                                               {'loss': 0.563, 'grad_norm': 5.140270233154297, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:07,  1.70it/s] 70%|███████   | 28/40 [00:16<00:07,  1.63it/s]                                               {'loss': 0.1932, 'grad_norm': 2.2001216411590576, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.63it/s] 72%|███████▎  | 29/40 [00:16<00:06,  1.63it/s]                                               {'loss': 0.1404, 'grad_norm': 2.823861598968506, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:06,  1.63it/s] 75%|███████▌  | 30/40 [00:17<00:06,  1.53it/s]                                               {'loss': 0.0357, 'grad_norm': 0.8633017539978027, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:06,  1.53it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.51it/s]                                               {'loss': 0.0867, 'grad_norm': 2.654895067214966, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.51it/s] 80%|████████  | 32/40 [00:18<00:04,  1.98it/s]                                               {'loss': 0.1327, 'grad_norm': 5.228095054626465, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:04,  1.98it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.87it/s]                                               {'loss': 0.0966, 'grad_norm': 2.7661125659942627, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.87it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.70it/s]                                               {'loss': 0.1792, 'grad_norm': 4.219870090484619, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.70it/s] 88%|████████▊ | 35/40 [00:20<00:03,  1.62it/s]                                               {'loss': 0.0916, 'grad_norm': 1.6931962966918945, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:03,  1.62it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.62it/s]                                               {'loss': 0.4166, 'grad_norm': 0.9972131848335266, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:21<00:01,  1.54it/s]                                               {'loss': 0.0148, 'grad_norm': 0.22845138609409332, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  1.54it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.58it/s]                                               {'loss': 0.2387, 'grad_norm': 1.323637843132019, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.58it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.52it/s]                                               {'loss': 0.2667, 'grad_norm': 1.2283567190170288, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.52it/s]                                               {'loss': 0.0129, 'grad_norm': 0.37606680393218994, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.52it/s]                                               {'train_runtime': 23.3953, 'train_samples_per_second': 24.15, 'train_steps_per_second': 1.71, 'train_loss': 0.8159332956187427, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.52it/s]100%|██████████| 40/40 [00:23<00:00,  1.71it/s]
CLIENT:65
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:22,  1.71it/s]                                              {'loss': 1.7966, 'grad_norm': 7.21429443359375, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:22,  1.71it/s]  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]                                              {'loss': 1.6811, 'grad_norm': 12.230132102966309, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]  8%|▊         | 3/40 [00:01<00:14,  2.51it/s]                                              {'loss': 2.0822, 'grad_norm': 12.506433486938477, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:14,  2.51it/s] 10%|█         | 4/40 [00:01<00:13,  2.65it/s]                                              {'loss': 1.1895, 'grad_norm': 12.179237365722656, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.65it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.77it/s]                                              {'loss': 1.2656, 'grad_norm': 13.174311637878418, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.77it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.79it/s]                                              {'loss': 1.2277, 'grad_norm': 12.328514099121094, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.79it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.83it/s]                                              {'loss': 0.6093, 'grad_norm': 10.720555305480957, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.83it/s]                                              {'loss': 3.1639, 'grad_norm': 104.05592346191406, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:08,  3.56it/s]                                              {'loss': 0.6416, 'grad_norm': 8.593765258789062, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:08,  3.56it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.62it/s]                                               {'loss': 0.651, 'grad_norm': 6.276864051818848, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.62it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.29it/s]                                               {'loss': 0.1824, 'grad_norm': 3.1865158081054688, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.29it/s] 30%|███       | 12/40 [00:04<00:12,  2.26it/s]                                               {'loss': 0.6305, 'grad_norm': 4.973575115203857, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.10it/s]                                               {'loss': 0.6212, 'grad_norm': 4.729496955871582, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.10it/s] 35%|███▌      | 14/40 [00:06<00:13,  1.89it/s]                                               {'loss': 0.2327, 'grad_norm': 3.820722818374634, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:13,  1.89it/s] 38%|███▊      | 15/40 [00:06<00:14,  1.77it/s]                                               {'loss': 0.7329, 'grad_norm': 5.085811614990234, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:14,  1.77it/s]                                               {'loss': 0.2648, 'grad_norm': 11.601534843444824, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:13,  1.77it/s] 42%|████▎     | 17/40 [00:07<00:11,  2.05it/s]                                               {'loss': 0.2726, 'grad_norm': 2.7878708839416504, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:11,  2.05it/s] 45%|████▌     | 18/40 [00:08<00:11,  1.89it/s]                                               {'loss': 0.3896, 'grad_norm': 3.7604401111602783, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:11,  1.89it/s] 48%|████▊     | 19/40 [00:08<00:11,  1.78it/s]                                               {'loss': 0.5338, 'grad_norm': 2.1765666007995605, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:11,  1.78it/s] 50%|█████     | 20/40 [00:09<00:11,  1.67it/s]                                               {'loss': 0.216, 'grad_norm': 4.663145065307617, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:11,  1.67it/s] 52%|█████▎    | 21/40 [00:10<00:11,  1.65it/s]                                               {'loss': 0.0928, 'grad_norm': 1.7443686723709106, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:11,  1.65it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.59it/s]                                               {'loss': 0.1497, 'grad_norm': 4.688337326049805, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.59it/s] 57%|█████▊    | 23/40 [00:11<00:10,  1.68it/s]                                               {'loss': 0.1211, 'grad_norm': 3.8877322673797607, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:10,  1.68it/s]                                               {'loss': 0.1405, 'grad_norm': 8.229094505310059, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:09,  1.68it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.99it/s]                                               {'loss': 0.0801, 'grad_norm': 1.7200591564178467, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.99it/s] 65%|██████▌   | 26/40 [00:12<00:07,  1.80it/s]                                               {'loss': 0.1513, 'grad_norm': 1.363336205482483, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.76it/s]                                               {'loss': 0.3743, 'grad_norm': 1.9701263904571533, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.76it/s] 70%|███████   | 28/40 [00:14<00:07,  1.64it/s]                                               {'loss': 0.0226, 'grad_norm': 0.5955557823181152, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.64it/s] 72%|███████▎  | 29/40 [00:14<00:06,  1.57it/s]                                               {'loss': 0.1421, 'grad_norm': 2.3458893299102783, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:06,  1.57it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.61it/s]                                               {'loss': 0.0283, 'grad_norm': 0.6772313714027405, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.61it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.53it/s]                                               {'loss': 0.1672, 'grad_norm': 1.8186124563217163, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.53it/s]                                               {'loss': 0.0661, 'grad_norm': 3.022024631500244, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.53it/s] 82%|████████▎ | 33/40 [00:16<00:03,  1.89it/s]                                               {'loss': 0.1101, 'grad_norm': 0.38854068517684937, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:03,  1.89it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.84it/s]                                               {'loss': 0.0552, 'grad_norm': 0.7180195450782776, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.84it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.69it/s]                                               {'loss': 0.1253, 'grad_norm': 5.04802131652832, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:18<00:02,  1.70it/s]                                               {'loss': 0.0443, 'grad_norm': 1.8026914596557617, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:02,  1.70it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.61it/s]                                               {'loss': 0.0675, 'grad_norm': 1.9257606267929077, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.61it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.56it/s]                                               {'loss': 0.3544, 'grad_norm': 4.0879058837890625, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:20<00:00,  1.59it/s]                                               {'loss': 0.0414, 'grad_norm': 1.0686473846435547, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  1.59it/s]100%|██████████| 40/40 [00:20<00:00,  2.10it/s]                                               {'loss': 0.0009, 'grad_norm': 0.07231788337230682, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  2.10it/s]                                               {'train_runtime': 21.1859, 'train_samples_per_second': 26.669, 'train_steps_per_second': 1.888, 'train_loss': 0.5180093751623644, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.10it/s]100%|██████████| 40/40 [00:21<00:00,  1.89it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:20,  5.80it/s]  1%|          | 3/471 [00:00<02:06,  3.70it/s]  1%|          | 4/471 [00:01<02:16,  3.42it/s]  1%|          | 5/471 [00:01<02:18,  3.36it/s]  1%|▏         | 6/471 [00:01<02:37,  2.95it/s]  1%|▏         | 7/471 [00:02<02:37,  2.95it/s]  2%|▏         | 8/471 [00:02<02:31,  3.06it/s]  2%|▏         | 9/471 [00:02<02:35,  2.98it/s]  2%|▏         | 10/471 [00:03<02:44,  2.80it/s]  2%|▏         | 11/471 [00:03<02:39,  2.89it/s]  3%|▎         | 12/471 [00:03<02:35,  2.94it/s]  3%|▎         | 13/471 [00:04<02:46,  2.75it/s]  3%|▎         | 14/471 [00:04<02:41,  2.83it/s]  3%|▎         | 15/471 [00:04<02:33,  2.96it/s]  3%|▎         | 16/471 [00:05<02:44,  2.77it/s]  4%|▎         | 17/471 [00:05<02:43,  2.78it/s]  4%|▍         | 18/471 [00:05<02:36,  2.89it/s]  4%|▍         | 19/471 [00:06<02:41,  2.81it/s]  4%|▍         | 20/471 [00:06<02:45,  2.73it/s]  4%|▍         | 21/471 [00:07<02:38,  2.83it/s]  5%|▍         | 22/471 [00:07<02:37,  2.85it/s]  5%|▍         | 23/471 [00:07<02:45,  2.70it/s]  5%|▌         | 24/471 [00:08<02:39,  2.80it/s]  5%|▌         | 25/471 [00:08<02:35,  2.88it/s]  6%|▌         | 26/471 [00:08<02:44,  2.70it/s]  6%|▌         | 27/471 [00:09<02:38,  2.79it/s]  6%|▌         | 28/471 [00:09<02:31,  2.93it/s]  6%|▌         | 29/471 [00:09<02:40,  2.76it/s]  6%|▋         | 30/471 [00:10<02:39,  2.76it/s]  7%|▋         | 31/471 [00:10<02:31,  2.89it/s]  7%|▋         | 32/471 [00:10<02:15,  3.24it/s]  7%|▋         | 33/471 [00:11<01:59,  3.66it/s]  7%|▋         | 34/471 [00:11<01:49,  4.00it/s]  7%|▋         | 35/471 [00:11<01:41,  4.31it/s]  8%|▊         | 36/471 [00:11<01:34,  4.58it/s]  8%|▊         | 37/471 [00:11<01:30,  4.79it/s]  8%|▊         | 38/471 [00:11<01:27,  4.92it/s]  8%|▊         | 39/471 [00:12<01:26,  4.99it/s]  8%|▊         | 40/471 [00:12<01:24,  5.07it/s]  9%|▊         | 41/471 [00:12<01:23,  5.14it/s]  9%|▉         | 42/471 [00:12<01:22,  5.20it/s]  9%|▉         | 43/471 [00:12<01:21,  5.24it/s]  9%|▉         | 44/471 [00:13<01:22,  5.19it/s] 10%|▉         | 45/471 [00:13<01:22,  5.17it/s] 10%|▉         | 46/471 [00:13<01:22,  5.15it/s] 10%|▉         | 47/471 [00:13<01:22,  5.17it/s] 10%|█         | 48/471 [00:13<01:21,  5.22it/s] 10%|█         | 49/471 [00:14<01:21,  5.16it/s] 11%|█         | 50/471 [00:14<01:34,  4.48it/s] 11%|█         | 51/471 [00:14<01:57,  3.59it/s] 11%|█         | 52/471 [00:15<02:03,  3.40it/s] 11%|█▏        | 53/471 [00:15<02:04,  3.36it/s] 11%|█▏        | 54/471 [00:15<02:08,  3.25it/s] 12%|█▏        | 55/471 [00:16<01:58,  3.51it/s] 12%|█▏        | 56/471 [00:16<02:05,  3.30it/s] 12%|█▏        | 57/471 [00:16<02:08,  3.21it/s] 12%|█▏        | 58/471 [00:17<02:13,  3.10it/s] 13%|█▎        | 59/471 [00:17<02:25,  2.84it/s] 13%|█▎        | 60/471 [00:17<02:22,  2.89it/s] 13%|█▎        | 61/471 [00:18<02:20,  2.93it/s] 13%|█▎        | 62/471 [00:18<02:30,  2.72it/s] 13%|█▎        | 63/471 [00:18<02:24,  2.82it/s] 14%|█▎        | 64/471 [00:19<02:19,  2.91it/s] 14%|█▍        | 65/471 [00:19<02:28,  2.73it/s] 14%|█▍        | 66/471 [00:19<02:25,  2.78it/s] 14%|█▍        | 67/471 [00:20<02:18,  2.93it/s] 14%|█▍        | 68/471 [00:20<02:26,  2.76it/s] 15%|█▍        | 69/471 [00:21<02:26,  2.75it/s] 15%|█▍        | 70/471 [00:21<02:21,  2.84it/s] 15%|█▌        | 71/471 [00:21<02:21,  2.82it/s] 15%|█▌        | 72/471 [00:22<02:27,  2.71it/s] 15%|█▌        | 73/471 [00:22<02:21,  2.81it/s] 16%|█▌        | 74/471 [00:22<02:13,  2.98it/s] 16%|█▌        | 75/471 [00:23<02:22,  2.78it/s] 16%|█▌        | 76/471 [00:23<02:21,  2.79it/s] 16%|█▋        | 77/471 [00:23<02:14,  2.92it/s] 17%|█▋        | 78/471 [00:24<02:19,  2.82it/s] 17%|█▋        | 79/471 [00:24<02:23,  2.74it/s] 17%|█▋        | 80/471 [00:24<02:17,  2.84it/s] 17%|█▋        | 81/471 [00:25<02:15,  2.87it/s] 17%|█▋        | 82/471 [00:25<02:23,  2.72it/s] 18%|█▊        | 83/471 [00:25<02:17,  2.82it/s] 18%|█▊        | 84/471 [00:26<02:13,  2.90it/s] 18%|█▊        | 85/471 [00:26<02:22,  2.72it/s] 18%|█▊        | 86/471 [00:27<02:17,  2.79it/s] 18%|█▊        | 87/471 [00:27<02:10,  2.94it/s] 19%|█▊        | 88/471 [00:27<02:19,  2.75it/s] 19%|█▉        | 89/471 [00:28<02:18,  2.75it/s] 19%|█▉        | 90/471 [00:28<02:12,  2.87it/s] 19%|█▉        | 91/471 [00:28<02:16,  2.79it/s] 20%|█▉        | 92/471 [00:29<02:19,  2.72it/s] 20%|█▉        | 93/471 [00:29<02:14,  2.82it/s] 20%|█▉        | 94/471 [00:29<02:13,  2.83it/s] 20%|██        | 95/471 [00:30<02:19,  2.70it/s] 20%|██        | 96/471 [00:30<02:13,  2.80it/s] 21%|██        | 97/471 [00:30<02:03,  3.02it/s] 21%|██        | 98/471 [00:31<02:10,  2.86it/s] 21%|██        | 99/471 [00:31<02:13,  2.79it/s] 21%|██        | 100/471 [00:31<02:08,  2.88it/s] 21%|██▏       | 101/471 [00:32<02:04,  2.96it/s] 22%|██▏       | 102/471 [00:32<02:14,  2.75it/s] 22%|██▏       | 103/471 [00:33<02:10,  2.83it/s] 22%|██▏       | 104/471 [00:33<02:06,  2.91it/s] 22%|██▏       | 105/471 [00:33<02:14,  2.72it/s] 23%|██▎       | 106/471 [00:34<02:11,  2.78it/s] 23%|██▎       | 107/471 [00:34<02:04,  2.93it/s] 23%|██▎       | 108/471 [00:34<02:12,  2.75it/s] 23%|██▎       | 109/471 [00:35<02:12,  2.74it/s] 23%|██▎       | 110/471 [00:35<02:06,  2.85it/s] 24%|██▎       | 111/471 [00:35<02:07,  2.81it/s] 24%|██▍       | 112/471 [00:36<02:12,  2.71it/s] 24%|██▍       | 113/471 [00:36<02:06,  2.83it/s] 24%|██▍       | 114/471 [00:36<02:05,  2.85it/s] 24%|██▍       | 115/471 [00:37<02:12,  2.69it/s] 25%|██▍       | 116/471 [00:37<02:07,  2.78it/s] 25%|██▍       | 117/471 [00:38<02:03,  2.86it/s] 25%|██▌       | 118/471 [00:38<02:11,  2.69it/s] 25%|██▌       | 119/471 [00:38<02:06,  2.78it/s] 25%|██▌       | 120/471 [00:39<02:00,  2.92it/s] 26%|██▌       | 121/471 [00:39<02:01,  2.88it/s] 26%|██▌       | 122/471 [00:39<02:06,  2.75it/s] 26%|██▌       | 123/471 [00:40<02:02,  2.85it/s] 26%|██▋       | 124/471 [00:40<02:00,  2.89it/s] 27%|██▋       | 125/471 [00:40<02:07,  2.71it/s] 27%|██▋       | 126/471 [00:41<02:03,  2.80it/s] 27%|██▋       | 127/471 [00:41<01:58,  2.91it/s] 27%|██▋       | 128/471 [00:42<02:05,  2.73it/s] 27%|██▋       | 129/471 [00:42<02:03,  2.77it/s] 28%|██▊       | 130/471 [00:42<01:56,  2.92it/s] 28%|██▊       | 131/471 [00:43<02:04,  2.74it/s] 28%|██▊       | 132/471 [00:43<02:04,  2.71it/s] 28%|██▊       | 133/471 [00:43<02:00,  2.81it/s] 28%|██▊       | 134/471 [00:44<02:00,  2.79it/s] 29%|██▊       | 135/471 [00:44<02:04,  2.69it/s] 29%|██▉       | 136/471 [00:44<01:59,  2.80it/s] 29%|██▉       | 137/471 [00:45<01:57,  2.84it/s] 29%|██▉       | 138/471 [00:45<02:04,  2.68it/s] 30%|██▉       | 139/471 [00:45<01:58,  2.79it/s] 30%|██▉       | 140/471 [00:46<01:54,  2.89it/s] 30%|██▉       | 141/471 [00:46<02:01,  2.71it/s] 30%|███       | 142/471 [00:47<01:59,  2.76it/s] 30%|███       | 143/471 [00:47<01:53,  2.90it/s] 31%|███       | 144/471 [00:47<01:54,  2.85it/s] 31%|███       | 145/471 [00:48<01:59,  2.73it/s] 31%|███       | 146/471 [00:48<01:55,  2.81it/s] 31%|███       | 147/471 [00:48<01:53,  2.86it/s] 31%|███▏      | 148/471 [00:49<02:00,  2.69it/s] 32%|███▏      | 149/471 [00:49<01:56,  2.77it/s] 32%|███▏      | 150/471 [00:49<01:51,  2.88it/s] 32%|███▏      | 151/471 [00:50<01:59,  2.68it/s] 32%|███▏      | 152/471 [00:50<01:56,  2.73it/s] 32%|███▏      | 153/471 [00:50<01:50,  2.88it/s] 33%|███▎      | 154/471 [00:51<01:56,  2.72it/s] 33%|███▎      | 155/471 [00:51<01:56,  2.71it/s] 33%|███▎      | 156/471 [00:52<01:51,  2.82it/s] 33%|███▎      | 157/471 [00:52<01:51,  2.81it/s] 34%|███▎      | 158/471 [00:52<01:55,  2.71it/s] 34%|███▍      | 159/471 [00:53<01:51,  2.81it/s] 34%|███▍      | 160/471 [00:53<01:49,  2.84it/s] 34%|███▍      | 161/471 [00:53<01:55,  2.68it/s] 34%|███▍      | 162/471 [00:54<01:50,  2.79it/s] 35%|███▍      | 163/471 [00:54<01:46,  2.88it/s] 35%|███▍      | 164/471 [00:54<01:53,  2.70it/s] 35%|███▌      | 165/471 [00:55<01:51,  2.76it/s] 35%|███▌      | 166/471 [00:55<01:45,  2.90it/s] 35%|███▌      | 167/471 [00:55<01:32,  3.28it/s] 36%|███▌      | 168/471 [00:56<01:22,  3.66it/s] 36%|███▌      | 169/471 [00:56<01:15,  4.00it/s] 36%|███▌      | 170/471 [00:56<01:10,  4.29it/s] 36%|███▋      | 171/471 [00:56<01:05,  4.55it/s] 37%|███▋      | 172/471 [00:56<01:02,  4.75it/s] 37%|███▋      | 173/471 [00:56<01:01,  4.88it/s] 37%|███▋      | 174/471 [00:57<00:59,  4.95it/s] 37%|███▋      | 175/471 [00:57<00:59,  5.02it/s] 37%|███▋      | 176/471 [00:57<00:57,  5.09it/s] 38%|███▊      | 177/471 [00:57<00:57,  5.13it/s] 38%|███▊      | 178/471 [00:57<00:57,  5.09it/s] 38%|███▊      | 179/471 [00:58<00:57,  5.11it/s] 38%|███▊      | 180/471 [00:58<00:57,  5.10it/s] 38%|███▊      | 181/471 [00:58<00:56,  5.09it/s] 39%|███▊      | 182/471 [00:58<00:56,  5.11it/s] 39%|███▉      | 183/471 [00:58<00:56,  5.12it/s] 39%|███▉      | 184/471 [00:59<00:55,  5.16it/s] 39%|███▉      | 185/471 [00:59<00:55,  5.19it/s] 39%|███▉      | 186/471 [00:59<00:55,  5.17it/s] 40%|███▉      | 187/471 [00:59<00:55,  5.12it/s] 40%|███▉      | 188/471 [01:00<01:04,  4.38it/s] 40%|████      | 189/471 [01:00<01:19,  3.53it/s] 40%|████      | 190/471 [01:00<01:23,  3.36it/s] 41%|████      | 191/471 [01:01<01:23,  3.34it/s] 41%|████      | 192/471 [01:01<01:33,  2.97it/s] 41%|████      | 193/471 [01:01<01:35,  2.92it/s] 41%|████      | 194/471 [01:02<01:32,  3.00it/s] 41%|████▏     | 195/471 [01:02<01:36,  2.85it/s] 42%|████▏     | 196/471 [01:02<01:39,  2.75it/s] 42%|████▏     | 197/471 [01:03<01:36,  2.84it/s] 42%|████▏     | 198/471 [01:03<01:35,  2.86it/s] 42%|████▏     | 199/471 [01:04<01:41,  2.69it/s] 42%|████▏     | 200/471 [01:04<01:37,  2.77it/s] 43%|████▎     | 201/471 [01:04<01:34,  2.86it/s] 43%|████▎     | 202/471 [01:05<01:40,  2.66it/s] 43%|████▎     | 203/471 [01:05<01:38,  2.73it/s] 43%|████▎     | 204/471 [01:05<01:33,  2.86it/s] 44%|████▎     | 205/471 [01:06<01:38,  2.69it/s] 44%|████▎     | 206/471 [01:06<01:38,  2.69it/s] 44%|████▍     | 207/471 [01:06<01:33,  2.82it/s] 44%|████▍     | 208/471 [01:07<01:38,  2.68it/s] 44%|████▍     | 209/471 [01:07<01:37,  2.69it/s] 45%|████▍     | 210/471 [01:07<01:33,  2.80it/s] 45%|████▍     | 211/471 [01:08<01:20,  3.23it/s] 45%|████▌     | 212/471 [01:08<01:11,  3.63it/s] 45%|████▌     | 213/471 [01:08<01:05,  3.94it/s] 45%|████▌     | 214/471 [01:08<01:01,  4.19it/s] 46%|████▌     | 215/471 [01:09<01:10,  3.65it/s] 46%|████▌     | 216/471 [01:09<01:19,  3.22it/s] 46%|████▌     | 217/471 [01:09<01:20,  3.17it/s] 46%|████▋     | 218/471 [01:10<01:21,  3.10it/s] 46%|████▋     | 219/471 [01:10<01:29,  2.83it/s] 47%|████▋     | 220/471 [01:10<01:26,  2.89it/s] 47%|████▋     | 221/471 [01:11<01:24,  2.95it/s] 47%|████▋     | 222/471 [01:11<01:30,  2.76it/s] 47%|████▋     | 223/471 [01:12<01:29,  2.78it/s] 48%|████▊     | 224/471 [01:12<01:25,  2.90it/s] 48%|████▊     | 225/471 [01:12<01:28,  2.77it/s] 48%|████▊     | 226/471 [01:13<01:30,  2.71it/s] 48%|████▊     | 227/471 [01:13<01:27,  2.80it/s] 48%|████▊     | 228/471 [01:13<01:27,  2.79it/s] 49%|████▊     | 229/471 [01:14<01:30,  2.66it/s] 49%|████▉     | 230/471 [01:14<01:27,  2.76it/s] 49%|████▉     | 231/471 [01:14<01:25,  2.82it/s] 49%|████▉     | 232/471 [01:15<01:29,  2.66it/s] 49%|████▉     | 233/471 [01:15<01:26,  2.75it/s] 50%|████▉     | 234/471 [01:16<01:22,  2.86it/s] 50%|████▉     | 235/471 [01:16<01:27,  2.69it/s] 50%|█████     | 236/471 [01:16<01:26,  2.72it/s] 50%|█████     | 237/471 [01:17<01:21,  2.86it/s] 51%|█████     | 238/471 [01:17<01:20,  2.89it/s] 51%|█████     | 239/471 [01:17<01:25,  2.70it/s] 51%|█████     | 240/471 [01:18<01:22,  2.79it/s] 51%|█████     | 241/471 [01:18<01:19,  2.88it/s] 51%|█████▏    | 242/471 [01:18<01:24,  2.70it/s] 52%|█████▏    | 243/471 [01:19<01:23,  2.74it/s] 52%|█████▏    | 244/471 [01:19<01:18,  2.89it/s] 52%|█████▏    | 245/471 [01:20<01:21,  2.76it/s] 52%|█████▏    | 246/471 [01:20<01:23,  2.69it/s] 52%|█████▏    | 247/471 [01:20<01:20,  2.79it/s] 53%|█████▎    | 248/471 [01:21<01:19,  2.81it/s] 53%|█████▎    | 249/471 [01:21<01:23,  2.67it/s] 53%|█████▎    | 250/471 [01:21<01:19,  2.78it/s] 53%|█████▎    | 251/471 [01:22<01:17,  2.84it/s] 54%|█████▎    | 252/471 [01:22<01:22,  2.66it/s] 54%|█████▎    | 253/471 [01:22<01:19,  2.75it/s] 54%|█████▍    | 254/471 [01:23<01:16,  2.85it/s] 54%|█████▍    | 255/471 [01:23<01:20,  2.67it/s] 54%|█████▍    | 256/471 [01:24<01:19,  2.72it/s] 55%|█████▍    | 257/471 [01:24<01:14,  2.86it/s] 55%|█████▍    | 258/471 [01:24<01:19,  2.70it/s] 55%|█████▍    | 259/471 [01:25<01:19,  2.67it/s] 55%|█████▌    | 260/471 [01:25<01:16,  2.76it/s] 55%|█████▌    | 261/471 [01:25<01:12,  2.90it/s] 56%|█████▌    | 262/471 [01:26<01:17,  2.71it/s] 56%|█████▌    | 263/471 [01:26<01:15,  2.77it/s] 56%|█████▌    | 264/471 [01:26<01:11,  2.89it/s] 56%|█████▋    | 265/471 [01:27<01:15,  2.71it/s] 56%|█████▋    | 266/471 [01:27<01:15,  2.71it/s] 57%|█████▋    | 267/471 [01:27<01:12,  2.83it/s] 57%|█████▋    | 268/471 [01:28<01:13,  2.77it/s] 57%|█████▋    | 269/471 [01:28<01:15,  2.68it/s] 57%|█████▋    | 270/471 [01:29<01:12,  2.78it/s] 58%|█████▊    | 271/471 [01:29<01:11,  2.79it/s] 58%|█████▊    | 272/471 [01:29<01:14,  2.65it/s] 58%|█████▊    | 273/471 [01:30<01:12,  2.75it/s] 58%|█████▊    | 274/471 [01:30<01:09,  2.83it/s] 58%|█████▊    | 275/471 [01:30<01:14,  2.65it/s] 59%|█████▊    | 276/471 [01:31<01:11,  2.74it/s] 59%|█████▉    | 277/471 [01:31<01:07,  2.87it/s] 59%|█████▉    | 278/471 [01:32<01:11,  2.69it/s] 59%|█████▉    | 279/471 [01:32<01:10,  2.72it/s] 59%|█████▉    | 280/471 [01:32<01:06,  2.85it/s] 60%|█████▉    | 281/471 [01:33<01:09,  2.74it/s] 60%|█████▉    | 282/471 [01:33<01:10,  2.69it/s] 60%|██████    | 283/471 [01:33<01:07,  2.78it/s] 60%|██████    | 284/471 [01:34<01:03,  2.94it/s] 61%|██████    | 285/471 [01:34<01:08,  2.73it/s] 61%|██████    | 286/471 [01:34<01:07,  2.74it/s] 61%|██████    | 287/471 [01:35<01:04,  2.86it/s] 61%|██████    | 288/471 [01:35<01:07,  2.73it/s] 61%|██████▏   | 289/471 [01:35<01:07,  2.68it/s] 62%|██████▏   | 290/471 [01:36<01:05,  2.77it/s] 62%|██████▏   | 291/471 [01:36<01:04,  2.79it/s] 62%|██████▏   | 292/471 [01:37<01:07,  2.66it/s] 62%|██████▏   | 293/471 [01:37<01:04,  2.78it/s] 62%|██████▏   | 294/471 [01:37<01:00,  2.93it/s] 63%|██████▎   | 295/471 [01:38<01:04,  2.73it/s] 63%|██████▎   | 296/471 [01:38<01:03,  2.77it/s] 63%|██████▎   | 297/471 [01:38<00:59,  2.91it/s] 63%|██████▎   | 298/471 [01:39<01:03,  2.72it/s] 63%|██████▎   | 299/471 [01:39<01:03,  2.71it/s] 64%|██████▎   | 300/471 [01:39<01:01,  2.80it/s] 64%|██████▍   | 301/471 [01:40<01:00,  2.79it/s] 64%|██████▍   | 302/471 [01:40<01:02,  2.69it/s] 64%|██████▍   | 303/471 [01:40<01:00,  2.79it/s] 65%|██████▍   | 304/471 [01:41<00:59,  2.81it/s] 65%|██████▍   | 305/471 [01:41<01:02,  2.65it/s] 65%|██████▍   | 306/471 [01:42<00:59,  2.76it/s] 65%|██████▌   | 307/471 [01:42<00:55,  2.93it/s] 65%|██████▌   | 308/471 [01:42<00:48,  3.40it/s] 66%|██████▌   | 309/471 [01:42<00:43,  3.75it/s] 66%|██████▌   | 310/471 [01:42<00:39,  4.09it/s] 66%|██████▌   | 311/471 [01:43<00:36,  4.37it/s] 66%|██████▌   | 312/471 [01:43<00:34,  4.60it/s] 66%|██████▋   | 313/471 [01:43<00:32,  4.80it/s] 67%|██████▋   | 314/471 [01:43<00:31,  4.91it/s] 67%|██████▋   | 315/471 [01:43<00:31,  4.98it/s] 67%|██████▋   | 316/471 [01:44<00:31,  4.99it/s] 67%|██████▋   | 317/471 [01:44<00:30,  5.03it/s] 68%|██████▊   | 318/471 [01:44<00:30,  5.06it/s] 68%|██████▊   | 319/471 [01:44<00:30,  5.06it/s] 68%|██████▊   | 320/471 [01:44<00:29,  5.09it/s] 68%|██████▊   | 321/471 [01:45<00:29,  5.04it/s] 68%|██████▊   | 322/471 [01:45<00:29,  5.03it/s] 69%|██████▊   | 323/471 [01:45<00:29,  5.09it/s] 69%|██████▉   | 324/471 [01:45<00:28,  5.13it/s] 69%|██████▉   | 325/471 [01:45<00:28,  5.17it/s] 69%|██████▉   | 326/471 [01:46<00:28,  5.16it/s] 69%|██████▉   | 327/471 [01:46<00:32,  4.48it/s] 70%|██████▉   | 328/471 [01:46<00:40,  3.57it/s] 70%|██████▉   | 329/471 [01:47<00:42,  3.37it/s] 70%|███████   | 330/471 [01:47<00:42,  3.33it/s] 70%|███████   | 331/471 [01:47<00:47,  2.96it/s] 70%|███████   | 332/471 [01:48<00:47,  2.90it/s] 71%|███████   | 333/471 [01:48<00:46,  2.97it/s] 71%|███████   | 334/471 [01:48<00:48,  2.83it/s] 71%|███████   | 335/471 [01:49<00:49,  2.73it/s] 71%|███████▏  | 336/471 [01:49<00:47,  2.82it/s] 72%|███████▏  | 337/471 [01:49<00:47,  2.84it/s] 72%|███████▏  | 338/471 [01:50<00:49,  2.68it/s] 72%|███████▏  | 339/471 [01:50<00:47,  2.78it/s] 72%|███████▏  | 340/471 [01:51<00:45,  2.86it/s] 72%|███████▏  | 341/471 [01:51<00:48,  2.69it/s] 73%|███████▎  | 342/471 [01:51<00:46,  2.76it/s] 73%|███████▎  | 343/471 [01:52<00:44,  2.89it/s] 73%|███████▎  | 344/471 [01:52<00:46,  2.70it/s] 73%|███████▎  | 345/471 [01:52<00:46,  2.71it/s] 73%|███████▎  | 346/471 [01:53<00:44,  2.81it/s] 74%|███████▎  | 347/471 [01:53<00:45,  2.73it/s] 74%|███████▍  | 348/471 [01:54<00:45,  2.67it/s] 74%|███████▍  | 349/471 [01:54<00:44,  2.77it/s] 74%|███████▍  | 350/471 [01:54<00:38,  3.12it/s] 75%|███████▍  | 351/471 [01:54<00:33,  3.53it/s] 75%|███████▍  | 352/471 [01:55<00:30,  3.87it/s] 75%|███████▍  | 353/471 [01:55<00:28,  4.17it/s] 75%|███████▌  | 354/471 [01:55<00:28,  4.15it/s] 75%|███████▌  | 355/471 [01:55<00:33,  3.42it/s] 76%|███████▌  | 356/471 [01:56<00:36,  3.16it/s] 76%|███████▌  | 357/471 [01:56<00:36,  3.14it/s] 76%|███████▌  | 358/471 [01:56<00:37,  2.98it/s] 76%|███████▌  | 359/471 [01:57<00:39,  2.82it/s] 76%|███████▋  | 360/471 [01:57<00:38,  2.88it/s] 77%|███████▋  | 361/471 [01:57<00:38,  2.88it/s] 77%|███████▋  | 362/471 [01:58<00:40,  2.70it/s] 77%|███████▋  | 363/471 [01:58<00:38,  2.80it/s] 77%|███████▋  | 364/471 [01:59<00:37,  2.87it/s] 77%|███████▋  | 365/471 [01:59<00:39,  2.67it/s] 78%|███████▊  | 366/471 [01:59<00:38,  2.74it/s] 78%|███████▊  | 367/471 [02:00<00:36,  2.86it/s] 78%|███████▊  | 368/471 [02:00<00:38,  2.68it/s] 78%|███████▊  | 369/471 [02:00<00:37,  2.70it/s] 79%|███████▊  | 370/471 [02:01<00:35,  2.82it/s] 79%|███████▉  | 371/471 [02:01<00:36,  2.73it/s] 79%|███████▉  | 372/471 [02:02<00:37,  2.68it/s] 79%|███████▉  | 373/471 [02:02<00:35,  2.78it/s] 79%|███████▉  | 374/471 [02:02<00:34,  2.78it/s] 80%|███████▉  | 375/471 [02:03<00:36,  2.66it/s] 80%|███████▉  | 376/471 [02:03<00:34,  2.75it/s] 80%|████████  | 377/471 [02:03<00:31,  2.94it/s] 80%|████████  | 378/471 [02:04<00:33,  2.74it/s] 80%|████████  | 379/471 [02:04<00:33,  2.73it/s] 81%|████████  | 380/471 [02:04<00:32,  2.82it/s] 81%|████████  | 381/471 [02:05<00:31,  2.81it/s] 81%|████████  | 382/471 [02:05<00:33,  2.70it/s] 81%|████████▏ | 383/471 [02:06<00:31,  2.78it/s] 82%|████████▏ | 384/471 [02:06<00:30,  2.82it/s] 82%|████████▏ | 385/471 [02:06<00:32,  2.66it/s] 82%|████████▏ | 386/471 [02:07<00:30,  2.76it/s] 82%|████████▏ | 387/471 [02:07<00:29,  2.86it/s] 82%|████████▏ | 388/471 [02:07<00:30,  2.69it/s] 83%|████████▎ | 389/471 [02:08<00:29,  2.75it/s] 83%|████████▎ | 390/471 [02:08<00:27,  2.90it/s] 83%|████████▎ | 391/471 [02:08<00:29,  2.72it/s] 83%|████████▎ | 392/471 [02:09<00:29,  2.69it/s] 83%|████████▎ | 393/471 [02:09<00:28,  2.78it/s] 84%|████████▎ | 394/471 [02:09<00:27,  2.78it/s] 84%|████████▍ | 395/471 [02:10<00:28,  2.67it/s] 84%|████████▍ | 396/471 [02:10<00:27,  2.77it/s] 84%|████████▍ | 397/471 [02:11<00:26,  2.81it/s] 85%|████████▍ | 398/471 [02:11<00:27,  2.65it/s] 85%|████████▍ | 399/471 [02:11<00:26,  2.74it/s] 85%|████████▍ | 400/471 [02:12<00:24,  2.88it/s] 85%|████████▌ | 401/471 [02:12<00:25,  2.78it/s] 85%|████████▌ | 402/471 [02:12<00:25,  2.72it/s] 86%|████████▌ | 403/471 [02:13<00:24,  2.81it/s] 86%|████████▌ | 404/471 [02:13<00:23,  2.82it/s] 86%|████████▌ | 405/471 [02:14<00:24,  2.67it/s] 86%|████████▌ | 406/471 [02:14<00:23,  2.78it/s] 86%|████████▋ | 407/471 [02:14<00:22,  2.85it/s] 87%|████████▋ | 408/471 [02:15<00:23,  2.68it/s] 87%|████████▋ | 409/471 [02:15<00:22,  2.74it/s] 87%|████████▋ | 410/471 [02:15<00:21,  2.87it/s] 87%|████████▋ | 411/471 [02:16<00:22,  2.69it/s] 87%|████████▋ | 412/471 [02:16<00:21,  2.71it/s] 88%|████████▊ | 413/471 [02:16<00:20,  2.84it/s] 88%|████████▊ | 414/471 [02:17<00:20,  2.75it/s] 88%|████████▊ | 415/471 [02:17<00:20,  2.69it/s] 88%|████████▊ | 416/471 [02:17<00:19,  2.77it/s] 89%|████████▊ | 417/471 [02:18<00:19,  2.79it/s] 89%|████████▊ | 418/471 [02:18<00:19,  2.66it/s] 89%|████████▉ | 419/471 [02:19<00:18,  2.77it/s] 89%|████████▉ | 420/471 [02:19<00:18,  2.83it/s] 89%|████████▉ | 421/471 [02:19<00:18,  2.66it/s] 90%|████████▉ | 422/471 [02:20<00:17,  2.76it/s] 90%|████████▉ | 423/471 [02:20<00:16,  2.89it/s] 90%|█████████ | 424/471 [02:20<00:16,  2.81it/s] 90%|█████████ | 425/471 [02:21<00:16,  2.73it/s] 90%|█████████ | 426/471 [02:21<00:15,  2.82it/s] 91%|█████████ | 427/471 [02:21<00:15,  2.85it/s] 91%|█████████ | 428/471 [02:22<00:16,  2.68it/s] 91%|█████████ | 429/471 [02:22<00:15,  2.77it/s] 91%|█████████▏| 430/471 [02:22<00:14,  2.87it/s] 92%|█████████▏| 431/471 [02:23<00:14,  2.68it/s] 92%|█████████▏| 432/471 [02:23<00:14,  2.73it/s] 92%|█████████▏| 433/471 [02:24<00:13,  2.88it/s] 92%|█████████▏| 434/471 [02:24<00:13,  2.71it/s] 92%|█████████▏| 435/471 [02:24<00:13,  2.69it/s] 93%|█████████▎| 436/471 [02:25<00:12,  2.78it/s] 93%|█████████▎| 437/471 [02:25<00:12,  2.76it/s] 93%|█████████▎| 438/471 [02:25<00:12,  2.65it/s] 93%|█████████▎| 439/471 [02:26<00:11,  2.76it/s] 93%|█████████▎| 440/471 [02:26<00:11,  2.81it/s] 94%|█████████▎| 441/471 [02:27<00:11,  2.66it/s] 94%|█████████▍| 442/471 [02:27<00:10,  2.77it/s] 94%|█████████▍| 443/471 [02:27<00:09,  2.85it/s] 94%|█████████▍| 444/471 [02:28<00:10,  2.67it/s] 94%|█████████▍| 445/471 [02:28<00:09,  2.74it/s] 95%|█████████▍| 446/471 [02:28<00:08,  2.88it/s] 95%|█████████▍| 447/471 [02:29<00:07,  3.29it/s] 95%|█████████▌| 448/471 [02:29<00:06,  3.66it/s] 95%|█████████▌| 449/471 [02:29<00:05,  4.01it/s] 96%|█████████▌| 450/471 [02:29<00:04,  4.30it/s] 96%|█████████▌| 451/471 [02:29<00:04,  4.54it/s] 96%|█████████▌| 452/471 [02:29<00:03,  4.75it/s] 96%|█████████▌| 453/471 [02:30<00:03,  4.88it/s] 96%|█████████▋| 454/471 [02:30<00:03,  4.96it/s] 97%|█████████▋| 455/471 [02:30<00:03,  5.03it/s] 97%|█████████▋| 456/471 [02:30<00:02,  5.09it/s] 97%|█████████▋| 457/471 [02:30<00:02,  5.14it/s] 97%|█████████▋| 458/471 [02:31<00:02,  5.18it/s] 97%|█████████▋| 459/471 [02:31<00:02,  5.20it/s] 98%|█████████▊| 460/471 [02:31<00:02,  5.21it/s] 98%|█████████▊| 461/471 [02:31<00:01,  5.22it/s] 98%|█████████▊| 462/471 [02:31<00:01,  5.22it/s] 98%|█████████▊| 463/471 [02:32<00:01,  5.21it/s] 99%|█████████▊| 464/471 [02:32<00:01,  5.22it/s] 99%|█████████▊| 465/471 [02:32<00:01,  5.22it/s] 99%|█████████▉| 466/471 [02:32<00:00,  5.23it/s] 99%|█████████▉| 467/471 [02:32<00:00,  5.23it/s] 99%|█████████▉| 468/471 [02:33<00:00,  5.22it/s]100%|█████████▉| 469/471 [02:33<00:00,  5.22it/s]100%|█████████▉| 470/471 [02:33<00:00,  5.22it/s]100%|██████████| 471/471 [02:33<00:00,  5.57it/s]100%|██████████| 471/471 [02:33<00:00,  3.07it/s]
{'eval_loss': 2.9253087043762207, 'eval_model_preparation_time': 0.0129, 'eval_acc': 0.32846521508231546, 'eval_runtime': 153.8936, 'eval_samples_per_second': 48.943, 'eval_steps_per_second': 3.061}
ROUND:13
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]                                              {'loss': 2.6499, 'grad_norm': 8.774642944335938, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]                                              {'loss': 3.0045, 'grad_norm': 12.091608047485352, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:01<00:23,  1.54it/s]                                              {'loss': 1.4286, 'grad_norm': 11.308815002441406, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.54it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s]                                              {'loss': 1.3983, 'grad_norm': 11.374188423156738, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s]                                              {'loss': 2.03, 'grad_norm': 19.749515533447266, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s]                                              {'loss': 1.5543, 'grad_norm': 16.723262786865234, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 2.1997, 'grad_norm': 19.53244972229004, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s] 20%|██        | 8/40 [00:04<00:16,  2.00it/s]                                              {'loss': 1.8652, 'grad_norm': 2.604078769683838, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  2.00it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.77it/s]                                              {'loss': 0.6277, 'grad_norm': 9.45222282409668, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.77it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s]                                               {'loss': 0.7379, 'grad_norm': 3.961153984069824, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.62it/s]                                               {'loss': 1.2443, 'grad_norm': 9.036405563354492, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.62it/s] 30%|███       | 12/40 [00:07<00:16,  1.69it/s]                                               {'loss': 1.3059, 'grad_norm': 8.744565963745117, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.69it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.59it/s]                                               {'loss': 0.4699, 'grad_norm': 7.213013172149658, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.59it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s]                                               {'loss': 0.8857, 'grad_norm': 5.976524353027344, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.4567, 'grad_norm': 5.973872661590576, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 2.9821, 'grad_norm': 46.7711181640625, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.54it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.87it/s]                                               {'loss': 0.5569, 'grad_norm': 4.335902690887451, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.87it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.75it/s]                                               {'loss': 0.2419, 'grad_norm': 2.740309238433838, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.75it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.71it/s]                                               {'loss': 0.3941, 'grad_norm': 5.483879566192627, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.71it/s] 50%|█████     | 20/40 [00:12<00:12,  1.59it/s]                                               {'loss': 0.7391, 'grad_norm': 6.846318244934082, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.59it/s] 52%|█████▎    | 21/40 [00:12<00:12,  1.57it/s]                                               {'loss': 0.2944, 'grad_norm': 8.104304313659668, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.54it/s]                                               {'loss': 0.7422, 'grad_norm': 8.829151153564453, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.54it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.50it/s]                                               {'loss': 1.2519, 'grad_norm': 14.401399612426758, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.50it/s]                                               {'loss': 0.0096, 'grad_norm': 0.5925923585891724, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.50it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.93it/s]                                               {'loss': 0.2636, 'grad_norm': 3.334301471710205, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.93it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.78it/s]                                               {'loss': 0.8028, 'grad_norm': 7.54541540145874, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.78it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s]                                               {'loss': 0.1792, 'grad_norm': 4.222835063934326, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s] 70%|███████   | 28/40 [00:17<00:07,  1.68it/s]                                               {'loss': 0.1778, 'grad_norm': 4.041126728057861, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.68it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.58it/s]                                               {'loss': 0.4539, 'grad_norm': 3.2205333709716797, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.58it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s]                                               {'loss': 0.6114, 'grad_norm': 3.730466842651367, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.54it/s]                                               {'loss': 0.3977, 'grad_norm': 3.5189309120178223, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.54it/s]                                               {'loss': 0.1336, 'grad_norm': 11.519734382629395, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.54it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.87it/s]                                               {'loss': 0.0762, 'grad_norm': 1.0140597820281982, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.87it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.76it/s]                                               {'loss': 0.1193, 'grad_norm': 1.4919085502624512, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s]                                               {'loss': 0.1767, 'grad_norm': 2.508371353149414, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s]                                               {'loss': 1.0797, 'grad_norm': 1.1483137607574463, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.65it/s]                                               {'loss': 0.1905, 'grad_norm': 1.2697861194610596, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.65it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.56it/s]                                               {'loss': 0.1288, 'grad_norm': 3.378340244293213, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]                                               {'loss': 0.164, 'grad_norm': 4.130763053894043, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]100%|██████████| 40/40 [00:23<00:00,  2.05it/s]                                               {'loss': 0.0035, 'grad_norm': 0.28137096762657166, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.05it/s]                                               {'train_runtime': 24.23, 'train_samples_per_second': 23.318, 'train_steps_per_second': 1.651, 'train_loss': 0.850728841527598, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.05it/s]100%|██████████| 40/40 [00:24<00:00,  1.65it/s]
CLIENT:74
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.79it/s]                                              {'loss': 1.9883, 'grad_norm': 8.925856590270996, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.79it/s]  5%|▌         | 2/40 [00:00<00:13,  2.89it/s]                                              {'loss': 1.8256, 'grad_norm': 10.377410888671875, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.89it/s]  8%|▊         | 3/40 [00:01<00:12,  2.90it/s]                                              {'loss': 1.1357, 'grad_norm': 16.41145896911621, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.90it/s] 10%|█         | 4/40 [00:01<00:12,  2.95it/s]                                              {'loss': 2.6, 'grad_norm': 29.186439514160156, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.95it/s] 12%|█▎        | 5/40 [00:01<00:14,  2.50it/s]                                              {'loss': 1.7821, 'grad_norm': 14.705089569091797, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:14,  2.50it/s] 15%|█▌        | 6/40 [00:02<00:16,  2.03it/s]                                              {'loss': 1.3341, 'grad_norm': 19.282732009887695, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:16,  2.03it/s] 18%|█▊        | 7/40 [00:03<00:18,  1.77it/s]                                              {'loss': 1.5049, 'grad_norm': 15.271339416503906, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:18,  1.77it/s]                                              {'loss': 0.7255, 'grad_norm': 31.352161407470703, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:18,  1.77it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.09it/s]                                              {'loss': 0.3526, 'grad_norm': 5.9104156494140625, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.09it/s] 25%|██▌       | 10/40 [00:04<00:15,  1.91it/s]                                               {'loss': 0.47, 'grad_norm': 7.366846561431885, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:15,  1.91it/s] 28%|██▊       | 11/40 [00:05<00:16,  1.74it/s]                                               {'loss': 0.6555, 'grad_norm': 8.976068496704102, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:16,  1.74it/s] 30%|███       | 12/40 [00:06<00:16,  1.72it/s]                                               {'loss': 0.7737, 'grad_norm': 10.057385444641113, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:16,  1.72it/s] 32%|███▎      | 13/40 [00:06<00:16,  1.62it/s]                                               {'loss': 0.5097, 'grad_norm': 5.685616493225098, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.62it/s] 35%|███▌      | 14/40 [00:07<00:16,  1.55it/s]                                               {'loss': 0.53, 'grad_norm': 5.23628568649292, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:16,  1.55it/s] 38%|███▊      | 15/40 [00:08<00:15,  1.59it/s]                                               {'loss': 0.9888, 'grad_norm': 9.559782981872559, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:15,  1.59it/s]                                               {'loss': 0.0696, 'grad_norm': 2.793748617172241, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:15,  1.59it/s] 42%|████▎     | 17/40 [00:08<00:12,  1.90it/s]                                               {'loss': 0.2023, 'grad_norm': 6.256446838378906, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:12,  1.90it/s] 45%|████▌     | 18/40 [00:09<00:12,  1.80it/s]                                               {'loss': 0.6022, 'grad_norm': 4.587251663208008, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:12,  1.80it/s] 48%|████▊     | 19/40 [00:10<00:12,  1.71it/s]                                               {'loss': 0.2595, 'grad_norm': 8.722805976867676, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:12,  1.71it/s] 50%|█████     | 20/40 [00:10<00:12,  1.61it/s]                                               {'loss': 0.211, 'grad_norm': 4.686712265014648, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:12,  1.61it/s] 52%|█████▎    | 21/40 [00:11<00:11,  1.62it/s]                                               {'loss': 0.1181, 'grad_norm': 2.5264434814453125, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:11,  1.62it/s] 55%|█████▌    | 22/40 [00:12<00:11,  1.55it/s]                                               {'loss': 0.5865, 'grad_norm': 6.720459461212158, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:11,  1.55it/s] 57%|█████▊    | 23/40 [00:12<00:11,  1.53it/s]                                               {'loss': 0.1122, 'grad_norm': 3.5187950134277344, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:11,  1.53it/s]                                               {'loss': 0.003, 'grad_norm': 0.22432607412338257, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:13<00:07,  1.94it/s]                                               {'loss': 0.2656, 'grad_norm': 3.3499081134796143, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:07,  1.94it/s] 65%|██████▌   | 26/40 [00:14<00:07,  1.78it/s]                                               {'loss': 0.1562, 'grad_norm': 5.653820514678955, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:07,  1.78it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.67it/s]                                               {'loss': 0.1731, 'grad_norm': 2.1985020637512207, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.67it/s] 70%|███████   | 28/40 [00:15<00:07,  1.67it/s]                                               {'loss': 0.1022, 'grad_norm': 2.3471662998199463, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.67it/s] 72%|███████▎  | 29/40 [00:16<00:07,  1.57it/s]                                               {'loss': 0.1538, 'grad_norm': 2.5824661254882812, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:07,  1.57it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.61it/s]                                               {'loss': 0.0401, 'grad_norm': 0.5382505655288696, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.61it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.55it/s]                                               {'loss': 0.1881, 'grad_norm': 2.60516619682312, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.55it/s]                                               {'loss': 0.0897, 'grad_norm': 7.107343673706055, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.55it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.87it/s]                                               {'loss': 0.0372, 'grad_norm': 1.5755641460418701, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.87it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.81it/s]                                               {'loss': 0.1717, 'grad_norm': 4.492478847503662, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.81it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.68it/s]                                               {'loss': 0.2178, 'grad_norm': 1.6030876636505127, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.68it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.61it/s]                                               {'loss': 0.0509, 'grad_norm': 0.860709547996521, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:21<00:01,  1.62it/s]                                               {'loss': 0.1096, 'grad_norm': 1.1866189241409302, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  1.62it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.54it/s]                                               {'loss': 0.0509, 'grad_norm': 0.8137686252593994, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.54it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.53it/s]                                               {'loss': 0.0562, 'grad_norm': 1.441381573677063, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.53it/s]100%|██████████| 40/40 [00:22<00:00,  2.03it/s]                                               {'loss': 0.0306, 'grad_norm': 0.6888505816459656, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.03it/s]                                               {'train_runtime': 22.7367, 'train_samples_per_second': 24.85, 'train_steps_per_second': 1.759, 'train_loss': 0.5308626395417377, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.03it/s]100%|██████████| 40/40 [00:22<00:00,  1.76it/s]
CLIENT:15
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]                                              {'loss': 3.0671, 'grad_norm': 12.629183769226074, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]  5%|▌         | 2/40 [00:01<00:24,  1.55it/s]                                              {'loss': 0.7824, 'grad_norm': 7.918994426727295, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.55it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s]                                              {'loss': 1.7894, 'grad_norm': 10.249510765075684, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 1.9254, 'grad_norm': 16.025056838989258, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 0.8906, 'grad_norm': 15.46529483795166, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s]                                              {'loss': 1.7846, 'grad_norm': 17.607440948486328, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s]                                              {'loss': 2.4321, 'grad_norm': 20.469329833984375, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s] 20%|██        | 8/40 [00:05<00:18,  1.71it/s]                                              {'loss': 0.1534, 'grad_norm': 12.542896270751953, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:18,  1.71it/s] 22%|██▎       | 9/40 [00:05<00:19,  1.59it/s]                                              {'loss': 0.9907, 'grad_norm': 12.475869178771973, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:19,  1.59it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s]                                               {'loss': 0.4738, 'grad_norm': 6.36404275894165, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s] 28%|██▊       | 11/40 [00:06<00:15,  1.91it/s]                                               {'loss': 0.7799, 'grad_norm': 9.795855522155762, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:15,  1.91it/s] 30%|███       | 12/40 [00:07<00:13,  2.14it/s]                                               {'loss': 1.2855, 'grad_norm': 7.112358570098877, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:13,  2.14it/s] 32%|███▎      | 13/40 [00:07<00:11,  2.33it/s]                                               {'loss': 0.5299, 'grad_norm': 7.31733512878418, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:11,  2.33it/s] 35%|███▌      | 14/40 [00:07<00:10,  2.48it/s]                                               {'loss': 0.9243, 'grad_norm': 7.780025959014893, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:10,  2.48it/s] 38%|███▊      | 15/40 [00:08<00:09,  2.62it/s]                                               {'loss': 0.7918, 'grad_norm': 2.5788004398345947, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:09,  2.62it/s]                                               {'loss': 0.2938, 'grad_norm': 23.288131713867188, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:09,  2.62it/s] 42%|████▎     | 17/40 [00:08<00:06,  3.38it/s]                                               {'loss': 0.456, 'grad_norm': 4.526804447174072, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:06,  3.38it/s] 45%|████▌     | 18/40 [00:08<00:06,  3.24it/s]                                               {'loss': 0.1823, 'grad_norm': 3.4825453758239746, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:06,  3.24it/s] 48%|████▊     | 19/40 [00:09<00:07,  2.73it/s]                                               {'loss': 0.5229, 'grad_norm': 2.999445676803589, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:07,  2.73it/s] 50%|█████     | 20/40 [00:10<00:09,  2.13it/s]                                               {'loss': 0.2579, 'grad_norm': 3.3257641792297363, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:09,  2.13it/s] 52%|█████▎    | 21/40 [00:10<00:10,  1.81it/s]                                               {'loss': 0.1365, 'grad_norm': 3.231581449508667, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:10,  1.81it/s] 55%|█████▌    | 22/40 [00:11<00:10,  1.65it/s]                                               {'loss': 0.3869, 'grad_norm': 6.27419376373291, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:10,  1.65it/s] 57%|█████▊    | 23/40 [00:12<00:10,  1.55it/s]                                               {'loss': 1.3591, 'grad_norm': 5.615071773529053, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:10,  1.55it/s]                                               {'loss': 0.0594, 'grad_norm': 2.9145007133483887, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.55it/s] 62%|██████▎   | 25/40 [00:13<00:08,  1.85it/s]                                               {'loss': 0.7168, 'grad_norm': 2.7656354904174805, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:08,  1.85it/s] 65%|██████▌   | 26/40 [00:13<00:08,  1.69it/s]                                               {'loss': 0.1275, 'grad_norm': 1.6178611516952515, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:08,  1.69it/s] 68%|██████▊   | 27/40 [00:14<00:08,  1.59it/s]                                               {'loss': 0.0524, 'grad_norm': 1.770309567451477, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:08,  1.59it/s] 70%|███████   | 28/40 [00:15<00:07,  1.51it/s]                                               {'loss': 0.1262, 'grad_norm': 2.4629034996032715, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.51it/s] 72%|███████▎  | 29/40 [00:16<00:07,  1.46it/s]                                               {'loss': 0.5423, 'grad_norm': 7.186522006988525, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:07,  1.46it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.43it/s]                                               {'loss': 0.8628, 'grad_norm': 3.40871524810791, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.43it/s] 78%|███████▊  | 31/40 [00:17<00:06,  1.40it/s]                                               {'loss': 0.3232, 'grad_norm': 5.497550010681152, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:06,  1.40it/s]                                               {'loss': 0.0678, 'grad_norm': 5.3450212478637695, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.40it/s] 82%|████████▎ | 33/40 [00:18<00:04,  1.72it/s]                                               {'loss': 0.0691, 'grad_norm': 0.9612292051315308, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.61it/s]                                               {'loss': 0.0908, 'grad_norm': 1.155014157295227, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.61it/s] 88%|████████▊ | 35/40 [00:19<00:03,  1.53it/s]                                               {'loss': 0.6511, 'grad_norm': 4.1523308753967285, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.47it/s]                                               {'loss': 0.539, 'grad_norm': 1.042992353439331, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:21<00:02,  1.43it/s]                                               {'loss': 0.2502, 'grad_norm': 8.9782075881958, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.41it/s]                                               {'loss': 0.13, 'grad_norm': 1.5466452836990356, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.39it/s]                                               {'loss': 0.0501, 'grad_norm': 1.3943946361541748, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.39it/s]100%|██████████| 40/40 [00:23<00:00,  1.85it/s]                                               {'loss': 0.0508, 'grad_norm': 4.232724189758301, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.85it/s]                                               {'train_runtime': 23.2787, 'train_samples_per_second': 24.271, 'train_steps_per_second': 1.718, 'train_loss': 0.6726395833306015, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.85it/s]100%|██████████| 40/40 [00:23<00:00,  1.72it/s]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]                                              {'loss': 3.5431, 'grad_norm': 16.236867904663086, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 0.9444, 'grad_norm': 8.965559005737305, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:02<00:27,  1.33it/s]                                              {'loss': 0.9771, 'grad_norm': 9.085075378417969, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.33it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 1.6019, 'grad_norm': 11.62627124786377, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s]                                              {'loss': 1.7368, 'grad_norm': 15.04276180267334, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s]                                              {'loss': 0.5883, 'grad_norm': 8.02895450592041, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 2.6612, 'grad_norm': 18.728872299194336, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 1.8974, 'grad_norm': 70.72074127197266, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.34it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s]                                              {'loss': 1.2939, 'grad_norm': 11.49749755859375, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.70it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s]                                               {'loss': 0.7829, 'grad_norm': 11.220511436462402, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s]                                               {'loss': 0.6582, 'grad_norm': 7.660856246948242, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s] 30%|███       | 12/40 [00:08<00:19,  1.47it/s]                                               {'loss': 0.6752, 'grad_norm': 12.928898811340332, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.42it/s]                                               {'loss': 0.7971, 'grad_norm': 5.615441799163818, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.42it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s]                                               {'loss': 0.6738, 'grad_norm': 6.7083892822265625, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.40it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.6609, 'grad_norm': 5.1220784187316895, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.548, 'grad_norm': 19.33591651916504, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.38it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.70it/s]                                               {'loss': 0.2396, 'grad_norm': 4.756899833679199, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.70it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s]                                               {'loss': 0.3621, 'grad_norm': 3.127627372741699, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s]                                               {'loss': 0.6427, 'grad_norm': 3.491610527038574, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.52it/s] 50%|█████     | 20/40 [00:13<00:13,  1.47it/s]                                               {'loss': 0.5102, 'grad_norm': 9.341419219970703, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.539, 'grad_norm': 5.583128452301025, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.5716, 'grad_norm': 8.441340446472168, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.674, 'grad_norm': 8.386319160461426, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.3044, 'grad_norm': 15.776595115661621, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.70it/s]                                               {'loss': 0.453, 'grad_norm': 5.570809364318848, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.70it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s]                                               {'loss': 0.0643, 'grad_norm': 1.773537039756775, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s]                                               {'loss': 0.1509, 'grad_norm': 4.839524745941162, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s] 70%|███████   | 28/40 [00:18<00:08,  1.47it/s]                                               {'loss': 0.3284, 'grad_norm': 3.5747108459472656, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.42it/s]                                               {'loss': 0.0916, 'grad_norm': 2.3341064453125, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.40it/s]                                               {'loss': 0.4231, 'grad_norm': 8.332443237304688, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.3078, 'grad_norm': 2.145305633544922, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.0014, 'grad_norm': 0.06808038055896759, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.72it/s]                                               {'loss': 0.4109, 'grad_norm': 1.0837454795837402, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s]                                               {'loss': 0.0402, 'grad_norm': 0.7609803080558777, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:22<00:03,  1.60it/s] 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s]                                               {'loss': 0.242, 'grad_norm': 1.1213490962982178, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:23<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s]                                               {'loss': 0.1514, 'grad_norm': 2.9195191860198975, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s]                                               {'loss': 0.046, 'grad_norm': 1.0934350490570068, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:25<00:01,  1.40it/s]                                               {'loss': 0.0284, 'grad_norm': 0.5642346739768982, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:25<00:01,  1.40it/s] 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.236, 'grad_norm': 2.82686185836792, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:26<00:00,  1.38it/s]                                               {'loss': 0.0097, 'grad_norm': 0.6508486866950989, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]                                               {'train_runtime': 26.8576, 'train_samples_per_second': 21.037, 'train_steps_per_second': 1.489, 'train_loss': 0.671724084104062, 'epoch': 5.0}
100%|██████████| 40/40 [00:26<00:00,  1.38it/s]100%|██████████| 40/40 [00:26<00:00,  1.49it/s]
CLIENT:32
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:51,  1.31s/it]                                              {'loss': 2.9443, 'grad_norm': 10.04719352722168, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:51,  1.31s/it]  5%|▌         | 2/40 [00:02<00:37,  1.02it/s]                                              {'loss': 2.2973, 'grad_norm': 9.964273452758789, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.02it/s]  8%|▊         | 3/40 [00:02<00:32,  1.14it/s]                                              {'loss': 3.6049, 'grad_norm': 22.137039184570312, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.14it/s] 10%|█         | 4/40 [00:03<00:29,  1.21it/s]                                              {'loss': 2.0485, 'grad_norm': 17.20826530456543, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:29,  1.21it/s] 12%|█▎        | 5/40 [00:04<00:28,  1.25it/s]                                              {'loss': 1.8255, 'grad_norm': 13.786599159240723, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:28,  1.25it/s] 15%|█▌        | 6/40 [00:05<00:26,  1.28it/s]                                              {'loss': 2.5899, 'grad_norm': 25.103744506835938, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:26,  1.28it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 1.8266, 'grad_norm': 14.59125804901123, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 0.4464, 'grad_norm': 23.437992095947266, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:24,  1.30it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.66it/s]                                              {'loss': 1.1784, 'grad_norm': 12.670319557189941, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.66it/s] 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s]                                               {'loss': 1.1354, 'grad_norm': 12.342118263244629, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s]                                               {'loss': 0.7339, 'grad_norm': 7.541403293609619, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s]                                               {'loss': 1.2477, 'grad_norm': 6.859303951263428, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s]                                               {'loss': 1.0781, 'grad_norm': 10.061421394348145, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s]                                               {'loss': 1.1493, 'grad_norm': 6.291324615478516, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.37it/s]                                               {'loss': 1.7595, 'grad_norm': 9.651663780212402, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.37it/s]                                               {'loss': 0.5382, 'grad_norm': 20.44336700439453, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.37it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.70it/s]                                               {'loss': 0.7428, 'grad_norm': 6.295216083526611, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.70it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s]                                               {'loss': 0.2965, 'grad_norm': 3.4737682342529297, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.60it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s]                                               {'loss': 0.888, 'grad_norm': 5.435402870178223, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.4302, 'grad_norm': 3.904524803161621, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.4379, 'grad_norm': 3.5253660678863525, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.5024, 'grad_norm': 4.5703558921813965, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.5824, 'grad_norm': 7.6763386726379395, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 3.37, 'grad_norm': 1.9075368642807007, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.37it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.71it/s]                                               {'loss': 0.1708, 'grad_norm': 1.6631306409835815, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.71it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s]                                               {'loss': 0.5717, 'grad_norm': 3.635209560394287, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s]                                               {'loss': 0.2876, 'grad_norm': 1.5489236116409302, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.52it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.2165, 'grad_norm': 4.157468795776367, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.1418, 'grad_norm': 2.1684443950653076, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s]                                               {'loss': 0.0605, 'grad_norm': 1.2735298871994019, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.37it/s]                                               {'loss': 0.3153, 'grad_norm': 1.8396950960159302, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.37it/s]                                               {'loss': 0.6513, 'grad_norm': 10.857017517089844, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.37it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.69it/s]                                               {'loss': 0.0974, 'grad_norm': 1.4738140106201172, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.69it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s]                                               {'loss': 0.1057, 'grad_norm': 1.5635583400726318, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.52it/s]                                               {'loss': 0.2697, 'grad_norm': 1.3145240545272827, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.52it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s]                                               {'loss': 0.2231, 'grad_norm': 0.7987218499183655, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s]                                               {'loss': 0.0284, 'grad_norm': 0.5964765548706055, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s]                                               {'loss': 0.2901, 'grad_norm': 0.8399443030357361, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.38it/s]                                               {'loss': 0.1729, 'grad_norm': 7.007017135620117, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.38it/s]                                               {'loss': 0.0043, 'grad_norm': 0.318283349275589, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.38it/s]                                               {'train_runtime': 27.5137, 'train_samples_per_second': 20.535, 'train_steps_per_second': 1.454, 'train_loss': 0.9315297377412207, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.38it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
CLIENT:59
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]                                              {'loss': 2.5095, 'grad_norm': 9.41538143157959, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]  5%|▌         | 2/40 [00:01<00:29,  1.31it/s]                                              {'loss': 2.2144, 'grad_norm': 10.146186828613281, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:29,  1.31it/s]  8%|▊         | 3/40 [00:02<00:28,  1.32it/s]                                              {'loss': 1.0809, 'grad_norm': 11.578511238098145, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.32it/s] 10%|█         | 4/40 [00:03<00:27,  1.31it/s]                                              {'loss': 0.8747, 'grad_norm': 15.000533103942871, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.31it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.31it/s]                                              {'loss': 1.0881, 'grad_norm': 14.460914611816406, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.31it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.31it/s]                                              {'loss': 0.9765, 'grad_norm': 11.85859489440918, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.31it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.32it/s]                                              {'loss': 2.3667, 'grad_norm': 14.478615760803223, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.32it/s] 20%|██        | 8/40 [00:06<00:23,  1.36it/s]                                              {'loss': 7.0635, 'grad_norm': 110.9319839477539, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:23,  1.36it/s] 22%|██▎       | 9/40 [00:06<00:22,  1.36it/s]                                              {'loss': 1.3652, 'grad_norm': 8.988092422485352, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:22,  1.36it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.36it/s]                                               {'loss': 1.5644, 'grad_norm': 16.493227005004883, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.36it/s] 28%|██▊       | 11/40 [00:08<00:21,  1.34it/s]                                               {'loss': 0.4157, 'grad_norm': 4.632560729980469, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:21,  1.34it/s] 30%|███       | 12/40 [00:09<00:20,  1.34it/s]                                               {'loss': 0.832, 'grad_norm': 5.52158784866333, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:20,  1.34it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s]                                               {'loss': 0.6275, 'grad_norm': 7.199139595031738, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s]                                               {'loss': 0.3261, 'grad_norm': 5.3812432289123535, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.3247, 'grad_norm': 6.056882858276367, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 1.266, 'grad_norm': 16.27098846435547, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.33it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s]                                               {'loss': 0.4321, 'grad_norm': 4.828518390655518, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s]                                               {'loss': 0.263, 'grad_norm': 5.52810001373291, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.50it/s]                                               {'loss': 0.2795, 'grad_norm': 3.6034021377563477, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.50it/s] 50%|█████     | 20/40 [00:14<00:13,  1.44it/s]                                               {'loss': 0.2972, 'grad_norm': 2.98181414604187, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.41it/s]                                               {'loss': 0.7115, 'grad_norm': 4.250519275665283, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.41it/s] 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s]                                               {'loss': 0.5947, 'grad_norm': 6.014983654022217, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.802, 'grad_norm': 5.86940860748291, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.1983, 'grad_norm': 4.989887714385986, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.37it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s]                                               {'loss': 0.143, 'grad_norm': 2.6846139430999756, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s]                                               {'loss': 0.1692, 'grad_norm': 4.124119281768799, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s]                                               {'loss': 0.0877, 'grad_norm': 1.3994452953338623, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s]                                               {'loss': 0.5253, 'grad_norm': 0.7424634099006653, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.332, 'grad_norm': 0.8629180192947388, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s]                                               {'loss': 0.5674, 'grad_norm': 9.016268730163574, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.4376, 'grad_norm': 9.454203605651855, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.0419, 'grad_norm': 2.3059098720550537, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.37it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.69it/s]                                               {'loss': 0.0395, 'grad_norm': 0.6978936791419983, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.69it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.57it/s]                                               {'loss': 0.559, 'grad_norm': 1.4471452236175537, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.57it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s]                                               {'loss': 0.0489, 'grad_norm': 0.8585255146026611, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.44it/s]                                               {'loss': 0.2968, 'grad_norm': 17.02728271484375, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.41it/s]                                               {'loss': 0.087, 'grad_norm': 2.7023863792419434, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.41it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s]                                               {'loss': 0.0496, 'grad_norm': 2.0449531078338623, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.2962, 'grad_norm': 1.211409330368042, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.0012, 'grad_norm': 0.14239118993282318, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]                                               {'train_runtime': 27.7573, 'train_samples_per_second': 20.355, 'train_steps_per_second': 1.441, 'train_loss': 0.8039205085893627, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]100%|██████████| 40/40 [00:27<00:00,  1.44it/s]
CLIENT:91
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:56,  1.44s/it]                                              {'loss': 3.0917, 'grad_norm': 10.33315372467041, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:56,  1.44s/it]  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]                                              {'loss': 2.096, 'grad_norm': 13.719536781311035, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]  8%|▊         | 3/40 [00:02<00:33,  1.10it/s]                                              {'loss': 1.9986, 'grad_norm': 13.457558631896973, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:33,  1.10it/s] 10%|█         | 4/40 [00:03<00:30,  1.17it/s]                                              {'loss': 1.4, 'grad_norm': 12.575859069824219, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:30,  1.17it/s] 12%|█▎        | 5/40 [00:04<00:28,  1.23it/s]                                              {'loss': 3.3113, 'grad_norm': 16.883764266967773, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:28,  1.23it/s] 15%|█▌        | 6/40 [00:05<00:27,  1.26it/s]                                              {'loss': 1.1034, 'grad_norm': 16.728734970092773, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:27,  1.26it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.28it/s]                                              {'loss': 1.306, 'grad_norm': 15.326683044433594, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.28it/s] 20%|██        | 8/40 [00:06<00:18,  1.71it/s]                                              {'loss': 4.7694, 'grad_norm': 74.94569396972656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:18,  1.71it/s] 22%|██▎       | 9/40 [00:06<00:19,  1.57it/s]                                              {'loss': 0.4563, 'grad_norm': 5.345801830291748, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:19,  1.57it/s] 25%|██▌       | 10/40 [00:07<00:20,  1.47it/s]                                               {'loss': 0.9292, 'grad_norm': 10.00893783569336, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:08<00:20,  1.43it/s]                                               {'loss': 0.8956, 'grad_norm': 8.462589263916016, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:20,  1.43it/s] 30%|███       | 12/40 [00:09<00:20,  1.39it/s]                                               {'loss': 0.5825, 'grad_norm': 5.059263706207275, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:20,  1.39it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.38it/s]                                               {'loss': 0.7247, 'grad_norm': 6.808198928833008, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.38it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.36it/s]                                               {'loss': 1.0684, 'grad_norm': 7.086135387420654, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.36it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.35it/s]                                               {'loss': 0.8131, 'grad_norm': 5.125778675079346, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.35it/s]                                               {'loss': 0.1074, 'grad_norm': 4.935669422149658, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.35it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s]                                               {'loss': 0.106, 'grad_norm': 1.8219683170318604, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s] 45%|████▌     | 18/40 [00:13<00:13,  1.57it/s]                                               {'loss': 0.4012, 'grad_norm': 4.384924411773682, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:13,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.50it/s]                                               {'loss': 0.3976, 'grad_norm': 5.55067777633667, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.50it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.6588, 'grad_norm': 5.392156600952148, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s]                                               {'loss': 0.6275, 'grad_norm': 16.84454345703125, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s] 55%|█████▌    | 22/40 [00:16<00:12,  1.40it/s]                                               {'loss': 0.8981, 'grad_norm': 8.28852367401123, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.1965, 'grad_norm': 4.60098934173584, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.0008, 'grad_norm': 0.0588696263730526, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.37it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s]                                               {'loss': 0.218, 'grad_norm': 4.139699935913086, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.59it/s]                                               {'loss': 0.1023, 'grad_norm': 1.7585124969482422, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.59it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.51it/s]                                               {'loss': 0.1349, 'grad_norm': 2.096501350402832, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.51it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s]                                               {'loss': 0.4155, 'grad_norm': 2.8690006732940674, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.5533, 'grad_norm': 2.774336814880371, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s]                                               {'loss': 0.1716, 'grad_norm': 2.895597219467163, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.3398, 'grad_norm': 4.3668365478515625, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.3444, 'grad_norm': 13.101256370544434, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.36it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s]                                               {'loss': 0.3648, 'grad_norm': 1.756981611251831, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s]                                               {'loss': 0.1116, 'grad_norm': 3.3416249752044678, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s]                                               {'loss': 0.2775, 'grad_norm': 6.0773606300354, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.44it/s]                                               {'loss': 0.0919, 'grad_norm': 5.669336318969727, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.40it/s]                                               {'loss': 0.0669, 'grad_norm': 1.8987773656845093, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.40it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s]                                               {'loss': 0.4263, 'grad_norm': 0.9781436324119568, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0329, 'grad_norm': 1.3118456602096558, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]100%|██████████| 40/40 [00:27<00:00,  1.81it/s]                                               {'loss': 0.0557, 'grad_norm': 3.677680253982544, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.81it/s]                                               {'train_runtime': 27.9759, 'train_samples_per_second': 20.196, 'train_steps_per_second': 1.43, 'train_loss': 0.7911804254414164, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.81it/s]100%|██████████| 40/40 [00:27<00:00,  1.43it/s]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]                                              {'loss': 4.204, 'grad_norm': 10.757010459899902, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 1.299, 'grad_norm': 6.123023509979248, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:02<00:27,  1.32it/s]                                              {'loss': 1.0988, 'grad_norm': 8.003939628601074, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.32it/s] 10%|█         | 4/40 [00:03<00:27,  1.32it/s]                                              {'loss': 1.9169, 'grad_norm': 11.75814437866211, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.32it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s]                                              {'loss': 1.9549, 'grad_norm': 18.158592224121094, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s]                                              {'loss': 2.153, 'grad_norm': 17.199125289916992, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.32it/s]                                              {'loss': 1.7143, 'grad_norm': 11.83049488067627, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.32it/s] 20%|██        | 8/40 [00:06<00:24,  1.29it/s]                                              {'loss': 0.5214, 'grad_norm': 28.54959487915039, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:24,  1.29it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.31it/s]                                              {'loss': 0.5744, 'grad_norm': 5.24953031539917, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.31it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s]                                               {'loss': 1.6388, 'grad_norm': 7.1364312171936035, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s] 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s]                                               {'loss': 0.6234, 'grad_norm': 11.254043579101562, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s] 30%|███       | 12/40 [00:09<00:21,  1.32it/s]                                               {'loss': 0.5684, 'grad_norm': 7.867354393005371, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.32it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.31it/s]                                               {'loss': 1.0691, 'grad_norm': 7.6485700607299805, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.31it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s]                                               {'loss': 0.3127, 'grad_norm': 4.444709300994873, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.32it/s]                                               {'loss': 0.9144, 'grad_norm': 6.1319580078125, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.32it/s] 40%|████      | 16/40 [00:11<00:13,  1.78it/s]                                               {'loss': 2.1644, 'grad_norm': 23.05504608154297, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:13,  1.78it/s] 42%|████▎     | 17/40 [00:12<00:14,  1.62it/s]                                               {'loss': 0.5994, 'grad_norm': 2.0315160751342773, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:14,  1.62it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.52it/s]                                               {'loss': 0.548, 'grad_norm': 3.1321141719818115, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.52it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s]                                               {'loss': 1.019, 'grad_norm': 5.393960952758789, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.46it/s] 50%|█████     | 20/40 [00:14<00:14,  1.41it/s]                                               {'loss': 0.2693, 'grad_norm': 3.0701003074645996, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:14,  1.41it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.39it/s]                                               {'loss': 0.6894, 'grad_norm': 12.66361141204834, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.39it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.36it/s]                                               {'loss': 0.7302, 'grad_norm': 9.31562614440918, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.36it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.35it/s]                                               {'loss': 0.0989, 'grad_norm': 1.9022271633148193, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.35it/s]                                               {'loss': 0.0219, 'grad_norm': 1.5719796419143677, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.35it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.67it/s]                                               {'loss': 0.3478, 'grad_norm': 1.0265592336654663, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.67it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s]                                               {'loss': 0.6315, 'grad_norm': 1.901644229888916, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s]                                               {'loss': 0.2955, 'grad_norm': 5.884962558746338, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s] 70%|███████   | 28/40 [00:19<00:08,  1.44it/s]                                               {'loss': 0.1847, 'grad_norm': 3.6121983528137207, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.44it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.5785, 'grad_norm': 3.427013397216797, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s]                                               {'loss': 0.0899, 'grad_norm': 2.1518874168395996, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.0522, 'grad_norm': 2.231515645980835, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.1111, 'grad_norm': 13.925177574157715, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.36it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.67it/s]                                               {'loss': 0.0653, 'grad_norm': 1.2030607461929321, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.67it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.57it/s]                                               {'loss': 0.0192, 'grad_norm': 0.5174764394760132, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.57it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s]                                               {'loss': 0.3354, 'grad_norm': 1.8193869590759277, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.44it/s]                                               {'loss': 0.3068, 'grad_norm': 1.9892785549163818, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.44it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.41it/s]                                               {'loss': 0.0428, 'grad_norm': 1.0430080890655518, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.41it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s]                                               {'loss': 0.321, 'grad_norm': 2.1999666690826416, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.36it/s]                                               {'loss': 0.5296, 'grad_norm': 2.5474793910980225, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.36it/s]                                               {'loss': 0.3386, 'grad_norm': 15.90491771697998, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.36it/s]                                               {'train_runtime': 28.0503, 'train_samples_per_second': 20.142, 'train_steps_per_second': 1.426, 'train_loss': 0.7738445192575455, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.36it/s]100%|██████████| 40/40 [00:28<00:00,  1.43it/s]
CLIENT:50
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:57,  1.48s/it]                                              {'loss': 2.8399, 'grad_norm': 9.634023666381836, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:57,  1.48s/it]  5%|▌         | 2/40 [00:02<00:39,  1.05s/it]                                              {'loss': 1.6401, 'grad_norm': 9.774572372436523, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.05s/it]  8%|▊         | 3/40 [00:02<00:33,  1.09it/s]                                              {'loss': 1.6188, 'grad_norm': 11.107890129089355, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:33,  1.09it/s] 10%|█         | 4/40 [00:03<00:30,  1.17it/s]                                              {'loss': 1.2618, 'grad_norm': 18.406604766845703, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:30,  1.17it/s] 12%|█▎        | 5/40 [00:04<00:28,  1.23it/s]                                              {'loss': 1.2329, 'grad_norm': 10.819662094116211, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:28,  1.23it/s] 15%|█▌        | 6/40 [00:05<00:27,  1.25it/s]                                              {'loss': 1.5807, 'grad_norm': 20.079086303710938, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:27,  1.25it/s] 18%|█▊        | 7/40 [00:06<00:25,  1.27it/s]                                              {'loss': 1.262, 'grad_norm': 17.47486686706543, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:06<00:25,  1.27it/s]                                              {'loss': 1.1668, 'grad_norm': 62.31108474731445, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:25,  1.27it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.63it/s]                                              {'loss': 0.7837, 'grad_norm': 7.895590782165527, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.63it/s] 25%|██▌       | 10/40 [00:07<00:19,  1.54it/s]                                               {'loss': 0.8307, 'grad_norm': 16.370328903198242, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:19,  1.54it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.47it/s]                                               {'loss': 0.5607, 'grad_norm': 5.281025409698486, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.47it/s] 30%|███       | 12/40 [00:09<00:19,  1.43it/s]                                               {'loss': 0.7446, 'grad_norm': 7.2895331382751465, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:19,  1.43it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.39it/s]                                               {'loss': 0.6977, 'grad_norm': 7.046370029449463, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.39it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.37it/s]                                               {'loss': 0.7193, 'grad_norm': 10.212249755859375, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.37it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.35it/s]                                               {'loss': 0.2162, 'grad_norm': 4.335967063903809, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.35it/s]                                               {'loss': 0.0749, 'grad_norm': 1.8466850519180298, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.35it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s]                                               {'loss': 0.1646, 'grad_norm': 3.8389194011688232, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s] 45%|████▌     | 18/40 [00:13<00:14,  1.57it/s]                                               {'loss': 0.6352, 'grad_norm': 3.975942850112915, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:14,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.49it/s]                                               {'loss': 0.2272, 'grad_norm': 4.321415424346924, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.49it/s] 50%|█████     | 20/40 [00:14<00:13,  1.44it/s]                                               {'loss': 0.2074, 'grad_norm': 3.3374454975128174, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.41it/s]                                               {'loss': 0.4612, 'grad_norm': 4.017893314361572, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.41it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s]                                               {'loss': 0.149, 'grad_norm': 2.1866116523742676, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.3134, 'grad_norm': 2.251046657562256, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.0381, 'grad_norm': 3.8125059604644775, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s]                                               {'loss': 0.2648, 'grad_norm': 0.7067319750785828, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s]                                               {'loss': 0.2045, 'grad_norm': 3.932182550430298, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.51it/s]                                               {'loss': 0.2561, 'grad_norm': 1.4991322755813599, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.51it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s]                                               {'loss': 0.0666, 'grad_norm': 2.255068778991699, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.0416, 'grad_norm': 1.2468003034591675, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s]                                               {'loss': 0.0649, 'grad_norm': 1.4123821258544922, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.468, 'grad_norm': 4.803534984588623, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s] 80%|████████  | 32/40 [00:22<00:04,  1.83it/s]                                               {'loss': 0.0835, 'grad_norm': 5.563208103179932, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:04,  1.83it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.65it/s]                                               {'loss': 0.1899, 'grad_norm': 1.2004166841506958, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.65it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.52it/s]                                               {'loss': 0.0613, 'grad_norm': 2.301117420196533, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.52it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s]                                               {'loss': 0.0441, 'grad_norm': 1.3372174501419067, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.41it/s]                                               {'loss': 0.0471, 'grad_norm': 1.252861738204956, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.41it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.39it/s]                                               {'loss': 0.4658, 'grad_norm': 1.316956639289856, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.39it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.36it/s]                                               {'loss': 0.2235, 'grad_norm': 0.7920538783073425, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.36it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.0392, 'grad_norm': 2.0811898708343506, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.0106, 'grad_norm': 0.8094779253005981, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]                                               {'train_runtime': 27.9676, 'train_samples_per_second': 20.202, 'train_steps_per_second': 1.43, 'train_loss': 0.5489588858559727, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]100%|██████████| 40/40 [00:27<00:00,  1.43it/s]
CLIENT:53
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:21,  1.80it/s]                                              {'loss': 3.3737, 'grad_norm': 11.368749618530273, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:21,  1.80it/s]  5%|▌         | 2/40 [00:01<00:25,  1.51it/s]                                              {'loss': 1.2267, 'grad_norm': 8.576861381530762, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.51it/s]  8%|▊         | 3/40 [00:01<00:24,  1.51it/s]                                              {'loss': 1.6649, 'grad_norm': 16.132545471191406, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.51it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 2.6913, 'grad_norm': 18.409488677978516, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s]                                              {'loss': 2.0511, 'grad_norm': 21.707517623901367, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s]                                              {'loss': 3.0208, 'grad_norm': 35.042625427246094, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s]                                              {'loss': 2.1699, 'grad_norm': 21.60759162902832, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s] 20%|██        | 8/40 [00:04<00:17,  1.82it/s]                                              {'loss': 3.3155, 'grad_norm': 84.09430694580078, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:17,  1.82it/s] 22%|██▎       | 9/40 [00:05<00:18,  1.70it/s]                                              {'loss': 1.4706, 'grad_norm': 17.379520416259766, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:18,  1.70it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s]                                               {'loss': 0.8428, 'grad_norm': 12.137079238891602, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.59it/s] 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s]                                               {'loss': 1.6086, 'grad_norm': 10.026365280151367, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s] 30%|███       | 12/40 [00:07<00:18,  1.53it/s]                                               {'loss': 1.3648, 'grad_norm': 9.283013343811035, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:18,  1.53it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.53it/s]                                               {'loss': 1.3403, 'grad_norm': 8.234343528747559, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.53it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s]                                               {'loss': 1.1635, 'grad_norm': 9.966575622558594, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.49it/s]                                               {'loss': 1.8602, 'grad_norm': 8.590703964233398, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.49it/s]                                               {'loss': 0.4083, 'grad_norm': 15.462060928344727, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.49it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.87it/s]                                               {'loss': 0.5333, 'grad_norm': 6.389876842498779, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.87it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s]                                               {'loss': 0.6037, 'grad_norm': 4.936713218688965, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.65it/s]                                               {'loss': 0.7287, 'grad_norm': 7.987740993499756, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.65it/s] 50%|█████     | 20/40 [00:12<00:12,  1.65it/s]                                               {'loss': 1.1006, 'grad_norm': 6.322991847991943, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s]                                               {'loss': 0.5222, 'grad_norm': 5.214187145233154, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.52it/s]                                               {'loss': 1.1392, 'grad_norm': 11.98556137084961, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.52it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.7926, 'grad_norm': 9.94011116027832, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s] 60%|██████    | 24/40 [00:14<00:07,  2.06it/s]                                               {'loss': 1.4134, 'grad_norm': 36.20527648925781, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:07,  2.06it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.84it/s]                                               {'loss': 0.7927, 'grad_norm': 3.571549892425537, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.84it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.79it/s]                                               {'loss': 0.3629, 'grad_norm': 5.62509822845459, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.79it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.67it/s]                                               {'loss': 0.5104, 'grad_norm': 6.618249893188477, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.67it/s] 70%|███████   | 28/40 [00:17<00:07,  1.57it/s]                                               {'loss': 0.3814, 'grad_norm': 4.080777645111084, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.57it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.60it/s]                                               {'loss': 0.2926, 'grad_norm': 4.075893402099609, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.60it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.53it/s]                                               {'loss': 0.5263, 'grad_norm': 8.560474395751953, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.53it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.50it/s]                                               {'loss': 0.7721, 'grad_norm': 2.967327833175659, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.50it/s] 80%|████████  | 32/40 [00:19<00:03,  2.01it/s]                                               {'loss': 0.0081, 'grad_norm': 0.4142586886882782, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:03,  2.01it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.86it/s]                                               {'loss': 0.2102, 'grad_norm': 2.607574224472046, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.86it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.70it/s]                                               {'loss': 0.6672, 'grad_norm': 2.9035918712615967, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.70it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.62it/s]                                               {'loss': 0.1678, 'grad_norm': 3.795891523361206, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.62it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.62it/s]                                               {'loss': 0.2586, 'grad_norm': 3.5079915523529053, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.54it/s]                                               {'loss': 0.1975, 'grad_norm': 18.23631477355957, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.54it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s]                                               {'loss': 0.7588, 'grad_norm': 1.963598370552063, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.53it/s]                                               {'loss': 0.2346, 'grad_norm': 4.38944673538208, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.53it/s]                                               {'loss': 0.1713, 'grad_norm': 7.791338920593262, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.53it/s]                                               {'train_runtime': 24.3596, 'train_samples_per_second': 23.194, 'train_steps_per_second': 1.642, 'train_loss': 1.067979599442333, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.53it/s]100%|██████████| 40/40 [00:24<00:00,  1.64it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:55,  8.47it/s]  1%|          | 3/471 [00:00<01:06,  7.06it/s]  1%|          | 4/471 [00:00<01:13,  6.36it/s]  1%|          | 5/471 [00:00<01:17,  5.98it/s]  1%|▏         | 6/471 [00:00<01:20,  5.79it/s]  1%|▏         | 7/471 [00:01<01:23,  5.59it/s]  2%|▏         | 8/471 [00:01<01:24,  5.45it/s]  2%|▏         | 9/471 [00:01<01:25,  5.40it/s]  2%|▏         | 10/471 [00:01<01:25,  5.42it/s]  2%|▏         | 11/471 [00:01<01:25,  5.39it/s]  3%|▎         | 12/471 [00:02<01:25,  5.38it/s]  3%|▎         | 13/471 [00:02<01:26,  5.32it/s]  3%|▎         | 14/471 [00:02<01:25,  5.31it/s]  3%|▎         | 15/471 [00:02<01:25,  5.32it/s]  3%|▎         | 16/471 [00:02<01:26,  5.28it/s]  4%|▎         | 17/471 [00:03<01:25,  5.33it/s]  4%|▍         | 18/471 [00:03<01:25,  5.27it/s]  4%|▍         | 19/471 [00:03<01:25,  5.29it/s]  4%|▍         | 20/471 [00:03<01:25,  5.29it/s]  4%|▍         | 21/471 [00:03<01:25,  5.29it/s]  5%|▍         | 22/471 [00:03<01:25,  5.24it/s]  5%|▍         | 23/471 [00:04<01:25,  5.22it/s]  5%|▌         | 24/471 [00:04<01:25,  5.21it/s]  5%|▌         | 25/471 [00:04<01:25,  5.19it/s]  6%|▌         | 26/471 [00:04<01:25,  5.23it/s]  6%|▌         | 27/471 [00:04<01:25,  5.19it/s]  6%|▌         | 28/471 [00:05<01:32,  4.76it/s]  6%|▌         | 29/471 [00:05<01:58,  3.74it/s]  6%|▋         | 30/471 [00:05<02:08,  3.43it/s]  7%|▋         | 31/471 [00:06<02:08,  3.42it/s]  7%|▋         | 32/471 [00:06<02:22,  3.09it/s]  7%|▋         | 33/471 [00:07<02:27,  2.96it/s]  7%|▋         | 34/471 [00:07<02:25,  3.00it/s]  7%|▋         | 35/471 [00:07<02:28,  2.95it/s]  8%|▊         | 36/471 [00:08<02:35,  2.80it/s]  8%|▊         | 37/471 [00:08<02:30,  2.87it/s]  8%|▊         | 38/471 [00:08<02:29,  2.90it/s]  8%|▊         | 39/471 [00:09<02:38,  2.72it/s]  8%|▊         | 40/471 [00:09<02:32,  2.83it/s]  9%|▊         | 41/471 [00:09<02:27,  2.91it/s]  9%|▉         | 42/471 [00:10<02:36,  2.73it/s]  9%|▉         | 43/471 [00:10<02:32,  2.80it/s]  9%|▉         | 44/471 [00:10<02:24,  2.96it/s] 10%|▉         | 45/471 [00:11<02:33,  2.77it/s] 10%|▉         | 46/471 [00:11<02:34,  2.76it/s] 10%|▉         | 47/471 [00:11<02:28,  2.86it/s] 10%|█         | 48/471 [00:12<02:28,  2.85it/s] 10%|█         | 49/471 [00:12<02:34,  2.73it/s] 11%|█         | 50/471 [00:13<02:28,  2.83it/s] 11%|█         | 51/471 [00:13<02:19,  3.01it/s] 11%|█         | 52/471 [00:13<02:30,  2.78it/s] 11%|█▏        | 53/471 [00:14<02:30,  2.79it/s] 11%|█▏        | 54/471 [00:14<02:23,  2.91it/s] 12%|█▏        | 55/471 [00:14<02:27,  2.81it/s] 12%|█▏        | 56/471 [00:15<02:31,  2.74it/s] 12%|█▏        | 57/471 [00:15<02:25,  2.84it/s] 12%|█▏        | 58/471 [00:15<02:24,  2.85it/s] 13%|█▎        | 59/471 [00:16<02:32,  2.71it/s] 13%|█▎        | 60/471 [00:16<02:26,  2.81it/s] 13%|█▎        | 61/471 [00:16<02:22,  2.88it/s] 13%|█▎        | 62/471 [00:17<02:30,  2.71it/s] 13%|█▎        | 63/471 [00:17<02:25,  2.80it/s] 14%|█▎        | 64/471 [00:17<02:19,  2.91it/s] 14%|█▍        | 65/471 [00:18<02:28,  2.73it/s] 14%|█▍        | 66/471 [00:18<02:26,  2.76it/s] 14%|█▍        | 67/471 [00:19<02:19,  2.89it/s] 14%|█▍        | 68/471 [00:19<02:23,  2.80it/s] 15%|█▍        | 69/471 [00:19<02:27,  2.73it/s] 15%|█▍        | 70/471 [00:20<02:21,  2.82it/s] 15%|█▌        | 71/471 [00:20<02:21,  2.83it/s] 15%|█▌        | 72/471 [00:20<02:27,  2.70it/s] 15%|█▌        | 73/471 [00:21<02:21,  2.80it/s] 16%|█▌        | 74/471 [00:21<02:12,  2.99it/s] 16%|█▌        | 75/471 [00:21<02:22,  2.77it/s] 16%|█▌        | 76/471 [00:22<02:22,  2.77it/s] 16%|█▋        | 77/471 [00:22<02:18,  2.85it/s] 17%|█▋        | 78/471 [00:23<02:19,  2.81it/s] 17%|█▋        | 79/471 [00:23<02:23,  2.72it/s] 17%|█▋        | 80/471 [00:23<02:18,  2.83it/s] 17%|█▋        | 81/471 [00:24<02:16,  2.85it/s] 17%|█▋        | 82/471 [00:24<02:23,  2.70it/s] 18%|█▊        | 83/471 [00:24<02:18,  2.81it/s] 18%|█▊        | 84/471 [00:25<02:13,  2.89it/s] 18%|█▊        | 85/471 [00:25<02:21,  2.72it/s] 18%|█▊        | 86/471 [00:25<02:17,  2.80it/s] 18%|█▊        | 87/471 [00:26<02:11,  2.93it/s] 19%|█▊        | 88/471 [00:26<02:18,  2.76it/s] 19%|█▉        | 89/471 [00:26<02:18,  2.76it/s] 19%|█▉        | 90/471 [00:27<02:12,  2.87it/s] 19%|█▉        | 91/471 [00:27<02:14,  2.84it/s] 20%|█▉        | 92/471 [00:28<02:19,  2.73it/s] 20%|█▉        | 93/471 [00:28<02:13,  2.82it/s] 20%|█▉        | 94/471 [00:28<02:12,  2.85it/s] 20%|██        | 95/471 [00:29<02:19,  2.70it/s] 20%|██        | 96/471 [00:29<02:13,  2.81it/s] 21%|██        | 97/471 [00:29<02:05,  2.98it/s] 21%|██        | 98/471 [00:30<02:07,  2.92it/s] 21%|██        | 99/471 [00:30<02:13,  2.79it/s] 21%|██        | 100/471 [00:30<02:08,  2.89it/s] 21%|██▏       | 101/471 [00:31<02:06,  2.93it/s] 22%|██▏       | 102/471 [00:31<02:14,  2.74it/s] 22%|██▏       | 103/471 [00:31<02:10,  2.83it/s] 22%|██▏       | 104/471 [00:32<02:06,  2.91it/s] 22%|██▏       | 105/471 [00:32<02:14,  2.72it/s] 23%|██▎       | 106/471 [00:32<02:10,  2.79it/s] 23%|██▎       | 107/471 [00:33<02:03,  2.95it/s] 23%|██▎       | 108/471 [00:33<02:11,  2.76it/s] 23%|██▎       | 109/471 [00:34<02:11,  2.75it/s] 23%|██▎       | 110/471 [00:34<02:06,  2.84it/s] 24%|██▎       | 111/471 [00:34<02:06,  2.84it/s] 24%|██▍       | 112/471 [00:35<02:11,  2.72it/s] 24%|██▍       | 113/471 [00:35<02:06,  2.83it/s] 24%|██▍       | 114/471 [00:35<02:04,  2.86it/s] 24%|██▍       | 115/471 [00:36<02:11,  2.70it/s] 25%|██▍       | 116/471 [00:36<02:06,  2.80it/s] 25%|██▍       | 117/471 [00:36<02:02,  2.88it/s] 25%|██▌       | 118/471 [00:37<02:10,  2.71it/s] 25%|██▌       | 119/471 [00:37<02:06,  2.78it/s] 25%|██▌       | 120/471 [00:37<02:00,  2.92it/s] 26%|██▌       | 121/471 [00:38<02:01,  2.89it/s] 26%|██▌       | 122/471 [00:38<02:06,  2.75it/s] 26%|██▌       | 123/471 [00:38<02:02,  2.85it/s] 26%|██▋       | 124/471 [00:39<01:59,  2.90it/s] 27%|██▋       | 125/471 [00:39<02:07,  2.71it/s] 27%|██▋       | 126/471 [00:40<02:03,  2.80it/s] 27%|██▋       | 127/471 [00:40<01:58,  2.90it/s] 27%|██▋       | 128/471 [00:40<02:05,  2.73it/s] 27%|██▋       | 129/471 [00:41<02:03,  2.78it/s] 28%|██▊       | 130/471 [00:41<01:55,  2.95it/s] 28%|██▊       | 131/471 [00:41<02:02,  2.77it/s] 28%|██▊       | 132/471 [00:42<02:04,  2.73it/s] 28%|██▊       | 133/471 [00:42<01:59,  2.83it/s] 28%|██▊       | 134/471 [00:42<01:59,  2.81it/s] 29%|██▊       | 135/471 [00:43<02:04,  2.70it/s] 29%|██▉       | 136/471 [00:43<01:59,  2.80it/s] 29%|██▉       | 137/471 [00:43<01:57,  2.84it/s] 29%|██▉       | 138/471 [00:44<02:04,  2.68it/s] 30%|██▉       | 139/471 [00:44<01:58,  2.80it/s] 30%|██▉       | 140/471 [00:45<01:54,  2.89it/s] 30%|██▉       | 141/471 [00:45<02:01,  2.72it/s] 30%|███       | 142/471 [00:45<01:58,  2.79it/s] 30%|███       | 143/471 [00:46<01:51,  2.93it/s] 31%|███       | 144/471 [00:46<01:37,  3.34it/s] 31%|███       | 145/471 [00:46<01:27,  3.73it/s] 31%|███       | 146/471 [00:46<01:20,  4.06it/s] 31%|███       | 147/471 [00:46<01:14,  4.35it/s] 31%|███▏      | 148/471 [00:47<01:10,  4.60it/s] 32%|███▏      | 149/471 [00:47<01:07,  4.78it/s] 32%|███▏      | 150/471 [00:47<01:05,  4.92it/s] 32%|███▏      | 151/471 [00:47<01:04,  5.00it/s] 32%|███▏      | 152/471 [00:47<01:03,  5.06it/s] 32%|███▏      | 153/471 [00:48<01:02,  5.11it/s] 33%|███▎      | 154/471 [00:48<01:01,  5.19it/s] 33%|███▎      | 155/471 [00:48<01:00,  5.20it/s] 33%|███▎      | 156/471 [00:48<01:00,  5.24it/s] 33%|███▎      | 157/471 [00:48<00:59,  5.24it/s] 34%|███▎      | 158/471 [00:48<00:59,  5.28it/s] 34%|███▍      | 159/471 [00:49<00:58,  5.29it/s] 34%|███▍      | 160/471 [00:49<00:59,  5.27it/s] 34%|███▍      | 161/471 [00:49<00:59,  5.25it/s] 34%|███▍      | 162/471 [00:49<00:58,  5.25it/s] 35%|███▍      | 163/471 [00:49<00:58,  5.23it/s] 35%|███▍      | 164/471 [00:50<00:58,  5.27it/s] 35%|███▌      | 165/471 [00:50<00:57,  5.28it/s] 35%|███▌      | 166/471 [00:50<00:58,  5.20it/s] 35%|███▌      | 167/471 [00:50<00:58,  5.19it/s] 36%|███▌      | 168/471 [00:50<00:58,  5.15it/s] 36%|███▌      | 169/471 [00:51<00:58,  5.14it/s] 36%|███▌      | 170/471 [00:51<00:57,  5.20it/s] 36%|███▋      | 171/471 [00:51<00:58,  5.16it/s] 37%|███▋      | 172/471 [00:51<01:03,  4.74it/s] 37%|███▋      | 173/471 [00:52<01:20,  3.71it/s] 37%|███▋      | 174/471 [00:52<01:27,  3.41it/s] 37%|███▋      | 175/471 [00:52<01:27,  3.38it/s] 37%|███▋      | 176/471 [00:53<01:35,  3.10it/s] 38%|███▊      | 177/471 [00:53<01:40,  2.92it/s] 38%|███▊      | 178/471 [00:53<01:38,  2.96it/s] 38%|███▊      | 179/471 [00:54<01:37,  3.00it/s] 38%|███▊      | 180/471 [00:54<01:44,  2.77it/s] 38%|███▊      | 181/471 [00:54<01:41,  2.85it/s] 39%|███▊      | 182/471 [00:55<01:38,  2.93it/s] 39%|███▉      | 183/471 [00:55<01:45,  2.72it/s] 39%|███▉      | 184/471 [00:56<01:43,  2.76it/s] 39%|███▉      | 185/471 [00:56<01:36,  2.95it/s] 39%|███▉      | 186/471 [00:56<01:42,  2.79it/s] 40%|███▉      | 187/471 [00:57<01:43,  2.73it/s] 40%|███▉      | 188/471 [00:57<01:40,  2.82it/s] 40%|████      | 189/471 [00:57<01:40,  2.82it/s] 40%|████      | 190/471 [00:58<01:44,  2.70it/s] 41%|████      | 191/471 [00:58<01:40,  2.79it/s] 41%|████      | 192/471 [00:58<01:38,  2.83it/s] 41%|████      | 193/471 [00:59<01:43,  2.68it/s] 41%|████      | 194/471 [00:59<01:39,  2.77it/s] 41%|████▏     | 195/471 [00:59<01:34,  2.91it/s] 42%|████▏     | 196/471 [01:00<01:35,  2.87it/s] 42%|████▏     | 197/471 [01:00<01:38,  2.77it/s] 42%|████▏     | 198/471 [01:01<01:35,  2.86it/s] 42%|████▏     | 199/471 [01:01<01:34,  2.88it/s] 42%|████▏     | 200/471 [01:01<01:40,  2.71it/s] 43%|████▎     | 201/471 [01:02<01:36,  2.81it/s] 43%|████▎     | 202/471 [01:02<01:33,  2.88it/s] 43%|████▎     | 203/471 [01:02<01:39,  2.70it/s] 43%|████▎     | 204/471 [01:03<01:36,  2.75it/s] 44%|████▎     | 205/471 [01:03<01:32,  2.89it/s] 44%|████▎     | 206/471 [01:03<01:37,  2.71it/s] 44%|████▍     | 207/471 [01:04<01:37,  2.72it/s] 44%|████▍     | 208/471 [01:04<01:32,  2.83it/s] 44%|████▍     | 209/471 [01:04<01:33,  2.81it/s] 45%|████▍     | 210/471 [01:05<01:36,  2.71it/s] 45%|████▍     | 211/471 [01:05<01:32,  2.82it/s] 45%|████▌     | 212/471 [01:06<01:30,  2.87it/s] 45%|████▌     | 213/471 [01:06<01:35,  2.69it/s] 45%|████▌     | 214/471 [01:06<01:32,  2.77it/s] 46%|████▌     | 215/471 [01:07<01:29,  2.86it/s] 46%|████▌     | 216/471 [01:07<01:35,  2.68it/s] 46%|████▌     | 217/471 [01:07<01:32,  2.74it/s] 46%|████▋     | 218/471 [01:08<01:27,  2.90it/s] 46%|████▋     | 219/471 [01:08<01:27,  2.87it/s] 47%|████▋     | 220/471 [01:08<01:32,  2.71it/s] 47%|████▋     | 221/471 [01:09<01:29,  2.80it/s] 47%|████▋     | 222/471 [01:09<01:26,  2.88it/s] 47%|████▋     | 223/471 [01:10<01:31,  2.71it/s] 48%|████▊     | 224/471 [01:10<01:28,  2.78it/s] 48%|████▊     | 225/471 [01:10<01:24,  2.91it/s] 48%|████▊     | 226/471 [01:11<01:30,  2.70it/s] 48%|████▊     | 227/471 [01:11<01:29,  2.74it/s] 48%|████▊     | 228/471 [01:11<01:24,  2.89it/s] 49%|████▊     | 229/471 [01:12<01:28,  2.72it/s] 49%|████▉     | 230/471 [01:12<01:29,  2.70it/s] 49%|████▉     | 231/471 [01:12<01:26,  2.79it/s] 49%|████▉     | 232/471 [01:13<01:24,  2.82it/s] 49%|████▉     | 233/471 [01:13<01:28,  2.70it/s] 50%|████▉     | 234/471 [01:13<01:24,  2.80it/s] 50%|████▉     | 235/471 [01:14<01:22,  2.85it/s] 50%|█████     | 236/471 [01:14<01:27,  2.67it/s] 50%|█████     | 237/471 [01:15<01:24,  2.77it/s] 51%|█████     | 238/471 [01:15<01:21,  2.85it/s] 51%|█████     | 239/471 [01:15<01:26,  2.69it/s] 51%|█████     | 240/471 [01:16<01:24,  2.74it/s] 51%|█████     | 241/471 [01:16<01:20,  2.87it/s] 51%|█████▏    | 242/471 [01:16<01:20,  2.83it/s] 52%|█████▏    | 243/471 [01:17<01:24,  2.70it/s] 52%|█████▏    | 244/471 [01:17<01:21,  2.80it/s] 52%|█████▏    | 245/471 [01:17<01:18,  2.88it/s] 52%|█████▏    | 246/471 [01:18<01:23,  2.70it/s] 52%|█████▏    | 247/471 [01:18<01:20,  2.77it/s] 53%|█████▎    | 248/471 [01:18<01:16,  2.90it/s] 53%|█████▎    | 249/471 [01:19<01:21,  2.72it/s] 53%|█████▎    | 250/471 [01:19<01:20,  2.74it/s] 53%|█████▎    | 251/471 [01:20<01:16,  2.88it/s] 54%|█████▎    | 252/471 [01:20<01:18,  2.77it/s] 54%|█████▎    | 253/471 [01:20<01:20,  2.71it/s] 54%|█████▍    | 254/471 [01:21<01:17,  2.81it/s] 54%|█████▍    | 255/471 [01:21<01:16,  2.82it/s] 54%|█████▍    | 256/471 [01:21<01:20,  2.68it/s] 55%|█████▍    | 257/471 [01:22<01:16,  2.78it/s] 55%|█████▍    | 258/471 [01:22<01:14,  2.84it/s] 55%|█████▍    | 259/471 [01:23<01:19,  2.67it/s] 55%|█████▌    | 260/471 [01:23<01:16,  2.76it/s] 55%|█████▌    | 261/471 [01:23<01:13,  2.86it/s] 56%|█████▌    | 262/471 [01:24<01:17,  2.69it/s] 56%|█████▌    | 263/471 [01:24<01:16,  2.73it/s] 56%|█████▌    | 264/471 [01:24<01:11,  2.88it/s] 56%|█████▋    | 265/471 [01:25<01:10,  2.91it/s] 56%|█████▋    | 266/471 [01:25<01:15,  2.72it/s] 57%|█████▋    | 267/471 [01:25<01:12,  2.80it/s] 57%|█████▋    | 268/471 [01:26<01:10,  2.90it/s] 57%|█████▋    | 269/471 [01:26<01:14,  2.71it/s] 57%|█████▋    | 270/471 [01:26<01:13,  2.75it/s] 58%|█████▊    | 271/471 [01:27<01:08,  2.90it/s] 58%|█████▊    | 272/471 [01:27<01:12,  2.75it/s] 58%|█████▊    | 273/471 [01:28<01:12,  2.72it/s] 58%|█████▊    | 274/471 [01:28<01:09,  2.82it/s] 58%|█████▊    | 275/471 [01:28<01:09,  2.83it/s] 59%|█████▊    | 276/471 [01:29<01:12,  2.70it/s] 59%|█████▉    | 277/471 [01:29<01:09,  2.80it/s] 59%|█████▉    | 278/471 [01:29<01:07,  2.86it/s] 59%|█████▉    | 279/471 [01:30<01:11,  2.70it/s] 59%|█████▉    | 280/471 [01:30<01:08,  2.78it/s] 60%|█████▉    | 281/471 [01:30<01:05,  2.90it/s] 60%|█████▉    | 282/471 [01:31<01:09,  2.72it/s] 60%|██████    | 283/471 [01:31<01:08,  2.75it/s] 60%|██████    | 284/471 [01:31<01:04,  2.88it/s] 61%|██████    | 285/471 [01:32<01:07,  2.76it/s] 61%|██████    | 286/471 [01:32<01:08,  2.71it/s] 61%|██████    | 287/471 [01:33<01:05,  2.80it/s] 61%|██████    | 288/471 [01:33<00:58,  3.10it/s] 61%|██████▏   | 289/471 [01:33<00:51,  3.54it/s] 62%|██████▏   | 290/471 [01:33<00:46,  3.88it/s] 62%|██████▏   | 291/471 [01:33<00:42,  4.20it/s] 62%|██████▏   | 292/471 [01:34<00:40,  4.47it/s] 62%|██████▏   | 293/471 [01:34<00:37,  4.71it/s] 62%|██████▏   | 294/471 [01:34<00:36,  4.89it/s] 63%|██████▎   | 295/471 [01:34<00:35,  4.97it/s] 63%|██████▎   | 296/471 [01:34<00:34,  5.05it/s] 63%|██████▎   | 297/471 [01:34<00:34,  5.11it/s] 63%|██████▎   | 298/471 [01:35<00:33,  5.16it/s] 63%|██████▎   | 299/471 [01:35<00:33,  5.21it/s] 64%|██████▎   | 300/471 [01:35<00:32,  5.20it/s] 64%|██████▍   | 301/471 [01:35<00:32,  5.21it/s] 64%|██████▍   | 302/471 [01:35<00:32,  5.21it/s] 64%|██████▍   | 303/471 [01:36<00:32,  5.23it/s] 65%|██████▍   | 304/471 [01:36<00:31,  5.26it/s] 65%|██████▍   | 305/471 [01:36<00:31,  5.27it/s] 65%|██████▍   | 306/471 [01:36<00:31,  5.25it/s] 65%|██████▌   | 307/471 [01:36<00:31,  5.18it/s] 65%|██████▌   | 308/471 [01:37<00:31,  5.16it/s] 66%|██████▌   | 309/471 [01:37<00:31,  5.15it/s] 66%|██████▌   | 310/471 [01:37<00:31,  5.16it/s] 66%|██████▌   | 311/471 [01:37<00:30,  5.17it/s] 66%|██████▌   | 312/471 [01:37<00:30,  5.16it/s] 66%|██████▋   | 313/471 [01:38<00:30,  5.10it/s] 67%|██████▋   | 314/471 [01:38<00:39,  3.94it/s] 67%|██████▋   | 315/471 [01:38<00:45,  3.43it/s] 67%|██████▋   | 316/471 [01:39<00:46,  3.30it/s] 67%|██████▋   | 317/471 [01:39<00:47,  3.23it/s] 68%|██████▊   | 318/471 [01:39<00:44,  3.40it/s] 68%|██████▊   | 319/471 [01:40<00:48,  3.14it/s] 68%|██████▊   | 320/471 [01:40<00:48,  3.12it/s] 68%|██████▊   | 321/471 [01:40<00:48,  3.07it/s] 68%|██████▊   | 322/471 [01:41<00:52,  2.82it/s] 69%|██████▊   | 323/471 [01:41<00:51,  2.88it/s] 69%|██████▉   | 324/471 [01:41<00:49,  2.96it/s] 69%|██████▉   | 325/471 [01:42<00:53,  2.75it/s] 69%|██████▉   | 326/471 [01:42<00:51,  2.80it/s] 69%|██████▉   | 327/471 [01:42<00:48,  2.95it/s] 70%|██████▉   | 328/471 [01:43<00:51,  2.77it/s] 70%|██████▉   | 329/471 [01:43<00:51,  2.74it/s] 70%|███████   | 330/471 [01:44<00:49,  2.83it/s] 70%|███████   | 331/471 [01:44<00:49,  2.82it/s] 70%|███████   | 332/471 [01:44<00:51,  2.70it/s] 71%|███████   | 333/471 [01:45<00:49,  2.80it/s] 71%|███████   | 334/471 [01:45<00:48,  2.83it/s] 71%|███████   | 335/471 [01:45<00:50,  2.67it/s] 71%|███████▏  | 336/471 [01:46<00:48,  2.78it/s] 72%|███████▏  | 337/471 [01:46<00:44,  3.03it/s] 72%|███████▏  | 338/471 [01:46<00:41,  3.21it/s] 72%|███████▏  | 339/471 [01:47<00:45,  2.89it/s] 72%|███████▏  | 340/471 [01:47<00:45,  2.89it/s] 72%|███████▏  | 341/471 [01:47<00:42,  3.04it/s] 73%|███████▎  | 342/471 [01:48<00:45,  2.84it/s] 73%|███████▎  | 343/471 [01:48<00:46,  2.77it/s] 73%|███████▎  | 344/471 [01:48<00:44,  2.86it/s] 73%|███████▎  | 345/471 [01:49<00:42,  3.00it/s] 73%|███████▎  | 346/471 [01:49<00:45,  2.77it/s] 74%|███████▎  | 347/471 [01:49<00:43,  2.85it/s] 74%|███████▍  | 348/471 [01:50<00:41,  2.97it/s] 74%|███████▍  | 349/471 [01:50<00:44,  2.76it/s] 74%|███████▍  | 350/471 [01:51<00:43,  2.78it/s] 75%|███████▍  | 351/471 [01:51<00:40,  2.94it/s] 75%|███████▍  | 352/471 [01:51<00:41,  2.85it/s] 75%|███████▍  | 353/471 [01:52<00:43,  2.72it/s] 75%|███████▌  | 354/471 [01:52<00:41,  2.81it/s] 75%|███████▌  | 355/471 [01:52<00:41,  2.82it/s] 76%|███████▌  | 356/471 [01:53<00:42,  2.70it/s] 76%|███████▌  | 357/471 [01:53<00:40,  2.80it/s] 76%|███████▌  | 358/471 [01:53<00:39,  2.89it/s] 76%|███████▌  | 359/471 [01:54<00:41,  2.70it/s] 76%|███████▋  | 360/471 [01:54<00:40,  2.77it/s] 77%|███████▋  | 361/471 [01:54<00:38,  2.89it/s] 77%|███████▋  | 362/471 [01:55<00:37,  2.92it/s] 77%|███████▋  | 363/471 [01:55<00:39,  2.75it/s] 77%|███████▋  | 364/471 [01:56<00:37,  2.83it/s] 77%|███████▋  | 365/471 [01:56<00:36,  2.94it/s] 78%|███████▊  | 366/471 [01:56<00:38,  2.73it/s] 78%|███████▊  | 367/471 [01:57<00:37,  2.78it/s] 78%|███████▊  | 368/471 [01:57<00:35,  2.92it/s] 78%|███████▊  | 369/471 [01:57<00:37,  2.74it/s] 79%|███████▊  | 370/471 [01:58<00:37,  2.67it/s] 79%|███████▉  | 371/471 [01:58<00:35,  2.81it/s] 79%|███████▉  | 372/471 [01:58<00:37,  2.61it/s] 79%|███████▉  | 373/471 [01:59<00:36,  2.68it/s] 79%|███████▉  | 374/471 [01:59<00:33,  2.89it/s] 80%|███████▉  | 375/471 [02:00<00:35,  2.67it/s] 80%|███████▉  | 376/471 [02:00<00:35,  2.68it/s] 80%|████████  | 377/471 [02:00<00:33,  2.84it/s] 80%|████████  | 378/471 [02:01<00:34,  2.73it/s] 80%|████████  | 379/471 [02:01<00:34,  2.68it/s] 81%|████████  | 380/471 [02:01<00:32,  2.77it/s] 81%|████████  | 381/471 [02:02<00:32,  2.75it/s] 81%|████████  | 382/471 [02:02<00:33,  2.68it/s] 81%|████████▏ | 383/471 [02:02<00:31,  2.80it/s] 82%|████████▏ | 384/471 [02:03<00:29,  2.99it/s] 82%|████████▏ | 385/471 [02:03<00:31,  2.77it/s] 82%|████████▏ | 386/471 [02:03<00:30,  2.77it/s] 82%|████████▏ | 387/471 [02:04<00:28,  2.92it/s] 82%|████████▏ | 388/471 [02:04<00:29,  2.81it/s] 83%|████████▎ | 389/471 [02:05<00:29,  2.75it/s] 83%|████████▎ | 390/471 [02:05<00:28,  2.83it/s] 83%|████████▎ | 391/471 [02:05<00:28,  2.84it/s] 83%|████████▎ | 392/471 [02:06<00:29,  2.70it/s] 83%|████████▎ | 393/471 [02:06<00:28,  2.76it/s] 84%|████████▎ | 394/471 [02:06<00:27,  2.80it/s] 84%|████████▍ | 395/471 [02:07<00:28,  2.66it/s] 84%|████████▍ | 396/471 [02:07<00:27,  2.77it/s] 84%|████████▍ | 397/471 [02:07<00:25,  2.93it/s] 85%|████████▍ | 398/471 [02:08<00:26,  2.73it/s] 85%|████████▍ | 399/471 [02:08<00:26,  2.77it/s] 85%|████████▍ | 400/471 [02:08<00:24,  2.92it/s] 85%|████████▌ | 401/471 [02:09<00:25,  2.75it/s] 85%|████████▌ | 402/471 [02:09<00:25,  2.73it/s] 86%|████████▌ | 403/471 [02:10<00:24,  2.83it/s] 86%|████████▌ | 404/471 [02:10<00:23,  2.80it/s] 86%|████████▌ | 405/471 [02:10<00:24,  2.70it/s] 86%|████████▌ | 406/471 [02:11<00:23,  2.82it/s] 86%|████████▋ | 407/471 [02:11<00:21,  2.99it/s] 87%|████████▋ | 408/471 [02:11<00:22,  2.78it/s] 87%|████████▋ | 409/471 [02:12<00:22,  2.77it/s] 87%|████████▋ | 410/471 [02:12<00:21,  2.90it/s] 87%|████████▋ | 411/471 [02:12<00:21,  2.81it/s] 87%|████████▋ | 412/471 [02:13<00:21,  2.74it/s] 88%|████████▊ | 413/471 [02:13<00:20,  2.83it/s] 88%|████████▊ | 414/471 [02:13<00:20,  2.84it/s] 88%|████████▊ | 415/471 [02:14<00:20,  2.70it/s] 88%|████████▊ | 416/471 [02:14<00:19,  2.79it/s] 89%|████████▊ | 417/471 [02:15<00:18,  2.86it/s] 89%|████████▊ | 418/471 [02:15<00:19,  2.68it/s] 89%|████████▉ | 419/471 [02:15<00:18,  2.78it/s] 89%|████████▉ | 420/471 [02:16<00:17,  2.89it/s] 89%|████████▉ | 421/471 [02:16<00:18,  2.71it/s] 90%|████████▉ | 422/471 [02:16<00:17,  2.75it/s] 90%|████████▉ | 423/471 [02:17<00:16,  2.91it/s] 90%|█████████ | 424/471 [02:17<00:17,  2.75it/s] 90%|█████████ | 425/471 [02:17<00:16,  2.73it/s] 90%|█████████ | 426/471 [02:18<00:15,  2.82it/s] 91%|█████████ | 427/471 [02:18<00:15,  2.81it/s] 91%|█████████ | 428/471 [02:19<00:15,  2.72it/s] 91%|█████████ | 429/471 [02:19<00:14,  2.82it/s] 91%|█████████▏| 430/471 [02:19<00:13,  3.08it/s] 92%|█████████▏| 431/471 [02:19<00:11,  3.52it/s] 92%|█████████▏| 432/471 [02:20<00:10,  3.85it/s] 92%|█████████▏| 433/471 [02:20<00:09,  4.18it/s] 92%|█████████▏| 434/471 [02:20<00:08,  4.45it/s] 92%|█████████▏| 435/471 [02:20<00:07,  4.67it/s] 93%|█████████▎| 436/471 [02:20<00:07,  4.86it/s] 93%|█████████▎| 437/471 [02:20<00:06,  4.96it/s] 93%|█████████▎| 438/471 [02:21<00:06,  5.04it/s] 93%|█████████▎| 439/471 [02:21<00:06,  5.03it/s] 93%|█████████▎| 440/471 [02:21<00:06,  5.07it/s] 94%|█████████▎| 441/471 [02:21<00:05,  5.11it/s] 94%|█████████▍| 442/471 [02:21<00:05,  5.12it/s] 94%|█████████▍| 443/471 [02:22<00:05,  5.15it/s] 94%|█████████▍| 444/471 [02:22<00:05,  5.09it/s] 94%|█████████▍| 445/471 [02:22<00:05,  5.13it/s] 95%|█████████▍| 446/471 [02:22<00:04,  5.17it/s] 95%|█████████▍| 447/471 [02:22<00:04,  5.21it/s] 95%|█████████▌| 448/471 [02:23<00:04,  5.25it/s] 95%|█████████▌| 449/471 [02:23<00:04,  5.24it/s] 96%|█████████▌| 450/471 [02:23<00:04,  4.48it/s] 96%|█████████▌| 451/471 [02:23<00:05,  3.57it/s] 96%|█████████▌| 452/471 [02:24<00:05,  3.39it/s] 96%|█████████▌| 453/471 [02:24<00:05,  3.31it/s] 96%|█████████▋| 454/471 [02:25<00:05,  2.95it/s] 97%|█████████▋| 455/471 [02:25<00:05,  2.92it/s] 97%|█████████▋| 456/471 [02:25<00:04,  3.04it/s] 97%|█████████▋| 457/471 [02:26<00:04,  2.82it/s] 97%|█████████▋| 458/471 [02:26<00:04,  2.77it/s] 97%|█████████▋| 459/471 [02:26<00:04,  2.87it/s] 98%|█████████▊| 460/471 [02:27<00:03,  2.84it/s] 98%|█████████▊| 461/471 [02:27<00:03,  2.71it/s] 98%|█████████▊| 462/471 [02:27<00:03,  2.80it/s] 98%|█████████▊| 463/471 [02:28<00:02,  2.84it/s] 99%|█████████▊| 464/471 [02:28<00:02,  2.68it/s] 99%|█████████▊| 465/471 [02:29<00:02,  2.78it/s] 99%|█████████▉| 466/471 [02:29<00:01,  2.88it/s] 99%|█████████▉| 467/471 [02:29<00:01,  2.68it/s] 99%|█████████▉| 468/471 [02:30<00:01,  2.74it/s]100%|█████████▉| 469/471 [02:30<00:00,  2.87it/s]100%|█████████▉| 470/471 [02:30<00:00,  2.72it/s]100%|██████████| 471/471 [02:31<00:00,  2.89it/s]100%|██████████| 471/471 [02:31<00:00,  3.12it/s]
{'eval_loss': 2.702035427093506, 'eval_model_preparation_time': 0.0092, 'eval_acc': 0.35568242166755176, 'eval_runtime': 151.3932, 'eval_samples_per_second': 49.751, 'eval_steps_per_second': 3.111}
ROUND:14
CLIENT:72
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]                                              {'loss': 3.298, 'grad_norm': 10.961690902709961, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]                                              {'loss': 2.5667, 'grad_norm': 12.770626068115234, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.49it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s]                                              {'loss': 1.7089, 'grad_norm': 14.289695739746094, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:25,  1.39it/s]                                              {'loss': 1.6998, 'grad_norm': 16.65247917175293, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:25,  1.39it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s]                                              {'loss': 0.9255, 'grad_norm': 11.119203567504883, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s]                                              {'loss': 1.4804, 'grad_norm': 20.317169189453125, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.44it/s] 18%|█▊        | 7/40 [00:04<00:23,  1.42it/s]                                              {'loss': 1.4199, 'grad_norm': 12.255402565002441, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:23,  1.42it/s] 20%|██        | 8/40 [00:05<00:25,  1.25it/s]                                              {'loss': 2.9374, 'grad_norm': 89.9034423828125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:25,  1.25it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s]                                              {'loss': 0.8234, 'grad_norm': 10.460535049438477, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.35it/s]                                               {'loss': 1.1369, 'grad_norm': 5.415430545806885, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.35it/s] 28%|██▊       | 11/40 [00:07<00:20,  1.41it/s]                                               {'loss': 0.2015, 'grad_norm': 3.998277187347412, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:20,  1.41it/s] 30%|███       | 12/40 [00:08<00:19,  1.41it/s]                                               {'loss': 0.7651, 'grad_norm': 5.607789039611816, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.41it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s]                                               {'loss': 0.6139, 'grad_norm': 7.9875311851501465, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s]                                               {'loss': 0.4299, 'grad_norm': 5.025791168212891, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s]                                               {'loss': 0.5043, 'grad_norm': 2.5460572242736816, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:17,  1.45it/s]                                               {'loss': 0.1237, 'grad_norm': 6.361744403839111, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:16,  1.45it/s] 42%|████▎     | 17/40 [00:11<00:12,  1.81it/s]                                               {'loss': 0.1848, 'grad_norm': 3.4368412494659424, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:12,  1.81it/s] 45%|████▌     | 18/40 [00:12<00:12,  1.78it/s]                                               {'loss': 0.5652, 'grad_norm': 3.7432446479797363, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:12,  1.78it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.65it/s]                                               {'loss': 0.2756, 'grad_norm': 3.1921486854553223, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.65it/s] 50%|█████     | 20/40 [00:13<00:11,  1.73it/s]                                               {'loss': 0.4621, 'grad_norm': 6.721161365509033, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:11,  1.73it/s] 52%|█████▎    | 21/40 [00:13<00:09,  1.95it/s]                                               {'loss': 0.0923, 'grad_norm': 2.9004974365234375, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:09,  1.95it/s] 55%|█████▌    | 22/40 [00:13<00:08,  2.15it/s]                                               {'loss': 0.1878, 'grad_norm': 4.362359046936035, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:08,  2.15it/s] 57%|█████▊    | 23/40 [00:14<00:07,  2.34it/s]                                               {'loss': 0.5857, 'grad_norm': 4.262344837188721, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:07,  2.34it/s]                                               {'loss': 0.0076, 'grad_norm': 0.5764070749282837, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:06,  2.34it/s] 62%|██████▎   | 25/40 [00:14<00:04,  3.11it/s]                                               {'loss': 0.2863, 'grad_norm': 0.8619436025619507, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:04,  3.11it/s] 65%|██████▌   | 26/40 [00:15<00:04,  3.09it/s]                                               {'loss': 0.1533, 'grad_norm': 2.846261978149414, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:04,  3.09it/s] 68%|██████▊   | 27/40 [00:15<00:04,  3.02it/s]                                               {'loss': 0.1147, 'grad_norm': 2.2047579288482666, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:04,  3.02it/s] 70%|███████   | 28/40 [00:15<00:04,  2.97it/s]                                               {'loss': 0.2868, 'grad_norm': 4.638704299926758, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:04,  2.97it/s] 72%|███████▎  | 29/40 [00:16<00:03,  2.95it/s]                                               {'loss': 0.5592, 'grad_norm': 1.6511976718902588, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:03,  2.95it/s] 75%|███████▌  | 30/40 [00:16<00:03,  2.58it/s]                                               {'loss': 0.1689, 'grad_norm': 1.6734862327575684, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:03,  2.58it/s] 78%|███████▊  | 31/40 [00:17<00:04,  2.11it/s]                                               {'loss': 0.0986, 'grad_norm': 1.5760586261749268, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:04,  2.11it/s]                                               {'loss': 0.0042, 'grad_norm': 0.23090843856334686, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:03,  2.11it/s] 82%|████████▎ | 33/40 [00:17<00:02,  2.56it/s]                                               {'loss': 0.0656, 'grad_norm': 1.7816883325576782, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:02,  2.56it/s] 85%|████████▌ | 34/40 [00:18<00:02,  2.49it/s]                                               {'loss': 0.0325, 'grad_norm': 1.0880606174468994, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:02,  2.49it/s] 88%|████████▊ | 35/40 [00:18<00:02,  2.21it/s]                                               {'loss': 0.2545, 'grad_norm': 0.600136935710907, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  2.21it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.88it/s]                                               {'loss': 0.2348, 'grad_norm': 1.3195488452911377, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.88it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.76it/s]                                               {'loss': 0.1562, 'grad_norm': 4.0211567878723145, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.76it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.66it/s]                                               {'loss': 0.3731, 'grad_norm': 0.9745721220970154, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.66it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.58it/s]                                               {'loss': 0.0711, 'grad_norm': 0.8410680294036865, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.58it/s]                                               {'loss': 0.4786, 'grad_norm': 44.83624267578125, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.58it/s]                                               {'train_runtime': 21.9936, 'train_samples_per_second': 25.689, 'train_steps_per_second': 1.819, 'train_loss': 0.6583778609288856, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.58it/s]100%|██████████| 40/40 [00:21<00:00,  1.82it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]                                              {'loss': 2.4486, 'grad_norm': 9.758468627929688, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:24,  1.54it/s]                                              {'loss': 1.4002, 'grad_norm': 9.124996185302734, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.54it/s]  8%|▊         | 3/40 [00:02<00:25,  1.44it/s]                                              {'loss': 1.5391, 'grad_norm': 9.113228797912598, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.44it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s]                                              {'loss': 0.8594, 'grad_norm': 10.403552055358887, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s]                                              {'loss': 0.7996, 'grad_norm': 11.871346473693848, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.46it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.42it/s]                                              {'loss': 1.9409, 'grad_norm': 27.753847122192383, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.42it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s]                                              {'loss': 1.8746, 'grad_norm': 12.988612174987793, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.48it/s]                                              {'loss': 0.3439, 'grad_norm': 27.587724685668945, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.48it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.86it/s]                                              {'loss': 0.855, 'grad_norm': 11.122312545776367, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.86it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s]                                               {'loss': 1.3997, 'grad_norm': 15.010782241821289, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s]                                               {'loss': 1.4243, 'grad_norm': 15.160621643066406, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s] 30%|███       | 12/40 [00:07<00:17,  1.58it/s]                                               {'loss': 0.6417, 'grad_norm': 8.14125919342041, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.58it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.56it/s]                                               {'loss': 1.1574, 'grad_norm': 10.432551383972168, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.56it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.53it/s]                                               {'loss': 0.4803, 'grad_norm': 4.878903388977051, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.53it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.47it/s]                                               {'loss': 0.3498, 'grad_norm': 9.081369400024414, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.47it/s]                                               {'loss': 0.1852, 'grad_norm': 11.482412338256836, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.47it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.85it/s]                                               {'loss': 0.3492, 'grad_norm': 2.932119846343994, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.85it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.74it/s]                                               {'loss': 0.1403, 'grad_norm': 2.5241806507110596, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.74it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.63it/s]                                               {'loss': 0.6618, 'grad_norm': 2.7779347896575928, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.63it/s] 50%|█████     | 20/40 [00:12<00:12,  1.61it/s]                                               {'loss': 0.3193, 'grad_norm': 5.941306114196777, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.61it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.54it/s]                                               {'loss': 0.0969, 'grad_norm': 2.9183197021484375, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.54it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.53it/s]                                               {'loss': 0.3066, 'grad_norm': 5.25111722946167, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.53it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.52it/s]                                               {'loss': 0.6644, 'grad_norm': 12.473626136779785, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.52it/s]                                               {'loss': 0.0185, 'grad_norm': 1.2729566097259521, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.52it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.84it/s]                                               {'loss': 0.1834, 'grad_norm': 4.438953399658203, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.84it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.74it/s]                                               {'loss': 0.5722, 'grad_norm': 5.892319679260254, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.74it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.66it/s]                                               {'loss': 0.2793, 'grad_norm': 5.262836933135986, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.66it/s] 70%|███████   | 28/40 [00:17<00:07,  1.57it/s]                                               {'loss': 0.1821, 'grad_norm': 5.433582305908203, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.57it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.58it/s]                                               {'loss': 0.0475, 'grad_norm': 2.5838892459869385, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.58it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.52it/s]                                               {'loss': 0.2174, 'grad_norm': 2.003894090652466, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.52it/s] 78%|███████▊  | 31/40 [00:19<00:06,  1.48it/s]                                               {'loss': 0.045, 'grad_norm': 1.1920239925384521, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:06,  1.48it/s]                                               {'loss': 0.0957, 'grad_norm': 8.893177032470703, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.88it/s]                                               {'loss': 0.3763, 'grad_norm': 0.6225054264068604, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.88it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.74it/s]                                               {'loss': 0.0358, 'grad_norm': 0.9643247723579407, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.74it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.85it/s]                                               {'loss': 0.1413, 'grad_norm': 0.821615993976593, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.85it/s] 90%|█████████ | 36/40 [00:21<00:01,  2.04it/s]                                               {'loss': 0.1155, 'grad_norm': 3.7802252769470215, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:01,  2.04it/s] 92%|█████████▎| 37/40 [00:22<00:01,  2.22it/s]                                               {'loss': 0.0394, 'grad_norm': 2.09875226020813, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  2.22it/s] 95%|█████████▌| 38/40 [00:22<00:00,  2.38it/s]                                               {'loss': 0.1831, 'grad_norm': 2.3514387607574463, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:00,  2.38it/s] 98%|█████████▊| 39/40 [00:22<00:00,  2.50it/s]                                               {'loss': 0.1614, 'grad_norm': 2.552165985107422, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  2.50it/s]                                               {'loss': 0.178, 'grad_norm': 14.93796443939209, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.50it/s]                                               {'train_runtime': 23.1517, 'train_samples_per_second': 24.404, 'train_steps_per_second': 1.728, 'train_loss': 0.5777512380853296, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.50it/s]100%|██████████| 40/40 [00:23<00:00,  1.73it/s]
CLIENT:58
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.60it/s]                                              {'loss': 3.1278, 'grad_norm': 14.827306747436523, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.60it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]                                              {'loss': 1.79, 'grad_norm': 13.184493064880371, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:02<00:24,  1.48it/s]                                              {'loss': 1.4533, 'grad_norm': 11.915560722351074, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s]                                              {'loss': 1.6922, 'grad_norm': 18.33230972290039, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s]                                              {'loss': 0.6936, 'grad_norm': 11.827888488769531, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s]                                              {'loss': 2.3176, 'grad_norm': 27.779706954956055, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 1.8939, 'grad_norm': 15.148184776306152, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s] 20%|██        | 8/40 [00:04<00:17,  1.87it/s]                                              {'loss': 0.1229, 'grad_norm': 8.77801513671875, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:17,  1.87it/s] 22%|██▎       | 9/40 [00:05<00:18,  1.71it/s]                                              {'loss': 0.3504, 'grad_norm': 5.135064601898193, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:18,  1.71it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s]                                               {'loss': 0.5612, 'grad_norm': 8.156752586364746, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s] 28%|██▊       | 11/40 [00:06<00:18,  1.61it/s]                                               {'loss': 0.7919, 'grad_norm': 6.854485988616943, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:18,  1.61it/s] 30%|███       | 12/40 [00:07<00:18,  1.53it/s]                                               {'loss': 1.0336, 'grad_norm': 9.889195442199707, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:18,  1.53it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.54it/s]                                               {'loss': 0.8194, 'grad_norm': 8.883554458618164, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.54it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.52it/s]                                               {'loss': 0.3688, 'grad_norm': 6.69284725189209, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.47it/s]                                               {'loss': 0.7499, 'grad_norm': 9.1530179977417, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.47it/s]                                               {'loss': 0.0255, 'grad_norm': 1.315610647201538, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.47it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.4992, 'grad_norm': 5.077654838562012, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s]                                               {'loss': 0.4771, 'grad_norm': 7.721613883972168, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.64it/s]                                               {'loss': 0.3997, 'grad_norm': 4.910811424255371, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.64it/s] 50%|█████     | 20/40 [00:12<00:12,  1.63it/s]                                               {'loss': 0.2156, 'grad_norm': 3.3173372745513916, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.63it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s]                                               {'loss': 0.4269, 'grad_norm': 6.780567169189453, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.56it/s]                                               {'loss': 0.4624, 'grad_norm': 4.608253002166748, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.56it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.0855, 'grad_norm': 2.3909659385681152, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.8529, 'grad_norm': 40.491294860839844, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.85it/s]                                               {'loss': 0.0641, 'grad_norm': 1.3222824335098267, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.85it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.75it/s]                                               {'loss': 0.1528, 'grad_norm': 2.510741710662842, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.75it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s]                                               {'loss': 0.0961, 'grad_norm': 2.546983242034912, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s] 70%|███████   | 28/40 [00:17<00:07,  1.59it/s]                                               {'loss': 0.1197, 'grad_norm': 3.70589280128479, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.59it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.59it/s]                                               {'loss': 0.2037, 'grad_norm': 4.541510105133057, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.54it/s]                                               {'loss': 0.0565, 'grad_norm': 1.2109211683273315, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.54it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.51it/s]                                               {'loss': 0.3412, 'grad_norm': 2.7261788845062256, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.51it/s]                                               {'loss': 0.0026, 'grad_norm': 0.13938671350479126, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.51it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.90it/s]                                               {'loss': 0.3782, 'grad_norm': 6.836737632751465, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.90it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.77it/s]                                               {'loss': 0.0411, 'grad_norm': 0.835265040397644, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s]                                               {'loss': 0.0498, 'grad_norm': 0.7587913274765015, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.65it/s]                                               {'loss': 0.0631, 'grad_norm': 1.4497703313827515, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.65it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.58it/s]                                               {'loss': 0.0454, 'grad_norm': 1.2964959144592285, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s]                                               {'loss': 0.056, 'grad_norm': 1.6140344142913818, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.58it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]                                               {'loss': 0.0182, 'grad_norm': 0.6061039566993713, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]                                               {'loss': 0.0085, 'grad_norm': 0.4341649115085602, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.52it/s]                                               {'train_runtime': 24.5253, 'train_samples_per_second': 23.037, 'train_steps_per_second': 1.631, 'train_loss': 0.5727073935908266, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.52it/s]100%|██████████| 40/40 [00:24<00:00,  1.63it/s]
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]                                              {'loss': 3.5202, 'grad_norm': 9.082786560058594, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.46it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]                                              {'loss': 1.5257, 'grad_norm': 9.340643882751465, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:01<00:23,  1.55it/s]                                              {'loss': 2.0308, 'grad_norm': 21.4294376373291, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.55it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s]                                              {'loss': 1.4989, 'grad_norm': 12.1661376953125, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 2.3222, 'grad_norm': 17.680801391601562, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s]                                              {'loss': 2.041, 'grad_norm': 18.66741371154785, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s]                                              {'loss': 1.4574, 'grad_norm': 13.317667007446289, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.49it/s] 20%|██        | 8/40 [00:04<00:16,  1.96it/s]                                              {'loss': 4.6823, 'grad_norm': 60.233585357666016, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.96it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.80it/s]                                              {'loss': 0.8655, 'grad_norm': 11.129616737365723, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.80it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s]                                               {'loss': 1.172, 'grad_norm': 11.044990539550781, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.61it/s]                                               {'loss': 0.6772, 'grad_norm': 6.524439334869385, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.61it/s] 30%|███       | 12/40 [00:07<00:17,  1.60it/s]                                               {'loss': 0.5135, 'grad_norm': 5.552994728088379, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.60it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s]                                               {'loss': 1.1556, 'grad_norm': 6.601268291473389, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s]                                               {'loss': 0.7153, 'grad_norm': 9.693042755126953, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.55it/s]                                               {'loss': 1.02, 'grad_norm': 8.458907127380371, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.55it/s]                                               {'loss': 0.1192, 'grad_norm': 5.1950883865356445, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.55it/s] 42%|████▎     | 17/40 [00:10<00:11,  1.92it/s]                                               {'loss': 0.8406, 'grad_norm': 3.711913585662842, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:11,  1.92it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s]                                               {'loss': 0.599, 'grad_norm': 6.226101875305176, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s]                                               {'loss': 0.3392, 'grad_norm': 4.350839138031006, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s] 50%|█████     | 20/40 [00:12<00:12,  1.64it/s]                                               {'loss': 0.4122, 'grad_norm': 7.6072492599487305, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.64it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.64it/s]                                               {'loss': 0.5297, 'grad_norm': 3.3725085258483887, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.64it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.59it/s]                                               {'loss': 0.409, 'grad_norm': 5.250977993011475, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.59it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.4037, 'grad_norm': 5.98693323135376, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.3492, 'grad_norm': 21.568389892578125, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.92it/s]                                               {'loss': 0.2077, 'grad_norm': 3.495856523513794, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  1.92it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s]                                               {'loss': 0.483, 'grad_norm': 1.801919937133789, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s]                                               {'loss': 0.1442, 'grad_norm': 2.566547393798828, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s] 70%|███████   | 28/40 [00:16<00:07,  1.67it/s]                                               {'loss': 0.3149, 'grad_norm': 3.8156352043151855, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.67it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.59it/s]                                               {'loss': 0.6529, 'grad_norm': 4.216691493988037, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.55it/s]                                               {'loss': 0.1191, 'grad_norm': 1.3848588466644287, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.55it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.58it/s]                                               {'loss': 0.176, 'grad_norm': 6.448452949523926, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.58it/s]                                               {'loss': 0.0471, 'grad_norm': 3.784745216369629, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.58it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.90it/s]                                               {'loss': 0.1993, 'grad_norm': 7.403995513916016, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.90it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.82it/s]                                               {'loss': 0.1285, 'grad_norm': 3.3729255199432373, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.82it/s] 88%|████████▊ | 35/40 [00:20<00:02,  1.73it/s]                                               {'loss': 0.2494, 'grad_norm': 1.3709644079208374, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.73it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.63it/s]                                               {'loss': 0.0936, 'grad_norm': 2.1650447845458984, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.63it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.63it/s]                                               {'loss': 0.4957, 'grad_norm': 1.298012137413025, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.63it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.57it/s]                                               {'loss': 0.071, 'grad_norm': 1.5217207670211792, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.57it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.53it/s]                                               {'loss': 0.3043, 'grad_norm': 1.330749273300171, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.53it/s]                                               {'loss': 0.5706, 'grad_norm': 12.456207275390625, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.53it/s]                                               {'train_runtime': 24.0378, 'train_samples_per_second': 23.505, 'train_steps_per_second': 1.664, 'train_loss': 0.8364211472682654, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.53it/s]100%|██████████| 40/40 [00:24<00:00,  1.66it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.00it/s]                                              {'loss': 3.0823, 'grad_norm': 12.59457778930664, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.00it/s]  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]                                              {'loss': 2.0135, 'grad_norm': 11.159740447998047, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.99it/s]  8%|▊         | 3/40 [00:01<00:12,  2.95it/s]                                              {'loss': 0.8083, 'grad_norm': 10.199405670166016, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.95it/s] 10%|█         | 4/40 [00:01<00:12,  2.94it/s]                                              {'loss': 0.799, 'grad_norm': 11.15649127960205, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.94it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.89it/s]                                              {'loss': 1.3639, 'grad_norm': 12.304197311401367, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.89it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.89it/s]                                              {'loss': 0.878, 'grad_norm': 9.454364776611328, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.89it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.93it/s]                                              {'loss': 1.9248, 'grad_norm': 16.034393310546875, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.93it/s] 20%|██        | 8/40 [00:03<00:13,  2.31it/s]                                              {'loss': 0.4276, 'grad_norm': 35.41013717651367, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:13,  2.31it/s] 22%|██▎       | 9/40 [00:03<00:14,  2.08it/s]                                              {'loss': 0.6063, 'grad_norm': 7.77763557434082, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:14,  2.08it/s] 25%|██▌       | 10/40 [00:04<00:15,  1.91it/s]                                               {'loss': 0.4667, 'grad_norm': 7.245619773864746, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:15,  1.91it/s] 28%|██▊       | 11/40 [00:04<00:16,  1.72it/s]                                               {'loss': 0.5329, 'grad_norm': 6.654698848724365, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:16,  1.72it/s] 30%|███       | 12/40 [00:05<00:16,  1.68it/s]                                               {'loss': 0.5673, 'grad_norm': 4.6084980964660645, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:16,  1.68it/s] 32%|███▎      | 13/40 [00:06<00:16,  1.62it/s]                                               {'loss': 0.5281, 'grad_norm': 2.679605484008789, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.62it/s] 35%|███▌      | 14/40 [00:06<00:16,  1.54it/s]                                               {'loss': 0.3415, 'grad_norm': 4.871201992034912, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:16,  1.54it/s] 38%|███▊      | 15/40 [00:07<00:15,  1.59it/s]                                               {'loss': 0.922, 'grad_norm': 8.965432167053223, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:15,  1.59it/s]                                               {'loss': 0.0005, 'grad_norm': 0.0639185905456543, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:15,  1.59it/s] 42%|████▎     | 17/40 [00:08<00:11,  1.93it/s]                                               {'loss': 0.5748, 'grad_norm': 5.51188325881958, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:11,  1.93it/s] 45%|████▌     | 18/40 [00:09<00:12,  1.78it/s]                                               {'loss': 0.346, 'grad_norm': 6.1346940994262695, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:12,  1.78it/s] 48%|████▊     | 19/40 [00:09<00:12,  1.75it/s]                                               {'loss': 0.1282, 'grad_norm': 2.498838424682617, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:12,  1.75it/s] 50%|█████     | 20/40 [00:10<00:12,  1.63it/s]                                               {'loss': 0.1179, 'grad_norm': 2.0554311275482178, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:12,  1.63it/s] 52%|█████▎    | 21/40 [00:10<00:11,  1.64it/s]                                               {'loss': 0.1679, 'grad_norm': 4.079318046569824, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:11,  1.64it/s] 55%|█████▌    | 22/40 [00:11<00:11,  1.59it/s]                                               {'loss': 0.511, 'grad_norm': 3.125251531600952, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:11,  1.59it/s] 57%|█████▊    | 23/40 [00:12<00:11,  1.54it/s]                                               {'loss': 0.1088, 'grad_norm': 3.130807876586914, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:11,  1.54it/s]                                               {'loss': 0.0665, 'grad_norm': 1.5931528806686401, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.54it/s] 62%|██████▎   | 25/40 [00:13<00:07,  1.94it/s]                                               {'loss': 0.0749, 'grad_norm': 1.24760901927948, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:07,  1.94it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.80it/s]                                               {'loss': 0.0214, 'grad_norm': 0.5158188343048096, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.69it/s]                                               {'loss': 0.0314, 'grad_norm': 0.894588828086853, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.69it/s] 70%|███████   | 28/40 [00:14<00:07,  1.70it/s]                                               {'loss': 0.3939, 'grad_norm': 0.8828896284103394, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.70it/s] 72%|███████▎  | 29/40 [00:15<00:06,  1.59it/s]                                               {'loss': 0.0543, 'grad_norm': 5.895573616027832, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.56it/s]                                               {'loss': 0.2138, 'grad_norm': 4.334095001220703, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.56it/s]                                               {'loss': 0.3545, 'grad_norm': 2.3897557258605957, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.56it/s]                                               {'loss': 0.0065, 'grad_norm': 0.5215153098106384, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.56it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.89it/s]                                               {'loss': 0.0135, 'grad_norm': 0.4020785689353943, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.89it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.87it/s]                                               {'loss': 0.3366, 'grad_norm': 2.372479200363159, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.87it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.72it/s]                                               {'loss': 0.0405, 'grad_norm': 1.9285191297531128, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.72it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.66it/s]                                               {'loss': 0.0414, 'grad_norm': 0.9030976295471191, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.66it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.63it/s]                                               {'loss': 0.0358, 'grad_norm': 0.8314752578735352, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.63it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.57it/s]                                               {'loss': 0.3478, 'grad_norm': 1.218543291091919, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.57it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]                                               {'loss': 0.015, 'grad_norm': 0.6280198097229004, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.57it/s]                                               {'loss': 0.0047, 'grad_norm': 0.2218206375837326, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.57it/s]                                               {'train_runtime': 22.0317, 'train_samples_per_second': 25.645, 'train_steps_per_second': 1.816, 'train_loss': 0.4817527174425777, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.57it/s]100%|██████████| 40/40 [00:22<00:00,  1.82it/s]
CLIENT:84
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]                                              {'loss': 1.8371, 'grad_norm': 7.2596001625061035, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]  5%|▌         | 2/40 [00:01<00:29,  1.27it/s]                                              {'loss': 1.8077, 'grad_norm': 8.64815902709961, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:29,  1.27it/s]  8%|▊         | 3/40 [00:02<00:27,  1.32it/s]                                              {'loss': 1.2125, 'grad_norm': 12.642180442810059, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.32it/s] 10%|█         | 4/40 [00:03<00:25,  1.39it/s]                                              {'loss': 1.4522, 'grad_norm': 13.674039840698242, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:25,  1.39it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s]                                              {'loss': 1.1936, 'grad_norm': 9.987100601196289, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s]                                              {'loss': 0.9601, 'grad_norm': 10.340507507324219, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:05<00:22,  1.45it/s]                                              {'loss': 1.5615, 'grad_norm': 14.063216209411621, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:22,  1.45it/s] 20%|██        | 8/40 [00:05<00:16,  1.99it/s]                                              {'loss': 6.058, 'grad_norm': 79.1085433959961, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:16,  1.99it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 1.0022, 'grad_norm': 20.200410842895508, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.67it/s]                                               {'loss': 0.6813, 'grad_norm': 10.186119079589844, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.67it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.63it/s]                                               {'loss': 0.7794, 'grad_norm': 7.885786533355713, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.63it/s] 30%|███       | 12/40 [00:07<00:17,  1.59it/s]                                               {'loss': 0.5111, 'grad_norm': 3.1631693840026855, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.59it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.53it/s]                                               {'loss': 0.9406, 'grad_norm': 5.878545761108398, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.53it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.61it/s]                                               {'loss': 0.2971, 'grad_norm': 4.342160224914551, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.61it/s] 38%|███▊      | 15/40 [00:09<00:13,  1.87it/s]                                               {'loss': 0.5724, 'grad_norm': 5.5447587966918945, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:13,  1.87it/s]                                               {'loss': 0.0254, 'grad_norm': 1.5106749534606934, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:12,  1.87it/s] 42%|████▎     | 17/40 [00:09<00:08,  2.66it/s]                                               {'loss': 0.2648, 'grad_norm': 2.9005866050720215, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:08,  2.66it/s] 45%|████▌     | 18/40 [00:10<00:08,  2.72it/s]                                               {'loss': 0.3918, 'grad_norm': 2.624019145965576, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:08,  2.72it/s] 48%|████▊     | 19/40 [00:10<00:07,  2.76it/s]                                               {'loss': 0.0929, 'grad_norm': 1.9083406925201416, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:07,  2.76it/s] 50%|█████     | 20/40 [00:10<00:07,  2.80it/s]                                               {'loss': 0.774, 'grad_norm': 3.8551852703094482, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:07,  2.80it/s] 52%|█████▎    | 21/40 [00:11<00:06,  2.82it/s]                                               {'loss': 0.0818, 'grad_norm': 2.500978708267212, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:06,  2.82it/s] 55%|█████▌    | 22/40 [00:11<00:06,  2.86it/s]                                               {'loss': 0.5037, 'grad_norm': 10.153043746948242, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:06,  2.86it/s] 57%|█████▊    | 23/40 [00:12<00:07,  2.32it/s]                                               {'loss': 0.149, 'grad_norm': 3.832287311553955, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:07,  2.32it/s]                                               {'loss': 0.0006, 'grad_norm': 0.03162754327058792, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:06,  2.32it/s] 62%|██████▎   | 25/40 [00:12<00:05,  2.55it/s]                                               {'loss': 0.0205, 'grad_norm': 0.4787682592868805, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:05,  2.55it/s] 65%|██████▌   | 26/40 [00:13<00:05,  2.44it/s]                                               {'loss': 0.1231, 'grad_norm': 2.413259983062744, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:05,  2.44it/s] 68%|██████▊   | 27/40 [00:13<00:05,  2.29it/s]                                               {'loss': 0.5329, 'grad_norm': 3.6241836547851562, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:05,  2.29it/s] 70%|███████   | 28/40 [00:14<00:05,  2.06it/s]                                               {'loss': 0.2487, 'grad_norm': 1.3652154207229614, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:05,  2.06it/s] 72%|███████▎  | 29/40 [00:15<00:06,  1.83it/s]                                               {'loss': 0.0557, 'grad_norm': 1.4512510299682617, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:06,  1.83it/s] 75%|███████▌  | 30/40 [00:15<00:05,  1.69it/s]                                               {'loss': 0.3929, 'grad_norm': 5.257534980773926, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:05,  1.69it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.68it/s]                                               {'loss': 0.1299, 'grad_norm': 4.077028274536133, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.68it/s]                                               {'loss': 0.0116, 'grad_norm': 0.7891132831573486, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:04,  1.68it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.96it/s]                                               {'loss': 0.0134, 'grad_norm': 0.3808743953704834, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.96it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.80it/s]                                               {'loss': 0.0157, 'grad_norm': 0.42195725440979004, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.80it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.77it/s]                                               {'loss': 0.1614, 'grad_norm': 1.4043759107589722, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.77it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.64it/s]                                               {'loss': 0.0837, 'grad_norm': 3.0308892726898193, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.64it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.68it/s]                                               {'loss': 0.3737, 'grad_norm': 1.45181405544281, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.68it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.58it/s]                                               {'loss': 0.2056, 'grad_norm': 0.3150084614753723, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.58it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.55it/s]                                               {'loss': 0.0302, 'grad_norm': 1.1918041706085205, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.55it/s]100%|██████████| 40/40 [00:21<00:00,  2.06it/s]                                               {'loss': 3.0661, 'grad_norm': 2.2603824138641357, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.06it/s]                                               {'train_runtime': 21.5952, 'train_samples_per_second': 26.163, 'train_steps_per_second': 1.852, 'train_loss': 0.7153953002372873, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.06it/s]100%|██████████| 40/40 [00:21<00:00,  1.85it/s]
CLIENT:54
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:25,  1.50it/s]                                              {'loss': 3.4309, 'grad_norm': 12.671865463256836, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:25,  1.50it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]                                              {'loss': 1.8739, 'grad_norm': 10.793410301208496, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:02<00:24,  1.50it/s]                                              {'loss': 2.1375, 'grad_norm': 12.904083251953125, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s]                                              {'loss': 0.949, 'grad_norm': 12.84724235534668, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s]                                              {'loss': 1.7189, 'grad_norm': 19.475055694580078, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.52it/s]                                              {'loss': 3.2417, 'grad_norm': 27.330848693847656, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.52it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s]                                              {'loss': 1.5094, 'grad_norm': 20.24053955078125, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s]                                              {'loss': 1.3466, 'grad_norm': 62.566673278808594, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 1.3345, 'grad_norm': 18.879011154174805, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s]                                               {'loss': 0.5525, 'grad_norm': 5.082281112670898, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.65it/s]                                               {'loss': 1.0355, 'grad_norm': 9.154459953308105, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.65it/s] 30%|███       | 12/40 [00:07<00:16,  1.65it/s]                                               {'loss': 0.7238, 'grad_norm': 5.928227424621582, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.65it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.888, 'grad_norm': 6.590265274047852, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s]                                               {'loss': 1.1187, 'grad_norm': 10.769098281860352, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:09<00:15,  1.57it/s]                                               {'loss': 1.2983, 'grad_norm': 9.021500587463379, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:15,  1.57it/s]                                               {'loss': 0.385, 'grad_norm': 11.70278263092041, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.57it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.6123, 'grad_norm': 5.015171051025391, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.75it/s]                                               {'loss': 0.6694, 'grad_norm': 4.832313060760498, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.75it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.73it/s]                                               {'loss': 0.1331, 'grad_norm': 3.0317795276641846, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.73it/s] 50%|█████     | 20/40 [00:12<00:12,  1.60it/s]                                               {'loss': 1.028, 'grad_norm': 11.925082206726074, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.60it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.69it/s]                                               {'loss': 0.6496, 'grad_norm': 4.898014545440674, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.69it/s] 55%|█████▌    | 22/40 [00:13<00:09,  1.92it/s]                                               {'loss': 0.6224, 'grad_norm': 6.213669300079346, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:09,  1.92it/s] 57%|█████▊    | 23/40 [00:13<00:07,  2.13it/s]                                               {'loss': 0.3625, 'grad_norm': 7.565072536468506, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:07,  2.13it/s]                                               {'loss': 0.0041, 'grad_norm': 0.2783968150615692, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:07,  2.13it/s] 62%|██████▎   | 25/40 [00:13<00:05,  2.91it/s]                                               {'loss': 0.5118, 'grad_norm': 6.311507225036621, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:05,  2.91it/s] 65%|██████▌   | 26/40 [00:14<00:04,  2.89it/s]                                               {'loss': 0.5628, 'grad_norm': 7.1637396812438965, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:04,  2.89it/s] 68%|██████▊   | 27/40 [00:14<00:04,  2.89it/s]                                               {'loss': 0.4157, 'grad_norm': 3.0759968757629395, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:04,  2.89it/s] 70%|███████   | 28/40 [00:14<00:04,  2.91it/s]                                               {'loss': 0.188, 'grad_norm': 2.9652700424194336, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:04,  2.91it/s] 72%|███████▎  | 29/40 [00:15<00:03,  2.92it/s]                                               {'loss': 0.4224, 'grad_norm': 5.452448844909668, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:03,  2.92it/s] 75%|███████▌  | 30/40 [00:15<00:03,  2.90it/s]                                               {'loss': 0.3416, 'grad_norm': 5.269854545593262, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:03,  2.90it/s] 78%|███████▊  | 31/40 [00:15<00:03,  2.89it/s]                                               {'loss': 0.073, 'grad_norm': 1.568918228149414, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:03,  2.89it/s]                                               {'loss': 0.1732, 'grad_norm': 12.993086814880371, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:02,  2.89it/s] 82%|████████▎ | 33/40 [00:16<00:02,  2.76it/s]                                               {'loss': 0.1571, 'grad_norm': 3.558495283126831, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:02,  2.76it/s] 85%|████████▌ | 34/40 [00:17<00:02,  2.17it/s]                                               {'loss': 0.1696, 'grad_norm': 3.775068998336792, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:02,  2.17it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.86it/s]                                               {'loss': 0.2053, 'grad_norm': 3.5789296627044678, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.86it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.68it/s]                                               {'loss': 0.0839, 'grad_norm': 1.746775507926941, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.68it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.57it/s]                                               {'loss': 0.1685, 'grad_norm': 2.916044235229492, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.49it/s]                                               {'loss': 0.3397, 'grad_norm': 2.081679105758667, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.49it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.44it/s]                                               {'loss': 0.2907, 'grad_norm': 3.2265145778656006, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.44it/s]                                               {'loss': 0.0221, 'grad_norm': 1.5964549779891968, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.44it/s]                                               {'train_runtime': 21.6472, 'train_samples_per_second': 26.1, 'train_steps_per_second': 1.848, 'train_loss': 0.7937713688006625, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.44it/s]100%|██████████| 40/40 [00:21<00:00,  1.85it/s]
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.31it/s]                                              {'loss': 1.7969, 'grad_norm': 10.23627758026123, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.31it/s]  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]                                              {'loss': 1.5903, 'grad_norm': 11.329687118530273, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]  8%|▊         | 3/40 [00:02<00:28,  1.31it/s]                                              {'loss': 2.0987, 'grad_norm': 21.076641082763672, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.31it/s] 10%|█         | 4/40 [00:03<00:27,  1.32it/s]                                              {'loss': 3.5444, 'grad_norm': 25.273832321166992, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.32it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s]                                              {'loss': 2.3827, 'grad_norm': 17.69165802001953, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s]                                              {'loss': 1.8869, 'grad_norm': 14.596670150756836, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 1.1355, 'grad_norm': 13.941975593566895, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s] 20%|██        | 8/40 [00:06<00:24,  1.33it/s]                                              {'loss': 4.5997, 'grad_norm': 62.07952880859375, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:24,  1.33it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s]                                              {'loss': 0.7896, 'grad_norm': 14.540372848510742, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s]                                               {'loss': 0.8471, 'grad_norm': 9.601402282714844, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s] 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s]                                               {'loss': 1.0664, 'grad_norm': 9.964254379272461, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s] 30%|███       | 12/40 [00:09<00:21,  1.32it/s]                                               {'loss': 0.6923, 'grad_norm': 7.393306732177734, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.32it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.35it/s]                                               {'loss': 1.1651, 'grad_norm': 12.389617919921875, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.35it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s]                                               {'loss': 0.951, 'grad_norm': 10.670061111450195, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.34it/s]                                               {'loss': 0.6429, 'grad_norm': 7.798938274383545, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.34it/s] 40%|████      | 16/40 [00:11<00:13,  1.75it/s]                                               {'loss': 0.6118, 'grad_norm': 29.291568756103516, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:13,  1.75it/s] 42%|████▎     | 17/40 [00:12<00:14,  1.59it/s]                                               {'loss': 0.1277, 'grad_norm': 1.7645623683929443, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:14,  1.59it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.49it/s]                                               {'loss': 0.2561, 'grad_norm': 5.594659328460693, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:14,  1.49it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s]                                               {'loss': 0.4974, 'grad_norm': 7.4782538414001465, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:14<00:14,  1.40it/s]                                               {'loss': 0.4297, 'grad_norm': 6.833809852600098, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:14,  1.40it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.37it/s]                                               {'loss': 0.9014, 'grad_norm': 60.14875411987305, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.37it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.36it/s]                                               {'loss': 0.3857, 'grad_norm': 6.760819911956787, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.36it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.35it/s]                                               {'loss': 0.3966, 'grad_norm': 8.383345603942871, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.35it/s]                                               {'loss': 0.0599, 'grad_norm': 2.688854455947876, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.35it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s]                                               {'loss': 0.1242, 'grad_norm': 3.494546890258789, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.57it/s]                                               {'loss': 0.5442, 'grad_norm': 4.182378768920898, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.57it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s]                                               {'loss': 0.1892, 'grad_norm': 4.410908222198486, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s]                                               {'loss': 0.241, 'grad_norm': 6.519782066345215, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.1834, 'grad_norm': 6.050084114074707, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s]                                               {'loss': 0.1644, 'grad_norm': 7.784023761749268, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.6461, 'grad_norm': 17.70903968811035, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.37it/s]                                               {'loss': 0.0158, 'grad_norm': 0.9999259114265442, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.37it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s]                                               {'loss': 0.1286, 'grad_norm': 3.84116792678833, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.57it/s]                                               {'loss': 0.0426, 'grad_norm': 1.0500231981277466, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.57it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s]                                               {'loss': 0.0851, 'grad_norm': 2.321303367614746, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s]                                               {'loss': 0.4536, 'grad_norm': 5.059411525726318, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.41it/s]                                               {'loss': 0.2141, 'grad_norm': 14.348227500915527, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.41it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s]                                               {'loss': 0.0808, 'grad_norm': 2.496744155883789, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.1997, 'grad_norm': 5.843667030334473, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.1332, 'grad_norm': 13.986310958862305, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]                                               {'train_runtime': 27.8664, 'train_samples_per_second': 20.275, 'train_steps_per_second': 1.435, 'train_loss': 0.8075445502065122, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]100%|██████████| 40/40 [00:27<00:00,  1.44it/s]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]                                              {'loss': 3.3871, 'grad_norm': 11.926647186279297, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]                                              {'loss': 1.2574, 'grad_norm': 10.992573738098145, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]  8%|▊         | 3/40 [00:02<00:28,  1.32it/s]                                              {'loss': 1.6683, 'grad_norm': 18.033605575561523, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.32it/s] 10%|█         | 4/40 [00:03<00:27,  1.32it/s]                                              {'loss': 1.9925, 'grad_norm': 16.886491775512695, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.32it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s]                                              {'loss': 1.1349, 'grad_norm': 16.124523162841797, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s]                                              {'loss': 1.8072, 'grad_norm': 17.03399658203125, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 1.8902, 'grad_norm': 20.067773818969727, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s] 20%|██        | 8/40 [00:06<00:25,  1.28it/s]                                              {'loss': 0.8947, 'grad_norm': 41.64577865600586, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:25,  1.28it/s] 22%|██▎       | 9/40 [00:06<00:24,  1.29it/s]                                              {'loss': 1.0587, 'grad_norm': 10.01032829284668, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:24,  1.29it/s] 25%|██▌       | 10/40 [00:07<00:23,  1.30it/s]                                               {'loss': 0.703, 'grad_norm': 11.137451171875, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:23,  1.30it/s] 28%|██▊       | 11/40 [00:08<00:22,  1.30it/s]                                               {'loss': 0.3633, 'grad_norm': 5.777419567108154, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:22,  1.30it/s] 30%|███       | 12/40 [00:09<00:21,  1.31it/s]                                               {'loss': 0.7424, 'grad_norm': 7.505345821380615, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.31it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.31it/s]                                               {'loss': 1.0214, 'grad_norm': 8.586358070373535, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.31it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s]                                               {'loss': 0.5778, 'grad_norm': 7.141862869262695, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s] 38%|███▊      | 15/40 [00:11<00:19,  1.31it/s]                                               {'loss': 0.545, 'grad_norm': 7.516394138336182, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:19,  1.31it/s]                                               {'loss': 0.5761, 'grad_norm': 21.66204833984375, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.31it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.66it/s]                                               {'loss': 0.4434, 'grad_norm': 6.431887149810791, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.66it/s] 45%|████▌     | 18/40 [00:13<00:14,  1.55it/s]                                               {'loss': 0.5228, 'grad_norm': 11.155396461486816, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:14,  1.55it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.49it/s]                                               {'loss': 0.7337, 'grad_norm': 5.925664901733398, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.49it/s] 50%|█████     | 20/40 [00:14<00:13,  1.43it/s]                                               {'loss': 0.3492, 'grad_norm': 2.0552263259887695, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.43it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s]                                               {'loss': 0.2947, 'grad_norm': 4.6581220626831055, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s]                                               {'loss': 0.397, 'grad_norm': 5.575479507446289, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.1485, 'grad_norm': 4.425378799438477, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s] 60%|██████    | 24/40 [00:16<00:08,  1.83it/s]                                               {'loss': 0.0016, 'grad_norm': 0.08028591424226761, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:08,  1.83it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.64it/s]                                               {'loss': 0.4081, 'grad_norm': 5.930342197418213, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.64it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.54it/s]                                               {'loss': 0.1545, 'grad_norm': 2.7459936141967773, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:09,  1.54it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.46it/s]                                               {'loss': 0.056, 'grad_norm': 2.404252767562866, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.42it/s]                                               {'loss': 0.5098, 'grad_norm': 1.652241587638855, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.42it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.39it/s]                                               {'loss': 0.0494, 'grad_norm': 0.9489864706993103, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.39it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.37it/s]                                               {'loss': 0.1042, 'grad_norm': 1.4869104623794556, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.37it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.1274, 'grad_norm': 3.758570671081543, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.001, 'grad_norm': 0.1119898110628128, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.36it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s]                                               {'loss': 0.4912, 'grad_norm': 2.334210157394409, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.69it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s]                                               {'loss': 0.036, 'grad_norm': 0.9883460402488708, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s]                                               {'loss': 0.0316, 'grad_norm': 0.7045625448226929, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s]                                               {'loss': 0.0517, 'grad_norm': 1.2209374904632568, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.42it/s]                                               {'loss': 0.1194, 'grad_norm': 4.208911418914795, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s]                                               {'loss': 0.2525, 'grad_norm': 0.8978046774864197, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0491, 'grad_norm': 1.2423264980316162, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0014, 'grad_norm': 0.12565629184246063, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]                                               {'train_runtime': 27.9122, 'train_samples_per_second': 20.242, 'train_steps_per_second': 1.433, 'train_loss': 0.6238489867464523, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]100%|██████████| 40/40 [00:27<00:00,  1.43it/s]
CLIENT:40
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]                                              {'loss': 2.9108, 'grad_norm': 11.759625434875488, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.11s/it]  5%|▌         | 2/40 [00:01<00:34,  1.11it/s]                                              {'loss': 1.3306, 'grad_norm': 8.912443161010742, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:34,  1.11it/s]  8%|▊         | 3/40 [00:02<00:30,  1.20it/s]                                              {'loss': 1.8107, 'grad_norm': 17.858484268188477, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:30,  1.20it/s] 10%|█         | 4/40 [00:03<00:29,  1.24it/s]                                              {'loss': 1.6999, 'grad_norm': 14.061176300048828, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:29,  1.24it/s] 12%|█▎        | 5/40 [00:04<00:27,  1.27it/s]                                              {'loss': 0.4793, 'grad_norm': 6.442213535308838, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:27,  1.27it/s] 15%|█▌        | 6/40 [00:04<00:26,  1.28it/s]                                              {'loss': 1.2631, 'grad_norm': 18.123779296875, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:26,  1.28it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 1.4225, 'grad_norm': 13.838550567626953, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 5.7324, 'grad_norm': 83.34920501708984, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:24,  1.30it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.67it/s]                                              {'loss': 0.9485, 'grad_norm': 9.453690528869629, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.67it/s] 25%|██▌       | 10/40 [00:07<00:19,  1.57it/s]                                               {'loss': 0.6234, 'grad_norm': 7.358465194702148, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:19,  1.57it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s]                                               {'loss': 0.8181, 'grad_norm': 5.884701728820801, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s]                                               {'loss': 1.2287, 'grad_norm': 9.065125465393066, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s]                                               {'loss': 0.6674, 'grad_norm': 5.936068534851074, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s]                                               {'loss': 0.561, 'grad_norm': 5.627188682556152, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.36it/s]                                               {'loss': 0.3129, 'grad_norm': 3.8414204120635986, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.36it/s]                                               {'loss': 2.0126, 'grad_norm': 56.486568450927734, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.36it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.69it/s]                                               {'loss': 0.5575, 'grad_norm': 11.285428047180176, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.69it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s]                                               {'loss': 0.3702, 'grad_norm': 3.8023104667663574, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s]                                               {'loss': 0.3445, 'grad_norm': 4.017489433288574, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s] 50%|█████     | 20/40 [00:14<00:13,  1.45it/s]                                               {'loss': 0.3926, 'grad_norm': 9.46042251586914, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.41it/s]                                               {'loss': 0.3392, 'grad_norm': 2.2963929176330566, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.41it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.38it/s]                                               {'loss': 0.464, 'grad_norm': 4.055619716644287, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.2726, 'grad_norm': 6.21811580657959, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.0067, 'grad_norm': 0.630000114440918, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s]                                               {'loss': 0.1141, 'grad_norm': 1.9726154804229736, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s] 65%|██████▌   | 26/40 [00:17<00:08,  1.57it/s]                                               {'loss': 0.1922, 'grad_norm': 2.4795608520507812, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.57it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s]                                               {'loss': 0.2836, 'grad_norm': 4.117427349090576, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s]                                               {'loss': 0.2651, 'grad_norm': 0.6697323322296143, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.4699, 'grad_norm': 1.6061023473739624, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s]                                               {'loss': 0.1112, 'grad_norm': 1.4946542978286743, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.38it/s]                                               {'loss': 0.1238, 'grad_norm': 1.5047283172607422, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.38it/s]                                               {'loss': 0.3846, 'grad_norm': 14.523002624511719, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.38it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s]                                               {'loss': 0.2098, 'grad_norm': 0.6565999388694763, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s]                                               {'loss': 0.2921, 'grad_norm': 2.9064383506774902, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s]                                               {'loss': 0.0543, 'grad_norm': 1.416202425956726, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s]                                               {'loss': 0.2713, 'grad_norm': 1.9299964904785156, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.41it/s]                                               {'loss': 0.0269, 'grad_norm': 0.6554864048957825, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.41it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s]                                               {'loss': 0.2837, 'grad_norm': 2.6499876976013184, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0461, 'grad_norm': 1.2865431308746338, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0036, 'grad_norm': 0.2969803512096405, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]                                               {'train_runtime': 27.4516, 'train_samples_per_second': 20.582, 'train_steps_per_second': 1.457, 'train_loss': 0.7425359076471068, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:33,  5.04it/s]  1%|          | 3/471 [00:00<02:08,  3.64it/s]  1%|          | 4/471 [00:01<02:29,  3.12it/s]  1%|          | 5/471 [00:01<02:41,  2.89it/s]  1%|▏         | 6/471 [00:01<02:49,  2.75it/s]  1%|▏         | 7/471 [00:02<02:53,  2.67it/s]  2%|▏         | 8/471 [00:02<02:56,  2.62it/s]  2%|▏         | 9/471 [00:03<02:59,  2.57it/s]  2%|▏         | 10/471 [00:03<02:59,  2.57it/s]  2%|▏         | 11/471 [00:03<02:58,  2.58it/s]  3%|▎         | 12/471 [00:04<02:58,  2.57it/s]  3%|▎         | 13/471 [00:04<03:00,  2.53it/s]  3%|▎         | 14/471 [00:05<03:00,  2.54it/s]  3%|▎         | 15/471 [00:05<02:59,  2.54it/s]  3%|▎         | 16/471 [00:05<03:00,  2.52it/s]  4%|▎         | 17/471 [00:06<02:59,  2.53it/s]  4%|▍         | 18/471 [00:06<02:59,  2.53it/s]  4%|▍         | 19/471 [00:07<02:58,  2.53it/s]  4%|▍         | 20/471 [00:07<02:59,  2.51it/s]  4%|▍         | 21/471 [00:07<02:58,  2.51it/s]  5%|▍         | 22/471 [00:08<02:58,  2.52it/s]  5%|▍         | 23/471 [00:08<02:59,  2.50it/s]  5%|▌         | 24/471 [00:09<02:58,  2.51it/s]  5%|▌         | 25/471 [00:09<02:57,  2.52it/s]  6%|▌         | 26/471 [00:09<02:56,  2.52it/s]  6%|▌         | 27/471 [00:10<02:57,  2.51it/s]  6%|▌         | 28/471 [00:10<02:56,  2.51it/s]  6%|▌         | 29/471 [00:11<02:55,  2.52it/s]  6%|▋         | 30/471 [00:11<02:57,  2.49it/s]  7%|▋         | 31/471 [00:11<02:56,  2.50it/s]  7%|▋         | 32/471 [00:12<02:54,  2.51it/s]  7%|▋         | 33/471 [00:12<02:53,  2.53it/s]  7%|▋         | 34/471 [00:13<02:54,  2.51it/s]  7%|▋         | 35/471 [00:13<02:54,  2.50it/s]  8%|▊         | 36/471 [00:13<02:52,  2.52it/s]  8%|▊         | 37/471 [00:14<02:53,  2.50it/s]  8%|▊         | 38/471 [00:14<02:53,  2.50it/s]  8%|▊         | 39/471 [00:15<02:52,  2.51it/s]  8%|▊         | 40/471 [00:15<02:51,  2.51it/s]  9%|▊         | 41/471 [00:15<02:51,  2.51it/s]  9%|▉         | 42/471 [00:16<02:50,  2.52it/s]  9%|▉         | 43/471 [00:16<02:49,  2.53it/s]  9%|▉         | 44/471 [00:17<02:49,  2.51it/s] 10%|▉         | 45/471 [00:17<02:48,  2.52it/s] 10%|▉         | 46/471 [00:17<02:47,  2.53it/s] 10%|▉         | 47/471 [00:18<02:47,  2.54it/s] 10%|█         | 48/471 [00:18<02:47,  2.52it/s] 10%|█         | 49/471 [00:19<02:47,  2.52it/s] 11%|█         | 50/471 [00:19<02:46,  2.53it/s] 11%|█         | 51/471 [00:19<02:47,  2.51it/s] 11%|█         | 52/471 [00:20<02:45,  2.53it/s] 11%|█▏        | 53/471 [00:20<02:45,  2.53it/s] 11%|█▏        | 54/471 [00:21<02:44,  2.53it/s] 12%|█▏        | 55/471 [00:21<02:45,  2.51it/s] 12%|█▏        | 56/471 [00:21<02:45,  2.51it/s] 12%|█▏        | 57/471 [00:22<02:44,  2.52it/s] 12%|█▏        | 58/471 [00:22<02:44,  2.51it/s] 13%|█▎        | 59/471 [00:23<02:43,  2.52it/s] 13%|█▎        | 60/471 [00:23<02:42,  2.54it/s] 13%|█▎        | 61/471 [00:23<02:41,  2.54it/s] 13%|█▎        | 62/471 [00:24<02:42,  2.52it/s] 13%|█▎        | 63/471 [00:24<02:40,  2.54it/s] 14%|█▎        | 64/471 [00:24<02:40,  2.54it/s] 14%|█▍        | 65/471 [00:25<02:41,  2.52it/s] 14%|█▍        | 66/471 [00:25<02:41,  2.51it/s] 14%|█▍        | 67/471 [00:26<02:40,  2.52it/s] 14%|█▍        | 68/471 [00:26<02:39,  2.53it/s] 15%|█▍        | 69/471 [00:26<02:39,  2.51it/s] 15%|█▍        | 70/471 [00:27<02:38,  2.53it/s] 15%|█▌        | 71/471 [00:27<02:38,  2.53it/s] 15%|█▌        | 72/471 [00:28<02:38,  2.51it/s] 15%|█▌        | 73/471 [00:28<02:38,  2.52it/s] 16%|█▌        | 74/471 [00:28<02:37,  2.52it/s] 16%|█▌        | 75/471 [00:29<02:37,  2.51it/s] 16%|█▌        | 76/471 [00:29<02:37,  2.51it/s] 16%|█▋        | 77/471 [00:30<02:36,  2.51it/s] 17%|█▋        | 78/471 [00:30<02:36,  2.51it/s] 17%|█▋        | 79/471 [00:30<02:36,  2.50it/s] 17%|█▋        | 80/471 [00:31<02:35,  2.52it/s] 17%|█▋        | 81/471 [00:31<02:34,  2.53it/s] 17%|█▋        | 82/471 [00:32<02:33,  2.53it/s] 18%|█▊        | 83/471 [00:32<02:34,  2.52it/s] 18%|█▊        | 84/471 [00:32<02:33,  2.52it/s] 18%|█▊        | 85/471 [00:33<02:33,  2.52it/s] 18%|█▊        | 86/471 [00:33<02:33,  2.51it/s] 18%|█▊        | 87/471 [00:34<02:32,  2.52it/s] 19%|█▊        | 88/471 [00:34<02:31,  2.53it/s] 19%|█▉        | 89/471 [00:34<02:31,  2.52it/s] 19%|█▉        | 90/471 [00:35<02:32,  2.50it/s] 19%|█▉        | 91/471 [00:35<02:31,  2.51it/s] 20%|█▉        | 92/471 [00:36<02:30,  2.52it/s] 20%|█▉        | 93/471 [00:36<02:30,  2.51it/s] 20%|█▉        | 94/471 [00:36<02:29,  2.53it/s] 20%|██        | 95/471 [00:37<02:28,  2.54it/s] 20%|██        | 96/471 [00:37<02:28,  2.53it/s] 21%|██        | 97/471 [00:38<02:29,  2.49it/s] 21%|██        | 98/471 [00:38<02:28,  2.51it/s] 21%|██        | 99/471 [00:38<02:27,  2.52it/s] 21%|██        | 100/471 [00:39<02:28,  2.50it/s] 21%|██▏       | 101/471 [00:39<02:27,  2.51it/s] 22%|██▏       | 102/471 [00:40<02:26,  2.52it/s] 22%|██▏       | 103/471 [00:40<02:25,  2.53it/s] 22%|██▏       | 104/471 [00:40<02:26,  2.51it/s] 22%|██▏       | 105/471 [00:41<02:25,  2.52it/s] 23%|██▎       | 106/471 [00:41<02:24,  2.53it/s] 23%|██▎       | 107/471 [00:42<02:24,  2.52it/s] 23%|██▎       | 108/471 [00:42<02:23,  2.52it/s] 23%|██▎       | 109/471 [00:42<02:22,  2.54it/s] 23%|██▎       | 110/471 [00:43<02:21,  2.55it/s] 24%|██▎       | 111/471 [00:43<02:23,  2.51it/s] 24%|██▍       | 112/471 [00:44<02:22,  2.52it/s] 24%|██▍       | 113/471 [00:44<02:21,  2.53it/s] 24%|██▍       | 114/471 [00:44<02:22,  2.51it/s] 24%|██▍       | 115/471 [00:45<02:21,  2.52it/s] 25%|██▍       | 116/471 [00:45<02:21,  2.52it/s] 25%|██▍       | 117/471 [00:46<02:20,  2.52it/s] 25%|██▌       | 118/471 [00:46<02:20,  2.51it/s] 25%|██▌       | 119/471 [00:46<02:20,  2.51it/s] 25%|██▌       | 120/471 [00:47<02:19,  2.52it/s] 26%|██▌       | 121/471 [00:47<02:19,  2.50it/s] 26%|██▌       | 122/471 [00:48<02:18,  2.52it/s] 26%|██▌       | 123/471 [00:48<02:17,  2.53it/s] 26%|██▋       | 124/471 [00:48<02:17,  2.53it/s] 27%|██▋       | 125/471 [00:49<02:18,  2.51it/s] 27%|██▋       | 126/471 [00:49<02:17,  2.51it/s] 27%|██▋       | 127/471 [00:50<02:16,  2.52it/s] 27%|██▋       | 128/471 [00:50<02:16,  2.52it/s] 27%|██▋       | 129/471 [00:50<02:15,  2.53it/s] 28%|██▊       | 130/471 [00:51<02:14,  2.53it/s] 28%|██▊       | 131/471 [00:51<02:14,  2.52it/s] 28%|██▊       | 132/471 [00:52<02:14,  2.51it/s] 28%|██▊       | 133/471 [00:52<02:14,  2.52it/s] 28%|██▊       | 134/471 [00:52<02:13,  2.52it/s] 29%|██▊       | 135/471 [00:53<02:14,  2.51it/s] 29%|██▉       | 136/471 [00:53<02:13,  2.51it/s] 29%|██▉       | 137/471 [00:53<02:12,  2.53it/s] 29%|██▉       | 138/471 [00:54<02:11,  2.54it/s] 30%|██▉       | 139/471 [00:54<02:11,  2.53it/s] 30%|██▉       | 140/471 [00:55<02:10,  2.53it/s] 30%|██▉       | 141/471 [00:55<02:10,  2.53it/s] 30%|███       | 142/471 [00:55<02:10,  2.52it/s] 30%|███       | 143/471 [00:56<02:10,  2.52it/s] 31%|███       | 144/471 [00:56<02:09,  2.52it/s] 31%|███       | 145/471 [00:57<02:08,  2.53it/s] 31%|███       | 146/471 [00:57<02:09,  2.51it/s] 31%|███       | 147/471 [00:57<02:08,  2.53it/s] 31%|███▏      | 148/471 [00:58<02:07,  2.53it/s] 32%|███▏      | 149/471 [00:58<02:08,  2.51it/s] 32%|███▏      | 150/471 [00:59<02:07,  2.53it/s] 32%|███▏      | 151/471 [00:59<02:06,  2.53it/s] 32%|███▏      | 152/471 [00:59<02:05,  2.54it/s] 32%|███▏      | 153/471 [01:00<02:05,  2.53it/s] 33%|███▎      | 154/471 [01:00<02:04,  2.54it/s] 33%|███▎      | 155/471 [01:01<02:04,  2.54it/s] 33%|███▎      | 156/471 [01:01<02:05,  2.51it/s] 33%|███▎      | 157/471 [01:01<02:04,  2.52it/s] 34%|███▎      | 158/471 [01:02<02:03,  2.54it/s] 34%|███▍      | 159/471 [01:02<02:03,  2.52it/s] 34%|███▍      | 160/471 [01:03<02:02,  2.54it/s] 34%|███▍      | 161/471 [01:03<02:01,  2.55it/s] 34%|███▍      | 162/471 [01:03<02:00,  2.56it/s] 35%|███▍      | 163/471 [01:04<02:01,  2.53it/s] 35%|███▍      | 164/471 [01:04<02:01,  2.53it/s] 35%|███▌      | 165/471 [01:05<02:00,  2.54it/s] 35%|███▌      | 166/471 [01:05<02:00,  2.52it/s] 35%|███▌      | 167/471 [01:05<02:00,  2.53it/s] 36%|███▌      | 168/471 [01:06<01:59,  2.54it/s] 36%|███▌      | 169/471 [01:06<01:58,  2.54it/s] 36%|███▌      | 170/471 [01:07<01:59,  2.53it/s] 36%|███▋      | 171/471 [01:07<01:58,  2.54it/s] 37%|███▋      | 172/471 [01:07<01:57,  2.53it/s] 37%|███▋      | 173/471 [01:08<01:58,  2.51it/s] 37%|███▋      | 174/471 [01:08<01:58,  2.51it/s] 37%|███▋      | 175/471 [01:09<01:57,  2.52it/s] 37%|███▋      | 176/471 [01:09<01:56,  2.53it/s] 38%|███▊      | 177/471 [01:09<01:57,  2.50it/s] 38%|███▊      | 178/471 [01:10<01:56,  2.52it/s] 38%|███▊      | 179/471 [01:10<01:55,  2.53it/s] 38%|███▊      | 180/471 [01:11<01:55,  2.51it/s] 38%|███▊      | 181/471 [01:11<01:55,  2.52it/s] 39%|███▊      | 182/471 [01:11<01:53,  2.54it/s] 39%|███▉      | 183/471 [01:12<01:53,  2.54it/s] 39%|███▉      | 184/471 [01:12<01:53,  2.52it/s] 39%|███▉      | 185/471 [01:12<01:53,  2.53it/s] 39%|███▉      | 186/471 [01:13<01:52,  2.53it/s] 40%|███▉      | 187/471 [01:13<01:53,  2.51it/s] 40%|███▉      | 188/471 [01:14<01:52,  2.51it/s] 40%|████      | 189/471 [01:14<01:51,  2.52it/s] 40%|████      | 190/471 [01:14<01:50,  2.53it/s] 41%|████      | 191/471 [01:15<01:51,  2.51it/s] 41%|████      | 192/471 [01:15<01:50,  2.52it/s] 41%|████      | 193/471 [01:16<01:49,  2.54it/s] 41%|████      | 194/471 [01:16<01:50,  2.51it/s] 41%|████▏     | 195/471 [01:16<01:49,  2.52it/s] 42%|████▏     | 196/471 [01:17<01:48,  2.53it/s] 42%|████▏     | 197/471 [01:17<01:47,  2.54it/s] 42%|████▏     | 198/471 [01:18<01:47,  2.53it/s] 42%|████▏     | 199/471 [01:18<01:47,  2.54it/s] 42%|████▏     | 200/471 [01:18<01:46,  2.54it/s] 43%|████▎     | 201/471 [01:19<01:46,  2.54it/s] 43%|████▎     | 202/471 [01:19<01:45,  2.54it/s] 43%|████▎     | 203/471 [01:20<01:45,  2.55it/s] 43%|████▎     | 204/471 [01:20<01:44,  2.54it/s] 44%|████▎     | 205/471 [01:20<01:44,  2.54it/s] 44%|████▎     | 206/471 [01:21<01:43,  2.55it/s] 44%|████▍     | 207/471 [01:21<01:43,  2.55it/s] 44%|████▍     | 208/471 [01:22<01:43,  2.54it/s] 44%|████▍     | 209/471 [01:22<01:42,  2.55it/s] 45%|████▍     | 210/471 [01:22<01:42,  2.55it/s] 45%|████▍     | 211/471 [01:23<01:42,  2.54it/s] 45%|████▌     | 212/471 [01:23<01:41,  2.56it/s] 45%|████▌     | 213/471 [01:24<01:40,  2.56it/s] 45%|████▌     | 214/471 [01:24<01:40,  2.55it/s] 46%|████▌     | 215/471 [01:24<01:40,  2.54it/s] 46%|████▌     | 216/471 [01:25<01:40,  2.53it/s] 46%|████▌     | 217/471 [01:25<01:40,  2.53it/s] 46%|████▋     | 218/471 [01:25<01:40,  2.52it/s] 46%|████▋     | 219/471 [01:26<01:39,  2.53it/s] 47%|████▋     | 220/471 [01:26<01:39,  2.53it/s] 47%|████▋     | 221/471 [01:27<01:38,  2.54it/s] 47%|████▋     | 222/471 [01:27<01:38,  2.52it/s] 47%|████▋     | 223/471 [01:27<01:37,  2.54it/s] 48%|████▊     | 224/471 [01:28<01:36,  2.55it/s] 48%|████▊     | 225/471 [01:28<01:37,  2.53it/s] 48%|████▊     | 226/471 [01:29<01:36,  2.53it/s] 48%|████▊     | 227/471 [01:29<01:36,  2.53it/s] 48%|████▊     | 228/471 [01:29<01:35,  2.54it/s] 49%|████▊     | 229/471 [01:30<01:36,  2.52it/s] 49%|████▉     | 230/471 [01:30<01:35,  2.53it/s] 49%|████▉     | 231/471 [01:31<01:34,  2.54it/s] 49%|████▉     | 232/471 [01:31<01:34,  2.53it/s] 49%|████▉     | 233/471 [01:31<01:33,  2.54it/s] 50%|████▉     | 234/471 [01:32<01:33,  2.53it/s] 50%|████▉     | 235/471 [01:32<01:33,  2.53it/s] 50%|█████     | 236/471 [01:33<01:33,  2.52it/s] 50%|█████     | 237/471 [01:33<01:32,  2.53it/s] 51%|█████     | 238/471 [01:33<01:31,  2.54it/s] 51%|█████     | 239/471 [01:34<01:31,  2.52it/s] 51%|█████     | 240/471 [01:34<01:31,  2.53it/s] 51%|█████     | 241/471 [01:35<01:30,  2.53it/s] 51%|█████▏    | 242/471 [01:35<01:30,  2.54it/s] 52%|█████▏    | 243/471 [01:35<01:30,  2.51it/s] 52%|█████▏    | 244/471 [01:36<01:30,  2.52it/s] 52%|█████▏    | 245/471 [01:36<01:29,  2.53it/s] 52%|█████▏    | 246/471 [01:37<01:29,  2.51it/s] 52%|█████▏    | 247/471 [01:37<01:28,  2.53it/s] 53%|█████▎    | 248/471 [01:37<01:27,  2.54it/s] 53%|█████▎    | 249/471 [01:38<01:27,  2.55it/s] 53%|█████▎    | 250/471 [01:38<01:27,  2.53it/s] 53%|█████▎    | 251/471 [01:39<01:26,  2.54it/s] 54%|█████▎    | 252/471 [01:39<01:25,  2.55it/s] 54%|█████▎    | 253/471 [01:39<01:26,  2.53it/s] 54%|█████▍    | 254/471 [01:40<01:25,  2.53it/s] 54%|█████▍    | 255/471 [01:40<01:25,  2.53it/s] 54%|█████▍    | 256/471 [01:40<01:24,  2.53it/s] 55%|█████▍    | 257/471 [01:41<01:25,  2.52it/s] 55%|█████▍    | 258/471 [01:41<01:24,  2.53it/s] 55%|█████▍    | 259/471 [01:42<01:23,  2.53it/s] 55%|█████▌    | 260/471 [01:42<01:23,  2.52it/s] 55%|█████▌    | 261/471 [01:42<01:23,  2.53it/s] 56%|█████▌    | 262/471 [01:43<01:22,  2.54it/s] 56%|█████▌    | 263/471 [01:43<01:21,  2.54it/s] 56%|█████▌    | 264/471 [01:44<01:22,  2.52it/s] 56%|█████▋    | 265/471 [01:44<01:21,  2.54it/s] 56%|█████▋    | 266/471 [01:44<01:20,  2.55it/s] 57%|█████▋    | 267/471 [01:45<01:20,  2.53it/s] 57%|█████▋    | 268/471 [01:45<01:20,  2.54it/s] 57%|█████▋    | 269/471 [01:46<01:19,  2.54it/s] 57%|█████▋    | 270/471 [01:46<01:18,  2.55it/s] 58%|█████▊    | 271/471 [01:46<01:19,  2.52it/s] 58%|█████▊    | 272/471 [01:47<01:18,  2.53it/s] 58%|█████▊    | 273/471 [01:47<01:17,  2.54it/s] 58%|█████▊    | 274/471 [01:48<01:18,  2.52it/s] 58%|█████▊    | 275/471 [01:48<01:17,  2.54it/s] 59%|█████▊    | 276/471 [01:48<01:16,  2.54it/s] 59%|█████▉    | 277/471 [01:49<01:16,  2.54it/s] 59%|█████▉    | 278/471 [01:49<01:16,  2.53it/s] 59%|█████▉    | 279/471 [01:50<01:15,  2.55it/s] 59%|█████▉    | 280/471 [01:50<01:14,  2.56it/s] 60%|█████▉    | 281/471 [01:50<01:14,  2.53it/s] 60%|█████▉    | 282/471 [01:51<01:14,  2.54it/s] 60%|██████    | 283/471 [01:51<01:13,  2.54it/s] 60%|██████    | 284/471 [01:52<01:13,  2.56it/s] 61%|██████    | 285/471 [01:52<01:13,  2.54it/s] 61%|██████    | 286/471 [01:52<01:12,  2.54it/s] 61%|██████    | 287/471 [01:53<01:12,  2.55it/s] 61%|██████    | 288/471 [01:53<01:12,  2.53it/s] 61%|██████▏   | 289/471 [01:54<01:11,  2.54it/s] 62%|██████▏   | 290/471 [01:54<01:11,  2.55it/s] 62%|██████▏   | 291/471 [01:54<01:10,  2.54it/s] 62%|██████▏   | 292/471 [01:55<01:10,  2.54it/s] 62%|██████▏   | 293/471 [01:55<01:09,  2.56it/s] 62%|██████▏   | 294/471 [01:55<01:08,  2.57it/s] 63%|██████▎   | 295/471 [01:56<01:09,  2.55it/s] 63%|██████▎   | 296/471 [01:56<01:08,  2.56it/s] 63%|██████▎   | 297/471 [01:56<01:00,  2.86it/s] 63%|██████▎   | 298/471 [01:57<00:52,  3.30it/s] 63%|██████▎   | 299/471 [01:57<00:46,  3.72it/s] 64%|██████▎   | 300/471 [01:57<00:41,  4.08it/s] 64%|██████▍   | 301/471 [01:57<00:38,  4.37it/s] 64%|██████▍   | 302/471 [01:57<00:36,  4.61it/s] 64%|██████▍   | 303/471 [01:58<00:35,  4.79it/s] 65%|██████▍   | 304/471 [01:58<00:33,  4.92it/s] 65%|██████▍   | 305/471 [01:58<00:33,  5.03it/s] 65%|██████▍   | 306/471 [01:58<00:32,  5.03it/s] 65%|██████▌   | 307/471 [01:58<00:32,  5.06it/s] 65%|██████▌   | 308/471 [01:59<00:32,  5.08it/s] 66%|██████▌   | 309/471 [01:59<00:31,  5.08it/s] 66%|██████▌   | 310/471 [01:59<00:31,  5.13it/s] 66%|██████▌   | 311/471 [01:59<00:31,  5.11it/s] 66%|██████▌   | 312/471 [01:59<00:33,  4.80it/s] 66%|██████▋   | 313/471 [02:00<00:42,  3.73it/s] 67%|██████▋   | 314/471 [02:00<00:46,  3.40it/s] 67%|██████▋   | 315/471 [02:00<00:46,  3.35it/s] 67%|██████▋   | 316/471 [02:01<00:49,  3.13it/s] 67%|██████▋   | 317/471 [02:01<00:43,  3.53it/s] 68%|██████▊   | 318/471 [02:01<00:43,  3.51it/s] 68%|██████▊   | 319/471 [02:02<00:46,  3.28it/s] 68%|██████▊   | 320/471 [02:02<00:45,  3.30it/s] 68%|██████▊   | 321/471 [02:02<00:50,  2.99it/s] 68%|██████▊   | 322/471 [02:03<00:52,  2.86it/s] 69%|██████▊   | 323/471 [02:03<00:50,  2.91it/s] 69%|██████▉   | 324/471 [02:03<00:50,  2.90it/s] 69%|██████▉   | 325/471 [02:04<00:53,  2.73it/s] 69%|██████▉   | 326/471 [02:04<00:51,  2.81it/s] 69%|██████▉   | 327/471 [02:05<00:49,  2.89it/s] 70%|██████▉   | 328/471 [02:05<00:52,  2.70it/s] 70%|██████▉   | 329/471 [02:05<00:51,  2.78it/s] 70%|███████   | 330/471 [02:06<00:48,  2.90it/s] 70%|███████   | 331/471 [02:06<00:51,  2.71it/s] 70%|███████   | 332/471 [02:06<00:50,  2.74it/s] 71%|███████   | 333/471 [02:07<00:47,  2.89it/s] 71%|███████   | 334/471 [02:07<00:50,  2.72it/s] 71%|███████   | 335/471 [02:07<00:50,  2.69it/s] 71%|███████▏  | 336/471 [02:08<00:48,  2.79it/s] 72%|███████▏  | 337/471 [02:08<00:45,  2.93it/s] 72%|███████▏  | 338/471 [02:09<00:48,  2.73it/s] 72%|███████▏  | 339/471 [02:09<00:47,  2.78it/s] 72%|███████▏  | 340/471 [02:09<00:44,  2.93it/s] 72%|███████▏  | 341/471 [02:10<00:47,  2.75it/s] 73%|███████▎  | 342/471 [02:10<00:47,  2.74it/s] 73%|███████▎  | 343/471 [02:10<00:45,  2.84it/s] 73%|███████▎  | 344/471 [02:11<00:45,  2.82it/s] 73%|███████▎  | 345/471 [02:11<00:46,  2.71it/s] 73%|███████▎  | 346/471 [02:11<00:44,  2.79it/s] 74%|███████▎  | 347/471 [02:12<00:43,  2.83it/s] 74%|███████▍  | 348/471 [02:12<00:46,  2.67it/s] 74%|███████▍  | 349/471 [02:12<00:43,  2.78it/s] 74%|███████▍  | 350/471 [02:13<00:42,  2.87it/s] 75%|███████▍  | 351/471 [02:13<00:44,  2.71it/s] 75%|███████▍  | 352/471 [02:14<00:43,  2.75it/s] 75%|███████▍  | 353/471 [02:14<00:40,  2.91it/s] 75%|███████▌  | 354/471 [02:14<00:42,  2.75it/s] 75%|███████▌  | 355/471 [02:15<00:42,  2.71it/s] 76%|███████▌  | 356/471 [02:15<00:41,  2.79it/s] 76%|███████▌  | 357/471 [02:15<00:41,  2.77it/s] 76%|███████▌  | 358/471 [02:16<00:42,  2.68it/s] 76%|███████▌  | 359/471 [02:16<00:40,  2.78it/s] 76%|███████▋  | 360/471 [02:16<00:37,  2.97it/s] 77%|███████▋  | 361/471 [02:17<00:39,  2.75it/s] 77%|███████▋  | 362/471 [02:17<00:39,  2.77it/s] 77%|███████▋  | 363/471 [02:17<00:37,  2.89it/s] 77%|███████▋  | 364/471 [02:18<00:38,  2.79it/s] 77%|███████▋  | 365/471 [02:18<00:39,  2.71it/s] 78%|███████▊  | 366/471 [02:19<00:37,  2.80it/s] 78%|███████▊  | 367/471 [02:19<00:36,  2.82it/s] 78%|███████▊  | 368/471 [02:19<00:38,  2.68it/s] 78%|███████▊  | 369/471 [02:20<00:36,  2.79it/s] 79%|███████▊  | 370/471 [02:20<00:35,  2.85it/s] 79%|███████▉  | 371/471 [02:20<00:37,  2.69it/s] 79%|███████▉  | 372/471 [02:21<00:35,  2.77it/s] 79%|███████▉  | 373/471 [02:21<00:34,  2.88it/s] 79%|███████▉  | 374/471 [02:21<00:35,  2.71it/s] 80%|███████▉  | 375/471 [02:22<00:34,  2.75it/s] 80%|███████▉  | 376/471 [02:22<00:32,  2.89it/s] 80%|████████  | 377/471 [02:23<00:33,  2.77it/s] 80%|████████  | 378/471 [02:23<00:34,  2.73it/s] 80%|████████  | 379/471 [02:23<00:32,  2.81it/s] 81%|████████  | 380/471 [02:24<00:32,  2.81it/s] 81%|████████  | 381/471 [02:24<00:33,  2.69it/s] 81%|████████  | 382/471 [02:24<00:32,  2.78it/s] 81%|████████▏ | 383/471 [02:25<00:29,  2.96it/s] 82%|████████▏ | 384/471 [02:25<00:31,  2.75it/s] 82%|████████▏ | 385/471 [02:25<00:31,  2.73it/s] 82%|████████▏ | 386/471 [02:26<00:30,  2.83it/s] 82%|████████▏ | 387/471 [02:26<00:29,  2.81it/s] 82%|████████▏ | 388/471 [02:27<00:30,  2.70it/s] 83%|████████▎ | 389/471 [02:27<00:29,  2.80it/s] 83%|████████▎ | 390/471 [02:27<00:28,  2.85it/s] 83%|████████▎ | 391/471 [02:28<00:29,  2.67it/s] 83%|████████▎ | 392/471 [02:28<00:28,  2.78it/s] 83%|████████▎ | 393/471 [02:28<00:27,  2.88it/s] 84%|████████▎ | 394/471 [02:29<00:28,  2.69it/s] 84%|████████▍ | 395/471 [02:29<00:27,  2.75it/s] 84%|████████▍ | 396/471 [02:29<00:25,  2.90it/s] 84%|████████▍ | 397/471 [02:30<00:27,  2.73it/s] 85%|████████▍ | 398/471 [02:30<00:26,  2.72it/s] 85%|████████▍ | 399/471 [02:30<00:25,  2.80it/s] 85%|████████▍ | 400/471 [02:31<00:25,  2.82it/s] 85%|████████▌ | 401/471 [02:31<00:25,  2.70it/s] 85%|████████▌ | 402/471 [02:32<00:24,  2.79it/s] 86%|████████▌ | 403/471 [02:32<00:24,  2.83it/s] 86%|████████▌ | 404/471 [02:32<00:25,  2.66it/s] 86%|████████▌ | 405/471 [02:33<00:23,  2.76it/s] 86%|████████▌ | 406/471 [02:33<00:22,  2.91it/s] 86%|████████▋ | 407/471 [02:33<00:22,  2.83it/s] 87%|████████▋ | 408/471 [02:34<00:22,  2.75it/s] 87%|████████▋ | 409/471 [02:34<00:21,  2.83it/s] 87%|████████▋ | 410/471 [02:34<00:21,  2.86it/s] 87%|████████▋ | 411/471 [02:35<00:22,  2.70it/s] 87%|████████▋ | 412/471 [02:35<00:21,  2.79it/s] 88%|████████▊ | 413/471 [02:35<00:20,  2.87it/s] 88%|████████▊ | 414/471 [02:36<00:21,  2.69it/s] 88%|████████▊ | 415/471 [02:36<00:20,  2.76it/s] 88%|████████▊ | 416/471 [02:37<00:19,  2.88it/s] 89%|████████▊ | 417/471 [02:37<00:19,  2.71it/s] 89%|████████▊ | 418/471 [02:37<00:19,  2.73it/s] 89%|████████▉ | 419/471 [02:38<00:18,  2.85it/s] 89%|████████▉ | 420/471 [02:38<00:17,  2.86it/s] 89%|████████▉ | 421/471 [02:38<00:18,  2.71it/s] 90%|████████▉ | 422/471 [02:39<00:17,  2.81it/s] 90%|████████▉ | 423/471 [02:39<00:16,  2.87it/s] 90%|█████████ | 424/471 [02:39<00:17,  2.70it/s] 90%|█████████ | 425/471 [02:40<00:16,  2.79it/s] 90%|█████████ | 426/471 [02:40<00:15,  2.89it/s] 91%|█████████ | 427/471 [02:41<00:16,  2.72it/s] 91%|█████████ | 428/471 [02:41<00:15,  2.75it/s] 91%|█████████ | 429/471 [02:41<00:14,  2.91it/s] 91%|█████████▏| 430/471 [02:41<00:12,  3.25it/s] 92%|█████████▏| 431/471 [02:42<00:10,  3.65it/s] 92%|█████████▏| 432/471 [02:42<00:09,  3.99it/s] 92%|█████████▏| 433/471 [02:42<00:08,  4.29it/s] 92%|█████████▏| 434/471 [02:42<00:08,  4.55it/s] 92%|█████████▏| 435/471 [02:42<00:07,  4.76it/s] 93%|█████████▎| 436/471 [02:43<00:07,  4.91it/s] 93%|█████████▎| 437/471 [02:43<00:06,  4.97it/s] 93%|█████████▎| 438/471 [02:43<00:06,  5.05it/s] 93%|█████████▎| 439/471 [02:43<00:06,  5.12it/s] 93%|█████████▎| 440/471 [02:43<00:05,  5.19it/s] 94%|█████████▎| 441/471 [02:43<00:05,  5.21it/s] 94%|█████████▍| 442/471 [02:44<00:05,  5.22it/s] 94%|█████████▍| 443/471 [02:44<00:05,  5.22it/s] 94%|█████████▍| 444/471 [02:44<00:05,  5.23it/s] 94%|█████████▍| 445/471 [02:44<00:04,  5.25it/s] 95%|█████████▍| 446/471 [02:44<00:04,  5.26it/s] 95%|█████████▍| 447/471 [02:45<00:04,  5.20it/s] 95%|█████████▌| 448/471 [02:45<00:04,  5.18it/s] 95%|█████████▌| 449/471 [02:45<00:04,  5.15it/s] 96%|█████████▌| 450/471 [02:45<00:04,  5.14it/s] 96%|█████████▌| 451/471 [02:45<00:03,  5.18it/s] 96%|█████████▌| 452/471 [02:46<00:03,  5.11it/s] 96%|█████████▌| 453/471 [02:46<00:04,  4.04it/s] 96%|█████████▋| 454/471 [02:46<00:04,  3.46it/s] 97%|█████████▋| 455/471 [02:47<00:04,  3.33it/s] 97%|█████████▋| 456/471 [02:47<00:04,  3.20it/s] 97%|█████████▋| 457/471 [02:47<00:04,  3.37it/s] 97%|█████████▋| 458/471 [02:48<00:03,  3.35it/s] 97%|█████████▋| 459/471 [02:48<00:03,  3.21it/s] 98%|█████████▊| 460/471 [02:48<00:03,  3.24it/s] 98%|█████████▊| 461/471 [02:49<00:03,  2.93it/s] 98%|█████████▊| 462/471 [02:49<00:03,  2.85it/s] 98%|█████████▊| 463/471 [02:49<00:02,  2.92it/s] 99%|█████████▊| 464/471 [02:50<00:02,  2.87it/s] 99%|█████████▊| 465/471 [02:50<00:02,  2.74it/s] 99%|█████████▉| 466/471 [02:50<00:01,  2.84it/s] 99%|█████████▉| 467/471 [02:51<00:01,  2.86it/s] 99%|█████████▉| 468/471 [02:51<00:01,  2.69it/s]100%|█████████▉| 469/471 [02:52<00:00,  2.79it/s]100%|█████████▉| 470/471 [02:52<00:00,  2.88it/s]100%|██████████| 471/471 [02:52<00:00,  2.93it/s]100%|██████████| 471/471 [02:52<00:00,  2.73it/s]
{'eval_loss': 2.501251459121704, 'eval_model_preparation_time': 0.0052, 'eval_acc': 0.3831651619755709, 'eval_runtime': 173.0919, 'eval_samples_per_second': 43.514, 'eval_steps_per_second': 2.721}
ROUND:15
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:22,  1.75it/s]                                              {'loss': 3.2976, 'grad_norm': 9.785208702087402, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:22,  1.75it/s]  5%|▌         | 2/40 [00:01<00:25,  1.52it/s]                                              {'loss': 1.3478, 'grad_norm': 8.713226318359375, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.52it/s]  8%|▊         | 3/40 [00:01<00:24,  1.51it/s]                                              {'loss': 1.799, 'grad_norm': 20.144411087036133, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.51it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 1.5256, 'grad_norm': 12.511945724487305, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s]                                              {'loss': 2.0213, 'grad_norm': 17.11760139465332, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s]                                              {'loss': 1.9749, 'grad_norm': 19.62606430053711, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.50it/s]                                              {'loss': 1.4466, 'grad_norm': 13.66922378540039, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.50it/s]                                              {'loss': 4.3157, 'grad_norm': 61.495994567871094, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.50it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.86it/s]                                              {'loss': 0.9918, 'grad_norm': 14.512486457824707, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.86it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.80it/s]                                               {'loss': 1.1865, 'grad_norm': 15.940862655639648, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.80it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.69it/s]                                               {'loss': 0.5869, 'grad_norm': 6.252455234527588, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.69it/s] 30%|███       | 12/40 [00:07<00:17,  1.59it/s]                                               {'loss': 0.4498, 'grad_norm': 5.063266277313232, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.59it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.64it/s]                                               {'loss': 1.1178, 'grad_norm': 6.34814977645874, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.64it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.56it/s]                                               {'loss': 0.6518, 'grad_norm': 8.208429336547852, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.56it/s] 38%|███▊      | 15/40 [00:09<00:15,  1.57it/s]                                               {'loss': 0.8945, 'grad_norm': 8.110481262207031, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:15,  1.57it/s]                                               {'loss': 0.1394, 'grad_norm': 6.267366409301758, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.57it/s] 42%|████▎     | 17/40 [00:10<00:11,  1.93it/s]                                               {'loss': 0.8395, 'grad_norm': 3.728806972503662, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:11,  1.93it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.77it/s]                                               {'loss': 0.5426, 'grad_norm': 5.552365303039551, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.77it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.72it/s]                                               {'loss': 0.377, 'grad_norm': 5.461422443389893, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.72it/s] 50%|█████     | 20/40 [00:12<00:12,  1.64it/s]                                               {'loss': 0.483, 'grad_norm': 8.515872955322266, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.64it/s] 52%|█████▎    | 21/40 [00:12<00:12,  1.57it/s]                                               {'loss': 0.5349, 'grad_norm': 4.174802303314209, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.61it/s]                                               {'loss': 0.3816, 'grad_norm': 4.355096340179443, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.61it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.3475, 'grad_norm': 4.770101070404053, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.0956, 'grad_norm': 6.0201416015625, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:14<00:08,  1.85it/s]                                               {'loss': 0.3177, 'grad_norm': 4.987502098083496, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:08,  1.85it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.83it/s]                                               {'loss': 0.4927, 'grad_norm': 2.580214500427246, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.83it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.71it/s]                                               {'loss': 0.1161, 'grad_norm': 2.1026525497436523, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.71it/s] 70%|███████   | 28/40 [00:16<00:07,  1.69it/s]                                               {'loss': 0.2853, 'grad_norm': 4.001100540161133, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.69it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.61it/s]                                               {'loss': 0.672, 'grad_norm': 5.961378574371338, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.61it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.55it/s]                                               {'loss': 0.1196, 'grad_norm': 1.5336787700653076, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.55it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.58it/s]                                               {'loss': 0.0898, 'grad_norm': 2.5569751262664795, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.58it/s]                                               {'loss': 0.2762, 'grad_norm': 47.053855895996094, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:05,  1.58it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.90it/s]                                               {'loss': 0.1343, 'grad_norm': 2.977389097213745, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.90it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.76it/s]                                               {'loss': 0.1198, 'grad_norm': 3.3450450897216797, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:20<00:02,  1.74it/s]                                               {'loss': 0.2399, 'grad_norm': 1.2578482627868652, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  1.74it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.62it/s]                                               {'loss': 0.1069, 'grad_norm': 3.050755739212036, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.59it/s]                                               {'loss': 0.472, 'grad_norm': 0.8141342997550964, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.59it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.56it/s]                                               {'loss': 0.0903, 'grad_norm': 2.2195723056793213, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.76it/s]                                               {'loss': 0.4333, 'grad_norm': 5.463693618774414, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.76it/s]                                               {'loss': 1.19, 'grad_norm': 19.17499542236328, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.76it/s]                                               {'train_runtime': 23.6721, 'train_samples_per_second': 23.868, 'train_steps_per_second': 1.69, 'train_loss': 0.8126094914972782, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.76it/s]100%|██████████| 40/40 [00:23<00:00,  1.69it/s]
CLIENT:49
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:23,  1.64it/s]                                              {'loss': 3.2665, 'grad_norm': 13.434579849243164, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:23,  1.64it/s]  5%|▌         | 2/40 [00:01<00:24,  1.55it/s]                                              {'loss': 1.6713, 'grad_norm': 8.828755378723145, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.55it/s]  8%|▊         | 3/40 [00:01<00:24,  1.49it/s]                                              {'loss': 1.6801, 'grad_norm': 13.449504852294922, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.49it/s] 10%|█         | 4/40 [00:02<00:23,  1.56it/s]                                              {'loss': 1.2181, 'grad_norm': 14.764298439025879, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.56it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 1.6737, 'grad_norm': 18.124658584594727, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.54it/s]                                              {'loss': 2.3844, 'grad_norm': 27.8309383392334, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.54it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.51it/s]                                              {'loss': 1.6451, 'grad_norm': 16.065065383911133, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.51it/s]                                              {'loss': 3.3662, 'grad_norm': 80.48005676269531, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.51it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.88it/s]                                              {'loss': 0.9131, 'grad_norm': 12.081475257873535, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.88it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.80it/s]                                               {'loss': 1.291, 'grad_norm': 11.335653305053711, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.80it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s]                                               {'loss': 0.607, 'grad_norm': 8.541869163513184, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s] 30%|███       | 12/40 [00:07<00:17,  1.61it/s]                                               {'loss': 0.901, 'grad_norm': 9.717172622680664, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:07<00:16,  1.63it/s]                                               {'loss': 0.8598, 'grad_norm': 6.853300094604492, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:16,  1.63it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s]                                               {'loss': 0.5905, 'grad_norm': 6.3578057289123535, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.55it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.53it/s]                                               {'loss': 0.5256, 'grad_norm': 8.614136695861816, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.53it/s]                                               {'loss': 0.0666, 'grad_norm': 3.7663686275482178, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.53it/s] 42%|████▎     | 17/40 [00:10<00:11,  1.94it/s]                                               {'loss': 0.397, 'grad_norm': 7.878008842468262, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:11,  1.94it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.77it/s]                                               {'loss': 0.2228, 'grad_norm': 4.197387218475342, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.77it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.73it/s]                                               {'loss': 0.6041, 'grad_norm': 5.300478458404541, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.73it/s] 50%|█████     | 20/40 [00:12<00:12,  1.65it/s]                                               {'loss': 0.6374, 'grad_norm': 9.027796745300293, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:12<00:12,  1.57it/s]                                               {'loss': 0.6519, 'grad_norm': 6.974627494812012, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:12,  1.57it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.60it/s]                                               {'loss': 0.1652, 'grad_norm': 3.3978676795959473, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.60it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.55it/s]                                               {'loss': 0.6007, 'grad_norm': 4.558218002319336, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.55it/s]                                               {'loss': 0.6624, 'grad_norm': 39.19007110595703, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.55it/s] 62%|██████▎   | 25/40 [00:14<00:08,  1.87it/s]                                               {'loss': 0.3068, 'grad_norm': 3.716249704360962, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:08,  1.87it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s]                                               {'loss': 0.0904, 'grad_norm': 1.641024112701416, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s]                                               {'loss': 0.6736, 'grad_norm': 3.636265754699707, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s] 70%|███████   | 28/40 [00:16<00:07,  1.60it/s]                                               {'loss': 0.101, 'grad_norm': 2.9299309253692627, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.60it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.63it/s]                                               {'loss': 0.3317, 'grad_norm': 1.21829092502594, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.63it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.54it/s]                                               {'loss': 0.1576, 'grad_norm': 4.762678623199463, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.54it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.60it/s]                                               {'loss': 0.384, 'grad_norm': 5.105606555938721, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.60it/s]                                               {'loss': 0.0678, 'grad_norm': 4.660197734832764, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:05,  1.60it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.92it/s]                                               {'loss': 0.4649, 'grad_norm': 1.7709932327270508, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.92it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.76it/s]                                               {'loss': 0.0999, 'grad_norm': 2.9216010570526123, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:20<00:02,  1.73it/s]                                               {'loss': 0.0446, 'grad_norm': 1.154017448425293, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  1.73it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.64it/s]                                               {'loss': 0.2105, 'grad_norm': 3.4861040115356445, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.64it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.59it/s]                                               {'loss': 0.4633, 'grad_norm': 1.2525238990783691, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.59it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.60it/s]                                               {'loss': 0.2349, 'grad_norm': 9.45130443572998, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.60it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.53it/s]                                               {'loss': 0.0283, 'grad_norm': 1.1319297552108765, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.53it/s]                                               {'loss': 0.0209, 'grad_norm': 1.648076057434082, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.53it/s]                                               {'train_runtime': 23.9627, 'train_samples_per_second': 23.578, 'train_steps_per_second': 1.669, 'train_loss': 0.7570472144521773, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.53it/s]100%|██████████| 40/40 [00:23<00:00,  1.67it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.90it/s]                                              {'loss': 1.5864, 'grad_norm': 9.698564529418945, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.90it/s]  5%|▌         | 2/40 [00:00<00:13,  2.92it/s]                                              {'loss': 1.1542, 'grad_norm': 10.233001708984375, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.92it/s]  8%|▊         | 3/40 [00:01<00:12,  2.92it/s]                                              {'loss': 1.3068, 'grad_norm': 16.685237884521484, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.92it/s] 10%|█         | 4/40 [00:01<00:12,  2.95it/s]                                              {'loss': 1.1242, 'grad_norm': 12.548490524291992, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.95it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.92it/s]                                              {'loss': 1.2402, 'grad_norm': 11.875880241394043, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.92it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.91it/s]                                              {'loss': 2.048, 'grad_norm': 17.969852447509766, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.91it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.91it/s]                                              {'loss': 1.7896, 'grad_norm': 14.055500984191895, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.91it/s]                                              {'loss': 6.2458, 'grad_norm': 70.98934936523438, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.91it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.70it/s]                                              {'loss': 0.4627, 'grad_norm': 9.255131721496582, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.70it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.91it/s]                                               {'loss': 0.5605, 'grad_norm': 7.557369709014893, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.91it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s]                                               {'loss': 0.7751, 'grad_norm': 7.882789134979248, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s] 30%|███       | 12/40 [00:04<00:12,  2.19it/s]                                               {'loss': 0.37, 'grad_norm': 6.995791435241699, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.19it/s] 32%|███▎      | 13/40 [00:04<00:11,  2.33it/s]                                               {'loss': 0.1757, 'grad_norm': 3.367854595184326, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:11,  2.33it/s] 35%|███▌      | 14/40 [00:05<00:12,  2.05it/s]                                               {'loss': 0.9806, 'grad_norm': 8.80900764465332, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:12,  2.05it/s] 38%|███▊      | 15/40 [00:06<00:13,  1.82it/s]                                               {'loss': 1.035, 'grad_norm': 7.149400234222412, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:13,  1.82it/s]                                               {'loss': 1.1706, 'grad_norm': 25.16168212890625, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:13,  1.82it/s] 42%|████▎     | 17/40 [00:06<00:10,  2.16it/s]                                               {'loss': 0.2831, 'grad_norm': 2.2443037033081055, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:10,  2.16it/s] 45%|████▌     | 18/40 [00:07<00:11,  1.94it/s]                                               {'loss': 0.077, 'grad_norm': 1.387008547782898, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:11,  1.94it/s] 48%|████▊     | 19/40 [00:08<00:11,  1.78it/s]                                               {'loss': 0.4328, 'grad_norm': 3.104924201965332, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:11,  1.78it/s] 50%|█████     | 20/40 [00:08<00:11,  1.74it/s]                                               {'loss': 0.5317, 'grad_norm': 9.181903839111328, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:11,  1.74it/s] 52%|█████▎    | 21/40 [00:09<00:11,  1.63it/s]                                               {'loss': 0.1436, 'grad_norm': 2.9946177005767822, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:11,  1.63it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.57it/s]                                               {'loss': 0.2005, 'grad_norm': 3.770578384399414, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:10<00:10,  1.59it/s]                                               {'loss': 0.1191, 'grad_norm': 4.024783134460449, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:10,  1.59it/s]                                               {'loss': 0.0647, 'grad_norm': 2.728668451309204, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:10,  1.59it/s] 62%|██████▎   | 25/40 [00:11<00:07,  2.07it/s]                                               {'loss': 0.0961, 'grad_norm': 3.0929088592529297, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:07,  2.07it/s] 65%|██████▌   | 26/40 [00:12<00:07,  1.91it/s]                                               {'loss': 0.2411, 'grad_norm': 2.531521797180176, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:07,  1.91it/s] 68%|██████▊   | 27/40 [00:12<00:07,  1.75it/s]                                               {'loss': 0.1884, 'grad_norm': 2.4986019134521484, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:07,  1.75it/s] 70%|███████   | 28/40 [00:13<00:07,  1.71it/s]                                               {'loss': 0.2291, 'grad_norm': 2.4830760955810547, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:13<00:07,  1.71it/s] 72%|███████▎  | 29/40 [00:14<00:06,  1.61it/s]                                               {'loss': 0.1484, 'grad_norm': 2.0031468868255615, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:06,  1.61it/s] 75%|███████▌  | 30/40 [00:14<00:06,  1.56it/s]                                               {'loss': 0.0593, 'grad_norm': 1.9344451427459717, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:14<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:15<00:05,  1.60it/s]                                               {'loss': 0.0265, 'grad_norm': 0.6736356019973755, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:05,  1.60it/s]                                               {'loss': 0.0249, 'grad_norm': 1.7796847820281982, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:15<00:05,  1.60it/s] 82%|████████▎ | 33/40 [00:16<00:03,  1.90it/s]                                               {'loss': 0.0337, 'grad_norm': 1.920777440071106, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:03,  1.90it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.76it/s]                                               {'loss': 0.0175, 'grad_norm': 0.5420137643814087, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:17<00:02,  1.74it/s]                                               {'loss': 0.1714, 'grad_norm': 0.6403605937957764, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:17<00:02,  1.74it/s] 90%|█████████ | 36/40 [00:18<00:02,  1.62it/s]                                               {'loss': 0.1075, 'grad_norm': 3.801290512084961, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:18<00:01,  1.63it/s]                                               {'loss': 0.0161, 'grad_norm': 0.3759254217147827, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:18<00:01,  1.63it/s] 95%|█████████▌| 38/40 [00:19<00:01,  1.55it/s]                                               {'loss': 0.1619, 'grad_norm': 2.4057443141937256, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:19<00:01,  1.55it/s] 98%|█████████▊| 39/40 [00:20<00:00,  1.52it/s]                                               {'loss': 0.1516, 'grad_norm': 0.3743581771850586, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  1.52it/s]                                               {'loss': 0.0004, 'grad_norm': 0.020174667239189148, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.52it/s]                                               {'train_runtime': 20.6918, 'train_samples_per_second': 27.306, 'train_steps_per_second': 1.933, 'train_loss': 0.638792745990213, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.52it/s]100%|██████████| 40/40 [00:20<00:00,  1.93it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:58,  1.51s/it]                                              {'loss': 3.0086, 'grad_norm': 12.810083389282227, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:58,  1.51s/it]  5%|▌         | 2/40 [00:02<00:37,  1.00it/s]                                              {'loss': 1.8506, 'grad_norm': 10.931941032409668, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.00it/s]  8%|▊         | 3/40 [00:02<00:32,  1.15it/s]                                              {'loss': 2.381, 'grad_norm': 13.596945762634277, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.15it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 2.1571, 'grad_norm': 20.405630111694336, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s]                                              {'loss': 1.4188, 'grad_norm': 14.53707504272461, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s]                                              {'loss': 1.5378, 'grad_norm': 21.625747680664062, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 1.3076, 'grad_norm': 15.635643005371094, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 2.1196, 'grad_norm': 153.7323760986328, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.42it/s] 22%|██▎       | 9/40 [00:06<00:17,  1.80it/s]                                              {'loss': 0.5989, 'grad_norm': 8.493086814880371, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:17,  1.80it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.71it/s]                                               {'loss': 1.3531, 'grad_norm': 13.34582233428955, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.71it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.65it/s]                                               {'loss': 0.8921, 'grad_norm': 10.119124412536621, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.65it/s] 30%|███       | 12/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.7256, 'grad_norm': 7.136434555053711, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.57it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.7311, 'grad_norm': 6.549770355224609, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.53it/s]                                               {'loss': 1.2306, 'grad_norm': 9.528773307800293, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.53it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s]                                               {'loss': 0.7922, 'grad_norm': 7.25123405456543, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s]                                               {'loss': 0.3115, 'grad_norm': 12.716337203979492, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:16,  1.48it/s] 42%|████▎     | 17/40 [00:11<00:11,  1.98it/s]                                               {'loss': 0.8488, 'grad_norm': 10.56619930267334, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:11,  1.98it/s] 45%|████▌     | 18/40 [00:11<00:10,  2.15it/s]                                               {'loss': 0.5763, 'grad_norm': 6.7617268562316895, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:10,  2.15it/s] 48%|████▊     | 19/40 [00:11<00:09,  2.31it/s]                                               {'loss': 0.4182, 'grad_norm': 5.676208972930908, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:09,  2.31it/s] 50%|█████     | 20/40 [00:12<00:09,  2.07it/s]                                               {'loss': 0.6363, 'grad_norm': 3.9411888122558594, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:09,  2.07it/s] 52%|█████▎    | 21/40 [00:12<00:08,  2.28it/s]                                               {'loss': 0.3353, 'grad_norm': 4.721430778503418, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:12<00:07,  2.43it/s]                                               {'loss': 0.267, 'grad_norm': 6.676701068878174, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:07,  2.43it/s] 57%|█████▊    | 23/40 [00:13<00:06,  2.55it/s]                                               {'loss': 0.896, 'grad_norm': 17.835073471069336, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:06,  2.55it/s]                                               {'loss': 0.7968, 'grad_norm': 35.4126091003418, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:06,  2.55it/s] 62%|██████▎   | 25/40 [00:13<00:04,  3.21it/s]                                               {'loss': 0.1597, 'grad_norm': 2.725999355316162, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:04,  3.21it/s] 65%|██████▌   | 26/40 [00:14<00:04,  3.15it/s]                                               {'loss': 0.3737, 'grad_norm': 3.2568960189819336, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:04,  3.15it/s] 68%|██████▊   | 27/40 [00:14<00:04,  3.07it/s]                                               {'loss': 0.2299, 'grad_norm': 4.252413272857666, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:04,  3.07it/s] 70%|███████   | 28/40 [00:14<00:03,  3.02it/s]                                               {'loss': 0.143, 'grad_norm': 2.9258437156677246, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:03,  3.02it/s] 72%|███████▎  | 29/40 [00:15<00:03,  2.98it/s]                                               {'loss': 0.2224, 'grad_norm': 2.1885502338409424, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:03,  2.98it/s] 75%|███████▌  | 30/40 [00:15<00:03,  2.95it/s]                                               {'loss': 0.2091, 'grad_norm': 4.589158535003662, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:03,  2.95it/s] 78%|███████▊  | 31/40 [00:15<00:03,  2.93it/s]                                               {'loss': 0.2394, 'grad_norm': 4.051148891448975, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:03,  2.93it/s]                                               {'loss': 0.016, 'grad_norm': 0.9357004165649414, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:15<00:02,  2.93it/s] 82%|████████▎ | 33/40 [00:16<00:01,  3.65it/s]                                               {'loss': 0.1036, 'grad_norm': 1.719191074371338, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:01,  3.65it/s] 85%|████████▌ | 34/40 [00:16<00:01,  3.45it/s]                                               {'loss': 0.0425, 'grad_norm': 1.0052502155303955, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:16<00:01,  3.45it/s] 88%|████████▊ | 35/40 [00:16<00:01,  3.29it/s]                                               {'loss': 0.1373, 'grad_norm': 3.2704520225524902, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:16<00:01,  3.29it/s] 90%|█████████ | 36/40 [00:17<00:01,  3.03it/s]                                               {'loss': 0.6894, 'grad_norm': 12.368205070495605, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:17<00:01,  3.03it/s] 92%|█████████▎| 37/40 [00:18<00:01,  2.27it/s]                                               {'loss': 0.202, 'grad_norm': 4.039024829864502, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:18<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:18<00:01,  1.99it/s]                                               {'loss': 0.3088, 'grad_norm': 4.342851638793945, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:18<00:01,  1.99it/s] 98%|█████████▊| 39/40 [00:19<00:00,  1.83it/s]                                               {'loss': 0.1246, 'grad_norm': 2.435760259628296, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:19<00:00,  1.83it/s]                                               {'loss': 0.0347, 'grad_norm': 2.1704840660095215, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  1.83it/s]                                               {'train_runtime': 19.6076, 'train_samples_per_second': 28.815, 'train_steps_per_second': 2.04, 'train_loss': 0.760670084040612, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  1.83it/s]100%|██████████| 40/40 [00:19<00:00,  2.04it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]                                              {'loss': 2.3602, 'grad_norm': 10.191435813903809, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.43it/s]  5%|▌         | 2/40 [00:01<00:24,  1.56it/s]                                              {'loss': 2.4679, 'grad_norm': 12.96804141998291, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.56it/s]  8%|▊         | 3/40 [00:02<00:25,  1.45it/s]                                              {'loss': 1.2829, 'grad_norm': 14.218406677246094, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.45it/s] 10%|█         | 4/40 [00:02<00:23,  1.52it/s]                                              {'loss': 1.7722, 'grad_norm': 17.906972885131836, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.52it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s]                                              {'loss': 2.358, 'grad_norm': 22.967084884643555, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.48it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s]                                              {'loss': 1.2818, 'grad_norm': 12.89250659942627, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s]                                              {'loss': 1.185, 'grad_norm': 18.05658721923828, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.52it/s] 20%|██        | 8/40 [00:04<00:17,  1.84it/s]                                              {'loss': 3.6194, 'grad_norm': 114.02903747558594, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:17,  1.84it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.79it/s]                                              {'loss': 0.512, 'grad_norm': 4.217796802520752, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.79it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s]                                               {'loss': 1.2345, 'grad_norm': 9.282641410827637, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.64it/s] 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s]                                               {'loss': 0.802, 'grad_norm': 9.449609756469727, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s] 30%|███       | 12/40 [00:07<00:17,  1.56it/s]                                               {'loss': 1.406, 'grad_norm': 18.273895263671875, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.56it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.53it/s]                                               {'loss': 1.0317, 'grad_norm': 9.015047073364258, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.53it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s]                                               {'loss': 1.2879, 'grad_norm': 11.252942085266113, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.50it/s]                                               {'loss': 0.7976, 'grad_norm': 6.398260116577148, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.50it/s]                                               {'loss': 0.013, 'grad_norm': 1.0361583232879639, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.50it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.84it/s]                                               {'loss': 0.5551, 'grad_norm': 9.522706031799316, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.84it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.78it/s]                                               {'loss': 0.2815, 'grad_norm': 5.631928443908691, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.78it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s]                                               {'loss': 0.3437, 'grad_norm': 3.889559507369995, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s] 50%|█████     | 20/40 [00:12<00:12,  1.61it/s]                                               {'loss': 0.1689, 'grad_norm': 3.7748730182647705, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.61it/s] 52%|█████▎    | 21/40 [00:13<00:11,  1.61it/s]                                               {'loss': 0.3902, 'grad_norm': 3.2449839115142822, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:11,  1.61it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.53it/s]                                               {'loss': 0.7442, 'grad_norm': 8.942801475524902, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.53it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.4971, 'grad_norm': 2.8294546604156494, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s] 60%|██████    | 24/40 [00:14<00:07,  2.03it/s]                                               {'loss': 0.0378, 'grad_norm': 2.136514663696289, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:07,  2.03it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.88it/s]                                               {'loss': 0.139, 'grad_norm': 5.619613170623779, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.88it/s] 65%|██████▌   | 26/40 [00:15<00:08,  1.68it/s]                                               {'loss': 0.6041, 'grad_norm': 7.9820027351379395, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:08,  1.68it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.65it/s]                                               {'loss': 0.9072, 'grad_norm': 6.791733741760254, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.65it/s] 70%|███████   | 28/40 [00:17<00:07,  1.58it/s]                                               {'loss': 0.0709, 'grad_norm': 1.770471215248108, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.58it/s] 72%|███████▎  | 29/40 [00:17<00:07,  1.54it/s]                                               {'loss': 0.1841, 'grad_norm': 3.4220166206359863, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:07,  1.54it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.57it/s]                                               {'loss': 0.0629, 'grad_norm': 1.7218623161315918, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.57it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.50it/s]                                               {'loss': 0.1115, 'grad_norm': 2.2776081562042236, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.50it/s]                                               {'loss': 0.0107, 'grad_norm': 0.8363016247749329, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.50it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.87it/s]                                               {'loss': 0.4147, 'grad_norm': 0.3912195563316345, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.87it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.79it/s]                                               {'loss': 0.0685, 'grad_norm': 3.8737082481384277, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.79it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.65it/s]                                               {'loss': 0.1542, 'grad_norm': 1.9895867109298706, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.65it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.62it/s]                                               {'loss': 0.351, 'grad_norm': 1.3583526611328125, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s]                                               {'loss': 0.1167, 'grad_norm': 3.703889846801758, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.51it/s]                                               {'loss': 0.2169, 'grad_norm': 0.6063444018363953, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.51it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.53it/s]                                               {'loss': 0.1204, 'grad_norm': 0.7435263991355896, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.53it/s]100%|██████████| 40/40 [00:24<00:00,  2.02it/s]                                               {'loss': 0.0072, 'grad_norm': 0.7372690439224243, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.02it/s]                                               {'train_runtime': 24.5243, 'train_samples_per_second': 23.038, 'train_steps_per_second': 1.631, 'train_loss': 0.7492488081217743, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.02it/s]100%|██████████| 40/40 [00:24<00:00,  1.63it/s]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.37it/s]                                              {'loss': 1.9715, 'grad_norm': 11.267451286315918, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.37it/s]  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]                                              {'loss': 1.4577, 'grad_norm': 10.206014633178711, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.46it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s]                                              {'loss': 1.694, 'grad_norm': 14.656826972961426, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:20,  1.78it/s]                                              {'loss': 1.8153, 'grad_norm': 21.8273868560791, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.78it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.05it/s]                                              {'loss': 0.7033, 'grad_norm': 12.957371711730957, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.05it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.01it/s]                                              {'loss': 1.2445, 'grad_norm': 10.645829200744629, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.01it/s] 18%|█▊        | 7/40 [00:03<00:18,  1.80it/s]                                              {'loss': 1.3927, 'grad_norm': 15.20876407623291, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:18,  1.80it/s]                                              {'loss': 0.0292, 'grad_norm': 1.882873296737671, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:17,  1.80it/s] 22%|██▎       | 9/40 [00:04<00:15,  2.06it/s]                                              {'loss': 1.072, 'grad_norm': 7.631009578704834, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:15,  2.06it/s] 25%|██▌       | 10/40 [00:05<00:15,  1.88it/s]                                               {'loss': 0.1472, 'grad_norm': 3.1289830207824707, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:15,  1.88it/s] 28%|██▊       | 11/40 [00:06<00:16,  1.77it/s]                                               {'loss': 0.8388, 'grad_norm': 7.165007591247559, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:16,  1.77it/s] 30%|███       | 12/40 [00:06<00:16,  1.65it/s]                                               {'loss': 0.5429, 'grad_norm': 5.318747043609619, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:16,  1.65it/s] 32%|███▎      | 13/40 [00:07<00:16,  1.64it/s]                                               {'loss': 0.4631, 'grad_norm': 8.515244483947754, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:16,  1.64it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.56it/s]                                               {'loss': 0.4852, 'grad_norm': 4.311110496520996, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.56it/s] 38%|███▊      | 15/40 [00:08<00:16,  1.51it/s]                                               {'loss': 0.7242, 'grad_norm': 5.154010772705078, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:16,  1.51it/s]                                               {'loss': 3.5223, 'grad_norm': 48.95423889160156, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:15,  1.51it/s] 42%|████▎     | 17/40 [00:09<00:12,  1.91it/s]                                               {'loss': 0.3482, 'grad_norm': 3.1697888374328613, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:12,  1.91it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s]                                               {'loss': 0.2275, 'grad_norm': 2.3547465801239014, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:10<00:12,  1.70it/s]                                               {'loss': 0.8025, 'grad_norm': 13.150973320007324, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:12,  1.70it/s] 50%|█████     | 20/40 [00:11<00:12,  1.64it/s]                                               {'loss': 0.1707, 'grad_norm': 2.097013473510742, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:12,  1.64it/s] 52%|█████▎    | 21/40 [00:12<00:12,  1.56it/s]                                               {'loss': 0.4914, 'grad_norm': 6.7542829513549805, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:12,  1.56it/s] 55%|█████▌    | 22/40 [00:12<00:11,  1.58it/s]                                               {'loss': 0.4752, 'grad_norm': 6.022765636444092, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:11,  1.58it/s] 57%|█████▊    | 23/40 [00:13<00:11,  1.53it/s]                                               {'loss': 0.3824, 'grad_norm': 2.0570504665374756, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:11,  1.53it/s]                                               {'loss': 0.035, 'grad_norm': 1.5661238431930542, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:14<00:08,  1.86it/s]                                               {'loss': 0.5826, 'grad_norm': 1.495793342590332, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:08,  1.86it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s]                                               {'loss': 0.0695, 'grad_norm': 1.6576809883117676, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:15<00:07,  1.67it/s]                                               {'loss': 0.1725, 'grad_norm': 4.0052361488342285, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:07,  1.67it/s] 70%|███████   | 28/40 [00:16<00:07,  1.59it/s]                                               {'loss': 0.0586, 'grad_norm': 2.030789613723755, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.59it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.60it/s]                                               {'loss': 0.354, 'grad_norm': 4.861684322357178, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.60it/s] 75%|███████▌  | 30/40 [00:17<00:06,  1.53it/s]                                               {'loss': 0.3257, 'grad_norm': 6.77462100982666, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:06,  1.53it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.56it/s]                                               {'loss': 0.2519, 'grad_norm': 3.2195115089416504, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.56it/s]                                               {'loss': 0.4659, 'grad_norm': 11.944665908813477, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:05,  1.56it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.91it/s]                                               {'loss': 0.2162, 'grad_norm': 4.574674129486084, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.75it/s]                                               {'loss': 0.2579, 'grad_norm': 0.8065827488899231, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.75it/s] 88%|████████▊ | 35/40 [00:20<00:02,  1.72it/s]                                               {'loss': 0.3738, 'grad_norm': 1.3505439758300781, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  1.72it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s]                                               {'loss': 0.0969, 'grad_norm': 1.7962204217910767, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.53it/s]                                               {'loss': 0.0521, 'grad_norm': 1.1621052026748657, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.53it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.56it/s]                                               {'loss': 0.0869, 'grad_norm': 2.3901264667510986, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.50it/s]                                               {'loss': 0.0672, 'grad_norm': 1.5773378610610962, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.50it/s]                                               {'loss': 0.0012, 'grad_norm': 0.06513343751430511, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.50it/s]                                               {'train_runtime': 23.6407, 'train_samples_per_second': 23.9, 'train_steps_per_second': 1.692, 'train_loss': 0.6117365409154445, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.50it/s]100%|██████████| 40/40 [00:23<00:00,  1.69it/s]
CLIENT:87
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.97it/s]                                              {'loss': 1.8386, 'grad_norm': 11.500510215759277, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.97it/s]  5%|▌         | 2/40 [00:00<00:12,  2.94it/s]                                              {'loss': 2.0631, 'grad_norm': 13.016458511352539, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.94it/s]  8%|▊         | 3/40 [00:01<00:12,  2.94it/s]                                              {'loss': 1.1313, 'grad_norm': 11.71959400177002, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.94it/s] 10%|█         | 4/40 [00:01<00:12,  2.96it/s]                                              {'loss': 1.4605, 'grad_norm': 18.479536056518555, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.96it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.93it/s]                                              {'loss': 0.9297, 'grad_norm': 12.45574951171875, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.93it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s]                                              {'loss': 0.5758, 'grad_norm': 13.055475234985352, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.92it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.90it/s]                                              {'loss': 0.5956, 'grad_norm': 8.752124786376953, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.90it/s]                                              {'loss': 2.2692, 'grad_norm': 63.15220642089844, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.90it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.63it/s]                                              {'loss': 0.3066, 'grad_norm': 8.121298789978027, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.63it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.71it/s]                                               {'loss': 0.3664, 'grad_norm': 6.911101818084717, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.71it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.33it/s]                                               {'loss': 0.5111, 'grad_norm': 8.358705520629883, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.33it/s] 30%|███       | 12/40 [00:04<00:12,  2.20it/s]                                               {'loss': 0.3913, 'grad_norm': 7.392542362213135, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.20it/s] 32%|███▎      | 13/40 [00:04<00:11,  2.32it/s]                                               {'loss': 0.3453, 'grad_norm': 5.04295539855957, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:11,  2.32it/s] 35%|███▌      | 14/40 [00:05<00:12,  2.03it/s]                                               {'loss': 0.582, 'grad_norm': 8.227821350097656, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:12,  2.03it/s] 38%|███▊      | 15/40 [00:06<00:13,  1.81it/s]                                               {'loss': 0.4777, 'grad_norm': 5.288272380828857, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:13,  1.81it/s]                                               {'loss': 0.0499, 'grad_norm': 2.1755287647247314, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:13,  1.81it/s] 42%|████▎     | 17/40 [00:07<00:10,  2.12it/s]                                               {'loss': 0.2635, 'grad_norm': 4.634819507598877, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:10,  2.12it/s] 45%|████▌     | 18/40 [00:07<00:11,  1.93it/s]                                               {'loss': 0.2935, 'grad_norm': 4.080811977386475, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:11,  1.93it/s] 48%|████▊     | 19/40 [00:08<00:11,  1.76it/s]                                               {'loss': 0.0506, 'grad_norm': 0.8876822590827942, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:11,  1.76it/s] 50%|█████     | 20/40 [00:09<00:11,  1.72it/s]                                               {'loss': 0.3146, 'grad_norm': 5.557101726531982, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:11,  1.72it/s] 52%|█████▎    | 21/40 [00:09<00:11,  1.62it/s]                                               {'loss': 0.2578, 'grad_norm': 1.2976218461990356, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:11,  1.62it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.55it/s]                                               {'loss': 0.1332, 'grad_norm': 1.1608965396881104, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.55it/s] 57%|█████▊    | 23/40 [00:11<00:10,  1.59it/s]                                               {'loss': 0.2482, 'grad_norm': 6.191672325134277, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:10,  1.59it/s]                                               {'loss': 0.0219, 'grad_norm': 1.4509583711624146, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:10,  1.59it/s] 62%|██████▎   | 25/40 [00:11<00:07,  1.90it/s]                                               {'loss': 0.0459, 'grad_norm': 0.8507850766181946, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:07,  1.90it/s] 65%|██████▌   | 26/40 [00:12<00:07,  1.79it/s]                                               {'loss': 0.2576, 'grad_norm': 2.301192283630371, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:07,  1.79it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.71it/s]                                               {'loss': 0.0499, 'grad_norm': 1.6078782081604004, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.71it/s] 70%|███████   | 28/40 [00:13<00:07,  1.61it/s]                                               {'loss': 0.2139, 'grad_norm': 6.439699649810791, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:13<00:07,  1.61it/s] 72%|███████▎  | 29/40 [00:14<00:06,  1.61it/s]                                               {'loss': 0.1987, 'grad_norm': 5.738833427429199, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:06,  1.61it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.54it/s]                                               {'loss': 0.0555, 'grad_norm': 3.267522096633911, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.54it/s] 78%|███████▊  | 31/40 [00:15<00:05,  1.50it/s]                                               {'loss': 0.1627, 'grad_norm': 4.525984287261963, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:05,  1.50it/s]                                               {'loss': 0.0062, 'grad_norm': 0.4824260473251343, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:15<00:05,  1.50it/s] 82%|████████▎ | 33/40 [00:16<00:03,  1.91it/s]                                               {'loss': 0.3797, 'grad_norm': 6.251935958862305, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.76it/s]                                               {'loss': 0.0274, 'grad_norm': 0.7476405501365662, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:18<00:03,  1.65it/s]                                               {'loss': 0.1412, 'grad_norm': 5.5822248458862305, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:03,  1.65it/s] 90%|█████████ | 36/40 [00:18<00:02,  1.66it/s]                                               {'loss': 0.0516, 'grad_norm': 1.711129069328308, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:02,  1.66it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.56it/s]                                               {'loss': 0.0552, 'grad_norm': 1.998346209526062, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.56it/s] 95%|█████████▌| 38/40 [00:19<00:01,  1.58it/s]                                               {'loss': 0.0754, 'grad_norm': 1.9743224382400513, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:19<00:01,  1.58it/s] 98%|█████████▊| 39/40 [00:20<00:00,  1.52it/s]                                               {'loss': 0.1162, 'grad_norm': 1.0331825017929077, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  1.52it/s]                                               {'loss': 0.2044, 'grad_norm': 12.292597770690918, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.52it/s]                                               {'train_runtime': 21.0276, 'train_samples_per_second': 26.869, 'train_steps_per_second': 1.902, 'train_loss': 0.4379788609803654, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.52it/s]100%|██████████| 40/40 [00:21<00:00,  1.90it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:43,  1.13s/it]                                              {'loss': 2.0609, 'grad_norm': 7.791899681091309, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:43,  1.13s/it]  5%|▌         | 2/40 [00:01<00:33,  1.14it/s]                                              {'loss': 1.8645, 'grad_norm': 12.668338775634766, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:33,  1.14it/s]  8%|▊         | 3/40 [00:02<00:27,  1.33it/s]                                              {'loss': 1.2779, 'grad_norm': 12.824089050292969, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.33it/s] 10%|█         | 4/40 [00:03<00:26,  1.34it/s]                                              {'loss': 1.0117, 'grad_norm': 10.215086936950684, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s]                                              {'loss': 0.6885, 'grad_norm': 8.942508697509766, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.44it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.42it/s]                                              {'loss': 1.0886, 'grad_norm': 12.816550254821777, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.42it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 0.921, 'grad_norm': 13.69926929473877, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 2.5397, 'grad_norm': 94.63819122314453, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.42it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 0.4359, 'grad_norm': 7.25816535949707, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s]                                               {'loss': 0.8155, 'grad_norm': 8.42724895477295, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.72it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.63it/s]                                               {'loss': 0.1565, 'grad_norm': 4.692565441131592, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.63it/s] 30%|███       | 12/40 [00:07<00:17,  1.64it/s]                                               {'loss': 0.515, 'grad_norm': 6.228620529174805, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.64it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.54it/s]                                               {'loss': 0.2969, 'grad_norm': 5.615026950836182, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.54it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.4871, 'grad_norm': 3.857954263687134, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.54it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.53it/s]                                               {'loss': 0.31, 'grad_norm': 6.286901950836182, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.53it/s]                                               {'loss': 0.2396, 'grad_norm': 14.014143943786621, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:15,  1.53it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.87it/s]                                               {'loss': 0.2891, 'grad_norm': 3.717144250869751, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.87it/s] 45%|████▌     | 18/40 [00:11<00:11,  1.89it/s]                                               {'loss': 0.1109, 'grad_norm': 4.205580234527588, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:11,  1.89it/s] 48%|████▊     | 19/40 [00:11<00:10,  2.09it/s]                                               {'loss': 0.5752, 'grad_norm': 21.275863647460938, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:10,  2.09it/s] 50%|█████     | 20/40 [00:11<00:08,  2.26it/s]                                               {'loss': 0.2372, 'grad_norm': 7.151976108551025, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:08,  2.26it/s] 52%|█████▎    | 21/40 [00:12<00:07,  2.41it/s]                                               {'loss': 0.1867, 'grad_norm': 4.263338088989258, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:07,  2.41it/s] 55%|█████▌    | 22/40 [00:12<00:07,  2.55it/s]                                               {'loss': 0.3937, 'grad_norm': 4.9245452880859375, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:07,  2.55it/s] 57%|█████▊    | 23/40 [00:12<00:06,  2.65it/s]                                               {'loss': 0.2262, 'grad_norm': 3.8909544944763184, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:06,  2.65it/s]                                               {'loss': 1.6819, 'grad_norm': 20.463407516479492, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:06,  2.65it/s] 62%|██████▎   | 25/40 [00:13<00:04,  3.43it/s]                                               {'loss': 0.0947, 'grad_norm': 1.8976924419403076, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:04,  3.43it/s] 65%|██████▌   | 26/40 [00:13<00:04,  3.25it/s]                                               {'loss': 0.2474, 'grad_norm': 3.671482563018799, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:04,  3.25it/s] 68%|██████▊   | 27/40 [00:14<00:04,  3.13it/s]                                               {'loss': 0.0826, 'grad_norm': 1.9615225791931152, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:04,  3.13it/s] 70%|███████   | 28/40 [00:14<00:03,  3.07it/s]                                               {'loss': 0.4131, 'grad_norm': 6.31822395324707, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:03,  3.07it/s] 72%|███████▎  | 29/40 [00:14<00:03,  2.95it/s]                                               {'loss': 0.1163, 'grad_norm': 2.574403762817383, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:03,  2.95it/s] 75%|███████▌  | 30/40 [00:15<00:04,  2.20it/s]                                               {'loss': 0.189, 'grad_norm': 3.504441738128662, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:04,  2.20it/s] 78%|███████▊  | 31/40 [00:16<00:04,  2.00it/s]                                               {'loss': 0.0298, 'grad_norm': 1.3383729457855225, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:04,  2.00it/s]                                               {'loss': 0.3886, 'grad_norm': 12.335007667541504, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:04,  2.00it/s] 82%|████████▎ | 33/40 [00:16<00:02,  2.49it/s]                                               {'loss': 0.1331, 'grad_norm': 2.3390491008758545, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:02,  2.49it/s] 85%|████████▌ | 34/40 [00:17<00:02,  2.20it/s]                                               {'loss': 0.0242, 'grad_norm': 0.8306244015693665, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:02,  2.20it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.92it/s]                                               {'loss': 0.048, 'grad_norm': 1.761658787727356, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.92it/s] 90%|█████████ | 36/40 [00:18<00:02,  1.76it/s]                                               {'loss': 0.051, 'grad_norm': 0.7879229784011841, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:02,  1.76it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.73it/s]                                               {'loss': 0.2739, 'grad_norm': 0.928630530834198, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.73it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.60it/s]                                               {'loss': 0.0302, 'grad_norm': 1.0970420837402344, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.60it/s] 98%|█████████▊| 39/40 [00:20<00:00,  1.58it/s]                                               {'loss': 0.1517, 'grad_norm': 2.1709890365600586, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  1.58it/s]                                               {'loss': 0.0879, 'grad_norm': 6.591857433319092, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.58it/s]                                               {'train_runtime': 21.0551, 'train_samples_per_second': 26.834, 'train_steps_per_second': 1.9, 'train_loss': 0.5192811645101756, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.58it/s]100%|██████████| 40/40 [00:21<00:00,  1.90it/s]
CLIENT:99
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:01,  1.57s/it]                                              {'loss': 2.9681, 'grad_norm': 13.708959579467773, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:01,  1.57s/it]  5%|▌         | 2/40 [00:02<00:40,  1.05s/it]                                              {'loss': 1.7694, 'grad_norm': 14.011509895324707, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:40,  1.05s/it]  8%|▊         | 3/40 [00:02<00:33,  1.12it/s]                                              {'loss': 2.9662, 'grad_norm': 19.03420639038086, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:33,  1.12it/s] 10%|█         | 4/40 [00:03<00:27,  1.29it/s]                                              {'loss': 0.8576, 'grad_norm': 16.626773834228516, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.29it/s] 12%|█▎        | 5/40 [00:04<00:26,  1.32it/s]                                              {'loss': 0.9054, 'grad_norm': 13.499537467956543, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:26,  1.32it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.42it/s]                                              {'loss': 1.1843, 'grad_norm': 8.095779418945312, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.42it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 0.7339, 'grad_norm': 9.066537857055664, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s] 20%|██        | 8/40 [00:06<00:21,  1.46it/s]                                              {'loss': 1.1165, 'grad_norm': 9.911591529846191, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:06<00:20,  1.52it/s]                                              {'loss': 1.0783, 'grad_norm': 11.499519348144531, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:20,  1.52it/s] 25%|██▌       | 10/40 [00:07<00:20,  1.46it/s]                                               {'loss': 0.4936, 'grad_norm': 6.667281627655029, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:20,  1.46it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s]                                               {'loss': 0.4851, 'grad_norm': 15.354912757873535, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s] 30%|███       | 12/40 [00:08<00:18,  1.50it/s]                                               {'loss': 1.2931, 'grad_norm': 4.72883415222168, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:18,  1.50it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.47it/s]                                               {'loss': 0.4473, 'grad_norm': 4.79241418838501, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:18,  1.47it/s] 35%|███▌      | 14/40 [00:10<00:17,  1.51it/s]                                               {'loss': 0.293, 'grad_norm': 3.5688748359680176, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:17,  1.51it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s]                                               {'loss': 0.1742, 'grad_norm': 2.475480079650879, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.48it/s] 40%|████      | 16/40 [00:11<00:16,  1.50it/s]                                               {'loss': 0.4216, 'grad_norm': 5.588138580322266, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:16,  1.50it/s] 42%|████▎     | 17/40 [00:12<00:15,  1.53it/s]                                               {'loss': 0.0861, 'grad_norm': 1.86555016040802, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:15,  1.53it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.49it/s]                                               {'loss': 0.7469, 'grad_norm': 7.190343379974365, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.49it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.53it/s]                                               {'loss': 0.0888, 'grad_norm': 1.8222204446792603, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.53it/s] 50%|█████     | 20/40 [00:14<00:13,  1.50it/s]                                               {'loss': 0.1246, 'grad_norm': 4.517433166503906, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.50it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s]                                               {'loss': 0.1788, 'grad_norm': 4.224273681640625, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:12,  1.48it/s] 55%|█████▌    | 22/40 [00:15<00:11,  1.53it/s]                                               {'loss': 0.268, 'grad_norm': 4.93267297744751, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:11,  1.53it/s] 57%|█████▊    | 23/40 [00:16<00:11,  1.48it/s]                                               {'loss': 0.6262, 'grad_norm': 3.3163743019104004, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:11,  1.48it/s] 60%|██████    | 24/40 [00:16<00:10,  1.54it/s]                                               {'loss': 0.0714, 'grad_norm': 1.4336813688278198, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:10,  1.54it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.52it/s]                                               {'loss': 0.1381, 'grad_norm': 0.2084587812423706, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.52it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.48it/s]                                               {'loss': 0.0813, 'grad_norm': 1.5606142282485962, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:09,  1.48it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s]                                               {'loss': 0.019, 'grad_norm': 0.5923486948013306, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.54it/s] 70%|███████   | 28/40 [00:19<00:08,  1.50it/s]                                               {'loss': 0.5478, 'grad_norm': 0.7016404867172241, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.50it/s] 72%|███████▎  | 29/40 [00:19<00:06,  1.66it/s]                                               {'loss': 0.0146, 'grad_norm': 0.6407667994499207, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:06,  1.66it/s] 75%|███████▌  | 30/40 [00:20<00:05,  1.91it/s]                                               {'loss': 0.2271, 'grad_norm': 3.788018226623535, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:05,  1.91it/s] 78%|███████▊  | 31/40 [00:20<00:04,  2.13it/s]                                               {'loss': 0.0381, 'grad_norm': 1.2157394886016846, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:04,  2.13it/s] 80%|████████  | 32/40 [00:20<00:03,  2.36it/s]                                               {'loss': 0.0581, 'grad_norm': 1.2495903968811035, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:20<00:03,  2.36it/s] 82%|████████▎ | 33/40 [00:21<00:02,  2.51it/s]                                               {'loss': 0.5353, 'grad_norm': 0.6773927211761475, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:02,  2.51it/s] 85%|████████▌ | 34/40 [00:21<00:02,  2.63it/s]                                               {'loss': 0.0126, 'grad_norm': 1.705706238746643, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:02,  2.63it/s] 88%|████████▊ | 35/40 [00:21<00:01,  2.71it/s]                                               {'loss': 0.0114, 'grad_norm': 0.25639858841896057, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:01,  2.71it/s] 90%|█████████ | 36/40 [00:22<00:01,  2.80it/s]                                               {'loss': 0.1457, 'grad_norm': 0.4784548878669739, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:01,  2.80it/s] 92%|█████████▎| 37/40 [00:22<00:01,  2.82it/s]                                               {'loss': 0.0169, 'grad_norm': 0.5323233604431152, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  2.82it/s] 95%|█████████▌| 38/40 [00:22<00:00,  2.89it/s]                                               {'loss': 0.0227, 'grad_norm': 0.7431979179382324, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:00,  2.89it/s] 98%|█████████▊| 39/40 [00:23<00:00,  2.87it/s]                                               {'loss': 0.0124, 'grad_norm': 0.35268789529800415, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  2.87it/s]100%|██████████| 40/40 [00:23<00:00,  2.91it/s]                                               {'loss': 0.0095, 'grad_norm': 0.18341292440891266, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.91it/s]                                               {'train_runtime': 23.9229, 'train_samples_per_second': 26.544, 'train_steps_per_second': 1.672, 'train_loss': 0.5317240668926388, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.91it/s]100%|██████████| 40/40 [00:23<00:00,  1.67it/s]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]                                              {'loss': 0.0135, 'grad_norm': 0.33670687675476074, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]                                              {'loss': 0.2856, 'grad_norm': 6.441709518432617, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:02<00:24,  1.48it/s]                                              {'loss': 0.0377, 'grad_norm': 1.1582496166229248, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.48it/s] 10%|█         | 4/40 [00:02<00:24,  1.45it/s]                                              {'loss': 0.0199, 'grad_norm': 0.2921847105026245, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.45it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 0.0312, 'grad_norm': 1.0032038688659668, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s]                                              {'loss': 0.0186, 'grad_norm': 0.3091415762901306, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.50it/s]                                              {'loss': 0.0403, 'grad_norm': 0.8914810419082642, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.50it/s]                                              {'loss': 0.0405, 'grad_norm': 1.784414291381836, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.50it/s] 22%|██▎       | 9/40 [00:05<00:15,  1.96it/s]                                              {'loss': 0.0048, 'grad_norm': 0.12956148386001587, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:15,  1.96it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s]                                               {'loss': 0.0075, 'grad_norm': 0.19266553223133087, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.69it/s]                                               {'loss': 0.0074, 'grad_norm': 0.26482105255126953, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.69it/s] 30%|███       | 12/40 [00:07<00:17,  1.64it/s]                                               {'loss': 0.0041, 'grad_norm': 0.13075168430805206, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.64it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 0.0104, 'grad_norm': 0.2742850184440613, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.58it/s]                                               {'loss': 0.007, 'grad_norm': 0.10354652255773544, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.58it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.0328, 'grad_norm': 1.377004861831665, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.0003, 'grad_norm': 0.014363848604261875, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.54it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.0069, 'grad_norm': 0.10189356654882431, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.79it/s]                                               {'loss': 0.0034, 'grad_norm': 0.05335143953561783, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.79it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.69it/s]                                               {'loss': 0.0042, 'grad_norm': 0.08813382685184479, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.69it/s] 50%|█████     | 20/40 [00:12<00:12,  1.65it/s]                                               {'loss': 0.0027, 'grad_norm': 0.04672584682703018, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.62it/s]                                               {'loss': 0.0043, 'grad_norm': 0.08544375747442245, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.62it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.56it/s]                                               {'loss': 0.0047, 'grad_norm': 0.08394424617290497, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.56it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.57it/s]                                               {'loss': 0.0049, 'grad_norm': 0.10548650473356247, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.57it/s]                                               {'loss': 0.0, 'grad_norm': 5.938638878433267e-07, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.57it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.93it/s]                                               {'loss': 0.002, 'grad_norm': 0.02508539892733097, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  1.93it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.77it/s]                                               {'loss': 0.0044, 'grad_norm': 0.05622383579611778, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.77it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.74it/s]                                               {'loss': 0.0065, 'grad_norm': 0.09631797671318054, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.74it/s] 70%|███████   | 28/40 [00:16<00:07,  1.65it/s]                                               {'loss': 0.0028, 'grad_norm': 0.030893167480826378, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.65it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.58it/s]                                               {'loss': 0.0028, 'grad_norm': 0.0427873432636261, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.58it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.61it/s]                                               {'loss': 0.0031, 'grad_norm': 0.04230962321162224, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.61it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.54it/s]                                               {'loss': 0.0024, 'grad_norm': 0.04028622433543205, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.54it/s]                                               {'loss': 0.0021, 'grad_norm': 0.07283676415681839, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.54it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.92it/s]                                               {'loss': 0.0018, 'grad_norm': 0.019995104521512985, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.92it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.80it/s]                                               {'loss': 0.0022, 'grad_norm': 0.03057771921157837, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.80it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s]                                               {'loss': 0.0027, 'grad_norm': 0.030386019498109818, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.67it/s]                                               {'loss': 0.0016, 'grad_norm': 0.024566996842622757, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.67it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.60it/s]                                               {'loss': 0.0025, 'grad_norm': 0.029634390026330948, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.60it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s]                                               {'loss': 0.0029, 'grad_norm': 0.037816017866134644, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.59it/s]                                               {'loss': 0.0061, 'grad_norm': 0.06942147016525269, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.59it/s]                                               {'loss': 0.0014, 'grad_norm': 0.03977586328983307, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  1.59it/s]                                               {'train_runtime': 24.0087, 'train_samples_per_second': 23.533, 'train_steps_per_second': 1.666, 'train_loss': 0.015999602823285386, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.59it/s]100%|██████████| 40/40 [00:24<00:00,  1.67it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:11,  6.56it/s]  1%|          | 3/471 [00:00<01:58,  3.96it/s]  1%|          | 4/471 [00:01<02:09,  3.60it/s]  1%|          | 5/471 [00:01<02:14,  3.45it/s]  1%|▏         | 6/471 [00:01<02:17,  3.37it/s]  1%|▏         | 7/471 [00:01<02:11,  3.53it/s]  2%|▏         | 8/471 [00:02<02:20,  3.29it/s]  2%|▏         | 9/471 [00:02<02:20,  3.29it/s]  2%|▏         | 10/471 [00:02<02:30,  3.07it/s]  2%|▏         | 11/471 [00:03<02:37,  2.93it/s]  3%|▎         | 12/471 [00:03<02:34,  2.97it/s]  3%|▎         | 13/471 [00:03<02:33,  2.99it/s]  3%|▎         | 14/471 [00:04<02:42,  2.81it/s]  3%|▎         | 15/471 [00:04<02:37,  2.89it/s]  3%|▎         | 16/471 [00:04<02:32,  2.97it/s]  4%|▎         | 17/471 [00:05<02:42,  2.80it/s]  4%|▍         | 18/471 [00:05<02:38,  2.86it/s]  4%|▍         | 19/471 [00:06<02:29,  3.03it/s]  4%|▍         | 20/471 [00:06<02:39,  2.83it/s]  4%|▍         | 21/471 [00:06<02:40,  2.81it/s]  5%|▍         | 22/471 [00:07<02:34,  2.91it/s]  5%|▍         | 23/471 [00:07<02:34,  2.90it/s]  5%|▌         | 24/471 [00:07<02:40,  2.78it/s]  5%|▌         | 25/471 [00:08<02:35,  2.86it/s]  6%|▌         | 26/471 [00:08<02:25,  3.06it/s]  6%|▌         | 27/471 [00:08<02:35,  2.85it/s]  6%|▌         | 28/471 [00:09<02:36,  2.83it/s]  6%|▌         | 29/471 [00:09<02:31,  2.92it/s]  6%|▋         | 30/471 [00:09<02:32,  2.90it/s]  7%|▋         | 31/471 [00:10<02:37,  2.79it/s]  7%|▋         | 32/471 [00:10<02:32,  2.89it/s]  7%|▋         | 33/471 [00:10<02:28,  2.95it/s]  7%|▋         | 34/471 [00:11<02:36,  2.79it/s]  7%|▋         | 35/471 [00:11<02:31,  2.87it/s]  8%|▊         | 36/471 [00:11<02:24,  3.01it/s]  8%|▊         | 37/471 [00:12<02:34,  2.82it/s]  8%|▊         | 38/471 [00:12<02:32,  2.83it/s]  8%|▊         | 39/471 [00:12<02:25,  2.97it/s]  8%|▊         | 40/471 [00:13<02:30,  2.86it/s]  9%|▊         | 41/471 [00:13<02:34,  2.79it/s]  9%|▉         | 42/471 [00:14<02:28,  2.88it/s]  9%|▉         | 43/471 [00:14<02:28,  2.89it/s]  9%|▉         | 44/471 [00:14<02:34,  2.77it/s] 10%|▉         | 45/471 [00:15<02:28,  2.86it/s] 10%|▉         | 46/471 [00:15<02:25,  2.91it/s] 10%|▉         | 47/471 [00:15<02:34,  2.75it/s] 10%|█         | 48/471 [00:16<02:29,  2.84it/s] 10%|█         | 49/471 [00:16<02:22,  2.97it/s] 11%|█         | 50/471 [00:16<02:23,  2.94it/s] 11%|█         | 51/471 [00:17<02:29,  2.81it/s] 11%|█         | 52/471 [00:17<02:25,  2.89it/s] 11%|█▏        | 53/471 [00:17<02:22,  2.92it/s] 11%|█▏        | 54/471 [00:18<02:30,  2.76it/s] 12%|█▏        | 55/471 [00:18<02:25,  2.86it/s] 12%|█▏        | 56/471 [00:18<02:19,  2.97it/s] 12%|█▏        | 57/471 [00:19<02:27,  2.80it/s] 12%|█▏        | 58/471 [00:19<02:26,  2.82it/s] 13%|█▎        | 59/471 [00:19<02:20,  2.93it/s] 13%|█▎        | 60/471 [00:20<02:24,  2.85it/s] 13%|█▎        | 61/471 [00:20<02:27,  2.78it/s] 13%|█▎        | 62/471 [00:21<02:22,  2.87it/s] 13%|█▎        | 63/471 [00:21<02:21,  2.88it/s] 14%|█▎        | 64/471 [00:21<02:27,  2.76it/s] 14%|█▍        | 65/471 [00:22<02:22,  2.85it/s] 14%|█▍        | 66/471 [00:22<02:18,  2.91it/s] 14%|█▍        | 67/471 [00:22<02:26,  2.76it/s] 14%|█▍        | 68/471 [00:23<02:21,  2.84it/s] 15%|█▍        | 69/471 [00:23<02:16,  2.95it/s] 15%|█▍        | 70/471 [00:23<02:24,  2.78it/s] 15%|█▌        | 71/471 [00:24<02:23,  2.80it/s] 15%|█▌        | 72/471 [00:24<02:15,  2.94it/s] 15%|█▌        | 73/471 [00:24<02:14,  2.96it/s] 16%|█▌        | 74/471 [00:25<02:22,  2.79it/s] 16%|█▌        | 75/471 [00:25<02:18,  2.87it/s] 16%|█▌        | 76/471 [00:25<02:14,  2.95it/s] 16%|█▋        | 77/471 [00:26<02:22,  2.76it/s] 17%|█▋        | 78/471 [00:26<02:19,  2.83it/s] 17%|█▋        | 79/471 [00:27<02:12,  2.96it/s] 17%|█▋        | 80/471 [00:27<02:20,  2.79it/s] 17%|█▋        | 81/471 [00:27<02:19,  2.79it/s] 17%|█▋        | 82/471 [00:28<02:13,  2.91it/s] 18%|█▊        | 83/471 [00:28<02:17,  2.83it/s] 18%|█▊        | 84/471 [00:28<02:20,  2.76it/s] 18%|█▊        | 85/471 [00:29<02:15,  2.84it/s] 18%|█▊        | 86/471 [00:29<02:14,  2.85it/s] 18%|█▊        | 87/471 [00:29<02:20,  2.74it/s] 19%|█▊        | 88/471 [00:30<02:15,  2.83it/s] 19%|█▉        | 89/471 [00:30<02:12,  2.89it/s] 19%|█▉        | 90/471 [00:30<02:19,  2.73it/s] 19%|█▉        | 91/471 [00:31<02:14,  2.83it/s] 20%|█▉        | 92/471 [00:31<02:09,  2.93it/s] 20%|█▉        | 93/471 [00:32<02:16,  2.78it/s] 20%|█▉        | 94/471 [00:32<02:14,  2.81it/s] 20%|██        | 95/471 [00:32<02:07,  2.95it/s] 20%|██        | 96/471 [00:32<02:05,  2.99it/s] 21%|██        | 97/471 [00:33<02:14,  2.79it/s] 21%|██        | 98/471 [00:33<02:09,  2.87it/s] 21%|██        | 99/471 [00:34<02:04,  2.99it/s] 21%|██        | 100/471 [00:34<02:11,  2.81it/s] 21%|██▏       | 101/471 [00:34<02:10,  2.82it/s] 22%|██▏       | 102/471 [00:35<02:04,  2.96it/s] 22%|██▏       | 103/471 [00:35<02:09,  2.84it/s] 22%|██▏       | 104/471 [00:35<02:12,  2.76it/s] 22%|██▏       | 105/471 [00:36<02:09,  2.84it/s] 23%|██▎       | 106/471 [00:36<02:07,  2.85it/s] 23%|██▎       | 107/471 [00:36<02:13,  2.74it/s] 23%|██▎       | 108/471 [00:37<02:07,  2.84it/s] 23%|██▎       | 109/471 [00:37<02:05,  2.89it/s] 23%|██▎       | 110/471 [00:37<02:11,  2.74it/s] 24%|██▎       | 111/471 [00:38<02:07,  2.83it/s] 24%|██▍       | 112/471 [00:38<02:01,  2.96it/s] 24%|██▍       | 113/471 [00:39<02:08,  2.79it/s] 24%|██▍       | 114/471 [00:39<02:07,  2.80it/s] 24%|██▍       | 115/471 [00:39<02:01,  2.93it/s] 25%|██▍       | 116/471 [00:40<02:08,  2.77it/s] 25%|██▍       | 117/471 [00:40<02:08,  2.75it/s] 25%|██▌       | 118/471 [00:40<02:03,  2.85it/s] 25%|██▌       | 119/471 [00:41<01:50,  3.19it/s] 25%|██▌       | 120/471 [00:41<01:36,  3.63it/s] 26%|██▌       | 121/471 [00:41<01:27,  3.99it/s] 26%|██▌       | 122/471 [00:41<01:20,  4.31it/s] 26%|██▌       | 123/471 [00:41<01:16,  4.57it/s] 26%|██▋       | 124/471 [00:41<01:12,  4.79it/s] 27%|██▋       | 125/471 [00:42<01:10,  4.93it/s] 27%|██▋       | 126/471 [00:42<01:08,  5.07it/s] 27%|██▋       | 127/471 [00:42<01:07,  5.13it/s] 27%|██▋       | 128/471 [00:42<01:06,  5.17it/s] 27%|██▋       | 129/471 [00:42<01:05,  5.20it/s] 28%|██▊       | 130/471 [00:43<01:05,  5.24it/s] 28%|██▊       | 131/471 [00:43<01:05,  5.19it/s] 28%|██▊       | 132/471 [00:43<01:05,  5.20it/s] 28%|██▊       | 133/471 [00:43<01:05,  5.20it/s] 28%|██▊       | 134/471 [00:43<01:05,  5.16it/s] 29%|██▊       | 135/471 [00:44<01:19,  4.21it/s] 29%|██▉       | 136/471 [00:44<01:34,  3.55it/s] 29%|██▉       | 137/471 [00:44<01:45,  3.17it/s] 29%|██▉       | 138/471 [00:45<01:52,  2.97it/s] 30%|██▉       | 139/471 [00:45<01:55,  2.86it/s] 30%|██▉       | 140/471 [00:46<01:59,  2.78it/s] 30%|██▉       | 141/471 [00:46<02:02,  2.70it/s] 30%|███       | 142/471 [00:46<02:03,  2.67it/s] 30%|███       | 143/471 [00:47<02:03,  2.66it/s] 31%|███       | 144/471 [00:47<02:04,  2.62it/s] 31%|███       | 145/471 [00:48<02:03,  2.63it/s] 31%|███       | 146/471 [00:48<02:04,  2.62it/s] 31%|███       | 147/471 [00:48<02:04,  2.61it/s] 31%|███▏      | 148/471 [00:49<02:04,  2.59it/s] 32%|███▏      | 149/471 [00:49<02:04,  2.59it/s] 32%|███▏      | 150/471 [00:49<02:03,  2.59it/s] 32%|███▏      | 151/471 [00:50<02:04,  2.58it/s] 32%|███▏      | 152/471 [00:50<02:03,  2.59it/s] 32%|███▏      | 153/471 [00:51<02:03,  2.58it/s] 33%|███▎      | 154/471 [00:51<02:02,  2.59it/s] 33%|███▎      | 155/471 [00:51<02:02,  2.58it/s] 33%|███▎      | 156/471 [00:52<02:01,  2.59it/s] 33%|███▎      | 157/471 [00:52<02:01,  2.59it/s] 34%|███▎      | 158/471 [00:53<02:01,  2.57it/s] 34%|███▍      | 159/471 [00:53<02:00,  2.58it/s] 34%|███▍      | 160/471 [00:53<02:00,  2.58it/s] 34%|███▍      | 161/471 [00:54<01:59,  2.59it/s] 34%|███▍      | 162/471 [00:54<02:00,  2.57it/s] 35%|███▍      | 163/471 [00:55<02:00,  2.57it/s] 35%|███▍      | 164/471 [00:55<01:59,  2.57it/s] 35%|███▌      | 165/471 [00:55<02:00,  2.54it/s] 35%|███▌      | 166/471 [00:56<01:59,  2.55it/s] 35%|███▌      | 167/471 [00:56<01:58,  2.56it/s] 36%|███▌      | 168/471 [00:56<01:58,  2.56it/s] 36%|███▌      | 169/471 [00:57<01:58,  2.55it/s] 36%|███▌      | 170/471 [00:57<01:57,  2.57it/s] 36%|███▋      | 171/471 [00:58<01:56,  2.58it/s] 37%|███▋      | 172/471 [00:58<01:56,  2.57it/s] 37%|███▋      | 173/471 [00:58<01:56,  2.57it/s] 37%|███▋      | 174/471 [00:59<01:55,  2.57it/s] 37%|███▋      | 175/471 [00:59<01:54,  2.58it/s] 37%|███▋      | 176/471 [01:00<01:54,  2.57it/s] 38%|███▊      | 177/471 [01:00<01:54,  2.57it/s] 38%|███▊      | 178/471 [01:00<01:53,  2.59it/s] 38%|███▊      | 179/471 [01:01<01:53,  2.57it/s] 38%|███▊      | 180/471 [01:01<01:52,  2.58it/s] 38%|███▊      | 181/471 [01:02<01:52,  2.58it/s] 39%|███▊      | 182/471 [01:02<01:51,  2.58it/s] 39%|███▉      | 183/471 [01:02<01:52,  2.57it/s] 39%|███▉      | 184/471 [01:03<01:51,  2.58it/s] 39%|███▉      | 185/471 [01:03<01:50,  2.58it/s] 39%|███▉      | 186/471 [01:03<01:51,  2.56it/s] 40%|███▉      | 187/471 [01:04<01:50,  2.57it/s] 40%|███▉      | 188/471 [01:04<01:49,  2.57it/s] 40%|████      | 189/471 [01:05<01:49,  2.59it/s] 40%|████      | 190/471 [01:05<01:49,  2.57it/s] 41%|████      | 191/471 [01:05<01:48,  2.57it/s] 41%|████      | 192/471 [01:06<01:48,  2.58it/s] 41%|████      | 193/471 [01:06<01:48,  2.57it/s] 41%|████      | 194/471 [01:07<01:47,  2.58it/s] 41%|████▏     | 195/471 [01:07<01:46,  2.59it/s] 42%|████▏     | 196/471 [01:07<01:45,  2.60it/s] 42%|████▏     | 197/471 [01:08<01:46,  2.57it/s] 42%|████▏     | 198/471 [01:08<01:46,  2.57it/s] 42%|████▏     | 199/471 [01:09<01:45,  2.58it/s] 42%|████▏     | 200/471 [01:09<01:45,  2.56it/s] 43%|████▎     | 201/471 [01:09<01:45,  2.57it/s] 43%|████▎     | 202/471 [01:10<01:44,  2.57it/s] 43%|████▎     | 203/471 [01:10<01:44,  2.57it/s] 43%|████▎     | 204/471 [01:10<01:44,  2.56it/s] 44%|████▎     | 205/471 [01:11<01:43,  2.57it/s] 44%|████▎     | 206/471 [01:11<01:42,  2.58it/s] 44%|████▍     | 207/471 [01:12<01:43,  2.56it/s] 44%|████▍     | 208/471 [01:12<01:42,  2.57it/s] 44%|████▍     | 209/471 [01:12<01:41,  2.58it/s] 45%|████▍     | 210/471 [01:13<01:40,  2.59it/s] 45%|████▍     | 211/471 [01:13<01:41,  2.57it/s] 45%|████▌     | 212/471 [01:14<01:40,  2.57it/s] 45%|████▌     | 213/471 [01:14<01:40,  2.57it/s] 45%|████▌     | 214/471 [01:14<01:40,  2.55it/s] 46%|████▌     | 215/471 [01:15<01:39,  2.57it/s] 46%|████▌     | 216/471 [01:15<01:39,  2.57it/s] 46%|████▌     | 217/471 [01:16<01:39,  2.56it/s] 46%|████▋     | 218/471 [01:16<01:39,  2.55it/s] 46%|████▋     | 219/471 [01:16<01:38,  2.57it/s] 47%|████▋     | 220/471 [01:17<01:37,  2.57it/s] 47%|████▋     | 221/471 [01:17<01:38,  2.55it/s] 47%|████▋     | 222/471 [01:17<01:37,  2.56it/s] 47%|████▋     | 223/471 [01:18<01:36,  2.57it/s] 48%|████▊     | 224/471 [01:18<01:36,  2.57it/s] 48%|████▊     | 225/471 [01:19<01:36,  2.55it/s] 48%|████▊     | 226/471 [01:19<01:35,  2.56it/s] 48%|████▊     | 227/471 [01:19<01:35,  2.56it/s] 48%|████▊     | 228/471 [01:20<01:35,  2.54it/s] 49%|████▊     | 229/471 [01:20<01:35,  2.54it/s] 49%|████▉     | 230/471 [01:21<01:34,  2.55it/s] 49%|████▉     | 231/471 [01:21<01:33,  2.57it/s] 49%|████▉     | 232/471 [01:21<01:33,  2.54it/s] 49%|████▉     | 233/471 [01:22<01:33,  2.55it/s] 50%|████▉     | 234/471 [01:22<01:33,  2.55it/s] 50%|████▉     | 235/471 [01:23<01:32,  2.54it/s] 50%|█████     | 236/471 [01:23<01:31,  2.56it/s] 50%|█████     | 237/471 [01:23<01:31,  2.57it/s] 51%|█████     | 238/471 [01:24<01:29,  2.59it/s] 51%|█████     | 239/471 [01:24<01:30,  2.57it/s] 51%|█████     | 240/471 [01:25<01:30,  2.56it/s] 51%|█████     | 241/471 [01:25<01:29,  2.57it/s] 51%|█████▏    | 242/471 [01:25<01:29,  2.55it/s] 52%|█████▏    | 243/471 [01:26<01:29,  2.55it/s] 52%|█████▏    | 244/471 [01:26<01:28,  2.56it/s] 52%|█████▏    | 245/471 [01:26<01:28,  2.56it/s] 52%|█████▏    | 246/471 [01:27<01:28,  2.55it/s] 52%|█████▏    | 247/471 [01:27<01:31,  2.45it/s] 53%|█████▎    | 248/471 [01:28<01:36,  2.30it/s] 53%|█████▎    | 249/471 [01:28<01:33,  2.38it/s] 53%|█████▎    | 250/471 [01:29<01:30,  2.44it/s] 53%|█████▎    | 251/471 [01:29<01:28,  2.49it/s] 54%|█████▎    | 252/471 [01:29<01:27,  2.49it/s] 54%|█████▎    | 253/471 [01:30<01:26,  2.51it/s] 54%|█████▍    | 254/471 [01:30<01:25,  2.53it/s] 54%|█████▍    | 255/471 [01:31<01:25,  2.53it/s] 54%|█████▍    | 256/471 [01:31<01:24,  2.56it/s] 55%|█████▍    | 257/471 [01:31<01:23,  2.57it/s] 55%|█████▍    | 258/471 [01:32<01:22,  2.57it/s] 55%|█████▍    | 259/471 [01:32<01:23,  2.55it/s] 55%|█████▌    | 260/471 [01:32<01:22,  2.56it/s] 55%|█████▌    | 261/471 [01:33<01:21,  2.58it/s] 56%|█████▌    | 262/471 [01:33<01:21,  2.56it/s] 56%|█████▌    | 263/471 [01:34<01:20,  2.57it/s] 56%|█████▌    | 264/471 [01:34<01:20,  2.57it/s] 56%|█████▋    | 265/471 [01:34<01:19,  2.58it/s] 56%|█████▋    | 266/471 [01:35<01:20,  2.55it/s] 57%|█████▋    | 267/471 [01:35<01:19,  2.57it/s] 57%|█████▋    | 268/471 [01:36<01:18,  2.58it/s] 57%|█████▋    | 269/471 [01:36<01:18,  2.56it/s] 57%|█████▋    | 270/471 [01:36<01:18,  2.57it/s] 58%|█████▊    | 271/471 [01:37<01:17,  2.58it/s] 58%|█████▊    | 272/471 [01:37<01:17,  2.58it/s] 58%|█████▊    | 273/471 [01:38<01:16,  2.57it/s] 58%|█████▊    | 274/471 [01:38<01:16,  2.59it/s] 58%|█████▊    | 275/471 [01:38<01:15,  2.59it/s] 59%|█████▊    | 276/471 [01:39<01:16,  2.56it/s] 59%|█████▉    | 277/471 [01:39<01:15,  2.57it/s] 59%|█████▉    | 278/471 [01:39<01:15,  2.57it/s] 59%|█████▉    | 279/471 [01:40<01:15,  2.55it/s] 59%|█████▉    | 280/471 [01:40<01:14,  2.55it/s] 60%|█████▉    | 281/471 [01:41<01:14,  2.56it/s] 60%|█████▉    | 282/471 [01:41<01:13,  2.57it/s] 60%|██████    | 283/471 [01:41<01:13,  2.55it/s] 60%|██████    | 284/471 [01:42<01:13,  2.56it/s] 61%|██████    | 285/471 [01:42<01:12,  2.57it/s] 61%|██████    | 286/471 [01:43<01:12,  2.56it/s] 61%|██████    | 287/471 [01:43<01:11,  2.57it/s] 61%|██████    | 288/471 [01:43<01:11,  2.58it/s] 61%|██████▏   | 289/471 [01:44<01:10,  2.58it/s] 62%|██████▏   | 290/471 [01:44<01:10,  2.56it/s] 62%|██████▏   | 291/471 [01:45<01:10,  2.57it/s] 62%|██████▏   | 292/471 [01:45<01:09,  2.58it/s] 62%|██████▏   | 293/471 [01:45<01:09,  2.55it/s] 62%|██████▏   | 294/471 [01:46<01:09,  2.56it/s] 63%|██████▎   | 295/471 [01:46<01:08,  2.56it/s] 63%|██████▎   | 296/471 [01:47<01:08,  2.57it/s] 63%|██████▎   | 297/471 [01:47<01:08,  2.56it/s] 63%|██████▎   | 298/471 [01:47<01:07,  2.56it/s] 63%|██████▎   | 299/471 [01:48<01:06,  2.57it/s] 64%|██████▎   | 300/471 [01:48<01:06,  2.56it/s] 64%|██████▍   | 301/471 [01:48<01:06,  2.57it/s] 64%|██████▍   | 302/471 [01:49<01:05,  2.58it/s] 64%|██████▍   | 303/471 [01:49<01:05,  2.58it/s] 65%|██████▍   | 304/471 [01:50<01:05,  2.57it/s] 65%|██████▍   | 305/471 [01:50<01:04,  2.58it/s] 65%|██████▍   | 306/471 [01:50<01:04,  2.57it/s] 65%|██████▌   | 307/471 [01:51<01:04,  2.55it/s] 65%|██████▌   | 308/471 [01:51<01:03,  2.55it/s] 66%|██████▌   | 309/471 [01:52<01:03,  2.55it/s] 66%|██████▌   | 310/471 [01:52<01:03,  2.53it/s] 66%|██████▌   | 311/471 [01:52<01:02,  2.56it/s] 66%|██████▌   | 312/471 [01:53<01:01,  2.57it/s] 66%|██████▋   | 313/471 [01:53<01:01,  2.57it/s] 67%|██████▋   | 314/471 [01:54<01:01,  2.56it/s] 67%|██████▋   | 315/471 [01:54<01:00,  2.57it/s] 67%|██████▋   | 316/471 [01:54<01:00,  2.57it/s] 67%|██████▋   | 317/471 [01:55<01:00,  2.56it/s] 68%|██████▊   | 318/471 [01:55<00:59,  2.56it/s] 68%|██████▊   | 319/471 [01:55<00:59,  2.56it/s] 68%|██████▊   | 320/471 [01:56<00:58,  2.56it/s] 68%|██████▊   | 321/471 [01:56<00:59,  2.53it/s] 68%|██████▊   | 322/471 [01:57<00:58,  2.54it/s] 69%|██████▊   | 323/471 [01:57<00:58,  2.55it/s] 69%|██████▉   | 324/471 [01:57<00:57,  2.54it/s] 69%|██████▉   | 325/471 [01:58<00:57,  2.55it/s] 69%|██████▉   | 326/471 [01:58<00:56,  2.55it/s] 69%|██████▉   | 327/471 [01:59<00:56,  2.56it/s] 70%|██████▉   | 328/471 [01:59<00:56,  2.55it/s] 70%|██████▉   | 329/471 [01:59<00:55,  2.55it/s] 70%|███████   | 330/471 [02:00<00:54,  2.56it/s] 70%|███████   | 331/471 [02:00<00:54,  2.55it/s] 70%|███████   | 332/471 [02:01<00:54,  2.55it/s] 71%|███████   | 333/471 [02:01<00:53,  2.57it/s] 71%|███████   | 334/471 [02:01<00:53,  2.57it/s] 71%|███████   | 335/471 [02:02<00:53,  2.53it/s] 71%|███████▏  | 336/471 [02:02<00:53,  2.54it/s] 72%|███████▏  | 337/471 [02:03<00:52,  2.56it/s] 72%|███████▏  | 338/471 [02:03<00:52,  2.54it/s] 72%|███████▏  | 339/471 [02:03<00:51,  2.55it/s] 72%|███████▏  | 340/471 [02:04<00:51,  2.56it/s] 72%|███████▏  | 341/471 [02:04<00:50,  2.57it/s] 73%|███████▎  | 342/471 [02:05<00:50,  2.55it/s] 73%|███████▎  | 343/471 [02:05<00:50,  2.54it/s] 73%|███████▎  | 344/471 [02:05<00:49,  2.55it/s] 73%|███████▎  | 345/471 [02:06<00:49,  2.53it/s] 73%|███████▎  | 346/471 [02:06<00:49,  2.55it/s] 74%|███████▎  | 347/471 [02:06<00:48,  2.56it/s] 74%|███████▍  | 348/471 [02:07<00:48,  2.56it/s] 74%|███████▍  | 349/471 [02:07<00:47,  2.55it/s] 74%|███████▍  | 350/471 [02:08<00:47,  2.55it/s] 75%|███████▍  | 351/471 [02:08<00:46,  2.56it/s] 75%|███████▍  | 352/471 [02:08<00:46,  2.55it/s] 75%|███████▍  | 353/471 [02:09<00:46,  2.56it/s] 75%|███████▌  | 354/471 [02:09<00:45,  2.56it/s] 75%|███████▌  | 355/471 [02:10<00:45,  2.56it/s] 76%|███████▌  | 356/471 [02:10<00:45,  2.55it/s] 76%|███████▌  | 357/471 [02:10<00:44,  2.55it/s] 76%|███████▌  | 358/471 [02:11<00:44,  2.55it/s] 76%|███████▌  | 359/471 [02:11<00:43,  2.55it/s] 76%|███████▋  | 360/471 [02:12<00:43,  2.55it/s] 77%|███████▋  | 361/471 [02:12<00:43,  2.55it/s] 77%|███████▋  | 362/471 [02:12<00:42,  2.55it/s] 77%|███████▋  | 363/471 [02:13<00:42,  2.55it/s] 77%|███████▋  | 364/471 [02:13<00:41,  2.56it/s] 77%|███████▋  | 365/471 [02:14<00:41,  2.56it/s] 78%|███████▊  | 366/471 [02:14<00:41,  2.54it/s] 78%|███████▊  | 367/471 [02:14<00:40,  2.55it/s] 78%|███████▊  | 368/471 [02:15<00:40,  2.56it/s] 78%|███████▊  | 369/471 [02:15<00:39,  2.56it/s] 79%|███████▊  | 370/471 [02:15<00:39,  2.54it/s] 79%|███████▉  | 371/471 [02:16<00:39,  2.55it/s] 79%|███████▉  | 372/471 [02:16<00:38,  2.55it/s] 79%|███████▉  | 373/471 [02:17<00:38,  2.54it/s] 79%|███████▉  | 374/471 [02:17<00:38,  2.55it/s] 80%|███████▉  | 375/471 [02:17<00:37,  2.55it/s] 80%|███████▉  | 376/471 [02:18<00:37,  2.55it/s] 80%|████████  | 377/471 [02:18<00:37,  2.52it/s] 80%|████████  | 378/471 [02:19<00:36,  2.54it/s] 80%|████████  | 379/471 [02:19<00:36,  2.54it/s] 81%|████████  | 380/471 [02:19<00:36,  2.52it/s] 81%|████████  | 381/471 [02:20<00:35,  2.53it/s] 81%|████████  | 382/471 [02:20<00:35,  2.54it/s] 81%|████████▏ | 383/471 [02:21<00:34,  2.54it/s] 82%|████████▏ | 384/471 [02:21<00:34,  2.53it/s] 82%|████████▏ | 385/471 [02:21<00:33,  2.53it/s] 82%|████████▏ | 386/471 [02:22<00:33,  2.53it/s] 82%|████████▏ | 387/471 [02:22<00:33,  2.52it/s] 82%|████████▏ | 388/471 [02:23<00:32,  2.52it/s] 83%|████████▎ | 389/471 [02:23<00:32,  2.53it/s] 83%|████████▎ | 390/471 [02:23<00:32,  2.52it/s] 83%|████████▎ | 391/471 [02:24<00:31,  2.51it/s] 83%|████████▎ | 392/471 [02:24<00:31,  2.52it/s] 83%|████████▎ | 393/471 [02:25<00:30,  2.52it/s] 84%|████████▎ | 394/471 [02:25<00:30,  2.51it/s] 84%|████████▍ | 395/471 [02:25<00:29,  2.53it/s] 84%|████████▍ | 396/471 [02:26<00:29,  2.54it/s] 84%|████████▍ | 397/471 [02:26<00:29,  2.54it/s] 85%|████████▍ | 398/471 [02:27<00:28,  2.53it/s] 85%|████████▍ | 399/471 [02:27<00:28,  2.54it/s] 85%|████████▍ | 400/471 [02:27<00:27,  2.55it/s] 85%|████████▌ | 401/471 [02:28<00:27,  2.54it/s] 85%|████████▌ | 402/471 [02:28<00:27,  2.54it/s] 86%|████████▌ | 403/471 [02:28<00:26,  2.55it/s] 86%|████████▌ | 404/471 [02:29<00:26,  2.56it/s] 86%|████████▌ | 405/471 [02:29<00:26,  2.53it/s] 86%|████████▌ | 406/471 [02:30<00:25,  2.55it/s] 86%|████████▋ | 407/471 [02:30<00:25,  2.56it/s] 87%|████████▋ | 408/471 [02:30<00:24,  2.54it/s] 87%|████████▋ | 409/471 [02:31<00:24,  2.55it/s] 87%|████████▋ | 410/471 [02:31<00:23,  2.56it/s] 87%|████████▋ | 411/471 [02:32<00:23,  2.56it/s] 87%|████████▋ | 412/471 [02:32<00:23,  2.54it/s] 88%|████████▊ | 413/471 [02:32<00:22,  2.56it/s] 88%|████████▊ | 414/471 [02:33<00:22,  2.56it/s] 88%|████████▊ | 415/471 [02:33<00:22,  2.55it/s] 88%|████████▊ | 416/471 [02:34<00:21,  2.55it/s] 89%|████████▊ | 417/471 [02:34<00:21,  2.56it/s] 89%|████████▊ | 418/471 [02:34<00:20,  2.56it/s] 89%|████████▉ | 419/471 [02:35<00:20,  2.54it/s] 89%|████████▉ | 420/471 [02:35<00:19,  2.56it/s] 89%|████████▉ | 421/471 [02:36<00:19,  2.56it/s] 90%|████████▉ | 422/471 [02:36<00:19,  2.54it/s] 90%|████████▉ | 423/471 [02:36<00:18,  2.56it/s] 90%|█████████ | 424/471 [02:37<00:18,  2.56it/s] 90%|█████████ | 425/471 [02:37<00:17,  2.57it/s] 90%|█████████ | 426/471 [02:37<00:17,  2.57it/s] 91%|█████████ | 427/471 [02:38<00:17,  2.57it/s] 91%|█████████ | 428/471 [02:38<00:16,  2.57it/s] 91%|█████████ | 429/471 [02:39<00:16,  2.55it/s] 91%|█████████▏| 430/471 [02:39<00:15,  2.57it/s] 92%|█████████▏| 431/471 [02:39<00:15,  2.57it/s] 92%|█████████▏| 432/471 [02:40<00:15,  2.55it/s] 92%|█████████▏| 433/471 [02:40<00:14,  2.55it/s] 92%|█████████▏| 434/471 [02:41<00:14,  2.56it/s] 92%|█████████▏| 435/471 [02:41<00:14,  2.56it/s] 93%|█████████▎| 436/471 [02:41<00:13,  2.54it/s] 93%|█████████▎| 437/471 [02:42<00:13,  2.54it/s] 93%|█████████▎| 438/471 [02:42<00:12,  2.55it/s] 93%|█████████▎| 439/471 [02:43<00:12,  2.53it/s] 93%|█████████▎| 440/471 [02:43<00:12,  2.54it/s] 94%|█████████▎| 441/471 [02:43<00:11,  2.55it/s] 94%|█████████▍| 442/471 [02:44<00:11,  2.55it/s] 94%|█████████▍| 443/471 [02:44<00:11,  2.53it/s] 94%|█████████▍| 444/471 [02:45<00:10,  2.55it/s] 94%|█████████▍| 445/471 [02:45<00:10,  2.55it/s] 95%|█████████▍| 446/471 [02:45<00:09,  2.54it/s] 95%|█████████▍| 447/471 [02:46<00:09,  2.55it/s] 95%|█████████▌| 448/471 [02:46<00:09,  2.55it/s] 95%|█████████▌| 449/471 [02:47<00:08,  2.54it/s] 96%|█████████▌| 450/471 [02:47<00:08,  2.54it/s] 96%|█████████▌| 451/471 [02:47<00:07,  2.55it/s] 96%|█████████▌| 452/471 [02:48<00:07,  2.55it/s] 96%|█████████▌| 453/471 [02:48<00:07,  2.52it/s] 96%|█████████▋| 454/471 [02:49<00:06,  2.52it/s] 97%|█████████▋| 455/471 [02:49<00:06,  2.53it/s] 97%|█████████▋| 456/471 [02:49<00:05,  2.52it/s] 97%|█████████▋| 457/471 [02:50<00:05,  2.54it/s] 97%|█████████▋| 458/471 [02:50<00:05,  2.55it/s] 97%|█████████▋| 459/471 [02:50<00:04,  2.56it/s] 98%|█████████▊| 460/471 [02:51<00:04,  2.55it/s] 98%|█████████▊| 461/471 [02:51<00:03,  2.55it/s] 98%|█████████▊| 462/471 [02:52<00:03,  2.55it/s] 98%|█████████▊| 463/471 [02:52<00:03,  2.53it/s] 99%|█████████▊| 464/471 [02:52<00:02,  2.54it/s] 99%|█████████▊| 465/471 [02:53<00:02,  2.55it/s] 99%|█████████▉| 466/471 [02:53<00:01,  2.54it/s] 99%|█████████▉| 467/471 [02:54<00:01,  2.54it/s] 99%|█████████▉| 468/471 [02:54<00:01,  2.54it/s]100%|█████████▉| 469/471 [02:54<00:00,  2.55it/s]100%|█████████▉| 470/471 [02:55<00:00,  2.54it/s]100%|██████████| 471/471 [02:55<00:00,  2.71it/s]100%|██████████| 471/471 [02:55<00:00,  2.68it/s]
{'eval_loss': 2.4171206951141357, 'eval_model_preparation_time': 0.0056, 'eval_acc': 0.3990971853425385, 'eval_runtime': 175.7808, 'eval_samples_per_second': 42.849, 'eval_steps_per_second': 2.679}
ROUND:16
CLIENT:7
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]                                              {'loss': 2.045, 'grad_norm': 12.79330062866211, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 1.8807, 'grad_norm': 11.000003814697266, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:02<00:27,  1.33it/s]                                              {'loss': 2.7184, 'grad_norm': 12.63397216796875, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.33it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 1.8578, 'grad_norm': 13.133122444152832, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s]                                              {'loss': 1.3643, 'grad_norm': 13.92390251159668, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s]                                              {'loss': 2.1925, 'grad_norm': 17.37381935119629, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 1.2037, 'grad_norm': 11.81981372833252, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s] 20%|██        | 8/40 [00:06<00:24,  1.31it/s]                                              {'loss': 1.2953, 'grad_norm': 50.43528366088867, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:24,  1.31it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s]                                              {'loss': 0.5832, 'grad_norm': 6.869766712188721, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.32it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s]                                               {'loss': 0.4648, 'grad_norm': 5.242559909820557, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s] 28%|██▊       | 11/40 [00:08<00:21,  1.32it/s]                                               {'loss': 1.0209, 'grad_norm': 5.348311424255371, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:21,  1.32it/s] 30%|███       | 12/40 [00:09<00:21,  1.32it/s]                                               {'loss': 0.6364, 'grad_norm': 5.590009689331055, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.32it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s]                                               {'loss': 0.6416, 'grad_norm': 6.597751140594482, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s]                                               {'loss': 0.6752, 'grad_norm': 3.893110752105713, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.7419, 'grad_norm': 8.100354194641113, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s] 40%|████      | 16/40 [00:11<00:13,  1.79it/s]                                               {'loss': 0.2541, 'grad_norm': 18.284711837768555, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:13,  1.79it/s] 42%|████▎     | 17/40 [00:12<00:14,  1.61it/s]                                               {'loss': 0.5551, 'grad_norm': 5.722463130950928, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:14,  1.61it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.52it/s]                                               {'loss': 0.0881, 'grad_norm': 1.9167402982711792, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.52it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s]                                               {'loss': 0.6166, 'grad_norm': 6.842788219451904, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.45it/s] 50%|█████     | 20/40 [00:14<00:14,  1.42it/s]                                               {'loss': 0.278, 'grad_norm': 5.871426105499268, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:14,  1.42it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.39it/s]                                               {'loss': 0.7309, 'grad_norm': 6.11915397644043, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.39it/s] 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s]                                               {'loss': 0.402, 'grad_norm': 7.003581523895264, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.173, 'grad_norm': 3.7674036026000977, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s] 60%|██████    | 24/40 [00:16<00:08,  1.83it/s]                                               {'loss': 0.4255, 'grad_norm': 18.587383270263672, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:08,  1.83it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.65it/s]                                               {'loss': 0.5278, 'grad_norm': 7.5960373878479, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.65it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.53it/s]                                               {'loss': 0.5615, 'grad_norm': 3.2246057987213135, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:09,  1.53it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.2643, 'grad_norm': 3.5262553691864014, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.42it/s]                                               {'loss': 0.1842, 'grad_norm': 6.023532867431641, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.42it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.40it/s]                                               {'loss': 0.3757, 'grad_norm': 3.66267728805542, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.40it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.37it/s]                                               {'loss': 0.3038, 'grad_norm': 6.501691818237305, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.37it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.1092, 'grad_norm': 2.092074394226074, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.0144, 'grad_norm': 0.7326743006706238, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.36it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.69it/s]                                               {'loss': 0.1469, 'grad_norm': 3.044010877609253, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.69it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s]                                               {'loss': 0.6879, 'grad_norm': 13.969319343566895, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s]                                               {'loss': 0.3552, 'grad_norm': 3.1305575370788574, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.51it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s]                                               {'loss': 0.5611, 'grad_norm': 4.41880464553833, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s]                                               {'loss': 0.1541, 'grad_norm': 5.3471221923828125, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s]                                               {'loss': 0.1528, 'grad_norm': 2.682243585586548, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.1647, 'grad_norm': 2.57881498336792, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0229, 'grad_norm': 0.8252095580101013, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]                                               {'train_runtime': 27.7513, 'train_samples_per_second': 20.359, 'train_steps_per_second': 1.441, 'train_loss': 0.685780247184448, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]100%|██████████| 40/40 [00:27<00:00,  1.44it/s]
CLIENT:25
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:53,  1.36s/it]                                              {'loss': 1.7065, 'grad_norm': 9.672673225402832, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:53,  1.36s/it]  5%|▌         | 2/40 [00:02<00:37,  1.00it/s]                                              {'loss': 1.1903, 'grad_norm': 11.949743270874023, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.00it/s]  8%|▊         | 3/40 [00:02<00:32,  1.13it/s]                                              {'loss': 1.5585, 'grad_norm': 13.147100448608398, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.13it/s] 10%|█         | 4/40 [00:03<00:30,  1.20it/s]                                              {'loss': 1.8427, 'grad_norm': 20.3729305267334, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:30,  1.20it/s] 12%|█▎        | 5/40 [00:04<00:27,  1.25it/s]                                              {'loss': 4.5774, 'grad_norm': 44.55379104614258, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:27,  1.25it/s] 15%|█▌        | 6/40 [00:05<00:26,  1.27it/s]                                              {'loss': 1.0447, 'grad_norm': 15.255853652954102, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:26,  1.27it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 2.0429, 'grad_norm': 19.45209503173828, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 0.1477, 'grad_norm': 11.858171463012695, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:24,  1.30it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.66it/s]                                              {'loss': 0.9925, 'grad_norm': 10.106963157653809, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.66it/s] 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s]                                               {'loss': 0.3691, 'grad_norm': 6.203892230987549, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.48it/s]                                               {'loss': 0.9419, 'grad_norm': 6.978428363800049, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.48it/s] 30%|███       | 12/40 [00:08<00:19,  1.44it/s]                                               {'loss': 1.108, 'grad_norm': 8.040266990661621, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s]                                               {'loss': 0.5038, 'grad_norm': 6.897738456726074, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.9542, 'grad_norm': 8.125787734985352, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:18,  1.38it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.37it/s]                                               {'loss': 1.7713, 'grad_norm': 10.286392211914062, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.37it/s]                                               {'loss': 0.6068, 'grad_norm': 10.603925704956055, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.37it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.70it/s]                                               {'loss': 0.4385, 'grad_norm': 8.621485710144043, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.70it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s]                                               {'loss': 0.2841, 'grad_norm': 3.91518235206604, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.59it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.52it/s]                                               {'loss': 0.4958, 'grad_norm': 4.602001190185547, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.52it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.4321, 'grad_norm': 4.327846527099609, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s]                                               {'loss': 0.7299, 'grad_norm': 6.705015659332275, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.2333, 'grad_norm': 4.5530219078063965, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.39it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 0.6443, 'grad_norm': 7.161798000335693, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 0.0591, 'grad_norm': 2.9824600219726562, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s]                                               {'loss': 0.229, 'grad_norm': 5.751966953277588, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.59it/s]                                               {'loss': 0.1062, 'grad_norm': 2.8997414112091064, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.59it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.51it/s]                                               {'loss': 0.3273, 'grad_norm': 4.254286289215088, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.51it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s]                                               {'loss': 0.2832, 'grad_norm': 6.9131059646606445, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.1567, 'grad_norm': 3.4146132469177246, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s]                                               {'loss': 0.2372, 'grad_norm': 4.276717662811279, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.37it/s]                                               {'loss': 0.2207, 'grad_norm': 4.469377517700195, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.37it/s]                                               {'loss': 0.0158, 'grad_norm': 1.2054452896118164, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.37it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s]                                               {'loss': 0.0934, 'grad_norm': 1.7527344226837158, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s]                                               {'loss': 0.0901, 'grad_norm': 1.6501786708831787, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.59it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.52it/s]                                               {'loss': 0.0976, 'grad_norm': 1.7860952615737915, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.52it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.47it/s]                                               {'loss': 0.1439, 'grad_norm': 2.7989864349365234, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s]                                               {'loss': 0.0356, 'grad_norm': 1.1996572017669678, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s]                                               {'loss': 0.1387, 'grad_norm': 4.647499084472656, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.40it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.38it/s]                                               {'loss': 0.2119, 'grad_norm': 7.216311931610107, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.38it/s]                                               {'loss': 0.3956, 'grad_norm': 17.527549743652344, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.38it/s]                                               {'train_runtime': 27.5833, 'train_samples_per_second': 20.483, 'train_steps_per_second': 1.45, 'train_loss': 0.6864521043840796, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.38it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.35it/s]                                              {'loss': 2.2132, 'grad_norm': 11.544843673706055, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.35it/s]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 1.3448, 'grad_norm': 8.47739315032959, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:02<00:27,  1.35it/s]                                              {'loss': 1.0377, 'grad_norm': 13.685120582580566, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.35it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 2.6887, 'grad_norm': 22.49976921081543, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 1.4812, 'grad_norm': 15.932294845581055, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.35it/s]                                              {'loss': 2.6911, 'grad_norm': 20.51810073852539, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.35it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 0.7743, 'grad_norm': 13.40832805633545, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s] 20%|██        | 8/40 [00:06<00:24,  1.28it/s]                                              {'loss': 0.2446, 'grad_norm': 18.206159591674805, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:24,  1.28it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.30it/s]                                              {'loss': 0.9812, 'grad_norm': 9.913723945617676, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.30it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s]                                               {'loss': 0.4115, 'grad_norm': 6.894053936004639, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.32it/s] 28%|██▊       | 11/40 [00:08<00:21,  1.33it/s]                                               {'loss': 0.5118, 'grad_norm': 7.513854026794434, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:21,  1.33it/s] 30%|███       | 12/40 [00:09<00:21,  1.33it/s]                                               {'loss': 0.7509, 'grad_norm': 7.5420050621032715, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.33it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s]                                               {'loss': 0.5001, 'grad_norm': 5.9746880531311035, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.33it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s]                                               {'loss': 0.9251, 'grad_norm': 9.095885276794434, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.34it/s]                                               {'loss': 0.9265, 'grad_norm': 9.536632537841797, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.34it/s]                                               {'loss': 0.0207, 'grad_norm': 1.2071274518966675, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.34it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.68it/s]                                               {'loss': 0.2852, 'grad_norm': 4.5833587646484375, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.68it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s]                                               {'loss': 0.1725, 'grad_norm': 4.1861252784729, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s]                                               {'loss': 0.3819, 'grad_norm': 5.468482971191406, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.5376, 'grad_norm': 8.547104835510254, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.43it/s]                                               {'loss': 0.2167, 'grad_norm': 4.490592002868652, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.141, 'grad_norm': 3.263977289199829, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 0.3359, 'grad_norm': 2.3932740688323975, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 0.0043, 'grad_norm': 0.32333841919898987, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.71it/s]                                               {'loss': 0.1937, 'grad_norm': 3.8938698768615723, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.71it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s]                                               {'loss': 0.1069, 'grad_norm': 2.3835654258728027, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s]                                               {'loss': 0.0519, 'grad_norm': 1.489210605621338, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.53it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.1854, 'grad_norm': 4.0666422843933105, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.44it/s]                                               {'loss': 0.3539, 'grad_norm': 4.620360851287842, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.44it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s]                                               {'loss': 0.1107, 'grad_norm': 2.4171175956726074, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.2166, 'grad_norm': 5.125150203704834, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.39it/s]                                               {'loss': 0.241, 'grad_norm': 7.788869857788086, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.72it/s]                                               {'loss': 0.0466, 'grad_norm': 1.2534844875335693, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.72it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.62it/s]                                               {'loss': 0.0434, 'grad_norm': 1.145503282546997, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.62it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.53it/s]                                               {'loss': 0.0365, 'grad_norm': 0.9858095049858093, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s]                                               {'loss': 0.0355, 'grad_norm': 0.7080082893371582, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s]                                               {'loss': 0.1319, 'grad_norm': 1.9753634929656982, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.42it/s]                                               {'loss': 0.2007, 'grad_norm': 5.63096284866333, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.42it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.39it/s]                                               {'loss': 0.1244, 'grad_norm': 1.5826301574707031, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.39it/s]                                               {'loss': 0.0235, 'grad_norm': 1.5866914987564087, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.39it/s]                                               {'train_runtime': 27.475, 'train_samples_per_second': 20.564, 'train_steps_per_second': 1.456, 'train_loss': 0.542024742194917, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.39it/s]100%|██████████| 40/40 [00:27<00:00,  1.46it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:25,  1.53it/s]                                              {'loss': 1.9508, 'grad_norm': 7.910899639129639, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:25,  1.53it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]                                              {'loss': 1.7045, 'grad_norm': 13.396818161010742, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:01<00:24,  1.52it/s]                                              {'loss': 1.0887, 'grad_norm': 12.581467628479004, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.52it/s] 10%|█         | 4/40 [00:02<00:24,  1.50it/s]                                              {'loss': 0.9862, 'grad_norm': 10.528681755065918, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.50it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s]                                              {'loss': 0.6745, 'grad_norm': 9.722872734069824, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.47it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s]                                              {'loss': 0.9596, 'grad_norm': 12.596819877624512, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.52it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 0.7731, 'grad_norm': 13.701814651489258, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 2.1017, 'grad_norm': 93.1178970336914, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.89it/s]                                              {'loss': 0.2941, 'grad_norm': 5.360929489135742, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.89it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.79it/s]                                               {'loss': 0.7532, 'grad_norm': 9.335336685180664, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.79it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s]                                               {'loss': 0.1018, 'grad_norm': 4.111955165863037, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s] 30%|███       | 12/40 [00:07<00:16,  1.65it/s]                                               {'loss': 0.4453, 'grad_norm': 6.1470184326171875, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.65it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s]                                               {'loss': 0.3722, 'grad_norm': 11.53939437866211, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.54it/s]                                               {'loss': 0.4871, 'grad_norm': 3.1542954444885254, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.54it/s] 38%|███▊      | 15/40 [00:09<00:15,  1.57it/s]                                               {'loss': 0.2948, 'grad_norm': 6.19221830368042, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:15,  1.57it/s]                                               {'loss': 0.2275, 'grad_norm': 13.197542190551758, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.57it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s]                                               {'loss': 0.2342, 'grad_norm': 2.7329039573669434, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.75it/s]                                               {'loss': 0.0778, 'grad_norm': 1.4636056423187256, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.75it/s] 48%|████▊     | 19/40 [00:11<00:11,  1.75it/s]                                               {'loss': 0.3659, 'grad_norm': 16.201786041259766, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:11,  1.75it/s] 50%|█████     | 20/40 [00:12<00:12,  1.62it/s]                                               {'loss': 0.1355, 'grad_norm': 3.4900808334350586, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.62it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.63it/s]                                               {'loss': 0.089, 'grad_norm': 1.9019111394882202, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.63it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s]                                               {'loss': 0.31, 'grad_norm': 1.1942086219787598, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.2035, 'grad_norm': 4.575268268585205, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 1.675, 'grad_norm': 23.83928871154785, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.93it/s]                                               {'loss': 0.0463, 'grad_norm': 0.9642552733421326, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  1.93it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.77it/s]                                               {'loss': 0.2098, 'grad_norm': 5.739741325378418, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.77it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.67it/s]                                               {'loss': 0.0259, 'grad_norm': 0.5432161092758179, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.67it/s] 70%|███████   | 28/40 [00:16<00:07,  1.68it/s]                                               {'loss': 0.2905, 'grad_norm': 2.6068079471588135, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.68it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.58it/s]                                               {'loss': 0.1069, 'grad_norm': 3.222024917602539, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.58it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s]                                               {'loss': 0.1194, 'grad_norm': 3.723820209503174, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.56it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.55it/s]                                               {'loss': 0.0371, 'grad_norm': 1.9830459356307983, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.55it/s]                                               {'loss': 0.0664, 'grad_norm': 2.780275583267212, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.55it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.87it/s]                                               {'loss': 0.0947, 'grad_norm': 2.5939440727233887, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.87it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.81it/s]                                               {'loss': 0.0095, 'grad_norm': 0.3155128061771393, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.81it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s]                                               {'loss': 0.0121, 'grad_norm': 0.4900544285774231, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s]                                               {'loss': 0.0349, 'grad_norm': 0.5401535630226135, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.63it/s]                                               {'loss': 0.2796, 'grad_norm': 1.8314144611358643, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.63it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s]                                               {'loss': 0.0113, 'grad_norm': 0.48338964581489563, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]                                               {'loss': 0.1114, 'grad_norm': 1.6469550132751465, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.54it/s]100%|██████████| 40/40 [00:23<00:00,  2.04it/s]                                               {'loss': 0.0152, 'grad_norm': 1.0903102159500122, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.04it/s]                                               {'train_runtime': 24.0972, 'train_samples_per_second': 23.447, 'train_steps_per_second': 1.66, 'train_loss': 0.4444169524591416, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.04it/s]100%|██████████| 40/40 [00:24<00:00,  1.66it/s]
CLIENT:47
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:21,  1.81it/s]                                              {'loss': 3.0847, 'grad_norm': 14.186544418334961, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:21,  1.81it/s]  5%|▌         | 2/40 [00:00<00:16,  2.34it/s]                                              {'loss': 1.5981, 'grad_norm': 14.312515258789062, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.34it/s]  8%|▊         | 3/40 [00:01<00:14,  2.58it/s]                                              {'loss': 2.3331, 'grad_norm': 16.318817138671875, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:14,  2.58it/s] 10%|█         | 4/40 [00:01<00:13,  2.72it/s]                                              {'loss': 1.7936, 'grad_norm': 13.339483261108398, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.72it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.80it/s]                                              {'loss': 2.1918, 'grad_norm': 13.701163291931152, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.80it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.81it/s]                                              {'loss': 2.9617, 'grad_norm': 26.199949264526367, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.81it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.85it/s]                                              {'loss': 1.7968, 'grad_norm': 19.45964813232422, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.85it/s] 20%|██        | 8/40 [00:02<00:11,  2.83it/s]                                              {'loss': 0.1273, 'grad_norm': 8.932618141174316, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:13,  2.38it/s]                                              {'loss': 0.8334, 'grad_norm': 7.495471000671387, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:13,  2.38it/s] 25%|██▌       | 10/40 [00:04<00:14,  2.07it/s]                                               {'loss': 0.7422, 'grad_norm': 11.074108123779297, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:14,  2.07it/s] 28%|██▊       | 11/40 [00:04<00:16,  1.81it/s]                                               {'loss': 0.7883, 'grad_norm': 11.789011001586914, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:16,  1.81it/s] 30%|███       | 12/40 [00:05<00:16,  1.75it/s]                                               {'loss': 0.8593, 'grad_norm': 7.272716522216797, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:16,  1.75it/s] 32%|███▎      | 13/40 [00:06<00:16,  1.65it/s]                                               {'loss': 0.7377, 'grad_norm': 7.170654296875, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.65it/s] 35%|███▌      | 14/40 [00:06<00:16,  1.58it/s]                                               {'loss': 1.09, 'grad_norm': 8.29280948638916, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:16,  1.58it/s] 38%|███▊      | 15/40 [00:07<00:15,  1.61it/s]                                               {'loss': 0.5979, 'grad_norm': 6.669234752655029, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:15,  1.61it/s]                                               {'loss': 0.0598, 'grad_norm': 3.885791778564453, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:14,  1.61it/s] 42%|████▎     | 17/40 [00:08<00:11,  1.95it/s]                                               {'loss': 0.5327, 'grad_norm': 7.036512851715088, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:11,  1.95it/s] 45%|████▌     | 18/40 [00:08<00:12,  1.79it/s]                                               {'loss': 0.3903, 'grad_norm': 4.2941789627075195, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:12,  1.79it/s] 48%|████▊     | 19/40 [00:09<00:11,  1.76it/s]                                               {'loss': 0.2321, 'grad_norm': 3.1683967113494873, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:11,  1.76it/s] 50%|█████     | 20/40 [00:10<00:12,  1.64it/s]                                               {'loss': 0.4697, 'grad_norm': 7.790703296661377, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:12,  1.64it/s] 52%|█████▎    | 21/40 [00:10<00:11,  1.64it/s]                                               {'loss': 0.6315, 'grad_norm': 8.4999418258667, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:11,  1.64it/s] 55%|█████▌    | 22/40 [00:11<00:11,  1.57it/s]                                               {'loss': 0.3775, 'grad_norm': 5.906962871551514, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:12<00:11,  1.53it/s]                                               {'loss': 0.3605, 'grad_norm': 6.250077247619629, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:11,  1.53it/s]                                               {'loss': 0.0131, 'grad_norm': 0.83976811170578, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.94it/s]                                               {'loss': 0.1298, 'grad_norm': 1.9531896114349365, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.94it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.80it/s]                                               {'loss': 0.1989, 'grad_norm': 2.7345402240753174, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.68it/s]                                               {'loss': 0.3256, 'grad_norm': 2.2909982204437256, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.68it/s] 70%|███████   | 28/40 [00:14<00:07,  1.68it/s]                                               {'loss': 0.1486, 'grad_norm': 3.107208013534546, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.68it/s] 72%|███████▎  | 29/40 [00:15<00:06,  1.58it/s]                                               {'loss': 0.1912, 'grad_norm': 4.080082893371582, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:06,  1.58it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.55it/s]                                               {'loss': 0.1873, 'grad_norm': 4.461239337921143, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.55it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.57it/s]                                               {'loss': 0.0949, 'grad_norm': 1.6897958517074585, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.57it/s]                                               {'loss': 0.0761, 'grad_norm': 1.9641656875610352, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.57it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.90it/s]                                               {'loss': 0.0469, 'grad_norm': 1.0109533071517944, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.90it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.84it/s]                                               {'loss': 0.2535, 'grad_norm': 3.661109209060669, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.84it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.72it/s]                                               {'loss': 0.1143, 'grad_norm': 3.1451616287231445, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.72it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.63it/s]                                               {'loss': 0.1648, 'grad_norm': 4.3222575187683105, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.63it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.65it/s]                                               {'loss': 0.236, 'grad_norm': 1.2897778749465942, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.65it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.56it/s]                                               {'loss': 0.0275, 'grad_norm': 0.5689333081245422, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.54it/s]                                               {'loss': 0.049, 'grad_norm': 1.1989963054656982, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.54it/s]100%|██████████| 40/40 [00:21<00:00,  2.04it/s]                                               {'loss': 0.1791, 'grad_norm': 9.910553932189941, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.04it/s]                                               {'train_runtime': 22.0195, 'train_samples_per_second': 25.659, 'train_steps_per_second': 1.817, 'train_loss': 0.6756587185896933, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.04it/s]100%|██████████| 40/40 [00:22<00:00,  1.82it/s]
CLIENT:29
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.57it/s]                                              {'loss': 2.7402, 'grad_norm': 11.300891876220703, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.57it/s]  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]                                              {'loss': 2.1286, 'grad_norm': 10.856833457946777, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]  8%|▊         | 3/40 [00:02<00:25,  1.48it/s]                                              {'loss': 1.9044, 'grad_norm': 12.728711128234863, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.48it/s] 10%|█         | 4/40 [00:02<00:23,  1.54it/s]                                              {'loss': 1.7652, 'grad_norm': 15.750016212463379, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.54it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s]                                              {'loss': 1.7973, 'grad_norm': 15.867778778076172, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.50it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.48it/s]                                              {'loss': 1.0408, 'grad_norm': 11.89254093170166, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.48it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.54it/s]                                              {'loss': 0.8674, 'grad_norm': 9.625675201416016, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.54it/s]                                              {'loss': 3.5007, 'grad_norm': 126.06832122802734, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:20,  1.54it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.89it/s]                                              {'loss': 0.9739, 'grad_norm': 11.332496643066406, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.89it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s]                                               {'loss': 0.4521, 'grad_norm': 6.626880168914795, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s] 28%|██▊       | 11/40 [00:06<00:16,  1.74it/s]                                               {'loss': 1.265, 'grad_norm': 6.594480991363525, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:16,  1.74it/s] 30%|███       | 12/40 [00:07<00:14,  1.93it/s]                                               {'loss': 0.3561, 'grad_norm': 4.957860946655273, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:14,  1.93it/s] 32%|███▎      | 13/40 [00:07<00:12,  2.14it/s]                                               {'loss': 0.2425, 'grad_norm': 6.753948211669922, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:12,  2.14it/s] 35%|███▌      | 14/40 [00:07<00:11,  2.34it/s]                                               {'loss': 0.549, 'grad_norm': 3.7213616371154785, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:11,  2.34it/s] 38%|███▊      | 15/40 [00:08<00:10,  2.49it/s]                                               {'loss': 0.8428, 'grad_norm': 5.875785827636719, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:10,  2.49it/s]                                               {'loss': 0.0026, 'grad_norm': 0.18182869255542755, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:09,  2.49it/s] 42%|████▎     | 17/40 [00:08<00:07,  3.22it/s]                                               {'loss': 0.6624, 'grad_norm': 4.494503021240234, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:07,  3.22it/s] 45%|████▌     | 18/40 [00:08<00:07,  3.14it/s]                                               {'loss': 0.9057, 'grad_norm': 8.693638801574707, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:07,  3.14it/s] 48%|████▊     | 19/40 [00:09<00:06,  3.11it/s]                                               {'loss': 0.4121, 'grad_norm': 0.7957906126976013, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:06,  3.11it/s] 50%|█████     | 20/40 [00:09<00:07,  2.71it/s]                                               {'loss': 0.4523, 'grad_norm': 9.195441246032715, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:07,  2.71it/s] 52%|█████▎    | 21/40 [00:10<00:08,  2.19it/s]                                               {'loss': 0.3733, 'grad_norm': 5.487646579742432, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:08,  2.19it/s] 55%|█████▌    | 22/40 [00:11<00:09,  1.87it/s]                                               {'loss': 0.2943, 'grad_norm': 1.601370930671692, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:09,  1.87it/s] 57%|█████▊    | 23/40 [00:11<00:09,  1.80it/s]                                               {'loss': 0.0375, 'grad_norm': 0.9848363995552063, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:09,  1.80it/s]                                               {'loss': 0.0044, 'grad_norm': 0.2537475526332855, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:08,  1.80it/s] 62%|██████▎   | 25/40 [00:12<00:07,  2.08it/s]                                               {'loss': 0.0635, 'grad_norm': 1.3764903545379639, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  2.08it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.85it/s]                                               {'loss': 0.2194, 'grad_norm': 1.6191370487213135, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.85it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.80it/s]                                               {'loss': 0.1717, 'grad_norm': 2.0016279220581055, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.80it/s] 70%|███████   | 28/40 [00:14<00:07,  1.65it/s]                                               {'loss': 0.2716, 'grad_norm': 3.836264133453369, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.65it/s] 72%|███████▎  | 29/40 [00:15<00:06,  1.57it/s]                                               {'loss': 0.119, 'grad_norm': 1.5483053922653198, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:06,  1.57it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.59it/s]                                               {'loss': 0.0305, 'grad_norm': 1.1133426427841187, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.59it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.52it/s]                                               {'loss': 1.0185, 'grad_norm': 1.7130964994430542, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.52it/s]                                               {'loss': 0.3958, 'grad_norm': 19.37793731689453, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.52it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.91it/s]                                               {'loss': 1.1369, 'grad_norm': 0.5865930914878845, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.79it/s]                                               {'loss': 0.1081, 'grad_norm': 10.196822166442871, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.79it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.68it/s]                                               {'loss': 0.0498, 'grad_norm': 1.6119407415390015, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.68it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.65it/s]                                               {'loss': 0.028, 'grad_norm': 1.5534347295761108, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.65it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s]                                               {'loss': 0.0228, 'grad_norm': 0.9345517754554749, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.52it/s]                                               {'loss': 0.0123, 'grad_norm': 0.2876308560371399, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.52it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.56it/s]                                               {'loss': 0.2368, 'grad_norm': 0.8474881649017334, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.56it/s]                                               {'loss': 0.4593, 'grad_norm': 89.74722290039062, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.56it/s]                                               {'train_runtime': 21.6461, 'train_samples_per_second': 26.102, 'train_steps_per_second': 1.848, 'train_loss': 0.6978696219157428, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.56it/s]100%|██████████| 40/40 [00:21<00:00,  1.85it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:47,  1.21s/it]                                              {'loss': 1.8332, 'grad_norm': 8.65283203125, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:47,  1.21s/it]  5%|▌         | 2/40 [00:01<00:35,  1.07it/s]                                              {'loss': 1.6757, 'grad_norm': 10.675527572631836, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:35,  1.07it/s]  8%|▊         | 3/40 [00:02<00:29,  1.24it/s]                                              {'loss': 1.5971, 'grad_norm': 10.261225700378418, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:29,  1.24it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 1.3526, 'grad_norm': 14.633316993713379, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 0.7496, 'grad_norm': 13.514263153076172, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s]                                              {'loss': 2.4291, 'grad_norm': 15.55759334564209, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 1.6861, 'grad_norm': 16.577167510986328, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 4.1616, 'grad_norm': 93.4098892211914, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.42it/s] 22%|██▎       | 9/40 [00:06<00:17,  1.80it/s]                                              {'loss': 0.3538, 'grad_norm': 5.822483062744141, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:17,  1.80it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s]                                               {'loss': 0.5326, 'grad_norm': 5.80175256729126, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.65it/s]                                               {'loss': 1.7942, 'grad_norm': 8.104391098022461, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.65it/s] 30%|███       | 12/40 [00:08<00:17,  1.62it/s]                                               {'loss': 0.2297, 'grad_norm': 3.2021360397338867, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.62it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s]                                               {'loss': 1.0965, 'grad_norm': 7.510616302490234, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.57it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.52it/s]                                               {'loss': 0.2049, 'grad_norm': 5.154571056365967, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.56it/s]                                               {'loss': 0.6377, 'grad_norm': 9.13408088684082, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.56it/s] 40%|████      | 16/40 [00:10<00:11,  2.07it/s]                                               {'loss': 1.1133, 'grad_norm': 44.392860412597656, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:11,  2.07it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.84it/s]                                               {'loss': 0.5183, 'grad_norm': 13.013002395629883, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.84it/s] 45%|████▌     | 18/40 [00:11<00:13,  1.67it/s]                                               {'loss': 0.47, 'grad_norm': 5.304327964782715, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:13,  1.67it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.67it/s]                                               {'loss': 0.5762, 'grad_norm': 9.083401679992676, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.67it/s] 50%|█████     | 20/40 [00:12<00:12,  1.58it/s]                                               {'loss': 0.6405, 'grad_norm': 5.305168151855469, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.58it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.52it/s]                                               {'loss': 0.6857, 'grad_norm': 3.5372347831726074, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.52it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.55it/s]                                               {'loss': 0.1218, 'grad_norm': 3.2923200130462646, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.55it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.48it/s]                                               {'loss': 0.3647, 'grad_norm': 5.588176250457764, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.48it/s]                                               {'loss': 0.0281, 'grad_norm': 1.4675183296203613, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.48it/s] 62%|██████▎   | 25/40 [00:15<00:07,  2.06it/s]                                               {'loss': 0.5421, 'grad_norm': 3.200291633605957, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  2.06it/s] 65%|██████▌   | 26/40 [00:15<00:06,  2.22it/s]                                               {'loss': 0.5788, 'grad_norm': 2.346113681793213, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:06,  2.22it/s] 68%|██████▊   | 27/40 [00:16<00:05,  2.38it/s]                                               {'loss': 0.4023, 'grad_norm': 3.0157558917999268, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:05,  2.38it/s] 70%|███████   | 28/40 [00:16<00:04,  2.48it/s]                                               {'loss': 0.1183, 'grad_norm': 5.181999683380127, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:04,  2.48it/s] 72%|███████▎  | 29/40 [00:16<00:04,  2.59it/s]                                               {'loss': 0.1298, 'grad_norm': 2.3488786220550537, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:04,  2.59it/s] 75%|███████▌  | 30/40 [00:17<00:03,  2.69it/s]                                               {'loss': 0.1793, 'grad_norm': 1.3538389205932617, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:03,  2.69it/s] 78%|███████▊  | 31/40 [00:17<00:03,  2.75it/s]                                               {'loss': 0.2486, 'grad_norm': 2.6797726154327393, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:03,  2.75it/s]                                               {'loss': 0.0024, 'grad_norm': 0.14445102214813232, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:02,  2.75it/s] 82%|████████▎ | 33/40 [00:17<00:02,  3.41it/s]                                               {'loss': 0.2124, 'grad_norm': 2.537736415863037, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:02,  3.41it/s] 85%|████████▌ | 34/40 [00:18<00:01,  3.28it/s]                                               {'loss': 0.1045, 'grad_norm': 1.2290641069412231, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:01,  3.28it/s] 88%|████████▊ | 35/40 [00:18<00:01,  3.18it/s]                                               {'loss': 0.0287, 'grad_norm': 0.5554981231689453, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:01,  3.18it/s] 90%|█████████ | 36/40 [00:19<00:01,  3.13it/s]                                               {'loss': 0.5526, 'grad_norm': 1.0498206615447998, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:01,  3.13it/s] 92%|█████████▎| 37/40 [00:19<00:00,  3.07it/s]                                               {'loss': 0.1333, 'grad_norm': 0.47732841968536377, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:00,  3.07it/s] 95%|█████████▌| 38/40 [00:19<00:00,  3.00it/s]                                               {'loss': 0.4418, 'grad_norm': 0.714512288570404, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:19<00:00,  3.00it/s] 98%|█████████▊| 39/40 [00:20<00:00,  2.95it/s]                                               {'loss': 0.2624, 'grad_norm': 2.2332913875579834, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  2.95it/s]                                               {'loss': 0.0012, 'grad_norm': 0.06681114435195923, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  2.95it/s]                                               {'train_runtime': 20.3305, 'train_samples_per_second': 27.791, 'train_steps_per_second': 1.967, 'train_loss': 0.7197881263011368, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  2.95it/s]100%|██████████| 40/40 [00:20<00:00,  1.97it/s]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]                                              {'loss': 1.5662, 'grad_norm': 9.03974723815918, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:42,  1.09s/it]  5%|▌         | 2/40 [00:01<00:30,  1.26it/s]                                              {'loss': 1.7754, 'grad_norm': 11.168194770812988, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:30,  1.26it/s]  8%|▊         | 3/40 [00:02<00:28,  1.32it/s]                                              {'loss': 1.4339, 'grad_norm': 10.394367218017578, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.32it/s] 10%|█         | 4/40 [00:03<00:26,  1.38it/s]                                              {'loss': 1.5704, 'grad_norm': 13.998762130737305, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:26,  1.38it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s]                                              {'loss': 2.8135, 'grad_norm': 19.080055236816406, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.45it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s]                                              {'loss': 1.5769, 'grad_norm': 14.121410369873047, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:05<00:22,  1.47it/s]                                              {'loss': 1.3337, 'grad_norm': 10.90114974975586, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:22,  1.47it/s]                                              {'loss': 0.5069, 'grad_norm': 27.18194007873535, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 0.2475, 'grad_norm': 5.592401504516602, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s]                                               {'loss': 0.7229, 'grad_norm': 10.732198715209961, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.76it/s] 28%|██▊       | 11/40 [00:07<00:16,  1.74it/s]                                               {'loss': 0.5161, 'grad_norm': 5.870075702667236, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:16,  1.74it/s] 30%|███       | 12/40 [00:07<00:17,  1.62it/s]                                               {'loss': 0.4969, 'grad_norm': 6.990824222564697, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.62it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.59it/s]                                               {'loss': 0.6524, 'grad_norm': 6.654696941375732, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.59it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.57it/s]                                               {'loss': 1.2723, 'grad_norm': 8.28089714050293, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.57it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.51it/s]                                               {'loss': 0.4644, 'grad_norm': 3.2569234371185303, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.51it/s]                                               {'loss': 0.4251, 'grad_norm': 20.959884643554688, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.51it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s]                                               {'loss': 0.2822, 'grad_norm': 3.6366994380950928, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.79it/s]                                               {'loss': 0.2568, 'grad_norm': 3.558013677597046, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.79it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.68it/s]                                               {'loss': 0.2824, 'grad_norm': 2.6385226249694824, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.68it/s] 50%|█████     | 20/40 [00:12<00:12,  1.65it/s]                                               {'loss': 0.2541, 'grad_norm': 3.5478315353393555, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.65it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s]                                               {'loss': 0.0809, 'grad_norm': 1.8936635255813599, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s] 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s]                                               {'loss': 0.2798, 'grad_norm': 3.745811700820923, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:11,  1.57it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s]                                               {'loss': 0.2136, 'grad_norm': 5.145634651184082, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.56it/s] 60%|██████    | 24/40 [00:14<00:07,  2.06it/s]                                               {'loss': 0.0615, 'grad_norm': 5.945080280303955, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:07,  2.06it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.80it/s]                                               {'loss': 0.1973, 'grad_norm': 4.736478328704834, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.80it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.68it/s]                                               {'loss': 0.0536, 'grad_norm': 1.1525617837905884, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.68it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s]                                               {'loss': 0.2582, 'grad_norm': 3.2885119915008545, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.68it/s] 70%|███████   | 28/40 [00:17<00:07,  1.57it/s]                                               {'loss': 0.0507, 'grad_norm': 1.594079852104187, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.57it/s] 72%|███████▎  | 29/40 [00:18<00:07,  1.55it/s]                                               {'loss': 0.2231, 'grad_norm': 4.434961795806885, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:07,  1.55it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.53it/s]                                               {'loss': 0.1961, 'grad_norm': 3.1412441730499268, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.53it/s] 78%|███████▊  | 31/40 [00:19<00:06,  1.49it/s]                                               {'loss': 0.0547, 'grad_norm': 1.3951910734176636, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:06,  1.49it/s]                                               {'loss': 0.0444, 'grad_norm': 2.8175594806671143, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.49it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.86it/s]                                               {'loss': 0.0416, 'grad_norm': 1.5278913974761963, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.86it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.75it/s]                                               {'loss': 0.0284, 'grad_norm': 0.8792282342910767, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.75it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.65it/s]                                               {'loss': 0.0773, 'grad_norm': 1.7241170406341553, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.65it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.66it/s]                                               {'loss': 0.0612, 'grad_norm': 1.9163429737091064, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.66it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s]                                               {'loss': 0.1127, 'grad_norm': 3.660771369934082, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s]                                               {'loss': 0.2591, 'grad_norm': 1.739437222480774, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.54it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.55it/s]                                               {'loss': 0.186, 'grad_norm': 8.465822219848633, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.55it/s]                                               {'loss': 0.0145, 'grad_norm': 0.9977325201034546, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.55it/s]                                               {'train_runtime': 24.5391, 'train_samples_per_second': 23.024, 'train_steps_per_second': 1.63, 'train_loss': 0.5236079981084913, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.55it/s]100%|██████████| 40/40 [00:24<00:00,  1.63it/s]
CLIENT:50
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:53,  1.36s/it]                                              {'loss': 2.2512, 'grad_norm': 7.8284831047058105, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:53,  1.36s/it]  5%|▌         | 2/40 [00:02<00:35,  1.06it/s]                                              {'loss': 1.3968, 'grad_norm': 10.584985733032227, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:35,  1.06it/s]  8%|▊         | 3/40 [00:02<00:30,  1.20it/s]                                              {'loss': 1.486, 'grad_norm': 11.556838035583496, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:30,  1.20it/s] 10%|█         | 4/40 [00:03<00:26,  1.34it/s]                                              {'loss': 0.7909, 'grad_norm': 9.691548347473145, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:04<00:25,  1.38it/s]                                              {'loss': 1.1816, 'grad_norm': 10.744730949401855, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:25,  1.38it/s] 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s]                                              {'loss': 1.3789, 'grad_norm': 19.313386917114258, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:24,  1.39it/s] 18%|█▊        | 7/40 [00:05<00:22,  1.47it/s]                                              {'loss': 0.8104, 'grad_norm': 14.947432518005371, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:22,  1.47it/s]                                              {'loss': 0.5837, 'grad_norm': 42.91101837158203, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:06<00:16,  1.83it/s]                                              {'loss': 0.4932, 'grad_norm': 6.102782726287842, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:16,  1.83it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s]                                               {'loss': 0.6953, 'grad_norm': 9.559365272521973, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.73it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.66it/s]                                               {'loss': 0.5028, 'grad_norm': 5.732104301452637, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.66it/s] 30%|███       | 12/40 [00:08<00:17,  1.59it/s]                                               {'loss': 0.6732, 'grad_norm': 6.788696765899658, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.59it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.60it/s]                                               {'loss': 0.5836, 'grad_norm': 5.8260416984558105, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.60it/s] 35%|███▌      | 14/40 [00:09<00:16,  1.54it/s]                                               {'loss': 0.9577, 'grad_norm': 12.452871322631836, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:16,  1.54it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s]                                               {'loss': 0.1425, 'grad_norm': 3.347445487976074, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s]                                               {'loss': 0.0574, 'grad_norm': 1.5313111543655396, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:15,  1.50it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.90it/s]                                               {'loss': 0.1492, 'grad_norm': 3.690450668334961, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.90it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s]                                               {'loss': 0.6833, 'grad_norm': 4.249557971954346, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.65it/s]                                               {'loss': 0.1503, 'grad_norm': 3.539135456085205, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.65it/s] 50%|█████     | 20/40 [00:12<00:12,  1.66it/s]                                               {'loss': 0.3042, 'grad_norm': 4.812704563140869, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.66it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s]                                               {'loss': 0.4519, 'grad_norm': 5.154856204986572, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.58it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.59it/s]                                               {'loss': 0.3771, 'grad_norm': 5.7188873291015625, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.59it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.54it/s]                                               {'loss': 0.2687, 'grad_norm': 1.260369896888733, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.54it/s]                                               {'loss': 0.0115, 'grad_norm': 1.0609214305877686, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.54it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.87it/s]                                               {'loss': 0.4769, 'grad_norm': 5.929750919342041, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.87it/s] 65%|██████▌   | 26/40 [00:16<00:07,  1.79it/s]                                               {'loss': 0.2716, 'grad_norm': 4.425310134887695, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:07,  1.79it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.68it/s]                                               {'loss': 0.2689, 'grad_norm': 2.305968761444092, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.68it/s] 70%|███████   | 28/40 [00:17<00:07,  1.60it/s]                                               {'loss': 0.0781, 'grad_norm': 2.6050610542297363, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.60it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.62it/s]                                               {'loss': 0.0542, 'grad_norm': 1.6208479404449463, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.62it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.53it/s]                                               {'loss': 0.1826, 'grad_norm': 4.4891204833984375, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.53it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s]                                               {'loss': 0.4667, 'grad_norm': 6.38753080368042, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s] 80%|████████  | 32/40 [00:19<00:03,  2.02it/s]                                               {'loss': 0.0402, 'grad_norm': 1.9373586177825928, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:03,  2.02it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.91it/s]                                               {'loss': 0.1936, 'grad_norm': 1.6562575101852417, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.72it/s]                                               {'loss': 0.0795, 'grad_norm': 2.0130202770233154, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.72it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s]                                               {'loss': 0.0369, 'grad_norm': 0.7969658374786377, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.59it/s]                                               {'loss': 0.0297, 'grad_norm': 0.7672761082649231, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.59it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.56it/s]                                               {'loss': 0.4517, 'grad_norm': 1.0510826110839844, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.56it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.59it/s]                                               {'loss': 0.2082, 'grad_norm': 0.3756074011325836, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.59it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.51it/s]                                               {'loss': 0.0262, 'grad_norm': 0.7749630212783813, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.51it/s]                                               {'loss': 0.016, 'grad_norm': 1.3620777130126953, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.51it/s]                                               {'train_runtime': 24.8647, 'train_samples_per_second': 22.723, 'train_steps_per_second': 1.609, 'train_loss': 0.48156328229233625, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.51it/s]100%|██████████| 40/40 [00:24<00:00,  1.61it/s]
CLIENT:9
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.59it/s]                                              {'loss': 2.2477, 'grad_norm': 12.052480697631836, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.59it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]                                              {'loss': 1.9345, 'grad_norm': 12.483285903930664, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:01<00:22,  1.62it/s]                                              {'loss': 0.789, 'grad_norm': 10.311567306518555, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.62it/s] 10%|█         | 4/40 [00:02<00:18,  1.96it/s]                                              {'loss': 1.1641, 'grad_norm': 11.324349403381348, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:18,  1.96it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s]                                              {'loss': 1.8519, 'grad_norm': 22.927125930786133, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.44it/s]                                              {'loss': 2.6367, 'grad_norm': 21.175859451293945, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.44it/s] 18%|█▊        | 7/40 [00:03<00:12,  2.59it/s]                                              {'loss': 1.4315, 'grad_norm': 15.872074127197266, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:12,  2.59it/s] 20%|██        | 8/40 [00:03<00:09,  3.38it/s]                                              {'loss': 0.6528, 'grad_norm': 52.708126068115234, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:09,  3.38it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.20it/s]                                              {'loss': 1.2336, 'grad_norm': 23.419857025146484, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.20it/s] 25%|██▌       | 10/40 [00:04<00:09,  3.10it/s]                                               {'loss': 0.5423, 'grad_norm': 10.763945579528809, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:09,  3.10it/s] 28%|██▊       | 11/40 [00:04<00:09,  3.05it/s]                                               {'loss': 0.5112, 'grad_norm': 8.738906860351562, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:09,  3.05it/s] 30%|███       | 12/40 [00:04<00:09,  2.97it/s]                                               {'loss': 0.5449, 'grad_norm': 9.807328224182129, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.97it/s] 32%|███▎      | 13/40 [00:05<00:09,  2.92it/s]                                               {'loss': 0.2904, 'grad_norm': 5.218747615814209, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:09,  2.92it/s] 35%|███▌      | 14/40 [00:05<00:08,  2.91it/s]                                               {'loss': 1.3791, 'grad_norm': 12.070878982543945, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:08,  2.91it/s] 38%|███▊      | 15/40 [00:05<00:08,  2.90it/s]                                               {'loss': 0.3176, 'grad_norm': 4.56716775894165, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  2.90it/s]                                               {'loss': 0.7915, 'grad_norm': 18.70874786376953, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:08,  2.90it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.60it/s]                                               {'loss': 0.4032, 'grad_norm': 5.739306926727295, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.60it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.59it/s]                                               {'loss': 0.2405, 'grad_norm': 8.41801929473877, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.59it/s] 48%|████▊     | 19/40 [00:07<00:09,  2.22it/s]                                               {'loss': 0.3733, 'grad_norm': 9.208909034729004, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:09,  2.22it/s] 50%|█████     | 20/40 [00:08<00:10,  1.93it/s]                                               {'loss': 0.3471, 'grad_norm': 7.410576343536377, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:10,  1.93it/s] 52%|█████▎    | 21/40 [00:08<00:10,  1.74it/s]                                               {'loss': 0.068, 'grad_norm': 1.3968528509140015, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:10,  1.74it/s] 55%|█████▌    | 22/40 [00:09<00:10,  1.70it/s]                                               {'loss': 0.2494, 'grad_norm': 8.54724407196045, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:10,  1.70it/s] 57%|█████▊    | 23/40 [00:10<00:10,  1.59it/s]                                               {'loss': 0.4023, 'grad_norm': 7.159952640533447, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:10,  1.59it/s]                                               {'loss': 0.0322, 'grad_norm': 2.054239273071289, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:10,  1.59it/s] 62%|██████▎   | 25/40 [00:11<00:07,  1.91it/s]                                               {'loss': 0.222, 'grad_norm': 6.714266300201416, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:11<00:07,  1.84it/s]                                               {'loss': 0.0883, 'grad_norm': 2.050348997116089, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:07,  1.84it/s] 68%|██████▊   | 27/40 [00:12<00:07,  1.69it/s]                                               {'loss': 0.1493, 'grad_norm': 14.88376522064209, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:07,  1.69it/s] 70%|███████   | 28/40 [00:13<00:07,  1.61it/s]                                               {'loss': 0.0623, 'grad_norm': 1.7323801517486572, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:13<00:07,  1.61it/s] 72%|███████▎  | 29/40 [00:13<00:06,  1.59it/s]                                               {'loss': 0.0887, 'grad_norm': 2.3303327560424805, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:14<00:06,  1.52it/s]                                               {'loss': 0.0761, 'grad_norm': 1.8986155986785889, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:14<00:06,  1.52it/s] 78%|███████▊  | 31/40 [00:15<00:05,  1.55it/s]                                               {'loss': 0.1988, 'grad_norm': 8.096424102783203, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:05,  1.55it/s]                                               {'loss': 0.0504, 'grad_norm': 3.4346120357513428, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:15<00:05,  1.55it/s] 82%|████████▎ | 33/40 [00:15<00:03,  1.88it/s]                                               {'loss': 0.0577, 'grad_norm': 2.3799362182617188, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:15<00:03,  1.88it/s] 85%|████████▌ | 34/40 [00:16<00:03,  1.71it/s]                                               {'loss': 0.0267, 'grad_norm': 1.0186147689819336, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:16<00:03,  1.71it/s] 88%|████████▊ | 35/40 [00:17<00:02,  1.68it/s]                                               {'loss': 0.0296, 'grad_norm': 0.8415564894676208, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:17<00:02,  1.68it/s] 90%|█████████ | 36/40 [00:18<00:02,  1.59it/s]                                               {'loss': 0.0183, 'grad_norm': 0.6196228265762329, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:18<00:02,  1.59it/s] 92%|█████████▎| 37/40 [00:18<00:01,  1.53it/s]                                               {'loss': 0.0424, 'grad_norm': 1.3087146282196045, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:18<00:01,  1.53it/s] 95%|█████████▌| 38/40 [00:19<00:01,  1.56it/s]                                               {'loss': 0.0332, 'grad_norm': 1.1668907403945923, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:19<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:20<00:00,  1.49it/s]                                               {'loss': 0.0408, 'grad_norm': 1.9036297798156738, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:20<00:00,  1.49it/s]                                               {'loss': 0.0038, 'grad_norm': 0.23544760048389435, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.49it/s]                                               {'train_runtime': 20.3987, 'train_samples_per_second': 27.698, 'train_steps_per_second': 1.961, 'train_loss': 0.5405822590284515, 'epoch': 5.0}
100%|██████████| 40/40 [00:20<00:00,  1.49it/s]100%|██████████| 40/40 [00:20<00:00,  1.96it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:16,  6.16it/s]  1%|          | 3/471 [00:00<01:42,  4.58it/s]  1%|          | 4/471 [00:01<02:18,  3.37it/s]  1%|          | 5/471 [00:01<02:26,  3.17it/s]  1%|▏         | 6/471 [00:01<02:22,  3.26it/s]  1%|▏         | 7/471 [00:02<02:40,  2.90it/s]  2%|▏         | 8/471 [00:02<02:44,  2.81it/s]  2%|▏         | 9/471 [00:02<02:39,  2.89it/s]  2%|▏         | 10/471 [00:03<02:39,  2.89it/s]  2%|▏         | 11/471 [00:03<02:48,  2.72it/s]  3%|▎         | 12/471 [00:03<02:42,  2.82it/s]  3%|▎         | 13/471 [00:04<02:40,  2.86it/s]  3%|▎         | 14/471 [00:04<02:51,  2.67it/s]  3%|▎         | 15/471 [00:05<02:44,  2.76it/s]  3%|▎         | 16/471 [00:05<02:38,  2.88it/s]  4%|▎         | 17/471 [00:05<02:48,  2.69it/s]  4%|▍         | 18/471 [00:06<02:47,  2.71it/s]  4%|▍         | 19/471 [00:06<02:37,  2.86it/s]  4%|▍         | 20/471 [00:06<02:43,  2.75it/s]  4%|▍         | 21/471 [00:07<02:47,  2.69it/s]  5%|▍         | 22/471 [00:07<02:41,  2.78it/s]  5%|▍         | 23/471 [00:07<02:41,  2.78it/s]  5%|▌         | 24/471 [00:08<02:48,  2.66it/s]  5%|▌         | 25/471 [00:08<02:41,  2.76it/s]  6%|▌         | 26/471 [00:08<02:29,  2.97it/s]  6%|▌         | 27/471 [00:09<02:41,  2.75it/s]  6%|▌         | 28/471 [00:09<02:41,  2.73it/s]  6%|▌         | 29/471 [00:10<02:36,  2.82it/s]  6%|▋         | 30/471 [00:10<02:37,  2.79it/s]  7%|▋         | 31/471 [00:10<02:43,  2.69it/s]  7%|▋         | 32/471 [00:11<02:37,  2.78it/s]  7%|▋         | 33/471 [00:11<02:32,  2.88it/s]  7%|▋         | 34/471 [00:11<02:42,  2.69it/s]  7%|▋         | 35/471 [00:12<02:37,  2.77it/s]  8%|▊         | 36/471 [00:12<02:30,  2.89it/s]  8%|▊         | 37/471 [00:12<02:41,  2.69it/s]  8%|▊         | 38/471 [00:13<02:38,  2.73it/s]  8%|▊         | 39/471 [00:13<02:30,  2.87it/s]  8%|▊         | 40/471 [00:14<02:36,  2.75it/s]  9%|▊         | 41/471 [00:14<02:39,  2.70it/s]  9%|▉         | 42/471 [00:14<02:33,  2.80it/s]  9%|▉         | 43/471 [00:15<02:32,  2.81it/s]  9%|▉         | 44/471 [00:15<02:39,  2.68it/s] 10%|▉         | 45/471 [00:15<02:32,  2.78it/s] 10%|▉         | 46/471 [00:16<02:30,  2.83it/s] 10%|▉         | 47/471 [00:16<02:39,  2.66it/s] 10%|█         | 48/471 [00:16<02:33,  2.75it/s] 10%|█         | 49/471 [00:17<02:26,  2.88it/s] 11%|█         | 50/471 [00:17<02:05,  3.36it/s] 11%|█         | 51/471 [00:17<01:52,  3.72it/s] 11%|█         | 52/471 [00:17<01:43,  4.05it/s] 11%|█▏        | 53/471 [00:18<01:36,  4.34it/s] 11%|█▏        | 54/471 [00:18<01:31,  4.57it/s] 12%|█▏        | 55/471 [00:18<01:27,  4.75it/s] 12%|█▏        | 56/471 [00:18<01:25,  4.85it/s] 12%|█▏        | 57/471 [00:18<01:23,  4.94it/s] 12%|█▏        | 58/471 [00:18<01:22,  5.01it/s] 13%|█▎        | 59/471 [00:19<01:21,  5.07it/s] 13%|█▎        | 60/471 [00:19<01:21,  5.05it/s] 13%|█▎        | 61/471 [00:19<01:21,  5.05it/s] 13%|█▎        | 62/471 [00:19<01:21,  5.04it/s] 13%|█▎        | 63/471 [00:19<01:20,  5.05it/s] 14%|█▎        | 64/471 [00:20<01:19,  5.09it/s] 14%|█▍        | 65/471 [00:20<01:20,  5.04it/s] 14%|█▍        | 66/471 [00:20<01:41,  4.00it/s] 14%|█▍        | 67/471 [00:21<01:58,  3.41it/s] 14%|█▍        | 68/471 [00:21<02:02,  3.29it/s] 15%|█▍        | 69/471 [00:21<02:07,  3.16it/s] 15%|█▍        | 70/471 [00:22<02:19,  2.87it/s] 15%|█▌        | 71/471 [00:22<02:16,  2.92it/s] 15%|█▌        | 72/471 [00:22<02:14,  2.97it/s] 15%|█▌        | 73/471 [00:23<02:25,  2.74it/s] 16%|█▌        | 74/471 [00:23<02:22,  2.79it/s] 16%|█▌        | 75/471 [00:23<02:15,  2.93it/s] 16%|█▌        | 76/471 [00:24<02:24,  2.74it/s] 16%|█▋        | 77/471 [00:24<02:25,  2.71it/s] 17%|█▋        | 78/471 [00:25<02:20,  2.79it/s] 17%|█▋        | 79/471 [00:25<02:21,  2.76it/s] 17%|█▋        | 80/471 [00:25<02:26,  2.67it/s] 17%|█▋        | 81/471 [00:26<02:20,  2.77it/s] 17%|█▋        | 82/471 [00:26<02:19,  2.80it/s] 18%|█▊        | 83/471 [00:26<02:26,  2.64it/s] 18%|█▊        | 84/471 [00:27<02:21,  2.74it/s] 18%|█▊        | 85/471 [00:27<02:17,  2.81it/s] 18%|█▊        | 86/471 [00:28<02:26,  2.63it/s] 18%|█▊        | 87/471 [00:28<02:21,  2.72it/s] 19%|█▊        | 88/471 [00:28<02:14,  2.86it/s] 19%|█▉        | 89/471 [00:29<02:16,  2.80it/s] 19%|█▉        | 90/471 [00:29<02:21,  2.69it/s] 19%|█▉        | 91/471 [00:29<02:15,  2.80it/s] 20%|█▉        | 92/471 [00:30<02:13,  2.84it/s] 20%|█▉        | 93/471 [00:30<02:21,  2.66it/s] 20%|█▉        | 94/471 [00:30<02:16,  2.77it/s] 20%|██        | 95/471 [00:31<02:10,  2.88it/s] 20%|██        | 96/471 [00:31<02:18,  2.70it/s] 21%|██        | 97/471 [00:32<02:16,  2.74it/s] 21%|██        | 98/471 [00:32<02:09,  2.89it/s] 21%|██        | 99/471 [00:32<02:16,  2.73it/s] 21%|██        | 100/471 [00:33<02:17,  2.69it/s] 21%|██▏       | 101/471 [00:33<02:13,  2.78it/s] 22%|██▏       | 102/471 [00:33<02:12,  2.78it/s] 22%|██▏       | 103/471 [00:34<02:18,  2.65it/s] 22%|██▏       | 104/471 [00:34<02:13,  2.75it/s] 22%|██▏       | 105/471 [00:34<02:10,  2.81it/s] 23%|██▎       | 106/471 [00:35<02:17,  2.65it/s] 23%|██▎       | 107/471 [00:35<02:12,  2.75it/s] 23%|██▎       | 108/471 [00:35<02:06,  2.86it/s] 23%|██▎       | 109/471 [00:36<02:14,  2.68it/s] 23%|██▎       | 110/471 [00:36<02:13,  2.71it/s] 24%|██▎       | 111/471 [00:37<02:05,  2.87it/s] 24%|██▍       | 112/471 [00:37<02:04,  2.88it/s] 24%|██▍       | 113/471 [00:37<02:12,  2.71it/s] 24%|██▍       | 114/471 [00:38<02:07,  2.79it/s] 24%|██▍       | 115/471 [00:38<02:02,  2.92it/s] 25%|██▍       | 116/471 [00:38<02:10,  2.71it/s] 25%|██▍       | 117/471 [00:39<02:08,  2.74it/s] 25%|██▌       | 118/471 [00:39<02:01,  2.90it/s] 25%|██▌       | 119/471 [00:39<02:07,  2.76it/s] 25%|██▌       | 120/471 [00:40<02:10,  2.69it/s] 26%|██▌       | 121/471 [00:40<02:05,  2.79it/s] 26%|██▌       | 122/471 [00:41<02:04,  2.80it/s] 26%|██▌       | 123/471 [00:41<02:10,  2.66it/s] 26%|██▋       | 124/471 [00:41<02:05,  2.77it/s] 27%|██▋       | 125/471 [00:42<02:02,  2.82it/s] 27%|██▋       | 126/471 [00:42<02:10,  2.65it/s] 27%|██▋       | 127/471 [00:42<02:05,  2.75it/s] 27%|██▋       | 128/471 [00:43<01:59,  2.86it/s] 27%|██▋       | 129/471 [00:43<02:07,  2.68it/s] 28%|██▊       | 130/471 [00:43<02:05,  2.72it/s] 28%|██▊       | 131/471 [00:44<01:58,  2.87it/s] 28%|██▊       | 132/471 [00:44<02:05,  2.70it/s] 28%|██▊       | 133/471 [00:45<02:06,  2.68it/s] 28%|██▊       | 134/471 [00:45<02:01,  2.77it/s] 29%|██▊       | 135/471 [00:45<01:51,  3.01it/s] 29%|██▉       | 136/471 [00:46<02:00,  2.78it/s] 29%|██▉       | 137/471 [00:46<02:00,  2.77it/s] 29%|██▉       | 138/471 [00:46<01:55,  2.88it/s] 30%|██▉       | 139/471 [00:47<01:59,  2.78it/s] 30%|██▉       | 140/471 [00:47<02:02,  2.70it/s] 30%|██▉       | 141/471 [00:47<01:58,  2.80it/s] 30%|███       | 142/471 [00:48<01:57,  2.81it/s] 30%|███       | 143/471 [00:48<02:02,  2.67it/s] 31%|███       | 144/471 [00:48<01:58,  2.76it/s] 31%|███       | 145/471 [00:49<01:54,  2.86it/s] 31%|███       | 146/471 [00:49<02:01,  2.67it/s] 31%|███       | 147/471 [00:50<01:58,  2.74it/s] 31%|███▏      | 148/471 [00:50<01:52,  2.86it/s] 32%|███▏      | 149/471 [00:50<02:00,  2.68it/s] 32%|███▏      | 150/471 [00:51<01:58,  2.71it/s] 32%|███▏      | 151/471 [00:51<01:52,  2.85it/s] 32%|███▏      | 152/471 [00:51<01:56,  2.75it/s] 32%|███▏      | 153/471 [00:52<01:58,  2.68it/s] 33%|███▎      | 154/471 [00:52<01:53,  2.79it/s] 33%|███▎      | 155/471 [00:52<01:51,  2.82it/s] 33%|███▎      | 156/471 [00:53<01:57,  2.68it/s] 33%|███▎      | 157/471 [00:53<01:52,  2.78it/s] 34%|███▎      | 158/471 [00:53<01:45,  2.97it/s] 34%|███▍      | 159/471 [00:54<01:48,  2.86it/s] 34%|███▍      | 160/471 [00:54<01:52,  2.76it/s] 34%|███▍      | 161/471 [00:55<01:49,  2.84it/s] 34%|███▍      | 162/471 [00:55<01:47,  2.87it/s] 35%|███▍      | 163/471 [00:55<01:54,  2.69it/s] 35%|███▍      | 164/471 [00:56<01:49,  2.80it/s] 35%|███▌      | 165/471 [00:56<01:46,  2.87it/s] 35%|███▌      | 166/471 [00:56<01:53,  2.70it/s] 35%|███▌      | 167/471 [00:57<01:50,  2.76it/s] 36%|███▌      | 168/471 [00:57<01:44,  2.90it/s] 36%|███▌      | 169/471 [00:57<01:51,  2.71it/s] 36%|███▌      | 170/471 [00:58<01:50,  2.72it/s] 36%|███▋      | 171/471 [00:58<01:46,  2.81it/s] 37%|███▋      | 172/471 [00:59<01:47,  2.79it/s] 37%|███▋      | 173/471 [00:59<01:50,  2.69it/s] 37%|███▋      | 174/471 [00:59<01:46,  2.79it/s] 37%|███▋      | 175/471 [01:00<01:44,  2.83it/s] 37%|███▋      | 176/471 [01:00<01:50,  2.67it/s] 38%|███▊      | 177/471 [01:00<01:46,  2.77it/s] 38%|███▊      | 178/471 [01:01<01:42,  2.85it/s] 38%|███▊      | 179/471 [01:01<01:48,  2.68it/s] 38%|███▊      | 180/471 [01:01<01:46,  2.74it/s] 38%|███▊      | 181/471 [01:02<01:40,  2.89it/s] 39%|███▊      | 182/471 [01:02<01:28,  3.25it/s] 39%|███▉      | 183/471 [01:02<01:19,  3.63it/s] 39%|███▉      | 184/471 [01:02<01:12,  3.97it/s] 39%|███▉      | 185/471 [01:03<01:06,  4.28it/s] 39%|███▉      | 186/471 [01:03<01:02,  4.53it/s] 40%|███▉      | 187/471 [01:03<00:59,  4.73it/s] 40%|███▉      | 188/471 [01:03<00:58,  4.85it/s] 40%|████      | 189/471 [01:03<00:57,  4.93it/s] 40%|████      | 190/471 [01:04<00:55,  5.02it/s] 41%|████      | 191/471 [01:04<00:55,  5.08it/s] 41%|████      | 192/471 [01:04<00:54,  5.15it/s] 41%|████      | 193/471 [01:04<00:53,  5.18it/s] 41%|████      | 194/471 [01:04<00:53,  5.17it/s] 41%|████▏     | 195/471 [01:05<00:53,  5.11it/s] 42%|████▏     | 196/471 [01:05<00:53,  5.11it/s] 42%|████▏     | 197/471 [01:05<00:53,  5.14it/s] 42%|████▏     | 198/471 [01:05<00:53,  5.13it/s] 42%|████▏     | 199/471 [01:05<00:53,  5.13it/s] 42%|████▏     | 200/471 [01:05<00:53,  5.05it/s] 43%|████▎     | 201/471 [01:06<01:08,  3.95it/s] 43%|████▎     | 202/471 [01:06<01:18,  3.43it/s] 43%|████▎     | 203/471 [01:07<01:21,  3.28it/s] 43%|████▎     | 204/471 [01:07<01:24,  3.15it/s] 44%|████▎     | 205/471 [01:07<01:20,  3.30it/s] 44%|████▎     | 206/471 [01:08<01:22,  3.21it/s] 44%|████▍     | 207/471 [01:08<01:23,  3.15it/s] 44%|████▍     | 208/471 [01:08<01:23,  3.16it/s] 44%|████▍     | 209/471 [01:09<01:30,  2.88it/s] 45%|████▍     | 210/471 [01:09<01:30,  2.87it/s] 45%|████▍     | 211/471 [01:09<01:26,  3.00it/s] 45%|████▌     | 212/471 [01:10<01:33,  2.78it/s] 45%|████▌     | 213/471 [01:10<01:34,  2.74it/s] 45%|████▌     | 214/471 [01:10<01:31,  2.82it/s] 46%|████▌     | 215/471 [01:11<01:31,  2.80it/s] 46%|████▌     | 216/471 [01:11<01:35,  2.68it/s] 46%|████▌     | 217/471 [01:11<01:31,  2.78it/s] 46%|████▋     | 218/471 [01:12<01:28,  2.85it/s] 46%|████▋     | 219/471 [01:12<01:34,  2.67it/s] 47%|████▋     | 220/471 [01:13<01:30,  2.76it/s] 47%|████▋     | 221/471 [01:13<01:26,  2.88it/s] 47%|████▋     | 222/471 [01:13<01:32,  2.69it/s] 47%|████▋     | 223/471 [01:14<01:30,  2.73it/s] 48%|████▊     | 224/471 [01:14<01:25,  2.88it/s] 48%|████▊     | 225/471 [01:14<01:24,  2.90it/s] 48%|████▊     | 226/471 [01:15<01:30,  2.71it/s] 48%|████▊     | 227/471 [01:15<01:27,  2.79it/s] 48%|████▊     | 228/471 [01:15<01:24,  2.89it/s] 49%|████▊     | 229/471 [01:16<01:29,  2.70it/s] 49%|████▉     | 230/471 [01:16<01:27,  2.75it/s] 49%|████▉     | 231/471 [01:16<01:22,  2.90it/s] 49%|████▉     | 232/471 [01:17<01:27,  2.73it/s] 49%|████▉     | 233/471 [01:17<01:27,  2.71it/s] 50%|████▉     | 234/471 [01:18<01:25,  2.79it/s] 50%|████▉     | 235/471 [01:18<01:24,  2.78it/s] 50%|█████     | 236/471 [01:18<01:27,  2.69it/s] 50%|█████     | 237/471 [01:19<01:24,  2.78it/s] 51%|█████     | 238/471 [01:19<01:22,  2.81it/s] 51%|█████     | 239/471 [01:19<01:27,  2.66it/s] 51%|█████     | 240/471 [01:20<01:23,  2.76it/s] 51%|█████     | 241/471 [01:20<01:20,  2.85it/s] 51%|█████▏    | 242/471 [01:21<01:25,  2.68it/s] 52%|█████▏    | 243/471 [01:21<01:23,  2.75it/s] 52%|█████▏    | 244/471 [01:21<01:18,  2.88it/s] 52%|█████▏    | 245/471 [01:22<01:23,  2.70it/s] 52%|█████▏    | 246/471 [01:22<01:23,  2.70it/s] 52%|█████▏    | 247/471 [01:22<01:20,  2.79it/s] 53%|█████▎    | 248/471 [01:23<01:16,  2.91it/s] 53%|█████▎    | 249/471 [01:23<01:21,  2.71it/s] 53%|█████▎    | 250/471 [01:23<01:19,  2.79it/s] 53%|█████▎    | 251/471 [01:24<01:15,  2.92it/s] 54%|█████▎    | 252/471 [01:24<01:20,  2.73it/s] 54%|█████▎    | 253/471 [01:24<01:19,  2.74it/s] 54%|█████▍    | 254/471 [01:25<01:16,  2.83it/s] 54%|█████▍    | 255/471 [01:25<01:16,  2.81it/s] 54%|█████▍    | 256/471 [01:26<01:19,  2.70it/s] 55%|█████▍    | 257/471 [01:26<01:16,  2.80it/s] 55%|█████▍    | 258/471 [01:26<01:15,  2.84it/s] 55%|█████▍    | 259/471 [01:27<01:19,  2.67it/s] 55%|█████▌    | 260/471 [01:27<01:16,  2.77it/s] 55%|█████▌    | 261/471 [01:27<01:13,  2.85it/s] 56%|█████▌    | 262/471 [01:28<01:18,  2.68it/s] 56%|█████▌    | 263/471 [01:28<01:15,  2.74it/s] 56%|█████▌    | 264/471 [01:28<01:11,  2.88it/s] 56%|█████▋    | 265/471 [01:29<01:16,  2.70it/s] 56%|█████▋    | 266/471 [01:29<01:15,  2.71it/s] 57%|█████▋    | 267/471 [01:30<01:12,  2.82it/s] 57%|█████▋    | 268/471 [01:30<01:13,  2.76it/s] 57%|█████▋    | 269/471 [01:30<01:14,  2.69it/s] 57%|█████▋    | 270/471 [01:31<01:11,  2.80it/s] 58%|█████▊    | 271/471 [01:31<01:07,  2.95it/s] 58%|█████▊    | 272/471 [01:31<01:12,  2.76it/s] 58%|█████▊    | 273/471 [01:32<01:11,  2.77it/s] 58%|█████▊    | 274/471 [01:32<01:08,  2.88it/s] 58%|█████▊    | 275/471 [01:32<01:10,  2.79it/s] 59%|█████▊    | 276/471 [01:33<01:11,  2.72it/s] 59%|█████▉    | 277/471 [01:33<01:09,  2.81it/s] 59%|█████▉    | 278/471 [01:33<01:08,  2.82it/s] 59%|█████▉    | 279/471 [01:34<01:11,  2.68it/s] 59%|█████▉    | 280/471 [01:34<01:08,  2.79it/s] 60%|█████▉    | 281/471 [01:35<01:06,  2.86it/s] 60%|█████▉    | 282/471 [01:35<01:10,  2.69it/s] 60%|██████    | 283/471 [01:35<01:08,  2.76it/s] 60%|██████    | 284/471 [01:36<01:04,  2.88it/s] 61%|██████    | 285/471 [01:36<01:08,  2.70it/s] 61%|██████    | 286/471 [01:36<01:07,  2.72it/s] 61%|██████    | 287/471 [01:37<01:05,  2.83it/s] 61%|██████    | 288/471 [01:37<01:06,  2.77it/s] 61%|██████▏   | 289/471 [01:37<01:07,  2.71it/s] 62%|██████▏   | 290/471 [01:38<01:04,  2.80it/s] 62%|██████▏   | 291/471 [01:38<01:03,  2.82it/s] 62%|██████▏   | 292/471 [01:39<01:06,  2.68it/s] 62%|██████▏   | 293/471 [01:39<01:03,  2.79it/s] 62%|██████▏   | 294/471 [01:39<00:59,  2.97it/s] 63%|██████▎   | 295/471 [01:40<01:02,  2.84it/s] 63%|██████▎   | 296/471 [01:40<01:03,  2.76it/s] 63%|██████▎   | 297/471 [01:40<01:01,  2.85it/s] 63%|██████▎   | 298/471 [01:41<01:00,  2.85it/s] 63%|██████▎   | 299/471 [01:41<01:03,  2.70it/s] 64%|██████▎   | 300/471 [01:41<01:01,  2.78it/s] 64%|██████▍   | 301/471 [01:42<00:59,  2.85it/s] 64%|██████▍   | 302/471 [01:42<01:03,  2.67it/s] 64%|██████▍   | 303/471 [01:42<01:01,  2.75it/s] 65%|██████▍   | 304/471 [01:43<00:57,  2.89it/s] 65%|██████▍   | 305/471 [01:43<01:01,  2.70it/s] 65%|██████▍   | 306/471 [01:44<01:00,  2.71it/s] 65%|██████▌   | 307/471 [01:44<00:57,  2.84it/s] 65%|██████▌   | 308/471 [01:44<00:58,  2.78it/s] 66%|██████▌   | 309/471 [01:45<01:00,  2.69it/s] 66%|██████▌   | 310/471 [01:45<00:57,  2.80it/s] 66%|██████▌   | 311/471 [01:45<00:55,  2.88it/s] 66%|██████▌   | 312/471 [01:46<00:58,  2.70it/s] 66%|██████▋   | 313/471 [01:46<00:56,  2.80it/s] 67%|██████▋   | 314/471 [01:46<00:54,  2.88it/s] 67%|██████▋   | 315/471 [01:47<00:57,  2.70it/s] 67%|██████▋   | 316/471 [01:47<00:56,  2.76it/s] 67%|██████▋   | 317/471 [01:47<00:52,  2.92it/s] 68%|██████▊   | 318/471 [01:48<00:46,  3.30it/s] 68%|██████▊   | 319/471 [01:48<00:41,  3.69it/s] 68%|██████▊   | 320/471 [01:48<00:37,  4.02it/s] 68%|██████▊   | 321/471 [01:48<00:34,  4.32it/s] 68%|██████▊   | 322/471 [01:48<00:32,  4.57it/s] 69%|██████▊   | 323/471 [01:49<00:31,  4.77it/s] 69%|██████▉   | 324/471 [01:49<00:30,  4.90it/s] 69%|██████▉   | 325/471 [01:49<00:29,  4.98it/s] 69%|██████▉   | 326/471 [01:49<00:28,  5.04it/s] 69%|██████▉   | 327/471 [01:49<00:28,  5.12it/s] 70%|██████▉   | 328/471 [01:50<00:27,  5.17it/s] 70%|██████▉   | 329/471 [01:50<00:27,  5.19it/s] 70%|███████   | 330/471 [01:50<00:26,  5.23it/s] 70%|███████   | 331/471 [01:50<00:26,  5.23it/s] 70%|███████   | 332/471 [01:50<00:26,  5.23it/s] 71%|███████   | 333/471 [01:51<00:26,  5.24it/s] 71%|███████   | 334/471 [01:51<00:26,  5.25it/s] 71%|███████   | 335/471 [01:51<00:25,  5.24it/s] 71%|███████▏  | 336/471 [01:51<00:25,  5.25it/s] 72%|███████▏  | 337/471 [01:51<00:25,  5.27it/s] 72%|███████▏  | 338/471 [01:51<00:25,  5.26it/s] 72%|███████▏  | 339/471 [01:52<00:25,  5.25it/s] 72%|███████▏  | 340/471 [01:52<00:24,  5.26it/s] 72%|███████▏  | 341/471 [01:52<00:24,  5.26it/s] 73%|███████▎  | 342/471 [01:52<00:24,  5.27it/s] 73%|███████▎  | 343/471 [01:52<00:24,  5.26it/s] 73%|███████▎  | 344/471 [01:53<00:24,  5.27it/s] 73%|███████▎  | 345/471 [01:53<00:23,  5.25it/s] 73%|███████▎  | 346/471 [01:53<00:23,  5.26it/s] 74%|███████▎  | 347/471 [01:53<00:23,  5.27it/s] 74%|███████▍  | 348/471 [01:53<00:23,  5.26it/s] 74%|███████▍  | 349/471 [01:54<00:23,  5.25it/s] 74%|███████▍  | 350/471 [01:54<00:23,  5.24it/s] 75%|███████▍  | 351/471 [01:54<00:22,  5.27it/s] 75%|███████▍  | 352/471 [01:54<00:22,  5.27it/s] 75%|███████▍  | 353/471 [01:54<00:22,  5.25it/s] 75%|███████▌  | 354/471 [01:55<00:22,  5.25it/s] 75%|███████▌  | 355/471 [01:55<00:22,  5.24it/s] 76%|███████▌  | 356/471 [01:55<00:21,  5.25it/s] 76%|███████▌  | 357/471 [01:55<00:21,  5.25it/s] 76%|███████▌  | 358/471 [01:55<00:21,  5.26it/s] 76%|███████▌  | 359/471 [01:55<00:21,  5.26it/s] 76%|███████▋  | 360/471 [01:56<00:21,  5.26it/s] 77%|███████▋  | 361/471 [01:56<00:20,  5.26it/s] 77%|███████▋  | 362/471 [01:56<00:20,  5.27it/s] 77%|███████▋  | 363/471 [01:56<00:20,  5.28it/s] 77%|███████▋  | 364/471 [01:56<00:20,  5.26it/s] 77%|███████▋  | 365/471 [01:57<00:20,  5.19it/s] 78%|███████▊  | 366/471 [01:57<00:20,  5.17it/s] 78%|███████▊  | 367/471 [01:57<00:20,  5.16it/s] 78%|███████▊  | 368/471 [01:57<00:19,  5.16it/s] 78%|███████▊  | 369/471 [01:57<00:19,  5.17it/s] 79%|███████▊  | 370/471 [01:58<00:19,  5.15it/s] 79%|███████▉  | 371/471 [01:58<00:20,  4.82it/s] 79%|███████▉  | 372/471 [01:58<00:26,  3.74it/s] 79%|███████▉  | 373/471 [01:59<00:28,  3.39it/s] 79%|███████▉  | 374/471 [01:59<00:29,  3.33it/s] 80%|███████▉  | 375/471 [01:59<00:30,  3.12it/s] 80%|███████▉  | 376/471 [01:59<00:27,  3.45it/s] 80%|████████  | 377/471 [02:00<00:28,  3.27it/s] 80%|████████  | 378/471 [02:00<00:28,  3.21it/s] 80%|████████  | 379/471 [02:00<00:29,  3.14it/s] 81%|████████  | 380/471 [02:01<00:31,  2.85it/s] 81%|████████  | 381/471 [02:01<00:31,  2.89it/s] 81%|████████  | 382/471 [02:02<00:29,  2.98it/s] 81%|████████▏ | 383/471 [02:02<00:31,  2.77it/s] 82%|████████▏ | 384/471 [02:02<00:31,  2.78it/s] 82%|████████▏ | 385/471 [02:03<00:29,  2.90it/s] 82%|████████▏ | 386/471 [02:03<00:30,  2.79it/s] 82%|████████▏ | 387/471 [02:03<00:30,  2.72it/s] 82%|████████▏ | 388/471 [02:04<00:29,  2.81it/s] 83%|████████▎ | 389/471 [02:04<00:29,  2.83it/s] 83%|████████▎ | 390/471 [02:05<00:30,  2.69it/s] 83%|████████▎ | 391/471 [02:05<00:28,  2.79it/s] 83%|████████▎ | 392/471 [02:05<00:27,  2.84it/s] 83%|████████▎ | 393/471 [02:06<00:29,  2.67it/s] 84%|████████▎ | 394/471 [02:06<00:27,  2.76it/s] 84%|████████▍ | 395/471 [02:06<00:26,  2.89it/s] 84%|████████▍ | 396/471 [02:07<00:26,  2.82it/s] 84%|████████▍ | 397/471 [02:07<00:27,  2.72it/s] 85%|████████▍ | 398/471 [02:07<00:25,  2.82it/s] 85%|████████▍ | 399/471 [02:08<00:25,  2.85it/s] 85%|████████▍ | 400/471 [02:08<00:26,  2.68it/s] 85%|████████▌ | 401/471 [02:08<00:25,  2.79it/s] 85%|████████▌ | 402/471 [02:09<00:23,  2.89it/s] 86%|████████▌ | 403/471 [02:09<00:25,  2.72it/s] 86%|████████▌ | 404/471 [02:10<00:24,  2.76it/s] 86%|████████▌ | 405/471 [02:10<00:22,  2.91it/s] 86%|████████▌ | 406/471 [02:10<00:23,  2.76it/s] 86%|████████▋ | 407/471 [02:11<00:23,  2.72it/s] 87%|████████▋ | 408/471 [02:11<00:22,  2.80it/s] 87%|████████▋ | 409/471 [02:11<00:22,  2.80it/s] 87%|████████▋ | 410/471 [02:12<00:22,  2.68it/s] 87%|████████▋ | 411/471 [02:12<00:21,  2.78it/s] 87%|████████▋ | 412/471 [02:12<00:20,  2.83it/s] 88%|████████▊ | 413/471 [02:13<00:21,  2.67it/s] 88%|████████▊ | 414/471 [02:13<00:20,  2.78it/s] 88%|████████▊ | 415/471 [02:13<00:19,  2.86it/s] 88%|████████▊ | 416/471 [02:14<00:20,  2.69it/s] 89%|████████▊ | 417/471 [02:14<00:19,  2.76it/s] 89%|████████▊ | 418/471 [02:15<00:18,  2.90it/s] 89%|████████▉ | 419/471 [02:15<00:18,  2.86it/s] 89%|████████▉ | 420/471 [02:15<00:18,  2.72it/s] 89%|████████▉ | 421/471 [02:16<00:17,  2.82it/s] 90%|████████▉ | 422/471 [02:16<00:17,  2.88it/s] 90%|████████▉ | 423/471 [02:16<00:17,  2.70it/s] 90%|█████████ | 424/471 [02:17<00:16,  2.78it/s] 90%|█████████ | 425/471 [02:17<00:15,  2.89it/s] 90%|█████████ | 426/471 [02:17<00:16,  2.70it/s] 91%|█████████ | 427/471 [02:18<00:15,  2.75it/s] 91%|█████████ | 428/471 [02:18<00:14,  2.92it/s] 91%|█████████ | 429/471 [02:18<00:15,  2.77it/s] 91%|█████████▏| 430/471 [02:19<00:15,  2.72it/s] 92%|█████████▏| 431/471 [02:19<00:14,  2.82it/s] 92%|█████████▏| 432/471 [02:20<00:13,  2.82it/s] 92%|█████████▏| 433/471 [02:20<00:14,  2.70it/s] 92%|█████████▏| 434/471 [02:20<00:13,  2.79it/s] 92%|█████████▏| 435/471 [02:21<00:12,  2.86it/s] 93%|█████████▎| 436/471 [02:21<00:13,  2.69it/s] 93%|█████████▎| 437/471 [02:21<00:12,  2.78it/s] 93%|█████████▎| 438/471 [02:22<00:11,  2.89it/s] 93%|█████████▎| 439/471 [02:22<00:11,  2.70it/s] 93%|█████████▎| 440/471 [02:22<00:11,  2.74it/s] 94%|█████████▎| 441/471 [02:23<00:10,  2.88it/s] 94%|█████████▍| 442/471 [02:23<00:10,  2.89it/s] 94%|█████████▍| 443/471 [02:24<00:10,  2.72it/s] 94%|█████████▍| 444/471 [02:24<00:09,  2.81it/s] 94%|█████████▍| 445/471 [02:24<00:09,  2.89it/s] 95%|█████████▍| 446/471 [02:25<00:09,  2.71it/s] 95%|█████████▍| 447/471 [02:25<00:08,  2.77it/s] 95%|█████████▌| 448/471 [02:25<00:07,  2.93it/s] 95%|█████████▌| 449/471 [02:26<00:08,  2.74it/s] 96%|█████████▌| 450/471 [02:26<00:07,  2.72it/s] 96%|█████████▌| 451/471 [02:26<00:07,  2.81it/s] 96%|█████████▌| 452/471 [02:27<00:06,  2.81it/s] 96%|█████████▌| 453/471 [02:27<00:06,  2.69it/s] 96%|█████████▋| 454/471 [02:27<00:06,  2.78it/s] 97%|█████████▋| 455/471 [02:28<00:05,  2.83it/s] 97%|█████████▋| 456/471 [02:28<00:05,  2.68it/s] 97%|█████████▋| 457/471 [02:29<00:05,  2.77it/s] 97%|█████████▋| 458/471 [02:29<00:04,  2.87it/s] 97%|█████████▋| 459/471 [02:29<00:04,  2.70it/s] 98%|█████████▊| 460/471 [02:30<00:03,  2.76it/s] 98%|█████████▊| 461/471 [02:30<00:03,  2.89it/s] 98%|█████████▊| 462/471 [02:30<00:03,  2.72it/s] 98%|█████████▊| 463/471 [02:31<00:02,  2.73it/s] 99%|█████████▊| 464/471 [02:31<00:02,  2.84it/s] 99%|█████████▊| 465/471 [02:31<00:02,  2.94it/s] 99%|█████████▉| 466/471 [02:32<00:01,  2.73it/s] 99%|█████████▉| 467/471 [02:32<00:01,  2.81it/s] 99%|█████████▉| 468/471 [02:32<00:01,  2.92it/s]100%|█████████▉| 469/471 [02:33<00:00,  2.74it/s]100%|█████████▉| 470/471 [02:33<00:00,  2.75it/s]100%|██████████| 471/471 [02:33<00:00,  3.02it/s]100%|██████████| 471/471 [02:33<00:00,  3.06it/s]
{'eval_loss': 2.2651448249816895, 'eval_model_preparation_time': 0.0053, 'eval_acc': 0.42498672331386084, 'eval_runtime': 154.349, 'eval_samples_per_second': 48.798, 'eval_steps_per_second': 3.052}
ROUND:17
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.82it/s]                                              {'loss': 2.0027, 'grad_norm': 13.278879165649414, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.82it/s]  5%|▌         | 2/40 [00:00<00:13,  2.86it/s]                                              {'loss': 1.8284, 'grad_norm': 11.747610092163086, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.86it/s]  8%|▊         | 3/40 [00:01<00:12,  2.90it/s]                                              {'loss': 1.6078, 'grad_norm': 14.970643997192383, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.90it/s] 10%|█         | 4/40 [00:01<00:14,  2.42it/s]                                              {'loss': 1.0096, 'grad_norm': 14.517370223999023, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.42it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.00it/s]                                              {'loss': 2.3953, 'grad_norm': 19.003000259399414, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.00it/s] 15%|█▌        | 6/40 [00:02<00:17,  1.96it/s]                                              {'loss': 1.3009, 'grad_norm': 21.363203048706055, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:17,  1.96it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 1.3465, 'grad_norm': 13.660969734191895, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 0.2032, 'grad_norm': 17.060789108276367, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.18it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.48it/s]                                              {'loss': 0.4709, 'grad_norm': 7.963244438171387, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.48it/s] 25%|██▌       | 10/40 [00:04<00:14,  2.05it/s]                                               {'loss': 0.7921, 'grad_norm': 9.417207717895508, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:14,  2.05it/s] 28%|██▊       | 11/40 [00:05<00:15,  1.87it/s]                                               {'loss': 0.5037, 'grad_norm': 12.617914199829102, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:15,  1.87it/s] 30%|███       | 12/40 [00:05<00:16,  1.75it/s]                                               {'loss': 1.1401, 'grad_norm': 8.744927406311035, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:16,  1.75it/s] 32%|███▎      | 13/40 [00:06<00:16,  1.65it/s]                                               {'loss': 0.6718, 'grad_norm': 7.718330383300781, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.65it/s] 35%|███▌      | 14/40 [00:07<00:15,  1.65it/s]                                               {'loss': 0.7291, 'grad_norm': 9.05982494354248, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:15,  1.65it/s] 38%|███▊      | 15/40 [00:07<00:15,  1.58it/s]                                               {'loss': 0.4142, 'grad_norm': 7.514392852783203, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:15,  1.58it/s]                                               {'loss': 0.0103, 'grad_norm': 0.5794248580932617, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:15,  1.58it/s] 42%|████▎     | 17/40 [00:08<00:12,  1.89it/s]                                               {'loss': 0.1188, 'grad_norm': 3.536095380783081, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:09<00:11,  1.90it/s]                                               {'loss': 0.1847, 'grad_norm': 4.966372966766357, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:11,  1.90it/s] 48%|████▊     | 19/40 [00:09<00:11,  1.87it/s]                                               {'loss': 0.4377, 'grad_norm': 4.767606735229492, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:11,  1.87it/s] 50%|█████     | 20/40 [00:10<00:11,  1.76it/s]                                               {'loss': 0.2748, 'grad_norm': 6.415104389190674, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:11,  1.76it/s] 52%|█████▎    | 21/40 [00:11<00:11,  1.66it/s]                                               {'loss': 0.5346, 'grad_norm': 2.225519895553589, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:11,  1.66it/s] 55%|█████▌    | 22/40 [00:11<00:10,  1.64it/s]                                               {'loss': 0.2993, 'grad_norm': 5.548172950744629, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:10,  1.64it/s] 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s]                                               {'loss': 0.6111, 'grad_norm': 8.107486724853516, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s]                                               {'loss': 0.1818, 'grad_norm': 13.192240715026855, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.57it/s] 62%|██████▎   | 25/40 [00:13<00:07,  1.91it/s]                                               {'loss': 0.4464, 'grad_norm': 1.8705008029937744, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:13<00:07,  1.83it/s]                                               {'loss': 0.2144, 'grad_norm': 4.596779823303223, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:07,  1.83it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.71it/s]                                               {'loss': 0.0768, 'grad_norm': 2.1352100372314453, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.71it/s] 70%|███████   | 28/40 [00:15<00:07,  1.62it/s]                                               {'loss': 0.1958, 'grad_norm': 7.54180908203125, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.62it/s] 72%|███████▎  | 29/40 [00:15<00:06,  1.63it/s]                                               {'loss': 0.2031, 'grad_norm': 7.375333309173584, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:06,  1.63it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.55it/s]                                               {'loss': 0.1603, 'grad_norm': 5.478847026824951, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.55it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.57it/s]                                               {'loss': 0.1614, 'grad_norm': 3.0172252655029297, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.57it/s]                                               {'loss': 0.0142, 'grad_norm': 1.8348459005355835, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.57it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.93it/s]                                               {'loss': 0.0881, 'grad_norm': 1.2149797677993774, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.93it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.77it/s]                                               {'loss': 0.3739, 'grad_norm': 1.151098370552063, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.72it/s]                                               {'loss': 0.0683, 'grad_norm': 2.186957597732544, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.72it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.64it/s]                                               {'loss': 0.163, 'grad_norm': 3.261544704437256, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.64it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.57it/s]                                               {'loss': 0.1262, 'grad_norm': 4.3895792961120605, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.62it/s]                                               {'loss': 0.2322, 'grad_norm': 3.92439603805542, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.62it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.54it/s]                                               {'loss': 0.0613, 'grad_norm': 2.110759973526001, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.54it/s]                                               {'loss': 0.0469, 'grad_norm': 3.3132283687591553, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.54it/s]                                               {'train_runtime': 22.2505, 'train_samples_per_second': 25.393, 'train_steps_per_second': 1.798, 'train_loss': 0.5425405270420015, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.54it/s]100%|██████████| 40/40 [00:22<00:00,  1.80it/s]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]                                              {'loss': 3.3636, 'grad_norm': 13.457376480102539, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:40,  1.05s/it]  5%|▌         | 2/40 [00:01<00:30,  1.23it/s]                                              {'loss': 1.3023, 'grad_norm': 7.639842510223389, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:30,  1.23it/s]  8%|▊         | 3/40 [00:02<00:28,  1.31it/s]                                              {'loss': 0.8001, 'grad_norm': 6.476275444030762, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.31it/s] 10%|█         | 4/40 [00:03<00:25,  1.42it/s]                                              {'loss': 1.5129, 'grad_norm': 13.969573974609375, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:25,  1.42it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s]                                              {'loss': 2.1034, 'grad_norm': 18.948579788208008, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.43it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s]                                              {'loss': 1.8265, 'grad_norm': 15.721147537231445, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.45it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.51it/s]                                              {'loss': 1.302, 'grad_norm': 11.604467391967773, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.51it/s]                                              {'loss': 0.054, 'grad_norm': 3.4910576343536377, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:21,  1.51it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 0.626, 'grad_norm': 8.510778427124023, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s]                                               {'loss': 1.6406, 'grad_norm': 8.549384117126465, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.75it/s] 28%|██▊       | 11/40 [00:07<00:16,  1.73it/s]                                               {'loss': 0.588, 'grad_norm': 10.514644622802734, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:16,  1.73it/s] 30%|███       | 12/40 [00:07<00:14,  1.93it/s]                                               {'loss': 0.5396, 'grad_norm': 7.151507377624512, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:14,  1.93it/s] 32%|███▎      | 13/40 [00:07<00:12,  2.13it/s]                                               {'loss': 0.9055, 'grad_norm': 7.613465785980225, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:12,  2.13it/s] 35%|███▌      | 14/40 [00:08<00:11,  2.32it/s]                                               {'loss': 0.2291, 'grad_norm': 4.044112682342529, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:11,  2.32it/s] 38%|███▊      | 15/40 [00:08<00:10,  2.47it/s]                                               {'loss': 0.7537, 'grad_norm': 5.5517354011535645, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:10,  2.47it/s]                                               {'loss': 2.5367, 'grad_norm': 33.33156967163086, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:09,  2.47it/s] 42%|████▎     | 17/40 [00:08<00:07,  3.23it/s]                                               {'loss': 0.5538, 'grad_norm': 0.9347969889640808, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:07,  3.23it/s] 45%|████▌     | 18/40 [00:09<00:06,  3.17it/s]                                               {'loss': 0.5314, 'grad_norm': 3.765125036239624, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:06,  3.17it/s] 48%|████▊     | 19/40 [00:09<00:06,  3.10it/s]                                               {'loss': 0.8822, 'grad_norm': 4.287161827087402, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:06,  3.10it/s] 50%|█████     | 20/40 [00:09<00:06,  3.07it/s]                                               {'loss': 0.265, 'grad_norm': 7.790316104888916, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:06,  3.07it/s] 52%|█████▎    | 21/40 [00:10<00:06,  3.03it/s]                                               {'loss': 0.3239, 'grad_norm': 3.9838368892669678, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:06,  3.03it/s] 55%|█████▌    | 22/40 [00:10<00:06,  2.99it/s]                                               {'loss': 0.4566, 'grad_norm': 4.35973596572876, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:06,  2.99it/s] 57%|█████▊    | 23/40 [00:10<00:05,  2.95it/s]                                               {'loss': 0.1016, 'grad_norm': 2.1494083404541016, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:05,  2.95it/s]                                               {'loss': 0.0038, 'grad_norm': 0.2598322331905365, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.95it/s] 62%|██████▎   | 25/40 [00:11<00:04,  3.05it/s]                                               {'loss': 0.5112, 'grad_norm': 8.5789155960083, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:04,  3.05it/s] 65%|██████▌   | 26/40 [00:12<00:05,  2.34it/s]                                               {'loss': 0.5787, 'grad_norm': 1.342989206314087, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:05,  2.34it/s] 68%|██████▊   | 27/40 [00:12<00:06,  1.96it/s]                                               {'loss': 0.1646, 'grad_norm': 3.699449062347412, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:06,  1.96it/s] 70%|███████   | 28/40 [00:13<00:06,  1.75it/s]                                               {'loss': 0.0705, 'grad_norm': 1.8895485401153564, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:13<00:06,  1.75it/s] 72%|███████▎  | 29/40 [00:14<00:06,  1.61it/s]                                               {'loss': 0.6399, 'grad_norm': 2.4466772079467773, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:06,  1.61it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.53it/s]                                               {'loss': 0.0735, 'grad_norm': 1.7146613597869873, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.53it/s] 78%|███████▊  | 31/40 [00:15<00:06,  1.47it/s]                                               {'loss': 0.0562, 'grad_norm': 2.3819997310638428, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:06,  1.47it/s]                                               {'loss': 0.0119, 'grad_norm': 1.363677978515625, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.47it/s] 82%|████████▎ | 33/40 [00:16<00:03,  1.78it/s]                                               {'loss': 0.033, 'grad_norm': 1.005998134613037, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:03,  1.78it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.64it/s]                                               {'loss': 0.0169, 'grad_norm': 0.7162829637527466, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.64it/s] 88%|████████▊ | 35/40 [00:18<00:03,  1.56it/s]                                               {'loss': 0.3158, 'grad_norm': 1.366811990737915, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:03,  1.56it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.49it/s]                                               {'loss': 0.284, 'grad_norm': 2.317148208618164, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.49it/s] 92%|█████████▎| 37/40 [00:19<00:02,  1.45it/s]                                               {'loss': 0.0818, 'grad_norm': 3.2284841537475586, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:02,  1.45it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.41it/s]                                               {'loss': 0.3213, 'grad_norm': 1.996734380722046, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.39it/s]                                               {'loss': 0.4748, 'grad_norm': 1.1486996412277222, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.39it/s]                                               {'loss': 0.073, 'grad_norm': 4.185274600982666, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.39it/s]                                               {'train_runtime': 21.6, 'train_samples_per_second': 26.157, 'train_steps_per_second': 1.852, 'train_loss': 0.6727349373977631, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.39it/s]100%|██████████| 40/40 [00:21<00:00,  1.85it/s]
CLIENT:96
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]                                              {'loss': 2.3347, 'grad_norm': 11.84073257446289, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 2.3358, 'grad_norm': 16.72615623474121, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:02<00:27,  1.33it/s]                                              {'loss': 0.5792, 'grad_norm': 13.162999153137207, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.33it/s] 10%|█         | 4/40 [00:02<00:26,  1.34it/s]                                              {'loss': 0.6651, 'grad_norm': 9.623668670654297, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:26,  1.34it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s]                                              {'loss': 1.5253, 'grad_norm': 13.762439727783203, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.4352, 'grad_norm': 14.508806228637695, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 1.1378, 'grad_norm': 12.974928855895996, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s] 20%|██        | 8/40 [00:06<00:25,  1.24it/s]                                              {'loss': 0.0107, 'grad_norm': 0.6512751579284668, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:25,  1.24it/s] 22%|██▎       | 9/40 [00:06<00:24,  1.27it/s]                                              {'loss': 1.0671, 'grad_norm': 12.040820121765137, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:24,  1.27it/s] 25%|██▌       | 10/40 [00:07<00:23,  1.29it/s]                                               {'loss': 0.6289, 'grad_norm': 6.879585266113281, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:23,  1.29it/s] 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s]                                               {'loss': 0.4544, 'grad_norm': 6.806003570556641, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s] 30%|███       | 12/40 [00:09<00:21,  1.31it/s]                                               {'loss': 0.2815, 'grad_norm': 5.812859535217285, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.31it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.32it/s]                                               {'loss': 0.2415, 'grad_norm': 3.676607608795166, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.32it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s]                                               {'loss': 0.4761, 'grad_norm': 4.188437461853027, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.32it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.2556, 'grad_norm': 2.1851840019226074, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.0173, 'grad_norm': 1.3745478391647339, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.33it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.66it/s]                                               {'loss': 0.2414, 'grad_norm': 8.626755714416504, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.66it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.57it/s]                                               {'loss': 0.163, 'grad_norm': 3.2118782997131348, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.50it/s]                                               {'loss': 0.2328, 'grad_norm': 0.8695089817047119, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.50it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.2029, 'grad_norm': 3.5763180255889893, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s]                                               {'loss': 0.4172, 'grad_norm': 9.648537635803223, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.321, 'grad_norm': 4.6856913566589355, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.39it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.0889, 'grad_norm': 2.0070340633392334, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.37it/s]                                               {'loss': 0.0144, 'grad_norm': 1.283864974975586, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.37it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.71it/s]                                               {'loss': 0.1155, 'grad_norm': 2.7699830532073975, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.71it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s]                                               {'loss': 0.1264, 'grad_norm': 2.459714412689209, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.53it/s]                                               {'loss': 0.1932, 'grad_norm': 3.0100743770599365, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.53it/s] 70%|███████   | 28/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.0771, 'grad_norm': 0.8978570699691772, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.43it/s]                                               {'loss': 0.2106, 'grad_norm': 0.2874721586704254, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.43it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s]                                               {'loss': 0.1532, 'grad_norm': 2.5262842178344727, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.39it/s]                                               {'loss': 0.0491, 'grad_norm': 0.9222965240478516, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.39it/s]                                               {'loss': 0.0157, 'grad_norm': 0.8703693151473999, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.71it/s]                                               {'loss': 0.0221, 'grad_norm': 0.5197407603263855, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.71it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.60it/s]                                               {'loss': 0.0287, 'grad_norm': 0.5021609663963318, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.60it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.53it/s]                                               {'loss': 0.0375, 'grad_norm': 1.5555158853530884, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.48it/s]                                               {'loss': 0.1427, 'grad_norm': 10.557905197143555, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s]                                               {'loss': 0.3099, 'grad_norm': 2.5935795307159424, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.44it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.41it/s]                                               {'loss': 0.1694, 'grad_norm': 2.9723832607269287, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.39it/s]                                               {'loss': 0.0428, 'grad_norm': 1.4834263324737549, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.39it/s]                                               {'loss': 0.0003, 'grad_norm': 0.01672186888754368, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.39it/s]                                               {'train_runtime': 27.7278, 'train_samples_per_second': 20.377, 'train_steps_per_second': 1.443, 'train_loss': 0.4205545243108645, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.39it/s]100%|██████████| 40/40 [00:27<00:00,  1.44it/s]
CLIENT:16
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:13,  1.90s/it]                                              {'loss': 1.4018, 'grad_norm': 11.949498176574707, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:13,  1.90s/it]  5%|▌         | 2/40 [00:02<00:46,  1.23s/it]                                              {'loss': 1.441, 'grad_norm': 11.97560977935791, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:46,  1.23s/it]  8%|▊         | 3/40 [00:03<00:37,  1.01s/it]                                              {'loss': 1.3481, 'grad_norm': 13.726561546325684, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:37,  1.01s/it] 10%|█         | 4/40 [00:04<00:32,  1.10it/s]                                              {'loss': 1.8239, 'grad_norm': 22.39703369140625, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:04<00:32,  1.10it/s] 12%|█▎        | 5/40 [00:04<00:29,  1.17it/s]                                              {'loss': 1.2796, 'grad_norm': 14.615673065185547, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:29,  1.17it/s] 15%|█▌        | 6/40 [00:05<00:27,  1.22it/s]                                              {'loss': 1.5411, 'grad_norm': 12.420100212097168, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:27,  1.22it/s] 18%|█▊        | 7/40 [00:06<00:26,  1.26it/s]                                              {'loss': 1.6249, 'grad_norm': 15.61116886138916, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:06<00:26,  1.26it/s]                                              {'loss': 6.3267, 'grad_norm': 121.58440399169922, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:25,  1.26it/s] 22%|██▎       | 9/40 [00:07<00:19,  1.63it/s]                                              {'loss': 1.2728, 'grad_norm': 16.390546798706055, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:07<00:19,  1.63it/s] 25%|██▌       | 10/40 [00:08<00:19,  1.54it/s]                                               {'loss': 1.2901, 'grad_norm': 13.476689338684082, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:08<00:19,  1.54it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.47it/s]                                               {'loss': 0.2708, 'grad_norm': 11.370681762695312, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.47it/s] 30%|███       | 12/40 [00:09<00:19,  1.44it/s]                                               {'loss': 0.3755, 'grad_norm': 5.214378356933594, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:19,  1.44it/s] 32%|███▎      | 13/40 [00:10<00:19,  1.41it/s]                                               {'loss': 0.4202, 'grad_norm': 2.289862871170044, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:10<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s]                                               {'loss': 0.6093, 'grad_norm': 7.256533145904541, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.38it/s]                                               {'loss': 0.902, 'grad_norm': 8.585354804992676, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.38it/s]                                               {'loss': 3.1736, 'grad_norm': 69.40453338623047, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.38it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.71it/s]                                               {'loss': 0.4863, 'grad_norm': 3.5344948768615723, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.71it/s] 45%|████▌     | 18/40 [00:13<00:13,  1.59it/s]                                               {'loss': 0.326, 'grad_norm': 2.7670700550079346, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:13,  1.59it/s] 48%|████▊     | 19/40 [00:14<00:13,  1.52it/s]                                               {'loss': 0.1003, 'grad_norm': 2.988229990005493, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:14<00:13,  1.52it/s] 50%|█████     | 20/40 [00:14<00:13,  1.47it/s]                                               {'loss': 0.7662, 'grad_norm': 12.089850425720215, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.47it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.44it/s]                                               {'loss': 0.3699, 'grad_norm': 4.665098190307617, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.44it/s] 55%|█████▌    | 22/40 [00:16<00:12,  1.41it/s]                                               {'loss': 0.3501, 'grad_norm': 2.968219041824341, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:12,  1.41it/s] 57%|█████▊    | 23/40 [00:17<00:12,  1.39it/s]                                               {'loss': 0.4411, 'grad_norm': 3.006296157836914, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:17<00:12,  1.39it/s]                                               {'loss': 0.0022, 'grad_norm': 0.3091069161891937, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:17<00:11,  1.39it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.72it/s]                                               {'loss': 0.1422, 'grad_norm': 5.109752178192139, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.72it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.62it/s]                                               {'loss': 0.4518, 'grad_norm': 6.6279072761535645, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.62it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.53it/s]                                               {'loss': 0.3144, 'grad_norm': 1.6873492002487183, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.53it/s] 70%|███████   | 28/40 [00:20<00:08,  1.47it/s]                                               {'loss': 0.3763, 'grad_norm': 1.6912647485733032, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:20<00:08,  1.47it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.43it/s]                                               {'loss': 0.0539, 'grad_norm': 0.9056550860404968, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.43it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s]                                               {'loss': 0.3487, 'grad_norm': 3.2858970165252686, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.39it/s]                                               {'loss': 0.4166, 'grad_norm': 3.4616684913635254, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.39it/s]                                               {'loss': 0.0014, 'grad_norm': 0.07514028996229172, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.39it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.71it/s]                                               {'loss': 0.3406, 'grad_norm': 3.2135915756225586, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.71it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.60it/s]                                               {'loss': 0.0286, 'grad_norm': 1.0210719108581543, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.60it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.53it/s]                                               {'loss': 0.4476, 'grad_norm': 2.549825668334961, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.53it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.48it/s]                                               {'loss': 0.0472, 'grad_norm': 3.9915928840637207, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.48it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.43it/s]                                               {'loss': 0.081, 'grad_norm': 2.571413516998291, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.43it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.41it/s]                                               {'loss': 0.6131, 'grad_norm': 12.644537925720215, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.41it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.39it/s]                                               {'loss': 0.3836, 'grad_norm': 2.33105206489563, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.39it/s]                                               {'loss': 0.041, 'grad_norm': 5.45094108581543, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.39it/s]                                               {'train_runtime': 28.0638, 'train_samples_per_second': 20.133, 'train_steps_per_second': 1.425, 'train_loss': 0.8007848049426685, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.39it/s]100%|██████████| 40/40 [00:28<00:00,  1.43it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:56,  1.45s/it]                                              {'loss': 1.6538, 'grad_norm': 8.571090698242188, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:56,  1.45s/it]  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]                                              {'loss': 1.5173, 'grad_norm': 10.679431915283203, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.04s/it]  8%|▊         | 3/40 [00:02<00:33,  1.11it/s]                                              {'loss': 1.4447, 'grad_norm': 10.216399192810059, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:33,  1.11it/s] 10%|█         | 4/40 [00:03<00:30,  1.18it/s]                                              {'loss': 1.1462, 'grad_norm': 14.639775276184082, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:30,  1.18it/s] 12%|█▎        | 5/40 [00:04<00:28,  1.24it/s]                                              {'loss': 0.6481, 'grad_norm': 13.133992195129395, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:28,  1.24it/s] 15%|█▌        | 6/40 [00:05<00:26,  1.27it/s]                                              {'loss': 2.5616, 'grad_norm': 16.619525909423828, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:26,  1.27it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.29it/s]                                              {'loss': 1.8097, 'grad_norm': 17.32455825805664, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.29it/s]                                              {'loss': 6.0522, 'grad_norm': 132.53526306152344, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:24,  1.29it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.64it/s]                                              {'loss': 0.4126, 'grad_norm': 7.128881454467773, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.64it/s] 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s]                                               {'loss': 0.426, 'grad_norm': 5.483019828796387, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s]                                               {'loss': 1.732, 'grad_norm': 8.493440628051758, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s] 30%|███       | 12/40 [00:09<00:19,  1.45it/s]                                               {'loss': 0.2393, 'grad_norm': 4.872779369354248, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s]                                               {'loss': 0.9854, 'grad_norm': 7.445746898651123, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:10<00:18,  1.38it/s]                                               {'loss': 0.1864, 'grad_norm': 4.821773529052734, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:18,  1.38it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.36it/s]                                               {'loss': 0.684, 'grad_norm': 10.990534782409668, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.36it/s]                                               {'loss': 0.677, 'grad_norm': 32.251625061035156, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.36it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.69it/s]                                               {'loss': 0.3414, 'grad_norm': 10.976326942443848, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.69it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s]                                               {'loss': 0.403, 'grad_norm': 4.885809421539307, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.52it/s]                                               {'loss': 0.4774, 'grad_norm': 5.297451972961426, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.52it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.6191, 'grad_norm': 4.661253929138184, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s]                                               {'loss': 0.7946, 'grad_norm': 6.16621208190918, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.42it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.39it/s]                                               {'loss': 0.1473, 'grad_norm': 4.36405086517334, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.39it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.4204, 'grad_norm': 6.654532432556152, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.0671, 'grad_norm': 3.5801587104797363, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s]                                               {'loss': 0.511, 'grad_norm': 2.3237600326538086, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.69it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s]                                               {'loss': 0.5726, 'grad_norm': 1.6051714420318604, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s]                                               {'loss': 0.3797, 'grad_norm': 2.372875213623047, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s]                                               {'loss': 0.0635, 'grad_norm': 2.3321480751037598, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.092, 'grad_norm': 2.3232381343841553, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s]                                               {'loss': 0.1791, 'grad_norm': 1.870780110359192, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.39it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s]                                               {'loss': 0.269, 'grad_norm': 4.872836112976074, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.36it/s] 80%|████████  | 32/40 [00:22<00:04,  1.82it/s]                                               {'loss': 0.02, 'grad_norm': 1.2464035749435425, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:04,  1.82it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.64it/s]                                               {'loss': 0.2041, 'grad_norm': 1.4623570442199707, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.64it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.53it/s]                                               {'loss': 0.1076, 'grad_norm': 1.1865538358688354, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.53it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.47it/s]                                               {'loss': 0.0163, 'grad_norm': 0.3105197846889496, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.42it/s]                                               {'loss': 0.5284, 'grad_norm': 0.4081975817680359, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.42it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.40it/s]                                               {'loss': 0.1393, 'grad_norm': 0.4995029866695404, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.40it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.37it/s]                                               {'loss': 0.4351, 'grad_norm': 1.047982931137085, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.37it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.2471, 'grad_norm': 1.068784236907959, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.0016, 'grad_norm': 0.08911658823490143, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]                                               {'train_runtime': 27.7922, 'train_samples_per_second': 20.329, 'train_steps_per_second': 1.439, 'train_loss': 0.730325403434108, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]100%|██████████| 40/40 [00:27<00:00,  1.44it/s]
CLIENT:24
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]                                              {'loss': 2.1728, 'grad_norm': 9.4383544921875, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 1.4796, 'grad_norm': 9.54459285736084, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:02<00:28,  1.32it/s]                                              {'loss': 3.0195, 'grad_norm': 23.393108367919922, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.32it/s] 10%|█         | 4/40 [00:03<00:27,  1.32it/s]                                              {'loss': 1.7354, 'grad_norm': 15.453882217407227, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.32it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s]                                              {'loss': 1.8242, 'grad_norm': 16.0681095123291, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s]                                              {'loss': 2.1735, 'grad_norm': 18.198131561279297, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 2.4585, 'grad_norm': 20.829513549804688, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s] 20%|██        | 8/40 [00:05<00:21,  1.49it/s]                                              {'loss': 6.4339, 'grad_norm': 48.071380615234375, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:21,  1.49it/s] 22%|██▎       | 9/40 [00:06<00:21,  1.43it/s]                                              {'loss': 1.4976, 'grad_norm': 15.866233825683594, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:21,  1.43it/s] 25%|██▌       | 10/40 [00:07<00:21,  1.40it/s]                                               {'loss': 1.3489, 'grad_norm': 13.58345890045166, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:21,  1.40it/s] 28%|██▊       | 11/40 [00:08<00:21,  1.38it/s]                                               {'loss': 1.0835, 'grad_norm': 7.902928829193115, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:21,  1.38it/s] 30%|███       | 12/40 [00:08<00:20,  1.36it/s]                                               {'loss': 0.701, 'grad_norm': 6.884408473968506, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:20,  1.36it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.34it/s]                                               {'loss': 0.7255, 'grad_norm': 7.02559757232666, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.34it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s]                                               {'loss': 1.0115, 'grad_norm': 6.7247138023376465, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.34it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.7344, 'grad_norm': 11.667023658752441, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.33it/s]                                               {'loss': 0.2098, 'grad_norm': 13.949373245239258, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.33it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.67it/s]                                               {'loss': 0.5115, 'grad_norm': 2.7657599449157715, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.67it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.57it/s]                                               {'loss': 0.2767, 'grad_norm': 4.424191951751709, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.50it/s]                                               {'loss': 0.3571, 'grad_norm': 4.192479133605957, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.50it/s] 50%|█████     | 20/40 [00:14<00:13,  1.44it/s]                                               {'loss': 0.3359, 'grad_norm': 5.450460433959961, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.44it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.41it/s]                                               {'loss': 0.5859, 'grad_norm': 3.9078781604766846, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.41it/s] 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s]                                               {'loss': 0.3741, 'grad_norm': 4.742393493652344, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.3256, 'grad_norm': 3.536205291748047, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.3999, 'grad_norm': 9.308319091796875, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s]                                               {'loss': 0.1426, 'grad_norm': 2.8294806480407715, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.68it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s]                                               {'loss': 0.5823, 'grad_norm': 2.582294464111328, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.58it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s]                                               {'loss': 0.0931, 'grad_norm': 1.1248202323913574, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.50it/s] 70%|███████   | 28/40 [00:19<00:08,  1.45it/s]                                               {'loss': 0.2575, 'grad_norm': 6.648589611053467, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.45it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s]                                               {'loss': 0.2315, 'grad_norm': 4.649502754211426, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.41it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s]                                               {'loss': 0.1007, 'grad_norm': 2.645620584487915, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.38it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.36it/s]                                               {'loss': 0.2841, 'grad_norm': 5.690979480743408, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.36it/s]                                               {'loss': 0.0551, 'grad_norm': 1.6323813199996948, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.36it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.68it/s]                                               {'loss': 0.082, 'grad_norm': 1.1973249912261963, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.68it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.56it/s]                                               {'loss': 0.2388, 'grad_norm': 4.6112380027771, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.56it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s]                                               {'loss': 0.0495, 'grad_norm': 0.9859216213226318, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.50it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s]                                               {'loss': 0.3427, 'grad_norm': 2.8660337924957275, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.40it/s]                                               {'loss': 0.2531, 'grad_norm': 10.914131164550781, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.40it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s]                                               {'loss': 0.1089, 'grad_norm': 2.5993635654449463, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.36it/s]                                               {'loss': 0.2568, 'grad_norm': 1.1811705827713013, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.36it/s]                                               {'loss': 0.1616, 'grad_norm': 8.777542114257812, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.36it/s]                                               {'train_runtime': 27.625, 'train_samples_per_second': 20.453, 'train_steps_per_second': 1.448, 'train_loss': 0.8754192481748759, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.36it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
CLIENT:53
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:52,  1.34s/it]                                              {'loss': 2.3833, 'grad_norm': 9.48997688293457, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:52,  1.34s/it]  5%|▌         | 2/40 [00:02<00:37,  1.01it/s]                                              {'loss': 1.1678, 'grad_norm': 11.19152545928955, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.01it/s]  8%|▊         | 3/40 [00:02<00:32,  1.13it/s]                                              {'loss': 1.3089, 'grad_norm': 14.547966003417969, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:32,  1.13it/s] 10%|█         | 4/40 [00:03<00:29,  1.20it/s]                                              {'loss': 2.5487, 'grad_norm': 17.704015731811523, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:29,  1.20it/s] 12%|█▎        | 5/40 [00:04<00:28,  1.24it/s]                                              {'loss': 1.5899, 'grad_norm': 15.287628173828125, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:28,  1.24it/s] 15%|█▌        | 6/40 [00:05<00:26,  1.26it/s]                                              {'loss': 2.5132, 'grad_norm': 21.03003692626953, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:26,  1.26it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 1.6933, 'grad_norm': 16.687429428100586, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.30it/s]                                              {'loss': 4.3698, 'grad_norm': 75.45713806152344, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:24,  1.30it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.66it/s]                                              {'loss': 0.8042, 'grad_norm': 10.402946472167969, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.66it/s] 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s]                                               {'loss': 0.1062, 'grad_norm': 2.2054741382598877, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:19,  1.56it/s] 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s]                                               {'loss': 1.1151, 'grad_norm': 5.705031871795654, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:19,  1.49it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s]                                               {'loss': 0.9231, 'grad_norm': 8.412520408630371, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s]                                               {'loss': 1.1985, 'grad_norm': 11.523808479309082, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s]                                               {'loss': 0.8525, 'grad_norm': 11.164711952209473, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:18,  1.39it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.37it/s]                                               {'loss': 1.9522, 'grad_norm': 10.713531494140625, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.37it/s]                                               {'loss': 0.3541, 'grad_norm': 17.25811195373535, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.37it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.69it/s]                                               {'loss': 0.2144, 'grad_norm': 3.2450666427612305, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.69it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s]                                               {'loss': 0.3377, 'grad_norm': 5.575268268585205, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s]                                               {'loss': 0.4311, 'grad_norm': 6.0931596755981445, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.8099, 'grad_norm': 2.5289759635925293, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.43it/s]                                               {'loss': 0.2844, 'grad_norm': 4.277065277099609, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.43it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s]                                               {'loss': 0.6552, 'grad_norm': 1.8504277467727661, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.40it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 0.2495, 'grad_norm': 6.74209451675415, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.38it/s]                                               {'loss': 1.1462, 'grad_norm': 40.8366584777832, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.38it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.70it/s]                                               {'loss': 0.6862, 'grad_norm': 2.576321601867676, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.70it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.59it/s]                                               {'loss': 0.1843, 'grad_norm': 3.2388482093811035, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.59it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.51it/s]                                               {'loss': 0.3481, 'grad_norm': 6.798259258270264, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.51it/s] 70%|███████   | 28/40 [00:19<00:08,  1.46it/s]                                               {'loss': 0.2868, 'grad_norm': 7.536497116088867, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.46it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s]                                               {'loss': 0.2507, 'grad_norm': 4.710975646972656, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.42it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s]                                               {'loss': 0.1233, 'grad_norm': 2.2835476398468018, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.40it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.37it/s]                                               {'loss': 0.6507, 'grad_norm': 1.603217601776123, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.37it/s]                                               {'loss': 0.0032, 'grad_norm': 0.16879424452781677, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.37it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s]                                               {'loss': 0.1206, 'grad_norm': 1.8850350379943848, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.70it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s]                                               {'loss': 0.6244, 'grad_norm': 3.2735390663146973, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.58it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.52it/s]                                               {'loss': 0.1793, 'grad_norm': 4.783080101013184, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.52it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.46it/s]                                               {'loss': 0.0951, 'grad_norm': 1.9019782543182373, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.46it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s]                                               {'loss': 0.0708, 'grad_norm': 2.954336643218994, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s]                                               {'loss': 0.6585, 'grad_norm': 1.6630656719207764, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.39it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0877, 'grad_norm': 1.7864619493484497, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.37it/s]                                               {'loss': 0.0673, 'grad_norm': 3.795475721359253, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]                                               {'train_runtime': 27.5904, 'train_samples_per_second': 20.478, 'train_steps_per_second': 1.45, 'train_loss': 0.8361491305986419, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.37it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
CLIENT:97
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.34it/s]                                              {'loss': 2.6768, 'grad_norm': 10.8125, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.34it/s]  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]                                              {'loss': 2.2477, 'grad_norm': 15.218111991882324, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]  8%|▊         | 3/40 [00:02<00:27,  1.34it/s]                                              {'loss': 1.8797, 'grad_norm': 18.3906192779541, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.34it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 1.3307, 'grad_norm': 16.112184524536133, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s]                                              {'loss': 2.1133, 'grad_norm': 15.610799789428711, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.33it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s]                                              {'loss': 2.5598, 'grad_norm': 19.007953643798828, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.32it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 2.3037, 'grad_norm': 20.525644302368164, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.33it/s]                                              {'loss': 1.1171, 'grad_norm': 58.40910339355469, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:24,  1.33it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s]                                              {'loss': 0.8826, 'grad_norm': 14.899433135986328, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.58it/s]                                               {'loss': 1.8203, 'grad_norm': 12.104995727539062, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:19,  1.58it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s]                                               {'loss': 0.9326, 'grad_norm': 3.7841262817382812, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.50it/s] 30%|███       | 12/40 [00:08<00:19,  1.45it/s]                                               {'loss': 0.8629, 'grad_norm': 6.855730056762695, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.45it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s]                                               {'loss': 1.0986, 'grad_norm': 6.701009750366211, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.41it/s] 35%|███▌      | 14/40 [00:09<00:18,  1.39it/s]                                               {'loss': 1.2159, 'grad_norm': 7.088249206542969, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:18,  1.39it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.37it/s]                                               {'loss': 0.7381, 'grad_norm': 8.752033233642578, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.37it/s]                                               {'loss': 0.3331, 'grad_norm': 10.003165245056152, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.37it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.69it/s]                                               {'loss': 0.8696, 'grad_norm': 12.881299018859863, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.69it/s] 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s]                                               {'loss': 0.5688, 'grad_norm': 7.070046424865723, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:13,  1.58it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s]                                               {'loss': 0.7188, 'grad_norm': 9.30360221862793, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.51it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s]                                               {'loss': 0.3815, 'grad_norm': 4.73538064956665, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.42it/s]                                               {'loss': 0.8695, 'grad_norm': 5.422970294952393, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.42it/s] 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s]                                               {'loss': 0.7899, 'grad_norm': 4.069146156311035, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:13,  1.38it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 0.2288, 'grad_norm': 3.76275372505188, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.36it/s]                                               {'loss': 3.1056, 'grad_norm': 1.0038448572158813, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.36it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.68it/s]                                               {'loss': 0.5515, 'grad_norm': 4.321878910064697, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.68it/s] 65%|██████▌   | 26/40 [00:17<00:07,  1.87it/s]                                               {'loss': 0.4665, 'grad_norm': 4.8841352462768555, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:07,  1.87it/s] 68%|██████▊   | 27/40 [00:17<00:06,  2.06it/s]                                               {'loss': 1.0483, 'grad_norm': 7.628683090209961, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:06,  2.06it/s] 70%|███████   | 28/40 [00:17<00:05,  2.22it/s]                                               {'loss': 0.6638, 'grad_norm': 2.5686683654785156, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:05,  2.22it/s] 72%|███████▎  | 29/40 [00:18<00:04,  2.36it/s]                                               {'loss': 0.2445, 'grad_norm': 3.482012987136841, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:04,  2.36it/s] 75%|███████▌  | 30/40 [00:18<00:04,  2.49it/s]                                               {'loss': 0.2393, 'grad_norm': 3.8288655281066895, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:04,  2.49it/s] 78%|███████▊  | 31/40 [00:19<00:03,  2.51it/s]                                               {'loss': 0.6165, 'grad_norm': 2.486783504486084, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:03,  2.51it/s]                                               {'loss': 0.8308, 'grad_norm': 21.70488929748535, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:03,  2.51it/s] 82%|████████▎ | 33/40 [00:19<00:02,  2.98it/s]                                               {'loss': 0.0499, 'grad_norm': 1.2700819969177246, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:02,  2.98it/s] 85%|████████▌ | 34/40 [00:19<00:02,  2.97it/s]                                               {'loss': 0.6443, 'grad_norm': 5.714762210845947, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:02,  2.97it/s] 88%|████████▊ | 35/40 [00:20<00:02,  2.44it/s]                                               {'loss': 0.1196, 'grad_norm': 3.7770323753356934, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  2.44it/s] 90%|█████████ | 36/40 [00:21<00:01,  2.02it/s]                                               {'loss': 0.2973, 'grad_norm': 2.192416191101074, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:01,  2.02it/s] 92%|█████████▎| 37/40 [00:21<00:01,  1.90it/s]                                               {'loss': 0.1133, 'grad_norm': 2.5011987686157227, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  1.90it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.70it/s]                                               {'loss': 0.154, 'grad_norm': 2.9091646671295166, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.70it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.64it/s]                                               {'loss': 0.8286, 'grad_norm': 2.6525604724884033, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.64it/s]100%|██████████| 40/40 [00:23<00:00,  2.17it/s]                                               {'loss': 0.0154, 'grad_norm': 0.9465213418006897, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.17it/s]                                               {'train_runtime': 23.5906, 'train_samples_per_second': 23.95, 'train_steps_per_second': 1.696, 'train_loss': 0.9632259207777679, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.17it/s]100%|██████████| 40/40 [00:23<00:00,  1.70it/s]
CLIENT:41
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:52,  1.35s/it]                                              {'loss': 2.5618, 'grad_norm': 9.986856460571289, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:52,  1.35s/it]  5%|▌         | 2/40 [00:02<00:37,  1.03it/s]                                              {'loss': 1.0868, 'grad_norm': 9.436199188232422, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.03it/s]  8%|▊         | 3/40 [00:02<00:31,  1.19it/s]                                              {'loss': 1.4338, 'grad_norm': 13.005973815917969, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:31,  1.19it/s] 10%|█         | 4/40 [00:03<00:27,  1.32it/s]                                              {'loss': 1.8394, 'grad_norm': 16.97859001159668, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.32it/s] 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s]                                              {'loss': 1.6437, 'grad_norm': 11.033224105834961, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:26,  1.34it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s]                                              {'loss': 1.3109, 'grad_norm': 13.743285179138184, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.43it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 1.5471, 'grad_norm': 8.759187698364258, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s] 20%|██        | 8/40 [00:05<00:16,  1.95it/s]                                              {'loss': 0.026, 'grad_norm': 1.9938052892684937, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:16,  1.95it/s] 22%|██▎       | 9/40 [00:06<00:17,  1.74it/s]                                              {'loss': 0.6152, 'grad_norm': 9.246569633483887, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:17,  1.74it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.69it/s]                                               {'loss': 0.6658, 'grad_norm': 17.767711639404297, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.69it/s] 28%|██▊       | 11/40 [00:07<00:18,  1.61it/s]                                               {'loss': 1.1528, 'grad_norm': 11.298628807067871, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:18,  1.61it/s] 30%|███       | 12/40 [00:08<00:18,  1.54it/s]                                               {'loss': 0.5946, 'grad_norm': 7.204570770263672, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:18,  1.54it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s]                                               {'loss': 1.6105, 'grad_norm': 15.340188980102539, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s]                                               {'loss': 0.2524, 'grad_norm': 6.348927021026611, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s]                                               {'loss': 0.0521, 'grad_norm': 1.170303463935852, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.50it/s] 40%|████      | 16/40 [00:10<00:11,  2.02it/s]                                               {'loss': 0.0001, 'grad_norm': 0.00663710804656148, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:11,  2.02it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.90it/s]                                               {'loss': 0.3264, 'grad_norm': 5.913705348968506, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.90it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.71it/s]                                               {'loss': 0.6963, 'grad_norm': 1.6687335968017578, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.71it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.68it/s]                                               {'loss': 0.8318, 'grad_norm': 9.173304557800293, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.68it/s] 50%|█████     | 20/40 [00:12<00:12,  1.60it/s]                                               {'loss': 0.1588, 'grad_norm': 2.6182782649993896, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.60it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.55it/s]                                               {'loss': 0.4716, 'grad_norm': 3.120664596557617, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.55it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.58it/s]                                               {'loss': 0.0919, 'grad_norm': 1.6516538858413696, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.58it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.50it/s]                                               {'loss': 0.1342, 'grad_norm': 3.8400115966796875, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:11,  1.50it/s]                                               {'loss': 0.1432, 'grad_norm': 9.567769050598145, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.50it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.86it/s]                                               {'loss': 0.9712, 'grad_norm': 0.47855144739151, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.86it/s] 65%|██████▌   | 26/40 [00:16<00:07,  1.82it/s]                                               {'loss': 0.0093, 'grad_norm': 0.38324132561683655, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:07,  1.82it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.68it/s]                                               {'loss': 0.4168, 'grad_norm': 6.691405296325684, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.68it/s] 70%|███████   | 28/40 [00:17<00:07,  1.62it/s]                                               {'loss': 0.3284, 'grad_norm': 14.382818222045898, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.62it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.60it/s]                                               {'loss': 0.321, 'grad_norm': 3.7512400150299072, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.60it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.58it/s]                                               {'loss': 0.0444, 'grad_norm': 4.007729530334473, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.58it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.60it/s]                                               {'loss': 0.0669, 'grad_norm': 1.3920609951019287, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.60it/s]                                               {'loss': 0.0052, 'grad_norm': 0.26704439520835876, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:04,  1.60it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.92it/s]                                               {'loss': 0.0431, 'grad_norm': 4.611184120178223, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.92it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.78it/s]                                               {'loss': 0.0411, 'grad_norm': 0.7559436559677124, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.78it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.72it/s]                                               {'loss': 0.012, 'grad_norm': 0.29760414361953735, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.72it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.61it/s]                                               {'loss': 0.7893, 'grad_norm': 2.6438162326812744, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.59it/s]                                               {'loss': 0.0425, 'grad_norm': 3.2027971744537354, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.59it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.57it/s]                                               {'loss': 0.279, 'grad_norm': 1.1973477602005005, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.57it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]                                               {'loss': 0.4654, 'grad_norm': 0.6885814666748047, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.52it/s]                                               {'loss': 0.0534, 'grad_norm': 3.2605226039886475, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.52it/s]                                               {'train_runtime': 24.868, 'train_samples_per_second': 22.72, 'train_steps_per_second': 1.608, 'train_loss': 0.5784118564497476, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.52it/s]100%|██████████| 40/40 [00:24<00:00,  1.61it/s]
CLIENT:47
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.86it/s]                                              {'loss': 2.6771, 'grad_norm': 14.119754791259766, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.86it/s]  5%|▌         | 2/40 [00:00<00:13,  2.87it/s]                                              {'loss': 1.4057, 'grad_norm': 13.361870765686035, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.87it/s]  8%|▊         | 3/40 [00:01<00:12,  2.90it/s]                                              {'loss': 2.0187, 'grad_norm': 17.635066986083984, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.90it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 1.5583, 'grad_norm': 13.166512489318848, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s]                                              {'loss': 2.1554, 'grad_norm': 13.8589448928833, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s] 15%|█▌        | 6/40 [00:02<00:17,  2.00it/s]                                              {'loss': 2.846, 'grad_norm': 25.533756256103516, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:17,  2.00it/s] 18%|█▊        | 7/40 [00:03<00:17,  1.94it/s]                                              {'loss': 1.8983, 'grad_norm': 17.773523330688477, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:17,  1.94it/s]                                              {'loss': 0.0632, 'grad_norm': 4.89541482925415, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:16,  1.94it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.21it/s]                                              {'loss': 0.8374, 'grad_norm': 8.58653736114502, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.21it/s] 25%|██▌       | 10/40 [00:04<00:14,  2.03it/s]                                               {'loss': 0.8992, 'grad_norm': 16.48398780822754, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:14,  2.03it/s] 28%|██▊       | 11/40 [00:05<00:16,  1.79it/s]                                               {'loss': 0.8464, 'grad_norm': 13.102311134338379, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:16,  1.79it/s] 30%|███       | 12/40 [00:06<00:16,  1.71it/s]                                               {'loss': 0.8966, 'grad_norm': 8.93118667602539, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:16,  1.71it/s] 32%|███▎      | 13/40 [00:06<00:16,  1.65it/s]                                               {'loss': 0.6697, 'grad_norm': 6.885800361633301, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.65it/s] 35%|███▌      | 14/40 [00:07<00:16,  1.57it/s]                                               {'loss': 1.0698, 'grad_norm': 8.958111763000488, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:16,  1.57it/s] 38%|███▊      | 15/40 [00:08<00:15,  1.58it/s]                                               {'loss': 0.4559, 'grad_norm': 6.346277713775635, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:15,  1.58it/s]                                               {'loss': 0.1093, 'grad_norm': 8.589048385620117, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:15,  1.58it/s] 42%|████▎     | 17/40 [00:08<00:11,  1.94it/s]                                               {'loss': 0.5213, 'grad_norm': 6.831675052642822, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:11,  1.94it/s] 45%|████▌     | 18/40 [00:09<00:11,  1.90it/s]                                               {'loss': 0.4369, 'grad_norm': 5.753988265991211, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:11,  1.90it/s] 48%|████▊     | 19/40 [00:10<00:11,  1.76it/s]                                               {'loss': 0.2779, 'grad_norm': 4.0813374519348145, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:11,  1.76it/s] 50%|█████     | 20/40 [00:10<00:12,  1.63it/s]                                               {'loss': 0.5498, 'grad_norm': 11.36318588256836, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:12,  1.63it/s] 52%|█████▎    | 21/40 [00:11<00:11,  1.64it/s]                                               {'loss': 0.5448, 'grad_norm': 8.900500297546387, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:11,  1.64it/s] 55%|█████▌    | 22/40 [00:12<00:11,  1.55it/s]                                               {'loss': 0.454, 'grad_norm': 7.658041954040527, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:11,  1.55it/s] 57%|█████▊    | 23/40 [00:12<00:11,  1.52it/s]                                               {'loss': 0.2722, 'grad_norm': 3.597893476486206, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:11,  1.52it/s]                                               {'loss': 0.0184, 'grad_norm': 1.1674530506134033, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:10,  1.52it/s] 62%|██████▎   | 25/40 [00:13<00:07,  1.94it/s]                                               {'loss': 0.0833, 'grad_norm': 1.6228231191635132, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:07,  1.94it/s] 65%|██████▌   | 26/40 [00:14<00:07,  1.78it/s]                                               {'loss': 0.1438, 'grad_norm': 2.115830898284912, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:07,  1.78it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.69it/s]                                               {'loss': 0.3061, 'grad_norm': 2.7362730503082275, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.69it/s] 70%|███████   | 28/40 [00:15<00:07,  1.67it/s]                                               {'loss': 0.1323, 'grad_norm': 3.2247400283813477, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.67it/s] 72%|███████▎  | 29/40 [00:16<00:06,  1.57it/s]                                               {'loss': 0.1419, 'grad_norm': 2.8644402027130127, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:06,  1.57it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.62it/s]                                               {'loss': 0.1778, 'grad_norm': 3.6226699352264404, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.62it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.54it/s]                                               {'loss': 0.064, 'grad_norm': 1.0645850896835327, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.54it/s]                                               {'loss': 0.0702, 'grad_norm': 2.1098828315734863, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.54it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.87it/s]                                               {'loss': 0.0546, 'grad_norm': 1.173291802406311, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.87it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.81it/s]                                               {'loss': 0.311, 'grad_norm': 6.107031345367432, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.81it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.69it/s]                                               {'loss': 0.0716, 'grad_norm': 2.357861280441284, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.69it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.61it/s]                                               {'loss': 0.0683, 'grad_norm': 1.7980667352676392, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.63it/s]                                               {'loss': 0.241, 'grad_norm': 1.3871376514434814, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.63it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.53it/s]                                               {'loss': 0.0325, 'grad_norm': 1.2778279781341553, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.53it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.52it/s]                                               {'loss': 0.0385, 'grad_norm': 0.9515399932861328, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.52it/s]100%|██████████| 40/40 [00:22<00:00,  2.02it/s]                                               {'loss': 0.1209, 'grad_norm': 5.804643630981445, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.02it/s]                                               {'train_runtime': 22.6911, 'train_samples_per_second': 24.9, 'train_steps_per_second': 1.763, 'train_loss': 0.6385072704404593, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.02it/s]100%|██████████| 40/40 [00:22<00:00,  1.76it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<01:17,  6.02it/s]  1%|          | 3/471 [00:00<01:42,  4.56it/s]  1%|          | 4/471 [00:01<02:17,  3.41it/s]  1%|          | 5/471 [00:01<02:26,  3.17it/s]  1%|▏         | 6/471 [00:01<02:25,  3.19it/s]  1%|▏         | 7/471 [00:02<02:37,  2.95it/s]  2%|▏         | 8/471 [00:02<02:44,  2.82it/s]  2%|▏         | 9/471 [00:02<02:40,  2.88it/s]  2%|▏         | 10/471 [00:03<02:40,  2.88it/s]  2%|▏         | 11/471 [00:03<02:50,  2.70it/s]  3%|▎         | 12/471 [00:03<02:43,  2.81it/s]  3%|▎         | 13/471 [00:04<02:40,  2.86it/s]  3%|▎         | 14/471 [00:04<02:50,  2.69it/s]  3%|▎         | 15/471 [00:05<02:43,  2.79it/s]  3%|▎         | 16/471 [00:05<02:36,  2.90it/s]  4%|▎         | 17/471 [00:05<02:47,  2.72it/s]  4%|▍         | 18/471 [00:06<02:44,  2.75it/s]  4%|▍         | 19/471 [00:06<02:35,  2.91it/s]  4%|▍         | 20/471 [00:06<02:42,  2.77it/s]  4%|▍         | 21/471 [00:07<02:45,  2.73it/s]  5%|▍         | 22/471 [00:07<02:38,  2.82it/s]  5%|▍         | 23/471 [00:07<02:39,  2.81it/s]  5%|▌         | 24/471 [00:08<02:46,  2.69it/s]  5%|▌         | 25/471 [00:08<02:39,  2.80it/s]  6%|▌         | 26/471 [00:08<02:27,  3.02it/s]  6%|▌         | 27/471 [00:09<02:07,  3.48it/s]  6%|▌         | 28/471 [00:09<01:56,  3.82it/s]  6%|▌         | 29/471 [00:09<01:46,  4.14it/s]  6%|▋         | 30/471 [00:09<01:39,  4.42it/s]  7%|▋         | 31/471 [00:09<01:34,  4.65it/s]  7%|▋         | 32/471 [00:10<01:30,  4.84it/s]  7%|▋         | 33/471 [00:10<01:27,  4.99it/s]  7%|▋         | 34/471 [00:10<01:26,  5.04it/s]  7%|▋         | 35/471 [00:10<01:25,  5.09it/s]  8%|▊         | 36/471 [00:10<01:25,  5.09it/s]  8%|▊         | 37/471 [00:10<01:24,  5.11it/s]  8%|▊         | 38/471 [00:11<01:24,  5.11it/s]  8%|▊         | 39/471 [00:11<01:24,  5.10it/s]  8%|▊         | 40/471 [00:11<01:24,  5.13it/s]  9%|▊         | 41/471 [00:11<01:24,  5.08it/s]  9%|▉         | 42/471 [00:11<01:24,  5.08it/s]  9%|▉         | 43/471 [00:12<01:23,  5.14it/s]  9%|▉         | 44/471 [00:12<01:22,  5.20it/s] 10%|▉         | 45/471 [00:12<01:21,  5.22it/s] 10%|▉         | 46/471 [00:12<01:21,  5.20it/s] 10%|▉         | 47/471 [00:13<01:35,  4.45it/s] 10%|█         | 48/471 [00:13<01:58,  3.57it/s] 10%|█         | 49/471 [00:13<02:04,  3.39it/s] 11%|█         | 50/471 [00:14<02:06,  3.33it/s] 11%|█         | 51/471 [00:14<02:21,  2.97it/s] 11%|█         | 52/471 [00:14<02:22,  2.94it/s] 11%|█▏        | 53/471 [00:15<02:16,  3.05it/s] 11%|█▏        | 54/471 [00:15<02:26,  2.85it/s] 12%|█▏        | 55/471 [00:15<02:30,  2.77it/s] 12%|█▏        | 56/471 [00:16<02:25,  2.85it/s] 12%|█▏        | 57/471 [00:16<02:25,  2.84it/s] 12%|█▏        | 58/471 [00:17<02:32,  2.70it/s] 13%|█▎        | 59/471 [00:17<02:27,  2.79it/s] 13%|█▎        | 60/471 [00:17<02:24,  2.84it/s] 13%|█▎        | 61/471 [00:18<02:33,  2.66it/s] 13%|█▎        | 62/471 [00:18<02:28,  2.76it/s] 13%|█▎        | 63/471 [00:18<02:18,  2.96it/s] 14%|█▎        | 64/471 [00:19<02:28,  2.73it/s] 14%|█▍        | 65/471 [00:19<02:27,  2.75it/s] 14%|█▍        | 66/471 [00:19<02:20,  2.87it/s] 14%|█▍        | 67/471 [00:20<02:23,  2.82it/s] 14%|█▍        | 68/471 [00:20<02:28,  2.72it/s] 15%|█▍        | 69/471 [00:20<02:22,  2.82it/s] 15%|█▍        | 70/471 [00:21<02:13,  3.00it/s] 15%|█▌        | 71/471 [00:21<02:24,  2.77it/s] 15%|█▌        | 72/471 [00:21<02:24,  2.76it/s] 15%|█▌        | 73/471 [00:22<02:18,  2.88it/s] 16%|█▌        | 74/471 [00:22<02:20,  2.83it/s] 16%|█▌        | 75/471 [00:23<02:26,  2.71it/s] 16%|█▌        | 76/471 [00:23<02:20,  2.80it/s] 16%|█▋        | 77/471 [00:23<02:19,  2.82it/s] 17%|█▋        | 78/471 [00:24<02:26,  2.68it/s] 17%|█▋        | 79/471 [00:24<02:20,  2.78it/s] 17%|█▋        | 80/471 [00:24<02:16,  2.85it/s] 17%|█▋        | 81/471 [00:25<02:25,  2.68it/s] 17%|█▋        | 82/471 [00:25<02:21,  2.75it/s] 18%|█▊        | 83/471 [00:25<02:14,  2.88it/s] 18%|█▊        | 84/471 [00:26<02:23,  2.70it/s] 18%|█▊        | 85/471 [00:26<02:22,  2.71it/s] 18%|█▊        | 86/471 [00:27<02:15,  2.83it/s] 18%|█▊        | 87/471 [00:27<02:19,  2.74it/s] 19%|█▊        | 88/471 [00:27<02:21,  2.70it/s] 19%|█▉        | 89/471 [00:28<02:16,  2.80it/s] 19%|█▉        | 90/471 [00:28<02:15,  2.81it/s] 19%|█▉        | 91/471 [00:28<02:21,  2.68it/s] 20%|█▉        | 92/471 [00:29<02:15,  2.79it/s] 20%|█▉        | 93/471 [00:29<02:06,  2.99it/s] 20%|█▉        | 94/471 [00:29<02:15,  2.78it/s] 20%|██        | 95/471 [00:30<02:16,  2.75it/s] 20%|██        | 96/471 [00:30<02:12,  2.84it/s] 21%|██        | 97/471 [00:30<02:13,  2.81it/s] 21%|██        | 98/471 [00:31<02:18,  2.69it/s] 21%|██        | 99/471 [00:31<02:12,  2.80it/s] 21%|██        | 100/471 [00:32<02:10,  2.84it/s] 21%|██▏       | 101/471 [00:32<02:18,  2.68it/s] 22%|██▏       | 102/471 [00:32<02:12,  2.77it/s] 22%|██▏       | 103/471 [00:33<02:08,  2.86it/s] 22%|██▏       | 104/471 [00:33<02:17,  2.68it/s] 22%|██▏       | 105/471 [00:33<02:13,  2.75it/s] 23%|██▎       | 106/471 [00:34<02:05,  2.90it/s] 23%|██▎       | 107/471 [00:34<02:13,  2.73it/s] 23%|██▎       | 108/471 [00:34<02:13,  2.72it/s] 23%|██▎       | 109/471 [00:35<02:07,  2.84it/s] 23%|██▎       | 110/471 [00:35<02:11,  2.75it/s] 24%|██▎       | 111/471 [00:36<02:13,  2.69it/s] 24%|██▍       | 112/471 [00:36<02:08,  2.79it/s] 24%|██▍       | 113/471 [00:36<02:07,  2.80it/s] 24%|██▍       | 114/471 [00:37<02:14,  2.66it/s] 24%|██▍       | 115/471 [00:37<02:08,  2.77it/s] 25%|██▍       | 116/471 [00:37<01:59,  2.96it/s] 25%|██▍       | 117/471 [00:38<02:07,  2.77it/s] 25%|██▌       | 118/471 [00:38<02:08,  2.75it/s] 25%|██▌       | 119/471 [00:38<02:03,  2.85it/s] 25%|██▌       | 120/471 [00:39<02:04,  2.81it/s] 26%|██▌       | 121/471 [00:39<02:09,  2.71it/s] 26%|██▌       | 122/471 [00:39<02:04,  2.81it/s] 26%|██▌       | 123/471 [00:40<02:01,  2.86it/s] 26%|██▋       | 124/471 [00:40<02:09,  2.69it/s] 27%|██▋       | 125/471 [00:41<02:04,  2.79it/s] 27%|██▋       | 126/471 [00:41<01:59,  2.89it/s] 27%|██▋       | 127/471 [00:41<02:07,  2.70it/s] 27%|██▋       | 128/471 [00:42<02:04,  2.75it/s] 27%|██▋       | 129/471 [00:42<01:58,  2.89it/s] 28%|██▊       | 130/471 [00:42<02:05,  2.72it/s] 28%|██▊       | 131/471 [00:43<02:05,  2.70it/s] 28%|██▊       | 132/471 [00:43<02:01,  2.80it/s] 28%|██▊       | 133/471 [00:43<02:00,  2.80it/s] 28%|██▊       | 134/471 [00:44<02:05,  2.69it/s] 29%|██▊       | 135/471 [00:44<02:00,  2.80it/s] 29%|██▉       | 136/471 [00:45<01:57,  2.84it/s] 29%|██▉       | 137/471 [00:45<02:04,  2.68it/s] 29%|██▉       | 138/471 [00:45<02:00,  2.77it/s] 30%|██▉       | 139/471 [00:46<01:54,  2.90it/s] 30%|██▉       | 140/471 [00:46<01:56,  2.83it/s] 30%|██▉       | 141/471 [00:46<02:00,  2.74it/s] 30%|███       | 142/471 [00:47<01:56,  2.82it/s] 30%|███       | 143/471 [00:47<01:55,  2.84it/s] 31%|███       | 144/471 [00:47<02:02,  2.67it/s] 31%|███       | 145/471 [00:48<01:57,  2.77it/s] 31%|███       | 146/471 [00:48<01:53,  2.86it/s] 31%|███       | 147/471 [00:49<02:01,  2.68it/s] 31%|███▏      | 148/471 [00:49<01:57,  2.74it/s] 32%|███▏      | 149/471 [00:49<01:51,  2.89it/s] 32%|███▏      | 150/471 [00:50<01:58,  2.72it/s] 32%|███▏      | 151/471 [00:50<01:58,  2.71it/s] 32%|███▏      | 152/471 [00:50<01:53,  2.81it/s] 32%|███▏      | 153/471 [00:51<01:53,  2.79it/s] 33%|███▎      | 154/471 [00:51<01:57,  2.70it/s] 33%|███▎      | 155/471 [00:51<01:52,  2.80it/s] 33%|███▎      | 156/471 [00:52<01:50,  2.85it/s] 33%|███▎      | 157/471 [00:52<01:57,  2.68it/s] 34%|███▎      | 158/471 [00:52<01:52,  2.79it/s] 34%|███▍      | 159/471 [00:53<01:48,  2.88it/s] 34%|███▍      | 160/471 [00:53<01:55,  2.69it/s] 34%|███▍      | 161/471 [00:54<01:52,  2.76it/s] 34%|███▍      | 162/471 [00:54<01:46,  2.90it/s] 35%|███▍      | 163/471 [00:54<01:33,  3.30it/s] 35%|███▍      | 164/471 [00:54<01:23,  3.69it/s] 35%|███▌      | 165/471 [00:54<01:15,  4.03it/s] 35%|███▌      | 166/471 [00:55<01:10,  4.31it/s] 35%|███▌      | 167/471 [00:55<01:06,  4.56it/s] 36%|███▌      | 168/471 [00:55<01:03,  4.74it/s] 36%|███▌      | 169/471 [00:55<01:01,  4.88it/s] 36%|███▌      | 170/471 [00:55<01:00,  4.97it/s] 36%|███▋      | 171/471 [00:56<00:59,  5.02it/s] 37%|███▋      | 172/471 [00:56<00:58,  5.09it/s] 37%|███▋      | 173/471 [00:56<00:58,  5.13it/s] 37%|███▋      | 174/471 [00:56<00:57,  5.16it/s] 37%|███▋      | 175/471 [00:56<00:57,  5.18it/s] 37%|███▋      | 176/471 [00:57<00:56,  5.19it/s] 38%|███▊      | 177/471 [00:57<00:56,  5.18it/s] 38%|███▊      | 178/471 [00:57<00:56,  5.21it/s] 38%|███▊      | 179/471 [00:57<00:56,  5.21it/s] 38%|███▊      | 180/471 [00:57<00:55,  5.24it/s] 38%|███▊      | 181/471 [00:58<00:55,  5.24it/s] 39%|███▊      | 182/471 [00:58<00:55,  5.23it/s] 39%|███▉      | 183/471 [00:58<00:55,  5.20it/s] 39%|███▉      | 184/471 [00:58<00:54,  5.23it/s] 39%|███▉      | 185/471 [00:58<00:54,  5.23it/s] 39%|███▉      | 186/471 [00:58<00:54,  5.23it/s] 40%|███▉      | 187/471 [00:59<00:54,  5.23it/s] 40%|███▉      | 188/471 [00:59<00:54,  5.21it/s] 40%|████      | 189/471 [00:59<00:54,  5.21it/s] 40%|████      | 190/471 [00:59<00:54,  5.20it/s] 41%|████      | 191/471 [00:59<00:53,  5.19it/s] 41%|████      | 192/471 [01:00<00:53,  5.18it/s] 41%|████      | 193/471 [01:00<00:53,  5.22it/s] 41%|████      | 194/471 [01:00<00:53,  5.22it/s] 41%|████▏     | 195/471 [01:00<00:52,  5.23it/s] 42%|████▏     | 196/471 [01:00<00:52,  5.22it/s] 42%|████▏     | 197/471 [01:01<00:52,  5.21it/s] 42%|████▏     | 198/471 [01:01<00:52,  5.24it/s] 42%|████▏     | 199/471 [01:01<00:51,  5.24it/s] 42%|████▏     | 200/471 [01:01<00:51,  5.24it/s] 43%|████▎     | 201/471 [01:01<00:51,  5.23it/s] 43%|████▎     | 202/471 [01:02<00:51,  5.21it/s] 43%|████▎     | 203/471 [01:02<00:51,  5.22it/s] 43%|████▎     | 204/471 [01:02<00:51,  5.23it/s] 44%|████▎     | 205/471 [01:02<00:50,  5.23it/s] 44%|████▎     | 206/471 [01:02<00:50,  5.25it/s] 44%|████▍     | 207/471 [01:02<00:50,  5.23it/s] 44%|████▍     | 208/471 [01:03<00:50,  5.25it/s] 44%|████▍     | 209/471 [01:03<00:49,  5.26it/s] 45%|████▍     | 210/471 [01:03<00:49,  5.26it/s] 45%|████▍     | 211/471 [01:03<00:49,  5.25it/s] 45%|████▌     | 212/471 [01:03<00:49,  5.24it/s] 45%|████▌     | 213/471 [01:04<00:49,  5.23it/s] 45%|████▌     | 214/471 [01:04<00:49,  5.23it/s] 46%|████▌     | 215/471 [01:04<00:49,  5.22it/s] 46%|████▌     | 216/471 [01:04<00:48,  5.23it/s] 46%|████▌     | 217/471 [01:04<00:48,  5.22it/s] 46%|████▋     | 218/471 [01:05<00:48,  5.21it/s] 46%|████▋     | 219/471 [01:05<00:48,  5.18it/s] 47%|████▋     | 220/471 [01:05<00:48,  5.15it/s] 47%|████▋     | 221/471 [01:05<00:48,  5.12it/s] 47%|████▋     | 222/471 [01:05<00:48,  5.15it/s] 47%|████▋     | 223/471 [01:06<00:48,  5.12it/s] 48%|████▊     | 224/471 [01:06<00:48,  5.14it/s] 48%|████▊     | 225/471 [01:06<00:47,  5.15it/s] 48%|████▊     | 226/471 [01:06<00:47,  5.15it/s] 48%|████▊     | 227/471 [01:06<00:47,  5.16it/s] 48%|████▊     | 228/471 [01:07<00:48,  5.01it/s] 49%|████▊     | 229/471 [01:07<00:53,  4.51it/s] 49%|████▉     | 230/471 [01:07<00:51,  4.69it/s] 49%|████▉     | 231/471 [01:07<00:50,  4.76it/s] 49%|████▉     | 232/471 [01:07<00:48,  4.92it/s] 49%|████▉     | 233/471 [01:08<00:53,  4.48it/s] 50%|████▉     | 234/471 [01:08<01:04,  3.67it/s] 50%|████▉     | 235/471 [01:08<01:07,  3.47it/s] 50%|█████     | 236/471 [01:09<01:10,  3.31it/s] 50%|█████     | 237/471 [01:09<01:19,  2.96it/s] 51%|█████     | 238/471 [01:09<01:18,  2.98it/s] 51%|█████     | 239/471 [01:10<01:16,  3.03it/s] 51%|█████     | 240/471 [01:10<01:23,  2.78it/s] 51%|█████     | 241/471 [01:11<01:22,  2.80it/s] 51%|█████▏    | 242/471 [01:11<01:17,  2.96it/s] 52%|█████▏    | 243/471 [01:11<01:21,  2.80it/s] 52%|█████▏    | 244/471 [01:12<01:23,  2.73it/s] 52%|█████▏    | 245/471 [01:12<01:20,  2.81it/s] 52%|█████▏    | 246/471 [01:12<01:19,  2.82it/s] 52%|█████▏    | 247/471 [01:13<01:23,  2.69it/s] 53%|█████▎    | 248/471 [01:13<01:19,  2.80it/s] 53%|█████▎    | 249/471 [01:13<01:17,  2.86it/s] 53%|█████▎    | 250/471 [01:14<01:22,  2.68it/s] 53%|█████▎    | 251/471 [01:14<01:19,  2.77it/s] 54%|█████▎    | 252/471 [01:14<01:16,  2.87it/s] 54%|█████▎    | 253/471 [01:15<01:20,  2.70it/s] 54%|█████▍    | 254/471 [01:15<01:19,  2.73it/s] 54%|█████▍    | 255/471 [01:16<01:15,  2.86it/s] 54%|█████▍    | 256/471 [01:16<01:13,  2.91it/s] 55%|█████▍    | 257/471 [01:16<01:18,  2.72it/s] 55%|█████▍    | 258/471 [01:17<01:15,  2.81it/s] 55%|█████▍    | 259/471 [01:17<01:12,  2.91it/s] 55%|█████▌    | 260/471 [01:17<01:17,  2.72it/s] 55%|█████▌    | 261/471 [01:18<01:16,  2.75it/s] 56%|█████▌    | 262/471 [01:18<01:12,  2.88it/s] 56%|█████▌    | 263/471 [01:18<01:15,  2.77it/s] 56%|█████▌    | 264/471 [01:19<01:16,  2.71it/s] 56%|█████▋    | 265/471 [01:19<01:13,  2.79it/s] 56%|█████▋    | 266/471 [01:20<01:13,  2.81it/s] 57%|█████▋    | 267/471 [01:20<01:16,  2.67it/s] 57%|█████▋    | 268/471 [01:20<01:12,  2.78it/s] 57%|█████▋    | 269/471 [01:21<01:10,  2.87it/s] 57%|█████▋    | 270/471 [01:21<01:14,  2.69it/s] 58%|█████▊    | 271/471 [01:21<01:12,  2.77it/s] 58%|█████▊    | 272/471 [01:22<01:08,  2.89it/s] 58%|█████▊    | 273/471 [01:22<01:12,  2.72it/s] 58%|█████▊    | 274/471 [01:22<01:11,  2.74it/s] 58%|█████▊    | 275/471 [01:23<01:08,  2.86it/s] 59%|█████▊    | 276/471 [01:23<01:10,  2.76it/s] 59%|█████▉    | 277/471 [01:24<01:11,  2.70it/s] 59%|█████▉    | 278/471 [01:24<01:09,  2.79it/s] 59%|█████▉    | 279/471 [01:24<01:05,  2.93it/s] 59%|█████▉    | 280/471 [01:25<01:10,  2.73it/s] 60%|█████▉    | 281/471 [01:25<01:08,  2.77it/s] 60%|█████▉    | 282/471 [01:25<01:04,  2.91it/s] 60%|██████    | 283/471 [01:26<01:08,  2.73it/s] 60%|██████    | 284/471 [01:26<01:09,  2.71it/s] 61%|██████    | 285/471 [01:26<01:06,  2.80it/s] 61%|██████    | 286/471 [01:27<01:06,  2.79it/s] 61%|██████    | 287/471 [01:27<01:08,  2.68it/s] 61%|██████    | 288/471 [01:27<01:05,  2.78it/s] 61%|██████▏   | 289/471 [01:28<01:04,  2.84it/s] 62%|██████▏   | 290/471 [01:28<01:07,  2.67it/s] 62%|██████▏   | 291/471 [01:29<01:05,  2.76it/s] 62%|██████▏   | 292/471 [01:29<01:02,  2.88it/s] 62%|██████▏   | 293/471 [01:29<01:05,  2.71it/s] 62%|██████▏   | 294/471 [01:30<01:04,  2.75it/s] 63%|██████▎   | 295/471 [01:30<01:00,  2.92it/s] 63%|██████▎   | 296/471 [01:30<01:03,  2.75it/s] 63%|██████▎   | 297/471 [01:31<01:04,  2.71it/s] 63%|██████▎   | 298/471 [01:31<01:01,  2.81it/s] 63%|██████▎   | 299/471 [01:31<01:01,  2.78it/s] 64%|██████▎   | 300/471 [01:32<01:03,  2.68it/s] 64%|██████▍   | 301/471 [01:32<01:01,  2.78it/s] 64%|██████▍   | 302/471 [01:32<00:57,  2.94it/s] 64%|██████▍   | 303/471 [01:33<01:01,  2.75it/s] 65%|██████▍   | 304/471 [01:33<01:00,  2.76it/s] 65%|██████▍   | 305/471 [01:34<00:57,  2.88it/s] 65%|██████▍   | 306/471 [01:34<00:58,  2.82it/s] 65%|██████▌   | 307/471 [01:34<01:00,  2.72it/s] 65%|██████▌   | 308/471 [01:35<00:58,  2.81it/s] 66%|██████▌   | 309/471 [01:35<00:56,  2.85it/s] 66%|██████▌   | 310/471 [01:35<00:59,  2.69it/s] 66%|██████▌   | 311/471 [01:36<00:57,  2.79it/s] 66%|██████▌   | 312/471 [01:36<00:55,  2.87it/s] 66%|██████▋   | 313/471 [01:36<00:58,  2.69it/s] 67%|██████▋   | 314/471 [01:37<00:56,  2.76it/s] 67%|██████▋   | 315/471 [01:37<00:53,  2.89it/s] 67%|██████▋   | 316/471 [01:38<00:57,  2.71it/s] 67%|██████▋   | 317/471 [01:38<00:56,  2.71it/s] 68%|██████▊   | 318/471 [01:38<00:54,  2.81it/s] 68%|██████▊   | 319/471 [01:39<00:54,  2.78it/s] 68%|██████▊   | 320/471 [01:39<00:55,  2.70it/s] 68%|██████▊   | 321/471 [01:39<00:53,  2.79it/s] 68%|██████▊   | 322/471 [01:40<00:52,  2.82it/s] 69%|██████▊   | 323/471 [01:40<00:55,  2.67it/s] 69%|██████▉   | 324/471 [01:40<00:53,  2.76it/s] 69%|██████▉   | 325/471 [01:41<00:49,  2.93it/s] 69%|██████▉   | 326/471 [01:41<00:51,  2.80it/s] 69%|██████▉   | 327/471 [01:42<00:52,  2.74it/s] 70%|██████▉   | 328/471 [01:42<00:50,  2.82it/s] 70%|██████▉   | 329/471 [01:42<00:50,  2.83it/s] 70%|███████   | 330/471 [01:43<00:52,  2.69it/s] 70%|███████   | 331/471 [01:43<00:50,  2.79it/s] 70%|███████   | 332/471 [01:43<00:48,  2.84it/s] 71%|███████   | 333/471 [01:44<00:51,  2.66it/s] 71%|███████   | 334/471 [01:44<00:49,  2.77it/s] 71%|███████   | 335/471 [01:44<00:47,  2.88it/s] 71%|███████▏  | 336/471 [01:45<00:50,  2.70it/s] 72%|███████▏  | 337/471 [01:45<00:48,  2.74it/s] 72%|███████▏  | 338/471 [01:45<00:46,  2.89it/s] 72%|███████▏  | 339/471 [01:46<00:48,  2.75it/s] 72%|███████▏  | 340/471 [01:46<00:48,  2.71it/s] 72%|███████▏  | 341/471 [01:47<00:46,  2.81it/s] 73%|███████▎  | 342/471 [01:47<00:45,  2.82it/s] 73%|███████▎  | 343/471 [01:47<00:47,  2.68it/s] 73%|███████▎  | 344/471 [01:48<00:45,  2.79it/s] 73%|███████▎  | 345/471 [01:48<00:44,  2.84it/s] 73%|███████▎  | 346/471 [01:48<00:46,  2.67it/s] 74%|███████▎  | 347/471 [01:49<00:44,  2.77it/s] 74%|███████▍  | 348/471 [01:49<00:42,  2.89it/s] 74%|███████▍  | 349/471 [01:49<00:36,  3.34it/s] 74%|███████▍  | 350/471 [01:49<00:32,  3.70it/s] 75%|███████▍  | 351/471 [01:50<00:29,  4.06it/s] 75%|███████▍  | 352/471 [01:50<00:27,  4.35it/s] 75%|███████▍  | 353/471 [01:50<00:25,  4.59it/s] 75%|███████▌  | 354/471 [01:50<00:24,  4.79it/s] 75%|███████▌  | 355/471 [01:50<00:23,  4.88it/s] 76%|███████▌  | 356/471 [01:51<00:23,  4.95it/s] 76%|███████▌  | 357/471 [01:51<00:22,  5.04it/s] 76%|███████▌  | 358/471 [01:51<00:22,  5.11it/s] 76%|███████▌  | 359/471 [01:51<00:21,  5.16it/s] 76%|███████▋  | 360/471 [01:51<00:21,  5.17it/s] 77%|███████▋  | 361/471 [01:52<00:21,  5.12it/s] 77%|███████▋  | 362/471 [01:52<00:21,  5.14it/s] 77%|███████▋  | 363/471 [01:52<00:21,  5.13it/s] 77%|███████▋  | 364/471 [01:52<00:20,  5.14it/s] 77%|███████▋  | 365/471 [01:52<00:20,  5.15it/s] 78%|███████▊  | 366/471 [01:53<00:20,  5.11it/s] 78%|███████▊  | 367/471 [01:53<00:20,  5.14it/s] 78%|███████▊  | 368/471 [01:53<00:19,  5.18it/s] 78%|███████▊  | 369/471 [01:53<00:19,  5.22it/s] 79%|███████▊  | 370/471 [01:53<00:19,  5.24it/s] 79%|███████▉  | 371/471 [01:53<00:19,  5.23it/s] 79%|███████▉  | 372/471 [01:54<00:19,  5.13it/s] 79%|███████▉  | 373/471 [01:54<00:24,  4.04it/s] 79%|███████▉  | 374/471 [01:54<00:28,  3.46it/s] 80%|███████▉  | 375/471 [01:55<00:28,  3.33it/s] 80%|███████▉  | 376/471 [01:55<00:29,  3.20it/s] 80%|████████  | 377/471 [01:56<00:32,  2.90it/s] 80%|████████  | 378/471 [01:56<00:31,  2.95it/s] 80%|████████  | 379/471 [01:56<00:30,  3.00it/s] 81%|████████  | 380/471 [01:57<00:32,  2.77it/s] 81%|████████  | 381/471 [01:57<00:32,  2.79it/s] 81%|████████  | 382/471 [01:57<00:30,  2.93it/s] 81%|████████▏ | 383/471 [01:58<00:32,  2.75it/s] 82%|████████▏ | 384/471 [01:58<00:32,  2.71it/s] 82%|████████▏ | 385/471 [01:58<00:30,  2.80it/s] 82%|████████▏ | 386/471 [01:59<00:30,  2.78it/s] 82%|████████▏ | 387/471 [01:59<00:31,  2.68it/s] 82%|████████▏ | 388/471 [01:59<00:29,  2.78it/s] 83%|████████▎ | 389/471 [02:00<00:29,  2.82it/s] 83%|████████▎ | 390/471 [02:00<00:30,  2.66it/s] 83%|████████▎ | 391/471 [02:01<00:28,  2.76it/s] 83%|████████▎ | 392/471 [02:01<00:27,  2.85it/s] 83%|████████▎ | 393/471 [02:01<00:29,  2.67it/s] 84%|████████▎ | 394/471 [02:02<00:28,  2.73it/s] 84%|████████▍ | 395/471 [02:02<00:26,  2.86it/s] 84%|████████▍ | 396/471 [02:02<00:22,  3.33it/s] 84%|████████▍ | 397/471 [02:02<00:20,  3.69it/s] 85%|████████▍ | 398/471 [02:03<00:18,  4.03it/s] 85%|████████▍ | 399/471 [02:03<00:19,  3.71it/s] 85%|████████▍ | 400/471 [02:03<00:22,  3.21it/s] 85%|████████▌ | 401/471 [02:04<00:22,  3.14it/s] 85%|████████▌ | 402/471 [02:04<00:21,  3.15it/s] 86%|████████▌ | 403/471 [02:04<00:23,  2.87it/s] 86%|████████▌ | 404/471 [02:05<00:23,  2.84it/s] 86%|████████▌ | 405/471 [02:05<00:22,  2.96it/s] 86%|████████▌ | 406/471 [02:05<00:23,  2.82it/s] 86%|████████▋ | 407/471 [02:06<00:23,  2.74it/s] 87%|████████▋ | 408/471 [02:06<00:22,  2.82it/s] 87%|████████▋ | 409/471 [02:06<00:21,  2.83it/s] 87%|████████▋ | 410/471 [02:07<00:22,  2.69it/s] 87%|████████▋ | 411/471 [02:07<00:21,  2.79it/s] 87%|████████▋ | 412/471 [02:08<00:20,  2.84it/s] 88%|████████▊ | 413/471 [02:08<00:21,  2.67it/s] 88%|████████▊ | 414/471 [02:08<00:20,  2.74it/s] 88%|████████▊ | 415/471 [02:09<00:19,  2.90it/s] 88%|████████▊ | 416/471 [02:09<00:20,  2.70it/s] 89%|████████▊ | 417/471 [02:09<00:19,  2.71it/s] 89%|████████▊ | 418/471 [02:10<00:18,  2.83it/s] 89%|████████▉ | 419/471 [02:10<00:18,  2.78it/s] 89%|████████▉ | 420/471 [02:11<00:18,  2.70it/s] 89%|████████▉ | 421/471 [02:11<00:17,  2.80it/s] 90%|████████▉ | 422/471 [02:11<00:16,  2.97it/s] 90%|████████▉ | 423/471 [02:12<00:17,  2.76it/s] 90%|█████████ | 424/471 [02:12<00:17,  2.75it/s] 90%|█████████ | 425/471 [02:12<00:15,  2.88it/s] 90%|█████████ | 426/471 [02:13<00:16,  2.76it/s] 91%|█████████ | 427/471 [02:13<00:16,  2.70it/s] 91%|█████████ | 428/471 [02:13<00:15,  2.79it/s] 91%|█████████ | 429/471 [02:14<00:15,  2.79it/s] 91%|█████████▏| 430/471 [02:14<00:15,  2.67it/s] 92%|█████████▏| 431/471 [02:14<00:14,  2.77it/s] 92%|█████████▏| 432/471 [02:15<00:13,  2.84it/s] 92%|█████████▏| 433/471 [02:15<00:14,  2.67it/s] 92%|█████████▏| 434/471 [02:16<00:13,  2.76it/s] 92%|█████████▏| 435/471 [02:16<00:12,  2.88it/s] 93%|█████████▎| 436/471 [02:16<00:12,  2.71it/s] 93%|█████████▎| 437/471 [02:17<00:12,  2.73it/s] 93%|█████████▎| 438/471 [02:17<00:11,  2.85it/s] 93%|█████████▎| 439/471 [02:17<00:11,  2.76it/s] 93%|█████████▎| 440/471 [02:18<00:11,  2.70it/s] 94%|█████████▎| 441/471 [02:18<00:10,  2.79it/s] 94%|█████████▍| 442/471 [02:18<00:10,  2.80it/s] 94%|█████████▍| 443/471 [02:19<00:10,  2.67it/s] 94%|█████████▍| 444/471 [02:19<00:09,  2.78it/s] 94%|█████████▍| 445/471 [02:19<00:08,  2.97it/s] 95%|█████████▍| 446/471 [02:20<00:09,  2.76it/s] 95%|█████████▍| 447/471 [02:20<00:08,  2.74it/s] 95%|█████████▌| 448/471 [02:21<00:08,  2.83it/s] 95%|█████████▌| 449/471 [02:21<00:07,  2.81it/s] 96%|█████████▌| 450/471 [02:21<00:07,  2.70it/s] 96%|█████████▌| 451/471 [02:22<00:07,  2.81it/s] 96%|█████████▌| 452/471 [02:22<00:06,  2.85it/s] 96%|█████████▌| 453/471 [02:22<00:06,  2.67it/s] 96%|█████████▋| 454/471 [02:23<00:06,  2.76it/s] 97%|█████████▋| 455/471 [02:23<00:05,  2.86it/s] 97%|█████████▋| 456/471 [02:23<00:05,  2.68it/s] 97%|█████████▋| 457/471 [02:24<00:05,  2.73it/s] 97%|█████████▋| 458/471 [02:24<00:04,  2.88it/s] 97%|█████████▋| 459/471 [02:25<00:04,  2.72it/s] 98%|█████████▊| 460/471 [02:25<00:04,  2.70it/s] 98%|█████████▊| 461/471 [02:25<00:03,  2.79it/s] 98%|█████████▊| 462/471 [02:26<00:03,  2.80it/s] 98%|█████████▊| 463/471 [02:26<00:02,  2.69it/s] 99%|█████████▊| 464/471 [02:26<00:02,  2.79it/s] 99%|█████████▊| 465/471 [02:27<00:02,  2.84it/s] 99%|█████████▉| 466/471 [02:27<00:01,  2.66it/s] 99%|█████████▉| 467/471 [02:27<00:01,  2.75it/s] 99%|█████████▉| 468/471 [02:28<00:01,  2.88it/s]100%|█████████▉| 469/471 [02:28<00:00,  2.82it/s]100%|█████████▉| 470/471 [02:29<00:00,  2.73it/s]100%|██████████| 471/471 [02:29<00:00,  3.00it/s]100%|██████████| 471/471 [02:29<00:00,  3.15it/s]
{'eval_loss': 2.1374025344848633, 'eval_model_preparation_time': 0.0053, 'eval_acc': 0.45193839617631437, 'eval_runtime': 149.6821, 'eval_samples_per_second': 50.32, 'eval_steps_per_second': 3.147}
ROUND:18
CLIENT:83
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.84it/s]                                              {'loss': 2.1573, 'grad_norm': 10.798563003540039, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.84it/s]  5%|▌         | 2/40 [00:00<00:13,  2.86it/s]                                              {'loss': 1.3288, 'grad_norm': 10.38604736328125, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.86it/s]  8%|▊         | 3/40 [00:01<00:12,  2.89it/s]                                              {'loss': 2.4267, 'grad_norm': 21.995601654052734, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.89it/s] 10%|█         | 4/40 [00:01<00:16,  2.16it/s]                                              {'loss': 1.7399, 'grad_norm': 19.614988327026367, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.16it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.96it/s]                                              {'loss': 1.6474, 'grad_norm': 17.199552536010742, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.96it/s] 15%|█▌        | 6/40 [00:02<00:17,  1.94it/s]                                              {'loss': 2.248, 'grad_norm': 22.737648010253906, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:17,  1.94it/s] 18%|█▊        | 7/40 [00:03<00:16,  1.97it/s]                                              {'loss': 1.1225, 'grad_norm': 14.707408905029297, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  1.97it/s] 20%|██        | 8/40 [00:03<00:12,  2.64it/s]                                              {'loss': 3.7578, 'grad_norm': 82.32939147949219, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:12,  2.64it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.14it/s]                                              {'loss': 0.7365, 'grad_norm': 11.81696891784668, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.14it/s] 25%|██▌       | 10/40 [00:04<00:15,  1.92it/s]                                               {'loss': 0.9733, 'grad_norm': 6.352364540100098, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:15,  1.92it/s] 28%|██▊       | 11/40 [00:05<00:16,  1.72it/s]                                               {'loss': 0.8403, 'grad_norm': 7.921798229217529, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:16,  1.72it/s] 30%|███       | 12/40 [00:06<00:16,  1.67it/s]                                               {'loss': 1.0109, 'grad_norm': 12.39141845703125, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:16,  1.67it/s] 32%|███▎      | 13/40 [00:06<00:16,  1.59it/s]                                               {'loss': 0.2689, 'grad_norm': 6.053305625915527, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:16,  1.59it/s] 35%|███▌      | 14/40 [00:07<00:17,  1.53it/s]                                               {'loss': 1.119, 'grad_norm': 9.629704475402832, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:17,  1.53it/s] 38%|███▊      | 15/40 [00:08<00:16,  1.56it/s]                                               {'loss': 0.5027, 'grad_norm': 8.973730087280273, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:16,  1.56it/s]                                               {'loss': 0.6098, 'grad_norm': 37.02915573120117, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:15,  1.56it/s] 42%|████▎     | 17/40 [00:08<00:12,  1.89it/s]                                               {'loss': 0.2845, 'grad_norm': 4.7429423332214355, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:09<00:11,  1.98it/s]                                               {'loss': 0.2583, 'grad_norm': 4.924677848815918, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:11,  1.98it/s] 48%|████▊     | 19/40 [00:10<00:11,  1.78it/s]                                               {'loss': 0.5941, 'grad_norm': 6.550842761993408, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:10<00:11,  1.78it/s] 50%|█████     | 20/40 [00:10<00:11,  1.69it/s]                                               {'loss': 0.2016, 'grad_norm': 3.0817203521728516, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:11,  1.69it/s] 52%|█████▎    | 21/40 [00:11<00:11,  1.62it/s]                                               {'loss': 0.6037, 'grad_norm': 6.180452823638916, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:11<00:11,  1.62it/s] 55%|█████▌    | 22/40 [00:12<00:11,  1.54it/s]                                               {'loss': 0.6205, 'grad_norm': 7.178297996520996, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:11,  1.54it/s] 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s]                                               {'loss': 0.8282, 'grad_norm': 9.254487037658691, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:12<00:10,  1.57it/s] 60%|██████    | 24/40 [00:12<00:07,  2.08it/s]                                               {'loss': 0.0544, 'grad_norm': 4.510769367218018, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:07,  2.08it/s] 62%|██████▎   | 25/40 [00:13<00:08,  1.86it/s]                                               {'loss': 0.3897, 'grad_norm': 16.853139877319336, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:08,  1.86it/s] 65%|██████▌   | 26/40 [00:14<00:08,  1.70it/s]                                               {'loss': 0.1243, 'grad_norm': 3.970392942428589, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:08,  1.70it/s] 68%|██████▊   | 27/40 [00:14<00:07,  1.68it/s]                                               {'loss': 0.3514, 'grad_norm': 5.345760822296143, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:07,  1.68it/s] 70%|███████   | 28/40 [00:15<00:07,  1.59it/s]                                               {'loss': 0.277, 'grad_norm': 4.195250034332275, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:07,  1.59it/s] 72%|███████▎  | 29/40 [00:16<00:07,  1.54it/s]                                               {'loss': 0.1169, 'grad_norm': 2.466620445251465, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:07,  1.54it/s] 75%|███████▌  | 30/40 [00:16<00:06,  1.58it/s]                                               {'loss': 0.5634, 'grad_norm': 4.968796253204346, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:06,  1.58it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.53it/s]                                               {'loss': 0.6237, 'grad_norm': 5.478367805480957, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.53it/s]                                               {'loss': 1.5321, 'grad_norm': 105.38383483886719, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:05,  1.53it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.91it/s]                                               {'loss': 0.4415, 'grad_norm': 3.180469512939453, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.78it/s]                                               {'loss': 0.0386, 'grad_norm': 1.0271002054214478, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.78it/s] 88%|████████▊ | 35/40 [00:19<00:03,  1.66it/s]                                               {'loss': 0.0858, 'grad_norm': 1.9691742658615112, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:03,  1.66it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.65it/s]                                               {'loss': 0.0846, 'grad_norm': 2.403643846511841, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.65it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.57it/s]                                               {'loss': 0.1435, 'grad_norm': 5.94857931137085, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.53it/s]                                               {'loss': 0.1611, 'grad_norm': 2.221100330352783, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.53it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.58it/s]                                               {'loss': 0.702, 'grad_norm': 4.740542411804199, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.58it/s]                                               {'loss': 0.0309, 'grad_norm': 2.2933905124664307, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.58it/s]                                               {'train_runtime': 22.6552, 'train_samples_per_second': 24.939, 'train_steps_per_second': 1.766, 'train_loss': 0.7900382661260664, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.58it/s]100%|██████████| 40/40 [00:22<00:00,  1.77it/s]
CLIENT:1
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.93it/s]                                              {'loss': 2.3053, 'grad_norm': 11.68896770477295, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.93it/s]  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]                                              {'loss': 1.6212, 'grad_norm': 8.114154815673828, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.00it/s]  8%|▊         | 3/40 [00:01<00:12,  3.00it/s]                                              {'loss': 2.2206, 'grad_norm': 17.696918487548828, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  3.00it/s] 10%|█         | 4/40 [00:01<00:12,  2.99it/s]                                              {'loss': 1.517, 'grad_norm': 15.81029224395752, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.99it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.98it/s]                                              {'loss': 1.5873, 'grad_norm': 22.504352569580078, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.98it/s] 15%|█▌        | 6/40 [00:02<00:11,  3.00it/s]                                              {'loss': 2.1729, 'grad_norm': 18.312284469604492, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s]                                              {'loss': 1.0956, 'grad_norm': 12.955742835998535, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.96it/s] 20%|██        | 8/40 [00:02<00:09,  3.38it/s]                                              {'loss': 1.4383, 'grad_norm': 79.34782409667969, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.38it/s] 22%|██▎       | 9/40 [00:02<00:09,  3.25it/s]                                              {'loss': 0.3602, 'grad_norm': 4.780166149139404, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:09,  3.25it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.16it/s]                                               {'loss': 0.6317, 'grad_norm': 10.469804763793945, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.16it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.11it/s]                                               {'loss': 0.4303, 'grad_norm': 5.833143711090088, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.11it/s] 30%|███       | 12/40 [00:03<00:09,  3.07it/s]                                               {'loss': 0.7561, 'grad_norm': 8.856950759887695, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:09,  3.07it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.05it/s]                                               {'loss': 0.8547, 'grad_norm': 8.1101713180542, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.05it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.03it/s]                                               {'loss': 1.4245, 'grad_norm': 10.480612754821777, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.03it/s] 38%|███▊      | 15/40 [00:04<00:08,  3.01it/s]                                               {'loss': 0.6743, 'grad_norm': 5.1766791343688965, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  3.01it/s]                                               {'loss': 0.6625, 'grad_norm': 27.449289321899414, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:07,  3.01it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.77it/s]                                               {'loss': 0.5817, 'grad_norm': 5.704301357269287, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.77it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s]                                               {'loss': 0.5228, 'grad_norm': 11.116287231445312, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s] 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s]                                               {'loss': 0.747, 'grad_norm': 5.166071891784668, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:05<00:06,  3.39it/s] 50%|█████     | 20/40 [00:06<00:06,  3.28it/s]                                               {'loss': 0.11, 'grad_norm': 2.797139883041382, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.28it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s]                                               {'loss': 0.076, 'grad_norm': 2.273282289505005, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.18it/s] 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s]                                               {'loss': 0.2381, 'grad_norm': 4.119591236114502, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:06<00:05,  3.10it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.06it/s]                                               {'loss': 0.7262, 'grad_norm': 7.21182107925415, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.06it/s]                                               {'loss': 0.1881, 'grad_norm': 17.629554748535156, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.06it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.76it/s]                                               {'loss': 0.1217, 'grad_norm': 2.7634525299072266, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.76it/s] 65%|██████▌   | 26/40 [00:08<00:03,  3.53it/s]                                               {'loss': 0.0698, 'grad_norm': 1.5475754737854004, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:03,  3.53it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s]                                               {'loss': 0.1353, 'grad_norm': 4.978486061096191, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.36it/s] 70%|███████   | 28/40 [00:08<00:03,  3.24it/s]                                               {'loss': 0.0336, 'grad_norm': 1.0482748746871948, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.24it/s] 72%|███████▎  | 29/40 [00:09<00:03,  3.17it/s]                                               {'loss': 0.7417, 'grad_norm': 6.379153251647949, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:09<00:03,  3.17it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.10it/s]                                               {'loss': 0.7664, 'grad_norm': 5.167428016662598, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.10it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.05it/s]                                               {'loss': 0.4251, 'grad_norm': 6.831713676452637, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.05it/s]                                               {'loss': 0.0082, 'grad_norm': 0.6454825401306152, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.05it/s] 82%|████████▎ | 33/40 [00:10<00:01,  3.76it/s]                                               {'loss': 0.2215, 'grad_norm': 1.7659838199615479, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:10<00:01,  3.76it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s]                                               {'loss': 0.0283, 'grad_norm': 1.5913000106811523, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.51it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s]                                               {'loss': 0.1863, 'grad_norm': 0.9792414903640747, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s] 90%|█████████ | 36/40 [00:11<00:01,  3.23it/s]                                               {'loss': 0.0424, 'grad_norm': 1.2082005739212036, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:11<00:01,  3.23it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.4678, 'grad_norm': 2.073404312133789, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.09it/s]                                               {'loss': 0.0419, 'grad_norm': 0.9587516188621521, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.09it/s] 98%|█████████▊| 39/40 [00:12<00:00,  3.07it/s]                                               {'loss': 0.7243, 'grad_norm': 4.966289043426514, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:12<00:00,  3.07it/s]                                               {'loss': 0.3444, 'grad_norm': 27.997892379760742, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]                                               {'train_runtime': 12.4628, 'train_samples_per_second': 45.335, 'train_steps_per_second': 3.21, 'train_loss': 0.6825217835605144, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.07it/s]100%|██████████| 40/40 [00:12<00:00,  3.21it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.21it/s]                                              {'loss': 2.1081, 'grad_norm': 11.499062538146973, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.21it/s]  5%|▌         | 2/40 [00:00<00:12,  3.11it/s]                                              {'loss': 1.8921, 'grad_norm': 12.67104721069336, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  3.11it/s]  8%|▊         | 3/40 [00:00<00:12,  3.02it/s]                                              {'loss': 0.7269, 'grad_norm': 11.550148010253906, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:12,  3.02it/s] 10%|█         | 4/40 [00:01<00:11,  3.01it/s]                                              {'loss': 0.6422, 'grad_norm': 10.84538459777832, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:11,  3.01it/s] 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s]                                              {'loss': 1.388, 'grad_norm': 13.769306182861328, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:11,  2.99it/s] 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s]                                              {'loss': 0.9508, 'grad_norm': 10.993837356567383, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:11,  3.00it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s]                                              {'loss': 1.9883, 'grad_norm': 18.277849197387695, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.01it/s] 20%|██        | 8/40 [00:02<00:11,  2.71it/s]                                              {'loss': 0.0918, 'grad_norm': 8.199445724487305, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.71it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.81it/s]                                              {'loss': 0.7677, 'grad_norm': 16.739717483520508, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.81it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.85it/s]                                               {'loss': 0.4689, 'grad_norm': 8.609886169433594, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.85it/s] 28%|██▊       | 11/40 [00:03<00:10,  2.89it/s]                                               {'loss': 0.5664, 'grad_norm': 6.405749320983887, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:10,  2.89it/s] 30%|███       | 12/40 [00:04<00:09,  2.94it/s]                                               {'loss': 0.666, 'grad_norm': 5.888152599334717, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.94it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.97it/s]                                               {'loss': 0.4523, 'grad_norm': 2.884124517440796, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.97it/s] 35%|███▌      | 14/40 [00:04<00:08,  2.95it/s]                                               {'loss': 0.3332, 'grad_norm': 5.2193217277526855, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  2.95it/s] 38%|███▊      | 15/40 [00:05<00:08,  3.02it/s]                                               {'loss': 0.9661, 'grad_norm': 7.305467128753662, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  3.02it/s]                                               {'loss': 0.0006, 'grad_norm': 0.062277913093566895, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.02it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s]                                               {'loss': 0.4441, 'grad_norm': 2.194244861602783, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.76it/s] 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s]                                               {'loss': 0.1455, 'grad_norm': 10.903043746948242, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:06,  3.54it/s] 48%|████▊     | 19/40 [00:06<00:06,  3.38it/s]                                               {'loss': 0.2088, 'grad_norm': 4.5314788818359375, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:06,  3.38it/s] 50%|█████     | 20/40 [00:06<00:06,  3.23it/s]                                               {'loss': 0.4902, 'grad_norm': 5.570719242095947, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:06,  3.23it/s] 52%|█████▎    | 21/40 [00:06<00:06,  3.17it/s]                                               {'loss': 0.1584, 'grad_norm': 2.8910815715789795, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:06,  3.17it/s] 55%|█████▌    | 22/40 [00:07<00:05,  3.12it/s]                                               {'loss': 0.4988, 'grad_norm': 4.130267143249512, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:05,  3.12it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.1442, 'grad_norm': 8.034347534179688, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.10it/s]                                               {'loss': 0.0295, 'grad_norm': 0.6605265736579895, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:05,  3.10it/s] 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s]                                               {'loss': 0.0933, 'grad_norm': 1.5092344284057617, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:07<00:03,  3.85it/s] 65%|██████▌   | 26/40 [00:08<00:03,  3.61it/s]                                               {'loss': 0.0268, 'grad_norm': 0.6851776242256165, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:03,  3.61it/s] 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s]                                               {'loss': 0.0667, 'grad_norm': 2.4478507041931152, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  3.42it/s] 70%|███████   | 28/40 [00:08<00:03,  3.30it/s]                                               {'loss': 0.3531, 'grad_norm': 0.8705171346664429, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.30it/s] 72%|███████▎  | 29/40 [00:09<00:03,  3.20it/s]                                               {'loss': 0.0529, 'grad_norm': 1.6914347410202026, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:09<00:03,  3.20it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s]                                               {'loss': 0.2079, 'grad_norm': 6.763788223266602, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.13it/s] 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.3258, 'grad_norm': 2.523942708969116, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:09<00:02,  3.09it/s]                                               {'loss': 0.0084, 'grad_norm': 0.5451204180717468, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:09<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:10<00:01,  3.78it/s]                                               {'loss': 0.0138, 'grad_norm': 0.3375660181045532, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:10<00:01,  3.78it/s] 85%|████████▌ | 34/40 [00:10<00:01,  3.54it/s]                                               {'loss': 0.2867, 'grad_norm': 2.034193992614746, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:10<00:01,  3.54it/s] 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s]                                               {'loss': 0.0461, 'grad_norm': 1.8104875087738037, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:10<00:01,  3.36it/s] 90%|█████████ | 36/40 [00:11<00:01,  3.24it/s]                                               {'loss': 0.0569, 'grad_norm': 1.967236876487732, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:11<00:01,  3.24it/s] 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s]                                               {'loss': 0.0156, 'grad_norm': 0.44378018379211426, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:11<00:00,  3.14it/s] 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s]                                               {'loss': 0.3216, 'grad_norm': 1.8225489854812622, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:11<00:00,  3.10it/s] 98%|█████████▊| 39/40 [00:12<00:00,  3.04it/s]                                               {'loss': 0.0086, 'grad_norm': 0.31696754693984985, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:12<00:00,  3.04it/s]                                               {'loss': 0.0049, 'grad_norm': 0.22390176355838776, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.04it/s]                                               {'train_runtime': 12.5604, 'train_samples_per_second': 44.983, 'train_steps_per_second': 3.185, 'train_loss': 0.4504509464153671, 'epoch': 5.0}
100%|██████████| 40/40 [00:12<00:00,  3.04it/s]100%|██████████| 40/40 [00:12<00:00,  3.18it/s]
CLIENT:9
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.32it/s]                                              {'loss': 1.7145, 'grad_norm': 13.27608585357666, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.32it/s]  5%|▌         | 2/40 [00:00<00:14,  2.59it/s]                                              {'loss': 1.6614, 'grad_norm': 13.83720588684082, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:14,  2.59it/s]  8%|▊         | 3/40 [00:01<00:13,  2.75it/s]                                              {'loss': 0.6699, 'grad_norm': 9.952251434326172, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.75it/s] 10%|█         | 4/40 [00:01<00:13,  2.71it/s]                                              {'loss': 0.9575, 'grad_norm': 12.236187934875488, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.71it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.80it/s]                                              {'loss': 1.754, 'grad_norm': 23.667041778564453, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.80it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.86it/s]                                              {'loss': 2.7372, 'grad_norm': 24.113191604614258, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.86it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.85it/s]                                              {'loss': 1.1612, 'grad_norm': 19.354698181152344, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.85it/s] 20%|██        | 8/40 [00:03<00:14,  2.27it/s]                                              {'loss': 1.4454, 'grad_norm': 108.30712890625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.27it/s] 22%|██▎       | 9/40 [00:03<00:13,  2.34it/s]                                              {'loss': 0.948, 'grad_norm': 19.710254669189453, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:13,  2.34it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.52it/s]                                               {'loss': 0.4063, 'grad_norm': 9.2444486618042, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.52it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.64it/s]                                               {'loss': 0.4208, 'grad_norm': 11.437454223632812, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.64it/s] 30%|███       | 12/40 [00:04<00:10,  2.70it/s]                                               {'loss': 0.4089, 'grad_norm': 8.717097282409668, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.70it/s] 32%|███▎      | 13/40 [00:04<00:10,  2.69it/s]                                               {'loss': 0.3143, 'grad_norm': 6.381145000457764, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:10,  2.69it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.77it/s]                                               {'loss': 1.246, 'grad_norm': 14.331886291503906, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.77it/s] 38%|███▊      | 15/40 [00:05<00:08,  2.82it/s]                                               {'loss': 0.1612, 'grad_norm': 3.658830404281616, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  2.82it/s] 40%|████      | 16/40 [00:05<00:07,  3.28it/s]                                               {'loss': 0.9727, 'grad_norm': 27.292850494384766, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.28it/s] 42%|████▎     | 17/40 [00:06<00:07,  2.89it/s]                                               {'loss': 0.5026, 'grad_norm': 5.397741794586182, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  2.89it/s] 45%|████▌     | 18/40 [00:06<00:07,  2.86it/s]                                               {'loss': 0.1044, 'grad_norm': 3.57002592086792, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:07,  2.86it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.75it/s]                                               {'loss': 0.1011, 'grad_norm': 2.958038568496704, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.75it/s] 50%|█████     | 20/40 [00:07<00:07,  2.75it/s]                                               {'loss': 0.0928, 'grad_norm': 3.0442159175872803, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.75it/s] 52%|█████▎    | 21/40 [00:07<00:07,  2.69it/s]                                               {'loss': 0.1397, 'grad_norm': 5.239051818847656, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:07,  2.69it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.68it/s]                                               {'loss': 0.1805, 'grad_norm': 6.294750690460205, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.68it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.72it/s]                                               {'loss': 0.4389, 'grad_norm': 7.285823345184326, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.72it/s] 60%|██████    | 24/40 [00:08<00:04,  3.29it/s]                                               {'loss': 0.1373, 'grad_norm': 8.888320922851562, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:04,  3.29it/s] 62%|██████▎   | 25/40 [00:08<00:04,  3.19it/s]                                               {'loss': 0.0081, 'grad_norm': 0.2436000108718872, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:04,  3.19it/s] 65%|██████▌   | 26/40 [00:09<00:04,  3.08it/s]                                               {'loss': 0.0659, 'grad_norm': 2.242112398147583, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  3.08it/s] 68%|██████▊   | 27/40 [00:09<00:04,  3.06it/s]                                               {'loss': 0.0144, 'grad_norm': 0.3799600899219513, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  3.06it/s] 70%|███████   | 28/40 [00:10<00:04,  2.99it/s]                                               {'loss': 0.032, 'grad_norm': 0.9152147769927979, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.99it/s] 72%|███████▎  | 29/40 [00:10<00:03,  2.95it/s]                                               {'loss': 0.0825, 'grad_norm': 3.055521011352539, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:03,  2.95it/s] 75%|███████▌  | 30/40 [00:10<00:03,  2.92it/s]                                               {'loss': 0.0834, 'grad_norm': 3.448842763900757, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:10<00:03,  2.92it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.96it/s]                                               {'loss': 0.3566, 'grad_norm': 12.06753921508789, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.96it/s]                                               {'loss': 0.0334, 'grad_norm': 2.232358694076538, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.96it/s] 82%|████████▎ | 33/40 [00:11<00:01,  3.70it/s]                                               {'loss': 0.097, 'grad_norm': 3.7706234455108643, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:11<00:01,  3.70it/s] 85%|████████▌ | 34/40 [00:11<00:01,  3.46it/s]                                               {'loss': 0.021, 'grad_norm': 0.7986990213394165, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:11<00:01,  3.46it/s] 88%|████████▊ | 35/40 [00:12<00:01,  3.30it/s]                                               {'loss': 0.0206, 'grad_norm': 0.6470434069633484, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:12<00:01,  3.30it/s] 90%|█████████ | 36/40 [00:12<00:01,  3.14it/s]                                               {'loss': 0.0375, 'grad_norm': 1.230690836906433, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:12<00:01,  3.14it/s] 92%|█████████▎| 37/40 [00:12<00:01,  2.99it/s]                                               {'loss': 0.0357, 'grad_norm': 1.8877239227294922, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:12<00:01,  2.99it/s] 95%|█████████▌| 38/40 [00:13<00:00,  2.88it/s]                                               {'loss': 0.0169, 'grad_norm': 0.6192373037338257, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:00,  2.88it/s] 98%|█████████▊| 39/40 [00:13<00:00,  2.78it/s]                                               {'loss': 0.0191, 'grad_norm': 0.631851851940155, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:13<00:00,  2.78it/s]100%|██████████| 40/40 [00:13<00:00,  3.28it/s]                                               {'loss': 0.0088, 'grad_norm': 0.5929288864135742, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:13<00:00,  3.28it/s]                                               {'train_runtime': 14.1737, 'train_samples_per_second': 39.863, 'train_steps_per_second': 2.822, 'train_loss': 0.490238407230936, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  3.28it/s]100%|██████████| 40/40 [00:14<00:00,  2.82it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:58,  1.49s/it]                                              {'loss': 2.5799, 'grad_norm': 12.679566383361816, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:58,  1.49s/it]  5%|▌         | 2/40 [00:02<00:39,  1.05s/it]                                              {'loss': 1.5447, 'grad_norm': 10.346641540527344, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:39,  1.05s/it]  8%|▊         | 3/40 [00:02<00:33,  1.12it/s]                                              {'loss': 2.3214, 'grad_norm': 11.928119659423828, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:33,  1.12it/s] 10%|█         | 4/40 [00:03<00:28,  1.28it/s]                                              {'loss': 2.1478, 'grad_norm': 19.05027961730957, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:28,  1.28it/s] 12%|█▎        | 5/40 [00:04<00:25,  1.38it/s]                                              {'loss': 1.4753, 'grad_norm': 13.866720199584961, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:25,  1.38it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.6247, 'grad_norm': 19.85430145263672, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 1.1528, 'grad_norm': 13.865955352783203, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.42it/s]                                              {'loss': 0.6048, 'grad_norm': 59.916778564453125, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.42it/s] 22%|██▎       | 9/40 [00:06<00:17,  1.82it/s]                                              {'loss': 0.6705, 'grad_norm': 8.870765686035156, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:17,  1.82it/s] 25%|██▌       | 10/40 [00:07<00:18,  1.64it/s]                                               {'loss': 0.8052, 'grad_norm': 10.030532836914062, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:18,  1.64it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.65it/s]                                               {'loss': 1.2654, 'grad_norm': 16.09276008605957, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.65it/s] 30%|███       | 12/40 [00:08<00:17,  1.61it/s]                                               {'loss': 0.7852, 'grad_norm': 7.237162113189697, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:09<00:17,  1.58it/s]                                               {'loss': 0.7702, 'grad_norm': 6.808465003967285, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:17,  1.58it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.52it/s]                                               {'loss': 1.108, 'grad_norm': 8.019392967224121, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.52it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s]                                               {'loss': 0.7931, 'grad_norm': 6.181028366088867, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:17,  1.46it/s]                                               {'loss': 0.2356, 'grad_norm': 10.463705062866211, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:11<00:12,  1.89it/s]                                               {'loss': 0.8427, 'grad_norm': 11.32788372039795, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:12,  1.89it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.72it/s]                                               {'loss': 0.5539, 'grad_norm': 7.8796796798706055, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.72it/s] 48%|████▊     | 19/40 [00:12<00:12,  1.62it/s]                                               {'loss': 0.3594, 'grad_norm': 5.575892925262451, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:12,  1.62it/s] 50%|█████     | 20/40 [00:13<00:12,  1.63it/s]                                               {'loss': 0.6048, 'grad_norm': 3.8999428749084473, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:12,  1.63it/s] 52%|█████▎    | 21/40 [00:13<00:11,  1.62it/s]                                               {'loss': 0.4593, 'grad_norm': 7.626674175262451, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:11,  1.62it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.50it/s]                                               {'loss': 0.1788, 'grad_norm': 3.249885082244873, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:12,  1.50it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.53it/s]                                               {'loss': 0.5568, 'grad_norm': 9.983704566955566, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:11,  1.53it/s]                                               {'loss': 1.1594, 'grad_norm': 41.5430793762207, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:16<00:07,  1.89it/s]                                               {'loss': 0.1156, 'grad_norm': 3.409996747970581, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:07,  1.89it/s] 65%|██████▌   | 26/40 [00:16<00:07,  1.80it/s]                                               {'loss': 0.3608, 'grad_norm': 2.816584348678589, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:07,  1.80it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.66it/s]                                               {'loss': 0.2875, 'grad_norm': 3.9663479328155518, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.66it/s] 70%|███████   | 28/40 [00:18<00:07,  1.57it/s]                                               {'loss': 0.1609, 'grad_norm': 2.581587076187134, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:07,  1.57it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.59it/s]                                               {'loss': 0.201, 'grad_norm': 1.8868094682693481, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.57it/s]                                               {'loss': 0.0901, 'grad_norm': 1.8545035123825073, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.57it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.48it/s]                                               {'loss': 0.2352, 'grad_norm': 4.255203723907471, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:06,  1.48it/s]                                               {'loss': 0.0017, 'grad_norm': 0.09545671939849854, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:20<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.91it/s]                                               {'loss': 0.0998, 'grad_norm': 2.0029819011688232, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.77it/s]                                               {'loss': 0.0603, 'grad_norm': 2.1096622943878174, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:22<00:03,  1.62it/s]                                               {'loss': 0.0896, 'grad_norm': 2.284111261367798, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:22<00:03,  1.62it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.61it/s]                                               {'loss': 0.2567, 'grad_norm': 11.048283576965332, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.58it/s]                                               {'loss': 0.1143, 'grad_norm': 2.5093300342559814, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:24<00:01,  1.56it/s]                                               {'loss': 0.2325, 'grad_norm': 1.5296257734298706, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:24<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.79it/s]                                               {'loss': 0.1209, 'grad_norm': 2.356304883956909, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.79it/s]                                               {'loss': 0.0965, 'grad_norm': 5.942193031311035, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.79it/s]                                               {'train_runtime': 24.9453, 'train_samples_per_second': 22.65, 'train_steps_per_second': 1.604, 'train_loss': 0.6780761666945182, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.79it/s]100%|██████████| 40/40 [00:24<00:00,  1.60it/s]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:49,  1.26s/it]                                              {'loss': 2.3038, 'grad_norm': 13.262795448303223, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:49,  1.26s/it]  5%|▌         | 2/40 [00:01<00:36,  1.05it/s]                                              {'loss': 1.2811, 'grad_norm': 13.441559791564941, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:36,  1.05it/s]  8%|▊         | 3/40 [00:02<00:29,  1.24it/s]                                              {'loss': 1.3008, 'grad_norm': 18.729745864868164, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:29,  1.24it/s] 10%|█         | 4/40 [00:03<00:27,  1.30it/s]                                              {'loss': 1.6161, 'grad_norm': 15.295896530151367, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.30it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.42it/s]                                              {'loss': 1.0493, 'grad_norm': 16.79086685180664, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.42it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s]                                              {'loss': 1.4258, 'grad_norm': 14.808095932006836, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.34it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.40it/s]                                              {'loss': 1.4927, 'grad_norm': 19.43453598022461, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.40it/s]                                              {'loss': 0.2932, 'grad_norm': 18.92777442932129, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.40it/s] 22%|██▎       | 9/40 [00:06<00:16,  1.87it/s]                                              {'loss': 0.8952, 'grad_norm': 10.564496040344238, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.65it/s]                                               {'loss': 0.5077, 'grad_norm': 7.8840651512146, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.65it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.61it/s]                                               {'loss': 0.2811, 'grad_norm': 5.083420276641846, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.61it/s] 30%|███       | 12/40 [00:08<00:17,  1.64it/s]                                               {'loss': 0.7392, 'grad_norm': 10.263487815856934, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.64it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.52it/s]                                               {'loss': 1.0687, 'grad_norm': 9.959964752197266, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.52it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s]                                               {'loss': 0.6702, 'grad_norm': 8.354344367980957, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.53it/s]                                               {'loss': 0.5249, 'grad_norm': 7.82061243057251, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.53it/s]                                               {'loss': 3.2891, 'grad_norm': 125.84629821777344, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:15,  1.53it/s] 42%|████▎     | 17/40 [00:11<00:12,  1.86it/s]                                               {'loss': 0.494, 'grad_norm': 9.717344284057617, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:12,  1.86it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.77it/s]                                               {'loss': 0.3034, 'grad_norm': 9.208732604980469, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.77it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.59it/s]                                               {'loss': 0.6255, 'grad_norm': 5.4438276290893555, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.59it/s] 50%|█████     | 20/40 [00:13<00:12,  1.60it/s]                                               {'loss': 0.4084, 'grad_norm': 5.807862281799316, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:12,  1.60it/s] 52%|█████▎    | 21/40 [00:13<00:11,  1.62it/s]                                               {'loss': 0.2766, 'grad_norm': 4.547515392303467, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:11,  1.62it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.50it/s]                                               {'loss': 0.3598, 'grad_norm': 5.299871921539307, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:12,  1.50it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.51it/s]                                               {'loss': 0.2254, 'grad_norm': 6.390264987945557, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:11,  1.51it/s]                                               {'loss': 0.004, 'grad_norm': 0.24630501866340637, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.51it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.94it/s]                                               {'loss': 0.293, 'grad_norm': 1.3943833112716675, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.94it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.71it/s]                                               {'loss': 0.096, 'grad_norm': 2.007673501968384, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.71it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.66it/s]                                               {'loss': 0.0635, 'grad_norm': 2.1823980808258057, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.66it/s] 70%|███████   | 28/40 [00:17<00:07,  1.66it/s]                                               {'loss': 0.4711, 'grad_norm': 2.2501602172851562, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.66it/s] 72%|███████▎  | 29/40 [00:18<00:07,  1.56it/s]                                               {'loss': 0.0455, 'grad_norm': 0.8657541871070862, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:07,  1.56it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.57it/s]                                               {'loss': 0.0958, 'grad_norm': 2.7368271350860596, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.57it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.45it/s]                                               {'loss': 0.0601, 'grad_norm': 2.0022995471954346, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:06,  1.45it/s]                                               {'loss': 0.0003, 'grad_norm': 0.019392939284443855, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:20<00:05,  1.45it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.86it/s]                                               {'loss': 0.4182, 'grad_norm': 1.035394549369812, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.86it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.77it/s]                                               {'loss': 0.0103, 'grad_norm': 0.28385671973228455, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:22<00:03,  1.60it/s]                                               {'loss': 0.0176, 'grad_norm': 0.36475974321365356, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:22<00:03,  1.60it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.59it/s]                                               {'loss': 0.0565, 'grad_norm': 3.9450576305389404, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.59it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.62it/s]                                               {'loss': 0.027, 'grad_norm': 1.0088379383087158, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.62it/s] 95%|█████████▌| 38/40 [00:24<00:01,  1.49it/s]                                               {'loss': 0.2423, 'grad_norm': 0.5015861392021179, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:24<00:01,  1.49it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.49it/s]                                               {'loss': 0.0341, 'grad_norm': 1.3079617023468018, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.49it/s]                                               {'loss': 0.0275, 'grad_norm': 3.6267073154449463, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.49it/s]                                               {'train_runtime': 25.2359, 'train_samples_per_second': 22.389, 'train_steps_per_second': 1.585, 'train_loss': 0.5848710128324456, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.49it/s]100%|██████████| 40/40 [00:25<00:00,  1.59it/s]
CLIENT:96
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:19,  2.03it/s]                                              {'loss': 2.0102, 'grad_norm': 11.778640747070312, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:19,  2.03it/s]  5%|▌         | 2/40 [00:00<00:15,  2.51it/s]                                              {'loss': 2.1301, 'grad_norm': 17.41020965576172, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:15,  2.51it/s]  8%|▊         | 3/40 [00:01<00:13,  2.69it/s]                                              {'loss': 0.4848, 'grad_norm': 11.73206901550293, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.69it/s] 10%|█         | 4/40 [00:01<00:12,  2.79it/s]                                              {'loss': 0.6393, 'grad_norm': 10.382661819458008, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.79it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.83it/s]                                              {'loss': 1.4777, 'grad_norm': 15.149750709533691, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.83it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.87it/s]                                              {'loss': 1.3211, 'grad_norm': 13.992912292480469, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.87it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.91it/s]                                              {'loss': 1.1012, 'grad_norm': 12.790984153747559, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.91it/s] 20%|██        | 8/40 [00:02<00:12,  2.64it/s]                                              {'loss': 0.0059, 'grad_norm': 0.36706799268722534, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:12,  2.64it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.72it/s]                                              {'loss': 0.9235, 'grad_norm': 12.256060600280762, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.72it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.78it/s]                                               {'loss': 0.5803, 'grad_norm': 5.688190937042236, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.78it/s] 28%|██▊       | 11/40 [00:03<00:10,  2.83it/s]                                               {'loss': 0.4388, 'grad_norm': 7.545167922973633, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:10,  2.83it/s] 30%|███       | 12/40 [00:04<00:10,  2.57it/s]                                               {'loss': 0.2167, 'grad_norm': 4.455366611480713, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.57it/s] 32%|███▎      | 13/40 [00:05<00:13,  1.94it/s]                                               {'loss': 0.153, 'grad_norm': 2.635176658630371, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:13,  1.94it/s] 35%|███▌      | 14/40 [00:05<00:14,  1.81it/s]                                               {'loss': 0.4239, 'grad_norm': 4.037257671356201, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:14,  1.81it/s] 38%|███▊      | 15/40 [00:06<00:13,  1.80it/s]                                               {'loss': 0.2838, 'grad_norm': 3.5811827182769775, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:13,  1.80it/s]                                               {'loss': 0.0198, 'grad_norm': 1.830049991607666, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:13,  1.80it/s] 42%|████▎     | 17/40 [00:07<00:11,  1.97it/s]                                               {'loss': 0.1696, 'grad_norm': 6.957615852355957, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:11,  1.97it/s] 45%|████▌     | 18/40 [00:08<00:11,  1.84it/s]                                               {'loss': 0.1208, 'grad_norm': 2.751265525817871, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:11,  1.84it/s] 48%|████▊     | 19/40 [00:08<00:11,  1.81it/s]                                               {'loss': 0.2427, 'grad_norm': 1.8290351629257202, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:11,  1.81it/s] 50%|█████     | 20/40 [00:09<00:12,  1.62it/s]                                               {'loss': 0.2595, 'grad_norm': 5.372435092926025, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:12,  1.62it/s] 52%|█████▎    | 21/40 [00:10<00:12,  1.56it/s]                                               {'loss': 0.2966, 'grad_norm': 6.611329078674316, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:12,  1.56it/s] 55%|█████▌    | 22/40 [00:10<00:11,  1.58it/s]                                               {'loss': 0.2546, 'grad_norm': 3.284421443939209, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:11,  1.58it/s] 57%|█████▊    | 23/40 [00:11<00:11,  1.52it/s]                                               {'loss': 0.0767, 'grad_norm': 1.846943736076355, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:11,  1.52it/s]                                               {'loss': 0.0158, 'grad_norm': 1.3640424013137817, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:10,  1.52it/s] 62%|██████▎   | 25/40 [00:12<00:07,  1.91it/s]                                               {'loss': 0.1504, 'grad_norm': 4.5112504959106445, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:12<00:08,  1.68it/s]                                               {'loss': 0.0986, 'grad_norm': 2.3800766468048096, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:12<00:08,  1.68it/s] 68%|██████▊   | 27/40 [00:13<00:07,  1.66it/s]                                               {'loss': 0.1643, 'grad_norm': 3.2325048446655273, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:07,  1.66it/s] 70%|███████   | 28/40 [00:14<00:07,  1.64it/s]                                               {'loss': 0.0796, 'grad_norm': 1.105621337890625, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:07,  1.64it/s] 72%|███████▎  | 29/40 [00:15<00:07,  1.50it/s]                                               {'loss': 0.2197, 'grad_norm': 0.6890046000480652, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:15<00:07,  1.50it/s] 75%|███████▌  | 30/40 [00:15<00:06,  1.51it/s]                                               {'loss': 0.1246, 'grad_norm': 2.122080087661743, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:06,  1.51it/s] 78%|███████▊  | 31/40 [00:16<00:05,  1.57it/s]                                               {'loss': 0.0286, 'grad_norm': 0.5029214024543762, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:16<00:05,  1.57it/s]                                               {'loss': 0.0101, 'grad_norm': 0.5859102606773376, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:16<00:05,  1.57it/s] 82%|████████▎ | 33/40 [00:17<00:03,  1.80it/s]                                               {'loss': 0.0188, 'grad_norm': 0.4269528090953827, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:17<00:03,  1.80it/s] 85%|████████▌ | 34/40 [00:17<00:03,  1.72it/s]                                               {'loss': 0.0495, 'grad_norm': 1.4631356000900269, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:17<00:03,  1.72it/s] 88%|████████▊ | 35/40 [00:18<00:02,  1.71it/s]                                               {'loss': 0.02, 'grad_norm': 0.8284846544265747, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:18<00:02,  1.71it/s] 90%|█████████ | 36/40 [00:19<00:02,  1.61it/s]                                               {'loss': 0.0956, 'grad_norm': 11.03984260559082, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:19<00:02,  1.61it/s] 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s]                                               {'loss': 0.2751, 'grad_norm': 2.6874687671661377, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:19<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:20<00:01,  1.46it/s]                                               {'loss': 0.1268, 'grad_norm': 2.844329357147217, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:01,  1.46it/s] 98%|█████████▊| 39/40 [00:21<00:00,  1.51it/s]                                               {'loss': 0.0452, 'grad_norm': 2.007983446121216, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  1.51it/s]                                               {'loss': 0.0004, 'grad_norm': 0.018486475571990013, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.51it/s]                                               {'train_runtime': 21.5594, 'train_samples_per_second': 26.207, 'train_steps_per_second': 1.855, 'train_loss': 0.3788393289934902, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  1.51it/s]100%|██████████| 40/40 [00:21<00:00,  1.86it/s]
CLIENT:29
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.62it/s]                                              {'loss': 2.347, 'grad_norm': 11.226882934570312, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.62it/s]  5%|▌         | 2/40 [00:01<00:25,  1.50it/s]                                              {'loss': 1.9845, 'grad_norm': 11.218489646911621, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.50it/s]  8%|▊         | 3/40 [00:02<00:26,  1.39it/s]                                              {'loss': 1.7135, 'grad_norm': 12.218195915222168, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:26,  1.39it/s] 10%|█         | 4/40 [00:02<00:24,  1.48it/s]                                              {'loss': 1.5818, 'grad_norm': 16.471637725830078, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s]                                              {'loss': 1.6707, 'grad_norm': 14.044286727905273, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.49it/s] 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s]                                              {'loss': 0.8832, 'grad_norm': 12.31556224822998, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:22,  1.50it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s]                                              {'loss': 0.9451, 'grad_norm': 12.250170707702637, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s]                                              {'loss': 3.1175, 'grad_norm': 180.10096740722656, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.46it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.83it/s]                                              {'loss': 0.8336, 'grad_norm': 17.009166717529297, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.83it/s] 25%|██▌       | 10/40 [00:06<00:16,  1.78it/s]                                               {'loss': 0.4675, 'grad_norm': 14.286576271057129, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:16,  1.78it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.65it/s]                                               {'loss': 1.215, 'grad_norm': 8.380518913269043, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.65it/s] 30%|███       | 12/40 [00:07<00:18,  1.55it/s]                                               {'loss': 0.5531, 'grad_norm': 19.9669246673584, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:18,  1.55it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s]                                               {'loss': 0.6203, 'grad_norm': 12.563539505004883, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.58it/s] 35%|███▌      | 14/40 [00:08<00:17,  1.53it/s]                                               {'loss': 0.5455, 'grad_norm': 4.702070713043213, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:17,  1.53it/s] 38%|███▊      | 15/40 [00:09<00:17,  1.46it/s]                                               {'loss': 0.9371, 'grad_norm': 8.19784164428711, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:17,  1.46it/s]                                               {'loss': 0.0751, 'grad_norm': 14.862446784973145, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.6962, 'grad_norm': 5.641851902008057, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.77it/s]                                               {'loss': 1.2227, 'grad_norm': 18.845739364624023, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.77it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s]                                               {'loss': 0.4468, 'grad_norm': 2.9118406772613525, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s] 50%|█████     | 20/40 [00:12<00:10,  1.96it/s]                                               {'loss': 0.3601, 'grad_norm': 5.362085819244385, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:10,  1.96it/s] 52%|█████▎    | 21/40 [00:12<00:08,  2.16it/s]                                               {'loss': 0.6068, 'grad_norm': 7.644824981689453, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:08,  2.16it/s] 55%|█████▌    | 22/40 [00:12<00:07,  2.34it/s]                                               {'loss': 0.3461, 'grad_norm': 2.8440632820129395, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:07,  2.34it/s] 57%|█████▊    | 23/40 [00:13<00:06,  2.49it/s]                                               {'loss': 0.087, 'grad_norm': 2.497661828994751, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:06,  2.49it/s]                                               {'loss': 0.0186, 'grad_norm': 1.2180838584899902, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:06,  2.49it/s] 62%|██████▎   | 25/40 [00:13<00:04,  3.25it/s]                                               {'loss': 0.1029, 'grad_norm': 1.855218529701233, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:04,  3.25it/s] 65%|██████▌   | 26/40 [00:13<00:04,  3.17it/s]                                               {'loss': 0.231, 'grad_norm': 2.1064975261688232, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:04,  3.17it/s] 68%|██████▊   | 27/40 [00:14<00:04,  3.10it/s]                                               {'loss': 0.1923, 'grad_norm': 1.9454764127731323, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:14<00:04,  3.10it/s] 70%|███████   | 28/40 [00:14<00:03,  3.04it/s]                                               {'loss': 0.2891, 'grad_norm': 5.1879377365112305, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:03,  3.04it/s] 72%|███████▎  | 29/40 [00:14<00:03,  2.97it/s]                                               {'loss': 0.1248, 'grad_norm': 3.8693578243255615, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:03,  2.97it/s] 75%|███████▌  | 30/40 [00:15<00:03,  2.93it/s]                                               {'loss': 0.1129, 'grad_norm': 3.5712928771972656, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:03,  2.93it/s] 78%|███████▊  | 31/40 [00:15<00:03,  2.96it/s]                                               {'loss': 1.1804, 'grad_norm': 8.088956832885742, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:03,  2.96it/s] 80%|████████  | 32/40 [00:15<00:02,  3.59it/s]                                               {'loss': 0.9708, 'grad_norm': 30.336589813232422, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:15<00:02,  3.59it/s] 82%|████████▎ | 33/40 [00:15<00:02,  3.38it/s]                                               {'loss': 1.1698, 'grad_norm': 1.5619571208953857, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:15<00:02,  3.38it/s] 85%|████████▌ | 34/40 [00:16<00:01,  3.21it/s]                                               {'loss': 0.0839, 'grad_norm': 3.0720067024230957, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:16<00:01,  3.21it/s] 88%|████████▊ | 35/40 [00:16<00:01,  3.12it/s]                                               {'loss': 0.0958, 'grad_norm': 2.3583931922912598, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:16<00:01,  3.12it/s] 90%|█████████ | 36/40 [00:16<00:01,  3.21it/s]                                               {'loss': 0.0209, 'grad_norm': 0.6981402635574341, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:16<00:01,  3.21it/s] 92%|█████████▎| 37/40 [00:17<00:00,  3.09it/s]                                               {'loss': 0.0259, 'grad_norm': 1.7268792390823364, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:17<00:00,  3.09it/s] 95%|█████████▌| 38/40 [00:18<00:00,  2.19it/s]                                               {'loss': 0.0193, 'grad_norm': 0.5440961122512817, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:18<00:00,  2.19it/s] 98%|█████████▊| 39/40 [00:18<00:00,  1.86it/s]                                               {'loss': 0.2511, 'grad_norm': 1.7260661125183105, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:18<00:00,  1.86it/s]                                               {'loss': 0.0224, 'grad_norm': 2.9768240451812744, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:18<00:00,  1.86it/s]                                               {'train_runtime': 19.1365, 'train_samples_per_second': 29.525, 'train_steps_per_second': 2.09, 'train_loss': 0.7042083359789103, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  1.86it/s]100%|██████████| 40/40 [00:19<00:00,  2.09it/s]
CLIENT:86
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:05,  1.67s/it]                                              {'loss': 1.6794, 'grad_norm': 10.223427772521973, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:05,  1.67s/it]  5%|▌         | 2/40 [00:02<00:40,  1.06s/it]                                              {'loss': 2.1527, 'grad_norm': 17.597049713134766, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:40,  1.06s/it]  8%|▊         | 3/40 [00:03<00:35,  1.05it/s]                                              {'loss': 1.6127, 'grad_norm': 16.241796493530273, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:35,  1.05it/s] 10%|█         | 4/40 [00:03<00:29,  1.21it/s]                                              {'loss': 1.9384, 'grad_norm': 25.954439163208008, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:29,  1.21it/s] 12%|█▎        | 5/40 [00:04<00:25,  1.35it/s]                                              {'loss': 0.8093, 'grad_norm': 11.741776466369629, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:05<00:25,  1.31it/s]                                              {'loss': 0.8239, 'grad_norm': 7.896277904510498, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:25,  1.31it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 1.0879, 'grad_norm': 14.825408935546875, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.35it/s]                                              {'loss': 6.1579, 'grad_norm': 118.66098022460938, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.35it/s] 22%|██▎       | 9/40 [00:06<00:17,  1.81it/s]                                              {'loss': 0.3745, 'grad_norm': 4.840658187866211, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:17,  1.81it/s] 25%|██▌       | 10/40 [00:07<00:18,  1.61it/s]                                               {'loss': 0.4494, 'grad_norm': 7.629186153411865, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:18,  1.61it/s] 28%|██▊       | 11/40 [00:08<00:18,  1.58it/s]                                               {'loss': 0.4371, 'grad_norm': 5.576745510101318, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:18,  1.58it/s] 30%|███       | 12/40 [00:08<00:17,  1.60it/s]                                               {'loss': 0.2551, 'grad_norm': 4.58510160446167, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.60it/s] 32%|███▎      | 13/40 [00:09<00:17,  1.52it/s]                                               {'loss': 0.3973, 'grad_norm': 4.8521952629089355, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:17,  1.52it/s] 35%|███▌      | 14/40 [00:10<00:16,  1.54it/s]                                               {'loss': 0.3613, 'grad_norm': 6.241369247436523, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:16,  1.54it/s] 38%|███▊      | 15/40 [00:10<00:17,  1.42it/s]                                               {'loss': 0.5001, 'grad_norm': 7.5078558921813965, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:17,  1.42it/s]                                               {'loss': 3.0674, 'grad_norm': 62.63179016113281, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:16,  1.42it/s] 42%|████▎     | 17/40 [00:11<00:12,  1.82it/s]                                               {'loss': 0.4007, 'grad_norm': 5.214591979980469, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:12,  1.82it/s] 45%|████▌     | 18/40 [00:12<00:12,  1.75it/s]                                               {'loss': 0.295, 'grad_norm': 6.464869976043701, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:12,  1.75it/s] 48%|████▊     | 19/40 [00:13<00:13,  1.57it/s]                                               {'loss': 0.0982, 'grad_norm': 2.631969928741455, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:13,  1.57it/s] 50%|█████     | 20/40 [00:13<00:12,  1.56it/s]                                               {'loss': 0.0604, 'grad_norm': 2.1316630840301514, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:12,  1.56it/s] 52%|█████▎    | 21/40 [00:14<00:12,  1.58it/s]                                               {'loss': 0.0516, 'grad_norm': 1.1216371059417725, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:12,  1.58it/s] 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s]                                               {'loss': 0.0758, 'grad_norm': 2.5187625885009766, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:12,  1.46it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s]                                               {'loss': 0.0895, 'grad_norm': 1.726785659790039, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s]                                               {'loss': 0.0119, 'grad_norm': 0.29790768027305603, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.48it/s] 62%|██████▎   | 25/40 [00:16<00:07,  1.96it/s]                                               {'loss': 0.042, 'grad_norm': 1.8230732679367065, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:07,  1.96it/s] 65%|██████▌   | 26/40 [00:17<00:07,  1.76it/s]                                               {'loss': 0.0562, 'grad_norm': 1.6436876058578491, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:07,  1.76it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.71it/s]                                               {'loss': 0.0179, 'grad_norm': 0.3946096897125244, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.71it/s] 70%|███████   | 28/40 [00:18<00:07,  1.54it/s]                                               {'loss': 0.0188, 'grad_norm': 0.6586475372314453, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:07,  1.54it/s] 72%|███████▎  | 29/40 [00:19<00:07,  1.54it/s]                                               {'loss': 0.037, 'grad_norm': 1.3090137243270874, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:07,  1.54it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.59it/s]                                               {'loss': 0.1637, 'grad_norm': 2.0033745765686035, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.59it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.46it/s]                                               {'loss': 0.0427, 'grad_norm': 1.6909101009368896, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:06,  1.46it/s] 80%|████████  | 32/40 [00:20<00:04,  1.94it/s]                                               {'loss': 0.0017, 'grad_norm': 0.04959363862872124, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:20<00:04,  1.94it/s] 82%|████████▎ | 33/40 [00:21<00:03,  1.81it/s]                                               {'loss': 0.0213, 'grad_norm': 0.9403868317604065, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:03,  1.81it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.76it/s]                                               {'loss': 0.067, 'grad_norm': 0.9701992273330688, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:22<00:03,  1.56it/s]                                               {'loss': 0.0086, 'grad_norm': 0.35411807894706726, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:22<00:03,  1.56it/s] 90%|█████████ | 36/40 [00:23<00:02,  1.53it/s]                                               {'loss': 0.0575, 'grad_norm': 2.8133678436279297, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:23<00:02,  1.53it/s] 92%|█████████▎| 37/40 [00:24<00:01,  1.56it/s]                                               {'loss': 0.1395, 'grad_norm': 4.031379699707031, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:24<00:01,  1.56it/s] 95%|█████████▌| 38/40 [00:24<00:01,  1.50it/s]                                               {'loss': 0.0109, 'grad_norm': 0.2863610088825226, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:24<00:01,  1.50it/s] 98%|█████████▊| 39/40 [00:25<00:00,  1.61it/s]                                               {'loss': 0.0342, 'grad_norm': 1.1793289184570312, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:25<00:00,  1.61it/s]                                               {'loss': 0.0003, 'grad_norm': 0.01935856230556965, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.61it/s]                                               {'train_runtime': 25.6195, 'train_samples_per_second': 22.053, 'train_steps_per_second': 1.561, 'train_loss': 0.5976727074325027, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.61it/s]100%|██████████| 40/40 [00:25<00:00,  1.56it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:56,  1.46s/it]                                              {'loss': 1.4711, 'grad_norm': 8.42209529876709, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:56,  1.46s/it]  5%|▌         | 2/40 [00:02<00:37,  1.01it/s]                                              {'loss': 1.358, 'grad_norm': 10.445237159729004, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:37,  1.01it/s]  8%|▊         | 3/40 [00:02<00:30,  1.22it/s]                                              {'loss': 1.3027, 'grad_norm': 9.887207984924316, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:30,  1.22it/s] 10%|█         | 4/40 [00:03<00:28,  1.28it/s]                                              {'loss': 0.9884, 'grad_norm': 14.826923370361328, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:28,  1.28it/s] 12%|█▎        | 5/40 [00:04<00:25,  1.35it/s]                                              {'loss': 0.5515, 'grad_norm': 12.888288497924805, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.31it/s]                                              {'loss': 2.6283, 'grad_norm': 17.63161277770996, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.31it/s] 18%|█▊        | 7/40 [00:05<00:23,  1.40it/s]                                              {'loss': 1.7286, 'grad_norm': 17.062528610229492, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:23,  1.40it/s]                                              {'loss': 6.059, 'grad_norm': 149.48684692382812, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.40it/s] 22%|██▎       | 9/40 [00:06<00:17,  1.81it/s]                                              {'loss': 0.4978, 'grad_norm': 9.5310697555542, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:17,  1.81it/s] 25%|██▌       | 10/40 [00:07<00:18,  1.63it/s]                                               {'loss': 0.3883, 'grad_norm': 5.6535186767578125, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:18,  1.63it/s] 28%|██▊       | 11/40 [00:07<00:17,  1.64it/s]                                               {'loss': 1.7451, 'grad_norm': 9.636852264404297, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:17,  1.64it/s] 30%|███       | 12/40 [00:08<00:17,  1.61it/s]                                               {'loss': 0.2744, 'grad_norm': 5.9595232009887695, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:09<00:18,  1.48it/s]                                               {'loss': 0.85, 'grad_norm': 8.000391960144043, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:18,  1.48it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s]                                               {'loss': 0.1079, 'grad_norm': 3.199223279953003, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s] 38%|███▊      | 15/40 [00:10<00:16,  1.54it/s]                                               {'loss': 0.6847, 'grad_norm': 11.803577423095703, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:16,  1.54it/s] 40%|████      | 16/40 [00:10<00:11,  2.05it/s]                                               {'loss': 0.4015, 'grad_norm': 24.232412338256836, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:11,  2.05it/s] 42%|████▎     | 17/40 [00:11<00:12,  1.83it/s]                                               {'loss': 0.1934, 'grad_norm': 5.666103363037109, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:12,  1.83it/s] 45%|████▌     | 18/40 [00:11<00:13,  1.68it/s]                                               {'loss': 0.5227, 'grad_norm': 4.74678897857666, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:13,  1.68it/s] 48%|████▊     | 19/40 [00:12<00:13,  1.55it/s]                                               {'loss': 0.4705, 'grad_norm': 3.0998566150665283, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:12<00:13,  1.55it/s] 50%|█████     | 20/40 [00:13<00:12,  1.58it/s]                                               {'loss': 0.6227, 'grad_norm': 4.992138385772705, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:12,  1.58it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.55it/s]                                               {'loss': 0.8402, 'grad_norm': 6.849818706512451, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.55it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.44it/s]                                               {'loss': 0.2425, 'grad_norm': 6.142570972442627, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s]                                               {'loss': 0.4133, 'grad_norm': 7.450655460357666, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:15<00:11,  1.48it/s]                                               {'loss': 0.1717, 'grad_norm': 8.724221229553223, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:10,  1.48it/s] 62%|██████▎   | 25/40 [00:16<00:08,  1.86it/s]                                               {'loss': 0.4735, 'grad_norm': 2.706068277359009, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:16<00:08,  1.86it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.65it/s]                                               {'loss': 0.558, 'grad_norm': 1.366740107536316, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.65it/s] 68%|██████▊   | 27/40 [00:17<00:07,  1.64it/s]                                               {'loss': 0.3623, 'grad_norm': 1.1124505996704102, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:07,  1.64it/s] 70%|███████   | 28/40 [00:18<00:07,  1.60it/s]                                               {'loss': 0.0229, 'grad_norm': 0.9882534742355347, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:07,  1.60it/s] 72%|███████▎  | 29/40 [00:18<00:07,  1.56it/s]                                               {'loss': 0.0731, 'grad_norm': 1.457585096359253, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:07,  1.56it/s] 75%|███████▌  | 30/40 [00:19<00:06,  1.50it/s]                                               {'loss': 0.1637, 'grad_norm': 0.911099910736084, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:06,  1.50it/s] 78%|███████▊  | 31/40 [00:20<00:06,  1.44it/s]                                               {'loss': 0.3235, 'grad_norm': 8.800870895385742, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:06,  1.44it/s]                                               {'loss': 0.0034, 'grad_norm': 0.2037551999092102, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:20<00:05,  1.44it/s] 82%|████████▎ | 33/40 [00:21<00:03,  1.86it/s]                                               {'loss': 0.1755, 'grad_norm': 0.9997032880783081, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:03,  1.86it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.69it/s]                                               {'loss': 0.1024, 'grad_norm': 1.2557157278060913, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.69it/s] 88%|████████▊ | 35/40 [00:22<00:03,  1.59it/s]                                               {'loss': 0.0186, 'grad_norm': 0.3907771706581116, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:22<00:03,  1.59it/s] 90%|█████████ | 36/40 [00:23<00:02,  1.59it/s]                                               {'loss': 0.6372, 'grad_norm': 4.620635032653809, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:23<00:02,  1.59it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.52it/s]                                               {'loss': 0.1398, 'grad_norm': 1.0897201299667358, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.52it/s] 95%|█████████▌| 38/40 [00:24<00:01,  1.45it/s]                                               {'loss': 0.4679, 'grad_norm': 1.6853398084640503, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:24<00:01,  1.45it/s] 98%|█████████▊| 39/40 [00:25<00:00,  1.49it/s]                                               {'loss': 0.2808, 'grad_norm': 2.8083505630493164, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:25<00:00,  1.49it/s]                                               {'loss': 0.0026, 'grad_norm': 0.14746324717998505, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.49it/s]                                               {'train_runtime': 25.6972, 'train_samples_per_second': 21.987, 'train_steps_per_second': 1.557, 'train_loss': 0.70799649116816, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.49it/s]100%|██████████| 40/40 [00:25<00:00,  1.56it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:44, 10.43it/s]  1%|          | 4/471 [00:00<01:06,  7.06it/s]  1%|          | 5/471 [00:00<01:12,  6.42it/s]  1%|▏         | 6/471 [00:00<01:17,  5.99it/s]  1%|▏         | 7/471 [00:01<01:21,  5.72it/s]  2%|▏         | 8/471 [00:01<01:23,  5.57it/s]  2%|▏         | 9/471 [00:01<01:24,  5.45it/s]  2%|▏         | 10/471 [00:01<01:26,  5.35it/s]  2%|▏         | 11/471 [00:01<01:26,  5.29it/s]  3%|▎         | 12/471 [00:02<01:27,  5.22it/s]  3%|▎         | 13/471 [00:02<01:27,  5.23it/s]  3%|▎         | 14/471 [00:02<01:27,  5.23it/s]  3%|▎         | 15/471 [00:02<01:28,  5.17it/s]  3%|▎         | 16/471 [00:02<01:29,  5.10it/s]  4%|▎         | 17/471 [00:03<01:28,  5.14it/s]  4%|▍         | 18/471 [00:03<01:27,  5.17it/s]  4%|▍         | 19/471 [00:03<01:26,  5.20it/s]  4%|▍         | 20/471 [00:03<01:26,  5.22it/s]  4%|▍         | 21/471 [00:03<01:33,  4.83it/s]  5%|▍         | 22/471 [00:04<02:02,  3.68it/s]  5%|▍         | 23/471 [00:04<02:22,  3.15it/s]  5%|▌         | 24/471 [00:05<02:32,  2.93it/s]  5%|▌         | 25/471 [00:05<02:30,  2.96it/s]  6%|▌         | 26/471 [00:05<02:29,  2.99it/s]  6%|▌         | 27/471 [00:06<02:27,  3.00it/s]  6%|▌         | 28/471 [00:06<02:31,  2.91it/s]  6%|▌         | 29/471 [00:06<02:42,  2.72it/s]  6%|▋         | 30/471 [00:07<02:49,  2.60it/s]  7%|▋         | 31/471 [00:07<02:44,  2.67it/s]  7%|▋         | 32/471 [00:08<02:38,  2.77it/s]  7%|▋         | 33/471 [00:08<02:33,  2.85it/s]  7%|▋         | 34/471 [00:08<02:29,  2.92it/s]  7%|▋         | 35/471 [00:09<02:40,  2.72it/s]  8%|▊         | 36/471 [00:09<02:47,  2.60it/s]  8%|▊         | 37/471 [00:09<02:48,  2.58it/s]  8%|▊         | 38/471 [00:10<02:40,  2.70it/s]  8%|▊         | 39/471 [00:10<02:34,  2.79it/s]  8%|▊         | 40/471 [00:10<02:30,  2.86it/s]  9%|▊         | 41/471 [00:11<02:33,  2.81it/s]  9%|▉         | 42/471 [00:11<02:38,  2.71it/s]  9%|▉         | 43/471 [00:11<02:32,  2.80it/s]  9%|▉         | 44/471 [00:12<02:27,  2.89it/s] 10%|▉         | 45/471 [00:12<02:38,  2.68it/s] 10%|▉         | 46/471 [00:13<02:45,  2.57it/s] 10%|▉         | 47/471 [00:13<02:44,  2.58it/s] 10%|█         | 48/471 [00:13<02:36,  2.70it/s] 10%|█         | 49/471 [00:14<02:31,  2.78it/s] 11%|█         | 50/471 [00:14<02:25,  2.89it/s] 11%|█         | 51/471 [00:14<02:32,  2.76it/s] 11%|█         | 52/471 [00:15<02:40,  2.61it/s] 11%|█▏        | 53/471 [00:15<02:45,  2.52it/s] 11%|█▏        | 54/471 [00:16<02:37,  2.64it/s] 12%|█▏        | 55/471 [00:16<02:31,  2.75it/s] 12%|█▏        | 56/471 [00:16<02:27,  2.82it/s] 12%|█▏        | 57/471 [00:17<02:26,  2.83it/s] 12%|█▏        | 58/471 [00:17<02:35,  2.65it/s] 13%|█▎        | 59/471 [00:18<02:42,  2.54it/s] 13%|█▎        | 60/471 [00:18<02:38,  2.59it/s] 13%|█▎        | 61/471 [00:18<02:32,  2.69it/s] 13%|█▎        | 62/471 [00:19<02:27,  2.77it/s] 13%|█▎        | 63/471 [00:19<02:21,  2.88it/s] 14%|█▎        | 64/471 [00:19<02:29,  2.72it/s] 14%|█▍        | 65/471 [00:20<02:30,  2.69it/s] 14%|█▍        | 66/471 [00:20<02:26,  2.77it/s] 14%|█▍        | 67/471 [00:20<02:23,  2.82it/s] 14%|█▍        | 68/471 [00:21<02:33,  2.62it/s] 15%|█▍        | 69/471 [00:21<02:38,  2.53it/s] 15%|█▍        | 70/471 [00:22<02:34,  2.59it/s] 15%|█▌        | 71/471 [00:22<02:28,  2.69it/s] 15%|█▌        | 72/471 [00:22<02:24,  2.77it/s] 15%|█▌        | 73/471 [00:23<02:17,  2.89it/s] 16%|█▌        | 74/471 [00:23<02:27,  2.69it/s] 16%|█▌        | 75/471 [00:23<02:34,  2.56it/s] 16%|█▌        | 76/471 [00:24<02:35,  2.54it/s] 16%|█▋        | 77/471 [00:24<02:28,  2.66it/s] 17%|█▋        | 78/471 [00:24<02:23,  2.75it/s] 17%|█▋        | 79/471 [00:25<02:19,  2.81it/s] 17%|█▋        | 80/471 [00:25<02:20,  2.78it/s] 17%|█▋        | 81/471 [00:26<02:28,  2.62it/s] 17%|█▋        | 82/471 [00:26<02:33,  2.53it/s] 18%|█▊        | 83/471 [00:26<02:28,  2.62it/s] 18%|█▊        | 84/471 [00:27<02:22,  2.72it/s] 18%|█▊        | 85/471 [00:27<02:18,  2.79it/s] 18%|█▊        | 86/471 [00:27<02:12,  2.90it/s] 18%|█▊        | 87/471 [00:28<02:21,  2.72it/s] 19%|█▊        | 88/471 [00:28<02:19,  2.75it/s] 19%|█▉        | 89/471 [00:28<02:13,  2.86it/s] 19%|█▉        | 90/471 [00:29<02:15,  2.80it/s] 19%|█▉        | 91/471 [00:29<02:24,  2.63it/s] 20%|█▉        | 92/471 [00:30<02:29,  2.54it/s] 20%|█▉        | 93/471 [00:30<02:23,  2.63it/s] 20%|█▉        | 94/471 [00:30<02:17,  2.74it/s] 20%|██        | 95/471 [00:31<02:13,  2.81it/s] 20%|██        | 96/471 [00:31<02:10,  2.88it/s] 21%|██        | 97/471 [00:31<02:19,  2.68it/s] 21%|██        | 98/471 [00:32<02:25,  2.56it/s] 21%|██        | 99/471 [00:32<02:25,  2.56it/s] 21%|██        | 100/471 [00:33<02:18,  2.68it/s] 21%|██▏       | 101/471 [00:33<02:14,  2.76it/s] 22%|██▏       | 102/471 [00:33<02:09,  2.85it/s] 22%|██▏       | 103/471 [00:34<02:14,  2.73it/s] 22%|██▏       | 104/471 [00:34<02:21,  2.59it/s] 22%|██▏       | 105/471 [00:35<02:26,  2.50it/s] 23%|██▎       | 106/471 [00:35<02:18,  2.63it/s] 23%|██▎       | 107/471 [00:35<02:12,  2.74it/s] 23%|██▎       | 108/471 [00:36<02:08,  2.82it/s] 23%|██▎       | 109/471 [00:36<02:07,  2.84it/s] 23%|██▎       | 110/471 [00:36<02:14,  2.68it/s] 24%|██▎       | 111/471 [00:37<02:10,  2.76it/s] 24%|██▍       | 112/471 [00:37<02:03,  2.91it/s] 24%|██▍       | 113/471 [00:37<02:12,  2.71it/s] 24%|██▍       | 114/471 [00:38<02:18,  2.58it/s] 24%|██▍       | 115/471 [00:38<02:20,  2.53it/s] 25%|██▍       | 116/471 [00:39<02:14,  2.64it/s] 25%|██▍       | 117/471 [00:39<02:09,  2.74it/s] 25%|██▌       | 118/471 [00:39<02:05,  2.81it/s] 25%|██▌       | 119/471 [00:40<02:05,  2.80it/s] 25%|██▌       | 120/471 [00:40<02:13,  2.62it/s] 26%|██▌       | 121/471 [00:40<02:18,  2.53it/s] 26%|██▌       | 122/471 [00:41<02:14,  2.60it/s] 26%|██▌       | 123/471 [00:41<02:08,  2.70it/s] 26%|██▋       | 124/471 [00:42<02:05,  2.77it/s] 27%|██▋       | 125/471 [00:42<02:01,  2.86it/s] 27%|██▋       | 126/471 [00:42<02:09,  2.67it/s] 27%|██▋       | 127/471 [00:43<02:15,  2.54it/s] 27%|██▋       | 128/471 [00:43<02:15,  2.52it/s] 27%|██▋       | 129/471 [00:43<02:08,  2.66it/s] 28%|██▊       | 130/471 [00:44<02:04,  2.73it/s] 28%|██▊       | 131/471 [00:44<01:59,  2.84it/s] 28%|██▊       | 132/471 [00:45<02:04,  2.72it/s] 28%|██▊       | 133/471 [00:45<02:06,  2.67it/s] 28%|██▊       | 134/471 [00:45<02:01,  2.76it/s] 29%|██▊       | 135/471 [00:45<01:46,  3.14it/s] 29%|██▉       | 136/471 [00:46<01:33,  3.57it/s] 29%|██▉       | 137/471 [00:46<01:25,  3.91it/s] 29%|██▉       | 138/471 [00:46<01:19,  4.21it/s] 30%|██▉       | 139/471 [00:46<01:14,  4.45it/s] 30%|██▉       | 140/471 [00:46<01:10,  4.66it/s] 30%|██▉       | 141/471 [00:47<01:08,  4.83it/s] 30%|███       | 142/471 [00:47<01:06,  4.94it/s] 30%|███       | 143/471 [00:47<01:05,  5.02it/s] 31%|███       | 144/471 [00:47<01:04,  5.06it/s] 31%|███       | 145/471 [00:47<01:04,  5.07it/s] 31%|███       | 146/471 [00:48<01:04,  5.06it/s] 31%|███       | 147/471 [00:48<01:04,  5.06it/s] 31%|███▏      | 148/471 [00:48<01:03,  5.07it/s] 32%|███▏      | 149/471 [00:48<01:03,  5.10it/s] 32%|███▏      | 150/471 [00:48<01:03,  5.09it/s] 32%|███▏      | 151/471 [00:49<01:02,  5.09it/s] 32%|███▏      | 152/471 [00:49<01:02,  5.11it/s] 32%|███▏      | 153/471 [00:49<01:01,  5.14it/s] 33%|███▎      | 154/471 [00:49<01:01,  5.18it/s] 33%|███▎      | 155/471 [00:49<01:00,  5.19it/s] 33%|███▎      | 156/471 [00:50<01:01,  5.12it/s] 33%|███▎      | 157/471 [00:50<01:19,  3.97it/s] 34%|███▎      | 158/471 [00:50<01:34,  3.30it/s] 34%|███▍      | 159/471 [00:51<01:46,  2.93it/s] 34%|███▍      | 160/471 [00:51<01:46,  2.91it/s] 34%|███▍      | 161/471 [00:51<01:45,  2.93it/s] 34%|███▍      | 162/471 [00:52<01:45,  2.94it/s] 35%|███▍      | 163/471 [00:52<01:44,  2.96it/s] 35%|███▍      | 164/471 [00:53<01:52,  2.73it/s] 35%|███▌      | 165/471 [00:53<01:58,  2.59it/s] 35%|███▌      | 166/471 [00:53<01:58,  2.58it/s] 35%|███▌      | 167/471 [00:54<01:52,  2.69it/s] 36%|███▌      | 168/471 [00:54<01:49,  2.77it/s] 36%|███▌      | 169/471 [00:54<01:44,  2.89it/s] 36%|███▌      | 170/471 [00:55<01:49,  2.75it/s] 36%|███▋      | 171/471 [00:55<01:55,  2.60it/s] 37%|███▋      | 172/471 [00:56<01:58,  2.52it/s] 37%|███▋      | 173/471 [00:56<01:52,  2.64it/s] 37%|███▋      | 174/471 [00:56<01:49,  2.72it/s] 37%|███▋      | 175/471 [00:57<01:46,  2.77it/s] 37%|███▋      | 176/471 [00:57<01:46,  2.76it/s] 38%|███▊      | 177/471 [00:57<01:51,  2.63it/s] 38%|███▊      | 178/471 [00:58<01:47,  2.72it/s] 38%|███▊      | 179/471 [00:58<01:42,  2.84it/s] 38%|███▊      | 180/471 [00:59<01:50,  2.64it/s] 38%|███▊      | 181/471 [00:59<01:54,  2.53it/s] 39%|███▊      | 182/471 [00:59<01:55,  2.51it/s] 39%|███▉      | 183/471 [01:00<01:49,  2.63it/s] 39%|███▉      | 184/471 [01:00<01:45,  2.73it/s] 39%|███▉      | 185/471 [01:00<01:42,  2.80it/s] 39%|███▉      | 186/471 [01:01<01:43,  2.75it/s] 40%|███▉      | 187/471 [01:01<01:49,  2.60it/s] 40%|███▉      | 188/471 [01:02<01:52,  2.51it/s] 40%|████      | 189/471 [01:02<01:47,  2.61it/s] 40%|████      | 190/471 [01:02<01:43,  2.71it/s] 41%|████      | 191/471 [01:03<01:40,  2.79it/s] 41%|████      | 192/471 [01:03<01:37,  2.86it/s] 41%|████      | 193/471 [01:03<01:43,  2.68it/s] 41%|████      | 194/471 [01:04<01:48,  2.56it/s] 41%|████▏     | 195/471 [01:04<01:47,  2.56it/s] 42%|████▏     | 196/471 [01:05<01:42,  2.67it/s] 42%|████▏     | 197/471 [01:05<01:38,  2.77it/s] 42%|████▏     | 198/471 [01:05<01:35,  2.85it/s] 42%|████▏     | 199/471 [01:06<01:37,  2.79it/s] 42%|████▏     | 200/471 [01:06<01:40,  2.69it/s] 43%|████▎     | 201/471 [01:06<01:36,  2.79it/s] 43%|████▎     | 202/471 [01:07<01:34,  2.86it/s] 43%|████▎     | 203/471 [01:07<01:40,  2.66it/s] 43%|████▎     | 204/471 [01:08<01:44,  2.55it/s] 44%|████▎     | 205/471 [01:08<01:43,  2.56it/s] 44%|████▎     | 206/471 [01:08<01:38,  2.68it/s] 44%|████▍     | 207/471 [01:09<01:35,  2.76it/s] 44%|████▍     | 208/471 [01:09<01:31,  2.87it/s] 44%|████▍     | 209/471 [01:09<01:34,  2.76it/s] 45%|████▍     | 210/471 [01:10<01:39,  2.61it/s] 45%|████▍     | 211/471 [01:10<01:42,  2.53it/s] 45%|████▌     | 212/471 [01:10<01:38,  2.64it/s] 45%|████▌     | 213/471 [01:11<01:33,  2.75it/s] 45%|████▌     | 214/471 [01:11<01:30,  2.83it/s] 46%|████▌     | 215/471 [01:11<01:29,  2.85it/s] 46%|████▌     | 216/471 [01:12<01:35,  2.66it/s] 46%|████▌     | 217/471 [01:12<01:39,  2.56it/s] 46%|████▋     | 218/471 [01:13<01:38,  2.57it/s] 46%|████▋     | 219/471 [01:13<01:33,  2.69it/s] 47%|████▋     | 220/471 [01:13<01:30,  2.77it/s] 47%|████▋     | 221/471 [01:14<01:26,  2.88it/s] 47%|████▋     | 222/471 [01:14<01:31,  2.72it/s] 47%|████▋     | 223/471 [01:15<01:32,  2.69it/s] 48%|████▊     | 224/471 [01:15<01:29,  2.77it/s] 48%|████▊     | 225/471 [01:15<01:27,  2.81it/s] 48%|████▊     | 226/471 [01:16<01:33,  2.63it/s] 48%|████▊     | 227/471 [01:16<01:36,  2.54it/s] 48%|████▊     | 228/471 [01:16<01:34,  2.58it/s] 49%|████▊     | 229/471 [01:17<01:30,  2.68it/s] 49%|████▉     | 230/471 [01:17<01:27,  2.76it/s] 49%|████▉     | 231/471 [01:17<01:22,  2.90it/s] 49%|████▉     | 232/471 [01:18<01:28,  2.69it/s] 49%|████▉     | 233/471 [01:18<01:32,  2.56it/s] 50%|████▉     | 234/471 [01:19<01:34,  2.52it/s] 50%|████▉     | 235/471 [01:19<01:29,  2.64it/s] 50%|█████     | 236/471 [01:19<01:25,  2.74it/s] 50%|█████     | 237/471 [01:20<01:23,  2.81it/s] 51%|█████     | 238/471 [01:20<01:23,  2.79it/s] 51%|█████     | 239/471 [01:20<01:28,  2.63it/s] 51%|█████     | 240/471 [01:21<01:31,  2.52it/s] 51%|█████     | 241/471 [01:21<01:28,  2.59it/s] 51%|█████▏    | 242/471 [01:22<01:24,  2.70it/s] 52%|█████▏    | 243/471 [01:22<01:22,  2.78it/s] 52%|█████▏    | 244/471 [01:22<01:19,  2.85it/s] 52%|█████▏    | 245/471 [01:23<01:24,  2.68it/s] 52%|█████▏    | 246/471 [01:23<01:23,  2.71it/s] 52%|█████▏    | 247/471 [01:23<01:18,  2.84it/s] 53%|█████▎    | 248/471 [01:24<01:20,  2.76it/s] 53%|█████▎    | 249/471 [01:24<01:25,  2.60it/s] 53%|█████▎    | 250/471 [01:25<01:28,  2.51it/s] 53%|█████▎    | 251/471 [01:25<01:24,  2.61it/s] 54%|█████▎    | 252/471 [01:25<01:20,  2.71it/s] 54%|█████▎    | 253/471 [01:26<01:18,  2.78it/s] 54%|█████▍    | 254/471 [01:26<01:16,  2.82it/s] 54%|█████▍    | 255/471 [01:26<01:22,  2.63it/s] 54%|█████▍    | 256/471 [01:27<01:25,  2.52it/s] 55%|█████▍    | 257/471 [01:27<01:23,  2.55it/s] 55%|█████▍    | 258/471 [01:28<01:19,  2.66it/s] 55%|█████▍    | 259/471 [01:28<01:17,  2.75it/s] 55%|█████▌    | 260/471 [01:28<01:13,  2.87it/s] 55%|█████▌    | 261/471 [01:29<01:18,  2.68it/s] 56%|█████▌    | 262/471 [01:29<01:21,  2.56it/s] 56%|█████▌    | 263/471 [01:30<01:22,  2.52it/s] 56%|█████▌    | 264/471 [01:30<01:18,  2.63it/s] 56%|█████▋    | 265/471 [01:30<01:15,  2.71it/s] 56%|█████▋    | 266/471 [01:31<01:13,  2.78it/s] 57%|█████▋    | 267/471 [01:31<01:13,  2.77it/s] 57%|█████▋    | 268/471 [01:31<01:16,  2.65it/s] 57%|█████▋    | 269/471 [01:32<01:13,  2.76it/s] 57%|█████▋    | 270/471 [01:32<01:06,  3.05it/s] 58%|█████▊    | 271/471 [01:32<00:57,  3.48it/s] 58%|█████▊    | 272/471 [01:32<00:51,  3.84it/s] 58%|█████▊    | 273/471 [01:32<00:47,  4.16it/s] 58%|█████▊    | 274/471 [01:33<00:44,  4.44it/s] 58%|█████▊    | 275/471 [01:33<00:42,  4.65it/s] 59%|█████▊    | 276/471 [01:33<00:40,  4.81it/s] 59%|█████▉    | 277/471 [01:33<00:39,  4.93it/s] 59%|█████▉    | 278/471 [01:33<00:38,  5.01it/s] 59%|█████▉    | 279/471 [01:34<00:37,  5.07it/s] 59%|█████▉    | 280/471 [01:34<00:37,  5.11it/s] 60%|█████▉    | 281/471 [01:34<00:37,  5.12it/s] 60%|█████▉    | 282/471 [01:34<00:36,  5.16it/s] 60%|██████    | 283/471 [01:34<00:36,  5.18it/s] 60%|██████    | 284/471 [01:35<00:36,  5.19it/s] 61%|██████    | 285/471 [01:35<00:35,  5.18it/s] 61%|██████    | 286/471 [01:35<00:35,  5.18it/s] 61%|██████    | 287/471 [01:35<00:35,  5.16it/s] 61%|██████    | 288/471 [01:35<00:35,  5.19it/s] 61%|██████▏   | 289/471 [01:36<00:34,  5.20it/s] 62%|██████▏   | 290/471 [01:36<00:34,  5.20it/s] 62%|██████▏   | 291/471 [01:36<00:34,  5.15it/s] 62%|██████▏   | 292/471 [01:36<00:34,  5.17it/s] 62%|██████▏   | 293/471 [01:36<00:34,  5.19it/s] 62%|██████▏   | 294/471 [01:37<00:33,  5.21it/s] 63%|██████▎   | 295/471 [01:37<00:34,  5.16it/s] 63%|██████▎   | 296/471 [01:37<00:33,  5.16it/s] 63%|██████▎   | 297/471 [01:37<00:33,  5.12it/s] 63%|██████▎   | 298/471 [01:37<00:33,  5.10it/s] 63%|██████▎   | 299/471 [01:37<00:33,  5.14it/s] 64%|██████▎   | 300/471 [01:38<00:33,  5.13it/s] 64%|██████▍   | 301/471 [01:38<00:33,  5.05it/s] 64%|██████▍   | 302/471 [01:38<00:37,  4.46it/s] 64%|██████▍   | 303/471 [01:38<00:35,  4.67it/s] 65%|██████▍   | 304/471 [01:39<00:34,  4.83it/s] 65%|██████▍   | 305/471 [01:39<00:33,  4.89it/s] 65%|██████▍   | 306/471 [01:39<00:34,  4.80it/s] 65%|██████▌   | 307/471 [01:39<00:44,  3.65it/s] 65%|██████▌   | 308/471 [01:40<00:52,  3.13it/s] 66%|██████▌   | 309/471 [01:40<00:54,  2.96it/s] 66%|██████▌   | 310/471 [01:41<00:54,  2.98it/s] 66%|██████▌   | 311/471 [01:41<00:53,  2.98it/s] 66%|██████▌   | 312/471 [01:41<00:51,  3.07it/s] 66%|██████▋   | 313/471 [01:42<00:55,  2.85it/s] 67%|██████▋   | 314/471 [01:42<00:58,  2.67it/s] 67%|██████▋   | 315/471 [01:42<01:00,  2.56it/s] 67%|██████▋   | 316/471 [01:43<00:57,  2.68it/s] 67%|██████▋   | 317/471 [01:43<00:55,  2.77it/s] 68%|██████▊   | 318/471 [01:43<00:54,  2.83it/s] 68%|██████▊   | 319/471 [01:44<00:53,  2.84it/s] 68%|██████▊   | 320/471 [01:44<00:56,  2.67it/s] 68%|██████▊   | 321/471 [01:45<00:58,  2.56it/s] 68%|██████▊   | 322/471 [01:45<00:57,  2.57it/s] 69%|██████▊   | 323/471 [01:45<00:54,  2.70it/s] 69%|██████▉   | 324/471 [01:46<00:52,  2.79it/s] 69%|██████▉   | 325/471 [01:46<00:50,  2.92it/s] 69%|██████▉   | 326/471 [01:46<00:52,  2.74it/s] 69%|██████▉   | 327/471 [01:47<00:53,  2.71it/s] 70%|██████▉   | 328/471 [01:47<00:51,  2.79it/s] 70%|██████▉   | 329/471 [01:47<00:50,  2.82it/s] 70%|███████   | 330/471 [01:48<00:53,  2.64it/s] 70%|███████   | 331/471 [01:48<00:55,  2.54it/s] 70%|███████   | 332/471 [01:49<00:53,  2.59it/s] 71%|███████   | 333/471 [01:49<00:50,  2.72it/s] 71%|███████   | 334/471 [01:49<00:48,  2.81it/s] 71%|███████   | 335/471 [01:50<00:46,  2.94it/s] 71%|███████▏  | 336/471 [01:50<00:49,  2.73it/s] 72%|███████▏  | 337/471 [01:51<00:51,  2.59it/s] 72%|███████▏  | 338/471 [01:51<00:52,  2.53it/s] 72%|███████▏  | 339/471 [01:51<00:49,  2.65it/s] 72%|███████▏  | 340/471 [01:52<00:47,  2.75it/s] 72%|███████▏  | 341/471 [01:52<00:46,  2.82it/s] 73%|███████▎  | 342/471 [01:52<00:46,  2.80it/s] 73%|███████▎  | 343/471 [01:53<00:48,  2.63it/s] 73%|███████▎  | 344/471 [01:53<00:50,  2.53it/s] 73%|███████▎  | 345/471 [01:54<00:48,  2.61it/s] 73%|███████▎  | 346/471 [01:54<00:46,  2.71it/s] 74%|███████▎  | 347/471 [01:54<00:44,  2.80it/s] 74%|███████▍  | 348/471 [01:55<00:43,  2.85it/s] 74%|███████▍  | 349/471 [01:55<00:45,  2.69it/s] 74%|███████▍  | 350/471 [01:55<00:44,  2.72it/s] 75%|███████▍  | 351/471 [01:56<00:42,  2.83it/s] 75%|███████▍  | 352/471 [01:56<00:43,  2.76it/s] 75%|███████▍  | 353/471 [01:56<00:45,  2.61it/s] 75%|███████▌  | 354/471 [01:57<00:46,  2.53it/s] 75%|███████▌  | 355/471 [01:57<00:44,  2.63it/s] 76%|███████▌  | 356/471 [01:58<00:42,  2.73it/s] 76%|███████▌  | 357/471 [01:58<00:40,  2.80it/s] 76%|███████▌  | 358/471 [01:58<00:39,  2.87it/s] 76%|███████▌  | 359/471 [01:59<00:42,  2.66it/s] 76%|███████▋  | 360/471 [01:59<00:43,  2.55it/s] 77%|███████▋  | 361/471 [01:59<00:42,  2.56it/s] 77%|███████▋  | 362/471 [02:00<00:40,  2.67it/s] 77%|███████▋  | 363/471 [02:00<00:39,  2.76it/s] 77%|███████▋  | 364/471 [02:00<00:37,  2.88it/s] 77%|███████▋  | 365/471 [02:01<00:38,  2.74it/s] 78%|███████▊  | 366/471 [02:01<00:40,  2.59it/s] 78%|███████▊  | 367/471 [02:02<00:41,  2.51it/s] 78%|███████▊  | 368/471 [02:02<00:38,  2.64it/s] 78%|███████▊  | 369/471 [02:02<00:37,  2.74it/s] 79%|███████▊  | 370/471 [02:03<00:35,  2.81it/s] 79%|███████▉  | 371/471 [02:03<00:35,  2.83it/s] 79%|███████▉  | 372/471 [02:03<00:37,  2.68it/s] 79%|███████▉  | 373/471 [02:04<00:35,  2.76it/s] 79%|███████▉  | 374/471 [02:04<00:33,  2.91it/s] 80%|███████▉  | 375/471 [02:05<00:35,  2.70it/s] 80%|███████▉  | 376/471 [02:05<00:36,  2.57it/s] 80%|████████  | 377/471 [02:05<00:37,  2.52it/s] 80%|████████  | 378/471 [02:06<00:35,  2.64it/s] 80%|████████  | 379/471 [02:06<00:33,  2.73it/s] 81%|████████  | 380/471 [02:06<00:32,  2.82it/s] 81%|████████  | 381/471 [02:07<00:32,  2.79it/s] 81%|████████  | 382/471 [02:07<00:33,  2.63it/s] 81%|████████▏ | 383/471 [02:08<00:34,  2.53it/s] 82%|████████▏ | 384/471 [02:08<00:33,  2.63it/s] 82%|████████▏ | 385/471 [02:08<00:31,  2.74it/s] 82%|████████▏ | 386/471 [02:09<00:30,  2.81it/s] 82%|████████▏ | 387/471 [02:09<00:29,  2.86it/s] 82%|████████▏ | 388/471 [02:09<00:31,  2.67it/s] 83%|████████▎ | 389/471 [02:10<00:31,  2.56it/s] 83%|████████▎ | 390/471 [02:10<00:31,  2.57it/s] 83%|████████▎ | 391/471 [02:11<00:29,  2.68it/s] 83%|████████▎ | 392/471 [02:11<00:28,  2.76it/s] 83%|████████▎ | 393/471 [02:11<00:26,  2.89it/s] 84%|████████▎ | 394/471 [02:12<00:28,  2.72it/s] 84%|████████▍ | 395/471 [02:12<00:28,  2.68it/s] 84%|████████▍ | 396/471 [02:12<00:27,  2.77it/s] 84%|████████▍ | 397/471 [02:13<00:26,  2.82it/s] 85%|████████▍ | 398/471 [02:13<00:27,  2.63it/s] 85%|████████▍ | 399/471 [02:14<00:28,  2.53it/s] 85%|████████▍ | 400/471 [02:14<00:27,  2.59it/s] 85%|████████▌ | 401/471 [02:14<00:25,  2.70it/s] 85%|████████▌ | 402/471 [02:15<00:24,  2.78it/s] 86%|████████▌ | 403/471 [02:15<00:23,  2.91it/s] 86%|████████▌ | 404/471 [02:15<00:24,  2.70it/s] 86%|████████▌ | 405/471 [02:16<00:25,  2.56it/s] 86%|████████▌ | 406/471 [02:16<00:25,  2.54it/s] 86%|████████▋ | 407/471 [02:16<00:24,  2.66it/s] 87%|████████▋ | 408/471 [02:17<00:22,  2.76it/s] 87%|████████▋ | 409/471 [02:17<00:21,  2.83it/s] 87%|████████▋ | 410/471 [02:18<00:21,  2.80it/s] 87%|████████▋ | 411/471 [02:18<00:22,  2.64it/s] 87%|████████▋ | 412/471 [02:18<00:23,  2.53it/s] 88%|████████▊ | 413/471 [02:19<00:22,  2.62it/s] 88%|████████▊ | 414/471 [02:19<00:20,  2.72it/s] 88%|████████▊ | 415/471 [02:19<00:20,  2.80it/s] 88%|████████▊ | 416/471 [02:20<00:19,  2.86it/s] 89%|████████▊ | 417/471 [02:20<00:19,  2.71it/s] 89%|████████▊ | 418/471 [02:20<00:19,  2.75it/s] 89%|████████▉ | 419/471 [02:21<00:18,  2.89it/s] 89%|████████▉ | 420/471 [02:21<00:15,  3.38it/s] 89%|████████▉ | 421/471 [02:21<00:13,  3.77it/s] 90%|████████▉ | 422/471 [02:21<00:11,  4.09it/s] 90%|████████▉ | 423/471 [02:22<00:10,  4.37it/s] 90%|█████████ | 424/471 [02:22<00:10,  4.60it/s] 90%|█████████ | 425/471 [02:22<00:09,  4.80it/s] 90%|█████████ | 426/471 [02:22<00:09,  4.93it/s] 91%|█████████ | 427/471 [02:22<00:08,  5.01it/s] 91%|█████████ | 428/471 [02:23<00:08,  5.07it/s] 91%|█████████ | 429/471 [02:23<00:08,  5.11it/s] 91%|█████████▏| 430/471 [02:23<00:08,  5.09it/s] 92%|█████████▏| 431/471 [02:23<00:07,  5.09it/s] 92%|█████████▏| 432/471 [02:23<00:07,  5.10it/s] 92%|█████████▏| 433/471 [02:23<00:07,  5.10it/s] 92%|█████████▏| 434/471 [02:24<00:07,  5.14it/s] 92%|█████████▏| 435/471 [02:24<00:07,  5.08it/s] 93%|█████████▎| 436/471 [02:24<00:07,  4.55it/s] 93%|█████████▎| 437/471 [02:24<00:07,  4.65it/s] 93%|█████████▎| 438/471 [02:25<00:06,  4.82it/s] 93%|█████████▎| 439/471 [02:25<00:06,  4.94it/s] 93%|█████████▎| 440/471 [02:25<00:06,  4.97it/s] 94%|█████████▎| 441/471 [02:25<00:07,  4.04it/s] 94%|█████████▍| 442/471 [02:26<00:08,  3.34it/s] 94%|█████████▍| 443/471 [02:26<00:09,  2.98it/s] 94%|█████████▍| 444/471 [02:26<00:09,  2.98it/s] 94%|█████████▍| 445/471 [02:27<00:08,  2.98it/s] 95%|█████████▍| 446/471 [02:27<00:08,  2.99it/s] 95%|█████████▍| 447/471 [02:27<00:08,  2.96it/s] 95%|█████████▌| 448/471 [02:28<00:08,  2.73it/s] 95%|█████████▌| 449/471 [02:28<00:08,  2.60it/s] 96%|█████████▌| 450/471 [02:29<00:07,  2.65it/s] 96%|█████████▌| 451/471 [02:29<00:07,  2.75it/s] 96%|█████████▌| 452/471 [02:29<00:06,  2.83it/s] 96%|█████████▌| 453/471 [02:30<00:06,  2.94it/s] 96%|█████████▋| 454/471 [02:30<00:06,  2.73it/s] 97%|█████████▋| 455/471 [02:31<00:06,  2.59it/s] 97%|█████████▋| 456/471 [02:31<00:05,  2.55it/s] 97%|█████████▋| 457/471 [02:31<00:05,  2.68it/s] 97%|█████████▋| 458/471 [02:32<00:04,  2.77it/s] 97%|█████████▋| 459/471 [02:32<00:04,  2.85it/s] 98%|█████████▊| 460/471 [02:32<00:03,  2.81it/s] 98%|█████████▊| 461/471 [02:33<00:03,  2.69it/s] 98%|█████████▊| 462/471 [02:33<00:03,  2.80it/s] 98%|█████████▊| 463/471 [02:33<00:02,  2.90it/s] 99%|█████████▊| 464/471 [02:34<00:02,  2.69it/s] 99%|█████████▊| 465/471 [02:34<00:02,  2.58it/s] 99%|█████████▉| 466/471 [02:35<00:01,  2.57it/s] 99%|█████████▉| 467/471 [02:35<00:01,  2.69it/s] 99%|█████████▉| 468/471 [02:35<00:01,  2.78it/s]100%|█████████▉| 469/471 [02:36<00:00,  2.87it/s]100%|█████████▉| 470/471 [02:36<00:00,  2.83it/s]100%|██████████| 471/471 [02:36<00:00,  2.86it/s]100%|██████████| 471/471 [02:36<00:00,  3.00it/s]
{'eval_loss': 2.0317270755767822, 'eval_model_preparation_time': 0.0055, 'eval_acc': 0.4706585236325013, 'eval_runtime': 156.9579, 'eval_samples_per_second': 47.987, 'eval_steps_per_second': 3.001}
ROUND:19
CLIENT:83
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.59it/s]                                              {'loss': 1.9364, 'grad_norm': 10.514900207519531, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.59it/s]  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]                                              {'loss': 1.2326, 'grad_norm': 9.902785301208496, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]  8%|▊         | 3/40 [00:01<00:24,  1.50it/s]                                              {'loss': 2.3512, 'grad_norm': 21.232389450073242, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.50it/s] 10%|█         | 4/40 [00:02<00:24,  1.47it/s]                                              {'loss': 1.6835, 'grad_norm': 20.43950653076172, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.47it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.39it/s]                                              {'loss': 1.3564, 'grad_norm': 16.353885650634766, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.39it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s]                                              {'loss': 1.9439, 'grad_norm': 21.646804809570312, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.46it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s]                                              {'loss': 1.0044, 'grad_norm': 15.997475624084473, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.46it/s] 20%|██        | 8/40 [00:04<00:16,  1.88it/s]                                              {'loss': 3.3542, 'grad_norm': 95.78605651855469, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.88it/s] 22%|██▎       | 9/40 [00:05<00:18,  1.68it/s]                                              {'loss': 0.6351, 'grad_norm': 10.218578338623047, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:18,  1.68it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.66it/s]                                               {'loss': 0.8351, 'grad_norm': 4.91883659362793, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.66it/s] 28%|██▊       | 11/40 [00:07<00:18,  1.55it/s]                                               {'loss': 0.7347, 'grad_norm': 7.536332607269287, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:18,  1.55it/s] 30%|███       | 12/40 [00:07<00:19,  1.47it/s]                                               {'loss': 1.0273, 'grad_norm': 13.599513053894043, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:19,  1.47it/s] 32%|███▎      | 13/40 [00:08<00:18,  1.50it/s]                                               {'loss': 0.2573, 'grad_norm': 5.876535415649414, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:18,  1.50it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s]                                               {'loss': 0.8524, 'grad_norm': 8.091163635253906, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.46it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s]                                               {'loss': 0.4582, 'grad_norm': 9.658968925476074, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.52it/s] 40%|████      | 16/40 [00:09<00:11,  2.03it/s]                                               {'loss': 0.6034, 'grad_norm': 37.941776275634766, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:11,  2.03it/s] 42%|████▎     | 17/40 [00:10<00:13,  1.68it/s]                                               {'loss': 0.2238, 'grad_norm': 6.520975589752197, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:13,  1.68it/s] 45%|████▌     | 18/40 [00:11<00:13,  1.62it/s]                                               {'loss': 0.2868, 'grad_norm': 6.113437652587891, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:13,  1.62it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.64it/s]                                               {'loss': 0.569, 'grad_norm': 6.211877346038818, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.64it/s] 50%|█████     | 20/40 [00:12<00:13,  1.48it/s]                                               {'loss': 0.128, 'grad_norm': 2.0346906185150146, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:13,  1.48it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.47it/s]                                               {'loss': 0.5071, 'grad_norm': 7.837040424346924, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.47it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.52it/s]                                               {'loss': 0.5437, 'grad_norm': 7.296391487121582, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.52it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.42it/s]                                               {'loss': 0.835, 'grad_norm': 10.84070873260498, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.42it/s] 60%|██████    | 24/40 [00:15<00:08,  1.91it/s]                                               {'loss': 0.0234, 'grad_norm': 1.6549001932144165, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:15<00:08,  1.91it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.76it/s]                                               {'loss': 0.2637, 'grad_norm': 12.655189514160156, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.76it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.74it/s]                                               {'loss': 0.1173, 'grad_norm': 5.385484218597412, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.74it/s] 68%|██████▊   | 27/40 [00:17<00:08,  1.59it/s]                                               {'loss': 0.4768, 'grad_norm': 8.249923706054688, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:17<00:08,  1.59it/s] 70%|███████   | 28/40 [00:17<00:07,  1.70it/s]                                               {'loss': 0.3356, 'grad_norm': 5.611918926239014, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.70it/s] 72%|███████▎  | 29/40 [00:17<00:05,  1.94it/s]                                               {'loss': 0.1145, 'grad_norm': 2.9443447589874268, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:05,  1.94it/s] 75%|███████▌  | 30/40 [00:18<00:04,  2.16it/s]                                               {'loss': 0.6581, 'grad_norm': 6.405743598937988, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:04,  2.16it/s] 78%|███████▊  | 31/40 [00:18<00:03,  2.35it/s]                                               {'loss': 0.5334, 'grad_norm': 4.85253381729126, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:03,  2.35it/s]                                               {'loss': 2.6724, 'grad_norm': 136.23643493652344, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:03,  2.35it/s] 82%|████████▎ | 33/40 [00:18<00:02,  3.09it/s]                                               {'loss': 0.4328, 'grad_norm': 2.9238739013671875, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:02,  3.09it/s] 85%|████████▌ | 34/40 [00:19<00:01,  3.03it/s]                                               {'loss': 0.0478, 'grad_norm': 1.3496201038360596, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:01,  3.03it/s] 88%|████████▊ | 35/40 [00:19<00:01,  2.99it/s]                                               {'loss': 0.1229, 'grad_norm': 2.2877328395843506, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:01,  2.99it/s] 90%|█████████ | 36/40 [00:20<00:01,  2.98it/s]                                               {'loss': 0.1325, 'grad_norm': 2.974303722381592, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:01,  2.98it/s] 92%|█████████▎| 37/40 [00:20<00:01,  2.98it/s]                                               {'loss': 0.184, 'grad_norm': 6.646875858306885, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  2.98it/s] 95%|█████████▌| 38/40 [00:20<00:00,  2.66it/s]                                               {'loss': 0.2593, 'grad_norm': 3.182339906692505, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:20<00:00,  2.66it/s] 98%|█████████▊| 39/40 [00:21<00:00,  2.00it/s]                                               {'loss': 0.7882, 'grad_norm': 8.674214363098145, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:21<00:00,  2.00it/s]100%|██████████| 40/40 [00:21<00:00,  2.61it/s]                                               {'loss': 0.0218, 'grad_norm': 1.2644497156143188, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.61it/s]                                               {'train_runtime': 21.9942, 'train_samples_per_second': 25.689, 'train_steps_per_second': 1.819, 'train_loss': 0.7636034461203962, 'epoch': 5.0}
100%|██████████| 40/40 [00:21<00:00,  2.61it/s]100%|██████████| 40/40 [00:21<00:00,  1.82it/s]
CLIENT:1
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.61it/s]                                              {'loss': 2.0601, 'grad_norm': 11.44320297241211, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.61it/s]  5%|▌         | 2/40 [00:01<00:24,  1.55it/s]                                              {'loss': 1.4377, 'grad_norm': 7.722314357757568, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.55it/s]  8%|▊         | 3/40 [00:01<00:24,  1.52it/s]                                              {'loss': 2.2663, 'grad_norm': 19.019248962402344, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:24,  1.52it/s] 10%|█         | 4/40 [00:02<00:24,  1.46it/s]                                              {'loss': 1.3878, 'grad_norm': 15.674928665161133, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:24,  1.46it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.41it/s]                                              {'loss': 1.5168, 'grad_norm': 22.67023468017578, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.41it/s] 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s]                                              {'loss': 2.1222, 'grad_norm': 18.890804290771484, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:23,  1.47it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s]                                              {'loss': 1.0578, 'grad_norm': 13.54637336730957, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.45it/s] 20%|██        | 8/40 [00:04<00:16,  1.97it/s]                                              {'loss': 0.6037, 'grad_norm': 49.20166015625, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.97it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.73it/s]                                              {'loss': 0.3069, 'grad_norm': 4.783142566680908, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.73it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.70it/s]                                               {'loss': 0.4665, 'grad_norm': 8.43994426727295, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.70it/s] 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s]                                               {'loss': 0.4054, 'grad_norm': 4.8358964920043945, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s] 30%|███       | 12/40 [00:07<00:18,  1.48it/s]                                               {'loss': 0.7442, 'grad_norm': 8.86013412475586, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:18,  1.48it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.51it/s]                                               {'loss': 0.8161, 'grad_norm': 8.290997505187988, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.51it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s]                                               {'loss': 1.2297, 'grad_norm': 10.178096771240234, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.49it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.50it/s]                                               {'loss': 0.7006, 'grad_norm': 6.135654926300049, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.50it/s]                                               {'loss': 0.6107, 'grad_norm': 28.278324127197266, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:15,  1.50it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.80it/s]                                               {'loss': 0.6106, 'grad_norm': 7.6512627601623535, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.80it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.70it/s]                                               {'loss': 0.2571, 'grad_norm': 5.950517177581787, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.70it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.68it/s]                                               {'loss': 0.7153, 'grad_norm': 4.734564781188965, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.68it/s] 50%|█████     | 20/40 [00:12<00:12,  1.57it/s]                                               {'loss': 0.1335, 'grad_norm': 3.6249754428863525, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.57it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.50it/s]                                               {'loss': 0.089, 'grad_norm': 3.372224807739258, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.50it/s] 55%|█████▌    | 22/40 [00:14<00:11,  1.51it/s]                                               {'loss': 0.1802, 'grad_norm': 4.822730541229248, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:11,  1.51it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.46it/s]                                               {'loss': 0.5697, 'grad_norm': 3.427031993865967, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.46it/s] 60%|██████    | 24/40 [00:14<00:08,  1.94it/s]                                               {'loss': 0.1431, 'grad_norm': 12.826776504516602, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:08,  1.94it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.75it/s]                                               {'loss': 0.0833, 'grad_norm': 2.043316125869751, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.75it/s] 65%|██████▌   | 26/40 [00:16<00:08,  1.70it/s]                                               {'loss': 0.0477, 'grad_norm': 1.1057260036468506, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:08,  1.70it/s] 68%|██████▊   | 27/40 [00:16<00:08,  1.59it/s]                                               {'loss': 0.3267, 'grad_norm': 10.237370491027832, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:08,  1.59it/s] 70%|███████   | 28/40 [00:17<00:07,  1.62it/s]                                               {'loss': 0.0424, 'grad_norm': 1.5083675384521484, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.62it/s] 72%|███████▎  | 29/40 [00:18<00:07,  1.48it/s]                                               {'loss': 0.692, 'grad_norm': 4.875707626342773, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:07,  1.48it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.48it/s]                                               {'loss': 0.7114, 'grad_norm': 4.978237152099609, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s]                                               {'loss': 0.2444, 'grad_norm': 2.6808509826660156, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.52it/s]                                               {'loss': 0.0073, 'grad_norm': 0.5382878184318542, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.52it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.79it/s]                                               {'loss': 0.3289, 'grad_norm': 5.780111789703369, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.79it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.69it/s]                                               {'loss': 0.0721, 'grad_norm': 3.7171154022216797, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.69it/s] 88%|████████▊ | 35/40 [00:21<00:02,  1.67it/s]                                               {'loss': 0.2006, 'grad_norm': 2.339808225631714, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:02,  1.67it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.55it/s]                                               {'loss': 0.1898, 'grad_norm': 12.766337394714355, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.55it/s] 92%|█████████▎| 37/40 [00:23<00:02,  1.49it/s]                                               {'loss': 0.4395, 'grad_norm': 1.4819444417953491, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:02,  1.49it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.53it/s]                                               {'loss': 0.0413, 'grad_norm': 1.2875474691390991, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.53it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.49it/s]                                               {'loss': 0.6474, 'grad_norm': 4.098088264465332, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.49it/s]                                               {'loss': 0.2983, 'grad_norm': 32.15813064575195, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.49it/s]                                               {'train_runtime': 24.9405, 'train_samples_per_second': 22.654, 'train_steps_per_second': 1.604, 'train_loss': 0.6201017339713871, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  1.49it/s]100%|██████████| 40/40 [00:24<00:00,  1.60it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.31it/s]                                              {'loss': 1.8594, 'grad_norm': 10.150412559509277, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.31it/s]  5%|▌         | 2/40 [00:01<00:29,  1.31it/s]                                              {'loss': 1.8805, 'grad_norm': 13.27463436126709, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:29,  1.31it/s]  8%|▊         | 3/40 [00:02<00:28,  1.31it/s]                                              {'loss': 0.6742, 'grad_norm': 12.19492244720459, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.31it/s] 10%|█         | 4/40 [00:02<00:25,  1.39it/s]                                              {'loss': 0.5839, 'grad_norm': 10.640125274658203, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:25,  1.39it/s] 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s]                                              {'loss': 1.3199, 'grad_norm': 16.84369468688965, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:25,  1.35it/s] 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s]                                              {'loss': 0.9661, 'grad_norm': 14.185195922851562, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:25,  1.33it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.32it/s]                                              {'loss': 1.9649, 'grad_norm': 32.27141189575195, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.32it/s] 20%|██        | 8/40 [00:05<00:23,  1.38it/s]                                              {'loss': 0.2541, 'grad_norm': 24.65289878845215, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.38it/s] 22%|██▎       | 9/40 [00:06<00:22,  1.35it/s]                                              {'loss': 0.5105, 'grad_norm': 11.783146858215332, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:22,  1.35it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.33it/s]                                               {'loss': 0.3376, 'grad_norm': 5.659517288208008, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.33it/s] 28%|██▊       | 11/40 [00:08<00:21,  1.34it/s]                                               {'loss': 0.5089, 'grad_norm': 6.855630874633789, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:21,  1.34it/s] 30%|███       | 12/40 [00:08<00:20,  1.36it/s]                                               {'loss': 0.6901, 'grad_norm': 7.130379676818848, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:20,  1.36it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.35it/s]                                               {'loss': 0.5132, 'grad_norm': 5.9847917556762695, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.35it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.33it/s]                                               {'loss': 0.3044, 'grad_norm': 5.038565635681152, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.33it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.32it/s]                                               {'loss': 0.7542, 'grad_norm': 6.173890113830566, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.32it/s]                                               {'loss': 0.0038, 'grad_norm': 0.4290831685066223, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.32it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.66it/s]                                               {'loss': 0.4696, 'grad_norm': 2.8447179794311523, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.66it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s]                                               {'loss': 0.1206, 'grad_norm': 5.066032886505127, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s]                                               {'loss': 0.2217, 'grad_norm': 3.820284366607666, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s] 50%|█████     | 20/40 [00:14<00:14,  1.41it/s]                                               {'loss': 0.2306, 'grad_norm': 3.958678960800171, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:14,  1.41it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.38it/s]                                               {'loss': 0.1807, 'grad_norm': 3.680785894393921, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.38it/s] 55%|█████▌    | 22/40 [00:15<00:13,  1.36it/s]                                               {'loss': 0.5959, 'grad_norm': 7.220300197601318, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:13,  1.36it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.35it/s]                                               {'loss': 0.1671, 'grad_norm': 5.60999059677124, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.35it/s] 60%|██████    | 24/40 [00:16<00:08,  1.80it/s]                                               {'loss': 0.0275, 'grad_norm': 0.6431246399879456, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:08,  1.80it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.61it/s]                                               {'loss': 0.0941, 'grad_norm': 2.2469546794891357, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.61it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.50it/s]                                               {'loss': 0.0472, 'grad_norm': 4.5170063972473145, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:09,  1.50it/s] 68%|██████▊   | 27/40 [00:19<00:09,  1.43it/s]                                               {'loss': 0.09, 'grad_norm': 2.822000503540039, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:09,  1.43it/s] 70%|███████   | 28/40 [00:19<00:08,  1.39it/s]                                               {'loss': 0.3579, 'grad_norm': 1.0233781337738037, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.39it/s] 72%|███████▎  | 29/40 [00:20<00:08,  1.36it/s]                                               {'loss': 0.0524, 'grad_norm': 1.924391508102417, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:08,  1.36it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.34it/s]                                               {'loss': 0.1271, 'grad_norm': 2.917733907699585, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.34it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.33it/s]                                               {'loss': 0.3397, 'grad_norm': 2.307095527648926, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.33it/s]                                               {'loss': 0.0119, 'grad_norm': 0.8578999638557434, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:06,  1.33it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.65it/s]                                               {'loss': 0.0174, 'grad_norm': 0.42201048135757446, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.65it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.56it/s]                                               {'loss': 0.3703, 'grad_norm': 6.646698474884033, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.56it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.54it/s]                                               {'loss': 0.0291, 'grad_norm': 0.6941718459129333, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.54it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.47it/s]                                               {'loss': 0.137, 'grad_norm': 5.400646209716797, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.47it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s]                                               {'loss': 0.0224, 'grad_norm': 1.133804202079773, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.42it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.37it/s]                                               {'loss': 0.2822, 'grad_norm': 0.5073716640472412, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.37it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.0085, 'grad_norm': 0.3024645447731018, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.0052, 'grad_norm': 0.23215340077877045, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]                                               {'train_runtime': 27.8774, 'train_samples_per_second': 20.267, 'train_steps_per_second': 1.435, 'train_loss': 0.42829789555980824, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]100%|██████████| 40/40 [00:27<00:00,  1.43it/s]
CLIENT:9
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:52,  1.35s/it]                                              {'loss': 1.4182, 'grad_norm': 12.676397323608398, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:52,  1.35s/it]  5%|▌         | 2/40 [00:02<00:38,  1.02s/it]                                              {'loss': 1.4768, 'grad_norm': 14.50262451171875, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:38,  1.02s/it]  8%|▊         | 3/40 [00:02<00:33,  1.10it/s]                                              {'loss': 0.5701, 'grad_norm': 9.170859336853027, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:33,  1.10it/s] 10%|█         | 4/40 [00:03<00:30,  1.17it/s]                                              {'loss': 0.929, 'grad_norm': 13.4920072555542, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:30,  1.17it/s] 12%|█▎        | 5/40 [00:04<00:28,  1.23it/s]                                              {'loss': 1.4853, 'grad_norm': 21.571189880371094, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:28,  1.23it/s] 15%|█▌        | 6/40 [00:05<00:26,  1.27it/s]                                              {'loss': 2.7718, 'grad_norm': 26.58364486694336, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:26,  1.27it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.27it/s]                                              {'loss': 1.0785, 'grad_norm': 21.431386947631836, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.27it/s] 20%|██        | 8/40 [00:06<00:18,  1.76it/s]                                              {'loss': 1.778, 'grad_norm': 118.51290130615234, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:18,  1.76it/s] 22%|██▎       | 9/40 [00:06<00:19,  1.58it/s]                                              {'loss': 0.7551, 'grad_norm': 17.71392250061035, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:19,  1.58it/s] 25%|██▌       | 10/40 [00:07<00:20,  1.47it/s]                                               {'loss': 0.4357, 'grad_norm': 8.877571105957031, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:20,  1.47it/s] 28%|██▊       | 11/40 [00:08<00:20,  1.40it/s]                                               {'loss': 0.2807, 'grad_norm': 8.908759117126465, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:20,  1.40it/s] 30%|███       | 12/40 [00:09<00:20,  1.36it/s]                                               {'loss': 0.3328, 'grad_norm': 7.197016716003418, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:20,  1.36it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.34it/s]                                               {'loss': 0.2121, 'grad_norm': 5.22797155380249, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.34it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.33it/s]                                               {'loss': 0.956, 'grad_norm': 8.906793594360352, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.33it/s] 38%|███▊      | 15/40 [00:11<00:19,  1.31it/s]                                               {'loss': 0.1221, 'grad_norm': 2.9079129695892334, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:19,  1.31it/s]                                               {'loss': 1.1817, 'grad_norm': 36.46931076049805, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.31it/s] 42%|████▎     | 17/40 [00:12<00:14,  1.64it/s]                                               {'loss': 0.4674, 'grad_norm': 5.804037094116211, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:14,  1.64it/s] 45%|████▌     | 18/40 [00:13<00:14,  1.57it/s]                                               {'loss': 0.1151, 'grad_norm': 3.5698235034942627, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:14,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s]                                               {'loss': 0.1445, 'grad_norm': 4.256329536437988, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s] 50%|█████     | 20/40 [00:14<00:14,  1.42it/s]                                               {'loss': 0.087, 'grad_norm': 2.616314172744751, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:14,  1.42it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.39it/s]                                               {'loss': 0.1092, 'grad_norm': 9.01516056060791, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.39it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.36it/s]                                               {'loss': 0.1911, 'grad_norm': 6.522575378417969, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.36it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.33it/s]                                               {'loss': 0.2617, 'grad_norm': 6.6640167236328125, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.33it/s]                                               {'loss': 0.0509, 'grad_norm': 3.4135711193084717, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:17<00:11,  1.33it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.65it/s]                                               {'loss': 0.0584, 'grad_norm': 3.9155802726745605, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.65it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.55it/s]                                               {'loss': 0.0756, 'grad_norm': 3.7958059310913086, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:09,  1.55it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.0145, 'grad_norm': 0.42578884959220886, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s] 70%|███████   | 28/40 [00:20<00:08,  1.42it/s]                                               {'loss': 0.1151, 'grad_norm': 5.180399417877197, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:20<00:08,  1.42it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.38it/s]                                               {'loss': 0.2427, 'grad_norm': 7.95574951171875, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.38it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.35it/s]                                               {'loss': 0.0679, 'grad_norm': 2.059619426727295, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.35it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.34it/s]                                               {'loss': 0.0191, 'grad_norm': 0.8533128499984741, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.34it/s]                                               {'loss': 0.0059, 'grad_norm': 0.4436641037464142, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:05,  1.34it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.65it/s]                                               {'loss': 0.0316, 'grad_norm': 1.171166181564331, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.65it/s] 85%|████████▌ | 34/40 [00:24<00:03,  1.53it/s]                                               {'loss': 0.0382, 'grad_norm': 1.6804858446121216, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:24<00:03,  1.53it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s]                                               {'loss': 0.0233, 'grad_norm': 0.8480401039123535, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s]                                               {'loss': 0.0549, 'grad_norm': 1.976099967956543, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.45it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.39it/s]                                               {'loss': 0.0165, 'grad_norm': 0.4844561517238617, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.39it/s] 95%|█████████▌| 38/40 [00:27<00:01,  1.36it/s]                                               {'loss': 0.0325, 'grad_norm': 1.2324274778366089, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:27<00:01,  1.36it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.34it/s]                                               {'loss': 0.0421, 'grad_norm': 1.8365620374679565, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.34it/s]                                               {'loss': 0.0027, 'grad_norm': 0.14688941836357117, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.34it/s]                                               {'train_runtime': 28.3124, 'train_samples_per_second': 19.956, 'train_steps_per_second': 1.413, 'train_loss': 0.45129752450739036, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.34it/s]100%|██████████| 40/40 [00:28<00:00,  1.41it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.31it/s]                                              {'loss': 2.2767, 'grad_norm': 13.099674224853516, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.31it/s]  5%|▌         | 2/40 [00:01<00:28,  1.31it/s]                                              {'loss': 1.4042, 'grad_norm': 9.889589309692383, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.31it/s]  8%|▊         | 3/40 [00:02<00:27,  1.35it/s]                                              {'loss': 2.2416, 'grad_norm': 11.979482650756836, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.35it/s] 10%|█         | 4/40 [00:03<00:27,  1.33it/s]                                              {'loss': 2.1208, 'grad_norm': 19.3396053314209, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.33it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s]                                              {'loss': 1.3995, 'grad_norm': 14.498706817626953, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.32it/s] 15%|█▌        | 6/40 [00:04<00:26,  1.30it/s]                                              {'loss': 1.5809, 'grad_norm': 21.615018844604492, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:26,  1.30it/s] 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 1.0642, 'grad_norm': 13.961970329284668, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:24,  1.34it/s]                                              {'loss': 0.5439, 'grad_norm': 52.74462127685547, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:23,  1.34it/s] 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s]                                              {'loss': 0.7447, 'grad_norm': 10.826639175415039, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:18,  1.68it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.56it/s]                                               {'loss': 0.7142, 'grad_norm': 10.194754600524902, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:19,  1.56it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s]                                               {'loss': 1.2706, 'grad_norm': 16.72397804260254, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.47it/s] 30%|███       | 12/40 [00:08<00:19,  1.42it/s]                                               {'loss': 0.8019, 'grad_norm': 8.265872955322266, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:19,  1.42it/s] 32%|███▎      | 13/40 [00:09<00:19,  1.38it/s]                                               {'loss': 0.7749, 'grad_norm': 6.780281066894531, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:19,  1.38it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.36it/s]                                               {'loss': 1.0871, 'grad_norm': 8.744681358337402, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.36it/s] 38%|███▊      | 15/40 [00:10<00:18,  1.35it/s]                                               {'loss': 0.7151, 'grad_norm': 6.571714878082275, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:10<00:18,  1.35it/s]                                               {'loss': 0.279, 'grad_norm': 12.502946853637695, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:17,  1.35it/s] 42%|████▎     | 17/40 [00:11<00:13,  1.67it/s]                                               {'loss': 0.7621, 'grad_norm': 10.630114555358887, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:11<00:13,  1.67it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s]                                               {'loss': 0.5177, 'grad_norm': 6.99367094039917, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.56it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s]                                               {'loss': 0.3735, 'grad_norm': 5.574933052062988, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.48it/s] 50%|█████     | 20/40 [00:13<00:13,  1.45it/s]                                               {'loss': 0.6341, 'grad_norm': 4.679360866546631, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:13<00:13,  1.45it/s] 52%|█████▎    | 21/40 [00:14<00:13,  1.40it/s]                                               {'loss': 0.351, 'grad_norm': 5.6275715827941895, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:14<00:13,  1.40it/s] 55%|█████▌    | 22/40 [00:15<00:13,  1.37it/s]                                               {'loss': 0.1728, 'grad_norm': 2.9279489517211914, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:13,  1.37it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.34it/s]                                               {'loss': 0.6077, 'grad_norm': 13.38416862487793, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.34it/s]                                               {'loss': 1.1815, 'grad_norm': 40.89286804199219, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.34it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.65it/s]                                               {'loss': 0.0965, 'grad_norm': 2.759477138519287, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.65it/s] 65%|██████▌   | 26/40 [00:17<00:09,  1.54it/s]                                               {'loss': 0.3377, 'grad_norm': 2.614903688430786, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:17<00:09,  1.54it/s] 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s]                                               {'loss': 0.263, 'grad_norm': 3.5897650718688965, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:08,  1.46it/s] 70%|███████   | 28/40 [00:19<00:08,  1.40it/s]                                               {'loss': 0.1288, 'grad_norm': 1.7283341884613037, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.40it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.38it/s]                                               {'loss': 0.2383, 'grad_norm': 2.4657363891601562, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.38it/s] 75%|███████▌  | 30/40 [00:20<00:07,  1.36it/s]                                               {'loss': 0.0737, 'grad_norm': 1.5522364377975464, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:20<00:07,  1.36it/s] 78%|███████▊  | 31/40 [00:21<00:06,  1.34it/s]                                               {'loss': 0.1793, 'grad_norm': 2.9577643871307373, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:21<00:06,  1.34it/s]                                               {'loss': 0.0039, 'grad_norm': 0.282943993806839, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:21<00:05,  1.34it/s] 82%|████████▎ | 33/40 [00:22<00:04,  1.65it/s]                                               {'loss': 0.0587, 'grad_norm': 0.9512143731117249, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:22<00:04,  1.65it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.55it/s]                                               {'loss': 0.0459, 'grad_norm': 1.8534808158874512, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.55it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.47it/s]                                               {'loss': 0.0505, 'grad_norm': 1.0791523456573486, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:24<00:02,  1.41it/s]                                               {'loss': 0.0898, 'grad_norm': 4.994407653808594, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:24<00:02,  1.41it/s] 92%|█████████▎| 37/40 [00:25<00:02,  1.37it/s]                                               {'loss': 0.1317, 'grad_norm': 3.022432327270508, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:25<00:02,  1.37it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s]                                               {'loss': 0.2097, 'grad_norm': 1.321122407913208, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.38it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.1336, 'grad_norm': 2.870896339416504, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.35it/s]                                               {'loss': 0.0409, 'grad_norm': 2.8708269596099854, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]                                               {'train_runtime': 27.595, 'train_samples_per_second': 20.475, 'train_steps_per_second': 1.45, 'train_loss': 0.6425403424887918, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.35it/s]100%|██████████| 40/40 [00:27<00:00,  1.45it/s]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:30,  1.27it/s]                                              {'loss': 1.984, 'grad_norm': 12.973581314086914, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:30,  1.27it/s]  5%|▌         | 2/40 [00:01<00:29,  1.28it/s]                                              {'loss': 1.2221, 'grad_norm': 13.857662200927734, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:29,  1.28it/s]  8%|▊         | 3/40 [00:02<00:28,  1.28it/s]                                              {'loss': 1.1514, 'grad_norm': 18.52102279663086, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.28it/s] 10%|█         | 4/40 [00:03<00:27,  1.29it/s]                                              {'loss': 1.4662, 'grad_norm': 15.198149681091309, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.29it/s] 12%|█▎        | 5/40 [00:03<00:27,  1.28it/s]                                              {'loss': 0.8401, 'grad_norm': 16.520360946655273, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:27,  1.28it/s] 15%|█▌        | 6/40 [00:04<00:26,  1.27it/s]                                              {'loss': 1.2627, 'grad_norm': 13.624288558959961, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:26,  1.27it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.29it/s]                                              {'loss': 1.3755, 'grad_norm': 18.026519775390625, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.29it/s] 20%|██        | 8/40 [00:06<00:22,  1.41it/s]                                              {'loss': 0.1574, 'grad_norm': 11.331293106079102, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:22,  1.41it/s] 22%|██▎       | 9/40 [00:06<00:22,  1.37it/s]                                              {'loss': 0.7512, 'grad_norm': 9.648186683654785, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:22,  1.37it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.33it/s]                                               {'loss': 0.4607, 'grad_norm': 7.349947929382324, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.33it/s] 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s]                                               {'loss': 0.2586, 'grad_norm': 5.0473761558532715, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:22,  1.31it/s] 30%|███       | 12/40 [00:09<00:21,  1.31it/s]                                               {'loss': 0.5948, 'grad_norm': 7.920435905456543, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:21,  1.31it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.30it/s]                                               {'loss': 0.8906, 'grad_norm': 8.154648780822754, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.30it/s] 35%|███▌      | 14/40 [00:10<00:20,  1.29it/s]                                               {'loss': 0.5919, 'grad_norm': 8.013670921325684, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:20,  1.29it/s] 38%|███▊      | 15/40 [00:11<00:19,  1.29it/s]                                               {'loss': 0.537, 'grad_norm': 7.6519293785095215, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:19,  1.29it/s]                                               {'loss': 2.4681, 'grad_norm': 105.55188751220703, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:18,  1.29it/s] 42%|████▎     | 17/40 [00:12<00:14,  1.62it/s]                                               {'loss': 0.4161, 'grad_norm': 9.488361358642578, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:14,  1.62it/s] 45%|████▌     | 18/40 [00:13<00:14,  1.51it/s]                                               {'loss': 0.2489, 'grad_norm': 9.644652366638184, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:14,  1.51it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s]                                               {'loss': 0.526, 'grad_norm': 3.4218995571136475, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.44it/s] 50%|█████     | 20/40 [00:14<00:14,  1.39it/s]                                               {'loss': 0.3392, 'grad_norm': 3.840846300125122, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:14,  1.39it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.37it/s]                                               {'loss': 0.2129, 'grad_norm': 5.332301139831543, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.37it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.34it/s]                                               {'loss': 0.192, 'grad_norm': 3.937284469604492, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.34it/s] 57%|█████▊    | 23/40 [00:17<00:12,  1.33it/s]                                               {'loss': 0.2667, 'grad_norm': 9.907671928405762, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:17<00:12,  1.33it/s]                                               {'loss': 0.0032, 'grad_norm': 0.19492721557617188, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:17<00:12,  1.33it/s] 62%|██████▎   | 25/40 [00:17<00:08,  1.73it/s]                                               {'loss': 0.315, 'grad_norm': 5.147058963775635, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:08,  1.73it/s] 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s]                                               {'loss': 0.1074, 'grad_norm': 2.524442434310913, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:08,  1.60it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s]                                               {'loss': 0.0511, 'grad_norm': 1.2715312242507935, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.50it/s] 70%|███████   | 28/40 [00:20<00:08,  1.43it/s]                                               {'loss': 0.4591, 'grad_norm': 3.277560234069824, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:20<00:08,  1.43it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.39it/s]                                               {'loss': 0.0636, 'grad_norm': 2.440410852432251, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.39it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.36it/s]                                               {'loss': 0.1049, 'grad_norm': 5.1526923179626465, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.36it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.33it/s]                                               {'loss': 0.0386, 'grad_norm': 1.203486442565918, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.33it/s]                                               {'loss': 0.0001, 'grad_norm': 0.00491587957367301, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:06,  1.33it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.64it/s]                                               {'loss': 0.4339, 'grad_norm': 2.827338933944702, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.64it/s] 85%|████████▌ | 34/40 [00:24<00:03,  1.54it/s]                                               {'loss': 0.0704, 'grad_norm': 2.974485397338867, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:24<00:03,  1.54it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s]                                               {'loss': 0.0356, 'grad_norm': 0.8468416333198547, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.46it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.40it/s]                                               {'loss': 0.0371, 'grad_norm': 0.9176947474479675, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.40it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.37it/s]                                               {'loss': 0.0754, 'grad_norm': 3.076756715774536, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.37it/s] 95%|█████████▌| 38/40 [00:27<00:01,  1.34it/s]                                               {'loss': 0.2469, 'grad_norm': 0.8764023184776306, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:27<00:01,  1.34it/s] 98%|█████████▊| 39/40 [00:28<00:00,  1.33it/s]                                               {'loss': 0.0641, 'grad_norm': 3.437507152557373, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:28<00:00,  1.33it/s]                                               {'loss': 0.002, 'grad_norm': 0.187411829829216, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.33it/s]                                               {'train_runtime': 28.3486, 'train_samples_per_second': 19.93, 'train_steps_per_second': 1.411, 'train_loss': 0.5080641630660466, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.33it/s]100%|██████████| 40/40 [00:28<00:00,  1.41it/s]
CLIENT:96
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:30,  1.29it/s]                                              {'loss': 1.7134, 'grad_norm': 11.219400405883789, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:30,  1.29it/s]  5%|▌         | 2/40 [00:01<00:29,  1.29it/s]                                              {'loss': 1.9965, 'grad_norm': 16.954227447509766, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:29,  1.29it/s]  8%|▊         | 3/40 [00:02<00:28,  1.29it/s]                                              {'loss': 0.3835, 'grad_norm': 9.365487098693848, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:28,  1.29it/s] 10%|█         | 4/40 [00:03<00:27,  1.29it/s]                                              {'loss': 0.6138, 'grad_norm': 11.385235786437988, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.29it/s] 12%|█▎        | 5/40 [00:03<00:27,  1.28it/s]                                              {'loss': 1.3791, 'grad_norm': 16.290016174316406, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:27,  1.28it/s] 15%|█▌        | 6/40 [00:04<00:26,  1.28it/s]                                              {'loss': 1.3319, 'grad_norm': 13.601611137390137, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:26,  1.28it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.29it/s]                                              {'loss': 1.1555, 'grad_norm': 15.093002319335938, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.29it/s] 20%|██        | 8/40 [00:06<00:23,  1.34it/s]                                              {'loss': 0.0051, 'grad_norm': 0.3370758891105652, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:06<00:23,  1.34it/s] 22%|██▎       | 9/40 [00:06<00:23,  1.33it/s]                                              {'loss': 1.2149, 'grad_norm': 20.293214797973633, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:23,  1.33it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.31it/s]                                               {'loss': 0.4988, 'grad_norm': 5.205807685852051, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.31it/s] 28%|██▊       | 11/40 [00:08<00:22,  1.30it/s]                                               {'loss': 0.7102, 'grad_norm': 22.92558479309082, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:22,  1.30it/s] 30%|███       | 12/40 [00:09<00:20,  1.34it/s]                                               {'loss': 0.2298, 'grad_norm': 4.64864444732666, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:09<00:20,  1.34it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.32it/s]                                               {'loss': 0.2282, 'grad_norm': 4.229340553283691, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.32it/s] 35%|███▌      | 14/40 [00:10<00:20,  1.30it/s]                                               {'loss': 0.3694, 'grad_norm': 4.2809882164001465, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:20,  1.30it/s] 38%|███▊      | 15/40 [00:11<00:19,  1.30it/s]                                               {'loss': 0.3547, 'grad_norm': 4.406515121459961, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:19,  1.30it/s] 40%|████      | 16/40 [00:11<00:13,  1.76it/s]                                               {'loss': 0.0016, 'grad_norm': 0.13659435510635376, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:13,  1.76it/s] 42%|████▎     | 17/40 [00:12<00:14,  1.58it/s]                                               {'loss': 0.5262, 'grad_norm': 12.000354766845703, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:14,  1.58it/s] 45%|████▌     | 18/40 [00:13<00:14,  1.48it/s]                                               {'loss': 0.1745, 'grad_norm': 4.747060775756836, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:13<00:14,  1.48it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.41it/s]                                               {'loss': 0.2679, 'grad_norm': 3.3764901161193848, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.41it/s] 50%|█████     | 20/40 [00:14<00:14,  1.38it/s]                                               {'loss': 0.3626, 'grad_norm': 8.477559089660645, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:14,  1.38it/s] 52%|█████▎    | 21/40 [00:15<00:14,  1.35it/s]                                               {'loss': 0.2623, 'grad_norm': 5.365734100341797, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:14,  1.35it/s] 55%|█████▌    | 22/40 [00:16<00:13,  1.33it/s]                                               {'loss': 0.3945, 'grad_norm': 5.426296234130859, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:16<00:13,  1.33it/s] 57%|█████▊    | 23/40 [00:17<00:12,  1.31it/s]                                               {'loss': 0.1234, 'grad_norm': 3.8549413681030273, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:17<00:12,  1.31it/s]                                               {'loss': 0.047, 'grad_norm': 5.128016948699951, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:17<00:12,  1.31it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.64it/s]                                               {'loss': 0.1061, 'grad_norm': 1.6754299402236938, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.64it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.54it/s]                                               {'loss': 0.2678, 'grad_norm': 9.70173454284668, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:09,  1.54it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.1932, 'grad_norm': 5.557857036590576, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s] 70%|███████   | 28/40 [00:20<00:08,  1.40it/s]                                               {'loss': 0.1514, 'grad_norm': 2.9161291122436523, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:20<00:08,  1.40it/s] 72%|███████▎  | 29/40 [00:21<00:08,  1.37it/s]                                               {'loss': 0.2266, 'grad_norm': 0.7947016358375549, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:21<00:08,  1.37it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.35it/s]                                               {'loss': 0.2335, 'grad_norm': 2.602958917617798, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.35it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.33it/s]                                               {'loss': 0.0789, 'grad_norm': 1.5957266092300415, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.33it/s]                                               {'loss': 0.019, 'grad_norm': 1.0332422256469727, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:06,  1.33it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.64it/s]                                               {'loss': 0.0698, 'grad_norm': 1.1688891649246216, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.64it/s] 85%|████████▌ | 34/40 [00:24<00:03,  1.53it/s]                                               {'loss': 0.0763, 'grad_norm': 1.5443662405014038, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:24<00:03,  1.53it/s] 88%|████████▊ | 35/40 [00:25<00:03,  1.47it/s]                                               {'loss': 0.062, 'grad_norm': 1.5363329648971558, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:25<00:03,  1.47it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.42it/s]                                               {'loss': 0.0721, 'grad_norm': 2.0719516277313232, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.42it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.37it/s]                                               {'loss': 0.234, 'grad_norm': 1.0298460721969604, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.37it/s] 95%|█████████▌| 38/40 [00:27<00:01,  1.38it/s]                                               {'loss': 0.1107, 'grad_norm': 1.921463131904602, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:27<00:01,  1.38it/s] 98%|█████████▊| 39/40 [00:28<00:00,  1.35it/s]                                               {'loss': 0.0679, 'grad_norm': 1.9848169088363647, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:28<00:00,  1.35it/s]                                               {'loss': 0.0011, 'grad_norm': 0.05424666404724121, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.35it/s]                                               {'train_runtime': 28.4534, 'train_samples_per_second': 19.857, 'train_steps_per_second': 1.406, 'train_loss': 0.40788143590907566, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.35it/s]100%|██████████| 40/40 [00:28<00:00,  1.41it/s]
CLIENT:29
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:30,  1.28it/s]                                              {'loss': 2.1251, 'grad_norm': 12.45095157623291, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:30,  1.28it/s]  5%|▌         | 2/40 [00:01<00:29,  1.29it/s]                                              {'loss': 1.8165, 'grad_norm': 10.968271255493164, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:29,  1.29it/s]  8%|▊         | 3/40 [00:02<00:27,  1.32it/s]                                              {'loss': 1.6171, 'grad_norm': 12.088068008422852, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.32it/s] 10%|█         | 4/40 [00:03<00:27,  1.31it/s]                                              {'loss': 1.2954, 'grad_norm': 17.054439544677734, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:27,  1.31it/s] 12%|█▎        | 5/40 [00:03<00:26,  1.30it/s]                                              {'loss': 1.5258, 'grad_norm': 13.303492546081543, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:26,  1.30it/s] 15%|█▌        | 6/40 [00:04<00:26,  1.30it/s]                                              {'loss': 0.8167, 'grad_norm': 12.273736000061035, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:26,  1.30it/s] 18%|█▊        | 7/40 [00:05<00:25,  1.31it/s]                                              {'loss': 0.9318, 'grad_norm': 13.838692665100098, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:05<00:25,  1.31it/s] 20%|██        | 8/40 [00:05<00:22,  1.45it/s]                                              {'loss': 1.0168, 'grad_norm': 130.9451141357422, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:22,  1.45it/s] 22%|██▎       | 9/40 [00:06<00:22,  1.39it/s]                                              {'loss': 0.7759, 'grad_norm': 17.639867782592773, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:22,  1.39it/s] 25%|██▌       | 10/40 [00:07<00:22,  1.36it/s]                                               {'loss': 0.6461, 'grad_norm': 20.10600471496582, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:07<00:22,  1.36it/s] 28%|██▊       | 11/40 [00:08<00:21,  1.34it/s]                                               {'loss': 1.1847, 'grad_norm': 10.280144691467285, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:08<00:21,  1.34it/s] 30%|███       | 12/40 [00:08<00:21,  1.32it/s]                                               {'loss': 0.4647, 'grad_norm': 29.455535888671875, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:08<00:21,  1.32it/s] 32%|███▎      | 13/40 [00:09<00:20,  1.31it/s]                                               {'loss': 0.3819, 'grad_norm': 17.63543128967285, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:09<00:20,  1.31it/s] 35%|███▌      | 14/40 [00:10<00:19,  1.31it/s]                                               {'loss': 0.5351, 'grad_norm': 4.306474208831787, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:10<00:19,  1.31it/s] 38%|███▊      | 15/40 [00:11<00:18,  1.36it/s]                                               {'loss': 1.0445, 'grad_norm': 8.940847396850586, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:11<00:18,  1.36it/s]                                               {'loss': 0.0398, 'grad_norm': 6.2205657958984375, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:11<00:17,  1.36it/s] 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s]                                               {'loss': 0.7667, 'grad_norm': 7.383636951446533, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:12<00:13,  1.67it/s] 45%|████▌     | 18/40 [00:12<00:14,  1.57it/s]                                               {'loss': 1.154, 'grad_norm': 12.800384521484375, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:12<00:14,  1.57it/s] 48%|████▊     | 19/40 [00:13<00:14,  1.49it/s]                                               {'loss': 0.409, 'grad_norm': 1.046676516532898, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:13<00:14,  1.49it/s] 50%|█████     | 20/40 [00:14<00:13,  1.46it/s]                                               {'loss': 0.2352, 'grad_norm': 2.6349008083343506, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:14<00:13,  1.46it/s] 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s]                                               {'loss': 0.4575, 'grad_norm': 5.9639573097229, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:15<00:13,  1.40it/s] 55%|█████▌    | 22/40 [00:15<00:13,  1.36it/s]                                               {'loss': 0.373, 'grad_norm': 4.52810525894165, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:15<00:13,  1.36it/s] 57%|█████▊    | 23/40 [00:16<00:12,  1.34it/s]                                               {'loss': 0.1478, 'grad_norm': 5.077386856079102, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:16<00:12,  1.34it/s]                                               {'loss': 0.0274, 'grad_norm': 2.137699842453003, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:16<00:11,  1.34it/s] 62%|██████▎   | 25/40 [00:17<00:09,  1.66it/s]                                               {'loss': 0.1153, 'grad_norm': 2.1654295921325684, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:09,  1.66it/s] 65%|██████▌   | 26/40 [00:18<00:09,  1.55it/s]                                               {'loss': 0.2635, 'grad_norm': 3.5902838706970215, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:09,  1.55it/s] 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s]                                               {'loss': 0.1935, 'grad_norm': 2.70548152923584, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:19<00:08,  1.47it/s] 70%|███████   | 28/40 [00:19<00:08,  1.42it/s]                                               {'loss': 0.3274, 'grad_norm': 6.205026626586914, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:19<00:08,  1.42it/s] 72%|███████▎  | 29/40 [00:20<00:07,  1.38it/s]                                               {'loss': 0.0679, 'grad_norm': 1.4617115259170532, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:20<00:07,  1.38it/s] 75%|███████▌  | 30/40 [00:21<00:07,  1.34it/s]                                               {'loss': 0.094, 'grad_norm': 2.5002732276916504, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:21<00:07,  1.34it/s] 78%|███████▊  | 31/40 [00:22<00:06,  1.34it/s]                                               {'loss': 1.1034, 'grad_norm': 3.7734298706054688, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:22<00:06,  1.34it/s] 80%|████████  | 32/40 [00:22<00:04,  1.79it/s]                                               {'loss': 0.3972, 'grad_norm': 16.764842987060547, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:22<00:04,  1.79it/s] 82%|████████▎ | 33/40 [00:23<00:04,  1.62it/s]                                               {'loss': 1.1441, 'grad_norm': 1.5323030948638916, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:23<00:04,  1.62it/s] 85%|████████▌ | 34/40 [00:23<00:03,  1.50it/s]                                               {'loss': 0.1769, 'grad_norm': 8.290426254272461, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:23<00:03,  1.50it/s] 88%|████████▊ | 35/40 [00:24<00:03,  1.43it/s]                                               {'loss': 0.0656, 'grad_norm': 1.403660774230957, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:24<00:03,  1.43it/s] 90%|█████████ | 36/40 [00:25<00:02,  1.38it/s]                                               {'loss': 0.0628, 'grad_norm': 5.240339756011963, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:25<00:02,  1.38it/s] 92%|█████████▎| 37/40 [00:26<00:02,  1.36it/s]                                               {'loss': 0.045, 'grad_norm': 2.309191942214966, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:26<00:02,  1.36it/s] 95%|█████████▌| 38/40 [00:26<00:01,  1.36it/s]                                               {'loss': 0.0499, 'grad_norm': 1.6505135297775269, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:26<00:01,  1.36it/s] 98%|█████████▊| 39/40 [00:27<00:00,  1.33it/s]                                               {'loss': 0.2575, 'grad_norm': 1.187828779220581, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:27<00:00,  1.33it/s]                                               {'loss': 0.0117, 'grad_norm': 1.9005168676376343, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:27<00:00,  1.33it/s]                                               {'train_runtime': 28.0142, 'train_samples_per_second': 20.168, 'train_steps_per_second': 1.428, 'train_loss': 0.6041067043086514, 'epoch': 5.0}
100%|██████████| 40/40 [00:28<00:00,  1.33it/s]100%|██████████| 40/40 [00:28<00:00,  1.43it/s]
CLIENT:86
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<01:04,  1.67s/it]                                              {'loss': 1.3901, 'grad_norm': 11.398606300354004, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<01:04,  1.67s/it]  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]                                              {'loss': 1.7741, 'grad_norm': 19.045604705810547, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:02<00:43,  1.14s/it]  8%|▊         | 3/40 [00:03<00:36,  1.02it/s]                                              {'loss': 1.5069, 'grad_norm': 17.01735496520996, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:03<00:36,  1.02it/s] 10%|█         | 4/40 [00:03<00:30,  1.16it/s]                                              {'loss': 1.7725, 'grad_norm': 25.52620506286621, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:30,  1.16it/s] 12%|█▎        | 5/40 [00:04<00:28,  1.21it/s]                                              {'loss': 0.8002, 'grad_norm': 12.543028831481934, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:04<00:28,  1.21it/s] 15%|█▌        | 6/40 [00:05<00:27,  1.23it/s]                                              {'loss': 0.8025, 'grad_norm': 8.051281929016113, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:05<00:27,  1.23it/s] 18%|█▊        | 7/40 [00:06<00:26,  1.25it/s]                                              {'loss': 1.2095, 'grad_norm': 16.950544357299805, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:06<00:26,  1.25it/s] 20%|██        | 8/40 [00:07<00:25,  1.23it/s]                                              {'loss': 4.3061, 'grad_norm': 122.50414276123047, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:07<00:25,  1.23it/s] 22%|██▎       | 9/40 [00:07<00:24,  1.24it/s]                                              {'loss': 0.34, 'grad_norm': 4.105548858642578, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:07<00:24,  1.24it/s] 25%|██▌       | 10/40 [00:08<00:23,  1.25it/s]                                               {'loss': 0.2863, 'grad_norm': 5.6640625, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:08<00:23,  1.25it/s] 28%|██▊       | 11/40 [00:09<00:22,  1.26it/s]                                               {'loss': 0.5719, 'grad_norm': 8.300795555114746, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:09<00:22,  1.26it/s] 30%|███       | 12/40 [00:10<00:21,  1.29it/s]                                               {'loss': 0.2893, 'grad_norm': 5.75530481338501, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:10<00:21,  1.29it/s] 32%|███▎      | 13/40 [00:10<00:20,  1.32it/s]                                               {'loss': 0.4833, 'grad_norm': 6.830842018127441, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:10<00:20,  1.32it/s] 35%|███▌      | 14/40 [00:11<00:19,  1.31it/s]                                               {'loss': 0.3397, 'grad_norm': 5.076254844665527, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:11<00:19,  1.31it/s] 38%|███▊      | 15/40 [00:12<00:19,  1.30it/s]                                               {'loss': 0.4668, 'grad_norm': 6.445023059844971, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:12<00:19,  1.30it/s]                                               {'loss': 1.4311, 'grad_norm': 54.47052764892578, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:12<00:18,  1.30it/s] 42%|████▎     | 17/40 [00:13<00:14,  1.61it/s]                                               {'loss': 0.3495, 'grad_norm': 4.17867374420166, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:13<00:14,  1.61it/s] 45%|████▌     | 18/40 [00:14<00:14,  1.52it/s]                                               {'loss': 0.1799, 'grad_norm': 3.7635092735290527, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:14<00:14,  1.52it/s] 48%|████▊     | 19/40 [00:14<00:14,  1.45it/s]                                               {'loss': 0.1989, 'grad_norm': 4.949521064758301, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:14<00:14,  1.45it/s] 50%|█████     | 20/40 [00:15<00:14,  1.40it/s]                                               {'loss': 0.1318, 'grad_norm': 6.1088080406188965, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:15<00:14,  1.40it/s] 52%|█████▎    | 21/40 [00:16<00:13,  1.36it/s]                                               {'loss': 0.163, 'grad_norm': 4.5191264152526855, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:16<00:13,  1.36it/s] 55%|█████▌    | 22/40 [00:17<00:12,  1.44it/s]                                               {'loss': 0.0932, 'grad_norm': 2.961836576461792, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:17<00:12,  1.44it/s] 57%|█████▊    | 23/40 [00:17<00:10,  1.69it/s]                                               {'loss': 0.1366, 'grad_norm': 3.4670495986938477, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:17<00:10,  1.69it/s]                                               {'loss': 0.0317, 'grad_norm': 0.8697340488433838, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:17<00:09,  1.69it/s] 62%|██████▎   | 25/40 [00:17<00:06,  2.42it/s]                                               {'loss': 0.0615, 'grad_norm': 1.2563260793685913, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:17<00:06,  2.42it/s] 65%|██████▌   | 26/40 [00:18<00:05,  2.51it/s]                                               {'loss': 0.0605, 'grad_norm': 1.419001817703247, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:18<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:18<00:05,  2.58it/s]                                               {'loss': 0.0182, 'grad_norm': 0.33300840854644775, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:18<00:05,  2.58it/s] 70%|███████   | 28/40 [00:18<00:04,  2.64it/s]                                               {'loss': 0.0293, 'grad_norm': 1.129629373550415, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:18<00:04,  2.64it/s] 72%|███████▎  | 29/40 [00:19<00:04,  2.68it/s]                                               {'loss': 0.0659, 'grad_norm': 2.3412678241729736, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:19<00:04,  2.68it/s] 75%|███████▌  | 30/40 [00:19<00:03,  2.72it/s]                                               {'loss': 0.1762, 'grad_norm': 2.4108200073242188, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:19<00:03,  2.72it/s] 78%|███████▊  | 31/40 [00:20<00:03,  2.41it/s]                                               {'loss': 0.0456, 'grad_norm': 1.8080902099609375, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:20<00:03,  2.41it/s] 80%|████████  | 32/40 [00:20<00:02,  3.09it/s]                                               {'loss': 0.0017, 'grad_norm': 0.05813050642609596, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:20<00:02,  3.09it/s] 82%|████████▎ | 33/40 [00:21<00:03,  2.16it/s]                                               {'loss': 0.0168, 'grad_norm': 0.4513789415359497, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:21<00:03,  2.16it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.95it/s]                                               {'loss': 0.1844, 'grad_norm': 3.522162675857544, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.95it/s] 88%|████████▊ | 35/40 [00:22<00:02,  1.79it/s]                                               {'loss': 0.022, 'grad_norm': 1.900429368019104, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:22<00:02,  1.79it/s] 90%|█████████ | 36/40 [00:23<00:02,  1.57it/s]                                               {'loss': 0.0312, 'grad_norm': 2.345562219619751, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:23<00:02,  1.57it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.58it/s]                                               {'loss': 0.1073, 'grad_norm': 3.273676872253418, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.58it/s] 95%|█████████▌| 38/40 [00:24<00:01,  1.60it/s]                                               {'loss': 0.0292, 'grad_norm': 1.260116457939148, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:24<00:01,  1.60it/s] 98%|█████████▊| 39/40 [00:25<00:00,  1.47it/s]                                               {'loss': 0.0309, 'grad_norm': 0.7233569622039795, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:25<00:00,  1.47it/s]                                               {'loss': 0.0002, 'grad_norm': 0.010598287917673588, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.47it/s]                                               {'train_runtime': 25.4923, 'train_samples_per_second': 22.164, 'train_steps_per_second': 1.569, 'train_loss': 0.49839932683717053, 'epoch': 5.0}
100%|██████████| 40/40 [00:25<00:00,  1.47it/s]100%|██████████| 40/40 [00:25<00:00,  1.57it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:353: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:23,  1.68it/s]                                              {'loss': 1.2997, 'grad_norm': 8.418980598449707, 'learning_rate': 0.001, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:23,  1.68it/s]  5%|▌         | 2/40 [00:01<00:27,  1.36it/s]                                              {'loss': 1.2023, 'grad_norm': 10.077815055847168, 'learning_rate': 0.001, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:27,  1.36it/s]  8%|▊         | 3/40 [00:02<00:25,  1.43it/s]                                              {'loss': 1.2282, 'grad_norm': 9.858752250671387, 'learning_rate': 0.001, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:25,  1.43it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 0.8912, 'grad_norm': 14.102375984191895, 'learning_rate': 0.001, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:24,  1.41it/s]                                              {'loss': 0.4496, 'grad_norm': 11.24506950378418, 'learning_rate': 0.001, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:24,  1.41it/s] 15%|█▌        | 6/40 [00:04<00:24,  1.42it/s]                                              {'loss': 2.4963, 'grad_norm': 17.136362075805664, 'learning_rate': 0.001, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:24,  1.42it/s] 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 1.5893, 'grad_norm': 16.33307456970215, 'learning_rate': 0.001, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:22,  1.47it/s]                                              {'loss': 5.3458, 'grad_norm': 163.19869995117188, 'learning_rate': 0.001, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.78it/s]                                              {'loss': 0.4382, 'grad_norm': 9.005879402160645, 'learning_rate': 0.001, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.78it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.68it/s]                                               {'loss': 0.4104, 'grad_norm': 7.050802230834961, 'learning_rate': 0.001, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.68it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s]                                               {'loss': 1.7254, 'grad_norm': 15.037247657775879, 'learning_rate': 0.001, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.67it/s] 30%|███       | 12/40 [00:07<00:17,  1.57it/s]                                               {'loss': 0.2737, 'grad_norm': 6.292850971221924, 'learning_rate': 0.001, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.57it/s] 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s]                                               {'loss': 0.792, 'grad_norm': 7.94696044921875, 'learning_rate': 0.001, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:16,  1.59it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s]                                               {'loss': 0.0938, 'grad_norm': 3.4888076782226562, 'learning_rate': 0.001, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.45it/s] 38%|███▊      | 15/40 [00:09<00:17,  1.46it/s]                                               {'loss': 0.6627, 'grad_norm': 11.69854736328125, 'learning_rate': 0.001, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:17,  1.46it/s]                                               {'loss': 0.1805, 'grad_norm': 13.01747989654541, 'learning_rate': 0.001, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:16,  1.46it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s]                                               {'loss': 0.2448, 'grad_norm': 8.148541450500488, 'learning_rate': 0.001, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.88it/s] 45%|████▌     | 18/40 [00:11<00:13,  1.67it/s]                                               {'loss': 0.5701, 'grad_norm': 7.139193058013916, 'learning_rate': 0.001, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:13,  1.67it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.63it/s]                                               {'loss': 0.4468, 'grad_norm': 2.685978889465332, 'learning_rate': 0.001, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.63it/s] 50%|█████     | 20/40 [00:12<00:12,  1.66it/s]                                               {'loss': 0.5557, 'grad_norm': 3.1277987957000732, 'learning_rate': 0.001, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:12,  1.66it/s] 52%|█████▎    | 21/40 [00:13<00:12,  1.51it/s]                                               {'loss': 0.7961, 'grad_norm': 5.846015453338623, 'learning_rate': 0.001, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:12,  1.51it/s] 55%|█████▌    | 22/40 [00:14<00:12,  1.49it/s]                                               {'loss': 0.1891, 'grad_norm': 5.711124420166016, 'learning_rate': 0.001, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:14<00:12,  1.49it/s] 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.3266, 'grad_norm': 6.978023052215576, 'learning_rate': 0.001, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:11,  1.53it/s]                                               {'loss': 0.1142, 'grad_norm': 6.353778839111328, 'learning_rate': 0.001, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:10,  1.53it/s] 62%|██████▎   | 25/40 [00:15<00:08,  1.86it/s]                                               {'loss': 0.5916, 'grad_norm': 11.274092674255371, 'learning_rate': 0.001, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:08,  1.86it/s] 65%|██████▌   | 26/40 [00:16<00:07,  1.78it/s]                                               {'loss': 0.5512, 'grad_norm': 1.5388332605361938, 'learning_rate': 0.001, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:16<00:07,  1.78it/s] 68%|██████▊   | 27/40 [00:16<00:08,  1.59it/s]                                               {'loss': 0.3437, 'grad_norm': 0.801551103591919, 'learning_rate': 0.001, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:08,  1.59it/s] 70%|███████   | 28/40 [00:17<00:07,  1.59it/s]                                               {'loss': 0.0115, 'grad_norm': 0.5290786027908325, 'learning_rate': 0.001, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.59it/s] 72%|███████▎  | 29/40 [00:18<00:06,  1.61it/s]                                               {'loss': 0.0434, 'grad_norm': 0.94428950548172, 'learning_rate': 0.001, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:18<00:06,  1.61it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.48it/s]                                               {'loss': 0.1651, 'grad_norm': 0.8728459477424622, 'learning_rate': 0.001, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.48it/s] 78%|███████▊  | 31/40 [00:19<00:06,  1.48it/s]                                               {'loss': 0.2132, 'grad_norm': 2.3556125164031982, 'learning_rate': 0.001, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:06,  1.48it/s]                                               {'loss': 0.0031, 'grad_norm': 0.22415080666542053, 'learning_rate': 0.001, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:05,  1.48it/s] 82%|████████▎ | 33/40 [00:20<00:03,  1.92it/s]                                               {'loss': 0.157, 'grad_norm': 1.7298707962036133, 'learning_rate': 0.001, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:20<00:03,  1.92it/s] 85%|████████▌ | 34/40 [00:21<00:03,  1.68it/s]                                               {'loss': 0.0685, 'grad_norm': 0.9115206003189087, 'learning_rate': 0.001, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:21<00:03,  1.68it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.62it/s]                                               {'loss': 0.0159, 'grad_norm': 0.4284956157207489, 'learning_rate': 0.001, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.62it/s] 90%|█████████ | 36/40 [00:22<00:02,  1.64it/s]                                               {'loss': 0.6344, 'grad_norm': 4.205650329589844, 'learning_rate': 0.001, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:22<00:02,  1.64it/s] 92%|█████████▎| 37/40 [00:23<00:01,  1.54it/s]                                               {'loss': 0.1433, 'grad_norm': 1.8350095748901367, 'learning_rate': 0.001, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:23<00:01,  1.54it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.64it/s]                                               {'loss': 0.4482, 'grad_norm': 0.989763617515564, 'learning_rate': 0.001, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.64it/s] 98%|█████████▊| 39/40 [00:24<00:00,  1.88it/s]                                               {'loss': 0.2417, 'grad_norm': 2.670231819152832, 'learning_rate': 0.001, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:24<00:00,  1.88it/s]100%|██████████| 40/40 [00:24<00:00,  2.45it/s]                                               {'loss': 0.0067, 'grad_norm': 0.41426438093185425, 'learning_rate': 0.001, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.45it/s]                                               {'train_runtime': 24.4288, 'train_samples_per_second': 23.128, 'train_steps_per_second': 1.637, 'train_loss': 0.6490231869800482, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.45it/s]100%|██████████| 40/40 [00:24<00:00,  1.64it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:388: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:45, 10.26it/s]  1%|          | 4/471 [00:00<02:05,  3.71it/s]  1%|          | 5/471 [00:01<02:25,  3.19it/s]  1%|▏         | 6/471 [00:01<02:29,  3.11it/s]  1%|▏         | 7/471 [00:02<02:30,  3.08it/s]  2%|▏         | 8/471 [00:02<02:30,  3.07it/s]  2%|▏         | 9/471 [00:02<02:28,  3.11it/s]  2%|▏         | 10/471 [00:03<02:41,  2.86it/s]  2%|▏         | 11/471 [00:03<02:50,  2.69it/s]  3%|▎         | 12/471 [00:03<02:52,  2.66it/s]  3%|▎         | 13/471 [00:04<02:45,  2.77it/s]  3%|▎         | 14/471 [00:04<02:39,  2.86it/s]  3%|▎         | 15/471 [00:04<02:35,  2.94it/s]  3%|▎         | 16/471 [00:05<02:37,  2.89it/s]  4%|▎         | 17/471 [00:05<02:47,  2.71it/s]  4%|▍         | 18/471 [00:06<02:54,  2.59it/s]  4%|▍         | 19/471 [00:06<02:48,  2.69it/s]  4%|▍         | 20/471 [00:06<02:41,  2.79it/s]  4%|▍         | 21/471 [00:07<02:37,  2.86it/s]  5%|▍         | 22/471 [00:07<02:33,  2.93it/s]  5%|▍         | 23/471 [00:07<02:42,  2.76it/s]  5%|▌         | 24/471 [00:08<02:39,  2.80it/s]  5%|▌         | 25/471 [00:08<02:31,  2.94it/s]  6%|▌         | 26/471 [00:08<02:35,  2.85it/s]  6%|▌         | 27/471 [00:09<02:46,  2.66it/s]  6%|▌         | 28/471 [00:09<02:51,  2.58it/s]  6%|▌         | 29/471 [00:10<02:44,  2.69it/s]  6%|▋         | 30/471 [00:10<02:38,  2.79it/s]  7%|▋         | 31/471 [00:10<02:33,  2.87it/s]  7%|▋         | 32/471 [00:11<02:29,  2.94it/s]  7%|▋         | 33/471 [00:11<02:38,  2.76it/s]  7%|▋         | 34/471 [00:11<02:46,  2.62it/s]  7%|▋         | 35/471 [00:12<02:46,  2.62it/s]  8%|▊         | 36/471 [00:12<02:38,  2.74it/s]  8%|▊         | 37/471 [00:12<02:33,  2.82it/s]  8%|▊         | 38/471 [00:13<02:30,  2.88it/s]  8%|▊         | 39/471 [00:13<02:31,  2.84it/s]  8%|▊         | 40/471 [00:14<02:40,  2.69it/s]  9%|▊         | 41/471 [00:14<02:45,  2.59it/s]  9%|▉         | 42/471 [00:14<02:40,  2.67it/s]  9%|▉         | 43/471 [00:15<02:33,  2.78it/s]  9%|▉         | 44/471 [00:15<02:28,  2.87it/s] 10%|▉         | 45/471 [00:15<02:25,  2.93it/s] 10%|▉         | 46/471 [00:16<02:33,  2.77it/s] 10%|▉         | 47/471 [00:16<02:31,  2.81it/s] 10%|█         | 48/471 [00:16<02:24,  2.93it/s] 10%|█         | 49/471 [00:17<02:28,  2.84it/s] 11%|█         | 50/471 [00:17<02:37,  2.67it/s] 11%|█         | 51/471 [00:18<02:42,  2.58it/s] 11%|█         | 52/471 [00:18<02:35,  2.69it/s] 11%|█▏        | 53/471 [00:18<02:29,  2.79it/s] 11%|█▏        | 54/471 [00:19<02:25,  2.87it/s] 12%|█▏        | 55/471 [00:19<02:22,  2.92it/s] 12%|█▏        | 56/471 [00:19<02:32,  2.72it/s] 12%|█▏        | 57/471 [00:20<02:38,  2.60it/s] 12%|█▏        | 58/471 [00:20<02:37,  2.62it/s] 13%|█▎        | 59/471 [00:20<02:30,  2.74it/s] 13%|█▎        | 60/471 [00:21<02:24,  2.84it/s] 13%|█▎        | 61/471 [00:21<02:18,  2.96it/s] 13%|█▎        | 62/471 [00:21<02:24,  2.83it/s] 13%|█▎        | 63/471 [00:22<02:32,  2.67it/s] 14%|█▎        | 64/471 [00:22<02:37,  2.59it/s] 14%|█▍        | 65/471 [00:23<02:30,  2.70it/s] 14%|█▍        | 66/471 [00:23<02:25,  2.79it/s] 14%|█▍        | 67/471 [00:23<02:21,  2.86it/s] 14%|█▍        | 68/471 [00:24<02:20,  2.87it/s] 15%|█▍        | 69/471 [00:24<02:27,  2.72it/s] 15%|█▍        | 70/471 [00:24<02:22,  2.81it/s] 15%|█▌        | 71/471 [00:25<02:15,  2.95it/s] 15%|█▌        | 72/471 [00:25<02:25,  2.75it/s] 15%|█▌        | 73/471 [00:25<02:32,  2.61it/s] 16%|█▌        | 74/471 [00:26<02:34,  2.57it/s] 16%|█▌        | 75/471 [00:26<02:27,  2.69it/s] 16%|█▌        | 76/471 [00:27<02:21,  2.78it/s] 16%|█▋        | 77/471 [00:27<02:18,  2.85it/s] 17%|█▋        | 78/471 [00:27<02:18,  2.84it/s] 17%|█▋        | 79/471 [00:28<02:26,  2.67it/s] 17%|█▋        | 80/471 [00:28<02:32,  2.57it/s] 17%|█▋        | 81/471 [00:28<02:26,  2.66it/s] 17%|█▋        | 82/471 [00:29<02:20,  2.76it/s] 18%|█▊        | 83/471 [00:29<02:16,  2.85it/s] 18%|█▊        | 84/471 [00:29<02:11,  2.93it/s] 18%|█▊        | 85/471 [00:30<02:21,  2.73it/s] 18%|█▊        | 86/471 [00:30<02:27,  2.61it/s] 18%|█▊        | 87/471 [00:31<02:27,  2.60it/s] 19%|█▊        | 88/471 [00:31<02:20,  2.72it/s] 19%|█▉        | 89/471 [00:31<02:15,  2.82it/s] 19%|█▉        | 90/471 [00:32<02:11,  2.89it/s] 19%|█▉        | 91/471 [00:32<02:13,  2.85it/s] 20%|█▉        | 92/471 [00:32<02:18,  2.74it/s] 20%|█▉        | 93/471 [00:33<02:14,  2.82it/s] 20%|█▉        | 94/471 [00:33<02:10,  2.90it/s] 20%|██        | 95/471 [00:33<02:19,  2.70it/s] 20%|██        | 96/471 [00:34<02:24,  2.59it/s] 21%|██        | 97/471 [00:34<02:23,  2.61it/s] 21%|██        | 98/471 [00:35<02:16,  2.73it/s] 21%|██        | 99/471 [00:35<02:11,  2.82it/s] 21%|██        | 100/471 [00:35<02:04,  2.97it/s] 21%|██▏       | 101/471 [00:36<02:12,  2.79it/s] 22%|██▏       | 102/471 [00:36<02:19,  2.64it/s] 22%|██▏       | 103/471 [00:36<02:24,  2.55it/s] 22%|██▏       | 104/471 [00:37<02:16,  2.68it/s] 22%|██▏       | 105/471 [00:37<02:11,  2.78it/s] 23%|██▎       | 106/471 [00:37<02:07,  2.87it/s] 23%|██▎       | 107/471 [00:38<02:06,  2.88it/s] 23%|██▎       | 108/471 [00:38<02:14,  2.69it/s] 23%|██▎       | 109/471 [00:39<02:19,  2.59it/s] 23%|██▎       | 110/471 [00:39<02:16,  2.64it/s] 24%|██▎       | 111/471 [00:39<02:11,  2.74it/s] 24%|██▍       | 112/471 [00:40<02:07,  2.82it/s] 24%|██▍       | 113/471 [00:40<02:01,  2.95it/s] 24%|██▍       | 114/471 [00:40<02:08,  2.77it/s] 24%|██▍       | 115/471 [00:41<02:09,  2.74it/s] 25%|██▍       | 116/471 [00:41<02:05,  2.82it/s] 25%|██▍       | 117/471 [00:41<01:48,  3.27it/s] 25%|██▌       | 118/471 [00:41<01:35,  3.70it/s] 25%|██▌       | 119/471 [00:42<01:27,  4.02it/s] 25%|██▌       | 120/471 [00:42<01:21,  4.32it/s] 26%|██▌       | 121/471 [00:42<01:16,  4.56it/s] 26%|██▌       | 122/471 [00:42<01:13,  4.76it/s] 26%|██▌       | 123/471 [00:42<01:10,  4.93it/s] 26%|██▋       | 124/471 [00:43<01:09,  5.02it/s] 27%|██▋       | 125/471 [00:43<01:08,  5.09it/s] 27%|██▋       | 126/471 [00:43<01:07,  5.15it/s] 27%|██▋       | 127/471 [00:43<01:07,  5.10it/s] 27%|██▋       | 128/471 [00:43<01:06,  5.13it/s] 27%|██▋       | 129/471 [00:44<01:06,  5.15it/s] 28%|██▊       | 130/471 [00:44<01:06,  5.16it/s] 28%|██▊       | 131/471 [00:44<01:05,  5.19it/s] 28%|██▊       | 132/471 [00:44<01:05,  5.17it/s] 28%|██▊       | 133/471 [00:44<01:04,  5.21it/s] 28%|██▊       | 134/471 [00:45<01:04,  5.24it/s] 29%|██▊       | 135/471 [00:45<01:04,  5.22it/s] 29%|██▉       | 136/471 [00:45<01:05,  5.15it/s] 29%|██▉       | 137/471 [00:45<01:23,  4.02it/s] 29%|██▉       | 138/471 [00:46<01:39,  3.33it/s] 30%|██▉       | 139/471 [00:46<01:51,  2.98it/s] 30%|██▉       | 140/471 [00:46<01:52,  2.94it/s] 30%|██▉       | 141/471 [00:47<01:50,  2.98it/s] 30%|███       | 142/471 [00:47<01:49,  3.01it/s] 30%|███       | 143/471 [00:47<01:47,  3.06it/s] 31%|███       | 144/471 [00:48<01:56,  2.80it/s] 31%|███       | 145/471 [00:48<02:02,  2.65it/s] 31%|███       | 146/471 [00:49<02:03,  2.62it/s] 31%|███       | 147/471 [00:49<01:58,  2.74it/s] 31%|███▏      | 148/471 [00:49<01:54,  2.82it/s] 32%|███▏      | 149/471 [00:50<01:52,  2.87it/s] 32%|███▏      | 150/471 [00:50<01:54,  2.81it/s] 32%|███▏      | 151/471 [00:50<02:00,  2.66it/s] 32%|███▏      | 152/471 [00:51<02:04,  2.57it/s] 32%|███▏      | 153/471 [00:51<01:59,  2.66it/s] 33%|███▎      | 154/471 [00:52<01:54,  2.76it/s] 33%|███▎      | 155/471 [00:52<01:51,  2.83it/s] 33%|███▎      | 156/471 [00:52<01:48,  2.89it/s] 33%|███▎      | 157/471 [00:53<01:54,  2.73it/s] 34%|███▎      | 158/471 [00:53<01:52,  2.78it/s] 34%|███▍      | 159/471 [00:53<01:47,  2.90it/s] 34%|███▍      | 160/471 [00:54<01:50,  2.80it/s] 34%|███▍      | 161/471 [00:54<01:57,  2.64it/s] 34%|███▍      | 162/471 [00:55<02:01,  2.55it/s] 35%|███▍      | 163/471 [00:55<01:55,  2.67it/s] 35%|███▍      | 164/471 [00:55<01:50,  2.78it/s] 35%|███▌      | 165/471 [00:56<01:47,  2.86it/s] 35%|███▌      | 166/471 [00:56<01:45,  2.89it/s] 35%|███▌      | 167/471 [00:56<01:52,  2.70it/s] 36%|███▌      | 168/471 [00:57<01:57,  2.58it/s] 36%|███▌      | 169/471 [00:57<01:56,  2.60it/s] 36%|███▌      | 170/471 [00:57<01:51,  2.71it/s] 36%|███▋      | 171/471 [00:58<01:47,  2.78it/s] 37%|███▋      | 172/471 [00:58<01:42,  2.92it/s] 37%|███▋      | 173/471 [00:58<01:49,  2.73it/s] 37%|███▋      | 174/471 [00:59<01:54,  2.60it/s] 37%|███▋      | 175/471 [00:59<01:56,  2.54it/s] 37%|███▋      | 176/471 [01:00<01:50,  2.67it/s] 38%|███▊      | 177/471 [01:00<01:45,  2.78it/s] 38%|███▊      | 178/471 [01:00<01:42,  2.85it/s] 38%|███▊      | 179/471 [01:01<01:42,  2.84it/s] 38%|███▊      | 180/471 [01:01<01:47,  2.70it/s] 38%|███▊      | 181/471 [01:01<01:43,  2.79it/s] 39%|███▊      | 182/471 [01:02<01:38,  2.92it/s] 39%|███▉      | 183/471 [01:02<01:46,  2.71it/s] 39%|███▉      | 184/471 [01:03<01:50,  2.59it/s] 39%|███▉      | 185/471 [01:03<01:52,  2.55it/s] 39%|███▉      | 186/471 [01:03<01:46,  2.67it/s] 40%|███▉      | 187/471 [01:04<01:42,  2.77it/s] 40%|███▉      | 188/471 [01:04<01:39,  2.83it/s] 40%|████      | 189/471 [01:04<01:40,  2.81it/s] 40%|████      | 190/471 [01:05<01:45,  2.65it/s] 41%|████      | 191/471 [01:05<01:49,  2.56it/s] 41%|████      | 192/471 [01:06<01:45,  2.65it/s] 41%|████      | 193/471 [01:06<01:41,  2.75it/s] 41%|████      | 194/471 [01:06<01:38,  2.82it/s] 41%|████▏     | 195/471 [01:07<01:35,  2.88it/s] 42%|████▏     | 196/471 [01:07<01:42,  2.69it/s] 42%|████▏     | 197/471 [01:07<01:45,  2.59it/s] 42%|████▏     | 198/471 [01:08<01:45,  2.59it/s] 42%|████▏     | 199/471 [01:08<01:40,  2.70it/s] 42%|████▏     | 200/471 [01:08<01:37,  2.78it/s] 43%|████▎     | 201/471 [01:09<01:33,  2.89it/s] 43%|████▎     | 202/471 [01:09<01:36,  2.78it/s] 43%|████▎     | 203/471 [01:10<01:38,  2.72it/s] 43%|████▎     | 204/471 [01:10<01:34,  2.83it/s] 44%|████▎     | 205/471 [01:10<01:32,  2.86it/s] 44%|████▎     | 206/471 [01:11<01:38,  2.68it/s] 44%|████▍     | 207/471 [01:11<01:42,  2.57it/s] 44%|████▍     | 208/471 [01:11<01:40,  2.62it/s] 44%|████▍     | 209/471 [01:12<01:35,  2.74it/s] 45%|████▍     | 210/471 [01:12<01:32,  2.83it/s] 45%|████▍     | 211/471 [01:12<01:28,  2.94it/s] 45%|████▌     | 212/471 [01:13<01:34,  2.73it/s] 45%|████▌     | 213/471 [01:13<01:39,  2.60it/s] 45%|████▌     | 214/471 [01:14<01:40,  2.56it/s] 46%|████▌     | 215/471 [01:14<01:35,  2.68it/s] 46%|████▌     | 216/471 [01:14<01:31,  2.77it/s] 46%|████▌     | 217/471 [01:15<01:29,  2.84it/s] 46%|████▋     | 218/471 [01:15<01:30,  2.81it/s] 46%|████▋     | 219/471 [01:15<01:35,  2.64it/s] 47%|████▋     | 220/471 [01:16<01:38,  2.55it/s] 47%|████▋     | 221/471 [01:16<01:35,  2.63it/s] 47%|████▋     | 222/471 [01:17<01:30,  2.74it/s] 47%|████▋     | 223/471 [01:17<01:28,  2.81it/s] 48%|████▊     | 224/471 [01:17<01:24,  2.91it/s] 48%|████▊     | 225/471 [01:18<01:29,  2.74it/s] 48%|████▊     | 226/471 [01:18<01:28,  2.75it/s] 48%|████▊     | 227/471 [01:18<01:25,  2.85it/s] 48%|████▊     | 228/471 [01:19<01:25,  2.83it/s] 49%|████▊     | 229/471 [01:19<01:31,  2.65it/s] 49%|████▉     | 230/471 [01:19<01:34,  2.56it/s] 49%|████▉     | 231/471 [01:20<01:30,  2.66it/s] 49%|████▉     | 232/471 [01:20<01:26,  2.76it/s] 49%|████▉     | 233/471 [01:20<01:24,  2.83it/s] 50%|████▉     | 234/471 [01:21<01:22,  2.89it/s] 50%|████▉     | 235/471 [01:21<01:27,  2.70it/s] 50%|█████     | 236/471 [01:22<01:30,  2.59it/s] 50%|█████     | 237/471 [01:22<01:30,  2.58it/s] 51%|█████     | 238/471 [01:22<01:26,  2.70it/s] 51%|█████     | 239/471 [01:23<01:23,  2.79it/s] 51%|█████     | 240/471 [01:23<01:20,  2.87it/s] 51%|█████     | 241/471 [01:23<01:22,  2.80it/s] 51%|█████▏    | 242/471 [01:24<01:26,  2.64it/s] 52%|█████▏    | 243/471 [01:24<01:29,  2.55it/s] 52%|█████▏    | 244/471 [01:25<01:25,  2.66it/s] 52%|█████▏    | 245/471 [01:25<01:22,  2.75it/s] 52%|█████▏    | 246/471 [01:25<01:19,  2.82it/s] 52%|█████▏    | 247/471 [01:26<01:17,  2.89it/s] 53%|█████▎    | 248/471 [01:26<01:22,  2.72it/s] 53%|█████▎    | 249/471 [01:26<01:19,  2.78it/s] 53%|█████▎    | 250/471 [01:27<01:14,  2.97it/s] 53%|█████▎    | 251/471 [01:27<01:04,  3.42it/s] 54%|█████▎    | 252/471 [01:27<00:57,  3.81it/s] 54%|█████▎    | 253/471 [01:27<00:52,  4.14it/s] 54%|█████▍    | 254/471 [01:27<00:49,  4.40it/s] 54%|█████▍    | 255/471 [01:28<00:46,  4.64it/s] 54%|█████▍    | 256/471 [01:28<00:44,  4.83it/s] 55%|█████▍    | 257/471 [01:28<00:43,  4.96it/s] 55%|█████▍    | 258/471 [01:28<00:42,  4.98it/s] 55%|█████▍    | 259/471 [01:28<00:42,  5.02it/s] 55%|█████▌    | 260/471 [01:29<00:41,  5.06it/s] 55%|█████▌    | 261/471 [01:29<00:41,  5.07it/s] 56%|█████▌    | 262/471 [01:29<00:40,  5.16it/s] 56%|█████▌    | 263/471 [01:29<00:40,  5.11it/s] 56%|█████▌    | 264/471 [01:29<00:40,  5.06it/s] 56%|█████▋    | 265/471 [01:30<00:53,  3.85it/s] 56%|█████▋    | 266/471 [01:30<01:03,  3.24it/s] 57%|█████▋    | 267/471 [01:31<01:10,  2.91it/s] 57%|█████▋    | 268/471 [01:31<01:09,  2.93it/s] 57%|█████▋    | 269/471 [01:31<01:08,  2.95it/s] 57%|█████▋    | 270/471 [01:32<01:07,  2.98it/s] 58%|█████▊    | 271/471 [01:32<01:07,  2.98it/s] 58%|█████▊    | 272/471 [01:32<01:12,  2.75it/s] 58%|█████▊    | 273/471 [01:33<01:15,  2.62it/s] 58%|█████▊    | 274/471 [01:33<01:14,  2.64it/s] 58%|█████▊    | 275/471 [01:33<01:11,  2.75it/s] 59%|█████▊    | 276/471 [01:34<01:08,  2.83it/s] 59%|█████▉    | 277/471 [01:34<01:05,  2.96it/s] 59%|█████▉    | 278/471 [01:35<01:10,  2.74it/s] 59%|█████▉    | 279/471 [01:35<01:13,  2.61it/s] 59%|█████▉    | 280/471 [01:35<01:14,  2.56it/s] 60%|█████▉    | 281/471 [01:36<01:10,  2.69it/s] 60%|█████▉    | 282/471 [01:36<01:07,  2.79it/s] 60%|██████    | 283/471 [01:36<01:05,  2.86it/s] 60%|██████    | 284/471 [01:37<01:05,  2.85it/s] 61%|██████    | 285/471 [01:37<01:08,  2.71it/s] 61%|██████    | 286/471 [01:37<01:06,  2.80it/s] 61%|██████    | 287/471 [01:38<01:02,  2.93it/s] 61%|██████    | 288/471 [01:38<01:07,  2.72it/s] 61%|██████▏   | 289/471 [01:39<01:10,  2.60it/s] 62%|██████▏   | 290/471 [01:39<01:10,  2.57it/s] 62%|██████▏   | 291/471 [01:39<01:06,  2.69it/s] 62%|██████▏   | 292/471 [01:40<01:04,  2.78it/s] 62%|██████▏   | 293/471 [01:40<01:02,  2.85it/s] 62%|██████▏   | 294/471 [01:40<01:02,  2.82it/s] 63%|██████▎   | 295/471 [01:41<01:06,  2.66it/s] 63%|██████▎   | 296/471 [01:41<01:08,  2.56it/s] 63%|██████▎   | 297/471 [01:42<01:05,  2.66it/s] 63%|██████▎   | 298/471 [01:42<01:02,  2.77it/s] 63%|██████▎   | 299/471 [01:42<01:00,  2.85it/s] 64%|██████▎   | 300/471 [01:43<00:58,  2.90it/s] 64%|██████▍   | 301/471 [01:43<01:02,  2.70it/s] 64%|██████▍   | 302/471 [01:43<01:05,  2.59it/s] 64%|██████▍   | 303/471 [01:44<01:04,  2.60it/s] 65%|██████▍   | 304/471 [01:44<01:01,  2.72it/s] 65%|██████▍   | 305/471 [01:44<00:59,  2.81it/s] 65%|██████▍   | 306/471 [01:45<00:56,  2.90it/s] 65%|██████▌   | 307/471 [01:45<00:58,  2.82it/s] 65%|██████▌   | 308/471 [01:46<00:59,  2.73it/s] 66%|██████▌   | 309/471 [01:46<00:57,  2.82it/s] 66%|██████▌   | 310/471 [01:46<00:55,  2.90it/s] 66%|██████▌   | 311/471 [01:47<00:59,  2.69it/s] 66%|██████▌   | 312/471 [01:47<01:01,  2.59it/s] 66%|██████▋   | 313/471 [01:47<01:00,  2.61it/s] 67%|██████▋   | 314/471 [01:48<00:57,  2.72it/s] 67%|██████▋   | 315/471 [01:48<00:55,  2.81it/s] 67%|██████▋   | 316/471 [01:48<00:52,  2.95it/s] 67%|██████▋   | 317/471 [01:49<00:54,  2.83it/s] 68%|██████▊   | 318/471 [01:49<00:57,  2.66it/s] 68%|██████▊   | 319/471 [01:50<00:59,  2.56it/s] 68%|██████▊   | 320/471 [01:50<00:56,  2.67it/s] 68%|██████▊   | 321/471 [01:50<00:54,  2.76it/s] 68%|██████▊   | 322/471 [01:51<00:52,  2.83it/s] 69%|██████▊   | 323/471 [01:51<00:51,  2.86it/s] 69%|██████▉   | 324/471 [01:51<00:54,  2.68it/s] 69%|██████▉   | 325/471 [01:52<00:56,  2.57it/s] 69%|██████▉   | 326/471 [01:52<00:56,  2.59it/s] 69%|██████▉   | 327/471 [01:53<00:53,  2.71it/s] 70%|██████▉   | 328/471 [01:53<00:51,  2.80it/s] 70%|██████▉   | 329/471 [01:53<00:48,  2.93it/s] 70%|███████   | 330/471 [01:54<00:50,  2.77it/s] 70%|███████   | 331/471 [01:54<00:51,  2.72it/s] 70%|███████   | 332/471 [01:54<00:49,  2.81it/s] 71%|███████   | 333/471 [01:55<00:48,  2.84it/s] 71%|███████   | 334/471 [01:55<00:51,  2.66it/s] 71%|███████   | 335/471 [01:55<00:53,  2.55it/s] 71%|███████▏  | 336/471 [01:56<00:51,  2.63it/s] 72%|███████▏  | 337/471 [01:56<00:48,  2.74it/s] 72%|███████▏  | 338/471 [01:56<00:47,  2.82it/s] 72%|███████▏  | 339/471 [01:57<00:45,  2.91it/s] 72%|███████▏  | 340/471 [01:57<00:48,  2.71it/s] 72%|███████▏  | 341/471 [01:58<00:50,  2.59it/s] 73%|███████▎  | 342/471 [01:58<00:50,  2.57it/s] 73%|███████▎  | 343/471 [01:58<00:47,  2.68it/s] 73%|███████▎  | 344/471 [01:59<00:45,  2.78it/s] 73%|███████▎  | 345/471 [01:59<00:44,  2.84it/s] 73%|███████▎  | 346/471 [01:59<00:44,  2.81it/s] 74%|███████▎  | 347/471 [02:00<00:46,  2.65it/s] 74%|███████▍  | 348/471 [02:00<00:48,  2.55it/s] 74%|███████▍  | 349/471 [02:01<00:46,  2.65it/s] 74%|███████▍  | 350/471 [02:01<00:43,  2.75it/s] 75%|███████▍  | 351/471 [02:01<00:42,  2.84it/s] 75%|███████▍  | 352/471 [02:02<00:41,  2.89it/s] 75%|███████▍  | 353/471 [02:02<00:43,  2.71it/s] 75%|███████▌  | 354/471 [02:02<00:42,  2.76it/s] 75%|███████▌  | 355/471 [02:03<00:39,  2.92it/s] 76%|███████▌  | 356/471 [02:03<00:41,  2.77it/s] 76%|███████▌  | 357/471 [02:04<00:43,  2.61it/s] 76%|███████▌  | 358/471 [02:04<00:44,  2.53it/s] 76%|███████▌  | 359/471 [02:04<00:42,  2.65it/s] 76%|███████▋  | 360/471 [02:05<00:40,  2.76it/s] 77%|███████▋  | 361/471 [02:05<00:38,  2.84it/s] 77%|███████▋  | 362/471 [02:05<00:38,  2.86it/s] 77%|███████▋  | 363/471 [02:06<00:40,  2.69it/s] 77%|███████▋  | 364/471 [02:06<00:41,  2.58it/s] 77%|███████▋  | 365/471 [02:06<00:40,  2.60it/s] 78%|███████▊  | 366/471 [02:07<00:38,  2.71it/s] 78%|███████▊  | 367/471 [02:07<00:37,  2.80it/s] 78%|███████▊  | 368/471 [02:07<00:34,  2.95it/s] 78%|███████▊  | 369/471 [02:08<00:37,  2.74it/s] 79%|███████▊  | 370/471 [02:08<00:38,  2.61it/s] 79%|███████▉  | 371/471 [02:09<00:39,  2.54it/s] 79%|███████▉  | 372/471 [02:09<00:37,  2.67it/s] 79%|███████▉  | 373/471 [02:09<00:35,  2.77it/s] 79%|███████▉  | 374/471 [02:10<00:34,  2.84it/s] 80%|███████▉  | 375/471 [02:10<00:33,  2.84it/s] 80%|███████▉  | 376/471 [02:10<00:35,  2.70it/s] 80%|████████  | 377/471 [02:11<00:33,  2.78it/s] 80%|████████  | 378/471 [02:11<00:30,  3.05it/s] 80%|████████  | 379/471 [02:11<00:26,  3.49it/s] 81%|████████  | 380/471 [02:11<00:23,  3.84it/s] 81%|████████  | 381/471 [02:12<00:21,  4.17it/s] 81%|████████  | 382/471 [02:12<00:20,  4.43it/s] 81%|████████▏ | 383/471 [02:12<00:18,  4.64it/s] 82%|████████▏ | 384/471 [02:12<00:18,  4.81it/s] 82%|████████▏ | 385/471 [02:12<00:17,  4.93it/s] 82%|████████▏ | 386/471 [02:13<00:16,  5.01it/s] 82%|████████▏ | 387/471 [02:13<00:16,  5.06it/s] 82%|████████▏ | 388/471 [02:13<00:16,  5.11it/s] 83%|████████▎ | 389/471 [02:13<00:15,  5.16it/s] 83%|████████▎ | 390/471 [02:13<00:15,  5.17it/s] 83%|████████▎ | 391/471 [02:14<00:15,  5.19it/s] 83%|████████▎ | 392/471 [02:14<00:15,  5.22it/s] 83%|████████▎ | 393/471 [02:14<00:15,  5.19it/s] 84%|████████▎ | 394/471 [02:14<00:14,  5.15it/s] 84%|████████▍ | 395/471 [02:14<00:14,  5.13it/s] 84%|████████▍ | 396/471 [02:15<00:14,  5.13it/s] 84%|████████▍ | 397/471 [02:15<00:14,  5.13it/s] 85%|████████▍ | 398/471 [02:15<00:14,  5.15it/s] 85%|████████▍ | 399/471 [02:15<00:14,  5.07it/s] 85%|████████▍ | 400/471 [02:15<00:17,  4.11it/s] 85%|████████▌ | 401/471 [02:16<00:20,  3.36it/s] 85%|████████▌ | 402/471 [02:16<00:23,  2.97it/s] 86%|████████▌ | 403/471 [02:17<00:23,  2.90it/s] 86%|████████▌ | 404/471 [02:17<00:22,  2.93it/s] 86%|████████▌ | 405/471 [02:17<00:22,  2.95it/s] 86%|████████▌ | 406/471 [02:18<00:21,  3.03it/s] 86%|████████▋ | 407/471 [02:18<00:22,  2.79it/s] 87%|████████▋ | 408/471 [02:19<00:23,  2.63it/s] 87%|████████▋ | 409/471 [02:19<00:24,  2.57it/s] 87%|████████▋ | 410/471 [02:19<00:22,  2.70it/s] 87%|████████▋ | 411/471 [02:20<00:21,  2.79it/s] 87%|████████▋ | 412/471 [02:20<00:20,  2.85it/s] 88%|████████▊ | 413/471 [02:20<00:20,  2.82it/s] 88%|████████▊ | 414/471 [02:21<00:21,  2.66it/s] 88%|████████▊ | 415/471 [02:21<00:21,  2.56it/s] 88%|████████▊ | 416/471 [02:22<00:20,  2.62it/s] 89%|████████▊ | 417/471 [02:22<00:19,  2.73it/s] 89%|████████▊ | 418/471 [02:22<00:18,  2.82it/s] 89%|████████▉ | 419/471 [02:22<00:17,  2.91it/s] 89%|████████▉ | 420/471 [02:23<00:18,  2.74it/s] 89%|████████▉ | 421/471 [02:23<00:18,  2.73it/s] 90%|████████▉ | 422/471 [02:24<00:17,  2.81it/s] 90%|████████▉ | 423/471 [02:24<00:17,  2.80it/s] 90%|█████████ | 424/471 [02:24<00:17,  2.63it/s] 90%|█████████ | 425/471 [02:25<00:18,  2.55it/s] 90%|█████████ | 426/471 [02:25<00:17,  2.62it/s] 91%|█████████ | 427/471 [02:25<00:16,  2.73it/s] 91%|█████████ | 428/471 [02:26<00:15,  2.80it/s] 91%|█████████ | 429/471 [02:26<00:14,  2.89it/s] 91%|█████████▏| 430/471 [02:27<00:15,  2.69it/s] 92%|█████████▏| 431/471 [02:27<00:15,  2.57it/s] 92%|█████████▏| 432/471 [02:27<00:15,  2.55it/s] 92%|█████████▏| 433/471 [02:28<00:14,  2.67it/s] 92%|█████████▏| 434/471 [02:28<00:13,  2.75it/s] 92%|█████████▏| 435/471 [02:28<00:12,  2.81it/s] 93%|█████████▎| 436/471 [02:29<00:12,  2.78it/s] 93%|█████████▎| 437/471 [02:29<00:12,  2.62it/s] 93%|█████████▎| 438/471 [02:30<00:13,  2.53it/s] 93%|█████████▎| 439/471 [02:30<00:12,  2.61it/s] 93%|█████████▎| 440/471 [02:30<00:11,  2.72it/s] 94%|█████████▎| 441/471 [02:31<00:10,  2.79it/s] 94%|█████████▍| 442/471 [02:31<00:10,  2.86it/s] 94%|█████████▍| 443/471 [02:31<00:10,  2.69it/s] 94%|█████████▍| 444/471 [02:32<00:09,  2.73it/s] 94%|█████████▍| 445/471 [02:32<00:09,  2.87it/s] 95%|█████████▍| 446/471 [02:32<00:09,  2.74it/s] 95%|█████████▍| 447/471 [02:33<00:09,  2.57it/s] 95%|█████████▌| 448/471 [02:33<00:09,  2.50it/s] 95%|█████████▌| 449/471 [02:34<00:08,  2.63it/s] 96%|█████████▌| 450/471 [02:34<00:07,  2.72it/s] 96%|█████████▌| 451/471 [02:34<00:07,  2.79it/s] 96%|█████████▌| 452/471 [02:35<00:06,  2.81it/s] 96%|█████████▌| 453/471 [02:35<00:06,  2.62it/s] 96%|█████████▋| 454/471 [02:36<00:06,  2.52it/s] 97%|█████████▋| 455/471 [02:36<00:06,  2.57it/s] 97%|█████████▋| 456/471 [02:36<00:05,  2.68it/s] 97%|█████████▋| 457/471 [02:37<00:05,  2.76it/s] 97%|█████████▋| 458/471 [02:37<00:04,  2.85it/s] 97%|█████████▋| 459/471 [02:37<00:04,  2.66it/s] 98%|█████████▊| 460/471 [02:38<00:04,  2.55it/s] 98%|█████████▊| 461/471 [02:38<00:03,  2.53it/s] 98%|█████████▊| 462/471 [02:39<00:03,  2.64it/s] 98%|█████████▊| 463/471 [02:39<00:02,  2.73it/s] 99%|█████████▊| 464/471 [02:39<00:02,  2.80it/s] 99%|█████████▊| 465/471 [02:40<00:02,  2.78it/s] 99%|█████████▉| 466/471 [02:40<00:01,  2.68it/s] 99%|█████████▉| 467/471 [02:40<00:01,  2.76it/s] 99%|█████████▉| 468/471 [02:41<00:01,  2.83it/s]100%|█████████▉| 469/471 [02:41<00:00,  2.64it/s]100%|█████████▉| 470/471 [02:42<00:00,  2.53it/s]100%|██████████| 471/471 [02:42<00:00,  2.70it/s]100%|██████████| 471/471 [02:42<00:00,  2.90it/s]
{'eval_loss': 1.962641716003418, 'eval_model_preparation_time': 0.0054, 'eval_acc': 0.483271375464684, 'eval_runtime': 162.5405, 'eval_samples_per_second': 46.339, 'eval_steps_per_second': 2.898}
