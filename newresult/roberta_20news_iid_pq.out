nohup: ignoring input
Map:   0%|          | 0/11314 [00:00<?, ? examples/s]Map:   9%|▉         | 1000/11314 [00:00<00:03, 2847.70 examples/s]Map:  18%|█▊        | 2000/11314 [00:00<00:03, 2840.33 examples/s]Map:  27%|██▋       | 3000/11314 [00:00<00:02, 3065.43 examples/s]Map:  35%|███▌      | 4000/11314 [00:01<00:02, 2902.46 examples/s]Map:  44%|████▍     | 5000/11314 [00:01<00:02, 2768.29 examples/s]Map:  53%|█████▎    | 6000/11314 [00:02<00:01, 2847.64 examples/s]Map:  62%|██████▏   | 7000/11314 [00:02<00:01, 2876.01 examples/s]Map:  71%|███████   | 8000/11314 [00:02<00:01, 2974.47 examples/s]Map:  80%|███████▉  | 9000/11314 [00:03<00:00, 2998.79 examples/s]Map:  88%|████████▊ | 10000/11314 [00:03<00:00, 2929.06 examples/s]Map:  97%|█████████▋| 11000/11314 [00:03<00:00, 2928.25 examples/s]Map: 100%|██████████| 11314/11314 [00:03<00:00, 2919.78 examples/s]
Map:   0%|          | 0/7532 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7532 [00:00<00:01, 3899.44 examples/s]Map:  27%|██▋       | 2000/7532 [00:00<00:01, 3056.55 examples/s]Map:  40%|███▉      | 3000/7532 [00:01<00:01, 2629.63 examples/s]Map:  53%|█████▎    | 4000/7532 [00:01<00:01, 2335.55 examples/s]Map:  66%|██████▋   | 5000/7532 [00:01<00:00, 2585.90 examples/s]Map:  80%|███████▉  | 6000/7532 [00:02<00:00, 2846.62 examples/s]Map:  93%|█████████▎| 7000/7532 [00:02<00:00, 2879.13 examples/s]Map: 100%|██████████| 7532/7532 [00:02<00:00, 2946.40 examples/s]Map: 100%|██████████| 7532/7532 [00:02<00:00, 2810.50 examples/s]
Some weights of RobertaForSequenceClassification were not initialized from the model checkpoint at ./model/models--roberta-base/ and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
trainable params: 1,179,648 || all params: 125,840,660 || trainable%: 0.9374
PeftModelForCausalLM(
  (base_model): LoraModel(
    (model): RobertaForSequenceClassification(
      (roberta): RobertaModel(
        (embeddings): RobertaEmbeddings(
          (word_embeddings): Embedding(50265, 768, padding_idx=1)
          (position_embeddings): Embedding(514, 768, padding_idx=1)
          (token_type_embeddings): Embedding(1, 768)
          (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (encoder): RobertaEncoder(
          (layer): ModuleList(
            (0-11): 12 x RobertaLayer(
              (attention): RobertaAttention(
                (self): RobertaSdpaSelfAttention(
                  (query): lora.Linear(
                    (base_layer): Linear(in_features=768, out_features=768, bias=True)
                    (lora_dropout): ModuleDict(
                      (default): Dropout(p=0.05, inplace=False)
                    )
                    (lora_A): ModuleDict(
                      (default): Linear(in_features=768, out_features=32, bias=False)
                    )
                    (lora_B): ModuleDict(
                      (default): Linear(in_features=32, out_features=768, bias=False)
                    )
                    (lora_embedding_A): ParameterDict()
                    (lora_embedding_B): ParameterDict()
                    (lora_magnitude_vector): ModuleDict()
                  )
                  (key): Linear(in_features=768, out_features=768, bias=True)
                  (value): lora.Linear(
                    (base_layer): Linear(in_features=768, out_features=768, bias=True)
                    (lora_dropout): ModuleDict(
                      (default): Dropout(p=0.05, inplace=False)
                    )
                    (lora_A): ModuleDict(
                      (default): Linear(in_features=768, out_features=32, bias=False)
                    )
                    (lora_B): ModuleDict(
                      (default): Linear(in_features=32, out_features=768, bias=False)
                    )
                    (lora_embedding_A): ParameterDict()
                    (lora_embedding_B): ParameterDict()
                    (lora_magnitude_vector): ModuleDict()
                  )
                  (dropout): Dropout(p=0.1, inplace=False)
                )
                (output): RobertaSelfOutput(
                  (dense): Linear(in_features=768, out_features=768, bias=True)
                  (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                  (dropout): Dropout(p=0.1, inplace=False)
                )
              )
              (intermediate): RobertaIntermediate(
                (dense): Linear(in_features=768, out_features=3072, bias=True)
                (intermediate_act_fn): GELUActivation()
              )
              (output): RobertaOutput(
                (dense): Linear(in_features=3072, out_features=768, bias=True)
                (LayerNorm): LayerNorm((768,), eps=1e-05, elementwise_affine=True)
                (dropout): Dropout(p=0.1, inplace=False)
              )
            )
          )
        )
      )
      (classifier): RobertaClassificationHead(
        (dense): Linear(in_features=768, out_features=768, bias=True)
        (dropout): Dropout(p=0.1, inplace=False)
        (out_proj): Linear(in_features=768, out_features=20, bias=True)
      )
    )
  )
)
ROUND:0
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:57,  1.47s/it]                                              {'loss': 2.9824, 'grad_norm': 1.9054919481277466, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:57,  1.47s/it]  5%|▌         | 2/40 [00:01<00:32,  1.19it/s]                                              {'loss': 3.0016, 'grad_norm': 2.222867012023926, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:32,  1.19it/s]  8%|▊         | 3/40 [00:02<00:22,  1.61it/s]                                              {'loss': 2.9259, 'grad_norm': 2.0977556705474854, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:22,  1.61it/s] 10%|█         | 4/40 [00:02<00:17,  2.05it/s]                                              {'loss': 3.0162, 'grad_norm': 2.601722478866577, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:17,  2.05it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.9815, 'grad_norm': 3.034400701522827, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s] 15%|█▌        | 6/40 [00:03<00:14,  2.40it/s]                                              {'loss': 2.8734, 'grad_norm': 2.273776054382324, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:14,  2.40it/s] 18%|█▊        | 7/40 [00:03<00:13,  2.49it/s]                                              {'loss': 3.098, 'grad_norm': 2.1881368160247803, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:13,  2.49it/s] 20%|██        | 8/40 [00:03<00:11,  2.78it/s]                                              {'loss': 3.0113, 'grad_norm': 2.2278804779052734, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.78it/s] 22%|██▎       | 9/40 [00:04<00:11,  2.79it/s]                                              {'loss': 3.0381, 'grad_norm': 2.2946696281433105, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:11,  2.79it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.72it/s]                                               {'loss': 2.908, 'grad_norm': 1.9736710786819458, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.72it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.76it/s]                                               {'loss': 2.9421, 'grad_norm': 2.742884635925293, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.76it/s] 30%|███       | 12/40 [00:05<00:09,  2.99it/s]                                               {'loss': 2.906, 'grad_norm': 1.4087436199188232, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:09,  2.99it/s] 32%|███▎      | 13/40 [00:05<00:08,  3.02it/s]                                               {'loss': 2.8975, 'grad_norm': 1.9576747417449951, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:08,  3.02it/s] 35%|███▌      | 14/40 [00:05<00:08,  2.98it/s]                                               {'loss': 2.9439, 'grad_norm': 1.8867758512496948, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:08,  2.98it/s] 38%|███▊      | 15/40 [00:06<00:08,  3.01it/s]                                               {'loss': 2.9272, 'grad_norm': 2.401893377304077, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:08,  3.01it/s] 40%|████      | 16/40 [00:06<00:06,  3.73it/s]                                               {'loss': 2.8973, 'grad_norm': 8.384102821350098, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:06,  3.73it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.46it/s]                                               {'loss': 2.9746, 'grad_norm': 2.1688997745513916, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.46it/s] 45%|████▌     | 18/40 [00:07<00:06,  3.30it/s]                                               {'loss': 2.9672, 'grad_norm': 4.756843090057373, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:06,  3.30it/s] 48%|████▊     | 19/40 [00:07<00:06,  3.25it/s]                                               {'loss': 2.7794, 'grad_norm': 1.9862542152404785, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:06,  3.25it/s] 50%|█████     | 20/40 [00:07<00:06,  3.16it/s]                                               {'loss': 2.8028, 'grad_norm': 3.138461112976074, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  3.16it/s] 52%|█████▎    | 21/40 [00:08<00:06,  3.06it/s]                                               {'loss': 2.9133, 'grad_norm': 2.2768287658691406, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:06,  3.06it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.96it/s]                                               {'loss': 2.8914, 'grad_norm': 2.5124852657318115, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.96it/s] 57%|█████▊    | 23/40 [00:08<00:05,  2.87it/s]                                               {'loss': 2.9439, 'grad_norm': 3.0025546550750732, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:05,  2.87it/s]                                               {'loss': 2.4716, 'grad_norm': 9.048197746276855, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.46it/s]                                               {'loss': 3.0172, 'grad_norm': 2.3758230209350586, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.46it/s] 65%|██████▌   | 26/40 [00:09<00:04,  3.27it/s]                                               {'loss': 2.74, 'grad_norm': 3.10799503326416, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  3.27it/s] 68%|██████▊   | 27/40 [00:09<00:04,  3.15it/s]                                               {'loss': 2.8624, 'grad_norm': 3.087217330932617, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  3.15it/s] 70%|███████   | 28/40 [00:10<00:03,  3.07it/s]                                               {'loss': 2.7698, 'grad_norm': 2.3925623893737793, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:03,  3.07it/s] 72%|███████▎  | 29/40 [00:10<00:03,  2.98it/s]                                               {'loss': 2.7637, 'grad_norm': 2.390740156173706, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:03,  2.98it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.90it/s]                                               {'loss': 2.8262, 'grad_norm': 2.17514705657959, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.90it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.83it/s]                                               {'loss': 3.0072, 'grad_norm': 3.3560328483581543, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.83it/s] 80%|████████  | 32/40 [00:11<00:02,  3.58it/s]                                               {'loss': 3.5572, 'grad_norm': 11.395055770874023, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  3.58it/s] 82%|████████▎ | 33/40 [00:11<00:02,  3.30it/s]                                               {'loss': 2.7488, 'grad_norm': 2.3301405906677246, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:11<00:02,  3.30it/s] 85%|████████▌ | 34/40 [00:12<00:01,  3.14it/s]                                               {'loss': 2.959, 'grad_norm': 2.7371466159820557, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:01,  3.14it/s] 88%|████████▊ | 35/40 [00:12<00:01,  3.02it/s]                                               {'loss': 2.9806, 'grad_norm': 3.0163168907165527, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:12<00:01,  3.02it/s] 90%|█████████ | 36/40 [00:12<00:01,  3.02it/s]                                               {'loss': 2.9023, 'grad_norm': 2.5451581478118896, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:12<00:01,  3.02it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.79it/s]                                               {'loss': 2.7398, 'grad_norm': 7.0897088050842285, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.79it/s] 95%|█████████▌| 38/40 [00:13<00:00,  2.61it/s]                                               {'loss': 2.971, 'grad_norm': 2.9941277503967285, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:00,  2.61it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.51it/s]                                               {'loss': 2.8495, 'grad_norm': 3.077542781829834, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.51it/s]100%|██████████| 40/40 [00:14<00:00,  3.12it/s]                                               {'loss': 2.7664, 'grad_norm': 10.751489639282227, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  3.12it/s]                                               {'train_runtime': 14.4407, 'train_samples_per_second': 39.126, 'train_steps_per_second': 2.77, 'train_loss': 2.913887619972229, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  3.12it/s]100%|██████████| 40/40 [00:14<00:00,  2.77it/s]
CLIENT:64
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.36it/s]                                              {'loss': 2.9919, 'grad_norm': 0.5612483620643616, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.36it/s]  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]                                              {'loss': 3.037, 'grad_norm': 0.2189142256975174, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]  8%|▊         | 3/40 [00:01<00:16,  2.24it/s]                                              {'loss': 3.0639, 'grad_norm': 0.3300831913948059, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.24it/s] 10%|█         | 4/40 [00:01<00:16,  2.25it/s]                                              {'loss': 3.1289, 'grad_norm': 0.809520959854126, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.25it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s]                                              {'loss': 3.0128, 'grad_norm': 0.7199913263320923, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.27it/s]                                              {'loss': 2.9223, 'grad_norm': 0.20343776047229767, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.27it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.9282, 'grad_norm': 0.23785898089408875, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s] 20%|██        | 8/40 [00:03<00:10,  2.92it/s]                                              {'loss': 2.9052, 'grad_norm': 1.0268518924713135, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.92it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s]                                              {'loss': 2.9265, 'grad_norm': 0.2785123884677887, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s]                                               {'loss': 2.9807, 'grad_norm': 0.30165281891822815, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s]                                               {'loss': 2.9401, 'grad_norm': 0.369758665561676, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s] 30%|███       | 12/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.9832, 'grad_norm': 0.25057360529899597, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.8958, 'grad_norm': 0.34252727031707764, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.24it/s]                                               {'loss': 2.9885, 'grad_norm': 0.32310569286346436, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s]                                               {'loss': 3.1448, 'grad_norm': 0.5969732403755188, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s] 40%|████      | 16/40 [00:06<00:08,  2.84it/s]                                               {'loss': 3.3001, 'grad_norm': 1.2571576833724976, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.84it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s]                                               {'loss': 3.0149, 'grad_norm': 0.5045943856239319, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.54it/s]                                               {'loss': 2.8901, 'grad_norm': 0.43449944257736206, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.54it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s]                                               {'loss': 3.0128, 'grad_norm': 0.7441710233688354, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s] 50%|█████     | 20/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.89, 'grad_norm': 0.5683062672615051, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.37it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.8594, 'grad_norm': 0.5205716490745544, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.9876, 'grad_norm': 0.5583260655403137, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s]                                               {'loss': 3.0413, 'grad_norm': 0.8791359663009644, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s] 60%|██████    | 24/40 [00:09<00:05,  2.86it/s]                                               {'loss': 3.2306, 'grad_norm': 2.2795066833496094, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.86it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s]                                               {'loss': 2.7901, 'grad_norm': 0.6672758460044861, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.49it/s]                                               {'loss': 3.0434, 'grad_norm': 1.2037652730941772, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.49it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s]                                               {'loss': 2.8708, 'grad_norm': 1.0134168863296509, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.8571, 'grad_norm': 0.8515058159828186, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s]                                               {'loss': 2.9122, 'grad_norm': 1.1893310546875, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.26it/s]                                               {'loss': 2.9531, 'grad_norm': 0.8795859813690186, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.26it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.30it/s]                                               {'loss': 2.935, 'grad_norm': 1.0294321775436401, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.30it/s] 80%|████████  | 32/40 [00:13<00:02,  2.91it/s]                                               {'loss': 2.8306, 'grad_norm': 3.261775493621826, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.91it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.8235, 'grad_norm': 0.9550546407699585, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.48it/s]                                               {'loss': 2.9565, 'grad_norm': 1.2150555849075317, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.48it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.39it/s]                                               {'loss': 2.8149, 'grad_norm': 1.319257140159607, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.39it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.28it/s]                                               {'loss': 2.9036, 'grad_norm': 1.1863046884536743, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.28it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s]                                               {'loss': 2.8988, 'grad_norm': 1.0138472318649292, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.19it/s]                                               {'loss': 2.964, 'grad_norm': 1.4023147821426392, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.19it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.18it/s]                                               {'loss': 2.8547, 'grad_norm': 1.0503829717636108, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.18it/s]100%|██████████| 40/40 [00:16<00:00,  2.83it/s]                                               {'loss': 2.8051, 'grad_norm': 5.173297882080078, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.83it/s]                                               {'train_runtime': 16.5839, 'train_samples_per_second': 34.069, 'train_steps_per_second': 2.412, 'train_loss': 2.9572435855865478, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.83it/s]100%|██████████| 40/40 [00:16<00:00,  2.41it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.39it/s]                                              {'loss': 3.1387, 'grad_norm': 0.44916239380836487, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.39it/s]  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.8948, 'grad_norm': 0.1981324553489685, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 3.1949, 'grad_norm': 1.0178242921829224, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:15,  2.34it/s]                                              {'loss': 3.1897, 'grad_norm': 0.9736137390136719, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.34it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.9511, 'grad_norm': 0.25533193349838257, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.25it/s]                                              {'loss': 3.01, 'grad_norm': 0.24489298462867737, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.25it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.9757, 'grad_norm': 0.3076704442501068, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s] 20%|██        | 8/40 [00:03<00:11,  2.87it/s]                                              {'loss': 2.975, 'grad_norm': 1.1024062633514404, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.87it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.62it/s]                                              {'loss': 2.9273, 'grad_norm': 0.32917946577072144, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.62it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.981, 'grad_norm': 0.26608389616012573, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s]                                               {'loss': 3.0872, 'grad_norm': 0.4763772785663605, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s] 30%|███       | 12/40 [00:05<00:11,  2.35it/s]                                               {'loss': 3.0092, 'grad_norm': 0.2979654371738434, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.35it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 3.0183, 'grad_norm': 0.3870457410812378, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s]                                               {'loss': 3.0084, 'grad_norm': 0.44478774070739746, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.8607, 'grad_norm': 0.6843103766441345, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s] 40%|████      | 16/40 [00:06<00:08,  2.87it/s]                                               {'loss': 3.2281, 'grad_norm': 1.857927680015564, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.87it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.63it/s]                                               {'loss': 2.9154, 'grad_norm': 0.6875430941581726, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.63it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.9271, 'grad_norm': 0.4599688947200775, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.36it/s]                                               {'loss': 3.0556, 'grad_norm': 0.6823219060897827, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.36it/s] 50%|█████     | 20/40 [00:08<00:08,  2.31it/s]                                               {'loss': 2.8556, 'grad_norm': 0.6725741028785706, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.31it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.24it/s]                                               {'loss': 3.0035, 'grad_norm': 0.6199457049369812, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.24it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.24it/s]                                               {'loss': 3.0246, 'grad_norm': 0.9044331908226013, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.24it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.24it/s]                                               {'loss': 2.9439, 'grad_norm': 0.864274799823761, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.24it/s] 60%|██████    | 24/40 [00:09<00:05,  2.88it/s]                                               {'loss': 2.9156, 'grad_norm': 3.0613701343536377, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s]                                               {'loss': 2.865, 'grad_norm': 0.8805822134017944, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.59it/s]                                               {'loss': 2.8889, 'grad_norm': 0.9434566497802734, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.59it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s]                                               {'loss': 2.9989, 'grad_norm': 1.2960814237594604, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s] 70%|███████   | 28/40 [00:11<00:05,  2.38it/s]                                               {'loss': 2.9408, 'grad_norm': 1.0818288326263428, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.38it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s]                                               {'loss': 3.029, 'grad_norm': 0.8647170066833496, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.8544, 'grad_norm': 0.9892814755439758, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s]                                               {'loss': 2.976, 'grad_norm': 0.9194604754447937, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s] 80%|████████  | 32/40 [00:13<00:02,  2.89it/s]                                               {'loss': 2.693, 'grad_norm': 4.412533760070801, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.89it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.80it/s]                                               {'loss': 2.9843, 'grad_norm': 1.2112568616867065, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.80it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.82it/s]                                               {'loss': 2.9001, 'grad_norm': 1.0105184316635132, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.82it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.72it/s]                                               {'loss': 2.839, 'grad_norm': 1.1677812337875366, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.72it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.70it/s]                                               {'loss': 2.8259, 'grad_norm': 1.267957329750061, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.70it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.68it/s]                                               {'loss': 2.9349, 'grad_norm': 1.048820972442627, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.68it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.64it/s]                                               {'loss': 2.9055, 'grad_norm': 1.372458577156067, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.64it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.67it/s]                                               {'loss': 2.8043, 'grad_norm': 1.559502124786377, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.67it/s]                                               {'loss': 3.3072, 'grad_norm': 4.511618137359619, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.67it/s]                                               {'train_runtime': 15.9569, 'train_samples_per_second': 35.408, 'train_steps_per_second': 2.507, 'train_loss': 2.9709616124629976, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.67it/s]100%|██████████| 40/40 [00:15<00:00,  2.51it/s]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:09,  4.25it/s]                                              {'loss': 2.831, 'grad_norm': 1.6931707859039307, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:09,  4.25it/s]  5%|▌         | 2/40 [00:00<00:09,  3.95it/s]                                              {'loss': 2.9656, 'grad_norm': 0.20635953545570374, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:09,  3.95it/s]  8%|▊         | 3/40 [00:00<00:10,  3.62it/s]                                              {'loss': 3.0025, 'grad_norm': 0.581813633441925, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:10,  3.62it/s] 10%|█         | 4/40 [00:01<00:10,  3.53it/s]                                              {'loss': 3.0441, 'grad_norm': 0.8246236443519592, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:10,  3.53it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.47it/s]                                              {'loss': 3.0027, 'grad_norm': 0.4835444390773773, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:10,  3.47it/s] 15%|█▌        | 6/40 [00:01<00:09,  3.45it/s]                                              {'loss': 2.8687, 'grad_norm': 0.26150500774383545, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:09,  3.45it/s] 18%|█▊        | 7/40 [00:02<00:10,  3.28it/s]                                              {'loss': 3.036, 'grad_norm': 0.4118778109550476, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:10,  3.28it/s] 20%|██        | 8/40 [00:02<00:07,  4.07it/s]                                              {'loss': 2.9994, 'grad_norm': 1.287562608718872, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:07,  4.07it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.53it/s]                                              {'loss': 2.8402, 'grad_norm': 0.43364667892456055, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.53it/s] 25%|██▌       | 10/40 [00:02<00:09,  3.24it/s]                                               {'loss': 3.0872, 'grad_norm': 0.5738416910171509, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:02<00:09,  3.24it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.07it/s]                                               {'loss': 2.7729, 'grad_norm': 0.5229313373565674, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.07it/s] 30%|███       | 12/40 [00:03<00:09,  2.96it/s]                                               {'loss': 3.0052, 'grad_norm': 0.3362677991390228, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:09,  2.96it/s] 32%|███▎      | 13/40 [00:03<00:09,  2.91it/s]                                               {'loss': 2.9517, 'grad_norm': 0.5315867066383362, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:03<00:09,  2.91it/s] 35%|███▌      | 14/40 [00:04<00:09,  2.88it/s]                                               {'loss': 2.9639, 'grad_norm': 0.5649843215942383, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:09,  2.88it/s] 38%|███▊      | 15/40 [00:04<00:08,  2.84it/s]                                               {'loss': 3.0189, 'grad_norm': 0.5403943657875061, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:04<00:08,  2.84it/s] 40%|████      | 16/40 [00:04<00:06,  3.58it/s]                                               {'loss': 2.5457, 'grad_norm': 2.8112237453460693, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:04<00:06,  3.58it/s] 42%|████▎     | 17/40 [00:05<00:07,  3.06it/s]                                               {'loss': 2.9435, 'grad_norm': 0.7256501913070679, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:07,  3.06it/s] 45%|████▌     | 18/40 [00:05<00:08,  2.68it/s]                                               {'loss': 2.934, 'grad_norm': 0.7174895405769348, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:08,  2.68it/s] 48%|████▊     | 19/40 [00:06<00:08,  2.52it/s]                                               {'loss': 2.841, 'grad_norm': 0.7610719203948975, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:08,  2.52it/s] 50%|█████     | 20/40 [00:06<00:08,  2.37it/s]                                               {'loss': 2.9182, 'grad_norm': 1.467756986618042, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:08,  2.37it/s] 52%|█████▎    | 21/40 [00:07<00:08,  2.30it/s]                                               {'loss': 2.8128, 'grad_norm': 0.698401927947998, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:08,  2.30it/s] 55%|█████▌    | 22/40 [00:07<00:08,  2.24it/s]                                               {'loss': 2.8974, 'grad_norm': 0.8579038977622986, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:08,  2.24it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.19it/s]                                               {'loss': 2.9999, 'grad_norm': 0.9715490341186523, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.19it/s] 60%|██████    | 24/40 [00:08<00:05,  2.84it/s]                                               {'loss': 2.7454, 'grad_norm': 3.624241590499878, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.84it/s] 62%|██████▎   | 25/40 [00:08<00:05,  2.64it/s]                                               {'loss': 2.9564, 'grad_norm': 0.8818599581718445, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.51it/s]                                               {'loss': 2.8462, 'grad_norm': 1.2518035173416138, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:09<00:05,  2.48it/s]                                               {'loss': 2.9487, 'grad_norm': 1.179725170135498, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:05,  2.48it/s] 70%|███████   | 28/40 [00:09<00:05,  2.39it/s]                                               {'loss': 2.804, 'grad_norm': 1.3273788690567017, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:09<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.32it/s]                                               {'loss': 2.7963, 'grad_norm': 1.4088635444641113, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:10<00:04,  2.29it/s]                                               {'loss': 2.8924, 'grad_norm': 1.252981185913086, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:10<00:04,  2.29it/s] 78%|███████▊  | 31/40 [00:11<00:04,  2.23it/s]                                               {'loss': 2.7635, 'grad_norm': 1.7286964654922485, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:04,  2.23it/s] 80%|████████  | 32/40 [00:11<00:02,  2.80it/s]                                               {'loss': 3.3548, 'grad_norm': 5.425832748413086, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:11<00:02,  2.65it/s]                                               {'loss': 2.7702, 'grad_norm': 1.489228367805481, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:11<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.45it/s]                                               {'loss': 2.7853, 'grad_norm': 1.4964814186096191, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.45it/s] 88%|████████▊ | 35/40 [00:12<00:02,  2.37it/s]                                               {'loss': 2.8757, 'grad_norm': 1.4143314361572266, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:12<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.48it/s]                                               {'loss': 2.8245, 'grad_norm': 1.6040095090866089, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.48it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.55it/s]                                               {'loss': 2.9116, 'grad_norm': 1.4336882829666138, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.55it/s] 95%|█████████▌| 38/40 [00:13<00:00,  2.49it/s]                                               {'loss': 2.7413, 'grad_norm': 1.2713154554367065, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:00,  2.49it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.37it/s]                                               {'loss': 2.8686, 'grad_norm': 1.4280164241790771, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.37it/s]100%|██████████| 40/40 [00:14<00:00,  2.99it/s]                                               {'loss': 2.7077, 'grad_norm': 6.107556343078613, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.99it/s]                                               {'train_runtime': 14.6691, 'train_samples_per_second': 38.516, 'train_steps_per_second': 2.727, 'train_loss': 2.8968772888183594, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.99it/s]100%|██████████| 40/40 [00:14<00:00,  2.73it/s]
CLIENT:6
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.41it/s]                                              {'loss': 2.8862, 'grad_norm': 0.9961612820625305, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.41it/s]  5%|▌         | 2/40 [00:00<00:15,  2.41it/s]                                              {'loss': 3.0708, 'grad_norm': 0.2899446189403534, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:15,  2.41it/s]  8%|▊         | 3/40 [00:01<00:14,  2.52it/s]                                              {'loss': 3.115, 'grad_norm': 0.9905476570129395, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:14,  2.52it/s] 10%|█         | 4/40 [00:01<00:13,  2.58it/s]                                              {'loss': 3.4391, 'grad_norm': 1.4334547519683838, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.58it/s] 12%|█▎        | 5/40 [00:01<00:13,  2.57it/s]                                              {'loss': 2.999, 'grad_norm': 0.7050442099571228, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:13,  2.57it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.66it/s]                                              {'loss': 3.0046, 'grad_norm': 0.37982621788978577, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.66it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.64it/s]                                              {'loss': 2.8969, 'grad_norm': 0.5096700191497803, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.64it/s] 20%|██        | 8/40 [00:02<00:09,  3.38it/s]                                              {'loss': 3.033, 'grad_norm': 0.7421573996543884, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.38it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.88it/s]                                              {'loss': 2.9768, 'grad_norm': 0.1949469894170761, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.88it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.65it/s]                                               {'loss': 3.0546, 'grad_norm': 0.1761004775762558, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.65it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s]                                               {'loss': 3.1744, 'grad_norm': 0.5903979539871216, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s] 30%|███       | 12/40 [00:04<00:11,  2.38it/s]                                               {'loss': 2.9695, 'grad_norm': 0.20600925385951996, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.38it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s]                                               {'loss': 2.9569, 'grad_norm': 0.18653665482997894, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.24it/s]                                               {'loss': 2.9919, 'grad_norm': 0.18183977901935577, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.9521, 'grad_norm': 0.4596077501773834, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s] 40%|████      | 16/40 [00:06<00:08,  2.88it/s]                                               {'loss': 3.1773, 'grad_norm': 0.7080716490745544, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.88it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.64it/s]                                               {'loss': 2.9433, 'grad_norm': 0.2359868884086609, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 3.1071, 'grad_norm': 0.21972684562206268, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s]                                               {'loss': 2.9704, 'grad_norm': 0.3872874975204468, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s] 50%|█████     | 20/40 [00:07<00:08,  2.34it/s]                                               {'loss': 3.0497, 'grad_norm': 0.26025643944740295, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.34it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.29it/s]                                               {'loss': 3.0213, 'grad_norm': 0.3554397523403168, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.29it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.25it/s]                                               {'loss': 3.0191, 'grad_norm': 0.24224701523780823, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.25it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.9835, 'grad_norm': 0.3453647792339325, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s] 60%|██████    | 24/40 [00:09<00:05,  2.86it/s]                                               {'loss': 2.8717, 'grad_norm': 0.6742363572120667, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.86it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.62it/s]                                               {'loss': 2.9112, 'grad_norm': 0.22144214808940887, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s]                                               {'loss': 2.9522, 'grad_norm': 0.3832060396671295, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.48it/s]                                               {'loss': 3.0045, 'grad_norm': 0.3458612561225891, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.48it/s] 70%|███████   | 28/40 [00:11<00:05,  2.38it/s]                                               {'loss': 3.0245, 'grad_norm': 0.2624881863594055, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.38it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.34it/s]                                               {'loss': 2.979, 'grad_norm': 0.2675677537918091, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.34it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.9942, 'grad_norm': 0.28706711530685425, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s]                                               {'loss': 2.9952, 'grad_norm': 0.2890867292881012, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s] 80%|████████  | 32/40 [00:12<00:02,  2.84it/s]                                               {'loss': 3.3004, 'grad_norm': 0.8716707229614258, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.84it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s]                                               {'loss': 3.0357, 'grad_norm': 0.3512730598449707, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s]                                               {'loss': 3.1132, 'grad_norm': 0.3954525291919708, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s]                                               {'loss': 2.8787, 'grad_norm': 0.2627742886543274, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.26it/s]                                               {'loss': 2.9561, 'grad_norm': 0.4426915943622589, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.26it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s]                                               {'loss': 2.9113, 'grad_norm': 0.21806512773036957, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.18it/s]                                               {'loss': 2.8814, 'grad_norm': 0.4276476800441742, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.18it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.17it/s]                                               {'loss': 3.0143, 'grad_norm': 0.36534935235977173, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.17it/s]                                               {'loss': 3.27, 'grad_norm': 0.9141706228256226, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.17it/s]                                               {'train_runtime': 16.2048, 'train_samples_per_second': 34.866, 'train_steps_per_second': 2.468, 'train_loss': 3.022150492668152, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.17it/s]100%|██████████| 40/40 [00:16<00:00,  2.47it/s]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]                                              {'loss': 3.1316, 'grad_norm': 0.976446270942688, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 3.1453, 'grad_norm': 0.2798145115375519, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:16,  2.21it/s]                                              {'loss': 3.0639, 'grad_norm': 0.6928958296775818, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.21it/s] 10%|█         | 4/40 [00:01<00:16,  2.16it/s]                                              {'loss': 3.0646, 'grad_norm': 0.4031885862350464, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.16it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s]                                              {'loss': 3.0609, 'grad_norm': 0.27464979887008667, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.32it/s]                                              {'loss': 3.0411, 'grad_norm': 0.20887409150600433, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.32it/s] 18%|█▊        | 7/40 [00:03<00:13,  2.37it/s]                                              {'loss': 3.0039, 'grad_norm': 0.32390695810317993, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:13,  2.37it/s]                                              {'loss': 2.9747, 'grad_norm': 0.9405322670936584, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:13,  2.37it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.06it/s]                                              {'loss': 3.1398, 'grad_norm': 0.3332383334636688, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.06it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.91it/s]                                               {'loss': 3.1089, 'grad_norm': 0.30883997678756714, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.91it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.88it/s]                                               {'loss': 3.0608, 'grad_norm': 0.4821825623512268, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.88it/s] 30%|███       | 12/40 [00:04<00:10,  2.76it/s]                                               {'loss': 2.911, 'grad_norm': 0.36683979630470276, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.76it/s] 32%|███▎      | 13/40 [00:05<00:09,  2.72it/s]                                               {'loss': 3.052, 'grad_norm': 0.3532184660434723, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:09,  2.72it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.73it/s]                                               {'loss': 2.9921, 'grad_norm': 0.2638944983482361, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.73it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.66it/s]                                               {'loss': 2.9833, 'grad_norm': 0.37251153588294983, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.66it/s] 40%|████      | 16/40 [00:05<00:07,  3.31it/s]                                               {'loss': 3.4338, 'grad_norm': 1.1639704704284668, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.31it/s] 42%|████▎     | 17/40 [00:06<00:07,  2.97it/s]                                               {'loss': 3.0757, 'grad_norm': 0.5715425610542297, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  2.97it/s] 45%|████▌     | 18/40 [00:06<00:07,  2.90it/s]                                               {'loss': 3.0408, 'grad_norm': 0.43775808811187744, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:07,  2.90it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.87it/s]                                               {'loss': 3.0045, 'grad_norm': 0.5705893039703369, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.87it/s] 50%|█████     | 20/40 [00:07<00:06,  2.88it/s]                                               {'loss': 2.9212, 'grad_norm': 0.5093135833740234, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  2.88it/s] 52%|█████▎    | 21/40 [00:07<00:06,  2.88it/s]                                               {'loss': 3.0227, 'grad_norm': 0.6294769644737244, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  2.88it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.84it/s]                                               {'loss': 3.0487, 'grad_norm': 0.6720888614654541, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.84it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.80it/s]                                               {'loss': 2.9149, 'grad_norm': 0.8240427374839783, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.80it/s] 60%|██████    | 24/40 [00:08<00:04,  3.54it/s]                                               {'loss': 2.8644, 'grad_norm': 1.6219919919967651, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:04,  3.54it/s] 62%|██████▎   | 25/40 [00:08<00:04,  3.32it/s]                                               {'loss': 2.9071, 'grad_norm': 0.6497396230697632, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:04,  3.32it/s] 65%|██████▌   | 26/40 [00:09<00:04,  3.18it/s]                                               {'loss': 2.9589, 'grad_norm': 0.84853196144104, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  3.18it/s] 68%|██████▊   | 27/40 [00:09<00:04,  3.10it/s]                                               {'loss': 2.9808, 'grad_norm': 0.8008866906166077, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  3.10it/s] 70%|███████   | 28/40 [00:09<00:03,  3.03it/s]                                               {'loss': 3.0162, 'grad_norm': 0.8216899037361145, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:09<00:03,  3.03it/s] 72%|███████▎  | 29/40 [00:10<00:03,  2.93it/s]                                               {'loss': 2.9525, 'grad_norm': 0.8547723293304443, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:03,  2.93it/s] 75%|███████▌  | 30/40 [00:10<00:03,  2.86it/s]                                               {'loss': 2.9998, 'grad_norm': 1.0213346481323242, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:10<00:03,  2.86it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.81it/s]                                               {'loss': 2.9257, 'grad_norm': 0.9286801815032959, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.81it/s]                                               {'loss': 2.8516, 'grad_norm': 3.225109815597534, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.81it/s] 82%|████████▎ | 33/40 [00:11<00:02,  3.40it/s]                                               {'loss': 2.9282, 'grad_norm': 0.8608092665672302, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:11<00:02,  3.40it/s] 85%|████████▌ | 34/40 [00:11<00:01,  3.23it/s]                                               {'loss': 2.9062, 'grad_norm': 0.8696408271789551, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:11<00:01,  3.23it/s] 88%|████████▊ | 35/40 [00:12<00:01,  2.91it/s]                                               {'loss': 2.9213, 'grad_norm': 0.791102409362793, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:12<00:01,  2.91it/s] 90%|█████████ | 36/40 [00:12<00:01,  2.65it/s]                                               {'loss': 2.8318, 'grad_norm': 1.0948271751403809, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:12<00:01,  2.65it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.53it/s]                                               {'loss': 2.968, 'grad_norm': 1.0467609167099, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.53it/s] 95%|█████████▌| 38/40 [00:13<00:00,  2.39it/s]                                               {'loss': 2.8833, 'grad_norm': 1.1468913555145264, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:00,  2.39it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.34it/s]                                               {'loss': 2.9645, 'grad_norm': 1.2646056413650513, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.34it/s]100%|██████████| 40/40 [00:14<00:00,  2.99it/s]                                               {'loss': 3.0238, 'grad_norm': 5.09022855758667, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.99it/s]                                               {'train_runtime': 14.382, 'train_samples_per_second': 39.285, 'train_steps_per_second': 2.781, 'train_loss': 3.0020126581192015, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.99it/s]100%|██████████| 40/40 [00:14<00:00,  2.78it/s]
CLIENT:43
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]                                              {'loss': 2.8431, 'grad_norm': 0.6526174545288086, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.47it/s]  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]                                              {'loss': 2.9942, 'grad_norm': 0.22393886744976044, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.43it/s]  8%|▊         | 3/40 [00:01<00:21,  1.71it/s]                                              {'loss': 3.1221, 'grad_norm': 0.8315524458885193, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:21,  1.71it/s] 10%|█         | 4/40 [00:02<00:19,  1.88it/s]                                              {'loss': 3.0472, 'grad_norm': 0.502013087272644, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.88it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.01it/s]                                              {'loss': 3.0579, 'grad_norm': 0.4330257177352905, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.01it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.08it/s]                                              {'loss': 2.9279, 'grad_norm': 0.368319034576416, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.08it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s]                                              {'loss': 3.0227, 'grad_norm': 0.32686179876327515, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s] 20%|██        | 8/40 [00:04<00:14,  2.16it/s]                                              {'loss': 3.0389, 'grad_norm': 0.7852838039398193, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.16it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.13it/s]                                              {'loss': 3.0153, 'grad_norm': 0.7262827157974243, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.13it/s] 25%|██▌       | 10/40 [00:05<00:13,  2.15it/s]                                               {'loss': 3.0981, 'grad_norm': 0.31087765097618103, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:13,  2.15it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.15it/s]                                               {'loss': 2.9972, 'grad_norm': 0.46074122190475464, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.15it/s] 30%|███       | 12/40 [00:05<00:12,  2.15it/s]                                               {'loss': 2.9233, 'grad_norm': 0.3258276581764221, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.15it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.17it/s]                                               {'loss': 3.0308, 'grad_norm': 0.4310881197452545, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.17it/s] 35%|███▌      | 14/40 [00:06<00:12,  2.14it/s]                                               {'loss': 2.877, 'grad_norm': 0.6215518116950989, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:12,  2.14it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s]                                               {'loss': 3.0057, 'grad_norm': 0.6403385996818542, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s]                                               {'loss': 2.8747, 'grad_norm': 0.9346585273742676, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:11,  2.18it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.71it/s]                                               {'loss': 2.8954, 'grad_norm': 0.5454994440078735, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.71it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.62it/s]                                               {'loss': 2.8753, 'grad_norm': 0.5188317894935608, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.62it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.49it/s]                                               {'loss': 2.9329, 'grad_norm': 0.5534244775772095, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.49it/s] 50%|█████     | 20/40 [00:09<00:08,  2.39it/s]                                               {'loss': 3.0001, 'grad_norm': 0.5931110382080078, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.34it/s]                                               {'loss': 2.8291, 'grad_norm': 0.611531674861908, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.34it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.27it/s]                                               {'loss': 3.0127, 'grad_norm': 0.5321362614631653, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.27it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s]                                               {'loss': 3.0042, 'grad_norm': 0.6104576587677002, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s]                                               {'loss': 3.3481, 'grad_norm': 1.9146044254302979, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:07,  2.27it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.81it/s]                                               {'loss': 2.7787, 'grad_norm': 0.7132354974746704, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.81it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.67it/s]                                               {'loss': 2.8522, 'grad_norm': 1.225160837173462, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.67it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.55it/s]                                               {'loss': 3.0215, 'grad_norm': 1.2892953157424927, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.55it/s] 70%|███████   | 28/40 [00:12<00:04,  2.42it/s]                                               {'loss': 2.9401, 'grad_norm': 0.9344416856765747, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:04,  2.42it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.38it/s]                                               {'loss': 2.8709, 'grad_norm': 1.071108102798462, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.38it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.30it/s]                                               {'loss': 2.8627, 'grad_norm': 0.9559594988822937, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s]                                               {'loss': 2.9852, 'grad_norm': 1.2201406955718994, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s]                                               {'loss': 2.7683, 'grad_norm': 4.211770534515381, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.27it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.73it/s]                                               {'loss': 2.9593, 'grad_norm': 1.1473740339279175, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.73it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.61it/s]                                               {'loss': 2.9037, 'grad_norm': 1.2432459592819214, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.61it/s] 88%|████████▊ | 35/40 [00:15<00:01,  2.54it/s]                                               {'loss': 2.8662, 'grad_norm': 1.3915101289749146, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:01,  2.54it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.42it/s]                                               {'loss': 2.9104, 'grad_norm': 1.2282456159591675, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.42it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.40it/s]                                               {'loss': 2.8378, 'grad_norm': 1.4038033485412598, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.40it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.33it/s]                                               {'loss': 2.8622, 'grad_norm': 1.228158950805664, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.33it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.29it/s]                                               {'loss': 2.807, 'grad_norm': 1.9390575885772705, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.29it/s]100%|██████████| 40/40 [00:17<00:00,  2.85it/s]                                               {'loss': 2.6508, 'grad_norm': 5.014106273651123, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.85it/s]                                               {'train_runtime': 17.2556, 'train_samples_per_second': 32.743, 'train_steps_per_second': 2.318, 'train_loss': 2.9412752747535706, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.85it/s]100%|██████████| 40/40 [00:17<00:00,  2.32it/s]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]                                              {'loss': 3.1243, 'grad_norm': 0.7628204226493835, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]  5%|▌         | 2/40 [00:00<00:16,  2.30it/s]                                              {'loss': 2.9343, 'grad_norm': 0.23354028165340424, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.30it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.9769, 'grad_norm': 0.32666176557540894, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:16,  2.23it/s]                                              {'loss': 3.0354, 'grad_norm': 0.546876072883606, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.23it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s]                                              {'loss': 2.974, 'grad_norm': 0.44480398297309875, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s]                                              {'loss': 3.0444, 'grad_norm': 0.26778945326805115, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.26it/s]                                              {'loss': 3.1038, 'grad_norm': 0.8460963368415833, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.26it/s] 20%|██        | 8/40 [00:03<00:10,  2.91it/s]                                              {'loss': 2.8264, 'grad_norm': 1.2123595476150513, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.91it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s]                                              {'loss': 3.1283, 'grad_norm': 0.2618260681629181, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s]                                               {'loss': 2.9879, 'grad_norm': 0.24405032396316528, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.35it/s]                                               {'loss': 2.9176, 'grad_norm': 0.3325774073600769, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.35it/s] 30%|███       | 12/40 [00:05<00:12,  2.29it/s]                                               {'loss': 2.9417, 'grad_norm': 0.19977323710918427, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.29it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s]                                               {'loss': 3.137, 'grad_norm': 0.3323376178741455, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.9984, 'grad_norm': 0.2229902446269989, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.9862, 'grad_norm': 0.6888543367385864, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.4786, 'grad_norm': 1.250740647315979, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:10,  2.21it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.74it/s]                                               {'loss': 3.029, 'grad_norm': 0.4262462556362152, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.74it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.9083, 'grad_norm': 0.26627808809280396, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.58it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.48it/s]                                               {'loss': 2.9594, 'grad_norm': 0.5732490420341492, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.48it/s] 50%|█████     | 20/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.9899, 'grad_norm': 0.48129743337631226, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.37it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.8523, 'grad_norm': 0.5695803761482239, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s]                                               {'loss': 3.0914, 'grad_norm': 0.5394810438156128, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s]                                               {'loss': 3.0647, 'grad_norm': 1.0957913398742676, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s] 60%|██████    | 24/40 [00:09<00:05,  2.88it/s]                                               {'loss': 3.1049, 'grad_norm': 2.1790761947631836, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s]                                               {'loss': 2.9562, 'grad_norm': 0.7129829525947571, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.50it/s]                                               {'loss': 2.9872, 'grad_norm': 1.0251842737197876, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.50it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.43it/s]                                               {'loss': 2.8159, 'grad_norm': 1.110683798789978, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.43it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 3.0848, 'grad_norm': 1.1257505416870117, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s]                                               {'loss': 2.9613, 'grad_norm': 0.9681624174118042, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.8978, 'grad_norm': 1.2538870573043823, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s]                                               {'loss': 2.8649, 'grad_norm': 1.85002601146698, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s] 80%|████████  | 32/40 [00:13<00:02,  2.83it/s]                                               {'loss': 3.0064, 'grad_norm': 3.7278332710266113, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.83it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.70it/s]                                               {'loss': 2.9091, 'grad_norm': 1.102588415145874, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.70it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.69it/s]                                               {'loss': 2.8502, 'grad_norm': 1.2152366638183594, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.69it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.66it/s]                                               {'loss': 2.8865, 'grad_norm': 1.3543996810913086, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.66it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.64it/s]                                               {'loss': 2.8302, 'grad_norm': 1.4263094663619995, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.64it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.65it/s]                                               {'loss': 2.8863, 'grad_norm': 1.1102278232574463, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.65it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.66it/s]                                               {'loss': 3.0509, 'grad_norm': 1.535076379776001, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.66it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.66it/s]                                               {'loss': 2.9167, 'grad_norm': 1.5227885246276855, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.66it/s]                                               {'loss': 3.1358, 'grad_norm': 5.941843032836914, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.66it/s]                                               {'train_runtime': 16.0193, 'train_samples_per_second': 35.27, 'train_steps_per_second': 2.497, 'train_loss': 2.965889585018158, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.66it/s]100%|██████████| 40/40 [00:16<00:00,  2.50it/s]
CLIENT:7
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]                                              {'loss': 3.0047, 'grad_norm': 0.8336350917816162, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:12,  3.03it/s]  5%|▌         | 2/40 [00:00<00:12,  2.93it/s]                                              {'loss': 3.1176, 'grad_norm': 0.2572758197784424, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:12,  2.93it/s]  8%|▊         | 3/40 [00:01<00:12,  2.88it/s]                                              {'loss': 3.0052, 'grad_norm': 0.340672105550766, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.88it/s] 10%|█         | 4/40 [00:01<00:12,  2.82it/s]                                              {'loss': 3.0727, 'grad_norm': 0.3932470381259918, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.82it/s] 12%|█▎        | 5/40 [00:01<00:13,  2.58it/s]                                              {'loss': 3.0732, 'grad_norm': 0.44891807436943054, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:13,  2.58it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.41it/s]                                              {'loss': 2.8896, 'grad_norm': 0.28051257133483887, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.41it/s] 18%|█▊        | 7/40 [00:02<00:13,  2.36it/s]                                              {'loss': 3.0905, 'grad_norm': 0.3384544849395752, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:13,  2.36it/s] 20%|██        | 8/40 [00:02<00:10,  3.07it/s]                                              {'loss': 3.0081, 'grad_norm': 0.8486438989639282, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.07it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.79it/s]                                              {'loss': 2.9449, 'grad_norm': 0.36406880617141724, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.79it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.69it/s]                                               {'loss': 2.979, 'grad_norm': 0.3133685886859894, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.69it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.51it/s]                                               {'loss': 2.9573, 'grad_norm': 0.4840157926082611, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.51it/s] 30%|███       | 12/40 [00:04<00:11,  2.42it/s]                                               {'loss': 2.9389, 'grad_norm': 0.3463316559791565, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.42it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.9426, 'grad_norm': 0.30141139030456543, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.29it/s]                                               {'loss': 2.9484, 'grad_norm': 0.3525933623313904, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.29it/s] 38%|███▊      | 15/40 [00:05<00:10,  2.29it/s]                                               {'loss': 3.1487, 'grad_norm': 0.8211418390274048, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:10,  2.29it/s] 40%|████      | 16/40 [00:06<00:08,  2.91it/s]                                               {'loss': 2.821, 'grad_norm': 1.4304864406585693, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.91it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.62it/s]                                               {'loss': 2.9494, 'grad_norm': 0.8987667560577393, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.62it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.53it/s]                                               {'loss': 2.9139, 'grad_norm': 0.5742838978767395, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.53it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.40it/s]                                               {'loss': 2.9848, 'grad_norm': 0.6814207434654236, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.40it/s] 50%|█████     | 20/40 [00:07<00:08,  2.34it/s]                                               {'loss': 2.9365, 'grad_norm': 0.723889172077179, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.34it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.9351, 'grad_norm': 0.7186841368675232, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.26it/s]                                               {'loss': 2.8864, 'grad_norm': 0.871954619884491, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.26it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.785, 'grad_norm': 1.0345885753631592, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s] 60%|██████    | 24/40 [00:09<00:05,  2.88it/s]                                               {'loss': 2.7021, 'grad_norm': 4.04282283782959, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.59it/s]                                               {'loss': 2.8613, 'grad_norm': 0.8597940802574158, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.43it/s]                                               {'loss': 2.8302, 'grad_norm': 1.2098791599273682, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.43it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.36it/s]                                               {'loss': 3.0138, 'grad_norm': 1.150580883026123, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.36it/s] 70%|███████   | 28/40 [00:11<00:05,  2.27it/s]                                               {'loss': 3.1697, 'grad_norm': 1.1617337465286255, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.27it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.26it/s]                                               {'loss': 2.7025, 'grad_norm': 1.470109224319458, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.26it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s]                                               {'loss': 2.6966, 'grad_norm': 1.84351646900177, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.7662, 'grad_norm': 1.4425299167633057, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s]                                               {'loss': 3.2962, 'grad_norm': 8.442469596862793, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:03,  2.24it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.75it/s]                                               {'loss': 2.882, 'grad_norm': 1.3983805179595947, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.75it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.60it/s]                                               {'loss': 2.798, 'grad_norm': 1.5434399843215942, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.60it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.50it/s]                                               {'loss': 2.8051, 'grad_norm': 2.0140740871429443, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.50it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s]                                               {'loss': 2.7632, 'grad_norm': 1.6896461248397827, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.8172, 'grad_norm': 1.7155680656433105, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.36it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s]                                               {'loss': 2.9324, 'grad_norm': 1.5403403043746948, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.30it/s]                                               {'loss': 2.7351, 'grad_norm': 1.6189473867416382, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.30it/s]100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'loss': 2.7226, 'grad_norm': 6.136978626251221, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'train_runtime': 16.0746, 'train_samples_per_second': 35.149, 'train_steps_per_second': 2.488, 'train_loss': 2.9206875205039977, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]100%|██████████| 40/40 [00:16<00:00,  2.49it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.25it/s]                                              {'loss': 2.901, 'grad_norm': 1.3397811651229858, 'learning_rate': 0.0003, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.25it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 3.1283, 'grad_norm': 0.2792181074619293, 'learning_rate': 0.00029249999999999995, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:16,  2.21it/s]                                              {'loss': 3.042, 'grad_norm': 0.42587190866470337, 'learning_rate': 0.000285, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.21it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 3.1126, 'grad_norm': 0.8093498349189758, 'learning_rate': 0.00027749999999999997, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s]                                              {'loss': 2.9427, 'grad_norm': 0.25880923867225647, 'learning_rate': 0.00027, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s]                                              {'loss': 3.1144, 'grad_norm': 0.28075316548347473, 'learning_rate': 0.0002625, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 3.0621, 'grad_norm': 0.45909515023231506, 'learning_rate': 0.00025499999999999996, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 2.9531, 'grad_norm': 0.9926639795303345, 'learning_rate': 0.00024749999999999994, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.15it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s]                                              {'loss': 3.0863, 'grad_norm': 0.342070609331131, 'learning_rate': 0.00023999999999999998, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s]                                               {'loss': 2.9964, 'grad_norm': 0.26717039942741394, 'learning_rate': 0.00023249999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.48it/s]                                               {'loss': 3.131, 'grad_norm': 0.540932297706604, 'learning_rate': 0.000225, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.48it/s] 30%|███       | 12/40 [00:05<00:11,  2.37it/s]                                               {'loss': 3.0206, 'grad_norm': 0.2656245827674866, 'learning_rate': 0.00021749999999999997, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.37it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.32it/s]                                               {'loss': 3.0243, 'grad_norm': 0.30087679624557495, 'learning_rate': 0.00020999999999999998, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.32it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.34it/s]                                               {'loss': 3.0438, 'grad_norm': 0.3373141288757324, 'learning_rate': 0.0002025, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.34it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.8876, 'grad_norm': 0.5435091257095337, 'learning_rate': 0.000195, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 2.765, 'grad_norm': 2.0461010932922363, 'learning_rate': 0.00018749999999999998, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s]                                               {'loss': 2.856, 'grad_norm': 0.5416697263717651, 'learning_rate': 0.00017999999999999998, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s]                                               {'loss': 2.9619, 'grad_norm': 0.5632593035697937, 'learning_rate': 0.00017249999999999996, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s]                                               {'loss': 3.0083, 'grad_norm': 0.6166935563087463, 'learning_rate': 0.000165, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s] 50%|█████     | 20/40 [00:08<00:08,  2.38it/s]                                               {'loss': 3.0066, 'grad_norm': 0.5635755658149719, 'learning_rate': 0.00015749999999999998, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.38it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 3.0154, 'grad_norm': 0.8188130259513855, 'learning_rate': 0.00015, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.33it/s]                                               {'loss': 2.9158, 'grad_norm': 0.7005535960197449, 'learning_rate': 0.0001425, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.33it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 3.0519, 'grad_norm': 1.056525468826294, 'learning_rate': 0.000135, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.84it/s]                                               {'loss': 2.6681, 'grad_norm': 1.8910036087036133, 'learning_rate': 0.00012749999999999998, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.84it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s]                                               {'loss': 2.8999, 'grad_norm': 0.8056448101997375, 'learning_rate': 0.00011999999999999999, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s]                                               {'loss': 2.9638, 'grad_norm': 1.0258036851882935, 'learning_rate': 0.0001125, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s]                                               {'loss': 3.0631, 'grad_norm': 1.231335163116455, 'learning_rate': 0.00010499999999999999, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s] 70%|███████   | 28/40 [00:11<00:05,  2.38it/s]                                               {'loss': 2.8941, 'grad_norm': 1.1170424222946167, 'learning_rate': 9.75e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.38it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.29it/s]                                               {'loss': 3.0042, 'grad_norm': 0.8975260853767395, 'learning_rate': 8.999999999999999e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.29it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.8109, 'grad_norm': 1.1726175546646118, 'learning_rate': 8.25e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s]                                               {'loss': 2.942, 'grad_norm': 1.0929220914840698, 'learning_rate': 7.5e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s] 80%|████████  | 32/40 [00:13<00:02,  2.88it/s]                                               {'loss': 2.7705, 'grad_norm': 5.12652063369751, 'learning_rate': 6.75e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.88it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.64it/s]                                               {'loss': 2.9407, 'grad_norm': 1.3664661645889282, 'learning_rate': 5.9999999999999995e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.64it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.56it/s]                                               {'loss': 2.8856, 'grad_norm': 1.347118854522705, 'learning_rate': 5.2499999999999995e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.56it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.39it/s]                                               {'loss': 2.7992, 'grad_norm': 1.2483223676681519, 'learning_rate': 4.4999999999999996e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.39it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.33it/s]                                               {'loss': 2.9062, 'grad_norm': 1.2670578956604004, 'learning_rate': 3.75e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.33it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s]                                               {'loss': 2.8358, 'grad_norm': 1.0390781164169312, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.27it/s]                                               {'loss': 2.9251, 'grad_norm': 1.318517804145813, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.27it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.31it/s]                                               {'loss': 2.9102, 'grad_norm': 1.3835052251815796, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.31it/s]100%|██████████| 40/40 [00:16<00:00,  2.95it/s]                                               {'loss': 2.555, 'grad_norm': 5.105557441711426, 'learning_rate': 7.499999999999999e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.95it/s]                                               {'train_runtime': 16.5086, 'train_samples_per_second': 34.225, 'train_steps_per_second': 2.423, 'train_loss': 2.9450443387031555, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.95it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:56,  8.34it/s]  1%|          | 3/471 [00:00<01:14,  6.27it/s]  1%|          | 4/471 [00:00<01:25,  5.48it/s]  1%|          | 5/471 [00:00<01:30,  5.15it/s]  1%|▏         | 6/471 [00:01<01:27,  5.32it/s]  1%|▏         | 7/471 [00:01<01:36,  4.82it/s]  2%|▏         | 8/471 [00:01<01:35,  4.86it/s]  2%|▏         | 9/471 [00:01<01:40,  4.58it/s]  2%|▏         | 10/471 [00:01<01:35,  4.84it/s]  2%|▏         | 11/471 [00:02<01:39,  4.63it/s]  3%|▎         | 12/471 [00:02<01:31,  4.99it/s]  3%|▎         | 13/471 [00:02<01:31,  5.00it/s]  3%|▎         | 14/471 [00:02<01:22,  5.54it/s]  3%|▎         | 15/471 [00:02<01:23,  5.44it/s]  3%|▎         | 16/471 [00:03<01:20,  5.63it/s]  4%|▎         | 17/471 [00:03<01:21,  5.58it/s]  4%|▍         | 18/471 [00:03<01:20,  5.60it/s]  4%|▍         | 19/471 [00:03<01:17,  5.85it/s]  4%|▍         | 20/471 [00:03<01:14,  6.05it/s]  4%|▍         | 21/471 [00:03<01:08,  6.58it/s]  5%|▍         | 22/471 [00:03<01:08,  6.59it/s]  5%|▍         | 23/471 [00:04<01:03,  7.02it/s]  5%|▌         | 24/471 [00:04<01:04,  6.96it/s]  5%|▌         | 25/471 [00:04<01:01,  7.19it/s]  6%|▌         | 26/471 [00:04<01:02,  7.16it/s]  6%|▌         | 27/471 [00:04<01:03,  7.04it/s]  6%|▌         | 28/471 [00:04<00:58,  7.55it/s]  6%|▌         | 29/471 [00:04<01:02,  7.07it/s]  7%|▋         | 31/471 [00:05<01:00,  7.27it/s]  7%|▋         | 32/471 [00:05<00:56,  7.73it/s]  7%|▋         | 33/471 [00:05<01:01,  7.12it/s]  7%|▋         | 34/471 [00:05<00:58,  7.52it/s]  7%|▋         | 35/471 [00:05<01:00,  7.15it/s]  8%|▊         | 36/471 [00:05<01:00,  7.22it/s]  8%|▊         | 37/471 [00:05<00:56,  7.65it/s]  8%|▊         | 38/471 [00:06<00:59,  7.22it/s]  8%|▊         | 40/471 [00:06<00:57,  7.44it/s]  9%|▊         | 41/471 [00:06<00:54,  7.83it/s]  9%|▉         | 42/471 [00:06<00:58,  7.31it/s]  9%|▉         | 43/471 [00:06<00:57,  7.44it/s]  9%|▉         | 44/471 [00:06<00:58,  7.30it/s] 10%|▉         | 45/471 [00:07<00:59,  7.20it/s] 10%|▉         | 46/471 [00:07<00:57,  7.44it/s] 10%|▉         | 47/471 [00:07<00:58,  7.19it/s] 10%|█         | 48/471 [00:07<00:57,  7.40it/s] 10%|█         | 49/471 [00:07<01:05,  6.41it/s] 11%|█         | 50/471 [00:07<01:02,  6.71it/s] 11%|█         | 51/471 [00:08<01:16,  5.51it/s] 11%|█         | 52/471 [00:08<01:16,  5.45it/s] 11%|█▏        | 53/471 [00:08<01:23,  5.02it/s] 11%|█▏        | 54/471 [00:08<01:18,  5.32it/s] 12%|█▏        | 55/471 [00:08<01:17,  5.37it/s] 12%|█▏        | 56/471 [00:09<01:16,  5.44it/s] 12%|█▏        | 57/471 [00:09<01:15,  5.49it/s] 12%|█▏        | 58/471 [00:09<01:18,  5.29it/s] 13%|█▎        | 59/471 [00:09<01:13,  5.64it/s] 13%|█▎        | 60/471 [00:09<01:15,  5.46it/s] 13%|█▎        | 61/471 [00:09<01:07,  6.09it/s] 13%|█▎        | 62/471 [00:10<01:13,  5.53it/s] 13%|█▎        | 63/471 [00:10<01:10,  5.77it/s] 14%|█▎        | 64/471 [00:10<01:13,  5.53it/s] 14%|█▍        | 65/471 [00:10<01:12,  5.59it/s] 14%|█▍        | 66/471 [00:10<01:09,  5.80it/s] 14%|█▍        | 67/471 [00:11<01:15,  5.33it/s] 14%|█▍        | 68/471 [00:11<01:18,  5.12it/s] 15%|█▍        | 69/471 [00:11<01:21,  4.91it/s] 15%|█▍        | 70/471 [00:11<01:21,  4.94it/s] 15%|█▌        | 71/471 [00:11<01:22,  4.83it/s] 15%|█▌        | 72/471 [00:12<01:22,  4.86it/s] 15%|█▌        | 73/471 [00:12<01:25,  4.63it/s] 16%|█▌        | 74/471 [00:12<01:23,  4.78it/s] 16%|█▌        | 75/471 [00:12<01:27,  4.54it/s] 16%|█▌        | 76/471 [00:12<01:21,  4.83it/s] 16%|█▋        | 77/471 [00:13<01:25,  4.63it/s] 17%|█▋        | 78/471 [00:13<01:21,  4.80it/s] 17%|█▋        | 79/471 [00:13<01:27,  4.48it/s] 17%|█▋        | 80/471 [00:13<01:23,  4.70it/s] 17%|█▋        | 81/471 [00:14<01:25,  4.56it/s] 17%|█▋        | 82/471 [00:14<01:21,  4.78it/s] 18%|█▊        | 83/471 [00:14<01:23,  4.64it/s] 18%|█▊        | 84/471 [00:14<01:24,  4.60it/s] 18%|█▊        | 85/471 [00:14<01:23,  4.62it/s] 18%|█▊        | 86/471 [00:15<01:24,  4.56it/s] 18%|█▊        | 87/471 [00:15<01:21,  4.69it/s] 19%|█▊        | 88/471 [00:15<01:19,  4.80it/s] 19%|█▉        | 89/471 [00:15<01:12,  5.30it/s] 19%|█▉        | 90/471 [00:15<01:13,  5.16it/s] 19%|█▉        | 91/471 [00:15<01:05,  5.76it/s] 20%|█▉        | 92/471 [00:16<01:09,  5.45it/s] 20%|█▉        | 93/471 [00:16<01:06,  5.65it/s] 20%|█▉        | 94/471 [00:16<01:16,  4.93it/s] 20%|██        | 95/471 [00:16<01:15,  5.00it/s] 20%|██        | 96/471 [00:17<01:20,  4.63it/s] 21%|██        | 97/471 [00:17<01:17,  4.81it/s] 21%|██        | 98/471 [00:17<01:19,  4.71it/s] 21%|██        | 99/471 [00:17<01:18,  4.75it/s] 21%|██        | 100/471 [00:17<01:19,  4.66it/s] 21%|██▏       | 101/471 [00:18<01:20,  4.58it/s] 22%|██▏       | 102/471 [00:18<01:19,  4.66it/s] 22%|██▏       | 103/471 [00:18<01:20,  4.59it/s] 22%|██▏       | 104/471 [00:18<01:17,  4.74it/s] 22%|██▏       | 105/471 [00:18<01:21,  4.50it/s] 23%|██▎       | 106/471 [00:19<01:18,  4.65it/s] 23%|██▎       | 107/471 [00:19<01:20,  4.53it/s] 23%|██▎       | 108/471 [00:19<01:14,  4.87it/s] 23%|██▎       | 109/471 [00:19<01:17,  4.65it/s] 23%|██▎       | 110/471 [00:20<01:12,  4.97it/s] 24%|██▎       | 111/471 [00:20<01:20,  4.48it/s] 24%|██▍       | 112/471 [00:20<01:15,  4.75it/s] 24%|██▍       | 113/471 [00:20<01:17,  4.63it/s] 24%|██▍       | 114/471 [00:20<01:15,  4.74it/s] 24%|██▍       | 115/471 [00:21<01:15,  4.73it/s] 25%|██▍       | 116/471 [00:21<01:17,  4.58it/s] 25%|██▍       | 117/471 [00:21<01:13,  4.83it/s] 25%|██▌       | 118/471 [00:21<01:17,  4.56it/s] 25%|██▌       | 119/471 [00:21<01:12,  4.89it/s] 25%|██▌       | 120/471 [00:22<01:16,  4.61it/s] 26%|██▌       | 121/471 [00:22<01:11,  4.89it/s] 26%|██▌       | 122/471 [00:22<01:17,  4.50it/s] 26%|██▌       | 123/471 [00:22<01:12,  4.82it/s] 26%|██▋       | 124/471 [00:23<01:16,  4.53it/s] 27%|██▋       | 125/471 [00:23<01:12,  4.75it/s] 27%|██▋       | 126/471 [00:23<01:13,  4.70it/s] 27%|██▋       | 127/471 [00:23<01:14,  4.64it/s] 27%|██▋       | 128/471 [00:23<01:12,  4.75it/s] 27%|██▋       | 129/471 [00:24<01:13,  4.67it/s] 28%|██▊       | 130/471 [00:24<01:08,  4.95it/s] 28%|██▊       | 131/471 [00:24<01:09,  4.88it/s] 28%|██▊       | 132/471 [00:24<01:08,  4.92it/s] 28%|██▊       | 133/471 [00:24<01:12,  4.68it/s] 28%|██▊       | 134/471 [00:25<01:10,  4.78it/s] 29%|██▊       | 135/471 [00:25<01:13,  4.60it/s] 29%|██▉       | 136/471 [00:25<01:09,  4.85it/s] 29%|██▉       | 137/471 [00:25<01:10,  4.76it/s] 29%|██▉       | 138/471 [00:25<01:11,  4.66it/s] 30%|██▉       | 139/471 [00:26<01:10,  4.69it/s] 30%|██▉       | 140/471 [00:26<01:11,  4.63it/s] 30%|██▉       | 141/471 [00:26<01:09,  4.75it/s] 30%|███       | 142/471 [00:26<01:09,  4.75it/s] 30%|███       | 143/471 [00:27<01:08,  4.82it/s] 31%|███       | 144/471 [00:27<01:10,  4.62it/s] 31%|███       | 145/471 [00:27<01:07,  4.82it/s] 31%|███       | 146/471 [00:27<01:10,  4.62it/s] 31%|███       | 147/471 [00:27<01:05,  4.92it/s] 31%|███▏      | 148/471 [00:28<01:08,  4.68it/s] 32%|███▏      | 149/471 [00:28<01:09,  4.65it/s] 32%|███▏      | 150/471 [00:28<01:08,  4.66it/s] 32%|███▏      | 151/471 [00:28<01:10,  4.54it/s] 32%|███▏      | 152/471 [00:28<01:06,  4.77it/s] 32%|███▏      | 153/471 [00:29<01:08,  4.61it/s] 33%|███▎      | 154/471 [00:29<01:05,  4.83it/s] 33%|███▎      | 155/471 [00:29<01:09,  4.55it/s] 33%|███▎      | 156/471 [00:29<01:04,  4.90it/s] 33%|███▎      | 157/471 [00:30<01:06,  4.69it/s] 34%|███▎      | 158/471 [00:30<00:59,  5.29it/s] 34%|███▍      | 159/471 [00:30<01:00,  5.19it/s] 34%|███▍      | 160/471 [00:30<00:59,  5.24it/s] 34%|███▍      | 161/471 [00:30<00:57,  5.35it/s] 34%|███▍      | 162/471 [00:30<00:58,  5.32it/s] 35%|███▍      | 163/471 [00:31<00:55,  5.60it/s] 35%|███▍      | 164/471 [00:31<00:56,  5.42it/s] 35%|███▌      | 165/471 [00:31<00:54,  5.60it/s] 35%|███▌      | 166/471 [00:31<00:57,  5.33it/s] 35%|███▌      | 167/471 [00:31<00:52,  5.74it/s] 36%|███▌      | 168/471 [00:31<00:55,  5.42it/s] 36%|███▌      | 169/471 [00:32<00:50,  5.93it/s] 36%|███▌      | 170/471 [00:32<00:53,  5.61it/s] 36%|███▋      | 171/471 [00:32<00:54,  5.46it/s] 37%|███▋      | 172/471 [00:32<01:00,  4.97it/s] 37%|███▋      | 173/471 [00:32<00:59,  4.97it/s] 37%|███▋      | 174/471 [00:33<01:01,  4.86it/s] 37%|███▋      | 175/471 [00:33<01:00,  4.93it/s] 37%|███▋      | 176/471 [00:33<01:01,  4.77it/s] 38%|███▊      | 177/471 [00:33<01:03,  4.65it/s] 38%|███▊      | 178/471 [00:34<01:02,  4.69it/s] 38%|███▊      | 179/471 [00:34<01:03,  4.57it/s] 38%|███▊      | 180/471 [00:34<01:00,  4.78it/s] 38%|███▊      | 181/471 [00:34<01:03,  4.58it/s] 39%|███▊      | 182/471 [00:34<01:01,  4.69it/s] 39%|███▉      | 183/471 [00:35<01:04,  4.46it/s] 39%|███▉      | 184/471 [00:35<01:00,  4.77it/s] 39%|███▉      | 185/471 [00:35<01:03,  4.52it/s] 39%|███▉      | 186/471 [00:35<00:58,  4.89it/s] 40%|███▉      | 187/471 [00:35<01:02,  4.51it/s] 40%|███▉      | 188/471 [00:36<01:00,  4.65it/s] 40%|████      | 189/471 [00:36<01:02,  4.48it/s] 40%|████      | 190/471 [00:36<01:00,  4.63it/s] 41%|████      | 191/471 [00:36<01:01,  4.58it/s] 41%|████      | 192/471 [00:37<01:00,  4.60it/s] 41%|████      | 193/471 [00:37<01:01,  4.54it/s] 41%|████      | 194/471 [00:37<01:01,  4.53it/s] 41%|████▏     | 195/471 [00:37<01:00,  4.59it/s] 42%|████▏     | 196/471 [00:37<00:58,  4.70it/s] 42%|████▏     | 197/471 [00:38<00:58,  4.71it/s] 42%|████▏     | 198/471 [00:38<00:59,  4.61it/s] 42%|████▏     | 199/471 [00:38<00:58,  4.67it/s] 42%|████▏     | 200/471 [00:38<00:59,  4.55it/s] 43%|████▎     | 201/471 [00:38<00:56,  4.76it/s] 43%|████▎     | 202/471 [00:39<00:58,  4.60it/s] 43%|████▎     | 203/471 [00:39<00:55,  4.80it/s] 43%|████▎     | 204/471 [00:39<00:59,  4.46it/s] 44%|████▎     | 205/471 [00:39<00:55,  4.79it/s] 44%|████▎     | 206/471 [00:40<00:58,  4.53it/s] 44%|████▍     | 207/471 [00:40<00:53,  4.91it/s] 44%|████▍     | 208/471 [00:40<00:55,  4.76it/s] 44%|████▍     | 209/471 [00:40<00:54,  4.82it/s] 45%|████▍     | 210/471 [00:40<00:57,  4.54it/s] 45%|████▍     | 211/471 [00:41<00:55,  4.69it/s] 45%|████▌     | 212/471 [00:41<00:56,  4.61it/s] 45%|████▌     | 213/471 [00:41<00:54,  4.78it/s] 45%|████▌     | 214/471 [00:41<00:55,  4.65it/s] 46%|████▌     | 215/471 [00:42<00:55,  4.61it/s] 46%|████▌     | 216/471 [00:42<00:55,  4.62it/s] 46%|████▌     | 217/471 [00:42<00:55,  4.56it/s] 46%|████▋     | 218/471 [00:42<00:54,  4.64it/s] 46%|████▋     | 219/471 [00:42<00:54,  4.62it/s] 47%|████▋     | 220/471 [00:43<00:53,  4.68it/s] 47%|████▋     | 221/471 [00:43<00:56,  4.46it/s] 47%|████▋     | 222/471 [00:43<00:52,  4.77it/s] 47%|████▋     | 223/471 [00:43<00:54,  4.52it/s] 48%|████▊     | 224/471 [00:43<00:50,  4.92it/s] 48%|████▊     | 225/471 [00:44<00:54,  4.52it/s] 48%|████▊     | 226/471 [00:44<00:52,  4.70it/s] 48%|████▊     | 227/471 [00:44<00:55,  4.43it/s] 48%|████▊     | 228/471 [00:44<00:51,  4.70it/s] 49%|████▊     | 229/471 [00:45<00:53,  4.55it/s] 49%|████▉     | 230/471 [00:45<00:52,  4.61it/s] 49%|████▉     | 231/471 [00:45<00:53,  4.48it/s] 49%|████▉     | 232/471 [00:45<00:52,  4.51it/s] 49%|████▉     | 233/471 [00:45<00:51,  4.62it/s] 50%|████▉     | 234/471 [00:46<00:51,  4.59it/s] 50%|████▉     | 235/471 [00:46<00:50,  4.67it/s] 50%|█████     | 236/471 [00:46<00:52,  4.46it/s] 50%|█████     | 237/471 [00:46<00:49,  4.73it/s] 51%|█████     | 238/471 [00:47<00:50,  4.57it/s] 51%|█████     | 239/471 [00:47<00:46,  4.94it/s] 51%|█████     | 240/471 [00:47<00:50,  4.62it/s] 51%|█████     | 241/471 [00:47<00:46,  4.90it/s] 51%|█████▏    | 242/471 [00:47<00:50,  4.50it/s] 52%|█████▏    | 243/471 [00:48<00:48,  4.71it/s] 52%|█████▏    | 244/471 [00:48<00:48,  4.67it/s] 52%|█████▏    | 245/471 [00:48<00:47,  4.74it/s] 52%|█████▏    | 246/471 [00:48<00:42,  5.33it/s] 52%|█████▏    | 247/471 [00:48<00:43,  5.19it/s] 53%|█████▎    | 248/471 [00:48<00:37,  5.98it/s] 53%|█████▎    | 249/471 [00:49<00:40,  5.49it/s] 53%|█████▎    | 250/471 [00:49<00:36,  6.12it/s] 53%|█████▎    | 251/471 [00:49<00:36,  6.02it/s] 54%|█████▎    | 252/471 [00:49<00:37,  5.88it/s] 54%|█████▎    | 253/471 [00:49<00:34,  6.39it/s] 54%|█████▍    | 254/471 [00:49<00:37,  5.84it/s] 54%|█████▍    | 255/471 [00:50<00:32,  6.55it/s] 54%|█████▍    | 256/471 [00:50<00:37,  5.81it/s] 55%|█████▍    | 257/471 [00:50<00:34,  6.25it/s] 55%|█████▍    | 258/471 [00:50<00:36,  5.80it/s] 55%|█████▍    | 259/471 [00:50<00:35,  5.89it/s] 55%|█████▌    | 260/471 [00:50<00:36,  5.85it/s] 55%|█████▌    | 261/471 [00:51<00:36,  5.71it/s] 56%|█████▌    | 262/471 [00:51<00:35,  5.91it/s] 56%|█████▌    | 263/471 [00:51<00:36,  5.69it/s] 56%|█████▌    | 264/471 [00:51<00:34,  6.01it/s] 56%|█████▋    | 265/471 [00:51<00:36,  5.60it/s] 56%|█████▋    | 266/471 [00:51<00:33,  6.17it/s] 57%|█████▋    | 267/471 [00:52<00:35,  5.77it/s] 57%|█████▋    | 268/471 [00:52<00:31,  6.41it/s] 57%|█████▋    | 269/471 [00:52<00:31,  6.42it/s] 57%|█████▋    | 270/471 [00:52<00:29,  6.72it/s] 58%|█████▊    | 271/471 [00:52<00:28,  6.91it/s] 58%|█████▊    | 272/471 [00:52<00:28,  6.95it/s] 58%|█████▊    | 273/471 [00:52<00:30,  6.40it/s] 58%|█████▊    | 274/471 [00:53<00:32,  5.97it/s] 58%|█████▊    | 275/471 [00:53<00:33,  5.79it/s] 59%|█████▊    | 276/471 [00:53<00:34,  5.64it/s] 59%|█████▉    | 277/471 [00:53<00:33,  5.75it/s] 59%|█████▉    | 278/471 [00:53<00:32,  5.86it/s] 59%|█████▉    | 279/471 [00:53<00:28,  6.67it/s] 59%|█████▉    | 280/471 [00:54<00:29,  6.47it/s] 60%|█████▉    | 281/471 [00:54<00:27,  6.84it/s] 60%|█████▉    | 282/471 [00:54<00:31,  6.03it/s] 60%|██████    | 283/471 [00:54<00:33,  5.60it/s] 60%|██████    | 284/471 [00:54<00:36,  5.15it/s] 61%|██████    | 285/471 [00:55<00:36,  5.13it/s] 61%|██████    | 286/471 [00:55<00:37,  4.97it/s] 61%|██████    | 287/471 [00:55<00:37,  4.94it/s] 61%|██████    | 288/471 [00:55<00:38,  4.70it/s] 61%|██████▏   | 289/471 [00:56<00:38,  4.69it/s] 62%|██████▏   | 290/471 [00:56<00:39,  4.64it/s] 62%|██████▏   | 291/471 [00:56<00:38,  4.69it/s] 62%|██████▏   | 292/471 [00:56<00:37,  4.78it/s] 62%|██████▏   | 293/471 [00:56<00:38,  4.59it/s] 62%|██████▏   | 294/471 [00:57<00:38,  4.64it/s] 63%|██████▎   | 295/471 [00:57<00:38,  4.53it/s] 63%|██████▎   | 296/471 [00:57<00:36,  4.74it/s] 63%|██████▎   | 297/471 [00:57<00:37,  4.58it/s] 63%|██████▎   | 298/471 [00:57<00:36,  4.76it/s] 63%|██████▎   | 299/471 [00:58<00:38,  4.43it/s] 64%|██████▎   | 300/471 [00:58<00:35,  4.75it/s] 64%|██████▍   | 301/471 [00:58<00:37,  4.51it/s] 64%|██████▍   | 302/471 [00:58<00:34,  4.90it/s] 64%|██████▍   | 303/471 [00:59<00:36,  4.64it/s] 65%|██████▍   | 304/471 [00:59<00:35,  4.73it/s] 65%|██████▍   | 305/471 [00:59<00:35,  4.61it/s] 65%|██████▍   | 306/471 [00:59<00:35,  4.63it/s] 65%|██████▌   | 307/471 [00:59<00:34,  4.78it/s] 65%|██████▌   | 308/471 [01:00<00:34,  4.69it/s] 66%|██████▌   | 309/471 [01:00<00:34,  4.74it/s] 66%|██████▌   | 310/471 [01:00<00:35,  4.50it/s] 66%|██████▌   | 311/471 [01:00<00:33,  4.75it/s] 66%|██████▌   | 312/471 [01:00<00:34,  4.67it/s] 66%|██████▋   | 313/471 [01:01<00:31,  4.95it/s] 67%|██████▋   | 314/471 [01:01<00:32,  4.88it/s] 67%|██████▋   | 315/471 [01:01<00:31,  4.89it/s] 67%|██████▋   | 316/471 [01:01<00:33,  4.64it/s] 67%|██████▋   | 317/471 [01:01<00:32,  4.73it/s] 68%|██████▊   | 318/471 [01:02<00:33,  4.57it/s] 68%|██████▊   | 319/471 [01:02<00:31,  4.78it/s] 68%|██████▊   | 320/471 [01:02<00:31,  4.79it/s] 68%|██████▊   | 321/471 [01:02<00:31,  4.69it/s] 68%|██████▊   | 322/471 [01:03<00:31,  4.67it/s] 69%|██████▊   | 323/471 [01:03<00:32,  4.61it/s] 69%|██████▉   | 324/471 [01:03<00:31,  4.71it/s] 69%|██████▉   | 325/471 [01:03<00:30,  4.73it/s] 69%|██████▉   | 326/471 [01:03<00:30,  4.73it/s] 69%|██████▉   | 327/471 [01:04<00:31,  4.56it/s] 70%|██████▉   | 328/471 [01:04<00:30,  4.70it/s] 70%|██████▉   | 329/471 [01:04<00:31,  4.57it/s] 70%|███████   | 330/471 [01:04<00:28,  5.03it/s] 70%|███████   | 331/471 [01:04<00:29,  4.72it/s] 70%|███████   | 332/471 [01:05<00:28,  4.80it/s] 71%|███████   | 333/471 [01:05<00:29,  4.62it/s] 71%|███████   | 334/471 [01:05<00:28,  4.76it/s] 71%|███████   | 335/471 [01:05<00:29,  4.65it/s] 71%|███████▏  | 336/471 [01:06<00:28,  4.78it/s] 72%|███████▏  | 337/471 [01:06<00:29,  4.59it/s] 72%|███████▏  | 338/471 [01:06<00:28,  4.65it/s] 72%|███████▏  | 339/471 [01:06<00:28,  4.57it/s] 72%|███████▏  | 340/471 [01:06<00:27,  4.70it/s] 72%|███████▏  | 341/471 [01:07<00:27,  4.72it/s] 73%|███████▎  | 342/471 [01:07<00:27,  4.63it/s] 73%|███████▎  | 343/471 [01:07<00:27,  4.58it/s] 73%|███████▎  | 344/471 [01:07<00:28,  4.49it/s] 73%|███████▎  | 345/471 [01:07<00:27,  4.62it/s] 73%|███████▎  | 346/471 [01:08<00:27,  4.58it/s] 74%|███████▎  | 347/471 [01:08<00:26,  4.70it/s] 74%|███████▍  | 348/471 [01:08<00:27,  4.47it/s] 74%|███████▍  | 349/471 [01:08<00:25,  4.73it/s] 74%|███████▍  | 350/471 [01:09<00:26,  4.55it/s] 75%|███████▍  | 351/471 [01:09<00:25,  4.73it/s] 75%|███████▍  | 352/471 [01:09<00:25,  4.69it/s] 75%|███████▍  | 353/471 [01:09<00:23,  4.93it/s] 75%|███████▌  | 354/471 [01:09<00:25,  4.54it/s] 75%|███████▌  | 355/471 [01:10<00:24,  4.75it/s] 76%|███████▌  | 356/471 [01:10<00:25,  4.51it/s] 76%|███████▌  | 357/471 [01:10<00:23,  4.78it/s] 76%|███████▌  | 358/471 [01:10<00:24,  4.62it/s] 76%|███████▌  | 359/471 [01:10<00:23,  4.69it/s] 76%|███████▋  | 360/471 [01:11<00:24,  4.53it/s] 77%|███████▋  | 361/471 [01:11<00:23,  4.61it/s] 77%|███████▋  | 362/471 [01:11<00:23,  4.74it/s] 77%|███████▋  | 363/471 [01:11<00:22,  4.72it/s] 77%|███████▋  | 364/471 [01:12<00:22,  4.66it/s] 77%|███████▋  | 365/471 [01:12<00:23,  4.54it/s] 78%|███████▊  | 366/471 [01:12<00:22,  4.67it/s] 78%|███████▊  | 367/471 [01:12<00:22,  4.54it/s] 78%|███████▊  | 368/471 [01:12<00:21,  4.81it/s] 78%|███████▊  | 369/471 [01:13<00:22,  4.57it/s] 79%|███████▊  | 370/471 [01:13<00:21,  4.76it/s] 79%|███████▉  | 371/471 [01:13<00:22,  4.43it/s] 79%|███████▉  | 372/471 [01:13<00:20,  4.80it/s] 79%|███████▉  | 373/471 [01:14<00:21,  4.54it/s] 79%|███████▉  | 374/471 [01:14<00:19,  4.94it/s] 80%|███████▉  | 375/471 [01:14<00:20,  4.59it/s] 80%|███████▉  | 376/471 [01:14<00:20,  4.60it/s] 80%|████████  | 377/471 [01:14<00:20,  4.64it/s] 80%|████████  | 378/471 [01:15<00:20,  4.61it/s] 80%|████████  | 379/471 [01:15<00:18,  4.86it/s] 81%|████████  | 380/471 [01:15<00:19,  4.58it/s] 81%|████████  | 381/471 [01:15<00:18,  4.75it/s] 81%|████████  | 382/471 [01:15<00:19,  4.51it/s] 81%|████████▏ | 383/471 [01:16<00:18,  4.79it/s] 82%|████████▏ | 384/471 [01:16<00:18,  4.60it/s] 82%|████████▏ | 385/471 [01:16<00:17,  4.88it/s] 82%|████████▏ | 386/471 [01:16<00:18,  4.49it/s] 82%|████████▏ | 387/471 [01:16<00:17,  4.79it/s] 82%|████████▏ | 388/471 [01:17<00:18,  4.53it/s] 83%|████████▎ | 389/471 [01:17<00:17,  4.70it/s] 83%|████████▎ | 390/471 [01:17<00:15,  5.09it/s] 83%|████████▎ | 391/471 [01:17<00:16,  4.90it/s] 83%|████████▎ | 392/471 [01:17<00:15,  4.97it/s] 83%|████████▎ | 393/471 [01:18<00:16,  4.64it/s] 84%|████████▎ | 394/471 [01:18<00:15,  4.90it/s] 84%|████████▍ | 395/471 [01:18<00:16,  4.60it/s] 84%|████████▍ | 396/471 [01:18<00:14,  5.15it/s] 84%|████████▍ | 397/471 [01:19<00:15,  4.65it/s] 85%|████████▍ | 398/471 [01:19<00:15,  4.78it/s] 85%|████████▍ | 399/471 [01:19<00:15,  4.61it/s] 85%|████████▍ | 400/471 [01:19<00:15,  4.61it/s] 85%|████████▌ | 401/471 [01:19<00:14,  4.97it/s] 85%|████████▌ | 402/471 [01:20<00:14,  4.68it/s] 86%|████████▌ | 403/471 [01:20<00:13,  4.92it/s] 86%|████████▌ | 404/471 [01:20<00:14,  4.61it/s] 86%|████████▌ | 405/471 [01:20<00:13,  4.96it/s] 86%|████████▌ | 406/471 [01:20<00:14,  4.63it/s] 86%|████████▋ | 407/471 [01:21<00:12,  5.05it/s] 87%|████████▋ | 408/471 [01:21<00:13,  4.53it/s] 87%|████████▋ | 409/471 [01:21<00:13,  4.67it/s] 87%|████████▋ | 410/471 [01:21<00:13,  4.61it/s] 87%|████████▋ | 411/471 [01:22<00:13,  4.60it/s] 87%|████████▋ | 412/471 [01:22<00:12,  4.90it/s] 88%|████████▊ | 413/471 [01:22<00:12,  4.60it/s] 88%|████████▊ | 414/471 [01:22<00:11,  4.82it/s] 88%|████████▊ | 415/471 [01:22<00:12,  4.55it/s] 88%|████████▊ | 416/471 [01:23<00:11,  4.95it/s] 89%|████████▊ | 417/471 [01:23<00:11,  4.70it/s] 89%|████████▊ | 418/471 [01:23<00:10,  4.99it/s] 89%|████████▉ | 419/471 [01:23<00:11,  4.57it/s] 89%|████████▉ | 420/471 [01:23<00:10,  4.66it/s] 89%|████████▉ | 421/471 [01:24<00:10,  4.70it/s] 90%|████████▉ | 422/471 [01:24<00:10,  4.66it/s] 90%|████████▉ | 423/471 [01:24<00:09,  4.94it/s] 90%|█████████ | 424/471 [01:24<00:09,  4.71it/s] 90%|█████████ | 425/471 [01:24<00:09,  4.80it/s] 90%|█████████ | 426/471 [01:25<00:09,  4.70it/s] 91%|█████████ | 427/471 [01:25<00:09,  4.79it/s] 91%|█████████ | 428/471 [01:25<00:09,  4.70it/s] 91%|█████████ | 429/471 [01:25<00:08,  4.91it/s] 91%|█████████▏| 430/471 [01:26<00:09,  4.55it/s] 92%|█████████▏| 431/471 [01:26<00:08,  4.72it/s] 92%|█████████▏| 432/471 [01:26<00:08,  4.49it/s] 92%|█████████▏| 433/471 [01:26<00:07,  4.75it/s] 92%|█████████▏| 434/471 [01:26<00:07,  4.63it/s] 92%|█████████▏| 435/471 [01:27<00:07,  4.68it/s] 93%|█████████▎| 436/471 [01:27<00:07,  4.54it/s] 93%|█████████▎| 437/471 [01:27<00:07,  4.61it/s] 93%|█████████▎| 438/471 [01:27<00:07,  4.63it/s] 93%|█████████▎| 439/471 [01:27<00:06,  4.71it/s] 93%|█████████▎| 440/471 [01:28<00:06,  4.74it/s] 94%|█████████▎| 441/471 [01:28<00:06,  4.64it/s] 94%|█████████▍| 442/471 [01:28<00:06,  4.68it/s] 94%|█████████▍| 443/471 [01:28<00:06,  4.57it/s] 94%|█████████▍| 444/471 [01:29<00:05,  4.76it/s] 94%|█████████▍| 445/471 [01:29<00:05,  4.58it/s] 95%|█████████▍| 446/471 [01:29<00:05,  4.78it/s] 95%|█████████▍| 447/471 [01:29<00:05,  4.44it/s] 95%|█████████▌| 448/471 [01:29<00:04,  4.76it/s] 95%|█████████▌| 449/471 [01:30<00:04,  4.51it/s] 96%|█████████▌| 450/471 [01:30<00:04,  4.87it/s] 96%|█████████▌| 451/471 [01:30<00:04,  4.51it/s] 96%|█████████▌| 452/471 [01:30<00:04,  4.66it/s] 96%|█████████▌| 453/471 [01:30<00:03,  4.58it/s] 96%|█████████▋| 454/471 [01:31<00:03,  4.71it/s] 97%|█████████▋| 455/471 [01:31<00:03,  4.71it/s] 97%|█████████▋| 456/471 [01:31<00:03,  4.70it/s] 97%|█████████▋| 457/471 [01:31<00:03,  4.56it/s] 97%|█████████▋| 458/471 [01:32<00:02,  4.56it/s] 97%|█████████▋| 459/471 [01:32<00:02,  4.57it/s] 98%|█████████▊| 460/471 [01:32<00:02,  4.63it/s] 98%|█████████▊| 461/471 [01:32<00:02,  4.77it/s] 98%|█████████▊| 462/471 [01:32<00:01,  4.63it/s] 98%|█████████▊| 463/471 [01:33<00:01,  4.69it/s] 99%|█████████▊| 464/471 [01:33<00:01,  4.55it/s] 99%|█████████▊| 465/471 [01:33<00:01,  4.84it/s] 99%|█████████▉| 466/471 [01:33<00:01,  4.67it/s] 99%|█████████▉| 467/471 [01:33<00:00,  5.13it/s] 99%|█████████▉| 468/471 [01:34<00:00,  4.98it/s]100%|█████████▉| 469/471 [01:34<00:00,  5.45it/s]100%|█████████▉| 470/471 [01:34<00:00,  5.33it/s]100%|██████████| 471/471 [01:34<00:00,  5.72it/s]100%|██████████| 471/471 [01:34<00:00,  4.98it/s]
{'eval_loss': 2.9878532886505127, 'eval_model_preparation_time': 0.0046, 'eval_acc': 0.07899628252788105, 'eval_runtime': 94.7964, 'eval_samples_per_second': 79.454, 'eval_steps_per_second': 4.969}
ROUND:1
CLIENT:26
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.73it/s]                                              {'loss': 2.9386, 'grad_norm': 0.48683080077171326, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.73it/s]  5%|▌         | 2/40 [00:00<00:14,  2.68it/s]                                              {'loss': 2.9967, 'grad_norm': 0.5066561698913574, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:14,  2.68it/s]  8%|▊         | 3/40 [00:01<00:13,  2.70it/s]                                              {'loss': 3.025, 'grad_norm': 0.78287672996521, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.70it/s] 10%|█         | 4/40 [00:01<00:13,  2.68it/s]                                              {'loss': 2.8657, 'grad_norm': 1.1120535135269165, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.68it/s] 12%|█▎        | 5/40 [00:01<00:13,  2.62it/s]                                              {'loss': 2.9689, 'grad_norm': 1.3131111860275269, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:13,  2.62it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.41it/s]                                              {'loss': 3.0005, 'grad_norm': 1.45708167552948, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.41it/s] 18%|█▊        | 7/40 [00:02<00:14,  2.34it/s]                                              {'loss': 2.9358, 'grad_norm': 1.1783559322357178, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:14,  2.34it/s]                                              {'loss': 2.9827, 'grad_norm': 3.9195780754089355, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:13,  2.34it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.82it/s]                                              {'loss': 2.7912, 'grad_norm': 1.4119924306869507, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.82it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.65it/s]                                               {'loss': 2.8956, 'grad_norm': 1.3297616243362427, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.65it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.56it/s]                                               {'loss': 2.9486, 'grad_norm': 1.9777426719665527, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.56it/s] 30%|███       | 12/40 [00:04<00:11,  2.44it/s]                                               {'loss': 2.9148, 'grad_norm': 2.0951428413391113, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.44it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.40it/s]                                               {'loss': 2.6862, 'grad_norm': 2.1364612579345703, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.40it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s]                                               {'loss': 2.9471, 'grad_norm': 1.9269808530807495, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.28it/s]                                               {'loss': 2.8453, 'grad_norm': 2.089829206466675, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.28it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 2.7167, 'grad_norm': 5.476670265197754, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.61it/s]                                               {'loss': 2.6606, 'grad_norm': 1.832746148109436, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s]                                               {'loss': 2.7506, 'grad_norm': 3.56783127784729, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.46it/s]                                               {'loss': 2.6459, 'grad_norm': 2.541246175765991, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.46it/s] 50%|█████     | 20/40 [00:07<00:08,  2.36it/s]                                               {'loss': 2.9372, 'grad_norm': 2.510371446609497, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.36it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.8607, 'grad_norm': 2.1288764476776123, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.31it/s]                                               {'loss': 2.6978, 'grad_norm': 2.0922021865844727, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.31it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.7376, 'grad_norm': 1.8929100036621094, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s] 60%|██████    | 24/40 [00:09<00:05,  2.85it/s]                                               {'loss': 3.0438, 'grad_norm': 9.01744270324707, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.77it/s]                                               {'loss': 2.7672, 'grad_norm': 2.0921099185943604, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.77it/s] 65%|██████▌   | 26/40 [00:10<00:04,  2.81it/s]                                               {'loss': 2.7682, 'grad_norm': 2.2695038318634033, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  2.81it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.79it/s]                                               {'loss': 2.7743, 'grad_norm': 2.354004144668579, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.79it/s] 70%|███████   | 28/40 [00:11<00:04,  2.58it/s]                                               {'loss': 2.5628, 'grad_norm': 1.955133080482483, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.58it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.46it/s]                                               {'loss': 2.7244, 'grad_norm': 2.050853967666626, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.46it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.41it/s]                                               {'loss': 2.5285, 'grad_norm': 2.259807586669922, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.41it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.33it/s]                                               {'loss': 2.7119, 'grad_norm': 3.077207088470459, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.33it/s] 80%|████████  | 32/40 [00:12<00:02,  2.90it/s]                                               {'loss': 3.0915, 'grad_norm': 9.657696723937988, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.65it/s]                                               {'loss': 2.5739, 'grad_norm': 2.2857666015625, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.45it/s]                                               {'loss': 2.6256, 'grad_norm': 2.2690486907958984, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.45it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.36it/s]                                               {'loss': 2.6768, 'grad_norm': 2.387052059173584, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.36it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.30it/s]                                               {'loss': 2.6055, 'grad_norm': 3.132044553756714, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.23it/s]                                               {'loss': 2.8621, 'grad_norm': 2.168998956680298, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.23it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s]                                               {'loss': 2.8008, 'grad_norm': 2.5195329189300537, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.16it/s]                                               {'loss': 2.5781, 'grad_norm': 1.8940823078155518, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.16it/s]                                               {'loss': 2.6075, 'grad_norm': 11.17570686340332, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.16it/s]                                               {'train_runtime': 15.9758, 'train_samples_per_second': 35.366, 'train_steps_per_second': 2.504, 'train_loss': 2.801313179731369, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.16it/s]100%|██████████| 40/40 [00:15<00:00,  2.51it/s]
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]                                              {'loss': 2.8228, 'grad_norm': 0.6595969796180725, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.34it/s]  5%|▌         | 2/40 [00:01<00:22,  1.72it/s]                                              {'loss': 2.9374, 'grad_norm': 0.3920394778251648, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:22,  1.72it/s]  8%|▊         | 3/40 [00:01<00:19,  1.91it/s]                                              {'loss': 2.921, 'grad_norm': 0.8202157020568848, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:19,  1.91it/s] 10%|█         | 4/40 [00:02<00:17,  2.04it/s]                                              {'loss': 2.9254, 'grad_norm': 1.0705891847610474, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:17,  2.04it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.08it/s]                                              {'loss': 2.9267, 'grad_norm': 1.3203186988830566, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.08it/s] 15%|█▌        | 6/40 [00:03<00:15,  2.14it/s]                                              {'loss': 2.8056, 'grad_norm': 1.065026879310608, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:15,  2.14it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 3.0168, 'grad_norm': 1.3479024171829224, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s] 20%|██        | 8/40 [00:03<00:15,  2.13it/s]                                              {'loss': 2.7752, 'grad_norm': 6.44822883605957, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:15,  2.13it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.18it/s]                                              {'loss': 2.6882, 'grad_norm': 1.626765489578247, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.18it/s] 25%|██▌       | 10/40 [00:04<00:13,  2.16it/s]                                               {'loss': 2.939, 'grad_norm': 1.548224925994873, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:13,  2.16it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.18it/s]                                               {'loss': 2.725, 'grad_norm': 1.906338095664978, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.18it/s] 30%|███       | 12/40 [00:05<00:12,  2.19it/s]                                               {'loss': 2.8357, 'grad_norm': 1.7978229522705078, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.19it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.20it/s]                                               {'loss': 2.8347, 'grad_norm': 1.7746607065200806, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.20it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.22it/s]                                               {'loss': 2.7176, 'grad_norm': 1.8323378562927246, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.22it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s]                                               {'loss': 2.8438, 'grad_norm': 1.5792005062103271, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s] 40%|████      | 16/40 [00:07<00:08,  2.77it/s]                                               {'loss': 2.0035, 'grad_norm': 7.80096435546875, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.77it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.63it/s]                                               {'loss': 2.8106, 'grad_norm': 2.5373246669769287, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.63it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.49it/s]                                               {'loss': 2.7124, 'grad_norm': 1.9699400663375854, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.49it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.38it/s]                                               {'loss': 2.66, 'grad_norm': 2.307556629180908, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.38it/s] 50%|█████     | 20/40 [00:09<00:08,  2.35it/s]                                               {'loss': 2.7292, 'grad_norm': 2.0931365489959717, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.35it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s]                                               {'loss': 2.5729, 'grad_norm': 1.8207800388336182, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.6261, 'grad_norm': 2.026062250137329, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s]                                               {'loss': 2.7935, 'grad_norm': 2.0010018348693848, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s] 60%|██████    | 24/40 [00:10<00:05,  2.86it/s]                                               {'loss': 2.5245, 'grad_norm': 6.030529022216797, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.86it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 2.7892, 'grad_norm': 2.1301934719085693, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.52it/s]                                               {'loss': 2.6505, 'grad_norm': 2.057227611541748, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.52it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.7351, 'grad_norm': 1.8334561586380005, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s] 70%|███████   | 28/40 [00:12<00:05,  2.33it/s]                                               {'loss': 2.5687, 'grad_norm': 2.0503454208374023, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.522, 'grad_norm': 2.3762736320495605, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.25it/s]                                               {'loss': 2.6184, 'grad_norm': 2.141028881072998, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.24it/s]                                               {'loss': 2.6004, 'grad_norm': 1.9699928760528564, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.24it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 3.6047, 'grad_norm': 12.165068626403809, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.57it/s]                                               {'loss': 2.5721, 'grad_norm': 2.2308125495910645, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.57it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s]                                               {'loss': 2.6093, 'grad_norm': 1.96710205078125, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.34it/s]                                               {'loss': 2.6964, 'grad_norm': 2.365687131881714, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.34it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s]                                               {'loss': 2.6282, 'grad_norm': 2.6352860927581787, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.31it/s]                                               {'loss': 2.6459, 'grad_norm': 1.9928979873657227, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.23it/s]                                               {'loss': 2.5575, 'grad_norm': 1.9220964908599854, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]                                               {'loss': 2.614, 'grad_norm': 2.0480990409851074, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]                                               {'loss': 2.1481, 'grad_norm': 6.812134265899658, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.22it/s]                                               {'train_runtime': 17.2549, 'train_samples_per_second': 32.744, 'train_steps_per_second': 2.318, 'train_loss': 2.7177073419094087, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.22it/s]100%|██████████| 40/40 [00:17<00:00,  2.32it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]                                              {'loss': 2.9681, 'grad_norm': 0.7130736708641052, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.9722, 'grad_norm': 0.9377014636993408, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]  8%|▊         | 3/40 [00:01<00:17,  2.15it/s]                                              {'loss': 2.8882, 'grad_norm': 0.9134702682495117, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.15it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.9661, 'grad_norm': 0.8685378432273865, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s]                                              {'loss': 2.9273, 'grad_norm': 1.274245262145996, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s]                                              {'loss': 2.8608, 'grad_norm': 1.3264358043670654, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 2.8471, 'grad_norm': 1.4499534368515015, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 3.287, 'grad_norm': 6.089150905609131, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.18it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.94it/s]                                              {'loss': 2.8462, 'grad_norm': 1.966765284538269, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.94it/s] 25%|██▌       | 10/40 [00:04<00:10,  2.90it/s]                                               {'loss': 2.8493, 'grad_norm': 2.262378692626953, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:10,  2.90it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.85it/s]                                               {'loss': 2.778, 'grad_norm': 1.5603771209716797, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.85it/s] 30%|███       | 12/40 [00:04<00:09,  2.81it/s]                                               {'loss': 2.7364, 'grad_norm': 1.9866549968719482, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.81it/s] 32%|███▎      | 13/40 [00:05<00:09,  2.78it/s]                                               {'loss': 2.8596, 'grad_norm': 1.771328091621399, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:09,  2.78it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.77it/s]                                               {'loss': 2.825, 'grad_norm': 1.8865858316421509, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.77it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.75it/s]                                               {'loss': 2.8026, 'grad_norm': 1.8990329504013062, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.75it/s]                                               {'loss': 3.0623, 'grad_norm': 7.462526321411133, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:08,  2.75it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.32it/s]                                               {'loss': 2.6933, 'grad_norm': 1.8838777542114258, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.32it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.15it/s]                                               {'loss': 2.7699, 'grad_norm': 2.245833396911621, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.15it/s] 48%|████▊     | 19/40 [00:07<00:06,  3.00it/s]                                               {'loss': 2.7812, 'grad_norm': 2.4010581970214844, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:06,  3.00it/s] 50%|█████     | 20/40 [00:07<00:06,  2.94it/s]                                               {'loss': 2.6941, 'grad_norm': 2.256600856781006, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  2.94it/s] 52%|█████▎    | 21/40 [00:07<00:07,  2.71it/s]                                               {'loss': 2.6163, 'grad_norm': 2.114572525024414, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:07,  2.71it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.52it/s]                                               {'loss': 2.5994, 'grad_norm': 2.793029546737671, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.52it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.45it/s]                                               {'loss': 2.7914, 'grad_norm': 2.265087842941284, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.45it/s] 60%|██████    | 24/40 [00:08<00:05,  3.08it/s]                                               {'loss': 2.1604, 'grad_norm': 6.9761576652526855, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  3.08it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.75it/s]                                               {'loss': 2.567, 'grad_norm': 1.910773754119873, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.75it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.62it/s]                                               {'loss': 2.7291, 'grad_norm': 1.859470248222351, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.62it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.46it/s]                                               {'loss': 2.5003, 'grad_norm': 2.128563165664673, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.46it/s] 70%|███████   | 28/40 [00:10<00:04,  2.42it/s]                                               {'loss': 2.7236, 'grad_norm': 2.4216461181640625, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.42it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.39it/s]                                               {'loss': 2.571, 'grad_norm': 2.3674581050872803, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.39it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.32it/s]                                               {'loss': 2.713, 'grad_norm': 2.3465538024902344, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.32it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s]                                               {'loss': 2.702, 'grad_norm': 2.9025373458862305, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s] 80%|████████  | 32/40 [00:12<00:02,  2.88it/s]                                               {'loss': 2.8704, 'grad_norm': 8.658997535705566, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.88it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.59it/s]                                               {'loss': 2.6395, 'grad_norm': 2.243534564971924, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.49it/s]                                               {'loss': 2.7515, 'grad_norm': 1.9614874124526978, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.49it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.40it/s]                                               {'loss': 2.556, 'grad_norm': 1.9386556148529053, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.40it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.34it/s]                                               {'loss': 2.4591, 'grad_norm': 2.302159547805786, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.34it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.5819, 'grad_norm': 2.269374132156372, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.36it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.29it/s]                                               {'loss': 2.5404, 'grad_norm': 2.0713624954223633, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]                                               {'loss': 2.5184, 'grad_norm': 2.4765632152557373, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]100%|██████████| 40/40 [00:15<00:00,  2.90it/s]                                               {'loss': 3.2433, 'grad_norm': 13.116843223571777, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.90it/s]                                               {'train_runtime': 15.5113, 'train_samples_per_second': 36.425, 'train_steps_per_second': 2.579, 'train_loss': 2.756217300891876, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.90it/s]100%|██████████| 40/40 [00:15<00:00,  2.58it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.06it/s]                                              {'loss': 3.0194, 'grad_norm': 0.5435287952423096, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.06it/s]  5%|▌         | 2/40 [00:01<00:24,  1.57it/s]                                              {'loss': 2.9364, 'grad_norm': 0.5687734484672546, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.57it/s]  8%|▊         | 3/40 [00:01<00:19,  1.92it/s]                                              {'loss': 3.0867, 'grad_norm': 0.9445978999137878, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:19,  1.92it/s] 10%|█         | 4/40 [00:01<00:16,  2.14it/s]                                              {'loss': 2.9488, 'grad_norm': 1.0773922204971313, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:16,  2.14it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.28it/s]                                              {'loss': 2.8728, 'grad_norm': 1.1397424936294556, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.28it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.34it/s]                                              {'loss': 2.9362, 'grad_norm': 1.2127342224121094, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.34it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.31it/s]                                              {'loss': 2.8785, 'grad_norm': 1.1608659029006958, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.31it/s] 20%|██        | 8/40 [00:04<00:18,  1.72it/s]                                              {'loss': 2.9118, 'grad_norm': 5.367353439331055, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:18,  1.72it/s] 22%|██▎       | 9/40 [00:04<00:16,  1.84it/s]                                              {'loss': 2.903, 'grad_norm': 1.1673270463943481, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:16,  1.84it/s] 25%|██▌       | 10/40 [00:05<00:15,  1.94it/s]                                               {'loss': 2.9368, 'grad_norm': 1.7603877782821655, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:15,  1.94it/s] 28%|██▊       | 11/40 [00:05<00:14,  2.07it/s]                                               {'loss': 2.8573, 'grad_norm': 1.7993063926696777, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:14,  2.07it/s] 30%|███       | 12/40 [00:05<00:13,  2.09it/s]                                               {'loss': 2.8989, 'grad_norm': 1.546504020690918, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:13,  2.09it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.14it/s]                                               {'loss': 2.8237, 'grad_norm': 1.9668116569519043, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.14it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.18it/s]                                               {'loss': 2.8463, 'grad_norm': 1.6641665697097778, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.18it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.19it/s]                                               {'loss': 2.7398, 'grad_norm': 1.645927906036377, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.19it/s] 40%|████      | 16/40 [00:07<00:08,  2.75it/s]                                               {'loss': 2.3144, 'grad_norm': 7.879497051239014, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.75it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.8176, 'grad_norm': 1.7889920473098755, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:08<00:09,  2.43it/s]                                               {'loss': 2.822, 'grad_norm': 1.6548810005187988, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:09,  2.43it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.7848, 'grad_norm': 1.6282196044921875, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:09<00:08,  2.28it/s]                                               {'loss': 2.7094, 'grad_norm': 2.0672526359558105, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.28it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.27it/s]                                               {'loss': 2.8325, 'grad_norm': 1.7455940246582031, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.31it/s]                                               {'loss': 2.6865, 'grad_norm': 1.7844908237457275, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.31it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s]                                               {'loss': 2.7263, 'grad_norm': 2.7151408195495605, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s] 60%|██████    | 24/40 [00:10<00:05,  2.85it/s]                                               {'loss': 2.5689, 'grad_norm': 8.166300773620605, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.65it/s]                                               {'loss': 2.7113, 'grad_norm': 1.5033087730407715, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.65it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.44it/s]                                               {'loss': 2.7751, 'grad_norm': 1.8545832633972168, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.44it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.37it/s]                                               {'loss': 2.8422, 'grad_norm': 1.8830883502960205, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.37it/s] 70%|███████   | 28/40 [00:12<00:05,  2.35it/s]                                               {'loss': 2.7285, 'grad_norm': 1.785632610321045, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.35it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.7104, 'grad_norm': 2.3208389282226562, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s]                                               {'loss': 2.6773, 'grad_norm': 2.0879058837890625, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s]                                               {'loss': 2.7317, 'grad_norm': 1.9918088912963867, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s] 80%|████████  | 32/40 [00:14<00:02,  2.87it/s]                                               {'loss': 2.9993, 'grad_norm': 6.922796726226807, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.87it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.65it/s]                                               {'loss': 2.7326, 'grad_norm': 1.6418870687484741, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.49it/s]                                               {'loss': 2.811, 'grad_norm': 2.8660833835601807, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.49it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.40it/s]                                               {'loss': 2.5355, 'grad_norm': 1.9851096868515015, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.40it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.37it/s]                                               {'loss': 2.8882, 'grad_norm': 2.600754737854004, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.37it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.29it/s]                                               {'loss': 2.6672, 'grad_norm': 2.1324408054351807, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.27it/s]                                               {'loss': 2.6182, 'grad_norm': 2.981147289276123, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.27it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]                                               {'loss': 2.6187, 'grad_norm': 1.9782415628433228, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]100%|██████████| 40/40 [00:17<00:00,  2.94it/s]                                               {'loss': 2.7069, 'grad_norm': 8.824691772460938, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.94it/s]                                               {'train_runtime': 17.3851, 'train_samples_per_second': 32.499, 'train_steps_per_second': 2.301, 'train_loss': 2.790324717760086, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.94it/s]100%|██████████| 40/40 [00:17<00:00,  2.30it/s]
CLIENT:77
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]                                              {'loss': 3.0795, 'grad_norm': 0.6431722640991211, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]  5%|▌         | 2/40 [00:00<00:15,  2.46it/s]                                              {'loss': 2.932, 'grad_norm': 0.5492259860038757, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:15,  2.46it/s]  8%|▊         | 3/40 [00:01<00:15,  2.46it/s]                                              {'loss': 2.9967, 'grad_norm': 0.8255083560943604, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.46it/s] 10%|█         | 4/40 [00:01<00:14,  2.53it/s]                                              {'loss': 2.8935, 'grad_norm': 1.2388290166854858, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.53it/s] 12%|█▎        | 5/40 [00:02<00:13,  2.50it/s]                                              {'loss': 2.9986, 'grad_norm': 1.1985574960708618, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.50it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.53it/s]                                              {'loss': 2.7925, 'grad_norm': 1.1744366884231567, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.53it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.57it/s]                                              {'loss': 2.853, 'grad_norm': 1.0531229972839355, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.57it/s]                                              {'loss': 3.081, 'grad_norm': 4.257518768310547, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:12,  2.57it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.03it/s]                                              {'loss': 2.7915, 'grad_norm': 1.390509009361267, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.03it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.76it/s]                                               {'loss': 2.8742, 'grad_norm': 1.4041050672531128, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.76it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.56it/s]                                               {'loss': 2.8, 'grad_norm': 2.438324213027954, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.56it/s] 30%|███       | 12/40 [00:04<00:11,  2.47it/s]                                               {'loss': 2.9216, 'grad_norm': 1.3647688627243042, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.47it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.35it/s]                                               {'loss': 2.8263, 'grad_norm': 1.5089702606201172, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.35it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.9072, 'grad_norm': 1.463965654373169, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.31it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.27it/s]                                               {'loss': 2.8393, 'grad_norm': 1.7371073961257935, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.27it/s] 40%|████      | 16/40 [00:06<00:08,  2.84it/s]                                               {'loss': 2.7226, 'grad_norm': 5.438910484313965, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.84it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.66it/s]                                               {'loss': 2.7347, 'grad_norm': 2.1311089992523193, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.66it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.64it/s]                                               {'loss': 2.7952, 'grad_norm': 1.67528235912323, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.64it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.75it/s]                                               {'loss': 2.6213, 'grad_norm': 1.7333496809005737, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.75it/s] 50%|█████     | 20/40 [00:07<00:07,  2.79it/s]                                               {'loss': 2.6838, 'grad_norm': 2.013092041015625, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.79it/s] 52%|█████▎    | 21/40 [00:08<00:06,  2.76it/s]                                               {'loss': 2.6699, 'grad_norm': 2.063500165939331, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:06,  2.76it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.73it/s]                                               {'loss': 2.7771, 'grad_norm': 2.027486562728882, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.73it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.71it/s]                                               {'loss': 2.7357, 'grad_norm': 2.366762638092041, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.71it/s]                                               {'loss': 2.4843, 'grad_norm': 5.622550964355469, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.71it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.37it/s]                                               {'loss': 2.741, 'grad_norm': 2.427295446395874, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.37it/s] 65%|██████▌   | 26/40 [00:09<00:04,  3.23it/s]                                               {'loss': 2.735, 'grad_norm': 1.8424651622772217, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  3.23it/s] 68%|██████▊   | 27/40 [00:09<00:04,  3.09it/s]                                               {'loss': 2.6296, 'grad_norm': 2.135833501815796, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  3.09it/s] 70%|███████   | 28/40 [00:10<00:04,  2.98it/s]                                               {'loss': 2.5849, 'grad_norm': 2.544090747833252, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.98it/s] 72%|███████▎  | 29/40 [00:10<00:03,  2.89it/s]                                               {'loss': 2.6725, 'grad_norm': 1.966844916343689, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:03,  2.89it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.80it/s]                                               {'loss': 2.71, 'grad_norm': 1.9046608209609985, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.80it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.55it/s]                                               {'loss': 2.6976, 'grad_norm': 2.271853446960449, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.55it/s] 80%|████████  | 32/40 [00:11<00:02,  3.17it/s]                                               {'loss': 2.8658, 'grad_norm': 10.718507766723633, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  3.17it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.87it/s]                                               {'loss': 2.6242, 'grad_norm': 2.221595525741577, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.87it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.61it/s]                                               {'loss': 2.5841, 'grad_norm': 2.1226768493652344, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.61it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.48it/s]                                               {'loss': 2.7606, 'grad_norm': 2.169276237487793, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.48it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s]                                               {'loss': 2.5758, 'grad_norm': 2.103182077407837, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.32it/s]                                               {'loss': 2.7977, 'grad_norm': 2.8386735916137695, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.32it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.31it/s]                                               {'loss': 2.561, 'grad_norm': 2.4315717220306396, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.24it/s]                                               {'loss': 2.7193, 'grad_norm': 2.614555597305298, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.24it/s]100%|██████████| 40/40 [00:15<00:00,  2.81it/s]                                               {'loss': 2.8963, 'grad_norm': 6.508939266204834, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.81it/s]                                               {'train_runtime': 15.1109, 'train_samples_per_second': 37.39, 'train_steps_per_second': 2.647, 'train_loss': 2.7741701126098635, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.81it/s]100%|██████████| 40/40 [00:15<00:00,  2.65it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]                                              {'loss': 2.9467, 'grad_norm': 0.490300714969635, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]  5%|▌         | 2/40 [00:00<00:15,  2.46it/s]                                              {'loss': 3.0468, 'grad_norm': 0.6575536727905273, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:15,  2.46it/s]  8%|▊         | 3/40 [00:01<00:14,  2.58it/s]                                              {'loss': 2.9691, 'grad_norm': 1.069859266281128, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:14,  2.58it/s] 10%|█         | 4/40 [00:01<00:13,  2.58it/s]                                              {'loss': 2.9276, 'grad_norm': 0.8800672888755798, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.58it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.38it/s]                                              {'loss': 2.9676, 'grad_norm': 2.0759098529815674, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.38it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.31it/s]                                              {'loss': 2.9861, 'grad_norm': 1.2546603679656982, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.31it/s] 18%|█▊        | 7/40 [00:02<00:14,  2.27it/s]                                              {'loss': 2.9235, 'grad_norm': 1.4496111869812012, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:14,  2.27it/s]                                              {'loss': 2.7497, 'grad_norm': 5.481504917144775, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.27it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.86it/s]                                              {'loss': 2.9159, 'grad_norm': 1.4127939939498901, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.86it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.84it/s]                                               {'loss': 2.7829, 'grad_norm': 1.6864609718322754, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.84it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.74it/s]                                               {'loss': 2.9719, 'grad_norm': 1.8400568962097168, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.74it/s] 30%|███       | 12/40 [00:04<00:10,  2.71it/s]                                               {'loss': 2.8161, 'grad_norm': 1.967358946800232, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.71it/s] 32%|███▎      | 13/40 [00:04<00:10,  2.69it/s]                                               {'loss': 2.9989, 'grad_norm': 2.0064637660980225, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:10,  2.69it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.67it/s]                                               {'loss': 2.8925, 'grad_norm': 1.8088611364364624, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.67it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.67it/s]                                               {'loss': 2.8653, 'grad_norm': 1.9450997114181519, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.67it/s] 40%|████      | 16/40 [00:05<00:07,  3.31it/s]                                               {'loss': 2.9943, 'grad_norm': 6.824184894561768, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.31it/s] 42%|████▎     | 17/40 [00:06<00:07,  2.91it/s]                                               {'loss': 2.7072, 'grad_norm': 2.3072268962860107, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  2.91it/s] 45%|████▌     | 18/40 [00:06<00:07,  2.82it/s]                                               {'loss': 2.8331, 'grad_norm': 1.7885289192199707, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:07,  2.82it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.66it/s]                                               {'loss': 2.8194, 'grad_norm': 2.099435567855835, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.66it/s] 50%|█████     | 20/40 [00:07<00:07,  2.59it/s]                                               {'loss': 2.8261, 'grad_norm': 2.0126709938049316, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.59it/s] 52%|█████▎    | 21/40 [00:07<00:07,  2.48it/s]                                               {'loss': 2.7446, 'grad_norm': 1.9713952541351318, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:07,  2.48it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.39it/s]                                               {'loss': 2.749, 'grad_norm': 1.8914583921432495, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.39it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.38it/s]                                               {'loss': 2.8423, 'grad_norm': 2.4171619415283203, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.38it/s] 60%|██████    | 24/40 [00:08<00:05,  2.98it/s]                                               {'loss': 2.7454, 'grad_norm': 7.617826461791992, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.98it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s]                                               {'loss': 2.6876, 'grad_norm': 1.9103742837905884, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.50it/s]                                               {'loss': 2.6699, 'grad_norm': 1.9607675075531006, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.50it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.40it/s]                                               {'loss': 2.7986, 'grad_norm': 1.8963679075241089, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.40it/s] 70%|███████   | 28/40 [00:10<00:05,  2.29it/s]                                               {'loss': 2.7956, 'grad_norm': 2.060065507888794, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.29it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s]                                               {'loss': 2.8833, 'grad_norm': 2.2032675743103027, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.20it/s]                                               {'loss': 2.5709, 'grad_norm': 1.9969701766967773, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.20it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.18it/s]                                               {'loss': 2.7939, 'grad_norm': 2.0739054679870605, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.18it/s] 80%|████████  | 32/40 [00:12<00:02,  2.82it/s]                                               {'loss': 2.739, 'grad_norm': 8.129783630371094, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.59it/s]                                               {'loss': 2.8331, 'grad_norm': 2.054352045059204, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s]                                               {'loss': 2.6989, 'grad_norm': 1.8959234952926636, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.39it/s]                                               {'loss': 2.7144, 'grad_norm': 1.9597980976104736, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.39it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.30it/s]                                               {'loss': 2.7107, 'grad_norm': 2.3179569244384766, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.28it/s]                                               {'loss': 2.7225, 'grad_norm': 2.073265790939331, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.25it/s]                                               {'loss': 2.7315, 'grad_norm': 2.126542091369629, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.25it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.24it/s]                                               {'loss': 2.6593, 'grad_norm': 2.0086541175842285, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.24it/s]100%|██████████| 40/40 [00:15<00:00,  2.83it/s]                                               {'loss': 2.9256, 'grad_norm': 7.415576457977295, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.83it/s]                                               {'train_runtime': 15.8118, 'train_samples_per_second': 35.733, 'train_steps_per_second': 2.53, 'train_loss': 2.823917531967163, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.83it/s]100%|██████████| 40/40 [00:15<00:00,  2.53it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]                                              {'loss': 2.9872, 'grad_norm': 0.47346678376197815, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 2.8998, 'grad_norm': 0.6773251891136169, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:01<00:22,  1.64it/s]                                              {'loss': 3.1571, 'grad_norm': 1.184502363204956, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.64it/s] 10%|█         | 4/40 [00:02<00:19,  1.81it/s]                                              {'loss': 3.0217, 'grad_norm': 1.188420057296753, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.81it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.94it/s]                                              {'loss': 2.9506, 'grad_norm': 1.421130657196045, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.94it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.04it/s]                                              {'loss': 2.9063, 'grad_norm': 1.369001865386963, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.04it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.06it/s]                                              {'loss': 2.9277, 'grad_norm': 1.3965628147125244, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.06it/s] 20%|██        | 8/40 [00:04<00:14,  2.20it/s]                                              {'loss': 2.9143, 'grad_norm': 5.4764838218688965, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.20it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.20it/s]                                              {'loss': 2.8498, 'grad_norm': 1.6422580480575562, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.20it/s] 25%|██▌       | 10/40 [00:05<00:13,  2.19it/s]                                               {'loss': 2.9429, 'grad_norm': 1.6554313898086548, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:13,  2.19it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s]                                               {'loss': 2.9117, 'grad_norm': 2.0259225368499756, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s] 30%|███       | 12/40 [00:05<00:12,  2.17it/s]                                               {'loss': 2.9156, 'grad_norm': 1.6912002563476562, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:12,  2.17it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.19it/s]                                               {'loss': 2.9151, 'grad_norm': 1.871279001235962, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.19it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.8898, 'grad_norm': 2.064460515975952, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.19it/s]                                               {'loss': 2.821, 'grad_norm': 2.0945353507995605, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.19it/s] 40%|████      | 16/40 [00:07<00:08,  2.79it/s]                                               {'loss': 2.6866, 'grad_norm': 8.778404235839844, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.79it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s]                                               {'loss': 2.8267, 'grad_norm': 2.091512680053711, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.47it/s]                                               {'loss': 2.7733, 'grad_norm': 1.9650770425796509, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s]                                               {'loss': 2.8308, 'grad_norm': 2.1142072677612305, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s] 50%|█████     | 20/40 [00:09<00:08,  2.36it/s]                                               {'loss': 2.8312, 'grad_norm': 1.8516325950622559, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.36it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.31it/s]                                               {'loss': 2.7849, 'grad_norm': 1.9116801023483276, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.31it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.34it/s]                                               {'loss': 2.8116, 'grad_norm': 1.922128677368164, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.34it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.28it/s]                                               {'loss': 2.716, 'grad_norm': 2.3297998905181885, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.28it/s] 60%|██████    | 24/40 [00:10<00:05,  2.85it/s]                                               {'loss': 2.7823, 'grad_norm': 8.708002090454102, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.63it/s]                                               {'loss': 2.6747, 'grad_norm': 1.9808876514434814, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.47it/s]                                               {'loss': 2.8441, 'grad_norm': 2.192850112915039, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.36it/s]                                               {'loss': 2.767, 'grad_norm': 1.7148218154907227, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.36it/s] 70%|███████   | 28/40 [00:12<00:05,  2.32it/s]                                               {'loss': 2.7175, 'grad_norm': 1.8644351959228516, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.32it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.24it/s]                                               {'loss': 2.7634, 'grad_norm': 2.184784412384033, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.24it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.23it/s]                                               {'loss': 2.7448, 'grad_norm': 2.218364953994751, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.23it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.7685, 'grad_norm': 1.863202452659607, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s] 80%|████████  | 32/40 [00:14<00:02,  2.81it/s]                                               {'loss': 2.0987, 'grad_norm': 6.991832256317139, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.81it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.59it/s]                                               {'loss': 2.6977, 'grad_norm': 1.9418262243270874, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s]                                               {'loss': 2.7487, 'grad_norm': 2.1718404293060303, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s] 88%|████████▊ | 35/40 [00:15<00:01,  2.65it/s]                                               {'loss': 2.6432, 'grad_norm': 1.8116483688354492, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:01,  2.65it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.72it/s]                                               {'loss': 2.774, 'grad_norm': 2.173546075820923, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.72it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.77it/s]                                               {'loss': 2.8756, 'grad_norm': 1.8672746419906616, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.77it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.82it/s]                                               {'loss': 2.7205, 'grad_norm': 2.698225259780884, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.82it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.90it/s]                                               {'loss': 2.6816, 'grad_norm': 2.1637156009674072, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.90it/s]100%|██████████| 40/40 [00:16<00:00,  3.62it/s]                                               {'loss': 2.9106, 'grad_norm': 8.852177619934082, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.62it/s]                                               {'train_runtime': 16.8623, 'train_samples_per_second': 33.507, 'train_steps_per_second': 2.372, 'train_loss': 2.812109261751175, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.62it/s]100%|██████████| 40/40 [00:16<00:00,  2.37it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]                                              {'loss': 3.0468, 'grad_norm': 0.6137483716011047, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.9565, 'grad_norm': 0.6240631937980652, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]  8%|▊         | 3/40 [00:01<00:16,  2.25it/s]                                              {'loss': 3.0202, 'grad_norm': 0.9328513145446777, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.25it/s] 10%|█         | 4/40 [00:01<00:16,  2.18it/s]                                              {'loss': 3.0419, 'grad_norm': 0.7344566583633423, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.18it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s]                                              {'loss': 3.015, 'grad_norm': 1.188726782798767, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.7984, 'grad_norm': 1.2357642650604248, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 2.9375, 'grad_norm': 1.2376618385314941, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s] 20%|██        | 8/40 [00:03<00:11,  2.83it/s]                                              {'loss': 2.9342, 'grad_norm': 6.354349613189697, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s]                                              {'loss': 2.7926, 'grad_norm': 1.6857236623764038, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s]                                               {'loss': 2.8885, 'grad_norm': 1.3714290857315063, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s]                                               {'loss': 2.9718, 'grad_norm': 1.8705459833145142, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s] 30%|███       | 12/40 [00:05<00:12,  2.28it/s]                                               {'loss': 2.9341, 'grad_norm': 1.6341793537139893, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.28it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.9092, 'grad_norm': 1.4282218217849731, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.7797, 'grad_norm': 1.5629855394363403, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.7829, 'grad_norm': 1.4547452926635742, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.5088, 'grad_norm': 6.0437421798706055, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:10,  2.23it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.76it/s]                                               {'loss': 2.7473, 'grad_norm': 1.6348575353622437, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.76it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.56it/s]                                               {'loss': 2.8369, 'grad_norm': 1.918919563293457, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.56it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.49it/s]                                               {'loss': 2.8998, 'grad_norm': 2.050499200820923, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.49it/s] 50%|█████     | 20/40 [00:08<00:07,  2.54it/s]                                               {'loss': 2.8199, 'grad_norm': 1.9024485349655151, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.54it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.56it/s]                                               {'loss': 2.8801, 'grad_norm': 1.8739548921585083, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.56it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.45it/s]                                               {'loss': 2.5852, 'grad_norm': 2.2050156593322754, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.45it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.36it/s]                                               {'loss': 2.7136, 'grad_norm': 2.524275302886963, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.36it/s] 60%|██████    | 24/40 [00:09<00:05,  2.96it/s]                                               {'loss': 2.5272, 'grad_norm': 8.255265235900879, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.96it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s]                                               {'loss': 2.7953, 'grad_norm': 2.213151216506958, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.7748, 'grad_norm': 2.252822160720825, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.49it/s]                                               {'loss': 2.6273, 'grad_norm': 1.7267080545425415, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.49it/s] 70%|███████   | 28/40 [00:11<00:05,  2.38it/s]                                               {'loss': 2.7705, 'grad_norm': 2.140866756439209, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.38it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.35it/s]                                               {'loss': 2.7633, 'grad_norm': 2.0379176139831543, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.35it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.31it/s]                                               {'loss': 2.6084, 'grad_norm': 2.002858877182007, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.31it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s]                                               {'loss': 2.772, 'grad_norm': 1.9944721460342407, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s] 80%|████████  | 32/40 [00:13<00:02,  2.85it/s]                                               {'loss': 2.2533, 'grad_norm': 7.663351058959961, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.8695, 'grad_norm': 3.0227251052856445, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s]                                               {'loss': 2.6813, 'grad_norm': 1.982498288154602, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s]                                               {'loss': 2.5739, 'grad_norm': 2.1473162174224854, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.29it/s]                                               {'loss': 2.7693, 'grad_norm': 2.315044641494751, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.29it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s]                                               {'loss': 2.7135, 'grad_norm': 2.0526106357574463, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.25it/s]                                               {'loss': 2.6878, 'grad_norm': 1.870317816734314, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.25it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.7759, 'grad_norm': 2.417652130126953, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'loss': 3.0193, 'grad_norm': 9.032899856567383, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'train_runtime': 16.4846, 'train_samples_per_second': 34.274, 'train_steps_per_second': 2.427, 'train_loss': 2.7945854902267455, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]100%|██████████| 40/40 [00:16<00:00,  2.43it/s]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]                                              {'loss': 2.9246, 'grad_norm': 0.4618098735809326, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]  5%|▌         | 2/40 [00:00<00:16,  2.36it/s]                                              {'loss': 3.0364, 'grad_norm': 0.58507239818573, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.36it/s]  8%|▊         | 3/40 [00:01<00:16,  2.29it/s]                                              {'loss': 3.031, 'grad_norm': 1.22750985622406, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.29it/s] 10%|█         | 4/40 [00:01<00:15,  2.31it/s]                                              {'loss': 3.0129, 'grad_norm': 1.2103580236434937, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.31it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s]                                              {'loss': 2.8888, 'grad_norm': 1.2853306531906128, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.24it/s]                                              {'loss': 2.8876, 'grad_norm': 1.021515130996704, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.24it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.25it/s]                                              {'loss': 2.8292, 'grad_norm': 1.8381516933441162, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.25it/s] 20%|██        | 8/40 [00:03<00:11,  2.84it/s]                                              {'loss': 2.9404, 'grad_norm': 4.819032192230225, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.84it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s]                                              {'loss': 2.8767, 'grad_norm': 1.8325732946395874, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s]                                               {'loss': 2.8583, 'grad_norm': 1.3775728940963745, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.8264, 'grad_norm': 1.4920073747634888, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s] 30%|███       | 12/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.9697, 'grad_norm': 2.3718042373657227, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.40it/s]                                               {'loss': 2.8237, 'grad_norm': 1.9138637781143188, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.40it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.32it/s]                                               {'loss': 2.8007, 'grad_norm': 1.567307472229004, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.32it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.30it/s]                                               {'loss': 2.7976, 'grad_norm': 2.0857129096984863, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.30it/s] 40%|████      | 16/40 [00:06<00:08,  2.89it/s]                                               {'loss': 3.1279, 'grad_norm': 8.14147663116455, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.89it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.64it/s]                                               {'loss': 2.8007, 'grad_norm': 2.06294846534729, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.776, 'grad_norm': 1.5902862548828125, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s]                                               {'loss': 2.8144, 'grad_norm': 1.9851958751678467, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s] 50%|█████     | 20/40 [00:08<00:08,  2.29it/s]                                               {'loss': 2.6844, 'grad_norm': 1.781814694404602, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.29it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.7562, 'grad_norm': 1.5372182130813599, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.22it/s]                                               {'loss': 2.7126, 'grad_norm': 1.8193292617797852, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.22it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s]                                               {'loss': 2.6598, 'grad_norm': 1.7021021842956543, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s]                                               {'loss': 2.9362, 'grad_norm': 6.265868663787842, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:07,  2.20it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.73it/s]                                               {'loss': 2.7777, 'grad_norm': 2.293657064437866, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.73it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.58it/s]                                               {'loss': 2.7018, 'grad_norm': 1.7514770030975342, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.58it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.52it/s]                                               {'loss': 2.7344, 'grad_norm': 1.8775335550308228, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.52it/s] 70%|███████   | 28/40 [00:11<00:04,  2.42it/s]                                               {'loss': 2.7532, 'grad_norm': 1.8813644647598267, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.42it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s]                                               {'loss': 2.7083, 'grad_norm': 2.4354026317596436, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.33it/s]                                               {'loss': 2.607, 'grad_norm': 1.9358376264572144, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.33it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.27it/s]                                               {'loss': 2.6782, 'grad_norm': 2.0690038204193115, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.27it/s] 80%|████████  | 32/40 [00:13<00:02,  2.85it/s]                                               {'loss': 1.7844, 'grad_norm': 5.878114700317383, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.70it/s]                                               {'loss': 2.8034, 'grad_norm': 1.858359456062317, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.70it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.50it/s]                                               {'loss': 2.6629, 'grad_norm': 2.3898394107818604, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.50it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s]                                               {'loss': 2.6264, 'grad_norm': 1.9814257621765137, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.34it/s]                                               {'loss': 2.5758, 'grad_norm': 2.1672556400299072, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.34it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.28it/s]                                               {'loss': 2.7016, 'grad_norm': 2.275904655456543, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.26it/s]                                               {'loss': 2.7537, 'grad_norm': 2.625530481338501, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.26it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.8502, 'grad_norm': 3.334153652191162, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'loss': 2.2132, 'grad_norm': 7.622401714324951, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'train_runtime': 16.5059, 'train_samples_per_second': 34.23, 'train_steps_per_second': 2.423, 'train_loss': 2.7676140874624253, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]                                              {'loss': 3.053, 'grad_norm': 0.6263673305511475, 'learning_rate': 0.00022792407799438732, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.9175, 'grad_norm': 1.1618083715438843, 'learning_rate': 0.00022222597604452764, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:15,  2.32it/s]                                              {'loss': 2.9354, 'grad_norm': 0.6964585781097412, 'learning_rate': 0.00021652787409466795, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.32it/s] 10%|█         | 4/40 [00:01<00:14,  2.46it/s]                                              {'loss': 2.9896, 'grad_norm': 0.7928317189216614, 'learning_rate': 0.0002108297721448083, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.46it/s] 12%|█▎        | 5/40 [00:02<00:13,  2.52it/s]                                              {'loss': 2.8543, 'grad_norm': 1.1308575868606567, 'learning_rate': 0.0002051316701949486, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.52it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.59it/s]                                              {'loss': 2.9515, 'grad_norm': 1.192368507385254, 'learning_rate': 0.0001994335682450889, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.59it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.63it/s]                                              {'loss': 3.0358, 'grad_norm': 1.507398247718811, 'learning_rate': 0.0001937354662952292, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.63it/s]                                              {'loss': 3.0053, 'grad_norm': 7.395752906799316, 'learning_rate': 0.00018803736434536952, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:12,  2.63it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.31it/s]                                              {'loss': 3.0093, 'grad_norm': 1.6274958848953247, 'learning_rate': 0.00018233926239550986, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.31it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.13it/s]                                               {'loss': 2.8312, 'grad_norm': 1.3192322254180908, 'learning_rate': 0.00017664116044565018, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.13it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.02it/s]                                               {'loss': 2.878, 'grad_norm': 2.0677263736724854, 'learning_rate': 0.0001709430584957905, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.02it/s] 30%|███       | 12/40 [00:04<00:09,  2.92it/s]                                               {'loss': 2.8346, 'grad_norm': 1.7093868255615234, 'learning_rate': 0.0001652449565459308, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.92it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.86it/s]                                               {'loss': 2.8989, 'grad_norm': 2.69826602935791, 'learning_rate': 0.00015954685459607112, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.86it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.81it/s]                                               {'loss': 2.9106, 'grad_norm': 1.8291406631469727, 'learning_rate': 0.00015384875264621146, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.81it/s] 38%|███▊      | 15/40 [00:05<00:08,  2.78it/s]                                               {'loss': 2.9853, 'grad_norm': 2.800261974334717, 'learning_rate': 0.00014815065069635178, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  2.78it/s] 40%|████      | 16/40 [00:05<00:06,  3.51it/s]                                               {'loss': 2.0658, 'grad_norm': 9.476593971252441, 'learning_rate': 0.0001424525487464921, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:06,  3.51it/s] 42%|████▎     | 17/40 [00:05<00:06,  3.31it/s]                                               {'loss': 2.7573, 'grad_norm': 2.049330234527588, 'learning_rate': 0.00013675444679663238, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:06,  3.31it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.16it/s]                                               {'loss': 2.662, 'grad_norm': 1.57109797000885, 'learning_rate': 0.0001310563448467727, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.16it/s] 48%|████▊     | 19/40 [00:06<00:07,  3.00it/s]                                               {'loss': 2.8487, 'grad_norm': 2.2761945724487305, 'learning_rate': 0.00012535824289691303, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:07,  3.00it/s] 50%|█████     | 20/40 [00:07<00:07,  2.72it/s]                                               {'loss': 2.7482, 'grad_norm': 2.0970630645751953, 'learning_rate': 0.00011966014094705335, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.72it/s] 52%|█████▎    | 21/40 [00:07<00:07,  2.52it/s]                                               {'loss': 2.7355, 'grad_norm': 1.9807944297790527, 'learning_rate': 0.00011396203899719366, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:07,  2.52it/s] 55%|█████▌    | 22/40 [00:07<00:07,  2.43it/s]                                               {'loss': 2.8466, 'grad_norm': 2.2774691581726074, 'learning_rate': 0.00010826393704733398, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:07,  2.43it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.37it/s]                                               {'loss': 2.839, 'grad_norm': 1.7092806100845337, 'learning_rate': 0.0001025658350974743, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.37it/s] 60%|██████    | 24/40 [00:08<00:05,  2.97it/s]                                               {'loss': 2.6068, 'grad_norm': 6.491847991943359, 'learning_rate': 9.68677331476146e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.97it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.72it/s]                                               {'loss': 2.8291, 'grad_norm': 1.8329262733459473, 'learning_rate': 9.116963119775493e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.72it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.57it/s]                                               {'loss': 2.8164, 'grad_norm': 1.9622247219085693, 'learning_rate': 8.547152924789525e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.57it/s] 68%|██████▊   | 27/40 [00:09<00:05,  2.48it/s]                                               {'loss': 2.6294, 'grad_norm': 1.814942479133606, 'learning_rate': 7.977342729803556e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:05,  2.48it/s] 70%|███████   | 28/40 [00:10<00:04,  2.42it/s]                                               {'loss': 2.8469, 'grad_norm': 2.260622501373291, 'learning_rate': 7.407532534817589e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.42it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.37it/s]                                               {'loss': 2.7938, 'grad_norm': 2.442610502243042, 'learning_rate': 6.837722339831619e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.37it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.34it/s]                                               {'loss': 2.6181, 'grad_norm': 2.3516345024108887, 'learning_rate': 6.267912144845652e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.34it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.29it/s]                                               {'loss': 2.6378, 'grad_norm': 2.428398847579956, 'learning_rate': 5.698101949859683e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.29it/s] 80%|████████  | 32/40 [00:11<00:02,  2.89it/s]                                               {'loss': 2.7667, 'grad_norm': 6.014652252197266, 'learning_rate': 5.128291754873715e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.89it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s]                                               {'loss': 2.6645, 'grad_norm': 1.9341274499893188, 'learning_rate': 4.5584815598877466e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s]                                               {'loss': 2.639, 'grad_norm': 2.1053764820098877, 'learning_rate': 3.988671364901778e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.47it/s]                                               {'loss': 2.6543, 'grad_norm': 2.8342201709747314, 'learning_rate': 3.4188611699158095e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.47it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.42it/s]                                               {'loss': 2.6518, 'grad_norm': 2.2310690879821777, 'learning_rate': 2.8490509749298416e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.42it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.34it/s]                                               {'loss': 2.7216, 'grad_norm': 1.8033835887908936, 'learning_rate': 2.2792407799438733e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.34it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.30it/s]                                               {'loss': 2.9121, 'grad_norm': 2.7942960262298584, 'learning_rate': 1.7094305849579047e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.26it/s]                                               {'loss': 2.6268, 'grad_norm': 2.672419786453247, 'learning_rate': 1.1396203899719367e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.26it/s]100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'loss': 2.6243, 'grad_norm': 9.46237564086914, 'learning_rate': 5.698101949859683e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'train_runtime': 15.1512, 'train_samples_per_second': 37.291, 'train_steps_per_second': 2.64, 'train_loss': 2.790824329853058, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]100%|██████████| 40/40 [00:15<00:00,  2.64it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:43, 10.79it/s]  1%|          | 4/471 [00:00<01:19,  5.85it/s]  1%|          | 5/471 [00:00<01:23,  5.56it/s]  1%|▏         | 6/471 [00:01<01:30,  5.16it/s]  1%|▏         | 7/471 [00:01<01:29,  5.16it/s]  2%|▏         | 8/471 [00:01<01:35,  4.86it/s]  2%|▏         | 9/471 [00:01<01:33,  4.93it/s]  2%|▏         | 10/471 [00:01<01:35,  4.83it/s]  2%|▏         | 11/471 [00:02<01:35,  4.79it/s]  3%|▎         | 12/471 [00:02<01:37,  4.71it/s]  3%|▎         | 13/471 [00:02<01:36,  4.75it/s]  3%|▎         | 14/471 [00:02<01:38,  4.65it/s]  3%|▎         | 15/471 [00:02<01:37,  4.67it/s]  3%|▎         | 16/471 [00:03<01:38,  4.63it/s]  4%|▎         | 17/471 [00:03<01:40,  4.51it/s]  4%|▍         | 18/471 [00:03<01:36,  4.69it/s]  4%|▍         | 19/471 [00:03<01:39,  4.53it/s]  4%|▍         | 20/471 [00:04<01:35,  4.72it/s]  4%|▍         | 21/471 [00:04<01:38,  4.55it/s]  5%|▍         | 22/471 [00:04<01:35,  4.69it/s]  5%|▍         | 23/471 [00:04<01:37,  4.59it/s]  5%|▌         | 24/471 [00:04<01:35,  4.69it/s]  5%|▌         | 25/471 [00:05<01:36,  4.60it/s]  6%|▌         | 26/471 [00:05<01:34,  4.72it/s]  6%|▌         | 27/471 [00:05<01:35,  4.64it/s]  6%|▌         | 28/471 [00:05<01:35,  4.65it/s]  6%|▌         | 29/471 [00:06<01:34,  4.65it/s]  6%|▋         | 30/471 [00:06<01:36,  4.58it/s]  7%|▋         | 31/471 [00:06<01:33,  4.69it/s]  7%|▋         | 32/471 [00:06<01:36,  4.55it/s]  7%|▋         | 33/471 [00:06<01:30,  4.82it/s]  7%|▋         | 34/471 [00:07<01:36,  4.55it/s]  7%|▋         | 35/471 [00:07<01:29,  4.86it/s]  8%|▊         | 36/471 [00:07<01:36,  4.49it/s]  8%|▊         | 37/471 [00:07<01:31,  4.73it/s]  8%|▊         | 38/471 [00:07<01:37,  4.46it/s]  8%|▊         | 39/471 [00:08<01:30,  4.76it/s]  8%|▊         | 40/471 [00:08<01:36,  4.48it/s]  9%|▊         | 41/471 [00:08<01:31,  4.72it/s]  9%|▉         | 42/471 [00:08<01:35,  4.49it/s]  9%|▉         | 43/471 [00:09<01:32,  4.63it/s]  9%|▉         | 44/471 [00:09<01:31,  4.68it/s] 10%|▉         | 45/471 [00:09<01:28,  4.82it/s] 10%|▉         | 46/471 [00:09<01:22,  5.15it/s] 10%|▉         | 47/471 [00:09<01:23,  5.06it/s] 10%|█         | 48/471 [00:09<01:13,  5.72it/s] 10%|█         | 49/471 [00:10<01:19,  5.33it/s] 11%|█         | 50/471 [00:10<01:13,  5.74it/s] 11%|█         | 51/471 [00:10<01:17,  5.45it/s] 11%|█         | 52/471 [00:10<01:15,  5.57it/s] 11%|█▏        | 53/471 [00:10<01:15,  5.51it/s] 11%|█▏        | 54/471 [00:11<01:12,  5.75it/s] 12%|█▏        | 55/471 [00:11<01:07,  6.14it/s] 12%|█▏        | 56/471 [00:11<01:06,  6.21it/s] 12%|█▏        | 57/471 [00:11<01:02,  6.66it/s] 12%|█▏        | 58/471 [00:11<01:03,  6.47it/s] 13%|█▎        | 59/471 [00:11<01:04,  6.38it/s] 13%|█▎        | 60/471 [00:11<01:10,  5.82it/s] 13%|█▎        | 61/471 [00:12<01:07,  6.05it/s] 13%|█▎        | 62/471 [00:12<01:13,  5.56it/s] 13%|█▎        | 63/471 [00:12<01:10,  5.80it/s] 14%|█▎        | 64/471 [00:12<01:14,  5.49it/s] 14%|█▍        | 65/471 [00:12<01:13,  5.50it/s] 14%|█▍        | 66/471 [00:13<01:13,  5.52it/s] 14%|█▍        | 67/471 [00:13<01:13,  5.47it/s] 14%|█▍        | 68/471 [00:13<01:12,  5.55it/s] 15%|█▍        | 69/471 [00:13<01:14,  5.42it/s] 15%|█▍        | 70/471 [00:13<01:11,  5.59it/s] 15%|█▌        | 71/471 [00:13<01:16,  5.21it/s] 15%|█▌        | 72/471 [00:14<01:17,  5.14it/s] 15%|█▌        | 73/471 [00:14<01:21,  4.89it/s] 16%|█▌        | 74/471 [00:14<01:20,  4.91it/s] 16%|█▌        | 75/471 [00:14<01:24,  4.70it/s] 16%|█▌        | 76/471 [00:15<01:23,  4.74it/s] 16%|█▋        | 77/471 [00:15<01:24,  4.65it/s] 17%|█▋        | 78/471 [00:15<01:25,  4.62it/s] 17%|█▋        | 79/471 [00:15<01:23,  4.67it/s] 17%|█▋        | 80/471 [00:15<01:25,  4.58it/s] 17%|█▋        | 81/471 [00:16<01:22,  4.75it/s] 17%|█▋        | 82/471 [00:16<01:25,  4.54it/s] 18%|█▊        | 83/471 [00:16<01:23,  4.67it/s] 18%|█▊        | 84/471 [00:16<01:24,  4.56it/s] 18%|█▊        | 85/471 [00:17<01:22,  4.68it/s] 18%|█▊        | 86/471 [00:17<01:24,  4.57it/s] 18%|█▊        | 87/471 [00:17<01:21,  4.71it/s] 19%|█▊        | 88/471 [00:17<01:24,  4.55it/s] 19%|█▉        | 89/471 [00:17<01:20,  4.76it/s] 19%|█▉        | 90/471 [00:18<01:23,  4.56it/s] 19%|█▉        | 91/471 [00:18<01:21,  4.68it/s] 20%|█▉        | 92/471 [00:18<01:21,  4.65it/s] 20%|█▉        | 93/471 [00:18<01:22,  4.56it/s] 20%|█▉        | 94/471 [00:18<01:20,  4.70it/s] 20%|██        | 95/471 [00:19<01:22,  4.55it/s] 20%|██        | 96/471 [00:19<01:18,  4.80it/s] 21%|██        | 97/471 [00:19<01:22,  4.55it/s] 21%|██        | 98/471 [00:19<01:18,  4.74it/s] 21%|██        | 99/471 [00:20<01:21,  4.56it/s] 21%|██        | 100/471 [00:20<01:18,  4.73it/s] 21%|██▏       | 101/471 [00:20<01:22,  4.46it/s] 22%|██▏       | 102/471 [00:20<01:17,  4.73it/s] 22%|██▏       | 103/471 [00:20<01:22,  4.47it/s] 22%|██▏       | 104/471 [00:21<01:17,  4.72it/s] 22%|██▏       | 105/471 [00:21<01:21,  4.50it/s] 23%|██▎       | 106/471 [00:21<01:19,  4.59it/s] 23%|██▎       | 107/471 [00:21<01:17,  4.70it/s] 23%|██▎       | 108/471 [00:21<01:19,  4.57it/s] 23%|██▎       | 109/471 [00:22<01:14,  4.84it/s] 23%|██▎       | 110/471 [00:22<01:19,  4.57it/s] 24%|██▎       | 111/471 [00:22<01:14,  4.84it/s] 24%|██▍       | 112/471 [00:22<01:18,  4.60it/s] 24%|██▍       | 113/471 [00:22<01:11,  4.99it/s] 24%|██▍       | 114/471 [00:23<01:17,  4.60it/s] 24%|██▍       | 115/471 [00:23<01:14,  4.76it/s] 25%|██▍       | 116/471 [00:23<01:16,  4.64it/s] 25%|██▍       | 117/471 [00:23<01:16,  4.65it/s] 25%|██▌       | 118/471 [00:24<01:13,  4.81it/s] 25%|██▌       | 119/471 [00:24<01:15,  4.68it/s] 25%|██▌       | 120/471 [00:24<01:10,  4.98it/s] 26%|██▌       | 121/471 [00:24<01:16,  4.57it/s] 26%|██▌       | 122/471 [00:24<01:09,  5.05it/s] 26%|██▌       | 123/471 [00:25<01:14,  4.67it/s] 26%|██▋       | 124/471 [00:25<01:13,  4.72it/s] 27%|██▋       | 125/471 [00:25<01:13,  4.71it/s] 27%|██▋       | 126/471 [00:25<01:14,  4.60it/s] 27%|██▋       | 127/471 [00:25<01:10,  4.85it/s] 27%|██▋       | 128/471 [00:26<01:13,  4.65it/s] 27%|██▋       | 129/471 [00:26<01:11,  4.77it/s] 28%|██▊       | 130/471 [00:26<01:13,  4.62it/s] 28%|██▊       | 131/471 [00:26<01:11,  4.74it/s] 28%|██▊       | 132/471 [00:27<01:13,  4.62it/s] 28%|██▊       | 133/471 [00:27<01:10,  4.82it/s] 28%|██▊       | 134/471 [00:27<01:14,  4.55it/s] 29%|██▊       | 135/471 [00:27<01:12,  4.61it/s] 29%|██▉       | 136/471 [00:27<01:13,  4.55it/s] 29%|██▉       | 137/471 [00:28<01:13,  4.52it/s] 29%|██▉       | 138/471 [00:28<01:11,  4.68it/s] 30%|██▉       | 139/471 [00:28<01:14,  4.47it/s] 30%|██▉       | 140/471 [00:28<01:09,  4.74it/s] 30%|██▉       | 141/471 [00:29<01:13,  4.50it/s] 30%|███       | 142/471 [00:29<01:07,  4.84it/s] 30%|███       | 143/471 [00:29<01:13,  4.48it/s] 31%|███       | 144/471 [00:29<01:08,  4.75it/s] 31%|███       | 145/471 [00:29<01:13,  4.47it/s] 31%|███       | 146/471 [00:30<01:08,  4.77it/s] 31%|███       | 147/471 [00:30<01:11,  4.56it/s] 31%|███▏      | 148/471 [00:30<01:09,  4.63it/s] 32%|███▏      | 149/471 [00:30<01:10,  4.59it/s] 32%|███▏      | 150/471 [00:30<01:10,  4.54it/s] 32%|███▏      | 151/471 [00:31<01:06,  4.79it/s] 32%|███▏      | 152/471 [00:31<01:06,  4.82it/s] 32%|███▏      | 153/471 [00:31<01:00,  5.22it/s] 33%|███▎      | 154/471 [00:31<01:02,  5.09it/s] 33%|███▎      | 155/471 [00:31<00:57,  5.54it/s] 33%|███▎      | 156/471 [00:32<01:00,  5.21it/s] 33%|███▎      | 157/471 [00:32<00:56,  5.56it/s] 34%|███▎      | 158/471 [00:32<00:57,  5.41it/s] 34%|███▍      | 159/471 [00:32<00:58,  5.34it/s] 34%|███▍      | 160/471 [00:32<00:55,  5.64it/s] 34%|███▍      | 161/471 [00:32<00:57,  5.37it/s] 34%|███▍      | 162/471 [00:33<00:54,  5.66it/s] 35%|███▍      | 163/471 [00:33<00:57,  5.38it/s] 35%|███▍      | 164/471 [00:33<00:53,  5.74it/s] 35%|███▌      | 165/471 [00:33<00:56,  5.40it/s] 35%|███▌      | 166/471 [00:33<00:55,  5.49it/s] 35%|███▌      | 167/471 [00:34<01:02,  4.89it/s] 36%|███▌      | 168/471 [00:34<01:00,  5.05it/s] 36%|███▌      | 169/471 [00:34<01:05,  4.64it/s] 36%|███▌      | 170/471 [00:34<01:02,  4.82it/s] 36%|███▋      | 171/471 [00:34<01:04,  4.67it/s] 37%|███▋      | 172/471 [00:35<01:03,  4.68it/s] 37%|███▋      | 173/471 [00:35<01:02,  4.77it/s] 37%|███▋      | 174/471 [00:35<01:04,  4.61it/s] 37%|███▋      | 175/471 [00:35<01:01,  4.79it/s] 37%|███▋      | 176/471 [00:36<01:05,  4.54it/s] 38%|███▊      | 177/471 [00:36<01:02,  4.72it/s] 38%|███▊      | 178/471 [00:36<01:04,  4.53it/s] 38%|███▊      | 179/471 [00:36<01:00,  4.80it/s] 38%|███▊      | 180/471 [00:36<01:04,  4.49it/s] 38%|███▊      | 181/471 [00:37<00:59,  4.84it/s] 39%|███▊      | 182/471 [00:37<01:04,  4.49it/s] 39%|███▉      | 183/471 [00:37<01:00,  4.73it/s] 39%|███▉      | 184/471 [00:37<01:02,  4.62it/s] 39%|███▉      | 185/471 [00:38<01:02,  4.59it/s] 39%|███▉      | 186/471 [00:38<01:02,  4.59it/s] 40%|███▉      | 187/471 [00:38<01:03,  4.48it/s] 40%|███▉      | 188/471 [00:38<00:58,  4.88it/s] 40%|████      | 189/471 [00:38<01:01,  4.59it/s] 40%|████      | 190/471 [00:39<00:56,  4.97it/s] 41%|████      | 191/471 [00:39<01:01,  4.55it/s] 41%|████      | 192/471 [00:39<00:56,  4.90it/s] 41%|████      | 193/471 [00:39<01:00,  4.59it/s] 41%|████      | 194/471 [00:39<00:59,  4.68it/s] 41%|████▏     | 195/471 [00:40<00:59,  4.66it/s] 42%|████▏     | 196/471 [00:40<01:00,  4.55it/s] 42%|████▏     | 197/471 [00:40<00:57,  4.78it/s] 42%|████▏     | 198/471 [00:40<00:58,  4.65it/s] 42%|████▏     | 199/471 [00:40<00:54,  4.95it/s] 42%|████▏     | 200/471 [00:41<00:59,  4.58it/s] 43%|████▎     | 201/471 [00:41<00:53,  5.03it/s] 43%|████▎     | 202/471 [00:41<00:58,  4.63it/s] 43%|████▎     | 203/471 [00:41<00:56,  4.77it/s] 43%|████▎     | 204/471 [00:42<00:58,  4.59it/s] 44%|████▎     | 205/471 [00:42<00:57,  4.60it/s] 44%|████▎     | 206/471 [00:42<00:56,  4.70it/s] 44%|████▍     | 207/471 [00:42<00:56,  4.63it/s] 44%|████▍     | 208/471 [00:42<00:55,  4.70it/s] 44%|████▍     | 209/471 [00:43<00:57,  4.55it/s] 45%|████▍     | 210/471 [00:43<00:56,  4.60it/s] 45%|████▍     | 211/471 [00:43<00:57,  4.53it/s] 45%|████▌     | 212/471 [00:43<00:55,  4.68it/s] 45%|████▌     | 213/471 [00:43<00:55,  4.65it/s] 45%|████▌     | 214/471 [00:44<00:55,  4.59it/s] 46%|████▌     | 215/471 [00:44<00:56,  4.55it/s] 46%|████▌     | 216/471 [00:44<00:55,  4.57it/s] 46%|████▌     | 217/471 [00:44<00:56,  4.49it/s] 46%|████▋     | 218/471 [00:45<00:55,  4.58it/s] 46%|████▋     | 219/471 [00:45<00:56,  4.43it/s] 47%|████▋     | 220/471 [00:45<00:55,  4.55it/s] 47%|████▋     | 221/471 [00:45<00:56,  4.42it/s] 47%|████▋     | 222/471 [00:45<00:53,  4.62it/s] 47%|████▋     | 223/471 [00:46<00:55,  4.48it/s] 48%|████▊     | 224/471 [00:46<00:53,  4.61it/s] 48%|████▊     | 225/471 [00:46<00:54,  4.48it/s] 48%|████▊     | 226/471 [00:46<00:53,  4.61it/s] 48%|████▊     | 227/471 [00:47<00:54,  4.46it/s] 48%|████▊     | 228/471 [00:47<00:52,  4.67it/s] 49%|████▊     | 229/471 [00:47<00:53,  4.52it/s] 49%|████▉     | 230/471 [00:47<00:52,  4.58it/s] 49%|████▉     | 231/471 [00:47<00:52,  4.56it/s] 49%|████▉     | 232/471 [00:48<00:52,  4.53it/s] 49%|████▉     | 233/471 [00:48<00:51,  4.63it/s] 50%|████▉     | 234/471 [00:48<00:52,  4.51it/s] 50%|████▉     | 235/471 [00:48<00:49,  4.76it/s] 50%|█████     | 236/471 [00:49<00:51,  4.56it/s] 50%|█████     | 237/471 [00:49<00:49,  4.77it/s] 51%|█████     | 238/471 [00:49<00:51,  4.56it/s] 51%|█████     | 239/471 [00:49<00:48,  4.77it/s] 51%|█████     | 240/471 [00:49<00:52,  4.44it/s] 51%|█████     | 241/471 [00:50<00:48,  4.78it/s] 51%|█████▏    | 242/471 [00:50<00:51,  4.46it/s] 52%|█████▏    | 243/471 [00:50<00:48,  4.67it/s] 52%|█████▏    | 244/471 [00:50<00:47,  4.80it/s] 52%|█████▏    | 245/471 [00:50<00:48,  4.63it/s] 52%|█████▏    | 246/471 [00:51<00:46,  4.86it/s] 52%|█████▏    | 247/471 [00:51<00:48,  4.58it/s] 53%|█████▎    | 248/471 [00:51<00:47,  4.72it/s] 53%|█████▎    | 249/471 [00:51<00:48,  4.53it/s] 53%|█████▎    | 250/471 [00:52<00:46,  4.80it/s] 53%|█████▎    | 251/471 [00:52<00:48,  4.50it/s] 54%|█████▎    | 252/471 [00:52<00:44,  4.88it/s] 54%|█████▎    | 253/471 [00:52<00:48,  4.49it/s] 54%|█████▍    | 254/471 [00:52<00:45,  4.75it/s] 54%|█████▍    | 255/471 [00:53<00:46,  4.60it/s] 54%|█████▍    | 256/471 [00:53<00:47,  4.57it/s] 55%|█████▍    | 257/471 [00:53<00:46,  4.57it/s] 55%|█████▍    | 258/471 [00:53<00:47,  4.48it/s] 55%|█████▍    | 259/471 [00:53<00:44,  4.78it/s] 55%|█████▌    | 260/471 [00:54<00:46,  4.53it/s] 55%|█████▌    | 261/471 [00:54<00:43,  4.83it/s] 56%|█████▌    | 262/471 [00:54<00:45,  4.55it/s] 56%|█████▌    | 263/471 [00:54<00:42,  4.93it/s] 56%|█████▌    | 264/471 [00:55<00:44,  4.64it/s] 56%|█████▋    | 265/471 [00:55<00:41,  4.98it/s] 56%|█████▋    | 266/471 [00:55<00:40,  5.03it/s] 57%|█████▋    | 267/471 [00:55<00:39,  5.11it/s] 57%|█████▋    | 268/471 [00:55<00:38,  5.22it/s] 57%|█████▋    | 269/471 [00:55<00:38,  5.26it/s] 57%|█████▋    | 270/471 [00:56<00:36,  5.51it/s] 58%|█████▊    | 271/471 [00:56<00:37,  5.32it/s] 58%|█████▊    | 272/471 [00:56<00:35,  5.65it/s] 58%|█████▊    | 273/471 [00:56<00:37,  5.28it/s] 58%|█████▊    | 274/471 [00:56<00:34,  5.77it/s] 58%|█████▊    | 275/471 [00:57<00:36,  5.35it/s] 59%|█████▊    | 276/471 [00:57<00:34,  5.59it/s] 59%|█████▉    | 277/471 [00:57<00:35,  5.49it/s] 59%|█████▉    | 278/471 [00:57<00:36,  5.32it/s] 59%|█████▉    | 279/471 [00:57<00:37,  5.09it/s] 59%|█████▉    | 280/471 [00:58<00:39,  4.89it/s] 60%|█████▉    | 281/471 [00:58<00:39,  4.76it/s] 60%|█████▉    | 282/471 [00:58<00:40,  4.70it/s] 60%|██████    | 283/471 [00:58<00:39,  4.71it/s] 60%|██████    | 284/471 [00:58<00:40,  4.61it/s] 61%|██████    | 285/471 [00:59<00:39,  4.70it/s] 61%|██████    | 286/471 [00:59<00:41,  4.47it/s] 61%|██████    | 287/471 [00:59<00:38,  4.74it/s] 61%|██████    | 288/471 [00:59<00:40,  4.49it/s] 61%|██████▏   | 289/471 [00:59<00:37,  4.82it/s] 62%|██████▏   | 290/471 [01:00<00:40,  4.46it/s] 62%|██████▏   | 291/471 [01:00<00:38,  4.71it/s] 62%|██████▏   | 292/471 [01:00<00:39,  4.56it/s] 62%|██████▏   | 293/471 [01:00<00:38,  4.63it/s] 62%|██████▏   | 294/471 [01:01<00:37,  4.67it/s] 63%|██████▎   | 295/471 [01:01<00:38,  4.60it/s] 63%|██████▎   | 296/471 [01:01<00:37,  4.65it/s] 63%|██████▎   | 297/471 [01:01<00:37,  4.58it/s] 63%|██████▎   | 298/471 [01:01<00:37,  4.66it/s] 63%|██████▎   | 299/471 [01:02<00:38,  4.47it/s] 64%|██████▎   | 300/471 [01:02<00:36,  4.70it/s] 64%|██████▍   | 301/471 [01:02<00:38,  4.47it/s] 64%|██████▍   | 302/471 [01:02<00:34,  4.87it/s] 64%|██████▍   | 303/471 [01:03<00:37,  4.50it/s] 65%|██████▍   | 304/471 [01:03<00:34,  4.79it/s] 65%|██████▍   | 305/471 [01:03<00:36,  4.51it/s] 65%|██████▍   | 306/471 [01:03<00:35,  4.62it/s] 65%|██████▌   | 307/471 [01:03<00:36,  4.55it/s] 65%|██████▌   | 308/471 [01:04<00:35,  4.59it/s] 66%|██████▌   | 309/471 [01:04<00:35,  4.54it/s] 66%|██████▌   | 310/471 [01:04<00:34,  4.61it/s] 66%|██████▌   | 311/471 [01:04<00:35,  4.57it/s] 66%|██████▌   | 312/471 [01:05<00:34,  4.61it/s] 66%|██████▋   | 313/471 [01:05<00:34,  4.61it/s] 67%|██████▋   | 314/471 [01:05<00:34,  4.57it/s] 67%|██████▋   | 315/471 [01:05<00:33,  4.65it/s] 67%|██████▋   | 316/471 [01:05<00:34,  4.51it/s] 67%|██████▋   | 317/471 [01:06<00:33,  4.62it/s] 68%|██████▊   | 318/471 [01:06<00:34,  4.45it/s] 68%|██████▊   | 319/471 [01:06<00:32,  4.65it/s] 68%|██████▊   | 320/471 [01:06<00:33,  4.48it/s] 68%|██████▊   | 321/471 [01:06<00:31,  4.70it/s] 68%|██████▊   | 322/471 [01:07<00:33,  4.43it/s] 69%|██████▊   | 323/471 [01:07<00:31,  4.67it/s] 69%|██████▉   | 324/471 [01:07<00:33,  4.37it/s] 69%|██████▉   | 325/471 [01:07<00:31,  4.68it/s] 69%|██████▉   | 326/471 [01:08<00:32,  4.47it/s] 69%|██████▉   | 327/471 [01:08<00:31,  4.63it/s] 70%|██████▉   | 328/471 [01:08<00:31,  4.55it/s] 70%|██████▉   | 329/471 [01:08<00:31,  4.53it/s] 70%|███████   | 330/471 [01:08<00:31,  4.53it/s] 70%|███████   | 331/471 [01:09<00:31,  4.49it/s] 70%|███████   | 332/471 [01:09<00:30,  4.62it/s] 71%|███████   | 333/471 [01:09<00:30,  4.50it/s] 71%|███████   | 334/471 [01:09<00:29,  4.63it/s] 71%|███████   | 335/471 [01:10<00:30,  4.47it/s] 71%|███████▏  | 336/471 [01:10<00:28,  4.68it/s] 72%|███████▏  | 337/471 [01:10<00:29,  4.48it/s] 72%|███████▏  | 338/471 [01:10<00:28,  4.73it/s] 72%|███████▏  | 339/471 [01:10<00:29,  4.42it/s] 72%|███████▏  | 340/471 [01:11<00:27,  4.81it/s] 72%|███████▏  | 341/471 [01:11<00:29,  4.46it/s] 73%|███████▎  | 342/471 [01:11<00:27,  4.69it/s] 73%|███████▎  | 343/471 [01:11<00:27,  4.66it/s] 73%|███████▎  | 344/471 [01:12<00:27,  4.68it/s] 73%|███████▎  | 345/471 [01:12<00:27,  4.66it/s] 73%|███████▎  | 346/471 [01:12<00:27,  4.62it/s] 74%|███████▎  | 347/471 [01:12<00:26,  4.63it/s] 74%|███████▍  | 348/471 [01:12<00:26,  4.63it/s] 74%|███████▍  | 349/471 [01:13<00:26,  4.64it/s] 74%|███████▍  | 350/471 [01:13<00:26,  4.56it/s] 75%|███████▍  | 351/471 [01:13<00:26,  4.60it/s] 75%|███████▍  | 352/471 [01:13<00:26,  4.47it/s] 75%|███████▍  | 353/471 [01:13<00:25,  4.61it/s] 75%|███████▌  | 354/471 [01:14<00:25,  4.53it/s] 75%|███████▌  | 355/471 [01:14<00:25,  4.58it/s] 76%|███████▌  | 356/471 [01:14<00:25,  4.44it/s] 76%|███████▌  | 357/471 [01:14<00:24,  4.56it/s] 76%|███████▌  | 358/471 [01:15<00:25,  4.44it/s] 76%|███████▌  | 359/471 [01:15<00:24,  4.64it/s] 76%|███████▋  | 360/471 [01:15<00:24,  4.49it/s] 77%|███████▋  | 361/471 [01:15<00:23,  4.66it/s] 77%|███████▋  | 362/471 [01:15<00:24,  4.41it/s] 77%|███████▋  | 363/471 [01:16<00:23,  4.69it/s] 77%|███████▋  | 364/471 [01:16<00:23,  4.47it/s] 77%|███████▋  | 365/471 [01:16<00:22,  4.62it/s] 78%|███████▊  | 366/471 [01:16<00:23,  4.45it/s] 78%|███████▊  | 367/471 [01:17<00:22,  4.55it/s] 78%|███████▊  | 368/471 [01:17<00:23,  4.46it/s] 78%|███████▊  | 369/471 [01:17<00:22,  4.51it/s] 79%|███████▊  | 370/471 [01:17<00:22,  4.49it/s] 79%|███████▉  | 371/471 [01:17<00:22,  4.49it/s] 79%|███████▉  | 372/471 [01:18<00:22,  4.47it/s] 79%|███████▉  | 373/471 [01:18<00:21,  4.47it/s] 79%|███████▉  | 374/471 [01:18<00:21,  4.58it/s] 80%|███████▉  | 375/471 [01:18<00:21,  4.52it/s] 80%|███████▉  | 376/471 [01:19<00:20,  4.65it/s] 80%|████████  | 377/471 [01:19<00:21,  4.45it/s] 80%|████████  | 378/471 [01:19<00:19,  4.79it/s] 80%|████████  | 379/471 [01:19<00:20,  4.52it/s] 81%|████████  | 380/471 [01:19<00:18,  4.90it/s] 81%|████████  | 381/471 [01:20<00:19,  4.54it/s] 81%|████████  | 382/471 [01:20<00:18,  4.75it/s] 81%|████████▏ | 383/471 [01:20<00:18,  4.65it/s] 82%|████████▏ | 384/471 [01:20<00:19,  4.56it/s] 82%|████████▏ | 385/471 [01:20<00:18,  4.56it/s] 82%|████████▏ | 386/471 [01:21<00:18,  4.50it/s] 82%|████████▏ | 387/471 [01:21<00:17,  4.68it/s] 82%|████████▏ | 388/471 [01:21<00:18,  4.59it/s] 83%|████████▎ | 389/471 [01:21<00:16,  4.83it/s] 83%|████████▎ | 390/471 [01:22<00:18,  4.48it/s] 83%|████████▎ | 391/471 [01:22<00:16,  4.92it/s] 83%|████████▎ | 392/471 [01:22<00:17,  4.52it/s] 83%|████████▎ | 393/471 [01:22<00:16,  4.82it/s] 84%|████████▎ | 394/471 [01:22<00:16,  4.60it/s] 84%|████████▍ | 395/471 [01:23<00:16,  4.61it/s] 84%|████████▍ | 396/471 [01:23<00:15,  4.74it/s] 84%|████████▍ | 397/471 [01:23<00:16,  4.51it/s] 85%|████████▍ | 398/471 [01:23<00:15,  4.74it/s] 85%|████████▍ | 399/471 [01:24<00:15,  4.50it/s] 85%|████████▍ | 400/471 [01:24<00:14,  4.78it/s] 85%|████████▌ | 401/471 [01:24<00:15,  4.56it/s] 85%|████████▌ | 402/471 [01:24<00:14,  4.83it/s] 86%|████████▌ | 403/471 [01:24<00:15,  4.50it/s] 86%|████████▌ | 404/471 [01:25<00:14,  4.75it/s] 86%|████████▌ | 405/471 [01:25<00:14,  4.51it/s] 86%|████████▌ | 406/471 [01:25<00:14,  4.62it/s] 86%|████████▋ | 407/471 [01:25<00:13,  4.64it/s] 87%|████████▋ | 408/471 [01:25<00:13,  4.54it/s] 87%|████████▋ | 409/471 [01:26<00:12,  4.81it/s] 87%|████████▋ | 410/471 [01:26<00:13,  4.50it/s] 87%|████████▋ | 411/471 [01:26<00:11,  5.07it/s] 87%|████████▋ | 412/471 [01:26<00:12,  4.60it/s] 88%|████████▊ | 413/471 [01:26<00:12,  4.82it/s] 88%|████████▊ | 414/471 [01:27<00:12,  4.47it/s] 88%|████████▊ | 415/471 [01:27<00:12,  4.64it/s] 88%|████████▊ | 416/471 [01:27<00:11,  4.62it/s] 89%|████████▊ | 417/471 [01:27<00:11,  4.52it/s] 89%|████████▊ | 418/471 [01:28<00:11,  4.65it/s] 89%|████████▉ | 419/471 [01:28<00:11,  4.64it/s] 89%|████████▉ | 420/471 [01:28<00:10,  4.65it/s] 89%|████████▉ | 421/471 [01:28<00:10,  4.57it/s] 90%|████████▉ | 422/471 [01:28<00:10,  4.69it/s] 90%|████████▉ | 423/471 [01:29<00:10,  4.54it/s] 90%|█████████ | 424/471 [01:29<00:09,  4.74it/s] 90%|█████████ | 425/471 [01:29<00:10,  4.57it/s] 90%|█████████ | 426/471 [01:29<00:09,  4.75it/s] 91%|█████████ | 427/471 [01:30<00:09,  4.51it/s] 91%|█████████ | 428/471 [01:30<00:09,  4.56it/s] 91%|█████████ | 429/471 [01:30<00:09,  4.59it/s] 91%|█████████▏| 430/471 [01:30<00:09,  4.54it/s] 92%|█████████▏| 431/471 [01:30<00:08,  4.67it/s] 92%|█████████▏| 432/471 [01:31<00:08,  4.53it/s] 92%|█████████▏| 433/471 [01:31<00:08,  4.57it/s] 92%|█████████▏| 434/471 [01:31<00:08,  4.51it/s] 92%|█████████▏| 435/471 [01:31<00:07,  4.64it/s] 93%|█████████▎| 436/471 [01:32<00:07,  4.54it/s] 93%|█████████▎| 437/471 [01:32<00:07,  4.69it/s] 93%|█████████▎| 438/471 [01:32<00:07,  4.53it/s] 93%|█████████▎| 439/471 [01:32<00:06,  4.73it/s] 93%|█████████▎| 440/471 [01:32<00:06,  4.49it/s] 94%|█████████▎| 441/471 [01:33<00:06,  4.62it/s] 94%|█████████▍| 442/471 [01:33<00:06,  4.59it/s] 94%|█████████▍| 443/471 [01:33<00:06,  4.51it/s] 94%|█████████▍| 444/471 [01:33<00:05,  4.69it/s] 94%|█████████▍| 445/471 [01:33<00:05,  4.48it/s] 95%|█████████▍| 446/471 [01:34<00:05,  4.65it/s] 95%|█████████▍| 447/471 [01:34<00:05,  4.45it/s] 95%|█████████▌| 448/471 [01:34<00:04,  4.69it/s] 95%|█████████▌| 449/471 [01:34<00:04,  4.60it/s] 96%|█████████▌| 450/471 [01:35<00:04,  4.66it/s] 96%|█████████▌| 451/471 [01:35<00:04,  4.59it/s] 96%|█████████▌| 452/471 [01:35<00:04,  4.66it/s] 96%|█████████▌| 453/471 [01:35<00:03,  4.57it/s] 96%|█████████▋| 454/471 [01:35<00:03,  4.68it/s] 97%|█████████▋| 455/471 [01:36<00:03,  4.54it/s] 97%|█████████▋| 456/471 [01:36<00:03,  4.58it/s] 97%|█████████▋| 457/471 [01:36<00:03,  4.65it/s] 97%|█████████▋| 458/471 [01:36<00:02,  4.60it/s] 97%|█████████▋| 459/471 [01:36<00:02,  4.69it/s] 98%|█████████▊| 460/471 [01:37<00:02,  4.54it/s] 98%|█████████▊| 461/471 [01:37<00:02,  4.59it/s] 98%|█████████▊| 462/471 [01:37<00:01,  4.52it/s] 98%|█████████▊| 463/471 [01:37<00:01,  4.66it/s] 99%|█████████▊| 464/471 [01:38<00:01,  4.56it/s] 99%|█████████▊| 465/471 [01:38<00:01,  4.69it/s] 99%|█████████▉| 466/471 [01:38<00:01,  4.51it/s] 99%|█████████▉| 467/471 [01:38<00:00,  4.70it/s] 99%|█████████▉| 468/471 [01:38<00:00,  4.52it/s]100%|█████████▉| 469/471 [01:39<00:00,  4.61it/s]100%|█████████▉| 470/471 [01:39<00:00,  4.61it/s]100%|██████████| 471/471 [01:39<00:00,  4.77it/s]100%|██████████| 471/471 [01:39<00:00,  4.73it/s]
{'eval_loss': 2.7975456714630127, 'eval_model_preparation_time': 0.0052, 'eval_acc': 0.2299522039298991, 'eval_runtime': 99.8298, 'eval_samples_per_second': 75.448, 'eval_steps_per_second': 4.718}
ROUND:2
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.9558, 'grad_norm': 3.2256531715393066, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.9103, 'grad_norm': 2.661472797393799, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]  8%|▊         | 3/40 [00:01<00:17,  2.16it/s]                                              {'loss': 2.765, 'grad_norm': 1.986297845840454, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.16it/s] 10%|█         | 4/40 [00:01<00:16,  2.14it/s]                                              {'loss': 2.7877, 'grad_norm': 1.7527589797973633, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.14it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.14it/s]                                              {'loss': 2.8661, 'grad_norm': 2.359825372695923, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.14it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s]                                              {'loss': 2.7044, 'grad_norm': 2.390782594680786, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 2.8035, 'grad_norm': 2.73482084274292, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s] 20%|██        | 8/40 [00:03<00:11,  2.85it/s]                                              {'loss': 2.2594, 'grad_norm': 11.563672065734863, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.85it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s]                                              {'loss': 2.7762, 'grad_norm': 2.473025321960449, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.5829, 'grad_norm': 2.4780383110046387, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s]                                               {'loss': 2.7211, 'grad_norm': 2.3562381267547607, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s] 30%|███       | 12/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.6981, 'grad_norm': 3.2661139965057373, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.34it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s]                                               {'loss': 2.7946, 'grad_norm': 2.4201908111572266, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.6795, 'grad_norm': 2.1086902618408203, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.7732, 'grad_norm': 2.3487987518310547, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 2.4741, 'grad_norm': 7.787983417510986, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s]                                               {'loss': 2.5367, 'grad_norm': 2.00766921043396, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.41it/s]                                               {'loss': 2.696, 'grad_norm': 2.278050422668457, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.41it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.31it/s]                                               {'loss': 2.8473, 'grad_norm': 2.6292824745178223, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:09,  2.31it/s] 50%|█████     | 20/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.6302, 'grad_norm': 2.399487257003784, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.27it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.22it/s]                                               {'loss': 2.7067, 'grad_norm': 2.400632381439209, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.22it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.19it/s]                                               {'loss': 2.674, 'grad_norm': 2.317737579345703, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.19it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.17it/s]                                               {'loss': 2.516, 'grad_norm': 2.5829460620880127, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.17it/s] 60%|██████    | 24/40 [00:10<00:05,  2.76it/s]                                               {'loss': 2.3607, 'grad_norm': 7.7701568603515625, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.76it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.6466, 'grad_norm': 2.4110615253448486, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.53it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.575, 'grad_norm': 2.3152666091918945, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.39it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.30it/s]                                               {'loss': 2.7121, 'grad_norm': 2.574338436126709, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.30it/s] 70%|███████   | 28/40 [00:11<00:05,  2.24it/s]                                               {'loss': 2.6967, 'grad_norm': 2.069861888885498, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.24it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.20it/s]                                               {'loss': 2.6174, 'grad_norm': 2.8487069606781006, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.20it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.16it/s]                                               {'loss': 2.4732, 'grad_norm': 3.1252009868621826, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.16it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.16it/s]                                               {'loss': 2.5804, 'grad_norm': 2.954972505569458, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.16it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 2.7331, 'grad_norm': 9.714508056640625, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.6147, 'grad_norm': 2.2797670364379883, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s]                                               {'loss': 2.6215, 'grad_norm': 3.0658438205718994, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s]                                               {'loss': 2.484, 'grad_norm': 2.2802371978759766, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.34it/s]                                               {'loss': 2.618, 'grad_norm': 2.8531370162963867, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.34it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s]                                               {'loss': 2.4725, 'grad_norm': 2.481091022491455, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.24it/s]                                               {'loss': 2.6338, 'grad_norm': 2.4634745121002197, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.24it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.5894, 'grad_norm': 2.543423891067505, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'loss': 2.3957, 'grad_norm': 9.592452049255371, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'train_runtime': 16.9433, 'train_samples_per_second': 33.346, 'train_steps_per_second': 2.361, 'train_loss': 2.649583238363266, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]100%|██████████| 40/40 [00:16<00:00,  2.36it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.38it/s]                                              {'loss': 2.7123, 'grad_norm': 2.148793935775757, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.38it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 2.9349, 'grad_norm': 2.124321699142456, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:01<00:22,  1.63it/s]                                              {'loss': 2.7159, 'grad_norm': 2.5770678520202637, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.63it/s] 10%|█         | 4/40 [00:02<00:19,  1.84it/s]                                              {'loss': 2.8114, 'grad_norm': 2.282989978790283, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.84it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s]                                              {'loss': 2.7271, 'grad_norm': 2.1760141849517822, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.09it/s]                                              {'loss': 2.8348, 'grad_norm': 2.2406864166259766, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.09it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s]                                              {'loss': 2.7225, 'grad_norm': 2.524911642074585, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s] 20%|██        | 8/40 [00:04<00:16,  1.99it/s]                                              {'loss': 3.0155, 'grad_norm': 7.401751518249512, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.99it/s] 22%|██▎       | 9/40 [00:04<00:15,  2.05it/s]                                              {'loss': 2.8035, 'grad_norm': 2.340491533279419, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:15,  2.05it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s]                                               {'loss': 2.6687, 'grad_norm': 1.9489250183105469, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.12it/s]                                               {'loss': 2.555, 'grad_norm': 3.521939277648926, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.12it/s] 30%|███       | 12/40 [00:06<00:13,  2.13it/s]                                               {'loss': 2.7537, 'grad_norm': 2.3600239753723145, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:13,  2.13it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.14it/s]                                               {'loss': 2.576, 'grad_norm': 2.2555429935455322, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.14it/s] 35%|███▌      | 14/40 [00:07<00:12,  2.16it/s]                                               {'loss': 2.6161, 'grad_norm': 2.1818888187408447, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:12,  2.16it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s]                                               {'loss': 2.6878, 'grad_norm': 2.341106414794922, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s] 40%|████      | 16/40 [00:07<00:08,  2.77it/s]                                               {'loss': 3.1199, 'grad_norm': 8.738184928894043, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.77it/s] 42%|████▎     | 17/40 [00:08<00:08,  2.57it/s]                                               {'loss': 2.565, 'grad_norm': 2.4419026374816895, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:08<00:09,  2.44it/s]                                               {'loss': 2.3853, 'grad_norm': 2.746985912322998, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.33it/s]                                               {'loss': 2.681, 'grad_norm': 2.4956960678100586, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:09,  2.33it/s] 50%|█████     | 20/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.6311, 'grad_norm': 2.2869112491607666, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.25it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.20it/s]                                               {'loss': 2.617, 'grad_norm': 2.3678324222564697, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.20it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.18it/s]                                               {'loss': 2.696, 'grad_norm': 2.6905062198638916, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.18it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s]                                               {'loss': 2.6148, 'grad_norm': 2.9012527465820312, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s] 60%|██████    | 24/40 [00:11<00:05,  2.76it/s]                                               {'loss': 2.8066, 'grad_norm': 9.81663990020752, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:05,  2.76it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.55it/s]                                               {'loss': 2.4679, 'grad_norm': 2.1072826385498047, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.55it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.45it/s]                                               {'loss': 2.5294, 'grad_norm': 2.2461533546447754, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.45it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.34it/s]                                               {'loss': 2.6539, 'grad_norm': 2.1881701946258545, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.34it/s] 70%|███████   | 28/40 [00:12<00:05,  2.28it/s]                                               {'loss': 2.5361, 'grad_norm': 2.3994648456573486, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.28it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.23it/s]                                               {'loss': 2.4701, 'grad_norm': 3.011697769165039, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.23it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.19it/s]                                               {'loss': 2.6428, 'grad_norm': 2.2699131965637207, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.19it/s] 78%|███████▊  | 31/40 [00:14<00:04,  2.20it/s]                                               {'loss': 2.4321, 'grad_norm': 2.5243632793426514, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:04,  2.20it/s] 80%|████████  | 32/40 [00:14<00:02,  2.83it/s]                                               {'loss': 2.6848, 'grad_norm': 9.824186325073242, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.83it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.56it/s]                                               {'loss': 2.5261, 'grad_norm': 2.103515386581421, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.56it/s] 85%|████████▌ | 34/40 [00:15<00:02,  2.43it/s]                                               {'loss': 2.2014, 'grad_norm': 2.4223055839538574, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:15<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.36it/s]                                               {'loss': 2.4887, 'grad_norm': 2.2704834938049316, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.36it/s] 90%|█████████ | 36/40 [00:16<00:01,  2.30it/s]                                               {'loss': 2.6459, 'grad_norm': 2.3612875938415527, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:16<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.26it/s]                                               {'loss': 2.4799, 'grad_norm': 2.4875986576080322, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:17<00:00,  2.24it/s]                                               {'loss': 2.6211, 'grad_norm': 2.0556352138519287, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:17<00:00,  2.24it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.21it/s]                                               {'loss': 2.5928, 'grad_norm': 2.9245223999023438, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.21it/s]100%|██████████| 40/40 [00:17<00:00,  2.80it/s]                                               {'loss': 2.369, 'grad_norm': 9.402782440185547, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.80it/s]                                               {'train_runtime': 17.8532, 'train_samples_per_second': 31.647, 'train_steps_per_second': 2.24, 'train_loss': 2.639842081069946, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.80it/s]100%|██████████| 40/40 [00:17<00:00,  2.24it/s]
CLIENT:46
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.17it/s]                                              {'loss': 2.7043, 'grad_norm': 2.5513598918914795, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.17it/s]  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]                                              {'loss': 2.716, 'grad_norm': 1.996510624885559, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]  8%|▊         | 3/40 [00:01<00:17,  2.14it/s]                                              {'loss': 2.8993, 'grad_norm': 2.1223974227905273, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.14it/s] 10%|█         | 4/40 [00:01<00:16,  2.14it/s]                                              {'loss': 2.7534, 'grad_norm': 2.0518362522125244, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.14it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s]                                              {'loss': 2.7314, 'grad_norm': 2.174633026123047, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s] 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.8105, 'grad_norm': 1.9223674535751343, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.8063, 'grad_norm': 3.776589870452881, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s] 20%|██        | 8/40 [00:03<00:11,  2.80it/s]                                              {'loss': 2.8949, 'grad_norm': 8.507259368896484, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.80it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s]                                              {'loss': 2.6852, 'grad_norm': 2.5319595336914062, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s]                                               {'loss': 2.7741, 'grad_norm': 2.23447322845459, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.31it/s]                                               {'loss': 2.7469, 'grad_norm': 2.0839571952819824, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.31it/s] 30%|███       | 12/40 [00:05<00:12,  2.26it/s]                                               {'loss': 2.7085, 'grad_norm': 2.0497426986694336, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.6348, 'grad_norm': 2.413156509399414, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.5342, 'grad_norm': 2.2640950679779053, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.7265, 'grad_norm': 2.186600685119629, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s] 40%|████      | 16/40 [00:06<00:08,  2.79it/s]                                               {'loss': 2.9253, 'grad_norm': 9.933889389038086, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.79it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.4554, 'grad_norm': 2.2850568294525146, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.6742, 'grad_norm': 2.3146779537200928, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.6418, 'grad_norm': 2.5651509761810303, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.5785, 'grad_norm': 2.0776724815368652, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.28it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.578, 'grad_norm': 2.105151891708374, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s]                                               {'loss': 2.4617, 'grad_norm': 2.2465028762817383, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s]                                               {'loss': 2.756, 'grad_norm': 2.4897620677948, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s] 60%|██████    | 24/40 [00:10<00:05,  2.81it/s]                                               {'loss': 2.4551, 'grad_norm': 11.613438606262207, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.55it/s]                                               {'loss': 2.4164, 'grad_norm': 2.5611140727996826, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.55it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.41it/s]                                               {'loss': 2.3917, 'grad_norm': 2.128246545791626, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.41it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.31it/s]                                               {'loss': 2.7406, 'grad_norm': 2.7931525707244873, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.31it/s] 70%|███████   | 28/40 [00:12<00:05,  2.24it/s]                                               {'loss': 2.5962, 'grad_norm': 2.4252853393554688, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.24it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.22it/s]                                               {'loss': 2.5965, 'grad_norm': 2.3087220191955566, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.22it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.19it/s]                                               {'loss': 2.514, 'grad_norm': 2.0813724994659424, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.19it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s]                                               {'loss': 2.5274, 'grad_norm': 2.4841387271881104, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s] 80%|████████  | 32/40 [00:13<00:02,  2.85it/s]                                               {'loss': 2.3893, 'grad_norm': 12.085055351257324, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.5022, 'grad_norm': 2.219982624053955, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.48it/s]                                               {'loss': 2.4641, 'grad_norm': 2.171804428100586, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.48it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s]                                               {'loss': 2.5208, 'grad_norm': 2.8944828510284424, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.35it/s]                                               {'loss': 2.4295, 'grad_norm': 1.9828130006790161, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.35it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s]                                               {'loss': 2.6469, 'grad_norm': 2.228942394256592, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.27it/s]                                               {'loss': 2.4708, 'grad_norm': 2.3571503162384033, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.27it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]                                               {'loss': 2.5941, 'grad_norm': 2.188129186630249, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'loss': 2.8504, 'grad_norm': 10.798340797424316, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'train_runtime': 16.9601, 'train_samples_per_second': 33.313, 'train_steps_per_second': 2.358, 'train_loss': 2.632574290037155, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]100%|██████████| 40/40 [00:16<00:00,  2.36it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.7727, 'grad_norm': 2.090841293334961, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.18it/s]  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]                                              {'loss': 2.7103, 'grad_norm': 2.096329927444458, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]  8%|▊         | 3/40 [00:01<00:17,  2.15it/s]                                              {'loss': 2.7462, 'grad_norm': 2.4624037742614746, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.15it/s] 10%|█         | 4/40 [00:01<00:15,  2.28it/s]                                              {'loss': 2.8168, 'grad_norm': 3.0767312049865723, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.28it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.38it/s]                                              {'loss': 2.8066, 'grad_norm': 2.8164045810699463, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.38it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.43it/s]                                              {'loss': 2.7177, 'grad_norm': 2.5471749305725098, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.43it/s] 18%|█▊        | 7/40 [00:02<00:13,  2.46it/s]                                              {'loss': 2.7667, 'grad_norm': 2.1921417713165283, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:13,  2.46it/s]                                              {'loss': 2.8353, 'grad_norm': 9.192883491516113, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:13,  2.46it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.13it/s]                                              {'loss': 2.7771, 'grad_norm': 2.1385223865509033, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.13it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.11it/s]                                               {'loss': 2.7231, 'grad_norm': 2.7788138389587402, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.11it/s] 28%|██▊       | 11/40 [00:04<00:09,  3.08it/s]                                               {'loss': 2.7944, 'grad_norm': 2.6522865295410156, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:09,  3.08it/s] 30%|███       | 12/40 [00:04<00:09,  2.91it/s]                                               {'loss': 2.7182, 'grad_norm': 2.894793748855591, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.91it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.79it/s]                                               {'loss': 2.6487, 'grad_norm': 2.4141061305999756, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.79it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.70it/s]                                               {'loss': 2.6835, 'grad_norm': 2.408148765563965, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.70it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.66it/s]                                               {'loss': 2.6131, 'grad_norm': 1.9755709171295166, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.66it/s]                                               {'loss': 1.8855, 'grad_norm': 7.724570274353027, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:09,  2.66it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.25it/s]                                               {'loss': 2.6454, 'grad_norm': 2.6768438816070557, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.25it/s] 45%|████▌     | 18/40 [00:06<00:07,  2.93it/s]                                               {'loss': 2.7138, 'grad_norm': 2.2363059520721436, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:07,  2.93it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.69it/s]                                               {'loss': 2.6594, 'grad_norm': 2.341364860534668, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.69it/s] 50%|█████     | 20/40 [00:07<00:07,  2.53it/s]                                               {'loss': 2.5446, 'grad_norm': 2.283633232116699, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.53it/s] 52%|█████▎    | 21/40 [00:07<00:07,  2.41it/s]                                               {'loss': 2.6445, 'grad_norm': 2.26242995262146, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:07,  2.41it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.33it/s]                                               {'loss': 2.5882, 'grad_norm': 2.4619686603546143, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.33it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.27it/s]                                               {'loss': 2.5295, 'grad_norm': 3.2244818210601807, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.86it/s]                                               {'loss': 2.6868, 'grad_norm': 13.961101531982422, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.86it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.63it/s]                                               {'loss': 2.5944, 'grad_norm': 2.046868324279785, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.51it/s]                                               {'loss': 2.6476, 'grad_norm': 2.3555445671081543, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.42it/s]                                               {'loss': 2.6398, 'grad_norm': 2.4289605617523193, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.42it/s] 70%|███████   | 28/40 [00:10<00:05,  2.38it/s]                                               {'loss': 2.6702, 'grad_norm': 2.348193407058716, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.38it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s]                                               {'loss': 2.4819, 'grad_norm': 2.923645496368408, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.30it/s]                                               {'loss': 2.4667, 'grad_norm': 2.656606674194336, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s]                                               {'loss': 2.5896, 'grad_norm': 2.3438308238983154, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s] 80%|████████  | 32/40 [00:12<00:02,  2.85it/s]                                               {'loss': 2.9993, 'grad_norm': 7.629685878753662, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.61it/s]                                               {'loss': 2.6175, 'grad_norm': 2.2195122241973877, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.61it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.48it/s]                                               {'loss': 2.6832, 'grad_norm': 2.3215205669403076, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.48it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.43it/s]                                               {'loss': 2.3248, 'grad_norm': 2.268861770629883, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s]                                               {'loss': 2.708, 'grad_norm': 2.936998128890991, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.35it/s]                                               {'loss': 2.4971, 'grad_norm': 2.7495996952056885, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.35it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.32it/s]                                               {'loss': 2.5272, 'grad_norm': 2.4970943927764893, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.32it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.27it/s]                                               {'loss': 2.5202, 'grad_norm': 2.2819440364837646, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.27it/s]100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'loss': 2.9517, 'grad_norm': 12.060147285461426, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'train_runtime': 15.6523, 'train_samples_per_second': 36.097, 'train_steps_per_second': 2.556, 'train_loss': 2.6486766576766967, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]100%|██████████| 40/40 [00:15<00:00,  2.56it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.12it/s]                                              {'loss': 2.8704, 'grad_norm': 2.5309829711914062, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.12it/s]  5%|▌         | 2/40 [00:00<00:17,  2.11it/s]                                              {'loss': 2.7319, 'grad_norm': 2.1689374446868896, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.11it/s]  8%|▊         | 3/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.986, 'grad_norm': 2.494210958480835, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.12it/s] 10%|█         | 4/40 [00:01<00:16,  2.12it/s]                                              {'loss': 2.8936, 'grad_norm': 1.9853816032409668, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.12it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.11it/s]                                              {'loss': 2.7551, 'grad_norm': 2.1822686195373535, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.11it/s] 15%|█▌        | 6/40 [00:02<00:16,  2.11it/s]                                              {'loss': 2.7247, 'grad_norm': 2.269408702850342, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:16,  2.11it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s]                                              {'loss': 2.816, 'grad_norm': 2.299715757369995, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s]                                              {'loss': 2.8401, 'grad_norm': 8.39356517791748, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:15,  2.11it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s]                                              {'loss': 2.7112, 'grad_norm': 2.292881965637207, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.64it/s]                                               {'loss': 2.7087, 'grad_norm': 2.240586996078491, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.64it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.60it/s]                                               {'loss': 2.7609, 'grad_norm': 2.2963368892669678, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.60it/s] 30%|███       | 12/40 [00:05<00:10,  2.58it/s]                                               {'loss': 2.708, 'grad_norm': 2.2469937801361084, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:10,  2.58it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.55it/s]                                               {'loss': 2.7193, 'grad_norm': 3.0589487552642822, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.55it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.54it/s]                                               {'loss': 2.6788, 'grad_norm': 2.403385877609253, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.54it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.55it/s]                                               {'loss': 2.6156, 'grad_norm': 2.195082664489746, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.55it/s]                                               {'loss': 2.4831, 'grad_norm': 8.810168266296387, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:09,  2.55it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.17it/s]                                               {'loss': 2.6669, 'grad_norm': 2.48909068107605, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.17it/s] 45%|████▌     | 18/40 [00:07<00:07,  2.97it/s]                                               {'loss': 2.6002, 'grad_norm': 2.5222675800323486, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  2.97it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.70it/s]                                               {'loss': 2.6314, 'grad_norm': 2.748279571533203, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.70it/s] 50%|█████     | 20/40 [00:07<00:07,  2.54it/s]                                               {'loss': 2.6335, 'grad_norm': 2.3016726970672607, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.54it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.41it/s]                                               {'loss': 2.6171, 'grad_norm': 2.2701542377471924, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.41it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.33it/s]                                               {'loss': 2.6345, 'grad_norm': 2.154447078704834, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.33it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.5323, 'grad_norm': 2.897277355194092, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.88it/s]                                               {'loss': 2.6734, 'grad_norm': 9.38099193572998, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.62it/s]                                               {'loss': 2.5144, 'grad_norm': 2.1233768463134766, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s]                                               {'loss': 2.7139, 'grad_norm': 2.4206385612487793, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.42it/s]                                               {'loss': 2.6051, 'grad_norm': 2.0976996421813965, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.42it/s] 70%|███████   | 28/40 [00:11<00:05,  2.36it/s]                                               {'loss': 2.5515, 'grad_norm': 2.4502127170562744, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.36it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s]                                               {'loss': 2.5959, 'grad_norm': 2.6960091590881348, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.26it/s]                                               {'loss': 2.5471, 'grad_norm': 2.5491721630096436, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.26it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.23it/s]                                               {'loss': 2.6346, 'grad_norm': 2.8570845127105713, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.23it/s] 80%|████████  | 32/40 [00:12<00:02,  2.79it/s]                                               {'loss': 1.6933, 'grad_norm': 7.9614691734313965, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.79it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s]                                               {'loss': 2.5531, 'grad_norm': 2.2851133346557617, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s]                                               {'loss': 2.6058, 'grad_norm': 2.71842622756958, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s]                                               {'loss': 2.4972, 'grad_norm': 2.0317721366882324, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.6507, 'grad_norm': 2.7994372844696045, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s]                                               {'loss': 2.7447, 'grad_norm': 2.57733154296875, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s]                                               {'loss': 2.5842, 'grad_norm': 3.359867572784424, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.27it/s]                                               {'loss': 2.5394, 'grad_norm': 2.3989670276641846, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.27it/s]100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'loss': 2.7636, 'grad_norm': 10.490394592285156, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'train_runtime': 16.2416, 'train_samples_per_second': 34.787, 'train_steps_per_second': 2.463, 'train_loss': 2.6446878910064697, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]100%|██████████| 40/40 [00:16<00:00,  2.46it/s]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.7222, 'grad_norm': 2.364227056503296, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.7221, 'grad_norm': 2.154829502105713, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.8583, 'grad_norm': 2.2943878173828125, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.20it/s] 10%|█         | 4/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.949, 'grad_norm': 2.452467918395996, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.19it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.742, 'grad_norm': 1.902766466140747, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.9423, 'grad_norm': 2.404456615447998, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 2.9435, 'grad_norm': 2.8301215171813965, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s] 20%|██        | 8/40 [00:03<00:11,  2.86it/s]                                              {'loss': 2.511, 'grad_norm': 8.199028015136719, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.86it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s]                                              {'loss': 2.7537, 'grad_norm': 2.283013343811035, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.742, 'grad_norm': 1.991530179977417, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s]                                               {'loss': 2.7606, 'grad_norm': 2.4634757041931152, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s] 30%|███       | 12/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.7694, 'grad_norm': 1.975191593170166, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.34it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.6762, 'grad_norm': 2.3734166622161865, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.34it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.30it/s]                                               {'loss': 2.6588, 'grad_norm': 1.9315685033798218, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.30it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.7616, 'grad_norm': 2.376645088195801, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s] 40%|████      | 16/40 [00:06<00:08,  2.84it/s]                                               {'loss': 2.747, 'grad_norm': 16.740633010864258, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.84it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.7174, 'grad_norm': 2.840416669845581, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.6431, 'grad_norm': 2.4835827350616455, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s]                                               {'loss': 2.7098, 'grad_norm': 2.720357656478882, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s] 50%|█████     | 20/40 [00:08<00:08,  2.47it/s]                                               {'loss': 2.6011, 'grad_norm': 3.462111473083496, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.47it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.54it/s]                                               {'loss': 2.5054, 'grad_norm': 2.000607967376709, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.54it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.55it/s]                                               {'loss': 2.6991, 'grad_norm': 1.9970115423202515, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.55it/s] 57%|█████▊    | 23/40 [00:09<00:06,  2.55it/s]                                               {'loss': 2.5255, 'grad_norm': 2.6650919914245605, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:06,  2.55it/s] 60%|██████    | 24/40 [00:09<00:04,  3.28it/s]                                               {'loss': 2.6567, 'grad_norm': 6.587665557861328, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:04,  3.28it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.03it/s]                                               {'loss': 2.5778, 'grad_norm': 2.3502161502838135, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.03it/s] 65%|██████▌   | 26/40 [00:10<00:04,  2.90it/s]                                               {'loss': 2.6258, 'grad_norm': 2.06295108795166, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  2.90it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.79it/s]                                               {'loss': 2.4698, 'grad_norm': 2.1723473072052, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.79it/s] 70%|███████   | 28/40 [00:11<00:04,  2.62it/s]                                               {'loss': 2.6376, 'grad_norm': 2.6274774074554443, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.62it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.50it/s]                                               {'loss': 2.7073, 'grad_norm': 2.2677910327911377, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.50it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.38it/s]                                               {'loss': 2.5185, 'grad_norm': 2.3842716217041016, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.38it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s]                                               {'loss': 2.5638, 'grad_norm': 2.237534761428833, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s] 80%|████████  | 32/40 [00:12<00:02,  2.92it/s]                                               {'loss': 3.2351, 'grad_norm': 10.175881385803223, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.92it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.71it/s]                                               {'loss': 2.6036, 'grad_norm': 2.2294812202453613, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.71it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.58it/s]                                               {'loss': 2.5569, 'grad_norm': 2.251807689666748, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.58it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.47it/s]                                               {'loss': 2.6399, 'grad_norm': 3.02204966545105, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.47it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.5597, 'grad_norm': 2.1625123023986816, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.29it/s]                                               {'loss': 2.5985, 'grad_norm': 2.6421425342559814, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s]                                               {'loss': 2.5336, 'grad_norm': 2.7143304347991943, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.20it/s]                                               {'loss': 2.5063, 'grad_norm': 2.699272632598877, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.20it/s]100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'loss': 2.5413, 'grad_norm': 8.209107398986816, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'train_runtime': 16.1163, 'train_samples_per_second': 35.058, 'train_steps_per_second': 2.482, 'train_loss': 2.6798328399658202, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]100%|██████████| 40/40 [00:16<00:00,  2.48it/s]
CLIENT:23
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]                                              {'loss': 2.8587, 'grad_norm': 2.2705273628234863, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]  5%|▌         | 2/40 [00:00<00:17,  2.13it/s]                                              {'loss': 2.752, 'grad_norm': 2.046159267425537, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.13it/s]  8%|▊         | 3/40 [00:01<00:17,  2.11it/s]                                              {'loss': 2.8759, 'grad_norm': 2.379746437072754, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.11it/s] 10%|█         | 4/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.7916, 'grad_norm': 2.446063995361328, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:17,  2.12it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.11it/s]                                              {'loss': 2.7429, 'grad_norm': 2.6831555366516113, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.11it/s] 15%|█▌        | 6/40 [00:02<00:16,  2.11it/s]                                              {'loss': 2.7253, 'grad_norm': 2.400966167449951, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:16,  2.11it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s]                                              {'loss': 2.7068, 'grad_norm': 3.4588561058044434, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s] 20%|██        | 8/40 [00:03<00:11,  2.81it/s]                                              {'loss': 2.804, 'grad_norm': 11.072519302368164, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.81it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.57it/s]                                              {'loss': 2.7229, 'grad_norm': 2.7442784309387207, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.57it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s]                                               {'loss': 2.7198, 'grad_norm': 3.4899816513061523, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s]                                               {'loss': 2.661, 'grad_norm': 3.4237589836120605, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s] 30%|███       | 12/40 [00:05<00:12,  2.26it/s]                                               {'loss': 2.6743, 'grad_norm': 2.1932990550994873, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.22it/s]                                               {'loss': 2.6022, 'grad_norm': 2.334836006164551, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.22it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.7154, 'grad_norm': 2.5641403198242188, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s]                                               {'loss': 2.6894, 'grad_norm': 2.419069528579712, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s] 40%|████      | 16/40 [00:06<00:08,  2.83it/s]                                               {'loss': 2.1961, 'grad_norm': 12.068490982055664, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.83it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s]                                               {'loss': 2.5403, 'grad_norm': 2.5455493927001953, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.66, 'grad_norm': 2.531830310821533, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.6361, 'grad_norm': 2.2132887840270996, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.39it/s] 50%|█████     | 20/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.5299, 'grad_norm': 2.4068751335144043, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.32it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.27it/s]                                               {'loss': 2.5541, 'grad_norm': 2.477236032485962, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.22it/s]                                               {'loss': 2.5366, 'grad_norm': 2.5189316272735596, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.22it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.19it/s]                                               {'loss': 2.5752, 'grad_norm': 2.197002410888672, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.19it/s] 60%|██████    | 24/40 [00:10<00:05,  2.77it/s]                                               {'loss': 3.0581, 'grad_norm': 9.723487854003906, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.77it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s]                                               {'loss': 2.6677, 'grad_norm': 2.564145803451538, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.43it/s]                                               {'loss': 2.6321, 'grad_norm': 2.78094744682312, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.43it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.6925, 'grad_norm': 3.480530023574829, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s] 70%|███████   | 28/40 [00:12<00:05,  2.29it/s]                                               {'loss': 2.5786, 'grad_norm': 2.8779702186584473, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.29it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.3494, 'grad_norm': 2.049790620803833, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s]                                               {'loss': 2.5015, 'grad_norm': 2.4483535289764404, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.661, 'grad_norm': 2.4640300273895264, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 2.7016, 'grad_norm': 7.4573187828063965, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.56it/s]                                               {'loss': 2.5364, 'grad_norm': 2.366715908050537, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.56it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s]                                               {'loss': 2.4908, 'grad_norm': 2.462203025817871, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s]                                               {'loss': 2.6899, 'grad_norm': 2.3716800212860107, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s]                                               {'loss': 2.5228, 'grad_norm': 2.351638078689575, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s]                                               {'loss': 2.5414, 'grad_norm': 2.4452521800994873, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.4615, 'grad_norm': 2.563789129257202, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.20it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.445, 'grad_norm': 3.3996829986572266, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]100%|██████████| 40/40 [00:16<00:00,  2.77it/s]                                               {'loss': 2.5921, 'grad_norm': 10.013875007629395, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.77it/s]                                               {'train_runtime': 17.0148, 'train_samples_per_second': 33.206, 'train_steps_per_second': 2.351, 'train_loss': 2.6348149955272673, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.77it/s]100%|██████████| 40/40 [00:17<00:00,  2.35it/s]
CLIENT:20
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.32it/s]                                              {'loss': 2.7313, 'grad_norm': 2.0046451091766357, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.32it/s]  5%|▌         | 2/40 [00:00<00:13,  2.74it/s]                                              {'loss': 2.9125, 'grad_norm': 1.9621208906173706, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.74it/s]  8%|▊         | 3/40 [00:01<00:12,  2.86it/s]                                              {'loss': 2.8885, 'grad_norm': 2.2811877727508545, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.86it/s] 10%|█         | 4/40 [00:01<00:12,  2.83it/s]                                              {'loss': 2.8638, 'grad_norm': 2.2728536128997803, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.83it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.77it/s]                                              {'loss': 2.6948, 'grad_norm': 1.7609410285949707, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.77it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.74it/s]                                              {'loss': 2.7633, 'grad_norm': 2.044111728668213, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.74it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.71it/s]                                              {'loss': 2.6863, 'grad_norm': 2.4793105125427246, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.71it/s] 20%|██        | 8/40 [00:02<00:09,  3.49it/s]                                              {'loss': 2.6563, 'grad_norm': 5.5797882080078125, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.49it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.24it/s]                                              {'loss': 2.6437, 'grad_norm': 2.269473075866699, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.24it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.09it/s]                                               {'loss': 2.727, 'grad_norm': 1.8569871187210083, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.09it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.00it/s]                                               {'loss': 2.6451, 'grad_norm': 1.7655439376831055, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.00it/s] 30%|███       | 12/40 [00:04<00:09,  2.93it/s]                                               {'loss': 2.7279, 'grad_norm': 2.9530959129333496, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.93it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.89it/s]                                               {'loss': 2.642, 'grad_norm': 2.459996223449707, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.89it/s] 35%|███▌      | 14/40 [00:04<00:09,  2.66it/s]                                               {'loss': 2.7182, 'grad_norm': 2.4494271278381348, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:09,  2.66it/s] 38%|███▊      | 15/40 [00:05<00:10,  2.50it/s]                                               {'loss': 2.6781, 'grad_norm': 2.8363873958587646, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:10,  2.50it/s] 40%|████      | 16/40 [00:05<00:07,  3.13it/s]                                               {'loss': 3.127, 'grad_norm': 9.342793464660645, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.13it/s] 42%|████▎     | 17/40 [00:05<00:08,  2.78it/s]                                               {'loss': 2.6298, 'grad_norm': 2.1299490928649902, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:08,  2.78it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.56it/s]                                               {'loss': 2.679, 'grad_norm': 2.129883289337158, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.56it/s] 48%|████▊     | 19/40 [00:06<00:08,  2.47it/s]                                               {'loss': 2.7256, 'grad_norm': 2.978729486465454, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:08,  2.47it/s] 50%|█████     | 20/40 [00:07<00:08,  2.33it/s]                                               {'loss': 2.5638, 'grad_norm': 2.37888503074646, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.33it/s] 52%|█████▎    | 21/40 [00:07<00:08,  2.30it/s]                                               {'loss': 2.5698, 'grad_norm': 1.9098525047302246, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:08,  2.30it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.29it/s]                                               {'loss': 2.4978, 'grad_norm': 2.191551685333252, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.25it/s]                                               {'loss': 2.545, 'grad_norm': 2.346343517303467, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.25it/s] 60%|██████    | 24/40 [00:08<00:05,  2.82it/s]                                               {'loss': 2.9893, 'grad_norm': 8.083020210266113, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.82it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.60it/s]                                               {'loss': 2.6069, 'grad_norm': 2.3914525508880615, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.60it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.42it/s]                                               {'loss': 2.5864, 'grad_norm': 2.207437515258789, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.42it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.37it/s]                                               {'loss': 2.6362, 'grad_norm': 2.2466583251953125, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.37it/s] 70%|███████   | 28/40 [00:10<00:05,  2.26it/s]                                               {'loss': 2.5787, 'grad_norm': 2.216806650161743, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.26it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.23it/s]                                               {'loss': 2.5422, 'grad_norm': 2.5398168563842773, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.23it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.21it/s]                                               {'loss': 2.5009, 'grad_norm': 2.0669288635253906, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.21it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.17it/s]                                               {'loss': 2.5379, 'grad_norm': 1.9099186658859253, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.17it/s]                                               {'loss': 1.5956, 'grad_norm': 6.466488838195801, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:03,  2.17it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.81it/s]                                               {'loss': 2.6409, 'grad_norm': 2.190147876739502, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.81it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.77it/s]                                               {'loss': 2.5884, 'grad_norm': 2.740140676498413, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.77it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.70it/s]                                               {'loss': 2.4807, 'grad_norm': 1.9139851331710815, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.70it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.52it/s]                                               {'loss': 2.4334, 'grad_norm': 2.2715606689453125, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.52it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.42it/s]                                               {'loss': 2.565, 'grad_norm': 1.8955320119857788, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.42it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.35it/s]                                               {'loss': 2.6379, 'grad_norm': 2.414973258972168, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.35it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]                                               {'loss': 2.715, 'grad_norm': 3.4841628074645996, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'loss': 2.0394, 'grad_norm': 7.944911003112793, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'train_runtime': 15.434, 'train_samples_per_second': 36.607, 'train_steps_per_second': 2.592, 'train_loss': 2.624797523021698, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]100%|██████████| 40/40 [00:15<00:00,  2.59it/s]
CLIENT:70
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]                                              {'loss': 2.8894, 'grad_norm': 2.7229573726654053, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]                                              {'loss': 2.8116, 'grad_norm': 2.6406168937683105, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]  8%|▊         | 3/40 [00:01<00:24,  1.52it/s]                                              {'loss': 2.7204, 'grad_norm': 2.056584358215332, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.52it/s] 10%|█         | 4/40 [00:02<00:20,  1.72it/s]                                              {'loss': 2.8247, 'grad_norm': 2.1249070167541504, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.72it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.90it/s]                                              {'loss': 2.6756, 'grad_norm': 2.295194625854492, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.90it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.99it/s]                                              {'loss': 2.7785, 'grad_norm': 2.202550172805786, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.99it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.03it/s]                                              {'loss': 2.7087, 'grad_norm': 1.9994276762008667, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.03it/s] 20%|██        | 8/40 [00:04<00:16,  1.98it/s]                                              {'loss': 2.9997, 'grad_norm': 9.285330772399902, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.98it/s] 22%|██▎       | 9/40 [00:04<00:15,  2.03it/s]                                              {'loss': 2.7704, 'grad_norm': 2.4591195583343506, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:15,  2.03it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.11it/s]                                               {'loss': 2.6021, 'grad_norm': 1.9014747142791748, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.11it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.13it/s]                                               {'loss': 2.5921, 'grad_norm': 2.3132922649383545, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.13it/s] 30%|███       | 12/40 [00:06<00:12,  2.19it/s]                                               {'loss': 2.7155, 'grad_norm': 2.3416805267333984, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:12,  2.19it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.24it/s]                                               {'loss': 2.7481, 'grad_norm': 2.5152010917663574, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.24it/s] 35%|███▌      | 14/40 [00:07<00:11,  2.23it/s]                                               {'loss': 2.4906, 'grad_norm': 2.8142435550689697, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.26it/s]                                               {'loss': 2.6351, 'grad_norm': 2.3085901737213135, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.26it/s] 40%|████      | 16/40 [00:07<00:08,  2.85it/s]                                               {'loss': 2.6892, 'grad_norm': 7.646711826324463, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:08<00:08,  2.58it/s]                                               {'loss': 2.6004, 'grad_norm': 2.268735647201538, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.50it/s]                                               {'loss': 2.6023, 'grad_norm': 1.938172698020935, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.50it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.5284, 'grad_norm': 2.4402642250061035, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.41it/s] 50%|█████     | 20/40 [00:09<00:08,  2.37it/s]                                               {'loss': 2.5837, 'grad_norm': 2.443986415863037, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.37it/s] 52%|█████▎    | 21/40 [00:09<00:07,  2.40it/s]                                               {'loss': 2.5492, 'grad_norm': 2.4502439498901367, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:07,  2.40it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.33it/s]                                               {'loss': 2.4985, 'grad_norm': 2.419774293899536, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.33it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.32it/s]                                               {'loss': 2.5064, 'grad_norm': 2.4310457706451416, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.32it/s] 60%|██████    | 24/40 [00:10<00:05,  2.90it/s]                                               {'loss': 2.8589, 'grad_norm': 12.701217651367188, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.90it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.85it/s]                                               {'loss': 2.5759, 'grad_norm': 2.375415086746216, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.85it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.59it/s]                                               {'loss': 2.3262, 'grad_norm': 2.3332982063293457, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.59it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.49it/s]                                               {'loss': 2.6014, 'grad_norm': 2.0948312282562256, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.49it/s] 70%|███████   | 28/40 [00:12<00:04,  2.44it/s]                                               {'loss': 2.4548, 'grad_norm': 2.393871307373047, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:04,  2.44it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.34it/s]                                               {'loss': 2.5175, 'grad_norm': 2.200204610824585, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.34it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s]                                               {'loss': 2.5611, 'grad_norm': 2.3689982891082764, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.24it/s]                                               {'loss': 2.4555, 'grad_norm': 2.5355074405670166, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.24it/s] 80%|████████  | 32/40 [00:14<00:02,  2.83it/s]                                               {'loss': 2.6097, 'grad_norm': 9.83083724975586, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.83it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s]                                               {'loss': 2.467, 'grad_norm': 2.305708646774292, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.45it/s]                                               {'loss': 2.5761, 'grad_norm': 2.3924291133880615, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.45it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.38it/s]                                               {'loss': 2.4197, 'grad_norm': 2.0781729221343994, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.32it/s]                                               {'loss': 2.3556, 'grad_norm': 2.6844797134399414, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.32it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.27it/s]                                               {'loss': 2.6283, 'grad_norm': 2.506579875946045, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.31it/s]                                               {'loss': 2.4951, 'grad_norm': 2.352903127670288, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]                                               {'loss': 2.5042, 'grad_norm': 2.804802417755127, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]100%|██████████| 40/40 [00:17<00:00,  2.82it/s]                                               {'loss': 2.6786, 'grad_norm': 7.081789493560791, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.82it/s]                                               {'train_runtime': 17.4853, 'train_samples_per_second': 32.313, 'train_steps_per_second': 2.288, 'train_loss': 2.6151519536972048, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.82it/s]100%|██████████| 40/40 [00:17<00:00,  2.29it/s]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]                                              {'loss': 2.8389, 'grad_norm': 2.92341947555542, 'learning_rate': 0.00020729490168751576, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]                                              {'loss': 2.7104, 'grad_norm': 1.7506446838378906, 'learning_rate': 0.00020211252914532787, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:31,  1.21it/s]  8%|▊         | 3/40 [00:01<00:24,  1.54it/s]                                              {'loss': 2.7367, 'grad_norm': 1.9695680141448975, 'learning_rate': 0.00019693015660313996, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.54it/s] 10%|█         | 4/40 [00:02<00:20,  1.72it/s]                                              {'loss': 2.8335, 'grad_norm': 2.364470958709717, 'learning_rate': 0.0001917477840609521, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.72it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.87it/s]                                              {'loss': 2.7316, 'grad_norm': 1.8000831604003906, 'learning_rate': 0.0001865654115187642, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.87it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.97it/s]                                              {'loss': 2.6978, 'grad_norm': 2.1510934829711914, 'learning_rate': 0.0001813830389765763, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.97it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.01it/s]                                              {'loss': 2.7701, 'grad_norm': 1.7990477085113525, 'learning_rate': 0.0001762006664343884, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.01it/s] 20%|██        | 8/40 [00:04<00:15,  2.02it/s]                                              {'loss': 3.3159, 'grad_norm': 11.09799575805664, 'learning_rate': 0.0001710182938922005, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.02it/s] 22%|██▎       | 9/40 [00:04<00:15,  2.04it/s]                                              {'loss': 2.5479, 'grad_norm': 2.9899559020996094, 'learning_rate': 0.00016583592135001261, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:15,  2.04it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.10it/s]                                               {'loss': 2.6427, 'grad_norm': 2.0163559913635254, 'learning_rate': 0.00016065354880782473, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.10it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.23it/s]                                               {'loss': 2.6527, 'grad_norm': 1.9117776155471802, 'learning_rate': 0.00015547117626563681, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.23it/s] 30%|███       | 12/40 [00:06<00:11,  2.38it/s]                                               {'loss': 2.6189, 'grad_norm': 1.9500652551651, 'learning_rate': 0.00015028880372344893, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:11,  2.38it/s] 32%|███▎      | 13/40 [00:06<00:10,  2.51it/s]                                               {'loss': 2.5743, 'grad_norm': 2.1750569343566895, 'learning_rate': 0.00014510643118126101, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:10,  2.51it/s] 35%|███▌      | 14/40 [00:06<00:09,  2.62it/s]                                               {'loss': 2.7874, 'grad_norm': 1.924304485321045, 'learning_rate': 0.00013992405863907315, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:09,  2.62it/s] 38%|███▊      | 15/40 [00:07<00:09,  2.69it/s]                                               {'loss': 2.5628, 'grad_norm': 2.1870641708374023, 'learning_rate': 0.00013474168609688524, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:09,  2.69it/s] 40%|████      | 16/40 [00:07<00:07,  3.40it/s]                                               {'loss': 3.0266, 'grad_norm': 11.414690017700195, 'learning_rate': 0.00012955931355469735, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:07,  3.40it/s] 42%|████▎     | 17/40 [00:07<00:07,  3.21it/s]                                               {'loss': 2.5109, 'grad_norm': 2.2725868225097656, 'learning_rate': 0.00012437694101250944, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:07,  3.21it/s] 45%|████▌     | 18/40 [00:07<00:07,  3.09it/s]                                               {'loss': 2.6761, 'grad_norm': 2.451514482498169, 'learning_rate': 0.00011919456847032155, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  3.09it/s] 48%|████▊     | 19/40 [00:08<00:06,  3.02it/s]                                               {'loss': 2.3726, 'grad_norm': 2.230475902557373, 'learning_rate': 0.00011401219592813368, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:06,  3.02it/s] 50%|█████     | 20/40 [00:08<00:06,  2.96it/s]                                               {'loss': 2.4011, 'grad_norm': 2.448214530944824, 'learning_rate': 0.00010882982338594578, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:06,  2.96it/s] 52%|█████▎    | 21/40 [00:08<00:06,  2.92it/s]                                               {'loss': 2.5603, 'grad_norm': 2.1517257690429688, 'learning_rate': 0.00010364745084375788, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:06,  2.92it/s] 55%|█████▌    | 22/40 [00:09<00:06,  2.87it/s]                                               {'loss': 2.4757, 'grad_norm': 2.156766414642334, 'learning_rate': 9.846507830156998e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:06,  2.87it/s] 57%|█████▊    | 23/40 [00:09<00:06,  2.83it/s]                                               {'loss': 2.5619, 'grad_norm': 3.7259116172790527, 'learning_rate': 9.32827057593821e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:06,  2.83it/s] 60%|██████    | 24/40 [00:09<00:04,  3.59it/s]                                               {'loss': 2.0596, 'grad_norm': 6.403825759887695, 'learning_rate': 8.81003332171942e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:04,  3.59it/s] 62%|██████▎   | 25/40 [00:10<00:04,  3.34it/s]                                               {'loss': 2.4477, 'grad_norm': 2.5072314739227295, 'learning_rate': 8.291796067500631e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:04,  3.34it/s] 65%|██████▌   | 26/40 [00:10<00:04,  3.03it/s]                                               {'loss': 2.4928, 'grad_norm': 1.9832614660263062, 'learning_rate': 7.773558813281841e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  3.03it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.70it/s]                                               {'loss': 2.3776, 'grad_norm': 2.6446733474731445, 'learning_rate': 7.255321559063051e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.70it/s] 70%|███████   | 28/40 [00:11<00:04,  2.58it/s]                                               {'loss': 2.5347, 'grad_norm': 2.0311505794525146, 'learning_rate': 6.737084304844262e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.58it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.47it/s]                                               {'loss': 2.3974, 'grad_norm': 2.4442217350006104, 'learning_rate': 6.218847050625472e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.47it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.39it/s]                                               {'loss': 2.6958, 'grad_norm': 2.8301196098327637, 'learning_rate': 5.700609796406684e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.39it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.37it/s]                                               {'loss': 2.3804, 'grad_norm': 2.335731267929077, 'learning_rate': 5.182372542187894e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.37it/s] 80%|████████  | 32/40 [00:12<00:02,  2.93it/s]                                               {'loss': 2.8023, 'grad_norm': 10.61838150024414, 'learning_rate': 4.664135287969105e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.93it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.69it/s]                                               {'loss': 2.3632, 'grad_norm': 2.540051221847534, 'learning_rate': 4.1458980337503154e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.69it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.61it/s]                                               {'loss': 2.5119, 'grad_norm': 2.3282034397125244, 'learning_rate': 3.6276607795315253e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.61it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.4077, 'grad_norm': 2.504385232925415, 'learning_rate': 3.109423525312736e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s]                                               {'loss': 2.4725, 'grad_norm': 2.1022250652313232, 'learning_rate': 2.591186271093947e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.39it/s]                                               {'loss': 2.3445, 'grad_norm': 2.4359309673309326, 'learning_rate': 2.0729490168751577e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.39it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s]                                               {'loss': 2.4179, 'grad_norm': 2.665081024169922, 'learning_rate': 1.554711762656368e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.32it/s]                                               {'loss': 2.4947, 'grad_norm': 2.2412514686584473, 'learning_rate': 1.0364745084375788e-05, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.32it/s]100%|██████████| 40/40 [00:16<00:00,  2.89it/s]                                               {'loss': 2.4163, 'grad_norm': 7.559648513793945, 'learning_rate': 5.182372542187894e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.89it/s]                                               {'train_runtime': 16.197, 'train_samples_per_second': 34.883, 'train_steps_per_second': 2.47, 'train_loss': 2.58059224486351, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.89it/s]100%|██████████| 40/40 [00:16<00:00,  2.47it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:47,  9.78it/s]  1%|          | 3/471 [00:00<01:14,  6.30it/s]  1%|          | 4/471 [00:00<01:20,  5.77it/s]  1%|          | 5/471 [00:00<01:30,  5.16it/s]  1%|▏         | 6/471 [00:01<01:28,  5.27it/s]  1%|▏         | 7/471 [00:01<01:36,  4.83it/s]  2%|▏         | 8/471 [00:01<01:34,  4.92it/s]  2%|▏         | 9/471 [00:01<01:41,  4.57it/s]  2%|▏         | 10/471 [00:01<01:36,  4.79it/s]  2%|▏         | 11/471 [00:02<01:39,  4.61it/s]  3%|▎         | 12/471 [00:02<01:35,  4.81it/s]  3%|▎         | 13/471 [00:02<01:41,  4.52it/s]  3%|▎         | 14/471 [00:02<01:40,  4.55it/s]  3%|▎         | 15/471 [00:03<01:39,  4.60it/s]  3%|▎         | 16/471 [00:03<01:38,  4.63it/s]  4%|▎         | 17/471 [00:03<01:35,  4.76it/s]  4%|▍         | 18/471 [00:03<01:38,  4.61it/s]  4%|▍         | 19/471 [00:03<01:36,  4.67it/s]  4%|▍         | 20/471 [00:04<01:39,  4.54it/s]  4%|▍         | 21/471 [00:04<01:34,  4.76it/s]  5%|▍         | 22/471 [00:04<01:38,  4.58it/s]  5%|▍         | 23/471 [00:04<01:33,  4.80it/s]  5%|▌         | 24/471 [00:04<01:40,  4.46it/s]  5%|▌         | 25/471 [00:05<01:34,  4.72it/s]  6%|▌         | 26/471 [00:05<01:39,  4.48it/s]  6%|▌         | 27/471 [00:05<01:32,  4.82it/s]  6%|▌         | 28/471 [00:05<01:36,  4.60it/s]  6%|▌         | 29/471 [00:06<01:33,  4.72it/s]  6%|▋         | 30/471 [00:06<01:35,  4.63it/s]  7%|▋         | 31/471 [00:06<01:35,  4.62it/s]  7%|▋         | 32/471 [00:06<01:30,  4.87it/s]  7%|▋         | 33/471 [00:06<01:31,  4.78it/s]  7%|▋         | 34/471 [00:07<01:21,  5.36it/s]  7%|▋         | 35/471 [00:07<01:29,  4.86it/s]  8%|▊         | 36/471 [00:07<01:28,  4.89it/s]  8%|▊         | 37/471 [00:07<01:33,  4.65it/s]  8%|▊         | 38/471 [00:07<01:30,  4.78it/s]  8%|▊         | 39/471 [00:08<01:33,  4.61it/s]  8%|▊         | 40/471 [00:08<01:30,  4.79it/s]  9%|▊         | 41/471 [00:08<01:35,  4.49it/s]  9%|▉         | 42/471 [00:08<01:33,  4.61it/s]  9%|▉         | 43/471 [00:09<01:33,  4.57it/s]  9%|▉         | 44/471 [00:09<01:32,  4.64it/s] 10%|▉         | 45/471 [00:09<01:27,  4.85it/s] 10%|▉         | 46/471 [00:09<01:30,  4.72it/s] 10%|▉         | 47/471 [00:09<01:29,  4.72it/s] 10%|█         | 48/471 [00:10<01:31,  4.64it/s] 10%|█         | 49/471 [00:10<01:28,  4.75it/s] 11%|█         | 50/471 [00:10<01:28,  4.76it/s] 11%|█         | 51/471 [00:10<01:28,  4.75it/s] 11%|█         | 52/471 [00:10<01:32,  4.55it/s] 11%|█▏        | 53/471 [00:11<01:28,  4.74it/s] 11%|█▏        | 54/471 [00:11<01:32,  4.52it/s] 12%|█▏        | 55/471 [00:11<01:26,  4.81it/s] 12%|█▏        | 56/471 [00:11<01:28,  4.70it/s] 12%|█▏        | 57/471 [00:11<01:28,  4.66it/s] 12%|█▏        | 58/471 [00:12<01:28,  4.69it/s] 13%|█▎        | 59/471 [00:12<01:28,  4.64it/s] 13%|█▎        | 60/471 [00:12<01:27,  4.67it/s] 13%|█▎        | 61/471 [00:12<01:27,  4.70it/s] 13%|█▎        | 62/471 [00:13<01:27,  4.69it/s] 13%|█▎        | 63/471 [00:13<01:29,  4.55it/s] 14%|█▎        | 64/471 [00:13<01:27,  4.67it/s] 14%|█▍        | 65/471 [00:13<01:28,  4.59it/s] 14%|█▍        | 66/471 [00:13<01:21,  4.97it/s] 14%|█▍        | 67/471 [00:14<01:27,  4.64it/s] 14%|█▍        | 68/471 [00:14<01:23,  4.82it/s] 15%|█▍        | 69/471 [00:14<01:28,  4.56it/s] 15%|█▍        | 70/471 [00:14<01:24,  4.74it/s] 15%|█▌        | 71/471 [00:14<01:26,  4.61it/s] 15%|█▌        | 72/471 [00:15<01:22,  4.82it/s] 15%|█▌        | 73/471 [00:15<01:20,  4.95it/s] 16%|█▌        | 74/471 [00:15<01:18,  5.04it/s] 16%|█▌        | 75/471 [00:15<01:17,  5.08it/s] 16%|█▌        | 76/471 [00:15<01:15,  5.22it/s] 16%|█▋        | 77/471 [00:16<01:12,  5.42it/s] 17%|█▋        | 78/471 [00:16<01:11,  5.50it/s] 17%|█▋        | 79/471 [00:16<01:10,  5.55it/s] 17%|█▋        | 80/471 [00:16<01:13,  5.30it/s] 17%|█▋        | 81/471 [00:16<01:10,  5.55it/s] 17%|█▋        | 82/471 [00:16<01:13,  5.32it/s] 18%|█▊        | 83/471 [00:17<01:07,  5.75it/s] 18%|█▊        | 84/471 [00:17<01:08,  5.61it/s] 18%|█▊        | 85/471 [00:17<01:08,  5.60it/s] 18%|█▊        | 86/471 [00:17<01:11,  5.40it/s] 18%|█▊        | 87/471 [00:17<01:11,  5.34it/s] 19%|█▊        | 88/471 [00:18<01:09,  5.48it/s] 19%|█▉        | 89/471 [00:18<01:08,  5.59it/s] 19%|█▉        | 90/471 [00:18<01:08,  5.55it/s] 19%|█▉        | 91/471 [00:18<01:10,  5.36it/s] 20%|█▉        | 92/471 [00:18<01:08,  5.53it/s] 20%|█▉        | 93/471 [00:18<01:10,  5.39it/s] 20%|█▉        | 94/471 [00:19<01:04,  5.82it/s] 20%|██        | 95/471 [00:19<01:09,  5.42it/s] 20%|██        | 96/471 [00:19<01:07,  5.55it/s] 21%|██        | 97/471 [00:19<01:09,  5.37it/s] 21%|██        | 98/471 [00:19<01:07,  5.56it/s] 21%|██        | 99/471 [00:20<01:07,  5.53it/s] 21%|██        | 100/471 [00:20<01:05,  5.63it/s] 21%|██▏       | 101/471 [00:20<01:07,  5.46it/s] 22%|██▏       | 102/471 [00:20<01:12,  5.11it/s] 22%|██▏       | 103/471 [00:20<01:13,  5.00it/s] 22%|██▏       | 104/471 [00:21<01:15,  4.88it/s] 22%|██▏       | 105/471 [00:21<01:13,  4.98it/s] 23%|██▎       | 106/471 [00:21<01:17,  4.73it/s] 23%|██▎       | 107/471 [00:21<01:17,  4.73it/s] 23%|██▎       | 108/471 [00:21<01:18,  4.65it/s] 23%|██▎       | 109/471 [00:22<01:16,  4.76it/s] 23%|██▎       | 110/471 [00:22<01:15,  4.75it/s] 24%|██▎       | 111/471 [00:22<01:12,  5.00it/s] 24%|██▍       | 112/471 [00:22<01:14,  4.79it/s] 24%|██▍       | 113/471 [00:22<01:15,  4.76it/s] 24%|██▍       | 114/471 [00:23<01:16,  4.66it/s] 24%|██▍       | 115/471 [00:23<01:16,  4.65it/s] 25%|██▍       | 116/471 [00:23<01:16,  4.63it/s] 25%|██▍       | 117/471 [00:23<01:15,  4.70it/s] 25%|██▌       | 118/471 [00:24<01:16,  4.63it/s] 25%|██▌       | 119/471 [00:24<01:16,  4.60it/s] 25%|██▌       | 120/471 [00:24<01:14,  4.70it/s] 26%|██▌       | 121/471 [00:24<01:15,  4.64it/s] 26%|██▌       | 122/471 [00:24<01:12,  4.85it/s] 26%|██▌       | 123/471 [00:25<01:15,  4.64it/s] 26%|██▋       | 124/471 [00:25<01:13,  4.75it/s] 27%|██▋       | 125/471 [00:25<01:15,  4.58it/s] 27%|██▋       | 126/471 [00:25<01:13,  4.70it/s] 27%|██▋       | 127/471 [00:25<01:14,  4.63it/s] 27%|██▋       | 128/471 [00:26<01:12,  4.72it/s] 27%|██▋       | 129/471 [00:26<01:15,  4.52it/s] 28%|██▊       | 130/471 [00:26<01:14,  4.57it/s] 28%|██▊       | 131/471 [00:26<01:14,  4.55it/s] 28%|██▊       | 132/471 [00:27<01:13,  4.64it/s] 28%|██▊       | 133/471 [00:27<01:11,  4.75it/s] 28%|██▊       | 134/471 [00:27<01:13,  4.57it/s] 29%|██▊       | 135/471 [00:27<01:13,  4.59it/s] 29%|██▉       | 136/471 [00:27<01:13,  4.54it/s] 29%|██▉       | 137/471 [00:28<01:11,  4.68it/s] 29%|██▉       | 138/471 [00:28<01:12,  4.59it/s] 30%|██▉       | 139/471 [00:28<01:10,  4.70it/s] 30%|██▉       | 140/471 [00:28<01:12,  4.54it/s] 30%|██▉       | 141/471 [00:28<01:08,  4.78it/s] 30%|███       | 142/471 [00:29<01:10,  4.67it/s] 30%|███       | 143/471 [00:29<01:08,  4.79it/s] 31%|███       | 144/471 [00:29<01:10,  4.65it/s] 31%|███       | 145/471 [00:29<01:10,  4.65it/s] 31%|███       | 146/471 [00:30<01:11,  4.57it/s] 31%|███       | 147/471 [00:30<01:09,  4.64it/s] 31%|███▏      | 148/471 [00:30<01:09,  4.67it/s] 32%|███▏      | 149/471 [00:30<01:07,  4.77it/s] 32%|███▏      | 150/471 [00:30<01:03,  5.08it/s] 32%|███▏      | 151/471 [00:31<01:01,  5.19it/s] 32%|███▏      | 152/471 [00:31<00:58,  5.48it/s] 32%|███▏      | 153/471 [00:31<00:58,  5.47it/s] 33%|███▎      | 154/471 [00:31<00:55,  5.73it/s] 33%|███▎      | 155/471 [00:31<00:56,  5.57it/s] 33%|███▎      | 156/471 [00:31<00:54,  5.76it/s] 33%|███▎      | 157/471 [00:32<00:56,  5.60it/s] 34%|███▎      | 158/471 [00:32<00:53,  5.82it/s] 34%|███▍      | 159/471 [00:32<00:54,  5.68it/s] 34%|███▍      | 160/471 [00:32<00:54,  5.73it/s] 34%|███▍      | 161/471 [00:32<00:54,  5.74it/s] 34%|███▍      | 162/471 [00:32<00:54,  5.68it/s] 35%|███▍      | 163/471 [00:33<00:53,  5.72it/s] 35%|███▍      | 164/471 [00:33<00:54,  5.61it/s] 35%|███▌      | 165/471 [00:33<00:52,  5.85it/s] 35%|███▌      | 166/471 [00:33<00:54,  5.62it/s] 35%|███▌      | 167/471 [00:33<00:51,  5.87it/s] 36%|███▌      | 168/471 [00:34<00:54,  5.56it/s] 36%|███▌      | 169/471 [00:34<00:50,  5.98it/s] 36%|███▌      | 170/471 [00:34<00:53,  5.63it/s] 36%|███▋      | 171/471 [00:34<00:49,  6.02it/s] 37%|███▋      | 172/471 [00:34<00:53,  5.57it/s] 37%|███▋      | 173/471 [00:34<00:51,  5.83it/s] 37%|███▋      | 174/471 [00:35<00:52,  5.71it/s] 37%|███▋      | 175/471 [00:35<00:51,  5.73it/s] 37%|███▋      | 176/471 [00:35<00:49,  5.93it/s] 38%|███▊      | 177/471 [00:35<00:51,  5.70it/s] 38%|███▊      | 178/471 [00:35<00:50,  5.82it/s] 38%|███▊      | 179/471 [00:35<00:53,  5.48it/s] 38%|███▊      | 180/471 [00:36<00:49,  5.89it/s] 38%|███▊      | 181/471 [00:36<00:52,  5.53it/s] 39%|███▊      | 182/471 [00:36<00:47,  6.08it/s] 39%|███▉      | 183/471 [00:36<00:51,  5.55it/s] 39%|███▉      | 184/471 [00:36<00:51,  5.55it/s] 39%|███▉      | 185/471 [00:36<00:51,  5.57it/s] 39%|███▉      | 186/471 [00:37<00:52,  5.43it/s] 40%|███▉      | 187/471 [00:37<00:47,  5.94it/s] 40%|███▉      | 188/471 [00:37<00:50,  5.55it/s] 40%|████      | 189/471 [00:37<00:46,  6.00it/s] 40%|████      | 190/471 [00:37<00:51,  5.50it/s] 41%|████      | 191/471 [00:38<00:47,  5.90it/s] 41%|████      | 192/471 [00:38<00:52,  5.32it/s] 41%|████      | 193/471 [00:38<00:52,  5.29it/s] 41%|████      | 194/471 [00:38<00:55,  5.00it/s] 41%|████▏     | 195/471 [00:38<00:58,  4.75it/s] 42%|████▏     | 196/471 [00:39<00:55,  5.00it/s] 42%|████▏     | 197/471 [00:39<00:57,  4.75it/s] 42%|████▏     | 198/471 [00:39<00:52,  5.23it/s] 42%|████▏     | 199/471 [00:39<00:57,  4.71it/s] 42%|████▏     | 200/471 [00:39<00:55,  4.88it/s] 43%|████▎     | 201/471 [00:40<00:59,  4.51it/s] 43%|████▎     | 202/471 [00:40<00:56,  4.79it/s] 43%|████▎     | 203/471 [00:40<00:59,  4.54it/s] 43%|████▎     | 204/471 [00:40<00:56,  4.71it/s] 44%|████▎     | 205/471 [00:41<00:58,  4.59it/s] 44%|████▎     | 206/471 [00:41<00:58,  4.57it/s] 44%|████▍     | 207/471 [00:41<00:54,  4.83it/s] 44%|████▍     | 208/471 [00:41<00:56,  4.65it/s] 44%|████▍     | 209/471 [00:41<00:52,  5.03it/s] 45%|████▍     | 210/471 [00:42<00:55,  4.67it/s] 45%|████▍     | 211/471 [00:42<00:52,  4.92it/s] 45%|████▌     | 212/471 [00:42<00:56,  4.60it/s] 45%|████▌     | 213/471 [00:42<00:52,  4.91it/s] 45%|████▌     | 214/471 [00:42<00:54,  4.70it/s] 46%|████▌     | 215/471 [00:43<00:51,  4.92it/s] 46%|████▌     | 216/471 [00:43<00:54,  4.68it/s] 46%|████▌     | 217/471 [00:43<00:55,  4.58it/s] 46%|████▋     | 218/471 [00:43<00:54,  4.67it/s] 46%|████▋     | 219/471 [00:43<00:55,  4.55it/s] 47%|████▋     | 220/471 [00:44<00:51,  4.87it/s] 47%|████▋     | 221/471 [00:44<00:54,  4.58it/s] 47%|████▋     | 222/471 [00:44<00:51,  4.86it/s] 47%|████▋     | 223/471 [00:44<00:54,  4.57it/s] 48%|████▊     | 224/471 [00:44<00:50,  4.93it/s] 48%|████▊     | 225/471 [00:45<00:53,  4.64it/s] 48%|████▊     | 226/471 [00:45<00:49,  4.96it/s] 48%|████▊     | 227/471 [00:45<00:52,  4.63it/s] 48%|████▊     | 228/471 [00:45<00:51,  4.69it/s] 49%|████▊     | 229/471 [00:46<00:52,  4.62it/s] 49%|████▉     | 230/471 [00:46<00:51,  4.66it/s] 49%|████▉     | 231/471 [00:46<00:50,  4.80it/s] 49%|████▉     | 232/471 [00:46<00:50,  4.70it/s] 49%|████▉     | 233/471 [00:46<00:50,  4.71it/s] 50%|████▉     | 234/471 [00:47<00:50,  4.65it/s] 50%|████▉     | 235/471 [00:47<00:49,  4.76it/s] 50%|█████     | 236/471 [00:47<00:49,  4.72it/s] 50%|█████     | 237/471 [00:47<00:49,  4.73it/s] 51%|█████     | 238/471 [00:48<00:51,  4.50it/s] 51%|█████     | 239/471 [00:48<00:48,  4.74it/s] 51%|█████     | 240/471 [00:48<00:51,  4.50it/s] 51%|█████     | 241/471 [00:48<00:47,  4.89it/s] 51%|█████▏    | 242/471 [00:48<00:48,  4.73it/s] 52%|█████▏    | 243/471 [00:49<00:48,  4.73it/s] 52%|█████▏    | 244/471 [00:49<00:49,  4.60it/s] 52%|█████▏    | 245/471 [00:49<00:47,  4.72it/s] 52%|█████▏    | 246/471 [00:49<00:48,  4.63it/s] 52%|█████▏    | 247/471 [00:49<00:46,  4.84it/s] 53%|█████▎    | 248/471 [00:50<00:47,  4.70it/s] 53%|█████▎    | 249/471 [00:50<00:47,  4.67it/s] 53%|█████▎    | 250/471 [00:50<00:47,  4.63it/s] 53%|█████▎    | 251/471 [00:50<00:47,  4.61it/s] 54%|█████▎    | 252/471 [00:50<00:45,  4.78it/s] 54%|█████▎    | 253/471 [00:51<00:45,  4.80it/s] 54%|█████▍    | 254/471 [00:51<00:45,  4.75it/s] 54%|█████▍    | 255/471 [00:51<00:46,  4.63it/s] 54%|█████▍    | 256/471 [00:51<00:45,  4.75it/s] 55%|█████▍    | 257/471 [00:52<00:46,  4.59it/s] 55%|█████▍    | 258/471 [00:52<00:44,  4.78it/s] 55%|█████▍    | 259/471 [00:52<00:46,  4.61it/s] 55%|█████▌    | 260/471 [00:52<00:44,  4.79it/s] 55%|█████▌    | 261/471 [00:52<00:47,  4.46it/s] 56%|█████▌    | 262/471 [00:53<00:44,  4.73it/s] 56%|█████▌    | 263/471 [00:53<00:45,  4.53it/s] 56%|█████▌    | 264/471 [00:53<00:42,  4.83it/s] 56%|█████▋    | 265/471 [00:53<00:45,  4.55it/s] 56%|█████▋    | 266/471 [00:53<00:44,  4.60it/s] 57%|█████▋    | 267/471 [00:54<00:44,  4.61it/s] 57%|█████▋    | 268/471 [00:54<00:43,  4.63it/s] 57%|█████▋    | 269/471 [00:54<00:42,  4.76it/s] 57%|█████▋    | 270/471 [00:54<00:43,  4.61it/s] 58%|█████▊    | 271/471 [00:55<00:42,  4.69it/s] 58%|█████▊    | 272/471 [00:55<00:43,  4.55it/s] 58%|█████▊    | 273/471 [00:55<00:41,  4.78it/s] 58%|█████▊    | 274/471 [00:55<00:42,  4.61it/s] 58%|█████▊    | 275/471 [00:55<00:40,  4.90it/s] 59%|█████▊    | 276/471 [00:56<00:43,  4.51it/s] 59%|█████▉    | 277/471 [00:56<00:41,  4.73it/s] 59%|█████▉    | 278/471 [00:56<00:43,  4.49it/s] 59%|█████▉    | 279/471 [00:56<00:40,  4.80it/s] 59%|█████▉    | 280/471 [00:57<00:42,  4.54it/s] 60%|█████▉    | 281/471 [00:57<00:40,  4.74it/s] 60%|█████▉    | 282/471 [00:57<00:41,  4.52it/s] 60%|██████    | 283/471 [00:57<00:38,  4.85it/s] 60%|██████    | 284/471 [00:57<00:37,  5.04it/s] 61%|██████    | 285/471 [00:57<00:35,  5.21it/s] 61%|██████    | 286/471 [00:58<00:34,  5.40it/s] 61%|██████    | 287/471 [00:58<00:35,  5.22it/s] 61%|██████    | 288/471 [00:58<00:32,  5.63it/s] 61%|██████▏   | 289/471 [00:58<00:33,  5.38it/s] 62%|██████▏   | 290/471 [00:58<00:30,  6.02it/s] 62%|██████▏   | 291/471 [00:59<00:31,  5.74it/s] 62%|██████▏   | 292/471 [00:59<00:29,  6.06it/s] 62%|██████▏   | 293/471 [00:59<00:31,  5.71it/s] 62%|██████▏   | 294/471 [00:59<00:31,  5.54it/s] 63%|██████▎   | 295/471 [00:59<00:30,  5.73it/s] 63%|██████▎   | 296/471 [00:59<00:31,  5.54it/s] 63%|██████▎   | 297/471 [00:59<00:27,  6.36it/s] 63%|██████▎   | 298/471 [01:00<00:30,  5.65it/s] 63%|██████▎   | 299/471 [01:00<00:31,  5.47it/s] 64%|██████▎   | 300/471 [01:00<00:34,  5.00it/s] 64%|██████▍   | 301/471 [01:00<00:32,  5.19it/s] 64%|██████▍   | 302/471 [01:01<00:32,  5.27it/s] 64%|██████▍   | 303/471 [01:01<00:31,  5.34it/s] 65%|██████▍   | 304/471 [01:01<00:31,  5.37it/s] 65%|██████▍   | 305/471 [01:01<00:32,  5.09it/s] 65%|██████▍   | 306/471 [01:01<00:32,  5.15it/s] 65%|██████▌   | 307/471 [01:02<00:33,  4.84it/s] 65%|██████▌   | 308/471 [01:02<00:30,  5.32it/s] 66%|██████▌   | 309/471 [01:02<00:34,  4.75it/s] 66%|██████▌   | 310/471 [01:02<00:32,  5.01it/s] 66%|██████▌   | 311/471 [01:02<00:34,  4.64it/s] 66%|██████▌   | 312/471 [01:03<00:33,  4.77it/s] 66%|██████▋   | 313/471 [01:03<00:33,  4.77it/s] 67%|██████▋   | 314/471 [01:03<00:34,  4.61it/s] 67%|██████▋   | 315/471 [01:03<00:32,  4.82it/s] 67%|██████▋   | 316/471 [01:03<00:33,  4.63it/s] 67%|██████▋   | 317/471 [01:04<00:30,  5.00it/s] 68%|██████▊   | 318/471 [01:04<00:32,  4.69it/s] 68%|██████▊   | 319/471 [01:04<00:30,  4.95it/s] 68%|██████▊   | 320/471 [01:04<00:33,  4.54it/s] 68%|██████▊   | 321/471 [01:04<00:31,  4.83it/s] 68%|██████▊   | 322/471 [01:05<00:32,  4.61it/s] 69%|██████▊   | 323/471 [01:05<00:31,  4.69it/s] 69%|██████▉   | 324/471 [01:05<00:30,  4.89it/s] 69%|██████▉   | 325/471 [01:05<00:31,  4.68it/s] 69%|██████▉   | 326/471 [01:05<00:29,  4.85it/s] 69%|██████▉   | 327/471 [01:06<00:30,  4.65it/s] 70%|██████▉   | 328/471 [01:06<00:28,  5.01it/s] 70%|██████▉   | 329/471 [01:06<00:29,  4.76it/s] 70%|███████   | 330/471 [01:06<00:26,  5.23it/s] 70%|███████   | 331/471 [01:07<00:29,  4.70it/s] 70%|███████   | 332/471 [01:07<00:29,  4.78it/s] 71%|███████   | 333/471 [01:07<00:29,  4.62it/s] 71%|███████   | 334/471 [01:07<00:29,  4.61it/s] 71%|███████   | 335/471 [01:07<00:28,  4.71it/s] 71%|███████▏  | 336/471 [01:08<00:28,  4.73it/s] 72%|███████▏  | 337/471 [01:08<00:28,  4.72it/s] 72%|███████▏  | 338/471 [01:08<00:29,  4.56it/s] 72%|███████▏  | 339/471 [01:08<00:28,  4.70it/s] 72%|███████▏  | 340/471 [01:08<00:28,  4.63it/s] 72%|███████▏  | 341/471 [01:09<00:26,  4.98it/s] 73%|███████▎  | 342/471 [01:09<00:27,  4.72it/s] 73%|███████▎  | 343/471 [01:09<00:26,  4.78it/s] 73%|███████▎  | 344/471 [01:09<00:27,  4.61it/s] 73%|███████▎  | 345/471 [01:10<00:26,  4.71it/s] 73%|███████▎  | 346/471 [01:10<00:26,  4.75it/s] 74%|███████▎  | 347/471 [01:10<00:26,  4.71it/s] 74%|███████▍  | 348/471 [01:10<00:25,  4.74it/s] 74%|███████▍  | 349/471 [01:10<00:26,  4.57it/s] 74%|███████▍  | 350/471 [01:11<00:25,  4.70it/s] 75%|███████▍  | 351/471 [01:11<00:25,  4.63it/s] 75%|███████▍  | 352/471 [01:11<00:23,  5.01it/s] 75%|███████▍  | 353/471 [01:11<00:25,  4.65it/s] 75%|███████▌  | 354/471 [01:11<00:24,  4.75it/s] 75%|███████▌  | 355/471 [01:12<00:25,  4.57it/s] 76%|███████▌  | 356/471 [01:12<00:24,  4.77it/s] 76%|███████▌  | 357/471 [01:12<00:24,  4.68it/s] 76%|███████▌  | 358/471 [01:12<00:24,  4.68it/s] 76%|███████▌  | 359/471 [01:13<00:24,  4.54it/s] 76%|███████▋  | 360/471 [01:13<00:24,  4.51it/s] 77%|███████▋  | 361/471 [01:13<00:24,  4.57it/s] 77%|███████▋  | 362/471 [01:13<00:23,  4.55it/s] 77%|███████▋  | 363/471 [01:13<00:22,  4.71it/s] 77%|███████▋  | 364/471 [01:14<00:23,  4.48it/s] 77%|███████▋  | 365/471 [01:14<00:22,  4.71it/s] 78%|███████▊  | 366/471 [01:14<00:23,  4.56it/s] 78%|███████▊  | 367/471 [01:14<00:21,  4.91it/s] 78%|███████▊  | 368/471 [01:14<00:21,  4.72it/s] 78%|███████▊  | 369/471 [01:15<00:18,  5.41it/s] 79%|███████▊  | 370/471 [01:15<00:19,  5.30it/s] 79%|███████▉  | 371/471 [01:15<00:18,  5.42it/s] 79%|███████▉  | 372/471 [01:15<00:17,  5.52it/s] 79%|███████▉  | 373/471 [01:15<00:18,  5.44it/s] 79%|███████▉  | 374/471 [01:15<00:16,  5.90it/s] 80%|███████▉  | 375/471 [01:16<00:17,  5.65it/s] 80%|███████▉  | 376/471 [01:16<00:15,  6.06it/s] 80%|████████  | 377/471 [01:16<00:16,  5.70it/s] 80%|████████  | 378/471 [01:16<00:15,  6.11it/s] 80%|████████  | 379/471 [01:16<00:16,  5.64it/s] 81%|████████  | 380/471 [01:16<00:15,  6.02it/s] 81%|████████  | 381/471 [01:17<00:15,  5.66it/s] 81%|████████  | 382/471 [01:17<00:15,  5.82it/s] 81%|████████▏ | 383/471 [01:17<00:15,  5.80it/s] 82%|████████▏ | 384/471 [01:17<00:15,  5.70it/s] 82%|████████▏ | 385/471 [01:17<00:14,  6.13it/s] 82%|████████▏ | 386/471 [01:17<00:14,  5.89it/s] 82%|████████▏ | 387/471 [01:18<00:13,  6.17it/s] 82%|████████▏ | 388/471 [01:18<00:14,  5.82it/s] 83%|████████▎ | 389/471 [01:18<00:13,  6.09it/s] 83%|████████▎ | 390/471 [01:18<00:14,  5.77it/s] 83%|████████▎ | 391/471 [01:18<00:13,  5.95it/s] 83%|████████▎ | 392/471 [01:19<00:13,  5.80it/s] 83%|████████▎ | 393/471 [01:19<00:13,  5.76it/s] 84%|████████▎ | 394/471 [01:19<00:13,  5.90it/s] 84%|████████▍ | 395/471 [01:19<00:13,  5.60it/s] 84%|████████▍ | 396/471 [01:19<00:13,  5.41it/s] 84%|████████▍ | 397/471 [01:19<00:15,  4.91it/s] 85%|████████▍ | 398/471 [01:20<00:14,  5.00it/s] 85%|████████▍ | 399/471 [01:20<00:15,  4.68it/s] 85%|████████▍ | 400/471 [01:20<00:14,  4.99it/s] 85%|████████▌ | 401/471 [01:20<00:15,  4.64it/s] 85%|████████▌ | 402/471 [01:21<00:14,  4.87it/s] 86%|████████▌ | 403/471 [01:21<00:14,  4.54it/s] 86%|████████▌ | 404/471 [01:21<00:14,  4.76it/s] 86%|████████▌ | 405/471 [01:21<00:14,  4.52it/s] 86%|████████▌ | 406/471 [01:21<00:13,  4.70it/s] 86%|████████▋ | 407/471 [01:22<00:13,  4.61it/s] 87%|████████▋ | 408/471 [01:22<00:13,  4.51it/s] 87%|████████▋ | 409/471 [01:22<00:13,  4.69it/s] 87%|████████▋ | 410/471 [01:22<00:13,  4.56it/s] 87%|████████▋ | 411/471 [01:22<00:11,  5.02it/s] 87%|████████▋ | 412/471 [01:23<00:12,  4.67it/s] 88%|████████▊ | 413/471 [01:23<00:11,  4.95it/s] 88%|████████▊ | 414/471 [01:23<00:12,  4.54it/s] 88%|████████▊ | 415/471 [01:23<00:11,  4.88it/s] 88%|████████▊ | 416/471 [01:24<00:11,  4.60it/s] 89%|████████▊ | 417/471 [01:24<00:11,  4.79it/s] 89%|████████▊ | 418/471 [01:24<00:11,  4.65it/s] 89%|████████▉ | 419/471 [01:24<00:11,  4.55it/s] 89%|████████▉ | 420/471 [01:24<00:10,  4.77it/s] 89%|████████▉ | 421/471 [01:25<00:10,  4.62it/s] 90%|████████▉ | 422/471 [01:25<00:09,  4.98it/s] 90%|████████▉ | 423/471 [01:25<00:10,  4.64it/s] 90%|█████████ | 424/471 [01:25<00:09,  4.90it/s] 90%|█████████ | 425/471 [01:25<00:10,  4.60it/s] 90%|█████████ | 426/471 [01:26<00:09,  4.96it/s] 91%|█████████ | 427/471 [01:26<00:09,  4.62it/s] 91%|█████████ | 428/471 [01:26<00:08,  4.81it/s] 91%|█████████ | 429/471 [01:26<00:09,  4.62it/s] 91%|█████████▏| 430/471 [01:27<00:08,  4.62it/s] 92%|█████████▏| 431/471 [01:27<00:08,  4.72it/s] 92%|█████████▏| 432/471 [01:27<00:08,  4.75it/s] 92%|█████████▏| 433/471 [01:27<00:06,  5.51it/s] 92%|█████████▏| 434/471 [01:27<00:07,  5.21it/s] 92%|█████████▏| 435/471 [01:27<00:06,  5.97it/s] 93%|█████████▎| 436/471 [01:28<00:06,  5.35it/s] 93%|█████████▎| 437/471 [01:28<00:06,  5.53it/s] 93%|█████████▎| 438/471 [01:28<00:06,  5.00it/s] 93%|█████████▎| 439/471 [01:28<00:06,  4.86it/s] 93%|█████████▎| 440/471 [01:28<00:06,  4.89it/s] 94%|█████████▎| 441/471 [01:29<00:06,  4.71it/s] 94%|█████████▍| 442/471 [01:29<00:05,  5.01it/s] 94%|█████████▍| 443/471 [01:29<00:05,  4.67it/s] 94%|█████████▍| 444/471 [01:29<00:05,  4.83it/s] 94%|█████████▍| 445/471 [01:30<00:05,  4.64it/s] 95%|█████████▍| 446/471 [01:30<00:05,  4.73it/s] 95%|█████████▍| 447/471 [01:30<00:05,  4.71it/s] 95%|█████████▌| 448/471 [01:30<00:04,  4.83it/s] 95%|█████████▌| 449/471 [01:30<00:04,  4.58it/s] 96%|█████████▌| 450/471 [01:31<00:04,  4.76it/s] 96%|█████████▌| 451/471 [01:31<00:04,  4.52it/s] 96%|█████████▌| 452/471 [01:31<00:03,  4.79it/s] 96%|█████████▌| 453/471 [01:31<00:03,  4.56it/s] 96%|█████████▋| 454/471 [01:31<00:03,  4.68it/s] 97%|█████████▋| 455/471 [01:32<00:03,  4.46it/s] 97%|█████████▋| 456/471 [01:32<00:03,  4.63it/s] 97%|█████████▋| 457/471 [01:32<00:03,  4.62it/s] 97%|█████████▋| 458/471 [01:32<00:02,  4.73it/s] 97%|█████████▋| 459/471 [01:33<00:02,  4.68it/s] 98%|█████████▊| 460/471 [01:33<00:02,  4.62it/s] 98%|█████████▊| 461/471 [01:33<00:02,  4.73it/s] 98%|█████████▊| 462/471 [01:33<00:01,  4.64it/s] 98%|█████████▊| 463/471 [01:33<00:01,  4.90it/s] 99%|█████████▊| 464/471 [01:34<00:01,  4.62it/s] 99%|█████████▊| 465/471 [01:34<00:01,  4.77it/s] 99%|█████████▉| 466/471 [01:34<00:01,  4.51it/s] 99%|█████████▉| 467/471 [01:34<00:00,  4.83it/s] 99%|█████████▉| 468/471 [01:34<00:00,  4.57it/s]100%|█████████▉| 469/471 [01:35<00:00,  4.88it/s]100%|█████████▉| 470/471 [01:35<00:00,  4.55it/s]100%|██████████| 471/471 [01:35<00:00,  4.81it/s]100%|██████████| 471/471 [01:35<00:00,  4.93it/s]
{'eval_loss': 2.6653034687042236, 'eval_model_preparation_time': 0.0062, 'eval_acc': 0.29182156133828996, 'eval_runtime': 95.7486, 'eval_samples_per_second': 78.664, 'eval_steps_per_second': 4.919}
ROUND:3
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.13it/s]                                              {'loss': 2.7016, 'grad_norm': 3.3026671409606934, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.13it/s]  5%|▌         | 2/40 [00:01<00:31,  1.20it/s]                                              {'loss': 2.7547, 'grad_norm': 3.411205768585205, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:31,  1.20it/s]  8%|▊         | 3/40 [00:01<00:23,  1.55it/s]                                              {'loss': 2.7205, 'grad_norm': 2.936997652053833, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.55it/s] 10%|█         | 4/40 [00:02<00:20,  1.74it/s]                                              {'loss': 2.6762, 'grad_norm': 2.5302627086639404, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.74it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.90it/s]                                              {'loss': 2.5681, 'grad_norm': 2.6141035556793213, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.90it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.01it/s]                                              {'loss': 2.7407, 'grad_norm': 2.625309705734253, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.01it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.07it/s]                                              {'loss': 2.7295, 'grad_norm': 3.800041437149048, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.07it/s] 20%|██        | 8/40 [00:04<00:16,  1.97it/s]                                              {'loss': 3.218, 'grad_norm': 18.719192504882812, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.97it/s] 22%|██▎       | 9/40 [00:04<00:15,  2.03it/s]                                              {'loss': 2.8929, 'grad_norm': 2.9799540042877197, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:15,  2.03it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s]                                               {'loss': 2.5791, 'grad_norm': 2.6691336631774902, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.16it/s]                                               {'loss': 2.5562, 'grad_norm': 2.933582067489624, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.16it/s] 30%|███       | 12/40 [00:06<00:13,  2.14it/s]                                               {'loss': 2.5409, 'grad_norm': 2.6795995235443115, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:13,  2.14it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.15it/s]                                               {'loss': 2.4484, 'grad_norm': 3.5407371520996094, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.15it/s] 35%|███▌      | 14/40 [00:07<00:12,  2.12it/s]                                               {'loss': 2.652, 'grad_norm': 2.5387306213378906, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:12,  2.12it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.14it/s]                                               {'loss': 2.6364, 'grad_norm': 3.3153157234191895, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.14it/s]                                               {'loss': 1.6801, 'grad_norm': 10.21853256225586, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:11,  2.14it/s] 42%|████▎     | 17/40 [00:08<00:08,  2.62it/s]                                               {'loss': 2.3968, 'grad_norm': 3.500040054321289, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:08,  2.62it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.51it/s]                                               {'loss': 2.3452, 'grad_norm': 2.1089816093444824, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.51it/s] 48%|████▊     | 19/40 [00:09<00:08,  2.44it/s]                                               {'loss': 2.6168, 'grad_norm': 3.141629457473755, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:08,  2.44it/s] 50%|█████     | 20/40 [00:09<00:08,  2.35it/s]                                               {'loss': 2.4922, 'grad_norm': 2.558443546295166, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.35it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.33it/s]                                               {'loss': 2.4317, 'grad_norm': 2.8839941024780273, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.29it/s]                                               {'loss': 2.6466, 'grad_norm': 2.779879570007324, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s]                                               {'loss': 2.6577, 'grad_norm': 2.85372257232666, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s] 60%|██████    | 24/40 [00:10<00:05,  2.83it/s]                                               {'loss': 2.5496, 'grad_norm': 8.040595054626465, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.59it/s]                                               {'loss': 2.6441, 'grad_norm': 2.7219760417938232, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.42it/s]                                               {'loss': 2.549, 'grad_norm': 3.3805272579193115, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.42it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.35it/s]                                               {'loss': 2.2867, 'grad_norm': 2.4625909328460693, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.35it/s] 70%|███████   | 28/40 [00:12<00:05,  2.24it/s]                                               {'loss': 2.4695, 'grad_norm': 2.933067798614502, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.24it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.5591, 'grad_norm': 2.752307653427124, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.21it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s]                                               {'loss': 2.3947, 'grad_norm': 2.796748399734497, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s] 78%|███████▊  | 31/40 [00:14<00:04,  2.20it/s]                                               {'loss': 2.449, 'grad_norm': 3.2130653858184814, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:04,  2.20it/s]                                               {'loss': 2.7655, 'grad_norm': 7.840111255645752, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:03,  2.20it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.79it/s]                                               {'loss': 2.4029, 'grad_norm': 2.526155948638916, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.79it/s] 85%|████████▌ | 34/40 [00:15<00:02,  2.59it/s]                                               {'loss': 2.3773, 'grad_norm': 2.567138195037842, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:15<00:02,  2.59it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.47it/s]                                               {'loss': 2.3857, 'grad_norm': 2.8835384845733643, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.47it/s] 90%|█████████ | 36/40 [00:16<00:01,  2.40it/s]                                               {'loss': 2.4268, 'grad_norm': 2.79138445854187, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:16<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.32it/s]                                               {'loss': 2.4826, 'grad_norm': 2.4288055896759033, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.32it/s] 95%|█████████▌| 38/40 [00:17<00:00,  2.30it/s]                                               {'loss': 2.7232, 'grad_norm': 3.1111819744110107, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:17<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.23it/s]                                               {'loss': 2.3563, 'grad_norm': 2.5891072750091553, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.23it/s]100%|██████████| 40/40 [00:17<00:00,  2.86it/s]                                               {'loss': 2.2054, 'grad_norm': 10.247864723205566, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.86it/s]                                               {'train_runtime': 17.7056, 'train_samples_per_second': 31.911, 'train_steps_per_second': 2.259, 'train_loss': 2.5427462965250016, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.86it/s]100%|██████████| 40/40 [00:17<00:00,  2.26it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.69it/s]                                              {'loss': 2.6642, 'grad_norm': 2.3997905254364014, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.69it/s]  5%|▌         | 2/40 [00:00<00:14,  2.70it/s]                                              {'loss': 2.6914, 'grad_norm': 3.6793999671936035, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:14,  2.70it/s]  8%|▊         | 3/40 [00:01<00:13,  2.73it/s]                                              {'loss': 2.7605, 'grad_norm': 3.7721917629241943, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.73it/s] 10%|█         | 4/40 [00:01<00:13,  2.75it/s]                                              {'loss': 2.7425, 'grad_norm': 2.862908124923706, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.75it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.73it/s]                                              {'loss': 2.8107, 'grad_norm': 3.4424798488616943, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.73it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.71it/s]                                              {'loss': 2.8107, 'grad_norm': 2.5709798336029053, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.71it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.70it/s]                                              {'loss': 2.7101, 'grad_norm': 3.0392143726348877, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.70it/s]                                              {'loss': 3.0797, 'grad_norm': 10.185846328735352, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.70it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.35it/s]                                              {'loss': 2.6954, 'grad_norm': 2.3998942375183105, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.35it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.18it/s]                                               {'loss': 2.7305, 'grad_norm': 2.3953018188476562, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.18it/s] 28%|██▊       | 11/40 [00:03<00:09,  3.05it/s]                                               {'loss': 2.6369, 'grad_norm': 2.1642959117889404, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  3.05it/s] 30%|███       | 12/40 [00:04<00:09,  2.94it/s]                                               {'loss': 2.7745, 'grad_norm': 3.2718026638031006, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.94it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.89it/s]                                               {'loss': 2.6842, 'grad_norm': 3.7471272945404053, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.89it/s] 35%|███▌      | 14/40 [00:04<00:09,  2.74it/s]                                               {'loss': 2.5288, 'grad_norm': 2.745338201522827, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:09,  2.74it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.51it/s]                                               {'loss': 2.6846, 'grad_norm': 3.2763073444366455, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.51it/s] 40%|████      | 16/40 [00:05<00:07,  3.14it/s]                                               {'loss': 2.6632, 'grad_norm': 13.478131294250488, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.14it/s] 42%|████▎     | 17/40 [00:05<00:07,  2.88it/s]                                               {'loss': 2.526, 'grad_norm': 2.6001384258270264, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:07,  2.88it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.61it/s]                                               {'loss': 2.5599, 'grad_norm': 2.3743138313293457, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.61it/s] 48%|████▊     | 19/40 [00:06<00:08,  2.51it/s]                                               {'loss': 2.5598, 'grad_norm': 2.743138074874878, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:08,  2.51it/s] 50%|█████     | 20/40 [00:07<00:08,  2.44it/s]                                               {'loss': 2.4818, 'grad_norm': 2.2448222637176514, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.44it/s] 52%|█████▎    | 21/40 [00:07<00:07,  2.39it/s]                                               {'loss': 2.5562, 'grad_norm': 2.4424550533294678, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:07,  2.39it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.38it/s]                                               {'loss': 2.5144, 'grad_norm': 2.810112237930298, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.38it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.30it/s]                                               {'loss': 2.5766, 'grad_norm': 2.9719953536987305, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.30it/s] 60%|██████    | 24/40 [00:08<00:05,  2.88it/s]                                               {'loss': 2.9679, 'grad_norm': 9.561111450195312, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.69it/s]                                               {'loss': 2.5844, 'grad_norm': 3.0565712451934814, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.69it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.57it/s]                                               {'loss': 2.5478, 'grad_norm': 2.62909197807312, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.57it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.49it/s]                                               {'loss': 2.5407, 'grad_norm': 2.8223721981048584, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.49it/s] 70%|███████   | 28/40 [00:10<00:04,  2.46it/s]                                               {'loss': 2.6998, 'grad_norm': 2.963103771209717, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.46it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.39it/s]                                               {'loss': 2.5604, 'grad_norm': 2.7992920875549316, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.39it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.34it/s]                                               {'loss': 2.5056, 'grad_norm': 2.5148398876190186, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.34it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.30it/s]                                               {'loss': 2.4113, 'grad_norm': 2.8735015392303467, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.30it/s] 80%|████████  | 32/40 [00:11<00:02,  2.85it/s]                                               {'loss': 2.8308, 'grad_norm': 11.673696517944336, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s]                                               {'loss': 2.5197, 'grad_norm': 2.454676389694214, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.65it/s]                                               {'loss': 2.5403, 'grad_norm': 3.0585451126098633, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.65it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.70it/s]                                               {'loss': 2.5391, 'grad_norm': 2.3781020641326904, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.70it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.63it/s]                                               {'loss': 2.4939, 'grad_norm': 3.10312819480896, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.63it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.46it/s]                                               {'loss': 2.4948, 'grad_norm': 2.9392940998077393, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.46it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.36it/s]                                               {'loss': 2.4418, 'grad_norm': 2.8934648036956787, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.36it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.32it/s]                                               {'loss': 2.3927, 'grad_norm': 2.5146570205688477, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.32it/s]100%|██████████| 40/40 [00:15<00:00,  2.91it/s]                                               {'loss': 2.3054, 'grad_norm': 10.233258247375488, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.91it/s]                                               {'train_runtime': 15.1247, 'train_samples_per_second': 37.356, 'train_steps_per_second': 2.645, 'train_loss': 2.620478940010071, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.91it/s]100%|██████████| 40/40 [00:15<00:00,  2.64it/s]
CLIENT:76
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.668, 'grad_norm': 2.5034594535827637, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.6437, 'grad_norm': 2.682852029800415, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]  8%|▊         | 3/40 [00:01<00:17,  2.16it/s]                                              {'loss': 2.8375, 'grad_norm': 3.5104658603668213, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.16it/s] 10%|█         | 4/40 [00:01<00:16,  2.18it/s]                                              {'loss': 2.663, 'grad_norm': 2.7701776027679443, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.18it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.19it/s]                                              {'loss': 2.6509, 'grad_norm': 3.615025758743286, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.7677, 'grad_norm': 2.714998245239258, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.6674, 'grad_norm': 2.973057270050049, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.8503, 'grad_norm': 9.72469711303711, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.22it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s]                                              {'loss': 2.6903, 'grad_norm': 2.5379109382629395, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.61it/s]                                               {'loss': 2.5544, 'grad_norm': 2.2614552974700928, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.61it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.52it/s]                                               {'loss': 2.7129, 'grad_norm': 3.074336290359497, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.52it/s] 30%|███       | 12/40 [00:05<00:11,  2.39it/s]                                               {'loss': 2.5792, 'grad_norm': 2.650820732116699, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.39it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.564, 'grad_norm': 1.9939749240875244, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.28it/s]                                               {'loss': 2.506, 'grad_norm': 2.1598098278045654, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.5399, 'grad_norm': 2.5173397064208984, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s] 40%|████      | 16/40 [00:06<00:08,  2.81it/s]                                               {'loss': 2.4963, 'grad_norm': 8.855147361755371, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.81it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.60it/s]                                               {'loss': 2.5017, 'grad_norm': 2.532532215118408, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.60it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.4535, 'grad_norm': 3.2774670124053955, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s]                                               {'loss': 2.5212, 'grad_norm': 2.8350086212158203, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s] 50%|█████     | 20/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.5086, 'grad_norm': 2.9226367473602295, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.33it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.2716, 'grad_norm': 2.279958724975586, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.4917, 'grad_norm': 3.9519119262695312, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.464, 'grad_norm': 2.874112129211426, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s] 60%|██████    | 24/40 [00:09<00:05,  2.87it/s]                                               {'loss': 2.6597, 'grad_norm': 10.515121459960938, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s]                                               {'loss': 2.4293, 'grad_norm': 2.509753704071045, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s]                                               {'loss': 2.5169, 'grad_norm': 2.511347532272339, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.3979, 'grad_norm': 2.8150229454040527, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.33it/s]                                               {'loss': 2.3727, 'grad_norm': 3.2430691719055176, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.4922, 'grad_norm': 2.715224027633667, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.4507, 'grad_norm': 3.219651699066162, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s]                                               {'loss': 2.4541, 'grad_norm': 3.07973051071167, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s]                                               {'loss': 2.5013, 'grad_norm': 11.353787422180176, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.19it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.74it/s]                                               {'loss': 2.3932, 'grad_norm': 2.693861961364746, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.74it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.55it/s]                                               {'loss': 2.573, 'grad_norm': 2.880777597427368, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.48it/s]                                               {'loss': 2.5697, 'grad_norm': 2.2313435077667236, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.48it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.41it/s]                                               {'loss': 2.4082, 'grad_norm': 2.9495394229888916, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.41it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.35it/s]                                               {'loss': 2.3051, 'grad_norm': 2.536240816116333, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.35it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.33it/s]                                               {'loss': 2.4688, 'grad_norm': 2.6177330017089844, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.33it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.28it/s]                                               {'loss': 2.365, 'grad_norm': 2.3779399394989014, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.28it/s]100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'loss': 2.3471, 'grad_norm': 9.506906509399414, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'train_runtime': 16.5626, 'train_samples_per_second': 34.113, 'train_steps_per_second': 2.415, 'train_loss': 2.5327185869216917, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.14it/s]                                              {'loss': 2.6823, 'grad_norm': 2.4922289848327637, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.14it/s]  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.5699, 'grad_norm': 2.852226972579956, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]  8%|▊         | 3/40 [00:01<00:17,  2.14it/s]                                              {'loss': 2.8934, 'grad_norm': 3.1992247104644775, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.14it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.6958, 'grad_norm': 2.505128860473633, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s]                                              {'loss': 2.6712, 'grad_norm': 2.711934804916382, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s]                                              {'loss': 2.6386, 'grad_norm': 3.1375441551208496, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s]                                              {'loss': 2.7524, 'grad_norm': 2.8704636096954346, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s] 20%|██        | 8/40 [00:03<00:11,  2.88it/s]                                              {'loss': 2.7388, 'grad_norm': 9.336134910583496, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.88it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s]                                              {'loss': 2.6523, 'grad_norm': 2.816720962524414, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.58it/s]                                               {'loss': 2.614, 'grad_norm': 2.828988790512085, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.58it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.58it/s]                                               {'loss': 2.6671, 'grad_norm': 2.965784788131714, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.58it/s] 30%|███       | 12/40 [00:04<00:10,  2.58it/s]                                               {'loss': 2.5965, 'grad_norm': 2.757133960723877, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.58it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.61it/s]                                               {'loss': 2.6214, 'grad_norm': 4.03047513961792, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.61it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.58it/s]                                               {'loss': 2.6024, 'grad_norm': 2.9762940406799316, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.58it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.61it/s]                                               {'loss': 2.5134, 'grad_norm': 2.6069164276123047, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.61it/s] 40%|████      | 16/40 [00:06<00:07,  3.32it/s]                                               {'loss': 2.4761, 'grad_norm': 11.700806617736816, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.32it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.18it/s]                                               {'loss': 2.5648, 'grad_norm': 3.1660397052764893, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.18it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.20it/s]                                               {'loss': 2.4772, 'grad_norm': 2.5411951541900635, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.20it/s] 48%|████▊     | 19/40 [00:07<00:06,  3.24it/s]                                               {'loss': 2.5108, 'grad_norm': 2.9437270164489746, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:06,  3.24it/s] 50%|█████     | 20/40 [00:07<00:06,  3.27it/s]                                               {'loss': 2.5332, 'grad_norm': 2.4426259994506836, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  3.27it/s] 52%|█████▎    | 21/40 [00:07<00:05,  3.31it/s]                                               {'loss': 2.5256, 'grad_norm': 2.5407886505126953, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:05,  3.31it/s] 55%|█████▌    | 22/40 [00:08<00:05,  3.36it/s]                                               {'loss': 2.5057, 'grad_norm': 2.51633620262146, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:05,  3.36it/s] 57%|█████▊    | 23/40 [00:08<00:04,  3.41it/s]                                               {'loss': 2.4913, 'grad_norm': 3.2526025772094727, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:04,  3.41it/s]                                               {'loss': 2.5598, 'grad_norm': 10.126139640808105, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:04,  3.41it/s] 62%|██████▎   | 25/40 [00:08<00:03,  3.84it/s]                                               {'loss': 2.4171, 'grad_norm': 2.42008376121521, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:03,  3.84it/s] 65%|██████▌   | 26/40 [00:09<00:04,  3.45it/s]                                               {'loss': 2.628, 'grad_norm': 2.6644527912139893, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  3.45it/s] 68%|██████▊   | 27/40 [00:09<00:04,  3.21it/s]                                               {'loss': 2.5311, 'grad_norm': 2.5044193267822266, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  3.21it/s] 70%|███████   | 28/40 [00:09<00:03,  3.03it/s]                                               {'loss': 2.4862, 'grad_norm': 2.495602607727051, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:09<00:03,  3.03it/s] 72%|███████▎  | 29/40 [00:10<00:03,  2.90it/s]                                               {'loss': 2.4816, 'grad_norm': 2.92167592048645, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:03,  2.90it/s] 75%|███████▌  | 30/40 [00:10<00:03,  2.84it/s]                                               {'loss': 2.472, 'grad_norm': 2.8045647144317627, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:10<00:03,  2.84it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.77it/s]                                               {'loss': 2.5025, 'grad_norm': 2.783799886703491, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.77it/s]                                               {'loss': 1.5647, 'grad_norm': 9.29418659210205, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.77it/s] 82%|████████▎ | 33/40 [00:11<00:02,  3.31it/s]                                               {'loss': 2.4765, 'grad_norm': 2.4688925743103027, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:11<00:02,  3.31it/s] 85%|████████▌ | 34/40 [00:11<00:01,  3.12it/s]                                               {'loss': 2.4573, 'grad_norm': 2.914309501647949, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:11<00:01,  3.12it/s] 88%|████████▊ | 35/40 [00:12<00:01,  2.79it/s]                                               {'loss': 2.3995, 'grad_norm': 2.304673433303833, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:12<00:01,  2.79it/s] 90%|█████████ | 36/40 [00:12<00:01,  2.58it/s]                                               {'loss': 2.5539, 'grad_norm': 2.9541373252868652, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:12<00:01,  2.58it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.48it/s]                                               {'loss': 2.6363, 'grad_norm': 2.8052256107330322, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.48it/s] 95%|█████████▌| 38/40 [00:13<00:00,  2.35it/s]                                               {'loss': 2.4391, 'grad_norm': 4.976071357727051, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:00,  2.35it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.29it/s]                                               {'loss': 2.4469, 'grad_norm': 2.524521589279175, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.29it/s]100%|██████████| 40/40 [00:14<00:00,  2.93it/s]                                               {'loss': 2.7235, 'grad_norm': 11.983956336975098, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.93it/s]                                               {'train_runtime': 14.4302, 'train_samples_per_second': 39.154, 'train_steps_per_second': 2.772, 'train_loss': 2.5442518651485444, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.93it/s]100%|██████████| 40/40 [00:14<00:00,  2.77it/s]
CLIENT:56
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:31,  1.23it/s]                                              {'loss': 2.8664, 'grad_norm': 2.846167802810669, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:31,  1.23it/s]  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]                                              {'loss': 2.6823, 'grad_norm': 2.550246238708496, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.47it/s]  8%|▊         | 3/40 [00:01<00:20,  1.77it/s]                                              {'loss': 2.7067, 'grad_norm': 2.830261707305908, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:20,  1.77it/s] 10%|█         | 4/40 [00:02<00:19,  1.87it/s]                                              {'loss': 2.7985, 'grad_norm': 2.7889459133148193, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.87it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s]                                              {'loss': 2.6036, 'grad_norm': 2.822746515274048, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.12it/s]                                              {'loss': 2.6426, 'grad_norm': 2.290571928024292, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.12it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s]                                              {'loss': 2.7368, 'grad_norm': 2.4677093029022217, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s] 20%|██        | 8/40 [00:04<00:14,  2.14it/s]                                              {'loss': 3.401, 'grad_norm': 13.952136993408203, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.14it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.15it/s]                                              {'loss': 2.6383, 'grad_norm': 2.870488405227661, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.15it/s] 25%|██▌       | 10/40 [00:05<00:13,  2.15it/s]                                               {'loss': 2.5738, 'grad_norm': 2.4527294635772705, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:13,  2.15it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.18it/s]                                               {'loss': 2.5547, 'grad_norm': 2.5702908039093018, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.18it/s] 30%|███       | 12/40 [00:05<00:13,  2.14it/s]                                               {'loss': 2.5577, 'grad_norm': 2.524155855178833, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:13,  2.14it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.16it/s]                                               {'loss': 2.8422, 'grad_norm': 2.648636817932129, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.16it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.5694, 'grad_norm': 2.6691348552703857, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:07<00:10,  2.31it/s]                                               {'loss': 2.504, 'grad_norm': 3.159207820892334, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:10,  2.31it/s] 40%|████      | 16/40 [00:07<00:08,  2.98it/s]                                               {'loss': 3.2554, 'grad_norm': 11.411407470703125, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.98it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.83it/s]                                               {'loss': 2.5482, 'grad_norm': 2.515793800354004, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.83it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.69it/s]                                               {'loss': 2.6228, 'grad_norm': 2.458076000213623, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.69it/s] 48%|████▊     | 19/40 [00:08<00:07,  2.68it/s]                                               {'loss': 2.6389, 'grad_norm': 2.8097712993621826, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:07,  2.68it/s] 50%|█████     | 20/40 [00:08<00:07,  2.60it/s]                                               {'loss': 2.4322, 'grad_norm': 2.436795949935913, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.60it/s] 52%|█████▎    | 21/40 [00:09<00:07,  2.47it/s]                                               {'loss': 2.523, 'grad_norm': 3.397151231765747, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:07,  2.47it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.36it/s]                                               {'loss': 2.5725, 'grad_norm': 2.6188530921936035, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.36it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.29it/s]                                               {'loss': 2.5786, 'grad_norm': 2.78413724899292, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.29it/s] 60%|██████    | 24/40 [00:10<00:05,  2.91it/s]                                               {'loss': 2.248, 'grad_norm': 8.593393325805664, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.91it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.72it/s]                                               {'loss': 2.4219, 'grad_norm': 2.232394218444824, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.72it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s]                                               {'loss': 2.5468, 'grad_norm': 2.918546676635742, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s]                                               {'loss': 2.435, 'grad_norm': 2.676933765411377, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s] 70%|███████   | 28/40 [00:12<00:05,  2.32it/s]                                               {'loss': 2.452, 'grad_norm': 2.6958088874816895, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.32it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.23it/s]                                               {'loss': 2.5649, 'grad_norm': 2.6555094718933105, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.23it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.24it/s]                                               {'loss': 2.5479, 'grad_norm': 2.6091480255126953, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.24it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.20it/s]                                               {'loss': 2.4543, 'grad_norm': 2.716052532196045, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.20it/s] 80%|████████  | 32/40 [00:13<00:02,  2.77it/s]                                               {'loss': 2.9101, 'grad_norm': 10.701279640197754, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.77it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.54it/s]                                               {'loss': 2.4495, 'grad_norm': 2.3647000789642334, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.54it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s]                                               {'loss': 2.5131, 'grad_norm': 2.364042282104492, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.33it/s]                                               {'loss': 2.5053, 'grad_norm': 3.0934677124023438, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.33it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.28it/s]                                               {'loss': 2.4869, 'grad_norm': 2.813052177429199, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.28it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.19it/s]                                               {'loss': 2.3999, 'grad_norm': 2.3815371990203857, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.19it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.17it/s]                                               {'loss': 2.5058, 'grad_norm': 2.753756523132324, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.17it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.17it/s]                                               {'loss': 2.5743, 'grad_norm': 2.764392375946045, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.17it/s]100%|██████████| 40/40 [00:17<00:00,  2.75it/s]                                               {'loss': 2.3371, 'grad_norm': 11.1483736038208, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.75it/s]                                               {'train_runtime': 17.3398, 'train_samples_per_second': 32.584, 'train_steps_per_second': 2.307, 'train_loss': 2.6050548613071443, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.75it/s]100%|██████████| 40/40 [00:17<00:00,  2.31it/s]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.6104, 'grad_norm': 3.8117148876190186, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.7392, 'grad_norm': 2.7954728603363037, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]  8%|▊         | 3/40 [00:01<00:17,  2.13it/s]                                              {'loss': 2.6659, 'grad_norm': 2.4528651237487793, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.13it/s] 10%|█         | 4/40 [00:01<00:16,  2.17it/s]                                              {'loss': 2.7021, 'grad_norm': 2.464522361755371, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.17it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s]                                              {'loss': 2.6313, 'grad_norm': 2.600820779800415, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.7468, 'grad_norm': 3.7773165702819824, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 2.5281, 'grad_norm': 2.341796398162842, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s] 20%|██        | 8/40 [00:03<00:11,  2.81it/s]                                              {'loss': 2.9977, 'grad_norm': 8.569257736206055, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.81it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s]                                              {'loss': 2.5299, 'grad_norm': 2.581770658493042, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s]                                               {'loss': 2.6443, 'grad_norm': 3.0528194904327393, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s]                                               {'loss': 2.5959, 'grad_norm': 2.254685163497925, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s] 30%|███       | 12/40 [00:05<00:12,  2.24it/s]                                               {'loss': 2.4813, 'grad_norm': 2.782405138015747, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.24it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.4179, 'grad_norm': 2.768218517303467, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.4446, 'grad_norm': 3.206599712371826, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.5885, 'grad_norm': 2.718122959136963, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.86it/s]                                               {'loss': 2.8139, 'grad_norm': 10.341160774230957, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.86it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.4577, 'grad_norm': 2.998915910720825, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.5367, 'grad_norm': 3.031754493713379, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.4314, 'grad_norm': 2.1196422576904297, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s] 50%|█████     | 20/40 [00:08<00:08,  2.26it/s]                                               {'loss': 2.5792, 'grad_norm': 3.301792860031128, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.26it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.4478, 'grad_norm': 2.57820463180542, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.5771, 'grad_norm': 2.7476437091827393, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.34it/s]                                               {'loss': 2.3402, 'grad_norm': 1.9852991104125977, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.34it/s] 60%|██████    | 24/40 [00:10<00:05,  2.99it/s]                                               {'loss': 2.2283, 'grad_norm': 8.075434684753418, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.99it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.88it/s]                                               {'loss': 2.4279, 'grad_norm': 2.371002674102783, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.88it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.74it/s]                                               {'loss': 2.4937, 'grad_norm': 2.8023221492767334, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.74it/s] 68%|██████▊   | 27/40 [00:11<00:04,  2.71it/s]                                               {'loss': 2.4689, 'grad_norm': 2.377033233642578, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:04,  2.71it/s] 70%|███████   | 28/40 [00:11<00:04,  2.60it/s]                                               {'loss': 2.4605, 'grad_norm': 2.514040231704712, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.60it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.54it/s]                                               {'loss': 2.2515, 'grad_norm': 2.739069700241089, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.54it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.41it/s]                                               {'loss': 2.4705, 'grad_norm': 2.5848488807678223, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.41it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.32it/s]                                               {'loss': 2.404, 'grad_norm': 2.455475091934204, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.32it/s] 80%|████████  | 32/40 [00:13<00:02,  2.89it/s]                                               {'loss': 2.5371, 'grad_norm': 16.31532859802246, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.89it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.3864, 'grad_norm': 2.2683205604553223, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.4141, 'grad_norm': 3.3667871952056885, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s]                                               {'loss': 2.4315, 'grad_norm': 2.846928119659424, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s]                                               {'loss': 2.332, 'grad_norm': 2.218858242034912, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.46it/s]                                               {'loss': 2.3472, 'grad_norm': 2.5557751655578613, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.46it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.51it/s]                                               {'loss': 2.3574, 'grad_norm': 2.853984832763672, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.51it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.55it/s]                                               {'loss': 2.4494, 'grad_norm': 2.2769041061401367, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.55it/s]100%|██████████| 40/40 [00:16<00:00,  3.22it/s]                                               {'loss': 2.2172, 'grad_norm': 9.174005508422852, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.22it/s]                                               {'train_runtime': 16.2589, 'train_samples_per_second': 34.75, 'train_steps_per_second': 2.46, 'train_loss': 2.5046438217163085, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.22it/s]100%|██████████| 40/40 [00:16<00:00,  2.46it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.6683, 'grad_norm': 2.2288477420806885, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]  5%|▌         | 2/40 [00:00<00:17,  2.13it/s]                                              {'loss': 2.7636, 'grad_norm': 3.0471885204315186, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.13it/s]  8%|▊         | 3/40 [00:01<00:17,  2.17it/s]                                              {'loss': 2.7651, 'grad_norm': 2.410093069076538, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.17it/s] 10%|█         | 4/40 [00:01<00:17,  2.11it/s]                                              {'loss': 2.6149, 'grad_norm': 2.3305821418762207, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:17,  2.11it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s]                                              {'loss': 2.6714, 'grad_norm': 2.7752139568328857, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.7143, 'grad_norm': 2.648653745651245, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.13it/s]                                              {'loss': 2.6241, 'grad_norm': 2.5579662322998047, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.13it/s] 20%|██        | 8/40 [00:03<00:11,  2.77it/s]                                              {'loss': 2.4869, 'grad_norm': 10.544488906860352, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.77it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.54it/s]                                              {'loss': 2.6254, 'grad_norm': 2.417508363723755, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.54it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.5303, 'grad_norm': 2.7668874263763428, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.40it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s]                                               {'loss': 2.6338, 'grad_norm': 2.4442286491394043, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s] 30%|███       | 12/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.5369, 'grad_norm': 3.1120359897613525, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.23it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s]                                               {'loss': 2.7984, 'grad_norm': 2.95759916305542, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.6627, 'grad_norm': 2.316068410873413, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.15it/s]                                               {'loss': 2.5976, 'grad_norm': 2.7594544887542725, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.15it/s] 40%|████      | 16/40 [00:06<00:08,  2.78it/s]                                               {'loss': 3.2529, 'grad_norm': 9.776808738708496, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.78it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.427, 'grad_norm': 2.5020172595977783, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.38it/s]                                               {'loss': 2.5344, 'grad_norm': 2.2960586547851562, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.38it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.32it/s]                                               {'loss': 2.6526, 'grad_norm': 2.8803837299346924, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:09,  2.32it/s] 50%|█████     | 20/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.6016, 'grad_norm': 2.5196187496185303, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.41it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.36it/s]                                               {'loss': 2.5419, 'grad_norm': 2.4213101863861084, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.36it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.25it/s]                                               {'loss': 2.4316, 'grad_norm': 2.175555944442749, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.25it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.22it/s]                                               {'loss': 2.5304, 'grad_norm': 2.475876569747925, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.22it/s] 60%|██████    | 24/40 [00:10<00:05,  2.86it/s]                                               {'loss': 2.3685, 'grad_norm': 12.706733703613281, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.86it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.55it/s]                                               {'loss': 2.5321, 'grad_norm': 2.3272855281829834, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.55it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.42it/s]                                               {'loss': 2.4253, 'grad_norm': 2.277860641479492, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.42it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.5989, 'grad_norm': 2.7044270038604736, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s] 70%|███████   | 28/40 [00:12<00:05,  2.26it/s]                                               {'loss': 2.5529, 'grad_norm': 2.636845827102661, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.26it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.6209, 'grad_norm': 3.056112289428711, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.18it/s]                                               {'loss': 2.3359, 'grad_norm': 2.5130691528320312, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.18it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.17it/s]                                               {'loss': 2.4725, 'grad_norm': 2.8509533405303955, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.17it/s] 80%|████████  | 32/40 [00:13<00:02,  2.81it/s]                                               {'loss': 2.3875, 'grad_norm': 9.688100814819336, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.81it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.53it/s]                                               {'loss': 2.518, 'grad_norm': 2.4027109146118164, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.53it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.40it/s]                                               {'loss': 2.476, 'grad_norm': 3.099792718887329, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.40it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.31it/s]                                               {'loss': 2.5522, 'grad_norm': 2.7598941326141357, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.31it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.24it/s]                                               {'loss': 2.429, 'grad_norm': 2.4878768920898438, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.24it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s]                                               {'loss': 2.4755, 'grad_norm': 2.7378344535827637, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.18it/s]                                               {'loss': 2.5252, 'grad_norm': 2.5760397911071777, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.18it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.17it/s]                                               {'loss': 2.4276, 'grad_norm': 2.62827730178833, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.17it/s]100%|██████████| 40/40 [00:16<00:00,  2.77it/s]                                               {'loss': 2.5681, 'grad_norm': 8.686063766479492, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.77it/s]                                               {'train_runtime': 17.0976, 'train_samples_per_second': 33.046, 'train_steps_per_second': 2.34, 'train_loss': 2.5733073234558104, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.77it/s]100%|██████████| 40/40 [00:17<00:00,  2.34it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.38it/s]                                              {'loss': 2.5218, 'grad_norm': 2.0788981914520264, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.38it/s]  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.705, 'grad_norm': 2.8921732902526855, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]  8%|▊         | 3/40 [00:01<00:16,  2.22it/s]                                              {'loss': 2.6704, 'grad_norm': 2.977372407913208, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.22it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.8243, 'grad_norm': 2.479490280151367, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s]                                              {'loss': 2.9177, 'grad_norm': 3.2864596843719482, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.16it/s]                                              {'loss': 2.8091, 'grad_norm': 2.899430274963379, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.16it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.6939, 'grad_norm': 3.213129758834839, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s] 20%|██        | 8/40 [00:03<00:11,  2.73it/s]                                              {'loss': 2.3559, 'grad_norm': 6.75165319442749, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.73it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s]                                              {'loss': 2.6287, 'grad_norm': 2.5528645515441895, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.38it/s]                                               {'loss': 2.6166, 'grad_norm': 3.0819263458251953, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.38it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s]                                               {'loss': 2.7544, 'grad_norm': 2.8929121494293213, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.32it/s] 30%|███       | 12/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.6515, 'grad_norm': 2.589526653289795, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.25it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s]                                               {'loss': 2.5767, 'grad_norm': 3.0266010761260986, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.6992, 'grad_norm': 3.236138343811035, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.6097, 'grad_norm': 2.809541702270508, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.80it/s]                                               {'loss': 2.213, 'grad_norm': 16.146373748779297, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.5298, 'grad_norm': 2.1995012760162354, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.575, 'grad_norm': 3.942715883255005, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.34it/s]                                               {'loss': 2.679, 'grad_norm': 2.568720579147339, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.34it/s] 50%|█████     | 20/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.5278, 'grad_norm': 2.36208438873291, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.28it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.21it/s]                                               {'loss': 2.6906, 'grad_norm': 2.600600004196167, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.21it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.19it/s]                                               {'loss': 2.4971, 'grad_norm': 3.2986953258514404, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.19it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s]                                               {'loss': 2.6395, 'grad_norm': 4.8831682205200195, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s] 60%|██████    | 24/40 [00:10<00:05,  2.79it/s]                                               {'loss': 2.2851, 'grad_norm': 8.599126815795898, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.79it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s]                                               {'loss': 2.3507, 'grad_norm': 2.8948237895965576, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.43it/s]                                               {'loss': 2.4784, 'grad_norm': 2.5063893795013428, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.43it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.6219, 'grad_norm': 2.4370877742767334, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.6498, 'grad_norm': 2.8067569732666016, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s]                                               {'loss': 2.6368, 'grad_norm': 2.9064340591430664, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.41it/s]                                               {'loss': 2.4319, 'grad_norm': 3.14345383644104, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.41it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.46it/s]                                               {'loss': 2.5653, 'grad_norm': 3.0293045043945312, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.46it/s] 80%|████████  | 32/40 [00:13<00:02,  3.14it/s]                                               {'loss': 1.9303, 'grad_norm': 11.681159973144531, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  3.14it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.94it/s]                                               {'loss': 2.5049, 'grad_norm': 3.482914686203003, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.94it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.91it/s]                                               {'loss': 2.5532, 'grad_norm': 2.5173232555389404, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.91it/s] 88%|████████▊ | 35/40 [00:14<00:01,  3.02it/s]                                               {'loss': 2.455, 'grad_norm': 2.677255153656006, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  3.02it/s] 90%|█████████ | 36/40 [00:14<00:01,  3.10it/s]                                               {'loss': 2.4514, 'grad_norm': 2.5616495609283447, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  3.10it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.96it/s]                                               {'loss': 2.5605, 'grad_norm': 2.7683637142181396, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.96it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.86it/s]                                               {'loss': 2.5456, 'grad_norm': 2.3357160091400146, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.86it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.80it/s]                                               {'loss': 2.5032, 'grad_norm': 2.5864806175231934, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.80it/s]                                               {'loss': 2.3142, 'grad_norm': 11.756608963012695, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.80it/s]                                               {'train_runtime': 15.9467, 'train_samples_per_second': 35.43, 'train_steps_per_second': 2.508, 'train_loss': 2.5556249380111695, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.80it/s]100%|██████████| 40/40 [00:15<00:00,  2.51it/s]
CLIENT:60
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.24it/s]                                              {'loss': 2.7147, 'grad_norm': 2.4852113723754883, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.24it/s]  5%|▌         | 2/40 [00:00<00:16,  2.24it/s]                                              {'loss': 2.6852, 'grad_norm': 2.355226516723633, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.24it/s]  8%|▊         | 3/40 [00:01<00:16,  2.29it/s]                                              {'loss': 2.6012, 'grad_norm': 2.9677884578704834, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.29it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.6432, 'grad_norm': 2.783341884613037, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s]                                              {'loss': 2.6962, 'grad_norm': 3.126980781555176, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.657, 'grad_norm': 2.5347073078155518, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s]                                              {'loss': 2.5621, 'grad_norm': 2.770235776901245, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s] 20%|██        | 8/40 [00:03<00:11,  2.85it/s]                                              {'loss': 3.643, 'grad_norm': 11.95943546295166, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.85it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s]                                              {'loss': 2.5512, 'grad_norm': 2.5468790531158447, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s]                                               {'loss': 2.4803, 'grad_norm': 2.6082606315612793, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s]                                               {'loss': 2.4783, 'grad_norm': 2.33370041847229, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s] 30%|███       | 12/40 [00:05<00:12,  2.26it/s]                                               {'loss': 2.745, 'grad_norm': 2.8050293922424316, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.4559, 'grad_norm': 2.504725694656372, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.5921, 'grad_norm': 2.7709426879882812, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.6066, 'grad_norm': 3.099292039871216, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s] 40%|████      | 16/40 [00:06<00:08,  2.78it/s]                                               {'loss': 3.0861, 'grad_norm': 11.118849754333496, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.78it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.6013, 'grad_norm': 2.6934492588043213, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.42it/s]                                               {'loss': 2.4759, 'grad_norm': 2.3725874423980713, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.42it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.369, 'grad_norm': 3.2744531631469727, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s] 50%|█████     | 20/40 [00:08<00:08,  2.47it/s]                                               {'loss': 2.3599, 'grad_norm': 2.664233446121216, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.47it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.50it/s]                                               {'loss': 2.5882, 'grad_norm': 3.503844976425171, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.50it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.38it/s]                                               {'loss': 2.5374, 'grad_norm': 2.851418972015381, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.38it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.4799, 'grad_norm': 3.1570305824279785, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s] 60%|██████    | 24/40 [00:09<00:05,  2.96it/s]                                               {'loss': 3.1138, 'grad_norm': 16.284561157226562, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.96it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.68it/s]                                               {'loss': 2.5391, 'grad_norm': 2.7017362117767334, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.68it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s]                                               {'loss': 2.6203, 'grad_norm': 3.130443572998047, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.4589, 'grad_norm': 2.8043622970581055, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.29it/s]                                               {'loss': 2.4619, 'grad_norm': 2.6045854091644287, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.29it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.2822, 'grad_norm': 2.5090935230255127, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s]                                               {'loss': 2.5015, 'grad_norm': 2.99645733833313, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.4523, 'grad_norm': 2.8364531993865967, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 2.3051, 'grad_norm': 8.909076690673828, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.60it/s]                                               {'loss': 2.4101, 'grad_norm': 2.847102165222168, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.60it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s]                                               {'loss': 2.4737, 'grad_norm': 3.7628281116485596, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s]                                               {'loss': 2.5268, 'grad_norm': 2.8670639991760254, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.29it/s]                                               {'loss': 2.45, 'grad_norm': 3.6227195262908936, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.29it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s]                                               {'loss': 2.3645, 'grad_norm': 2.699587821960449, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.30it/s]                                               {'loss': 2.2972, 'grad_norm': 2.5156993865966797, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.36it/s]                                               {'loss': 2.5468, 'grad_norm': 2.6269891262054443, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.36it/s]100%|██████████| 40/40 [00:16<00:00,  3.01it/s]                                               {'loss': 2.8232, 'grad_norm': 10.432968139648438, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.01it/s]                                               {'train_runtime': 16.5545, 'train_samples_per_second': 34.13, 'train_steps_per_second': 2.416, 'train_loss': 2.580918186903, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.01it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
CLIENT:67
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:23,  1.69it/s]                                              {'loss': 2.7673, 'grad_norm': 2.7152047157287598, 'learning_rate': 0.00019383318964064309, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:23,  1.69it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 2.6366, 'grad_norm': 4.153076648712158, 'learning_rate': 0.000188987359899627, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:01<00:22,  1.61it/s]                                              {'loss': 2.6151, 'grad_norm': 2.0076353549957275, 'learning_rate': 0.0001841415301586109, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.61it/s] 10%|█         | 4/40 [00:02<00:20,  1.80it/s]                                              {'loss': 2.7225, 'grad_norm': 2.392810821533203, 'learning_rate': 0.00017929570041759485, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.80it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.89it/s]                                              {'loss': 2.7019, 'grad_norm': 3.410311460494995, 'learning_rate': 0.0001744498706765788, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.89it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.99it/s]                                              {'loss': 2.6566, 'grad_norm': 3.7652716636657715, 'learning_rate': 0.0001696040409355627, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.99it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.00it/s]                                              {'loss': 2.4978, 'grad_norm': 2.8395895957946777, 'learning_rate': 0.00016475821119454662, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.00it/s] 20%|██        | 8/40 [00:04<00:14,  2.21it/s]                                              {'loss': 2.5888, 'grad_norm': 12.264763832092285, 'learning_rate': 0.00015991238145353053, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.21it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.25it/s]                                              {'loss': 2.5892, 'grad_norm': 2.287856101989746, 'learning_rate': 0.00015506655171251447, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.25it/s] 25%|██▌       | 10/40 [00:05<00:13,  2.22it/s]                                               {'loss': 2.4247, 'grad_norm': 2.354602098464966, 'learning_rate': 0.0001502207219714984, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:13,  2.22it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.22it/s]                                               {'loss': 2.5699, 'grad_norm': 2.3046109676361084, 'learning_rate': 0.00014537489223048232, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.22it/s] 30%|███       | 12/40 [00:05<00:12,  2.21it/s]                                               {'loss': 2.442, 'grad_norm': 2.231090784072876, 'learning_rate': 0.00014052906248946623, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.21it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s]                                               {'loss': 2.5796, 'grad_norm': 2.897515296936035, 'learning_rate': 0.00013568323274845015, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.6142, 'grad_norm': 2.139543294906616, 'learning_rate': 0.0001308374030074341, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.16it/s]                                               {'loss': 2.5573, 'grad_norm': 2.6625142097473145, 'learning_rate': 0.000125991573266418, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.16it/s]                                               {'loss': 2.72, 'grad_norm': 9.164426803588867, 'learning_rate': 0.00012114574352540193, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:11,  2.16it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.70it/s]                                               {'loss': 2.5254, 'grad_norm': 3.0828027725219727, 'learning_rate': 0.00011629991378438585, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.70it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.55it/s]                                               {'loss': 2.4812, 'grad_norm': 2.5398612022399902, 'learning_rate': 0.00011145408404336976, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.55it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.45it/s]                                               {'loss': 2.5223, 'grad_norm': 2.66835880279541, 'learning_rate': 0.0001066082543023537, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.45it/s] 50%|█████     | 20/40 [00:09<00:08,  2.40it/s]                                               {'loss': 2.4606, 'grad_norm': 2.4392542839050293, 'learning_rate': 0.00010176242456133763, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.40it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.33it/s]                                               {'loss': 2.3938, 'grad_norm': 2.9596266746520996, 'learning_rate': 9.691659482032154e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.29it/s]                                               {'loss': 2.5802, 'grad_norm': 2.736816883087158, 'learning_rate': 9.207076507930546e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.26it/s]                                               {'loss': 2.4382, 'grad_norm': 2.906588077545166, 'learning_rate': 8.72249353382894e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.26it/s] 60%|██████    | 24/40 [00:10<00:05,  2.79it/s]                                               {'loss': 2.2575, 'grad_norm': 8.698772430419922, 'learning_rate': 8.237910559727331e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.79it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.59it/s]                                               {'loss': 2.4446, 'grad_norm': 2.3797783851623535, 'learning_rate': 7.753327585625723e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s]                                               {'loss': 2.3541, 'grad_norm': 2.537339210510254, 'learning_rate': 7.268744611524116e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.37it/s]                                               {'loss': 2.473, 'grad_norm': 2.7503042221069336, 'learning_rate': 6.784161637422507e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.37it/s] 70%|███████   | 28/40 [00:12<00:05,  2.39it/s]                                               {'loss': 2.5721, 'grad_norm': 2.952791929244995, 'learning_rate': 6.2995786633209e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.34it/s]                                               {'loss': 2.2331, 'grad_norm': 2.305692434310913, 'learning_rate': 5.8149956892192926e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.34it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s]                                               {'loss': 2.3876, 'grad_norm': 2.3701984882354736, 'learning_rate': 5.330412715117685e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.39it/s]                                               {'loss': 2.4059, 'grad_norm': 2.6652920246124268, 'learning_rate': 4.845829741016077e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.39it/s] 80%|████████  | 32/40 [00:13<00:02,  2.97it/s]                                               {'loss': 2.7599, 'grad_norm': 10.577632904052734, 'learning_rate': 4.36124676691447e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.97it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s]                                               {'loss': 2.4891, 'grad_norm': 2.441286563873291, 'learning_rate': 3.876663792812862e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.51it/s]                                               {'loss': 2.3015, 'grad_norm': 2.604037284851074, 'learning_rate': 3.392080818711254e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.51it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.40it/s]                                               {'loss': 2.3454, 'grad_norm': 1.9946051836013794, 'learning_rate': 2.9074978446096463e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.40it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.35it/s]                                               {'loss': 2.4906, 'grad_norm': 2.6388895511627197, 'learning_rate': 2.4229148705080386e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.35it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.41it/s]                                               {'loss': 2.3118, 'grad_norm': 2.9297702312469482, 'learning_rate': 1.938331896406431e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.41it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.35it/s]                                               {'loss': 2.5799, 'grad_norm': 2.9046218395233154, 'learning_rate': 1.4537489223048231e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.35it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.37it/s]                                               {'loss': 2.3583, 'grad_norm': 2.8163530826568604, 'learning_rate': 9.691659482032154e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.37it/s]100%|██████████| 40/40 [00:17<00:00,  2.97it/s]                                               {'loss': 2.8788, 'grad_norm': 11.83924388885498, 'learning_rate': 4.845829741016077e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.97it/s]                                               {'train_runtime': 17.2848, 'train_samples_per_second': 32.688, 'train_steps_per_second': 2.314, 'train_loss': 2.518212449550629, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.97it/s]100%|██████████| 40/40 [00:17<00:00,  2.32it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:43, 10.83it/s]  1%|          | 4/471 [00:00<01:03,  7.40it/s]  1%|          | 5/471 [00:00<01:07,  6.92it/s]  1%|▏         | 6/471 [00:00<01:10,  6.61it/s]  1%|▏         | 7/471 [00:01<01:15,  6.11it/s]  2%|▏         | 8/471 [00:01<01:13,  6.32it/s]  2%|▏         | 9/471 [00:01<01:19,  5.81it/s]  2%|▏         | 10/471 [00:01<01:12,  6.40it/s]  2%|▏         | 11/471 [00:01<01:18,  5.83it/s]  3%|▎         | 12/471 [00:01<01:13,  6.23it/s]  3%|▎         | 13/471 [00:02<01:20,  5.68it/s]  3%|▎         | 14/471 [00:02<01:16,  5.98it/s]  3%|▎         | 15/471 [00:02<01:20,  5.68it/s]  3%|▎         | 16/471 [00:02<01:18,  5.83it/s]  4%|▎         | 17/471 [00:02<01:19,  5.74it/s]  4%|▍         | 18/471 [00:02<01:18,  5.78it/s]  4%|▍         | 19/471 [00:03<01:17,  5.85it/s]  4%|▍         | 20/471 [00:03<01:19,  5.69it/s]  4%|▍         | 21/471 [00:03<01:15,  5.94it/s]  5%|▍         | 22/471 [00:03<01:19,  5.67it/s]  5%|▍         | 23/471 [00:03<01:14,  6.04it/s]  5%|▌         | 24/471 [00:03<01:19,  5.61it/s]  5%|▌         | 25/471 [00:04<01:12,  6.12it/s]  6%|▌         | 26/471 [00:04<01:18,  5.67it/s]  6%|▌         | 27/471 [00:04<01:13,  6.05it/s]  6%|▌         | 28/471 [00:04<01:18,  5.67it/s]  6%|▌         | 29/471 [00:04<01:21,  5.40it/s]  6%|▋         | 30/471 [00:05<01:27,  5.03it/s]  7%|▋         | 31/471 [00:05<01:30,  4.88it/s]  7%|▋         | 32/471 [00:05<01:30,  4.84it/s]  7%|▋         | 33/471 [00:05<01:31,  4.81it/s]  7%|▋         | 34/471 [00:05<01:25,  5.11it/s]  7%|▋         | 35/471 [00:06<01:30,  4.80it/s]  8%|▊         | 36/471 [00:06<01:29,  4.87it/s]  8%|▊         | 37/471 [00:06<01:33,  4.65it/s]  8%|▊         | 38/471 [00:06<01:29,  4.84it/s]  8%|▊         | 39/471 [00:06<01:31,  4.71it/s]  8%|▊         | 40/471 [00:07<01:30,  4.78it/s]  9%|▊         | 41/471 [00:07<01:35,  4.52it/s]  9%|▉         | 42/471 [00:07<01:32,  4.63it/s]  9%|▉         | 43/471 [00:07<01:31,  4.66it/s]  9%|▉         | 44/471 [00:08<01:31,  4.68it/s] 10%|▉         | 45/471 [00:08<01:28,  4.79it/s] 10%|▉         | 46/471 [00:08<01:33,  4.53it/s] 10%|▉         | 47/471 [00:08<01:29,  4.73it/s] 10%|█         | 48/471 [00:08<01:32,  4.58it/s] 10%|█         | 49/471 [00:09<01:25,  4.92it/s] 11%|█         | 50/471 [00:09<01:31,  4.60it/s] 11%|█         | 51/471 [00:09<01:26,  4.85it/s] 11%|█         | 52/471 [00:09<01:33,  4.49it/s] 11%|█▏        | 53/471 [00:09<01:27,  4.78it/s] 11%|█▏        | 54/471 [00:10<01:30,  4.61it/s] 12%|█▏        | 55/471 [00:10<01:27,  4.77it/s] 12%|█▏        | 56/471 [00:10<01:28,  4.66it/s] 12%|█▏        | 57/471 [00:10<01:31,  4.54it/s] 12%|█▏        | 58/471 [00:11<01:25,  4.84it/s] 13%|█▎        | 59/471 [00:11<01:28,  4.65it/s] 13%|█▎        | 60/471 [00:11<01:19,  5.18it/s] 13%|█▎        | 61/471 [00:11<01:27,  4.68it/s] 13%|█▎        | 62/471 [00:11<01:21,  5.00it/s] 13%|█▎        | 63/471 [00:12<01:29,  4.57it/s] 14%|█▎        | 64/471 [00:12<01:24,  4.83it/s] 14%|█▍        | 65/471 [00:12<01:27,  4.63it/s] 14%|█▍        | 66/471 [00:12<01:21,  4.97it/s] 14%|█▍        | 67/471 [00:12<01:12,  5.55it/s] 14%|█▍        | 68/471 [00:13<01:15,  5.34it/s] 15%|█▍        | 69/471 [00:13<01:06,  6.00it/s] 15%|█▍        | 70/471 [00:13<01:10,  5.67it/s] 15%|█▌        | 71/471 [00:13<01:11,  5.61it/s] 15%|█▌        | 72/471 [00:13<01:18,  5.05it/s] 15%|█▌        | 73/471 [00:13<01:18,  5.08it/s] 16%|█▌        | 74/471 [00:14<01:24,  4.71it/s] 16%|█▌        | 75/471 [00:14<01:20,  4.92it/s] 16%|█▌        | 76/471 [00:14<01:23,  4.73it/s] 16%|█▋        | 77/471 [00:14<01:21,  4.82it/s] 17%|█▋        | 78/471 [00:15<01:26,  4.54it/s] 17%|█▋        | 79/471 [00:15<01:24,  4.67it/s] 17%|█▋        | 80/471 [00:15<01:23,  4.67it/s] 17%|█▋        | 81/471 [00:15<01:22,  4.71it/s] 17%|█▋        | 82/471 [00:15<01:20,  4.84it/s] 18%|█▊        | 83/471 [00:16<01:22,  4.71it/s] 18%|█▊        | 84/471 [00:16<01:21,  4.73it/s] 18%|█▊        | 85/471 [00:16<01:23,  4.60it/s] 18%|█▊        | 86/471 [00:16<01:20,  4.76it/s] 18%|█▊        | 87/471 [00:16<01:22,  4.67it/s] 19%|█▊        | 88/471 [00:17<01:19,  4.83it/s] 19%|█▉        | 89/471 [00:17<01:24,  4.55it/s] 19%|█▉        | 90/471 [00:17<01:18,  4.83it/s] 19%|█▉        | 91/471 [00:17<01:23,  4.55it/s] 20%|█▉        | 92/471 [00:17<01:17,  4.89it/s] 20%|█▉        | 93/471 [00:18<01:20,  4.67it/s] 20%|█▉        | 94/471 [00:18<01:20,  4.70it/s] 20%|██        | 95/471 [00:18<01:21,  4.64it/s] 20%|██        | 96/471 [00:18<01:20,  4.68it/s] 21%|██        | 97/471 [00:19<01:19,  4.72it/s] 21%|██        | 98/471 [00:19<01:18,  4.76it/s] 21%|██        | 99/471 [00:19<01:17,  4.79it/s] 21%|██        | 100/471 [00:19<01:21,  4.53it/s] 21%|██▏       | 101/471 [00:19<01:18,  4.72it/s] 22%|██▏       | 102/471 [00:20<01:20,  4.57it/s] 22%|██▏       | 103/471 [00:20<01:11,  5.11it/s] 22%|██▏       | 104/471 [00:20<01:19,  4.64it/s] 22%|██▏       | 105/471 [00:20<01:14,  4.91it/s] 23%|██▎       | 106/471 [00:20<01:19,  4.61it/s] 23%|██▎       | 107/471 [00:21<01:16,  4.74it/s] 23%|██▎       | 108/471 [00:21<01:16,  4.73it/s] 23%|██▎       | 109/471 [00:21<01:14,  4.89it/s] 23%|██▎       | 110/471 [00:21<01:06,  5.45it/s] 24%|██▎       | 111/471 [00:21<01:09,  5.17it/s] 24%|██▍       | 112/471 [00:22<01:06,  5.37it/s] 24%|██▍       | 113/471 [00:22<01:13,  4.87it/s] 24%|██▍       | 114/471 [00:22<01:10,  5.09it/s] 24%|██▍       | 115/471 [00:22<01:15,  4.71it/s] 25%|██▍       | 116/471 [00:22<01:10,  5.04it/s] 25%|██▍       | 117/471 [00:23<01:14,  4.73it/s] 25%|██▌       | 118/471 [00:23<01:13,  4.83it/s] 25%|██▌       | 119/471 [00:23<01:15,  4.65it/s] 25%|██▌       | 120/471 [00:23<01:15,  4.65it/s] 26%|██▌       | 121/471 [00:24<01:14,  4.73it/s] 26%|██▌       | 122/471 [00:24<01:14,  4.66it/s] 26%|██▌       | 123/471 [00:24<01:12,  4.79it/s] 26%|██▋       | 124/471 [00:24<01:16,  4.53it/s] 27%|██▋       | 125/471 [00:24<01:11,  4.81it/s] 27%|██▋       | 126/471 [00:25<01:15,  4.55it/s] 27%|██▋       | 127/471 [00:25<01:07,  5.10it/s] 27%|██▋       | 128/471 [00:25<01:13,  4.70it/s] 27%|██▋       | 129/471 [00:25<01:11,  4.81it/s] 28%|██▊       | 130/471 [00:25<01:14,  4.56it/s] 28%|██▊       | 131/471 [00:26<01:10,  4.79it/s] 28%|██▊       | 132/471 [00:26<01:13,  4.58it/s] 28%|██▊       | 133/471 [00:26<01:10,  4.81it/s] 28%|██▊       | 134/471 [00:26<01:14,  4.52it/s] 29%|██▊       | 135/471 [00:27<01:12,  4.61it/s] 29%|██▉       | 136/471 [00:27<01:13,  4.59it/s] 29%|██▉       | 137/471 [00:27<01:11,  4.66it/s] 29%|██▉       | 138/471 [00:27<01:08,  4.89it/s] 30%|██▉       | 139/471 [00:27<01:08,  4.84it/s] 30%|██▉       | 140/471 [00:28<01:10,  4.71it/s] 30%|██▉       | 141/471 [00:28<01:10,  4.71it/s] 30%|███       | 142/471 [00:28<01:09,  4.73it/s] 30%|███       | 143/471 [00:28<01:09,  4.75it/s] 31%|███       | 144/471 [00:28<01:09,  4.71it/s] 31%|███       | 145/471 [00:29<01:11,  4.57it/s] 31%|███       | 146/471 [00:29<01:08,  4.75it/s] 31%|███       | 147/471 [00:29<01:10,  4.59it/s] 31%|███▏      | 148/471 [00:29<01:06,  4.85it/s] 32%|███▏      | 149/471 [00:29<01:08,  4.70it/s] 32%|███▏      | 150/471 [00:30<01:03,  5.02it/s] 32%|███▏      | 151/471 [00:30<01:09,  4.61it/s] 32%|███▏      | 152/471 [00:30<01:06,  4.80it/s] 32%|███▏      | 153/471 [00:30<01:08,  4.62it/s] 33%|███▎      | 154/471 [00:31<01:06,  4.79it/s] 33%|███▎      | 155/471 [00:31<01:08,  4.62it/s] 33%|███▎      | 156/471 [00:31<01:07,  4.70it/s] 33%|███▎      | 157/471 [00:31<01:08,  4.59it/s] 34%|███▎      | 158/471 [00:31<01:08,  4.60it/s] 34%|███▍      | 159/471 [00:32<01:04,  4.82it/s] 34%|███▍      | 160/471 [00:32<01:06,  4.71it/s] 34%|███▍      | 161/471 [00:32<01:04,  4.80it/s] 34%|███▍      | 162/471 [00:32<01:08,  4.53it/s] 35%|███▍      | 163/471 [00:32<01:03,  4.81it/s] 35%|███▍      | 164/471 [00:33<01:07,  4.55it/s] 35%|███▌      | 165/471 [00:33<01:02,  4.90it/s] 35%|███▌      | 166/471 [00:33<01:07,  4.55it/s] 35%|███▌      | 167/471 [00:33<01:02,  4.87it/s] 36%|███▌      | 168/471 [00:34<01:06,  4.54it/s] 36%|███▌      | 169/471 [00:34<01:04,  4.72it/s] 36%|███▌      | 170/471 [00:34<01:04,  4.65it/s] 36%|███▋      | 171/471 [00:34<01:03,  4.73it/s] 37%|███▋      | 172/471 [00:34<01:03,  4.68it/s] 37%|███▋      | 173/471 [00:35<01:05,  4.55it/s] 37%|███▋      | 174/471 [00:35<01:01,  4.85it/s] 37%|███▋      | 175/471 [00:35<01:02,  4.74it/s] 37%|███▋      | 176/471 [00:35<00:59,  4.96it/s] 38%|███▊      | 177/471 [00:35<01:02,  4.71it/s] 38%|███▊      | 178/471 [00:36<01:02,  4.69it/s] 38%|███▊      | 179/471 [00:36<01:03,  4.59it/s] 38%|███▊      | 180/471 [00:36<01:00,  4.83it/s] 38%|███▊      | 181/471 [00:36<01:02,  4.64it/s] 39%|███▊      | 182/471 [00:36<00:59,  4.82it/s] 39%|███▉      | 183/471 [00:37<01:04,  4.47it/s] 39%|███▉      | 184/471 [00:37<01:00,  4.74it/s] 39%|███▉      | 185/471 [00:37<01:02,  4.54it/s] 39%|███▉      | 186/471 [00:37<01:00,  4.71it/s] 40%|███▉      | 187/471 [00:38<00:59,  4.78it/s] 40%|███▉      | 188/471 [00:38<00:58,  4.85it/s] 40%|████      | 189/471 [00:38<00:59,  4.73it/s] 40%|████      | 190/471 [00:38<01:00,  4.67it/s] 41%|████      | 191/471 [00:38<00:59,  4.67it/s] 41%|████      | 192/471 [00:39<01:00,  4.61it/s] 41%|████      | 193/471 [00:39<00:56,  4.90it/s] 41%|████      | 194/471 [00:39<00:59,  4.62it/s] 41%|████▏     | 195/471 [00:39<00:58,  4.70it/s] 42%|████▏     | 196/471 [00:40<01:01,  4.48it/s] 42%|████▏     | 197/471 [00:40<00:57,  4.79it/s] 42%|████▏     | 198/471 [00:40<00:59,  4.60it/s] 42%|████▏     | 199/471 [00:40<00:56,  4.83it/s] 42%|████▏     | 200/471 [00:40<01:00,  4.47it/s] 43%|████▎     | 201/471 [00:41<00:56,  4.80it/s] 43%|████▎     | 202/471 [00:41<00:59,  4.53it/s] 43%|████▎     | 203/471 [00:41<00:56,  4.78it/s] 43%|████▎     | 204/471 [00:41<00:57,  4.63it/s] 44%|████▎     | 205/471 [00:41<00:56,  4.69it/s] 44%|████▎     | 206/471 [00:42<00:57,  4.62it/s] 44%|████▍     | 207/471 [00:42<00:56,  4.64it/s] 44%|████▍     | 208/471 [00:42<00:54,  4.79it/s] 44%|████▍     | 209/471 [00:42<00:55,  4.71it/s] 45%|████▍     | 210/471 [00:42<00:54,  4.80it/s] 45%|████▍     | 211/471 [00:43<00:55,  4.69it/s] 45%|████▌     | 212/471 [00:43<00:54,  4.77it/s] 45%|████▌     | 213/471 [00:43<00:55,  4.69it/s] 45%|████▌     | 214/471 [00:43<00:52,  4.88it/s] 46%|████▌     | 215/471 [00:44<00:55,  4.63it/s] 46%|████▌     | 216/471 [00:44<00:54,  4.68it/s] 46%|████▌     | 217/471 [00:44<00:56,  4.48it/s] 46%|████▋     | 218/471 [00:44<00:53,  4.76it/s] 46%|████▋     | 219/471 [00:44<00:55,  4.53it/s] 47%|████▋     | 220/471 [00:45<00:51,  4.86it/s] 47%|████▋     | 221/471 [00:45<00:55,  4.49it/s] 47%|████▋     | 222/471 [00:45<00:52,  4.71it/s] 47%|████▋     | 223/471 [00:45<00:54,  4.56it/s] 48%|████▊     | 224/471 [00:45<00:52,  4.71it/s] 48%|████▊     | 225/471 [00:46<00:51,  4.76it/s] 48%|████▊     | 226/471 [00:46<00:49,  4.98it/s] 48%|████▊     | 227/471 [00:46<00:46,  5.26it/s] 48%|████▊     | 228/471 [00:46<00:45,  5.33it/s] 49%|████▊     | 229/471 [00:46<00:42,  5.70it/s] 49%|████▉     | 230/471 [00:47<00:43,  5.56it/s] 49%|████▉     | 231/471 [00:47<00:40,  5.90it/s] 49%|████▉     | 232/471 [00:47<00:42,  5.56it/s] 49%|████▉     | 233/471 [00:47<00:39,  6.06it/s] 50%|████▉     | 234/471 [00:47<00:42,  5.63it/s] 50%|████▉     | 235/471 [00:47<00:39,  6.04it/s] 50%|█████     | 236/471 [00:48<00:40,  5.74it/s] 50%|█████     | 237/471 [00:48<00:39,  5.88it/s] 51%|█████     | 238/471 [00:48<00:39,  5.93it/s] 51%|█████     | 239/471 [00:48<00:39,  5.89it/s] 51%|█████     | 240/471 [00:48<00:38,  6.04it/s] 51%|█████     | 241/471 [00:48<00:39,  5.85it/s] 51%|█████▏    | 242/471 [00:49<00:37,  6.05it/s] 52%|█████▏    | 243/471 [00:49<00:39,  5.81it/s] 52%|█████▏    | 244/471 [00:49<00:36,  6.19it/s] 52%|█████▏    | 245/471 [00:49<00:39,  5.72it/s] 52%|█████▏    | 246/471 [00:49<00:36,  6.17it/s] 52%|█████▏    | 247/471 [00:49<00:38,  5.78it/s] 53%|█████▎    | 248/471 [00:50<00:37,  5.96it/s] 53%|█████▎    | 249/471 [00:50<00:38,  5.83it/s] 53%|█████▎    | 250/471 [00:50<00:37,  5.83it/s] 53%|█████▎    | 251/471 [00:50<00:36,  6.10it/s] 54%|█████▎    | 252/471 [00:50<00:37,  5.88it/s] 54%|█████▎    | 253/471 [00:50<00:34,  6.26it/s] 54%|█████▍    | 254/471 [00:51<00:36,  5.89it/s] 54%|█████▍    | 255/471 [00:51<00:34,  6.29it/s] 54%|█████▍    | 256/471 [00:51<00:36,  5.89it/s] 55%|█████▍    | 257/471 [00:51<00:35,  6.00it/s] 55%|█████▍    | 258/471 [00:51<00:36,  5.80it/s] 55%|█████▍    | 259/471 [00:51<00:40,  5.23it/s] 55%|█████▌    | 260/471 [00:52<00:40,  5.18it/s] 55%|█████▌    | 261/471 [00:52<00:43,  4.87it/s] 56%|█████▌    | 262/471 [00:52<00:42,  4.96it/s] 56%|█████▌    | 263/471 [00:52<00:43,  4.74it/s] 56%|█████▌    | 264/471 [00:53<00:42,  4.87it/s] 56%|█████▋    | 265/471 [00:53<00:45,  4.54it/s] 56%|█████▋    | 266/471 [00:53<00:43,  4.70it/s] 57%|█████▋    | 267/471 [00:53<00:45,  4.53it/s] 57%|█████▋    | 268/471 [00:53<00:42,  4.82it/s] 57%|█████▋    | 269/471 [00:54<00:43,  4.67it/s] 57%|█████▋    | 270/471 [00:54<00:42,  4.68it/s] 58%|█████▊    | 271/471 [00:54<00:43,  4.56it/s] 58%|█████▊    | 272/471 [00:54<00:42,  4.66it/s] 58%|█████▊    | 273/471 [00:55<00:43,  4.55it/s] 58%|█████▊    | 274/471 [00:55<00:42,  4.69it/s] 58%|█████▊    | 275/471 [00:55<00:42,  4.58it/s] 59%|█████▊    | 276/471 [00:55<00:42,  4.58it/s] 59%|█████▉    | 277/471 [00:55<00:41,  4.67it/s] 59%|█████▉    | 278/471 [00:56<00:41,  4.62it/s] 59%|█████▉    | 279/471 [00:56<00:39,  4.86it/s] 59%|█████▉    | 280/471 [00:56<00:40,  4.73it/s] 60%|█████▉    | 281/471 [00:56<00:40,  4.64it/s] 60%|█████▉    | 282/471 [00:56<00:40,  4.67it/s] 60%|██████    | 283/471 [00:57<00:40,  4.69it/s] 60%|██████    | 284/471 [00:57<00:39,  4.78it/s] 61%|██████    | 285/471 [00:57<00:39,  4.69it/s] 61%|██████    | 286/471 [00:57<00:39,  4.71it/s] 61%|██████    | 287/471 [00:58<00:40,  4.59it/s] 61%|██████    | 288/471 [00:58<00:39,  4.64it/s] 61%|██████▏   | 289/471 [00:58<00:39,  4.66it/s] 62%|██████▏   | 290/471 [00:58<00:38,  4.71it/s] 62%|██████▏   | 291/471 [00:58<00:38,  4.68it/s] 62%|██████▏   | 292/471 [00:59<00:38,  4.61it/s] 62%|██████▏   | 293/471 [00:59<00:37,  4.73it/s] 62%|██████▏   | 294/471 [00:59<00:38,  4.65it/s] 63%|██████▎   | 295/471 [00:59<00:35,  4.91it/s] 63%|██████▎   | 296/471 [00:59<00:34,  5.10it/s] 63%|██████▎   | 297/471 [01:00<00:32,  5.33it/s] 63%|██████▎   | 298/471 [01:00<00:31,  5.44it/s] 63%|██████▎   | 299/471 [01:00<00:32,  5.37it/s] 64%|██████▎   | 300/471 [01:00<00:33,  5.09it/s] 64%|██████▍   | 301/471 [01:00<00:34,  4.97it/s] 64%|██████▍   | 302/471 [01:01<00:35,  4.77it/s] 64%|██████▍   | 303/471 [01:01<00:34,  4.87it/s] 65%|██████▍   | 304/471 [01:01<00:35,  4.75it/s] 65%|██████▍   | 305/471 [01:01<00:33,  4.89it/s] 65%|██████▍   | 306/471 [01:01<00:35,  4.70it/s] 65%|██████▌   | 307/471 [01:02<00:35,  4.66it/s] 65%|██████▌   | 308/471 [01:02<00:34,  4.73it/s] 66%|██████▌   | 309/471 [01:02<00:34,  4.66it/s] 66%|██████▌   | 310/471 [01:02<00:33,  4.85it/s] 66%|██████▌   | 311/471 [01:02<00:34,  4.65it/s] 66%|██████▌   | 312/471 [01:03<00:34,  4.67it/s] 66%|██████▋   | 313/471 [01:03<00:34,  4.60it/s] 67%|██████▋   | 314/471 [01:03<00:33,  4.75it/s] 67%|██████▋   | 315/471 [01:03<00:32,  4.78it/s] 67%|██████▋   | 316/471 [01:04<00:32,  4.73it/s] 67%|██████▋   | 317/471 [01:04<00:33,  4.61it/s] 68%|██████▊   | 318/471 [01:04<00:32,  4.68it/s] 68%|██████▊   | 319/471 [01:04<00:33,  4.55it/s] 68%|██████▊   | 320/471 [01:04<00:31,  4.75it/s] 68%|██████▊   | 321/471 [01:05<00:32,  4.60it/s] 68%|██████▊   | 322/471 [01:05<00:31,  4.80it/s] 69%|██████▊   | 323/471 [01:05<00:33,  4.46it/s] 69%|██████▉   | 324/471 [01:05<00:30,  4.77it/s] 69%|██████▉   | 325/471 [01:05<00:32,  4.52it/s] 69%|██████▉   | 326/471 [01:06<00:29,  4.91it/s] 69%|██████▉   | 327/471 [01:06<00:31,  4.53it/s] 70%|██████▉   | 328/471 [01:06<00:30,  4.75it/s] 70%|██████▉   | 329/471 [01:06<00:31,  4.49it/s] 70%|███████   | 330/471 [01:07<00:29,  4.71it/s] 70%|███████   | 331/471 [01:07<00:29,  4.70it/s] 70%|███████   | 332/471 [01:07<00:29,  4.68it/s] 71%|███████   | 333/471 [01:07<00:29,  4.69it/s] 71%|███████   | 334/471 [01:07<00:30,  4.56it/s] 71%|███████   | 335/471 [01:08<00:28,  4.83it/s] 71%|███████▏  | 336/471 [01:08<00:28,  4.66it/s] 72%|███████▏  | 337/471 [01:08<00:25,  5.21it/s] 72%|███████▏  | 338/471 [01:08<00:26,  5.10it/s] 72%|███████▏  | 339/471 [01:08<00:23,  5.62it/s] 72%|███████▏  | 340/471 [01:09<00:25,  5.06it/s] 72%|███████▏  | 341/471 [01:09<00:25,  5.08it/s] 73%|███████▎  | 342/471 [01:09<00:26,  4.81it/s] 73%|███████▎  | 343/471 [01:09<00:26,  4.78it/s] 73%|███████▎  | 344/471 [01:09<00:26,  4.81it/s] 73%|███████▎  | 345/471 [01:10<00:26,  4.73it/s] 73%|███████▎  | 346/471 [01:10<00:25,  4.90it/s] 74%|███████▎  | 347/471 [01:10<00:26,  4.60it/s] 74%|███████▍  | 348/471 [01:10<00:24,  5.00it/s] 74%|███████▍  | 349/471 [01:10<00:26,  4.66it/s] 74%|███████▍  | 350/471 [01:11<00:23,  5.24it/s] 75%|███████▍  | 351/471 [01:11<00:24,  4.80it/s] 75%|███████▍  | 352/471 [01:11<00:24,  4.77it/s] 75%|███████▍  | 353/471 [01:11<00:25,  4.64it/s] 75%|███████▌  | 354/471 [01:11<00:24,  4.69it/s] 75%|███████▌  | 355/471 [01:12<00:24,  4.83it/s] 76%|███████▌  | 356/471 [01:12<00:24,  4.75it/s] 76%|███████▌  | 357/471 [01:12<00:24,  4.73it/s] 76%|███████▌  | 358/471 [01:12<00:24,  4.65it/s] 76%|███████▌  | 359/471 [01:13<00:23,  4.75it/s] 76%|███████▋  | 360/471 [01:13<00:23,  4.66it/s] 77%|███████▋  | 361/471 [01:13<00:22,  4.86it/s] 77%|███████▋  | 362/471 [01:13<00:23,  4.65it/s] 77%|███████▋  | 363/471 [01:13<00:22,  4.76it/s] 77%|███████▋  | 364/471 [01:14<00:23,  4.59it/s] 77%|███████▋  | 365/471 [01:14<00:22,  4.80it/s] 78%|███████▊  | 366/471 [01:14<00:22,  4.69it/s] 78%|███████▊  | 367/471 [01:14<00:22,  4.72it/s] 78%|███████▊  | 368/471 [01:14<00:22,  4.58it/s] 78%|███████▊  | 369/471 [01:15<00:21,  4.64it/s] 79%|███████▊  | 370/471 [01:15<00:21,  4.75it/s] 79%|███████▉  | 371/471 [01:15<00:21,  4.72it/s] 79%|███████▉  | 372/471 [01:15<00:20,  4.74it/s] 79%|███████▉  | 373/471 [01:16<00:21,  4.57it/s] 79%|███████▉  | 374/471 [01:16<00:20,  4.69it/s] 80%|███████▉  | 375/471 [01:16<00:20,  4.63it/s] 80%|███████▉  | 376/471 [01:16<00:19,  4.84it/s] 80%|████████  | 377/471 [01:16<00:19,  4.77it/s] 80%|████████  | 378/471 [01:17<00:18,  5.04it/s] 80%|████████  | 379/471 [01:17<00:19,  4.67it/s] 81%|████████  | 380/471 [01:17<00:19,  4.77it/s] 81%|████████  | 381/471 [01:17<00:19,  4.59it/s] 81%|████████  | 382/471 [01:17<00:18,  4.78it/s] 81%|████████▏ | 383/471 [01:18<00:18,  4.69it/s] 82%|████████▏ | 384/471 [01:18<00:18,  4.67it/s] 82%|████████▏ | 385/471 [01:18<00:18,  4.59it/s] 82%|████████▏ | 386/471 [01:18<00:18,  4.57it/s] 82%|████████▏ | 387/471 [01:18<00:17,  4.80it/s] 82%|████████▏ | 388/471 [01:19<00:17,  4.71it/s] 83%|████████▎ | 389/471 [01:19<00:16,  4.86it/s] 83%|████████▎ | 390/471 [01:19<00:17,  4.57it/s] 83%|████████▎ | 391/471 [01:19<00:16,  4.86it/s] 83%|████████▎ | 392/471 [01:20<00:17,  4.59it/s] 83%|████████▎ | 393/471 [01:20<00:15,  4.90it/s] 84%|████████▎ | 394/471 [01:20<00:16,  4.59it/s] 84%|████████▍ | 395/471 [01:20<00:15,  4.84it/s] 84%|████████▍ | 396/471 [01:20<00:16,  4.52it/s] 84%|████████▍ | 397/471 [01:21<00:15,  4.70it/s] 85%|████████▍ | 398/471 [01:21<00:15,  4.68it/s] 85%|████████▍ | 399/471 [01:21<00:15,  4.73it/s] 85%|████████▍ | 400/471 [01:21<00:14,  4.88it/s] 85%|████████▌ | 401/471 [01:21<00:14,  4.67it/s] 85%|████████▌ | 402/471 [01:22<00:13,  5.08it/s] 86%|████████▌ | 403/471 [01:22<00:14,  4.71it/s] 86%|████████▌ | 404/471 [01:22<00:12,  5.30it/s] 86%|████████▌ | 405/471 [01:22<00:13,  4.96it/s] 86%|████████▌ | 406/471 [01:22<00:13,  4.82it/s] 86%|████████▋ | 407/471 [01:23<00:12,  5.04it/s] 87%|████████▋ | 408/471 [01:23<00:13,  4.78it/s] 87%|████████▋ | 409/471 [01:23<00:12,  5.02it/s] 87%|████████▋ | 410/471 [01:23<00:12,  4.93it/s] 87%|████████▋ | 411/471 [01:23<00:11,  5.33it/s] 87%|████████▋ | 412/471 [01:24<00:11,  5.08it/s] 88%|████████▊ | 413/471 [01:24<00:10,  5.55it/s] 88%|████████▊ | 414/471 [01:24<00:10,  5.37it/s] 88%|████████▊ | 415/471 [01:24<00:09,  5.72it/s] 88%|████████▊ | 416/471 [01:24<00:09,  5.83it/s] 89%|████████▊ | 417/471 [01:24<00:09,  5.60it/s] 89%|████████▊ | 418/471 [01:25<00:09,  5.69it/s] 89%|████████▉ | 419/471 [01:25<00:09,  5.50it/s] 89%|████████▉ | 420/471 [01:25<00:08,  5.91it/s] 89%|████████▉ | 421/471 [01:25<00:08,  5.82it/s] 90%|████████▉ | 422/471 [01:25<00:07,  6.43it/s] 90%|████████▉ | 423/471 [01:25<00:07,  6.22it/s] 90%|█████████ | 424/471 [01:26<00:07,  6.62it/s] 90%|█████████ | 425/471 [01:26<00:07,  6.52it/s] 90%|█████████ | 426/471 [01:26<00:06,  6.67it/s] 91%|█████████ | 427/471 [01:26<00:06,  7.03it/s] 91%|█████████ | 428/471 [01:26<00:06,  6.74it/s] 91%|█████████ | 429/471 [01:26<00:06,  6.71it/s] 91%|█████████▏| 430/471 [01:27<00:06,  6.01it/s] 92%|█████████▏| 431/471 [01:27<00:06,  6.30it/s] 92%|█████████▏| 432/471 [01:27<00:06,  5.90it/s] 92%|█████████▏| 433/471 [01:27<00:06,  6.22it/s] 92%|█████████▏| 434/471 [01:27<00:06,  5.61it/s] 92%|█████████▏| 435/471 [01:27<00:06,  5.68it/s] 93%|█████████▎| 436/471 [01:28<00:06,  5.68it/s] 93%|█████████▎| 437/471 [01:28<00:06,  5.58it/s] 93%|█████████▎| 438/471 [01:28<00:06,  5.37it/s] 93%|█████████▎| 439/471 [01:28<00:06,  5.00it/s] 93%|█████████▎| 440/471 [01:28<00:06,  4.97it/s] 94%|█████████▎| 441/471 [01:29<00:06,  4.74it/s] 94%|█████████▍| 442/471 [01:29<00:05,  4.98it/s] 94%|█████████▍| 443/471 [01:29<00:05,  4.74it/s] 94%|█████████▍| 444/471 [01:29<00:05,  4.87it/s] 94%|█████████▍| 445/471 [01:29<00:05,  4.58it/s] 95%|█████████▍| 446/471 [01:30<00:05,  4.90it/s] 95%|█████████▍| 447/471 [01:30<00:05,  4.59it/s] 95%|█████████▌| 448/471 [01:30<00:04,  5.03it/s] 95%|█████████▌| 449/471 [01:30<00:04,  4.68it/s] 96%|█████████▌| 450/471 [01:30<00:04,  4.69it/s] 96%|█████████▌| 451/471 [01:31<00:04,  4.67it/s] 96%|█████████▌| 452/471 [01:31<00:04,  4.68it/s] 96%|█████████▌| 453/471 [01:31<00:03,  4.78it/s] 96%|█████████▋| 454/471 [01:31<00:03,  4.76it/s] 97%|█████████▋| 455/471 [01:31<00:03,  5.32it/s] 97%|█████████▋| 456/471 [01:32<00:02,  5.18it/s] 97%|█████████▋| 457/471 [01:32<00:02,  5.81it/s] 97%|█████████▋| 458/471 [01:32<00:02,  5.61it/s] 97%|█████████▋| 459/471 [01:32<00:02,  5.89it/s] 98%|█████████▊| 460/471 [01:32<00:01,  5.67it/s] 98%|█████████▊| 461/471 [01:32<00:01,  5.86it/s] 98%|█████████▊| 462/471 [01:33<00:01,  5.83it/s] 98%|█████████▊| 463/471 [01:33<00:01,  5.93it/s] 99%|█████████▊| 464/471 [01:33<00:01,  5.99it/s] 99%|█████████▊| 465/471 [01:33<00:01,  5.93it/s] 99%|█████████▉| 466/471 [01:33<00:00,  5.96it/s] 99%|█████████▉| 467/471 [01:34<00:00,  5.84it/s] 99%|█████████▉| 468/471 [01:34<00:00,  5.92it/s]100%|█████████▉| 469/471 [01:34<00:00,  5.78it/s]100%|█████████▉| 470/471 [01:34<00:00,  5.92it/s]100%|██████████| 471/471 [01:34<00:00,  6.03it/s]100%|██████████| 471/471 [01:34<00:00,  4.97it/s]
{'eval_loss': 2.574207305908203, 'eval_model_preparation_time': 0.0051, 'eval_acc': 0.3574083908656399, 'eval_runtime': 94.8229, 'eval_samples_per_second': 79.432, 'eval_steps_per_second': 4.967}
ROUND:4
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.6092, 'grad_norm': 2.8414411544799805, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.7442, 'grad_norm': 3.316261053085327, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:16,  2.22it/s]                                              {'loss': 2.6462, 'grad_norm': 2.4519095420837402, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.22it/s] 10%|█         | 4/40 [00:01<00:15,  2.37it/s]                                              {'loss': 2.8471, 'grad_norm': 3.012815475463867, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.37it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.46it/s]                                              {'loss': 2.5455, 'grad_norm': 2.330925941467285, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.46it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.52it/s]                                              {'loss': 2.7056, 'grad_norm': 3.0727052688598633, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.52it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.57it/s]                                              {'loss': 2.7478, 'grad_norm': 3.2323663234710693, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.57it/s] 20%|██        | 8/40 [00:02<00:09,  3.32it/s]                                              {'loss': 2.5665, 'grad_norm': 14.793851852416992, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.32it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.02it/s]                                              {'loss': 2.5875, 'grad_norm': 2.7376980781555176, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.02it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.85it/s]                                               {'loss': 2.7029, 'grad_norm': 2.4484455585479736, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.85it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.77it/s]                                               {'loss': 2.534, 'grad_norm': 2.360626220703125, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.77it/s] 30%|███       | 12/40 [00:04<00:10,  2.71it/s]                                               {'loss': 2.5622, 'grad_norm': 2.6636548042297363, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.71it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.52it/s]                                               {'loss': 2.5245, 'grad_norm': 2.4477367401123047, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.52it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.40it/s]                                               {'loss': 2.5276, 'grad_norm': 2.921849489212036, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.40it/s] 38%|███▊      | 15/40 [00:05<00:10,  2.31it/s]                                               {'loss': 2.4904, 'grad_norm': 3.095444679260254, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:10,  2.31it/s] 40%|████      | 16/40 [00:06<00:08,  2.96it/s]                                               {'loss': 2.3118, 'grad_norm': 11.125303268432617, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.96it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s]                                               {'loss': 2.5024, 'grad_norm': 2.897113800048828, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.51it/s]                                               {'loss': 2.5402, 'grad_norm': 3.3633766174316406, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.51it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.37it/s]                                               {'loss': 2.487, 'grad_norm': 2.7282941341400146, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.37it/s] 50%|█████     | 20/40 [00:07<00:08,  2.31it/s]                                               {'loss': 2.4867, 'grad_norm': 3.1226730346679688, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.31it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.4529, 'grad_norm': 2.6837728023529053, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:08<00:08,  2.25it/s]                                               {'loss': 2.5069, 'grad_norm': 2.521218776702881, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:08,  2.25it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s]                                               {'loss': 2.4798, 'grad_norm': 3.3256425857543945, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s] 60%|██████    | 24/40 [00:09<00:05,  2.90it/s]                                               {'loss': 2.3096, 'grad_norm': 12.959894180297852, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.90it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.67it/s]                                               {'loss': 2.5152, 'grad_norm': 2.6058573722839355, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.67it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.51it/s]                                               {'loss': 2.5153, 'grad_norm': 2.6772103309631348, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.41it/s]                                               {'loss': 2.4237, 'grad_norm': 2.082920789718628, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.41it/s] 70%|███████   | 28/40 [00:11<00:05,  2.36it/s]                                               {'loss': 2.4176, 'grad_norm': 2.4322738647460938, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.36it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s]                                               {'loss': 2.3926, 'grad_norm': 2.5669307708740234, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.4293, 'grad_norm': 2.675474166870117, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s]                                               {'loss': 2.3425, 'grad_norm': 2.5398378372192383, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.26it/s] 80%|████████  | 32/40 [00:12<00:02,  2.86it/s]                                               {'loss': 2.4748, 'grad_norm': 11.556341171264648, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.86it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.69it/s]                                               {'loss': 2.3657, 'grad_norm': 2.781022071838379, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.69it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s]                                               {'loss': 2.3733, 'grad_norm': 2.671847105026245, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.45it/s]                                               {'loss': 2.4836, 'grad_norm': 2.779843330383301, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.45it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s]                                               {'loss': 2.4694, 'grad_norm': 2.9697747230529785, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.4362, 'grad_norm': 2.8603718280792236, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.36it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s]                                               {'loss': 2.4398, 'grad_norm': 2.305997848510742, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.27it/s]                                               {'loss': 2.5086, 'grad_norm': 2.659677743911743, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.27it/s]100%|██████████| 40/40 [00:15<00:00,  2.89it/s]                                               {'loss': 2.3311, 'grad_norm': 22.394031524658203, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.89it/s]                                               {'train_runtime': 15.9867, 'train_samples_per_second': 35.342, 'train_steps_per_second': 2.502, 'train_loss': 2.508425313234329, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.89it/s]100%|██████████| 40/40 [00:15<00:00,  2.50it/s]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]                                              {'loss': 2.5158, 'grad_norm': 2.555023431777954, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:28,  1.36it/s]  5%|▌         | 2/40 [00:01<00:27,  1.37it/s]                                              {'loss': 2.5683, 'grad_norm': 3.4465649127960205, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:27,  1.37it/s]  8%|▊         | 3/40 [00:01<00:22,  1.64it/s]                                              {'loss': 2.6714, 'grad_norm': 2.8980894088745117, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.64it/s] 10%|█         | 4/40 [00:02<00:20,  1.80it/s]                                              {'loss': 2.765, 'grad_norm': 3.1006062030792236, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.80it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.89it/s]                                              {'loss': 2.5854, 'grad_norm': 2.7044501304626465, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.89it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.98it/s]                                              {'loss': 2.4256, 'grad_norm': 2.566905975341797, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.98it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.03it/s]                                              {'loss': 2.7918, 'grad_norm': 3.577089548110962, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.03it/s] 20%|██        | 8/40 [00:04<00:14,  2.21it/s]                                              {'loss': 2.7672, 'grad_norm': 8.275142669677734, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.21it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.22it/s]                                              {'loss': 2.6511, 'grad_norm': 3.194074869155884, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.22it/s] 25%|██▌       | 10/40 [00:05<00:12,  2.32it/s]                                               {'loss': 2.5759, 'grad_norm': 2.913024663925171, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:12,  2.32it/s] 28%|██▊       | 11/40 [00:05<00:12,  2.37it/s]                                               {'loss': 2.467, 'grad_norm': 2.6494576930999756, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:12,  2.37it/s] 30%|███       | 12/40 [00:05<00:11,  2.40it/s]                                               {'loss': 2.5078, 'grad_norm': 2.618483781814575, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.40it/s] 32%|███▎      | 13/40 [00:06<00:11,  2.43it/s]                                               {'loss': 2.5252, 'grad_norm': 4.275137424468994, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:11,  2.43it/s] 35%|███▌      | 14/40 [00:06<00:10,  2.50it/s]                                               {'loss': 2.5271, 'grad_norm': 2.7484538555145264, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:10,  2.50it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.53it/s]                                               {'loss': 2.5948, 'grad_norm': 3.1554760932922363, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.53it/s]                                               {'loss': 2.3036, 'grad_norm': 11.376591682434082, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:09,  2.53it/s] 42%|████▎     | 17/40 [00:07<00:07,  3.00it/s]                                               {'loss': 2.4234, 'grad_norm': 2.467189073562622, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:07,  3.00it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.74it/s]                                               {'loss': 2.5417, 'grad_norm': 2.7973134517669678, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.74it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.55it/s]                                               {'loss': 2.505, 'grad_norm': 2.6327033042907715, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.55it/s] 50%|█████     | 20/40 [00:08<00:08,  2.43it/s]                                               {'loss': 2.5553, 'grad_norm': 3.1921346187591553, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.43it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.35it/s]                                               {'loss': 2.3702, 'grad_norm': 2.7315621376037598, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.35it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.5199, 'grad_norm': 3.5513598918914795, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s]                                               {'loss': 2.6303, 'grad_norm': 3.3811330795288086, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s] 60%|██████    | 24/40 [00:10<00:05,  2.85it/s]                                               {'loss': 3.0303, 'grad_norm': 12.94495677947998, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s]                                               {'loss': 2.3926, 'grad_norm': 3.2272112369537354, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.53it/s]                                               {'loss': 2.5219, 'grad_norm': 2.764787435531616, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.46it/s]                                               {'loss': 2.4379, 'grad_norm': 2.5618627071380615, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.46it/s] 70%|███████   | 28/40 [00:12<00:04,  2.41it/s]                                               {'loss': 2.5956, 'grad_norm': 3.017847776412964, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:04,  2.41it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.35it/s]                                               {'loss': 2.4311, 'grad_norm': 3.412137508392334, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.35it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.30it/s]                                               {'loss': 2.4871, 'grad_norm': 2.940539598464966, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s]                                               {'loss': 2.3924, 'grad_norm': 2.74347186088562, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s] 80%|████████  | 32/40 [00:13<00:02,  2.84it/s]                                               {'loss': 2.2355, 'grad_norm': 9.038015365600586, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.84it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.63it/s]                                               {'loss': 2.5432, 'grad_norm': 2.669707775115967, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s]                                               {'loss': 2.4313, 'grad_norm': 2.221447229385376, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.44it/s]                                               {'loss': 2.4345, 'grad_norm': 2.931396007537842, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.44it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.41it/s]                                               {'loss': 2.3915, 'grad_norm': 2.767921209335327, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.41it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s]                                               {'loss': 2.4217, 'grad_norm': 3.565887689590454, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.31it/s]                                               {'loss': 2.4799, 'grad_norm': 2.816337823867798, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.26it/s]                                               {'loss': 2.2512, 'grad_norm': 2.582343578338623, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.26it/s]100%|██████████| 40/40 [00:16<00:00,  2.87it/s]                                               {'loss': 2.7182, 'grad_norm': 9.6791410446167, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.87it/s]                                               {'train_runtime': 17.011, 'train_samples_per_second': 33.214, 'train_steps_per_second': 2.351, 'train_loss': 2.5246085464954375, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.87it/s]100%|██████████| 40/40 [00:17<00:00,  2.35it/s]
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.6924, 'grad_norm': 3.6710457801818848, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.7, 'grad_norm': 2.845888376235962, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]  8%|▊         | 3/40 [00:01<00:17,  2.16it/s]                                              {'loss': 2.7363, 'grad_norm': 3.2592613697052, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.16it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.5492, 'grad_norm': 3.1838715076446533, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s]                                              {'loss': 2.5231, 'grad_norm': 3.1599104404449463, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s]                                              {'loss': 2.5353, 'grad_norm': 2.8028364181518555, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 2.5496, 'grad_norm': 3.254103183746338, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 2.1304, 'grad_norm': 7.355809688568115, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.15it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s]                                              {'loss': 2.6372, 'grad_norm': 3.947941303253174, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.57it/s]                                               {'loss': 2.5977, 'grad_norm': 2.964240312576294, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.57it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s]                                               {'loss': 2.249, 'grad_norm': 3.335207223892212, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s] 30%|███       | 12/40 [00:05<00:11,  2.37it/s]                                               {'loss': 2.5131, 'grad_norm': 3.0089943408966064, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.37it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.6028, 'grad_norm': 3.850461721420288, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.27it/s]                                               {'loss': 2.3807, 'grad_norm': 2.461434841156006, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.27it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.3653, 'grad_norm': 2.595388889312744, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s] 40%|████      | 16/40 [00:06<00:08,  2.89it/s]                                               {'loss': 2.2114, 'grad_norm': 7.960699081420898, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.89it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s]                                               {'loss': 2.2722, 'grad_norm': 2.877290964126587, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.54it/s]                                               {'loss': 2.4904, 'grad_norm': 3.4974443912506104, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.54it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s]                                               {'loss': 2.442, 'grad_norm': 3.165046453475952, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s] 50%|█████     | 20/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.4032, 'grad_norm': 2.9312334060668945, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.35it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.3259, 'grad_norm': 4.204017162322998, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.377, 'grad_norm': 3.194723606109619, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.4349, 'grad_norm': 2.762373924255371, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.84it/s]                                               {'loss': 3.0002, 'grad_norm': 16.099260330200195, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.84it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 2.3303, 'grad_norm': 3.2837376594543457, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s]                                               {'loss': 2.3527, 'grad_norm': 2.815824270248413, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.354, 'grad_norm': 2.8508641719818115, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s] 70%|███████   | 28/40 [00:11<00:05,  2.30it/s]                                               {'loss': 2.3476, 'grad_norm': 2.8739538192749023, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.30it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.352, 'grad_norm': 2.7627079486846924, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.4245, 'grad_norm': 2.947023868560791, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s]                                               {'loss': 2.4538, 'grad_norm': 3.3717033863067627, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s] 80%|████████  | 32/40 [00:13<00:02,  2.85it/s]                                               {'loss': 2.5259, 'grad_norm': 12.698189735412598, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.61it/s]                                               {'loss': 2.3581, 'grad_norm': 2.9590184688568115, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.61it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.2569, 'grad_norm': 2.8851850032806396, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s]                                               {'loss': 2.2526, 'grad_norm': 3.0062999725341797, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s]                                               {'loss': 2.4286, 'grad_norm': 3.16817569732666, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s]                                               {'loss': 2.2618, 'grad_norm': 3.5740232467651367, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.24it/s]                                               {'loss': 2.266, 'grad_norm': 3.2806167602539062, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.24it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.22it/s]                                               {'loss': 2.2559, 'grad_norm': 2.2625699043273926, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.22it/s]100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'loss': 2.8191, 'grad_norm': 9.746255874633789, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'train_runtime': 16.6827, 'train_samples_per_second': 33.867, 'train_steps_per_second': 2.398, 'train_loss': 2.4439747273921966, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]100%|██████████| 40/40 [00:16<00:00,  2.40it/s]
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.6259, 'grad_norm': 3.4298183917999268, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.6429, 'grad_norm': 2.397724151611328, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]  8%|▊         | 3/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.4978, 'grad_norm': 2.642812967300415, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.21it/s] 10%|█         | 4/40 [00:01<00:16,  2.22it/s]                                              {'loss': 2.673, 'grad_norm': 2.797471761703491, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.22it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.24it/s]                                              {'loss': 2.5933, 'grad_norm': 2.9269444942474365, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.24it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s]                                              {'loss': 2.7483, 'grad_norm': 3.1069753170013428, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s]                                              {'loss': 2.6968, 'grad_norm': 3.0417537689208984, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s] 20%|██        | 8/40 [00:03<00:11,  2.86it/s]                                              {'loss': 2.1489, 'grad_norm': 16.93707275390625, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.86it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s]                                              {'loss': 2.5623, 'grad_norm': 2.82038950920105, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.5369, 'grad_norm': 3.871515989303589, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s]                                               {'loss': 2.5054, 'grad_norm': 2.5136497020721436, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s] 30%|███       | 12/40 [00:05<00:12,  2.31it/s]                                               {'loss': 2.5177, 'grad_norm': 2.9160497188568115, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.31it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.5055, 'grad_norm': 3.4432387351989746, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.462, 'grad_norm': 2.9509260654449463, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.21it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.5764, 'grad_norm': 2.894397258758545, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s] 40%|████      | 16/40 [00:06<00:08,  2.83it/s]                                               {'loss': 2.9669, 'grad_norm': 8.373433113098145, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.83it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s]                                               {'loss': 2.4032, 'grad_norm': 3.815208673477173, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.4254, 'grad_norm': 2.59651517868042, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.4997, 'grad_norm': 2.99837064743042, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.4011, 'grad_norm': 2.5345051288604736, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.5528, 'grad_norm': 3.02191162109375, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.4043, 'grad_norm': 2.693537473678589, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.25it/s]                                               {'loss': 2.3846, 'grad_norm': 2.9529716968536377, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.25it/s] 60%|██████    | 24/40 [00:09<00:05,  2.85it/s]                                               {'loss': 2.3364, 'grad_norm': 12.914017677307129, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s]                                               {'loss': 2.5301, 'grad_norm': 2.885383129119873, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s]                                               {'loss': 2.4029, 'grad_norm': 3.0445053577423096, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.4731, 'grad_norm': 2.9313912391662598, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.405, 'grad_norm': 3.1504695415496826, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.31it/s]                                               {'loss': 2.5313, 'grad_norm': 2.9222474098205566, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.31it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.29it/s]                                               {'loss': 2.4391, 'grad_norm': 3.1350767612457275, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.29it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.28it/s]                                               {'loss': 2.2861, 'grad_norm': 2.8308064937591553, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.28it/s] 80%|████████  | 32/40 [00:13<00:02,  2.85it/s]                                               {'loss': 2.5439, 'grad_norm': 9.665546417236328, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s]                                               {'loss': 2.4524, 'grad_norm': 2.421738386154175, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s]                                               {'loss': 2.3567, 'grad_norm': 2.692800998687744, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s]                                               {'loss': 2.4146, 'grad_norm': 2.854750156402588, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.32it/s]                                               {'loss': 2.3011, 'grad_norm': 3.2620952129364014, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.32it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.28it/s]                                               {'loss': 2.4806, 'grad_norm': 3.4606051445007324, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s]                                               {'loss': 2.4523, 'grad_norm': 2.748364210128784, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]                                               {'loss': 2.3226, 'grad_norm': 3.0954954624176025, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'loss': 2.166, 'grad_norm': 11.964799880981445, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'train_runtime': 16.6962, 'train_samples_per_second': 33.84, 'train_steps_per_second': 2.396, 'train_loss': 2.4806309580802917, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]100%|██████████| 40/40 [00:16<00:00,  2.40it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.27it/s]                                              {'loss': 2.5455, 'grad_norm': 2.7043347358703613, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.27it/s]  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.6722, 'grad_norm': 2.759570837020874, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]  8%|▊         | 3/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.6084, 'grad_norm': 2.404176950454712, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.20it/s] 10%|█         | 4/40 [00:01<00:16,  2.17it/s]                                              {'loss': 2.6269, 'grad_norm': 2.32487416267395, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.17it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s]                                              {'loss': 2.7139, 'grad_norm': 3.307318925857544, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.16it/s]                                              {'loss': 2.5691, 'grad_norm': 3.3560895919799805, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.16it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s]                                              {'loss': 2.7246, 'grad_norm': 3.562016487121582, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s] 20%|██        | 8/40 [00:03<00:11,  2.84it/s]                                              {'loss': 3.0289, 'grad_norm': 13.221329689025879, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.84it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s]                                              {'loss': 2.5022, 'grad_norm': 3.0306577682495117, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s]                                               {'loss': 2.4407, 'grad_norm': 2.763916254043579, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s]                                               {'loss': 2.6882, 'grad_norm': 3.3950304985046387, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s] 30%|███       | 12/40 [00:05<00:12,  2.29it/s]                                               {'loss': 2.5485, 'grad_norm': 2.6741769313812256, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.29it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.25it/s]                                               {'loss': 2.5824, 'grad_norm': 2.4518468379974365, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.25it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.4239, 'grad_norm': 2.5532357692718506, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.4537, 'grad_norm': 2.5956966876983643, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.78it/s]                                               {'loss': 2.1724, 'grad_norm': 9.20676326751709, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.78it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.4352, 'grad_norm': 3.2151260375976562, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s]                                               {'loss': 2.5937, 'grad_norm': 3.267975091934204, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.44it/s]                                               {'loss': 2.4726, 'grad_norm': 2.72086238861084, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.44it/s] 50%|█████     | 20/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.3747, 'grad_norm': 2.7920215129852295, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.41it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.683, 'grad_norm': 2.751974105834961, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.2484, 'grad_norm': 2.5760207176208496, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.25it/s]                                               {'loss': 2.4172, 'grad_norm': 2.8239524364471436, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.25it/s] 60%|██████    | 24/40 [00:09<00:05,  2.83it/s]                                               {'loss': 2.3464, 'grad_norm': 9.299967765808105, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s]                                               {'loss': 2.4028, 'grad_norm': 3.0845718383789062, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.46it/s]                                               {'loss': 2.3429, 'grad_norm': 2.1949727535247803, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.46it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.3078, 'grad_norm': 2.0605297088623047, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.33it/s]                                               {'loss': 2.4634, 'grad_norm': 3.103018283843994, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.3366, 'grad_norm': 2.7524735927581787, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.27it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.419, 'grad_norm': 3.4940710067749023, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s]                                               {'loss': 2.5252, 'grad_norm': 2.715716600418091, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s] 80%|████████  | 32/40 [00:13<00:02,  2.80it/s]                                               {'loss': 1.8524, 'grad_norm': 10.634183883666992, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.55it/s]                                               {'loss': 2.6135, 'grad_norm': 3.3474133014678955, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.55it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.39it/s]                                               {'loss': 2.3263, 'grad_norm': 3.260134696960449, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.39it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.31it/s]                                               {'loss': 2.3722, 'grad_norm': 2.681734561920166, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.31it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.25it/s]                                               {'loss': 2.4147, 'grad_norm': 3.119781017303467, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.25it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.21it/s]                                               {'loss': 2.3199, 'grad_norm': 2.9084348678588867, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.21it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.19it/s]                                               {'loss': 2.3614, 'grad_norm': 2.6727869510650635, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.19it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.16it/s]                                               {'loss': 2.4413, 'grad_norm': 2.6637442111968994, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.16it/s]                                               {'loss': 2.8064, 'grad_norm': 10.112869262695312, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.16it/s]                                               {'train_runtime': 16.7883, 'train_samples_per_second': 33.654, 'train_steps_per_second': 2.383, 'train_loss': 2.4794612526893616, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.16it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.6028, 'grad_norm': 2.839576005935669, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.4784, 'grad_norm': 3.2441890239715576, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]  8%|▊         | 3/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.781, 'grad_norm': 3.7838268280029297, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.21it/s] 10%|█         | 4/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.5679, 'grad_norm': 2.5664095878601074, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.20it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s]                                              {'loss': 2.536, 'grad_norm': 3.0820486545562744, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.4826, 'grad_norm': 3.142204999923706, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.16it/s]                                              {'loss': 2.7077, 'grad_norm': 3.249964714050293, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.16it/s]                                              {'loss': 2.5894, 'grad_norm': 9.764503479003906, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.16it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s]                                              {'loss': 2.5301, 'grad_norm': 2.716550588607788, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.56it/s]                                               {'loss': 2.5232, 'grad_norm': 2.996556282043457, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.56it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s]                                               {'loss': 2.5888, 'grad_norm': 3.1389081478118896, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s] 30%|███       | 12/40 [00:05<00:11,  2.37it/s]                                               {'loss': 2.4442, 'grad_norm': 2.8951833248138428, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.37it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.30it/s]                                               {'loss': 2.5671, 'grad_norm': 3.990840196609497, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.30it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s]                                               {'loss': 2.5199, 'grad_norm': 3.351909637451172, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.4156, 'grad_norm': 2.980024814605713, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.75it/s]                                               {'loss': 2.4999, 'grad_norm': 9.89613151550293, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.75it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.48, 'grad_norm': 3.824817657470703, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.3897, 'grad_norm': 2.800649404525757, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.3603, 'grad_norm': 3.1903634071350098, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.31it/s]                                               {'loss': 2.48, 'grad_norm': 2.5112924575805664, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.31it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.4349, 'grad_norm': 2.8005213737487793, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.3882, 'grad_norm': 3.071662425994873, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.25it/s]                                               {'loss': 2.4224, 'grad_norm': 3.522209644317627, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.25it/s] 60%|██████    | 24/40 [00:09<00:05,  2.82it/s]                                               {'loss': 2.3822, 'grad_norm': 12.061690330505371, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.82it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.57it/s]                                               {'loss': 2.3336, 'grad_norm': 2.5766894817352295, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.57it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.43it/s]                                               {'loss': 2.5547, 'grad_norm': 2.810617208480835, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.43it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.4526, 'grad_norm': 2.7733891010284424, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s] 70%|███████   | 28/40 [00:11<00:05,  2.24it/s]                                               {'loss': 2.3833, 'grad_norm': 2.6161887645721436, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.24it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.389, 'grad_norm': 2.9969630241394043, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.24it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.20it/s]                                               {'loss': 2.3963, 'grad_norm': 2.948831796646118, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.20it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.17it/s]                                               {'loss': 2.4161, 'grad_norm': 2.7151010036468506, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.17it/s] 80%|████████  | 32/40 [00:13<00:02,  2.80it/s]                                               {'loss': 1.3954, 'grad_norm': 10.1000337600708, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s]                                               {'loss': 2.4064, 'grad_norm': 2.7874233722686768, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s]                                               {'loss': 2.371, 'grad_norm': 3.089895009994507, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s]                                               {'loss': 2.2993, 'grad_norm': 2.3835315704345703, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.33it/s]                                               {'loss': 2.4468, 'grad_norm': 3.1668319702148438, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.33it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s]                                               {'loss': 2.5506, 'grad_norm': 2.905694007873535, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.28it/s]                                               {'loss': 2.3398, 'grad_norm': 4.227682113647461, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.27it/s]                                               {'loss': 2.3705, 'grad_norm': 2.6597065925598145, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.27it/s]100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'loss': 2.6617, 'grad_norm': 13.277396202087402, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'train_runtime': 16.7852, 'train_samples_per_second': 33.661, 'train_steps_per_second': 2.383, 'train_loss': 2.448483815789223, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:19
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.5891, 'grad_norm': 3.8244643211364746, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.5848, 'grad_norm': 2.3950300216674805, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.6586, 'grad_norm': 3.268087863922119, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.19it/s] 10%|█         | 4/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.7041, 'grad_norm': 3.5106942653656006, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.19it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s]                                              {'loss': 2.4898, 'grad_norm': 2.586962938308716, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.5723, 'grad_norm': 3.140171527862549, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 2.5277, 'grad_norm': 3.5460448265075684, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s] 20%|██        | 8/40 [00:03<00:11,  2.83it/s]                                              {'loss': 2.9212, 'grad_norm': 14.180526733398438, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.55it/s]                                              {'loss': 2.3584, 'grad_norm': 3.6465229988098145, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.55it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s]                                               {'loss': 2.3987, 'grad_norm': 2.6092584133148193, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s]                                               {'loss': 2.6019, 'grad_norm': 3.7414417266845703, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s] 30%|███       | 12/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.4166, 'grad_norm': 3.338689088821411, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.25it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.20it/s]                                               {'loss': 2.5044, 'grad_norm': 3.177185535430908, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.20it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.18it/s]                                               {'loss': 2.4382, 'grad_norm': 3.0096547603607178, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.18it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s]                                               {'loss': 2.6021, 'grad_norm': 3.0068650245666504, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s] 40%|████      | 16/40 [00:06<00:08,  2.80it/s]                                               {'loss': 2.986, 'grad_norm': 35.74691390991211, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s]                                               {'loss': 2.3749, 'grad_norm': 3.0930240154266357, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.41it/s]                                               {'loss': 2.4519, 'grad_norm': 3.0178346633911133, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.41it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.31it/s]                                               {'loss': 2.6337, 'grad_norm': 3.016815423965454, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:09,  2.31it/s] 50%|█████     | 20/40 [00:08<00:08,  2.24it/s]                                               {'loss': 2.4065, 'grad_norm': 2.8589212894439697, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.24it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.20it/s]                                               {'loss': 2.406, 'grad_norm': 2.9270007610321045, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.20it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.17it/s]                                               {'loss': 2.3657, 'grad_norm': 2.556198835372925, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.17it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.15it/s]                                               {'loss': 2.3091, 'grad_norm': 2.7466931343078613, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.15it/s] 60%|██████    | 24/40 [00:10<00:05,  2.80it/s]                                               {'loss': 2.151, 'grad_norm': 10.671249389648438, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.80it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s]                                               {'loss': 2.3583, 'grad_norm': 3.0196220874786377, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.47it/s]                                               {'loss': 2.2883, 'grad_norm': 2.364520788192749, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.4144, 'grad_norm': 2.7474050521850586, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.33it/s]                                               {'loss': 2.5519, 'grad_norm': 2.94138765335083, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s]                                               {'loss': 2.2349, 'grad_norm': 2.743119239807129, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.3919, 'grad_norm': 3.065229892730713, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s]                                               {'loss': 2.2394, 'grad_norm': 3.238767623901367, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s] 80%|████████  | 32/40 [00:13<00:02,  2.80it/s]                                               {'loss': 1.9502, 'grad_norm': 14.712958335876465, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s]                                               {'loss': 2.3548, 'grad_norm': 2.6971702575683594, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s]                                               {'loss': 2.1864, 'grad_norm': 4.45986795425415, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.47it/s]                                               {'loss': 2.2836, 'grad_norm': 2.8046329021453857, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.47it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.38it/s]                                               {'loss': 2.3232, 'grad_norm': 2.8813247680664062, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.38it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.31it/s]                                               {'loss': 2.4497, 'grad_norm': 3.703244924545288, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s]                                               {'loss': 2.4832, 'grad_norm': 3.4782488346099854, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.3839, 'grad_norm': 2.8700144290924072, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]100%|██████████| 40/40 [00:16<00:00,  2.78it/s]                                               {'loss': 3.1593, 'grad_norm': 10.812427520751953, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.78it/s]                                               {'train_runtime': 16.9352, 'train_samples_per_second': 33.362, 'train_steps_per_second': 2.362, 'train_loss': 2.4626459896564485, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.78it/s]100%|██████████| 40/40 [00:16<00:00,  2.36it/s]
CLIENT:28
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.4964, 'grad_norm': 2.603421926498413, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]  5%|▌         | 2/40 [00:00<00:17,  2.14it/s]                                              {'loss': 2.5147, 'grad_norm': 2.8072829246520996, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.14it/s]  8%|▊         | 3/40 [00:01<00:17,  2.15it/s]                                              {'loss': 2.7216, 'grad_norm': 3.256971597671509, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.15it/s] 10%|█         | 4/40 [00:01<00:16,  2.14it/s]                                              {'loss': 2.7006, 'grad_norm': 3.4879252910614014, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.14it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s]                                              {'loss': 2.7576, 'grad_norm': 3.41127610206604, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.16it/s]                                              {'loss': 2.5942, 'grad_norm': 3.315187692642212, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.16it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.28it/s]                                              {'loss': 2.5327, 'grad_norm': 2.5971946716308594, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.28it/s]                                              {'loss': 3.6889, 'grad_norm': 14.621355056762695, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.28it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.91it/s]                                              {'loss': 2.5391, 'grad_norm': 2.2308707237243652, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.91it/s] 25%|██▌       | 10/40 [00:04<00:10,  2.88it/s]                                               {'loss': 2.4492, 'grad_norm': 3.0704236030578613, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:10,  2.88it/s] 28%|██▊       | 11/40 [00:04<00:09,  2.94it/s]                                               {'loss': 2.5319, 'grad_norm': 3.028742551803589, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:09,  2.94it/s] 30%|███       | 12/40 [00:04<00:09,  2.99it/s]                                               {'loss': 2.4162, 'grad_norm': 3.2976412773132324, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.99it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.02it/s]                                               {'loss': 2.6329, 'grad_norm': 3.062821865081787, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.02it/s] 35%|███▌      | 14/40 [00:05<00:08,  3.03it/s]                                               {'loss': 2.4644, 'grad_norm': 3.2836432456970215, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:08,  3.03it/s] 38%|███▊      | 15/40 [00:05<00:08,  3.00it/s]                                               {'loss': 2.6634, 'grad_norm': 3.9227371215820312, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  3.00it/s] 40%|████      | 16/40 [00:05<00:06,  3.73it/s]                                               {'loss': 2.5043, 'grad_norm': 9.76165771484375, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:06,  3.73it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.29it/s]                                               {'loss': 2.4668, 'grad_norm': 2.6638851165771484, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.29it/s] 45%|████▌     | 18/40 [00:06<00:07,  2.89it/s]                                               {'loss': 2.4316, 'grad_norm': 2.665191888809204, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:07,  2.89it/s] 48%|████▊     | 19/40 [00:06<00:07,  2.76it/s]                                               {'loss': 2.4583, 'grad_norm': 4.105350971221924, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.76it/s] 50%|█████     | 20/40 [00:07<00:07,  2.64it/s]                                               {'loss': 2.5028, 'grad_norm': 2.599982738494873, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.64it/s] 52%|█████▎    | 21/40 [00:07<00:07,  2.49it/s]                                               {'loss': 2.4635, 'grad_norm': 2.888972043991089, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:07,  2.49it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.40it/s]                                               {'loss': 2.4862, 'grad_norm': 3.2031490802764893, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.40it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.32it/s]                                               {'loss': 2.4734, 'grad_norm': 3.2169957160949707, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.32it/s] 60%|██████    | 24/40 [00:08<00:05,  2.94it/s]                                               {'loss': 2.0761, 'grad_norm': 9.27900218963623, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.94it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.69it/s]                                               {'loss': 2.3013, 'grad_norm': 5.587466716766357, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.69it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.51it/s]                                               {'loss': 2.4752, 'grad_norm': 2.950530767440796, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.38it/s]                                               {'loss': 2.4803, 'grad_norm': 2.772064208984375, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.38it/s] 70%|███████   | 28/40 [00:10<00:05,  2.32it/s]                                               {'loss': 2.5027, 'grad_norm': 2.4312667846679688, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.32it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.28it/s]                                               {'loss': 2.3484, 'grad_norm': 2.886361837387085, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.28it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.25it/s]                                               {'loss': 2.2868, 'grad_norm': 3.475010395050049, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.23it/s]                                               {'loss': 2.4269, 'grad_norm': 3.6741862297058105, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.23it/s] 80%|████████  | 32/40 [00:12<00:02,  2.80it/s]                                               {'loss': 2.5107, 'grad_norm': 9.907734870910645, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.55it/s]                                               {'loss': 2.5293, 'grad_norm': 2.5865073204040527, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.55it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.40it/s]                                               {'loss': 2.4567, 'grad_norm': 3.15071702003479, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.40it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.29it/s]                                               {'loss': 2.2214, 'grad_norm': 2.8072638511657715, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.29it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.24it/s]                                               {'loss': 2.5087, 'grad_norm': 3.5038163661956787, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.24it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.20it/s]                                               {'loss': 2.4015, 'grad_norm': 2.506054162979126, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.20it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.18it/s]                                               {'loss': 2.5133, 'grad_norm': 3.160998821258545, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.18it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.16it/s]                                               {'loss': 2.3966, 'grad_norm': 2.9079298973083496, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.16it/s]100%|██████████| 40/40 [00:15<00:00,  2.78it/s]                                               {'loss': 2.455, 'grad_norm': 9.366596221923828, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.78it/s]                                               {'train_runtime': 15.8029, 'train_samples_per_second': 35.753, 'train_steps_per_second': 2.531, 'train_loss': 2.509540629386902, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.78it/s]100%|██████████| 40/40 [00:15<00:00,  2.53it/s]
CLIENT:94
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]                                              {'loss': 2.6335, 'grad_norm': 3.3223068714141846, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.41it/s]  5%|▌         | 2/40 [00:01<00:21,  1.77it/s]                                              {'loss': 2.5798, 'grad_norm': 3.7014918327331543, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:21,  1.77it/s]  8%|▊         | 3/40 [00:01<00:18,  2.03it/s]                                              {'loss': 2.6883, 'grad_norm': 3.401200771331787, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:18,  2.03it/s] 10%|█         | 4/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.582, 'grad_norm': 2.8682262897491455, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.19it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.30it/s]                                              {'loss': 2.6871, 'grad_norm': 2.6528866291046143, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.30it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.28it/s]                                              {'loss': 2.417, 'grad_norm': 3.031148672103882, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.28it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.29it/s]                                              {'loss': 2.6119, 'grad_norm': 3.4376728534698486, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.29it/s] 20%|██        | 8/40 [00:03<00:16,  1.97it/s]                                              {'loss': 2.0508, 'grad_norm': 8.2653169631958, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:16,  1.97it/s] 22%|██▎       | 9/40 [00:04<00:15,  2.01it/s]                                              {'loss': 2.4901, 'grad_norm': 3.06499981880188, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:15,  2.01it/s] 25%|██▌       | 10/40 [00:04<00:14,  2.05it/s]                                               {'loss': 2.4463, 'grad_norm': 2.1825623512268066, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:14,  2.05it/s] 28%|██▊       | 11/40 [00:05<00:14,  2.07it/s]                                               {'loss': 2.5132, 'grad_norm': 2.4566755294799805, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:14,  2.07it/s] 30%|███       | 12/40 [00:05<00:13,  2.07it/s]                                               {'loss': 2.3992, 'grad_norm': 3.0095410346984863, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:13,  2.07it/s] 32%|███▎      | 13/40 [00:06<00:13,  2.06it/s]                                               {'loss': 2.4163, 'grad_norm': 2.5030221939086914, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:13,  2.06it/s] 35%|███▌      | 14/40 [00:06<00:12,  2.07it/s]                                               {'loss': 2.4748, 'grad_norm': 2.9561545848846436, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:12,  2.07it/s] 38%|███▊      | 15/40 [00:07<00:12,  2.08it/s]                                               {'loss': 2.6473, 'grad_norm': 2.5044312477111816, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:12,  2.08it/s]                                               {'loss': 3.129, 'grad_norm': 12.966745376586914, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:11,  2.08it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.60it/s]                                               {'loss': 2.3411, 'grad_norm': 3.3421871662139893, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.60it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.46it/s]                                               {'loss': 2.3909, 'grad_norm': 2.580261707305908, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.46it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s]                                               {'loss': 2.5534, 'grad_norm': 2.7343173027038574, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s] 50%|█████     | 20/40 [00:09<00:08,  2.29it/s]                                               {'loss': 2.6589, 'grad_norm': 2.7923519611358643, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.29it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.2903, 'grad_norm': 2.6772725582122803, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.21it/s]                                               {'loss': 2.4419, 'grad_norm': 2.7046525478363037, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.21it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.19it/s]                                               {'loss': 2.4943, 'grad_norm': 2.3615338802337646, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.19it/s] 60%|██████    | 24/40 [00:10<00:05,  2.83it/s]                                               {'loss': 1.7604, 'grad_norm': 8.19731616973877, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.67it/s]                                               {'loss': 2.3007, 'grad_norm': 2.454457998275757, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.67it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s]                                               {'loss': 2.4488, 'grad_norm': 2.576791286468506, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.40it/s]                                               {'loss': 2.2658, 'grad_norm': 3.1803717613220215, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.40it/s] 70%|███████   | 28/40 [00:12<00:05,  2.30it/s]                                               {'loss': 2.527, 'grad_norm': 3.0933997631073, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.30it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.25it/s]                                               {'loss': 2.4005, 'grad_norm': 2.6418259143829346, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.4099, 'grad_norm': 2.493881940841675, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.21it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.18it/s]                                               {'loss': 2.4676, 'grad_norm': 3.5390214920043945, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.18it/s] 80%|████████  | 32/40 [00:14<00:02,  2.82it/s]                                               {'loss': 2.8732, 'grad_norm': 16.64610481262207, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s]                                               {'loss': 2.5012, 'grad_norm': 2.780768394470215, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.55it/s]                                               {'loss': 2.456, 'grad_norm': 2.375434637069702, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.42it/s]                                               {'loss': 2.2815, 'grad_norm': 3.251009464263916, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.42it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s]                                               {'loss': 2.1655, 'grad_norm': 2.51072096824646, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.26it/s]                                               {'loss': 2.2955, 'grad_norm': 3.451594591140747, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.22it/s]                                               {'loss': 2.49, 'grad_norm': 2.547832489013672, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.22it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.21it/s]                                               {'loss': 2.1862, 'grad_norm': 2.533719778060913, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.21it/s]100%|██████████| 40/40 [00:17<00:00,  2.81it/s]                                               {'loss': 1.9658, 'grad_norm': 7.395133018493652, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.81it/s]                                               {'train_runtime': 17.4995, 'train_samples_per_second': 32.287, 'train_steps_per_second': 2.286, 'train_loss': 2.44332532286644, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.81it/s]100%|██████████| 40/40 [00:17<00:00,  2.29it/s]
CLIENT:25
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.31it/s]                                              {'loss': 2.7026, 'grad_norm': 2.9262819290161133, 'learning_rate': 0.00018377223398316204, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.31it/s]  5%|▌         | 2/40 [00:00<00:15,  2.40it/s]                                              {'loss': 2.5119, 'grad_norm': 2.8570311069488525, 'learning_rate': 0.000179177928133583, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:15,  2.40it/s]  8%|▊         | 3/40 [00:01<00:15,  2.44it/s]                                              {'loss': 2.6648, 'grad_norm': 2.8566911220550537, 'learning_rate': 0.00017458362228400394, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.44it/s] 10%|█         | 4/40 [00:01<00:14,  2.48it/s]                                              {'loss': 2.7988, 'grad_norm': 3.169343948364258, 'learning_rate': 0.0001699893164344249, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.48it/s] 12%|█▎        | 5/40 [00:02<00:13,  2.51it/s]                                              {'loss': 2.6016, 'grad_norm': 2.6287732124328613, 'learning_rate': 0.00016539501058484584, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.51it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.54it/s]                                              {'loss': 2.7571, 'grad_norm': 3.549550771713257, 'learning_rate': 0.00016080070473526678, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.54it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.57it/s]                                              {'loss': 2.6598, 'grad_norm': 2.8210511207580566, 'learning_rate': 0.00015620639888568773, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.57it/s] 20%|██        | 8/40 [00:02<00:09,  3.29it/s]                                              {'loss': 2.3435, 'grad_norm': 10.05561637878418, 'learning_rate': 0.00015161209303610868, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.29it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.81it/s]                                              {'loss': 2.6449, 'grad_norm': 3.0574352741241455, 'learning_rate': 0.00014701778718652966, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.81it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.55it/s]                                               {'loss': 2.6043, 'grad_norm': 2.6422014236450195, 'learning_rate': 0.00014242348133695058, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.55it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.5841, 'grad_norm': 2.947427988052368, 'learning_rate': 0.00013782917548737153, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s] 30%|███       | 12/40 [00:04<00:12,  2.28it/s]                                               {'loss': 2.4942, 'grad_norm': 2.307729721069336, 'learning_rate': 0.00013323486963779247, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.28it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.22it/s]                                               {'loss': 2.5533, 'grad_norm': 2.6900312900543213, 'learning_rate': 0.00012864056378821342, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.22it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.19it/s]                                               {'loss': 2.5484, 'grad_norm': 2.3339617252349854, 'learning_rate': 0.0001240462579386344, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.5383, 'grad_norm': 2.5511388778686523, 'learning_rate': 0.00011945195208905533, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.7073, 'grad_norm': 11.275385856628418, 'learning_rate': 0.00011485764623947628, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:11,  2.17it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.66it/s]                                               {'loss': 2.5679, 'grad_norm': 3.108001947402954, 'learning_rate': 0.00011026334038989722, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.66it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.5112, 'grad_norm': 2.6427805423736572, 'learning_rate': 0.00010566903454031816, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s]                                               {'loss': 2.349, 'grad_norm': 2.6190454959869385, 'learning_rate': 0.00010107472869073914, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s] 50%|█████     | 20/40 [00:08<00:08,  2.36it/s]                                               {'loss': 2.5347, 'grad_norm': 2.880756378173828, 'learning_rate': 9.648042284116007e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.36it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.5921, 'grad_norm': 3.599088668823242, 'learning_rate': 9.188611699158102e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.5096, 'grad_norm': 3.363506555557251, 'learning_rate': 8.729181114200197e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.21it/s]                                               {'loss': 2.4037, 'grad_norm': 2.8643438816070557, 'learning_rate': 8.269750529242292e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.21it/s] 60%|██████    | 24/40 [00:09<00:05,  2.74it/s]                                               {'loss': 2.6346, 'grad_norm': 11.857549667358398, 'learning_rate': 7.810319944284387e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.74it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.52it/s]                                               {'loss': 2.5797, 'grad_norm': 3.436866044998169, 'learning_rate': 7.350889359326483e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.52it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.41it/s]                                               {'loss': 2.3524, 'grad_norm': 2.8839995861053467, 'learning_rate': 6.891458774368576e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.41it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.3787, 'grad_norm': 2.515610694885254, 'learning_rate': 6.432028189410671e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s] 70%|███████   | 28/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.3704, 'grad_norm': 3.3725173473358154, 'learning_rate': 5.9725976044527666e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.32it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.29it/s]                                               {'loss': 2.3674, 'grad_norm': 2.797278881072998, 'learning_rate': 5.513167019494861e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.29it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.5903, 'grad_norm': 2.99440336227417, 'learning_rate': 5.053736434536957e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.22it/s]                                               {'loss': 2.445, 'grad_norm': 2.9671220779418945, 'learning_rate': 4.594305849579051e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.22it/s] 80%|████████  | 32/40 [00:13<00:02,  2.80it/s]                                               {'loss': 2.1882, 'grad_norm': 11.46641731262207, 'learning_rate': 4.134875264621146e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.54it/s]                                               {'loss': 2.372, 'grad_norm': 2.776978015899658, 'learning_rate': 3.6754446796632414e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.54it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.40it/s]                                               {'loss': 2.4018, 'grad_norm': 3.093914270401001, 'learning_rate': 3.2160140947053356e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.40it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.30it/s]                                               {'loss': 2.4041, 'grad_norm': 2.5508859157562256, 'learning_rate': 2.7565835097474304e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.30it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.24it/s]                                               {'loss': 2.2895, 'grad_norm': 3.170389413833618, 'learning_rate': 2.2971529247895255e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.24it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.20it/s]                                               {'loss': 2.3768, 'grad_norm': 2.9867241382598877, 'learning_rate': 1.8377223398316207e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.20it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.16it/s]                                               {'loss': 2.4203, 'grad_norm': 3.7578375339508057, 'learning_rate': 1.3782917548737152e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.16it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.14it/s]                                               {'loss': 2.6732, 'grad_norm': 2.695727586746216, 'learning_rate': 9.188611699158104e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.14it/s]                                               {'loss': 2.5722, 'grad_norm': 12.513439178466797, 'learning_rate': 4.594305849579052e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.14it/s]                                               {'train_runtime': 16.5886, 'train_samples_per_second': 34.06, 'train_steps_per_second': 2.411, 'train_loss': 2.514987641572952, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.14it/s]100%|██████████| 40/40 [00:16<00:00,  2.41it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:39, 12.00it/s]  1%|          | 4/471 [00:00<01:17,  6.05it/s]  1%|          | 5/471 [00:00<01:25,  5.43it/s]  1%|▏         | 6/471 [00:01<01:30,  5.11it/s]  1%|▏         | 7/471 [00:01<01:32,  5.00it/s]  2%|▏         | 8/471 [00:01<01:36,  4.80it/s]  2%|▏         | 9/471 [00:01<01:35,  4.84it/s]  2%|▏         | 10/471 [00:01<01:40,  4.58it/s]  2%|▏         | 11/471 [00:02<01:37,  4.70it/s]  3%|▎         | 12/471 [00:02<01:41,  4.51it/s]  3%|▎         | 13/471 [00:02<01:36,  4.74it/s]  3%|▎         | 14/471 [00:02<01:42,  4.47it/s]  3%|▎         | 15/471 [00:03<01:36,  4.72it/s]  3%|▎         | 16/471 [00:03<01:43,  4.40it/s]  4%|▎         | 17/471 [00:03<01:34,  4.78it/s]  4%|▍         | 18/471 [00:03<01:40,  4.52it/s]  4%|▍         | 19/471 [00:03<01:38,  4.59it/s]  4%|▍         | 20/471 [00:04<01:36,  4.68it/s]  4%|▍         | 21/471 [00:04<01:38,  4.57it/s]  5%|▍         | 22/471 [00:04<01:34,  4.75it/s]  5%|▍         | 23/471 [00:04<01:39,  4.51it/s]  5%|▌         | 24/471 [00:04<01:36,  4.63it/s]  5%|▌         | 25/471 [00:05<01:39,  4.48it/s]  6%|▌         | 26/471 [00:05<01:34,  4.68it/s]  6%|▌         | 27/471 [00:05<01:38,  4.50it/s]  6%|▌         | 28/471 [00:05<01:33,  4.72it/s]  6%|▌         | 29/471 [00:06<01:40,  4.40it/s]  6%|▋         | 30/471 [00:06<01:32,  4.77it/s]  7%|▋         | 31/471 [00:06<01:37,  4.51it/s]  7%|▋         | 32/471 [00:06<01:33,  4.70it/s]  7%|▋         | 33/471 [00:06<01:38,  4.46it/s]  7%|▋         | 34/471 [00:07<01:35,  4.57it/s]  7%|▋         | 35/471 [00:07<01:36,  4.53it/s]  8%|▊         | 36/471 [00:07<01:34,  4.61it/s]  8%|▊         | 37/471 [00:07<01:36,  4.50it/s]  8%|▊         | 38/471 [00:08<01:34,  4.57it/s]  8%|▊         | 39/471 [00:08<01:35,  4.52it/s]  8%|▊         | 40/471 [00:08<01:32,  4.64it/s]  9%|▊         | 41/471 [00:08<01:35,  4.50it/s]  9%|▉         | 42/471 [00:08<01:33,  4.57it/s]  9%|▉         | 43/471 [00:09<01:35,  4.50it/s]  9%|▉         | 44/471 [00:09<01:35,  4.45it/s] 10%|▉         | 45/471 [00:09<01:32,  4.60it/s] 10%|▉         | 46/471 [00:09<01:34,  4.49it/s] 10%|▉         | 47/471 [00:10<01:31,  4.64it/s] 10%|█         | 48/471 [00:10<01:35,  4.45it/s] 10%|█         | 49/471 [00:10<01:30,  4.65it/s] 11%|█         | 50/471 [00:10<01:34,  4.48it/s] 11%|█         | 51/471 [00:10<01:29,  4.71it/s] 11%|█         | 52/471 [00:11<01:35,  4.40it/s] 11%|█▏        | 53/471 [00:11<01:28,  4.74it/s] 11%|█▏        | 54/471 [00:11<01:33,  4.44it/s] 12%|█▏        | 55/471 [00:11<01:28,  4.71it/s] 12%|█▏        | 56/471 [00:12<01:31,  4.53it/s] 12%|█▏        | 57/471 [00:12<01:31,  4.50it/s] 12%|█▏        | 58/471 [00:12<01:28,  4.69it/s] 13%|█▎        | 59/471 [00:12<01:30,  4.55it/s] 13%|█▎        | 60/471 [00:12<01:25,  4.78it/s] 13%|█▎        | 61/471 [00:13<01:30,  4.52it/s] 13%|█▎        | 62/471 [00:13<01:25,  4.79it/s] 13%|█▎        | 63/471 [00:13<01:30,  4.49it/s] 14%|█▎        | 64/471 [00:13<01:24,  4.83it/s] 14%|█▍        | 65/471 [00:13<01:28,  4.57it/s] 14%|█▍        | 66/471 [00:14<01:25,  4.71it/s] 14%|█▍        | 67/471 [00:14<01:30,  4.44it/s] 14%|█▍        | 68/471 [00:14<01:27,  4.63it/s] 15%|█▍        | 69/471 [00:14<01:29,  4.49it/s] 15%|█▍        | 70/471 [00:15<01:28,  4.55it/s] 15%|█▌        | 71/471 [00:15<01:28,  4.52it/s] 15%|█▌        | 72/471 [00:15<01:28,  4.51it/s] 15%|█▌        | 73/471 [00:15<01:25,  4.65it/s] 16%|█▌        | 74/471 [00:15<01:26,  4.60it/s] 16%|█▌        | 75/471 [00:16<01:24,  4.68it/s] 16%|█▌        | 76/471 [00:16<01:27,  4.51it/s] 16%|█▋        | 77/471 [00:16<01:25,  4.61it/s] 17%|█▋        | 78/471 [00:16<01:28,  4.46it/s] 17%|█▋        | 79/471 [00:16<01:23,  4.69it/s] 17%|█▋        | 80/471 [00:17<01:28,  4.41it/s] 17%|█▋        | 81/471 [00:17<01:23,  4.69it/s] 17%|█▋        | 82/471 [00:17<01:28,  4.38it/s] 18%|█▊        | 83/471 [00:17<01:22,  4.69it/s] 18%|█▊        | 84/471 [00:18<01:26,  4.50it/s] 18%|█▊        | 85/471 [00:18<01:25,  4.53it/s] 18%|█▊        | 86/471 [00:18<01:23,  4.60it/s] 18%|█▊        | 87/471 [00:18<01:24,  4.57it/s] 19%|█▊        | 88/471 [00:18<01:22,  4.67it/s] 19%|█▉        | 89/471 [00:19<01:23,  4.56it/s] 19%|█▉        | 90/471 [00:19<01:22,  4.64it/s] 19%|█▉        | 91/471 [00:19<01:24,  4.49it/s] 20%|█▉        | 92/471 [00:19<01:20,  4.71it/s] 20%|█▉        | 93/471 [00:20<01:25,  4.45it/s] 20%|█▉        | 94/471 [00:20<01:20,  4.68it/s] 20%|██        | 95/471 [00:20<01:25,  4.38it/s] 20%|██        | 96/471 [00:20<01:18,  4.77it/s] 21%|██        | 97/471 [00:20<01:24,  4.43it/s] 21%|██        | 98/471 [00:21<01:19,  4.68it/s] 21%|██        | 99/471 [00:21<01:21,  4.56it/s] 21%|██        | 100/471 [00:21<01:21,  4.54it/s] 21%|██▏       | 101/471 [00:21<01:20,  4.58it/s] 22%|██▏       | 102/471 [00:22<01:21,  4.53it/s] 22%|██▏       | 103/471 [00:22<01:19,  4.64it/s] 22%|██▏       | 104/471 [00:22<01:22,  4.47it/s] 22%|██▏       | 105/471 [00:22<01:20,  4.57it/s] 23%|██▎       | 106/471 [00:22<01:22,  4.44it/s] 23%|██▎       | 107/471 [00:23<01:17,  4.69it/s] 23%|██▎       | 108/471 [00:23<01:21,  4.48it/s] 23%|██▎       | 109/471 [00:23<01:16,  4.75it/s] 23%|██▎       | 110/471 [00:23<01:19,  4.54it/s] 24%|██▎       | 111/471 [00:23<01:16,  4.73it/s] 24%|██▍       | 112/471 [00:24<01:19,  4.49it/s] 24%|██▍       | 113/471 [00:24<01:16,  4.67it/s] 24%|██▍       | 114/471 [00:24<01:19,  4.50it/s] 24%|██▍       | 115/471 [00:24<01:17,  4.61it/s] 25%|██▍       | 116/471 [00:25<01:19,  4.48it/s] 25%|██▍       | 117/471 [00:25<01:17,  4.55it/s] 25%|██▌       | 118/471 [00:25<01:18,  4.50it/s] 25%|██▌       | 119/471 [00:25<01:17,  4.56it/s] 25%|██▌       | 120/471 [00:25<01:17,  4.51it/s] 26%|██▌       | 121/471 [00:26<01:16,  4.55it/s] 26%|██▌       | 122/471 [00:26<01:17,  4.50it/s] 26%|██▌       | 123/471 [00:26<01:18,  4.46it/s] 26%|██▋       | 124/471 [00:26<01:15,  4.62it/s] 27%|██▋       | 125/471 [00:27<01:18,  4.43it/s] 27%|██▋       | 126/471 [00:27<01:14,  4.64it/s] 27%|██▋       | 127/471 [00:27<01:17,  4.43it/s] 27%|██▋       | 128/471 [00:27<01:13,  4.68it/s] 27%|██▋       | 129/471 [00:27<01:17,  4.43it/s] 28%|██▊       | 130/471 [00:28<01:12,  4.67it/s] 28%|██▊       | 131/471 [00:28<01:16,  4.42it/s] 28%|██▊       | 132/471 [00:28<01:12,  4.70it/s] 28%|██▊       | 133/471 [00:28<01:16,  4.44it/s] 28%|██▊       | 134/471 [00:29<01:13,  4.58it/s] 29%|██▊       | 135/471 [00:29<01:15,  4.48it/s] 29%|██▉       | 136/471 [00:29<01:13,  4.58it/s] 29%|██▉       | 137/471 [00:29<01:13,  4.57it/s] 29%|██▉       | 138/471 [00:29<01:13,  4.50it/s] 30%|██▉       | 139/471 [00:30<01:10,  4.69it/s] 30%|██▉       | 140/471 [00:30<01:14,  4.47it/s] 30%|██▉       | 141/471 [00:30<01:10,  4.66it/s] 30%|███       | 142/471 [00:30<01:13,  4.45it/s] 30%|███       | 143/471 [00:31<01:09,  4.69it/s] 31%|███       | 144/471 [00:31<01:13,  4.43it/s] 31%|███       | 145/471 [00:31<01:09,  4.68it/s] 31%|███       | 146/471 [00:31<01:13,  4.41it/s] 31%|███       | 147/471 [00:31<01:08,  4.74it/s] 31%|███▏      | 148/471 [00:32<01:13,  4.41it/s] 32%|███▏      | 149/471 [00:32<01:08,  4.70it/s] 32%|███▏      | 150/471 [00:32<01:10,  4.55it/s] 32%|███▏      | 151/471 [00:32<01:10,  4.52it/s] 32%|███▏      | 152/471 [00:33<01:08,  4.65it/s] 32%|███▏      | 153/471 [00:33<01:10,  4.52it/s] 33%|███▎      | 154/471 [00:33<01:05,  4.81it/s] 33%|███▎      | 155/471 [00:33<01:09,  4.54it/s] 33%|███▎      | 156/471 [00:33<01:05,  4.83it/s] 33%|███▎      | 157/471 [00:34<01:09,  4.51it/s] 34%|███▎      | 158/471 [00:34<01:04,  4.84it/s] 34%|███▍      | 159/471 [00:34<01:08,  4.55it/s] 34%|███▍      | 160/471 [00:34<01:06,  4.69it/s] 34%|███▍      | 161/471 [00:34<01:07,  4.59it/s] 34%|███▍      | 162/471 [00:35<01:07,  4.57it/s] 35%|███▍      | 163/471 [00:35<01:07,  4.57it/s] 35%|███▍      | 164/471 [00:35<01:07,  4.53it/s] 35%|███▌      | 165/471 [00:35<01:04,  4.71it/s] 35%|███▌      | 166/471 [00:36<01:08,  4.48it/s] 35%|███▌      | 167/471 [00:36<01:02,  4.83it/s] 36%|███▌      | 168/471 [00:36<01:07,  4.48it/s] 36%|███▌      | 169/471 [00:36<01:02,  4.84it/s] 36%|███▌      | 170/471 [00:36<01:07,  4.47it/s] 36%|███▋      | 171/471 [00:37<01:03,  4.73it/s] 37%|███▋      | 172/471 [00:37<01:04,  4.60it/s] 37%|███▋      | 173/471 [00:37<01:04,  4.59it/s] 37%|███▋      | 174/471 [00:37<01:03,  4.65it/s] 37%|███▋      | 175/471 [00:37<01:05,  4.53it/s] 37%|███▋      | 176/471 [00:38<01:04,  4.59it/s] 38%|███▊      | 177/471 [00:38<01:02,  4.67it/s] 38%|███▊      | 178/471 [00:38<01:03,  4.60it/s] 38%|███▊      | 179/471 [00:38<01:02,  4.64it/s] 38%|███▊      | 180/471 [00:39<01:03,  4.61it/s] 38%|███▊      | 181/471 [00:39<01:02,  4.62it/s] 39%|███▊      | 182/471 [00:39<01:02,  4.61it/s] 39%|███▉      | 183/471 [00:39<01:03,  4.53it/s] 39%|███▉      | 184/471 [00:39<01:03,  4.54it/s] 39%|███▉      | 185/471 [00:40<01:04,  4.46it/s] 39%|███▉      | 186/471 [00:40<01:02,  4.56it/s] 40%|███▉      | 187/471 [00:40<01:04,  4.44it/s] 40%|███▉      | 188/471 [00:40<01:01,  4.64it/s] 40%|████      | 189/471 [00:41<01:03,  4.45it/s] 40%|████      | 190/471 [00:41<01:00,  4.65it/s] 41%|████      | 191/471 [00:41<01:03,  4.43it/s] 41%|████      | 192/471 [00:41<01:00,  4.61it/s] 41%|████      | 193/471 [00:41<01:02,  4.43it/s] 41%|████      | 194/471 [00:42<01:01,  4.53it/s] 41%|████▏     | 195/471 [00:42<01:01,  4.45it/s] 42%|████▏     | 196/471 [00:42<01:00,  4.53it/s] 42%|████▏     | 197/471 [00:42<01:01,  4.46it/s] 42%|████▏     | 198/471 [00:43<01:00,  4.54it/s] 42%|████▏     | 199/471 [00:43<01:01,  4.42it/s] 42%|████▏     | 200/471 [00:43<00:59,  4.52it/s] 43%|████▎     | 201/471 [00:43<01:00,  4.45it/s] 43%|████▎     | 202/471 [00:43<01:00,  4.48it/s] 43%|████▎     | 203/471 [00:44<00:59,  4.47it/s] 43%|████▎     | 204/471 [00:44<01:00,  4.41it/s] 44%|████▎     | 205/471 [00:44<00:57,  4.65it/s] 44%|████▎     | 206/471 [00:44<00:57,  4.59it/s] 44%|████▍     | 207/471 [00:45<00:56,  4.67it/s] 44%|████▍     | 208/471 [00:45<00:58,  4.53it/s] 44%|████▍     | 209/471 [00:45<00:56,  4.60it/s] 45%|████▍     | 210/471 [00:45<00:58,  4.49it/s] 45%|████▍     | 211/471 [00:45<00:55,  4.67it/s] 45%|████▌     | 212/471 [00:46<00:57,  4.49it/s] 45%|████▌     | 213/471 [00:46<00:54,  4.71it/s] 45%|████▌     | 214/471 [00:46<00:58,  4.40it/s] 46%|████▌     | 215/471 [00:46<00:53,  4.76it/s] 46%|████▌     | 216/471 [00:47<00:57,  4.45it/s] 46%|████▌     | 217/471 [00:47<00:54,  4.65it/s] 46%|████▋     | 218/471 [00:47<00:56,  4.48it/s] 46%|████▋     | 219/471 [00:47<00:55,  4.51it/s] 47%|████▋     | 220/471 [00:47<00:55,  4.55it/s] 47%|████▋     | 221/471 [00:48<00:55,  4.54it/s] 47%|████▋     | 222/471 [00:48<00:54,  4.54it/s] 47%|████▋     | 223/471 [00:48<00:55,  4.49it/s] 48%|████▊     | 224/471 [00:48<00:53,  4.58it/s] 48%|████▊     | 225/471 [00:49<00:54,  4.51it/s] 48%|████▊     | 226/471 [00:49<00:52,  4.65it/s] 48%|████▊     | 227/471 [00:49<00:54,  4.46it/s] 48%|████▊     | 228/471 [00:49<00:51,  4.70it/s] 49%|████▊     | 229/471 [00:49<00:54,  4.46it/s] 49%|████▉     | 230/471 [00:50<00:49,  4.85it/s] 49%|████▉     | 231/471 [00:50<00:53,  4.49it/s] 49%|████▉     | 232/471 [00:50<00:50,  4.73it/s] 49%|████▉     | 233/471 [00:50<00:52,  4.55it/s] 50%|████▉     | 234/471 [00:50<00:51,  4.60it/s] 50%|████▉     | 235/471 [00:51<00:51,  4.56it/s] 50%|█████     | 236/471 [00:51<00:51,  4.53it/s] 50%|█████     | 237/471 [00:51<00:51,  4.53it/s] 51%|█████     | 238/471 [00:51<00:51,  4.53it/s] 51%|█████     | 239/471 [00:52<00:50,  4.62it/s] 51%|█████     | 240/471 [00:52<00:50,  4.55it/s] 51%|█████     | 241/471 [00:52<00:49,  4.65it/s] 51%|█████▏    | 242/471 [00:52<00:51,  4.44it/s] 52%|█████▏    | 243/471 [00:52<00:47,  4.75it/s] 52%|█████▏    | 244/471 [00:53<00:51,  4.43it/s] 52%|█████▏    | 245/471 [00:53<00:47,  4.78it/s] 52%|█████▏    | 246/471 [00:53<00:50,  4.44it/s] 52%|█████▏    | 247/471 [00:53<00:47,  4.70it/s] 53%|█████▎    | 248/471 [00:54<00:49,  4.52it/s] 53%|█████▎    | 249/471 [00:54<00:48,  4.61it/s] 53%|█████▎    | 250/471 [00:54<00:47,  4.63it/s] 53%|█████▎    | 251/471 [00:54<00:47,  4.65it/s] 54%|█████▎    | 252/471 [00:54<00:47,  4.60it/s] 54%|█████▎    | 253/471 [00:55<00:47,  4.63it/s] 54%|█████▍    | 254/471 [00:55<00:47,  4.61it/s] 54%|█████▍    | 255/471 [00:55<00:47,  4.56it/s] 54%|█████▍    | 256/471 [00:55<00:46,  4.64it/s] 55%|█████▍    | 257/471 [00:55<00:47,  4.50it/s] 55%|█████▍    | 258/471 [00:56<00:46,  4.59it/s] 55%|█████▍    | 259/471 [00:56<00:47,  4.46it/s] 55%|█████▌    | 260/471 [00:56<00:46,  4.56it/s] 55%|█████▌    | 261/471 [00:56<00:47,  4.45it/s] 56%|█████▌    | 262/471 [00:57<00:44,  4.65it/s] 56%|█████▌    | 263/471 [00:57<00:46,  4.49it/s] 56%|█████▌    | 264/471 [00:57<00:44,  4.67it/s] 56%|█████▋    | 265/471 [00:57<00:46,  4.42it/s] 56%|█████▋    | 266/471 [00:57<00:44,  4.65it/s] 57%|█████▋    | 267/471 [00:58<00:46,  4.43it/s] 57%|█████▋    | 268/471 [00:58<00:42,  4.77it/s] 57%|█████▋    | 269/471 [00:58<00:40,  5.02it/s] 57%|█████▋    | 270/471 [00:58<00:38,  5.23it/s] 58%|█████▊    | 271/471 [00:58<00:36,  5.45it/s] 58%|█████▊    | 272/471 [00:59<00:36,  5.44it/s] 58%|█████▊    | 273/471 [00:59<00:33,  5.85it/s] 58%|█████▊    | 274/471 [00:59<00:35,  5.61it/s] 59%|█████▊    | 276/471 [00:59<00:32,  6.05it/s] 59%|█████▉    | 277/471 [00:59<00:31,  6.12it/s] 59%|█████▉    | 278/471 [01:00<00:31,  6.16it/s] 59%|█████▉    | 279/471 [01:00<00:32,  5.93it/s] 59%|█████▉    | 280/471 [01:00<00:29,  6.53it/s] 60%|█████▉    | 281/471 [01:00<00:32,  5.93it/s] 60%|█████▉    | 282/471 [01:00<00:29,  6.50it/s] 60%|██████    | 283/471 [01:00<00:32,  5.79it/s] 60%|██████    | 284/471 [01:00<00:30,  6.21it/s] 61%|██████    | 285/471 [01:01<00:31,  5.85it/s] 61%|██████    | 286/471 [01:01<00:31,  5.84it/s] 61%|██████    | 287/471 [01:01<00:29,  6.22it/s] 61%|██████    | 288/471 [01:01<00:31,  5.84it/s] 61%|██████▏   | 289/471 [01:01<00:28,  6.42it/s] 62%|██████▏   | 290/471 [01:02<00:30,  5.86it/s] 62%|██████▏   | 291/471 [01:02<00:27,  6.53it/s] 62%|██████▏   | 292/471 [01:02<00:30,  5.78it/s] 62%|██████▏   | 293/471 [01:02<00:31,  5.61it/s] 62%|██████▏   | 294/471 [01:02<00:34,  5.17it/s] 63%|██████▎   | 295/471 [01:02<00:35,  4.91it/s] 63%|██████▎   | 296/471 [01:03<00:34,  5.03it/s] 63%|██████▎   | 297/471 [01:03<00:36,  4.81it/s] 63%|██████▎   | 298/471 [01:03<00:35,  4.92it/s] 63%|██████▎   | 299/471 [01:03<00:37,  4.61it/s] 64%|██████▎   | 300/471 [01:04<00:35,  4.87it/s] 64%|██████▍   | 301/471 [01:04<00:37,  4.58it/s] 64%|██████▍   | 302/471 [01:04<00:34,  4.95it/s] 64%|██████▍   | 303/471 [01:04<00:36,  4.62it/s] 65%|██████▍   | 304/471 [01:04<00:34,  4.88it/s] 65%|██████▍   | 305/471 [01:05<00:36,  4.55it/s] 65%|██████▍   | 306/471 [01:05<00:35,  4.64it/s] 65%|██████▌   | 307/471 [01:05<00:35,  4.65it/s] 65%|██████▌   | 308/471 [01:05<00:34,  4.69it/s] 66%|██████▌   | 309/471 [01:05<00:34,  4.64it/s] 66%|██████▌   | 310/471 [01:06<00:35,  4.51it/s] 66%|██████▌   | 311/471 [01:06<00:33,  4.78it/s] 66%|██████▌   | 312/471 [01:06<00:34,  4.61it/s] 66%|██████▋   | 313/471 [01:06<00:30,  5.13it/s] 67%|██████▋   | 314/471 [01:07<00:33,  4.73it/s] 67%|██████▋   | 315/471 [01:07<00:32,  4.80it/s] 67%|██████▋   | 316/471 [01:07<00:33,  4.57it/s] 67%|██████▋   | 317/471 [01:07<00:32,  4.79it/s] 68%|██████▊   | 318/471 [01:07<00:33,  4.62it/s] 68%|██████▊   | 319/471 [01:08<00:31,  4.88it/s] 68%|██████▊   | 320/471 [01:08<00:32,  4.63it/s] 68%|██████▊   | 321/471 [01:08<00:31,  4.71it/s] 68%|██████▊   | 322/471 [01:08<00:32,  4.59it/s] 69%|██████▊   | 323/471 [01:08<00:31,  4.73it/s] 69%|██████▉   | 324/471 [01:09<00:31,  4.68it/s] 69%|██████▉   | 325/471 [01:09<00:30,  4.72it/s] 69%|██████▉   | 326/471 [01:09<00:31,  4.54it/s] 69%|██████▉   | 327/471 [01:09<00:31,  4.63it/s] 70%|██████▉   | 328/471 [01:10<00:30,  4.64it/s] 70%|██████▉   | 329/471 [01:10<00:30,  4.67it/s] 70%|███████   | 330/471 [01:10<00:28,  5.01it/s] 70%|███████   | 331/471 [01:10<00:27,  5.06it/s] 70%|███████   | 332/471 [01:10<00:24,  5.71it/s] 71%|███████   | 333/471 [01:10<00:25,  5.43it/s] 71%|███████   | 334/471 [01:11<00:22,  6.01it/s] 71%|███████   | 335/471 [01:11<00:25,  5.33it/s] 71%|███████▏  | 336/471 [01:11<00:24,  5.46it/s] 72%|███████▏  | 337/471 [01:11<00:27,  4.88it/s] 72%|███████▏  | 338/471 [01:11<00:26,  4.93it/s] 72%|███████▏  | 339/471 [01:12<00:27,  4.79it/s] 72%|███████▏  | 340/471 [01:12<00:27,  4.80it/s] 72%|███████▏  | 341/471 [01:12<00:27,  4.72it/s] 73%|███████▎  | 342/471 [01:12<00:28,  4.57it/s] 73%|███████▎  | 343/471 [01:12<00:27,  4.73it/s] 73%|███████▎  | 344/471 [01:13<00:27,  4.59it/s] 73%|███████▎  | 345/471 [01:13<00:25,  4.91it/s] 73%|███████▎  | 346/471 [01:13<00:27,  4.55it/s] 74%|███████▎  | 347/471 [01:13<00:25,  4.86it/s] 74%|███████▍  | 348/471 [01:14<00:26,  4.62it/s] 74%|███████▍  | 349/471 [01:14<00:25,  4.75it/s] 74%|███████▍  | 350/471 [01:14<00:26,  4.55it/s] 75%|███████▍  | 351/471 [01:14<00:24,  4.90it/s] 75%|███████▍  | 352/471 [01:14<00:26,  4.53it/s] 75%|███████▍  | 353/471 [01:15<00:25,  4.65it/s] 75%|███████▌  | 354/471 [01:15<00:25,  4.57it/s] 75%|███████▌  | 355/471 [01:15<00:24,  4.66it/s] 76%|███████▌  | 356/471 [01:15<00:23,  4.84it/s] 76%|███████▌  | 357/471 [01:15<00:24,  4.73it/s] 76%|███████▌  | 358/471 [01:16<00:23,  4.74it/s] 76%|███████▌  | 359/471 [01:16<00:24,  4.67it/s] 76%|███████▋  | 360/471 [01:16<00:23,  4.78it/s] 77%|███████▋  | 361/471 [01:16<00:23,  4.72it/s] 77%|███████▋  | 362/471 [01:17<00:22,  4.81it/s] 77%|███████▋  | 363/471 [01:17<00:23,  4.55it/s] 77%|███████▋  | 364/471 [01:17<00:22,  4.81it/s] 77%|███████▋  | 365/471 [01:17<00:23,  4.56it/s] 78%|███████▊  | 366/471 [01:17<00:21,  4.79it/s] 78%|███████▊  | 367/471 [01:18<00:22,  4.63it/s] 78%|███████▊  | 368/471 [01:18<00:21,  4.69it/s] 78%|███████▊  | 369/471 [01:18<00:22,  4.52it/s] 79%|███████▊  | 370/471 [01:18<00:21,  4.64it/s] 79%|███████▉  | 371/471 [01:18<00:21,  4.61it/s] 79%|███████▉  | 372/471 [01:19<00:20,  4.78it/s] 79%|███████▉  | 373/471 [01:19<00:20,  4.84it/s] 79%|███████▉  | 374/471 [01:19<00:20,  4.70it/s] 80%|███████▉  | 375/471 [01:19<00:20,  4.72it/s] 80%|███████▉  | 376/471 [01:20<00:20,  4.58it/s] 80%|████████  | 377/471 [01:20<00:19,  4.78it/s] 80%|████████  | 378/471 [01:20<00:19,  4.65it/s] 80%|████████  | 379/471 [01:20<00:18,  4.86it/s] 81%|████████  | 380/471 [01:20<00:20,  4.49it/s] 81%|████████  | 381/471 [01:21<00:18,  4.81it/s] 81%|████████  | 382/471 [01:21<00:19,  4.54it/s] 81%|████████▏ | 383/471 [01:21<00:18,  4.80it/s] 82%|████████▏ | 384/471 [01:21<00:19,  4.56it/s] 82%|████████▏ | 385/471 [01:21<00:18,  4.73it/s] 82%|████████▏ | 386/471 [01:22<00:19,  4.44it/s] 82%|████████▏ | 387/471 [01:22<00:18,  4.61it/s] 82%|████████▏ | 388/471 [01:22<00:18,  4.60it/s] 83%|████████▎ | 389/471 [01:22<00:17,  4.68it/s] 83%|████████▎ | 390/471 [01:23<00:17,  4.71it/s] 83%|████████▎ | 391/471 [01:23<00:17,  4.56it/s] 83%|████████▎ | 392/471 [01:23<00:16,  4.86it/s] 83%|████████▎ | 393/471 [01:23<00:16,  4.73it/s] 84%|████████▎ | 394/471 [01:23<00:15,  4.97it/s] 84%|████████▍ | 395/471 [01:24<00:16,  4.71it/s] 84%|████████▍ | 396/471 [01:24<00:15,  4.72it/s] 84%|████████▍ | 397/471 [01:24<00:16,  4.51it/s] 85%|████████▍ | 398/471 [01:24<00:15,  4.79it/s] 85%|████████▍ | 399/471 [01:24<00:15,  4.58it/s] 85%|████████▍ | 400/471 [01:25<00:14,  4.84it/s] 85%|████████▌ | 401/471 [01:25<00:15,  4.47it/s] 85%|████████▌ | 402/471 [01:25<00:14,  4.63it/s] 86%|████████▌ | 403/471 [01:25<00:15,  4.48it/s] 86%|████████▌ | 404/471 [01:26<00:14,  4.67it/s] 86%|████████▌ | 405/471 [01:26<00:14,  4.63it/s] 86%|████████▌ | 406/471 [01:26<00:14,  4.61it/s] 86%|████████▋ | 407/471 [01:26<00:14,  4.57it/s] 87%|████████▋ | 408/471 [01:26<00:13,  4.63it/s] 87%|████████▋ | 409/471 [01:27<00:13,  4.65it/s] 87%|████████▋ | 410/471 [01:27<00:12,  4.77it/s] 87%|████████▋ | 411/471 [01:27<00:11,  5.02it/s] 87%|████████▋ | 412/471 [01:27<00:12,  4.69it/s] 88%|████████▊ | 413/471 [01:27<00:12,  4.75it/s] 88%|████████▊ | 414/471 [01:28<00:12,  4.52it/s] 88%|████████▊ | 415/471 [01:28<00:11,  4.82it/s] 88%|████████▊ | 416/471 [01:28<00:11,  4.62it/s] 89%|████████▊ | 417/471 [01:28<00:11,  4.81it/s] 89%|████████▊ | 418/471 [01:29<00:11,  4.46it/s] 89%|████████▉ | 419/471 [01:29<00:10,  4.81it/s] 89%|████████▉ | 420/471 [01:29<00:11,  4.50it/s] 89%|████████▉ | 421/471 [01:29<00:10,  4.77it/s] 90%|████████▉ | 422/471 [01:29<00:10,  4.67it/s] 90%|████████▉ | 423/471 [01:30<00:10,  4.61it/s] 90%|█████████ | 424/471 [01:30<00:10,  4.62it/s] 90%|█████████ | 425/471 [01:30<00:09,  4.60it/s] 90%|█████████ | 426/471 [01:30<00:09,  4.86it/s] 91%|█████████ | 427/471 [01:30<00:09,  4.74it/s] 91%|█████████ | 428/471 [01:31<00:08,  4.97it/s] 91%|█████████ | 429/471 [01:31<00:09,  4.55it/s] 91%|█████████▏| 430/471 [01:31<00:08,  4.92it/s] 92%|█████████▏| 431/471 [01:31<00:08,  4.63it/s] 92%|█████████▏| 432/471 [01:31<00:07,  4.92it/s] 92%|█████████▏| 433/471 [01:32<00:07,  4.76it/s] 92%|█████████▏| 434/471 [01:32<00:07,  4.65it/s] 92%|█████████▏| 435/471 [01:32<00:07,  4.60it/s] 93%|█████████▎| 436/471 [01:32<00:07,  4.60it/s] 93%|█████████▎| 437/471 [01:33<00:07,  4.81it/s] 93%|█████████▎| 438/471 [01:33<00:07,  4.70it/s] 93%|█████████▎| 439/471 [01:33<00:06,  4.77it/s] 93%|█████████▎| 440/471 [01:33<00:06,  4.52it/s] 94%|█████████▎| 441/471 [01:33<00:06,  4.88it/s] 94%|█████████▍| 442/471 [01:34<00:06,  4.59it/s] 94%|█████████▍| 443/471 [01:34<00:05,  5.07it/s] 94%|█████████▍| 444/471 [01:34<00:05,  4.63it/s] 94%|█████████▍| 445/471 [01:34<00:05,  4.77it/s] 95%|█████████▍| 446/471 [01:34<00:05,  4.65it/s] 95%|█████████▍| 447/471 [01:35<00:05,  4.64it/s] 95%|█████████▌| 448/471 [01:35<00:04,  4.92it/s] 95%|█████████▌| 449/471 [01:35<00:04,  4.81it/s] 96%|█████████▌| 450/471 [01:35<00:04,  4.93it/s] 96%|█████████▌| 451/471 [01:36<00:04,  4.62it/s] 96%|█████████▌| 452/471 [01:36<00:03,  4.86it/s] 96%|█████████▌| 453/471 [01:36<00:03,  4.58it/s] 96%|█████████▋| 454/471 [01:36<00:03,  4.96it/s] 97%|█████████▋| 455/471 [01:36<00:03,  4.73it/s] 97%|█████████▋| 456/471 [01:36<00:02,  5.13it/s] 97%|█████████▋| 457/471 [01:37<00:02,  5.00it/s] 97%|█████████▋| 458/471 [01:37<00:02,  5.20it/s] 97%|█████████▋| 459/471 [01:37<00:02,  5.53it/s] 98%|█████████▊| 460/471 [01:37<00:01,  5.85it/s] 98%|█████████▊| 461/471 [01:37<00:01,  6.27it/s] 98%|█████████▊| 462/471 [01:37<00:01,  6.10it/s] 98%|█████████▊| 463/471 [01:38<00:01,  6.69it/s] 99%|█████████▊| 464/471 [01:38<00:01,  6.48it/s] 99%|█████████▊| 465/471 [01:38<00:00,  7.04it/s] 99%|█████████▉| 466/471 [01:38<00:00,  6.86it/s] 99%|█████████▉| 467/471 [01:38<00:00,  6.59it/s] 99%|█████████▉| 468/471 [01:38<00:00,  6.77it/s]100%|█████████▉| 469/471 [01:38<00:00,  6.66it/s]100%|█████████▉| 470/471 [01:39<00:00,  6.51it/s]100%|██████████| 471/471 [01:39<00:00,  6.39it/s]100%|██████████| 471/471 [01:39<00:00,  4.74it/s]
{'eval_loss': 2.4888973236083984, 'eval_model_preparation_time': 0.0048, 'eval_acc': 0.3993627190653213, 'eval_runtime': 99.5833, 'eval_samples_per_second': 75.635, 'eval_steps_per_second': 4.73}
ROUND:5
CLIENT:79
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:30,  1.28it/s]                                              {'loss': 2.5424, 'grad_norm': 3.6011998653411865, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:30,  1.28it/s]  5%|▌         | 2/40 [00:01<00:21,  1.78it/s]                                              {'loss': 2.6389, 'grad_norm': 3.3108649253845215, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:21,  1.78it/s]  8%|▊         | 3/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.6168, 'grad_norm': 3.758230686187744, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.12it/s] 10%|█         | 4/40 [00:01<00:15,  2.33it/s]                                              {'loss': 2.4098, 'grad_norm': 3.3490076065063477, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.33it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.47it/s]                                              {'loss': 2.4324, 'grad_norm': 2.527892827987671, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.47it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.55it/s]                                              {'loss': 2.4252, 'grad_norm': 3.6042118072509766, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.55it/s] 18%|█▊        | 7/40 [00:03<00:12,  2.59it/s]                                              {'loss': 2.4184, 'grad_norm': 3.23372220993042, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:12,  2.59it/s] 20%|██        | 8/40 [00:04<00:18,  1.73it/s]                                              {'loss': 1.9663, 'grad_norm': 8.252434730529785, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:18,  1.73it/s] 22%|██▎       | 9/40 [00:04<00:16,  1.88it/s]                                              {'loss': 2.551, 'grad_norm': 3.5718741416931152, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:16,  1.88it/s] 25%|██▌       | 10/40 [00:04<00:15,  1.96it/s]                                               {'loss': 2.5238, 'grad_norm': 3.357429027557373, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:15,  1.96it/s] 28%|██▊       | 11/40 [00:05<00:14,  2.04it/s]                                               {'loss': 2.1656, 'grad_norm': 3.7412023544311523, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:14,  2.04it/s] 30%|███       | 12/40 [00:05<00:13,  2.08it/s]                                               {'loss': 2.4255, 'grad_norm': 3.2841989994049072, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:13,  2.08it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.13it/s]                                               {'loss': 2.5078, 'grad_norm': 3.903545379638672, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.13it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.3097, 'grad_norm': 2.7205278873443604, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.17it/s]                                               {'loss': 2.2838, 'grad_norm': 2.776323080062866, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.17it/s] 40%|████      | 16/40 [00:07<00:08,  2.73it/s]                                               {'loss': 2.0169, 'grad_norm': 9.270681381225586, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.73it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.1612, 'grad_norm': 2.9192323684692383, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.57it/s]                                               {'loss': 2.395, 'grad_norm': 3.6104931831359863, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.57it/s] 48%|████▊     | 19/40 [00:08<00:07,  2.64it/s]                                               {'loss': 2.3497, 'grad_norm': 3.1743011474609375, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:07,  2.64it/s] 50%|█████     | 20/40 [00:08<00:07,  2.68it/s]                                               {'loss': 2.3265, 'grad_norm': 3.1863794326782227, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.68it/s] 52%|█████▎    | 21/40 [00:09<00:07,  2.70it/s]                                               {'loss': 2.2869, 'grad_norm': 4.535163879394531, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:07,  2.70it/s] 55%|█████▌    | 22/40 [00:09<00:06,  2.75it/s]                                               {'loss': 2.278, 'grad_norm': 3.0507450103759766, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:06,  2.75it/s] 57%|█████▊    | 23/40 [00:09<00:06,  2.68it/s]                                               {'loss': 2.3598, 'grad_norm': 2.9875669479370117, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:06,  2.68it/s] 60%|██████    | 24/40 [00:10<00:04,  3.38it/s]                                               {'loss': 2.8382, 'grad_norm': 16.71747589111328, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:04,  3.38it/s] 62%|██████▎   | 25/40 [00:10<00:04,  3.21it/s]                                               {'loss': 2.2379, 'grad_norm': 3.194150447845459, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:04,  3.21it/s] 65%|██████▌   | 26/40 [00:10<00:04,  2.99it/s]                                               {'loss': 2.274, 'grad_norm': 3.0502030849456787, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  2.99it/s] 68%|██████▊   | 27/40 [00:11<00:04,  2.90it/s]                                               {'loss': 2.2829, 'grad_norm': 2.8927009105682373, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:04,  2.90it/s] 70%|███████   | 28/40 [00:11<00:04,  2.91it/s]                                               {'loss': 2.2782, 'grad_norm': 2.8533408641815186, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.91it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.62it/s]                                               {'loss': 2.2636, 'grad_norm': 3.052147388458252, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.62it/s] 75%|███████▌  | 30/40 [00:12<00:03,  2.58it/s]                                               {'loss': 2.3573, 'grad_norm': 3.124882698059082, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:03,  2.58it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.59it/s]                                               {'loss': 2.3789, 'grad_norm': 3.7162117958068848, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.59it/s] 80%|████████  | 32/40 [00:12<00:02,  3.23it/s]                                               {'loss': 2.4851, 'grad_norm': 13.543052673339844, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.23it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.83it/s]                                               {'loss': 2.3086, 'grad_norm': 3.7065160274505615, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.83it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.66it/s]                                               {'loss': 2.1539, 'grad_norm': 3.0349483489990234, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.66it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.49it/s]                                               {'loss': 2.1925, 'grad_norm': 3.1414313316345215, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.49it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.45it/s]                                               {'loss': 2.3868, 'grad_norm': 3.3909542560577393, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.45it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.40it/s]                                               {'loss': 2.2126, 'grad_norm': 3.926438093185425, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.40it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.38it/s]                                               {'loss': 2.1767, 'grad_norm': 3.456012487411499, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.38it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.43it/s]                                               {'loss': 2.1566, 'grad_norm': 2.6643519401550293, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.43it/s]100%|██████████| 40/40 [00:16<00:00,  2.99it/s]                                               {'loss': 2.8012, 'grad_norm': 10.445237159729004, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.99it/s]                                               {'train_runtime': 16.1938, 'train_samples_per_second': 34.89, 'train_steps_per_second': 2.47, 'train_loss': 2.3544054359197615, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.99it/s]100%|██████████| 40/40 [00:16<00:00,  2.47it/s]
CLIENT:75
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.25it/s]                                              {'loss': 2.7091, 'grad_norm': 4.486807346343994, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.25it/s]  5%|▌         | 2/40 [00:00<00:16,  2.30it/s]                                              {'loss': 2.6087, 'grad_norm': 3.1207053661346436, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.30it/s]  8%|▊         | 3/40 [00:01<00:15,  2.35it/s]                                              {'loss': 2.4291, 'grad_norm': 2.7937822341918945, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.35it/s] 10%|█         | 4/40 [00:01<00:15,  2.31it/s]                                              {'loss': 2.5918, 'grad_norm': 2.7161083221435547, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.31it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.31it/s]                                              {'loss': 2.4686, 'grad_norm': 3.200425863265991, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.31it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.28it/s]                                              {'loss': 2.5178, 'grad_norm': 3.2322752475738525, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.28it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s]                                              {'loss': 2.5969, 'grad_norm': 3.336912155151367, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s] 20%|██        | 8/40 [00:03<00:11,  2.90it/s]                                              {'loss': 2.4674, 'grad_norm': 19.912525177001953, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.90it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.68it/s]                                              {'loss': 2.4705, 'grad_norm': 2.5091099739074707, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.68it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.51it/s]                                               {'loss': 2.3786, 'grad_norm': 2.894951343536377, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.51it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s]                                               {'loss': 2.3772, 'grad_norm': 2.829099416732788, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s] 30%|███       | 12/40 [00:04<00:11,  2.36it/s]                                               {'loss': 2.5394, 'grad_norm': 4.349145889282227, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s]                                               {'loss': 2.6328, 'grad_norm': 4.773643493652344, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.32it/s]                                               {'loss': 2.4492, 'grad_norm': 3.151679754257202, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.32it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.5373, 'grad_norm': 3.031860828399658, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 2.4123, 'grad_norm': 9.1323823928833, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.63it/s]                                               {'loss': 2.3146, 'grad_norm': 2.234365224838257, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.63it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.3886, 'grad_norm': 3.0235531330108643, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.37it/s]                                               {'loss': 2.587, 'grad_norm': 3.075253486633301, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.37it/s] 50%|█████     | 20/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.4422, 'grad_norm': 2.625318765640259, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.41it/s]                                               {'loss': 2.5311, 'grad_norm': 3.4673943519592285, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.41it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.49it/s]                                               {'loss': 2.3992, 'grad_norm': 2.5952346324920654, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.49it/s] 57%|█████▊    | 23/40 [00:09<00:06,  2.48it/s]                                               {'loss': 2.2213, 'grad_norm': 3.027146816253662, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:06,  2.48it/s] 60%|██████    | 24/40 [00:09<00:05,  3.20it/s]                                               {'loss': 2.4015, 'grad_norm': 11.178180694580078, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  3.20it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.03it/s]                                               {'loss': 2.4318, 'grad_norm': 2.980093002319336, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.03it/s] 65%|██████▌   | 26/40 [00:10<00:04,  2.90it/s]                                               {'loss': 2.2662, 'grad_norm': 2.6485366821289062, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  2.90it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.71it/s]                                               {'loss': 2.575, 'grad_norm': 3.2639453411102295, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.71it/s] 70%|███████   | 28/40 [00:11<00:04,  2.66it/s]                                               {'loss': 2.4723, 'grad_norm': 2.596966028213501, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.66it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.55it/s]                                               {'loss': 2.417, 'grad_norm': 3.492540121078491, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.55it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.52it/s]                                               {'loss': 2.261, 'grad_norm': 3.9575347900390625, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.52it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.42it/s]                                               {'loss': 2.2989, 'grad_norm': 2.9613611698150635, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.42it/s] 80%|████████  | 32/40 [00:12<00:02,  3.01it/s]                                               {'loss': 2.2582, 'grad_norm': 9.644963264465332, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.01it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.72it/s]                                               {'loss': 2.3374, 'grad_norm': 2.79555344581604, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.72it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.56it/s]                                               {'loss': 2.3944, 'grad_norm': 2.6059513092041016, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.56it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.45it/s]                                               {'loss': 2.1802, 'grad_norm': 2.583402395248413, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.45it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s]                                               {'loss': 2.3508, 'grad_norm': 3.126277446746826, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s]                                               {'loss': 2.2626, 'grad_norm': 3.348125696182251, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s]                                               {'loss': 2.4156, 'grad_norm': 2.7114453315734863, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.35it/s]                                               {'loss': 2.3467, 'grad_norm': 2.5641679763793945, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.35it/s]100%|██████████| 40/40 [00:15<00:00,  2.93it/s]                                               {'loss': 2.306, 'grad_norm': 9.57879638671875, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.93it/s]                                               {'train_runtime': 15.8885, 'train_samples_per_second': 35.56, 'train_steps_per_second': 2.518, 'train_loss': 2.4261497616767884, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.93it/s]100%|██████████| 40/40 [00:15<00:00,  2.52it/s]
CLIENT:63
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.26it/s]                                              {'loss': 2.4633, 'grad_norm': 4.586824893951416, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.26it/s]  5%|▌         | 2/40 [00:00<00:16,  2.29it/s]                                              {'loss': 2.4792, 'grad_norm': 4.262936592102051, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.29it/s]  8%|▊         | 3/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.4378, 'grad_norm': 3.1649558544158936, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.21it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.709, 'grad_norm': 3.243861675262451, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s]                                              {'loss': 2.4672, 'grad_norm': 3.833249092102051, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.6049, 'grad_norm': 3.137984275817871, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.19it/s]                                              {'loss': 2.5358, 'grad_norm': 2.75901460647583, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.19it/s] 20%|██        | 8/40 [00:03<00:11,  2.90it/s]                                              {'loss': 2.536, 'grad_norm': 9.219365119934082, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.90it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s]                                              {'loss': 2.3371, 'grad_norm': 2.771357774734497, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.50it/s]                                               {'loss': 2.4871, 'grad_norm': 2.605769634246826, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.50it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.4703, 'grad_norm': 4.162045001983643, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s] 30%|███       | 12/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.6084, 'grad_norm': 3.137528896331787, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.43it/s]                                               {'loss': 2.4104, 'grad_norm': 3.50297474861145, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.43it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.52it/s]                                               {'loss': 2.4649, 'grad_norm': 3.365561008453369, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.52it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.57it/s]                                               {'loss': 2.4175, 'grad_norm': 5.4425225257873535, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.57it/s] 40%|████      | 16/40 [00:06<00:07,  3.24it/s]                                               {'loss': 2.8472, 'grad_norm': 9.215106964111328, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.24it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.12it/s]                                               {'loss': 2.3033, 'grad_norm': 2.9431750774383545, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.12it/s] 45%|████▌     | 18/40 [00:06<00:07,  3.06it/s]                                               {'loss': 2.5059, 'grad_norm': 3.3551578521728516, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  3.06it/s] 48%|████▊     | 19/40 [00:07<00:06,  3.03it/s]                                               {'loss': 2.45, 'grad_norm': 3.506065845489502, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:06,  3.03it/s] 50%|█████     | 20/40 [00:07<00:06,  2.97it/s]                                               {'loss': 2.34, 'grad_norm': 3.922663927078247, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  2.97it/s] 52%|█████▎    | 21/40 [00:08<00:06,  2.91it/s]                                               {'loss': 2.5661, 'grad_norm': 2.9283618927001953, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:06,  2.91it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.84it/s]                                               {'loss': 2.2498, 'grad_norm': 3.602191686630249, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.84it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.80it/s]                                               {'loss': 2.4045, 'grad_norm': 2.7795631885528564, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.80it/s] 60%|██████    | 24/40 [00:08<00:04,  3.56it/s]                                               {'loss': 2.7556, 'grad_norm': 10.170193672180176, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:04,  3.56it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.30it/s]                                               {'loss': 2.2574, 'grad_norm': 3.3971993923187256, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.30it/s] 65%|██████▌   | 26/40 [00:09<00:04,  3.18it/s]                                               {'loss': 2.4154, 'grad_norm': 4.16431188583374, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  3.18it/s] 68%|██████▊   | 27/40 [00:09<00:04,  3.09it/s]                                               {'loss': 2.4668, 'grad_norm': 3.4355244636535645, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  3.09it/s] 70%|███████   | 28/40 [00:10<00:03,  3.01it/s]                                               {'loss': 2.3504, 'grad_norm': 3.6243109703063965, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:03,  3.01it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.71it/s]                                               {'loss': 2.5012, 'grad_norm': 3.1737546920776367, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.71it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.54it/s]                                               {'loss': 2.4122, 'grad_norm': 2.8696510791778564, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.54it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.54it/s]                                               {'loss': 2.3746, 'grad_norm': 2.6468780040740967, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.54it/s] 80%|████████  | 32/40 [00:11<00:02,  3.15it/s]                                               {'loss': 2.3392, 'grad_norm': 7.882171154022217, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  3.15it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.75it/s]                                               {'loss': 2.4083, 'grad_norm': 2.979064464569092, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.75it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.59it/s]                                               {'loss': 2.3695, 'grad_norm': 3.2344930171966553, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.59it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.46it/s]                                               {'loss': 2.1475, 'grad_norm': 3.128032922744751, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s]                                               {'loss': 2.3592, 'grad_norm': 2.704185962677002, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.36it/s]                                               {'loss': 2.3804, 'grad_norm': 3.063051223754883, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.36it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.29it/s]                                               {'loss': 2.4476, 'grad_norm': 3.236908197402954, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.29it/s]                                               {'loss': 2.166, 'grad_norm': 3.1192197799682617, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.29it/s]100%|██████████| 40/40 [00:15<00:00,  2.90it/s]                                               {'loss': 2.6288, 'grad_norm': 16.15091323852539, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.90it/s]                                               {'train_runtime': 15.1087, 'train_samples_per_second': 37.396, 'train_steps_per_second': 2.647, 'train_loss': 2.446898180246353, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.90it/s]100%|██████████| 40/40 [00:15<00:00,  2.65it/s]
CLIENT:15
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.41it/s]                                              {'loss': 2.5621, 'grad_norm': 3.0347063541412354, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.41it/s]  5%|▌         | 2/40 [00:00<00:16,  2.28it/s]                                              {'loss': 2.5869, 'grad_norm': 3.0272469520568848, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.28it/s]  8%|▊         | 3/40 [00:01<00:16,  2.25it/s]                                              {'loss': 2.3342, 'grad_norm': 2.87276291847229, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.25it/s] 10%|█         | 4/40 [00:01<00:15,  2.26it/s]                                              {'loss': 2.4437, 'grad_norm': 3.897780418395996, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.26it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.5357, 'grad_norm': 2.4910049438476562, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s]                                              {'loss': 2.6733, 'grad_norm': 3.473890781402588, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.4634, 'grad_norm': 3.29935884475708, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s] 20%|██        | 8/40 [00:03<00:11,  2.89it/s]                                              {'loss': 2.5324, 'grad_norm': 11.144596099853516, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.89it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.64it/s]                                              {'loss': 2.3669, 'grad_norm': 3.5179061889648438, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.64it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.4962, 'grad_norm': 3.050626277923584, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s]                                               {'loss': 2.3321, 'grad_norm': 3.6647281646728516, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s] 30%|███       | 12/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.5739, 'grad_norm': 3.5276927947998047, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.4374, 'grad_norm': 4.098662376403809, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.25it/s]                                               {'loss': 2.4336, 'grad_norm': 3.4490818977355957, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.25it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.4051, 'grad_norm': 3.598695993423462, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 2.6943, 'grad_norm': 11.731367111206055, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.65it/s]                                               {'loss': 2.4189, 'grad_norm': 3.1749427318573, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.65it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.3536, 'grad_norm': 3.1503992080688477, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.40it/s]                                               {'loss': 2.3811, 'grad_norm': 2.595695734024048, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.40it/s] 50%|█████     | 20/40 [00:08<00:08,  2.38it/s]                                               {'loss': 2.48, 'grad_norm': 3.181443929672241, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.38it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.438, 'grad_norm': 2.875422477722168, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.37it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.2173, 'grad_norm': 2.2911946773529053, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.31it/s]                                               {'loss': 2.3528, 'grad_norm': 3.7513561248779297, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.31it/s] 60%|██████    | 24/40 [00:09<00:05,  2.91it/s]                                               {'loss': 2.4997, 'grad_norm': 11.886699676513672, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.91it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s]                                               {'loss': 2.3129, 'grad_norm': 4.314952850341797, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.3984, 'grad_norm': 2.9328317642211914, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.46it/s]                                               {'loss': 2.2731, 'grad_norm': 2.655405282974243, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.46it/s] 70%|███████   | 28/40 [00:11<00:04,  2.42it/s]                                               {'loss': 2.2164, 'grad_norm': 2.75858736038208, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.42it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.46it/s]                                               {'loss': 2.5085, 'grad_norm': 3.224796772003174, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.46it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.39it/s]                                               {'loss': 2.163, 'grad_norm': 3.489894390106201, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.39it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.34it/s]                                               {'loss': 2.3918, 'grad_norm': 2.7759242057800293, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.34it/s] 80%|████████  | 32/40 [00:12<00:02,  2.94it/s]                                               {'loss': 1.5834, 'grad_norm': 8.359195709228516, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.94it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.71it/s]                                               {'loss': 2.3125, 'grad_norm': 3.4082226753234863, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.71it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.59it/s]                                               {'loss': 2.0731, 'grad_norm': 3.729919672012329, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.59it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.52it/s]                                               {'loss': 2.2636, 'grad_norm': 3.557325839996338, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.52it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s]                                               {'loss': 2.2245, 'grad_norm': 2.555845260620117, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s]                                               {'loss': 2.3137, 'grad_norm': 3.031697988510132, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.33it/s]                                               {'loss': 2.3463, 'grad_norm': 3.2362303733825684, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.33it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]                                               {'loss': 2.2398, 'grad_norm': 2.7076001167297363, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]100%|██████████| 40/40 [00:16<00:00,  2.87it/s]                                               {'loss': 2.5774, 'grad_norm': 9.039510726928711, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.87it/s]                                               {'train_runtime': 16.2984, 'train_samples_per_second': 34.666, 'train_steps_per_second': 2.454, 'train_loss': 2.380283299088478, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.87it/s]100%|██████████| 40/40 [00:16<00:00,  2.46it/s]
CLIENT:38
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]                                              {'loss': 2.611, 'grad_norm': 3.310412645339966, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]  5%|▌         | 2/40 [00:00<00:16,  2.26it/s]                                              {'loss': 2.7511, 'grad_norm': 2.9877071380615234, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.26it/s]  8%|▊         | 3/40 [00:01<00:15,  2.34it/s]                                              {'loss': 2.6269, 'grad_norm': 2.920832395553589, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.34it/s] 10%|█         | 4/40 [00:01<00:15,  2.28it/s]                                              {'loss': 2.5333, 'grad_norm': 3.4654805660247803, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.28it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.6643, 'grad_norm': 3.236509323120117, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.4227, 'grad_norm': 2.962041139602661, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.25it/s]                                              {'loss': 2.5633, 'grad_norm': 4.107785701751709, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.25it/s] 20%|██        | 8/40 [00:03<00:11,  2.88it/s]                                              {'loss': 2.4206, 'grad_norm': 9.256589889526367, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.88it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.74it/s]                                              {'loss': 2.5179, 'grad_norm': 3.262922525405884, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.74it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s]                                               {'loss': 2.4797, 'grad_norm': 2.793954610824585, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.50it/s]                                               {'loss': 2.4879, 'grad_norm': 2.529204845428467, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.50it/s] 30%|███       | 12/40 [00:04<00:11,  2.51it/s]                                               {'loss': 2.6679, 'grad_norm': 3.331814765930176, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.51it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.43it/s]                                               {'loss': 2.5551, 'grad_norm': 2.7719500064849854, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.43it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.315, 'grad_norm': 2.802513360977173, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.34it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.30it/s]                                               {'loss': 2.3133, 'grad_norm': 2.8063039779663086, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.30it/s] 40%|████      | 16/40 [00:06<00:08,  2.88it/s]                                               {'loss': 2.0078, 'grad_norm': 8.347670555114746, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.88it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s]                                               {'loss': 2.5616, 'grad_norm': 3.5195207595825195, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.54it/s]                                               {'loss': 2.469, 'grad_norm': 3.3434035778045654, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.54it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s]                                               {'loss': 2.4017, 'grad_norm': 2.8589019775390625, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s] 50%|█████     | 20/40 [00:08<00:08,  2.40it/s]                                               {'loss': 2.3766, 'grad_norm': 2.9140961170196533, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.40it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.3921, 'grad_norm': 2.610386371612549, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s]                                               {'loss': 2.4115, 'grad_norm': 2.9138972759246826, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.29it/s]                                               {'loss': 2.4948, 'grad_norm': 3.203857660293579, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.29it/s] 60%|██████    | 24/40 [00:09<00:05,  2.87it/s]                                               {'loss': 2.1463, 'grad_norm': 7.237164497375488, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s]                                               {'loss': 2.444, 'grad_norm': 2.687671661376953, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.51it/s]                                               {'loss': 2.216, 'grad_norm': 2.418177366256714, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s]                                               {'loss': 2.4007, 'grad_norm': 2.8257601261138916, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s] 70%|███████   | 28/40 [00:11<00:05,  2.33it/s]                                               {'loss': 2.3899, 'grad_norm': 3.2029223442077637, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.29it/s]                                               {'loss': 2.588, 'grad_norm': 3.303407907485962, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.29it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.3823, 'grad_norm': 2.89481258392334, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.28it/s]                                               {'loss': 2.3191, 'grad_norm': 2.4422078132629395, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.28it/s]                                               {'loss': 2.6183, 'grad_norm': 10.317790031433105, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:03,  2.28it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.97it/s]                                               {'loss': 2.4518, 'grad_norm': 3.0196332931518555, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.97it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.91it/s]                                               {'loss': 2.4448, 'grad_norm': 3.0977959632873535, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.91it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.87it/s]                                               {'loss': 2.3335, 'grad_norm': 2.7516283988952637, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.87it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.84it/s]                                               {'loss': 2.3092, 'grad_norm': 2.75394868850708, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.84it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.82it/s]                                               {'loss': 2.3446, 'grad_norm': 3.7614400386810303, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.82it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.80it/s]                                               {'loss': 2.2586, 'grad_norm': 2.9072906970977783, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.80it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.78it/s]                                               {'loss': 2.4417, 'grad_norm': 3.0203025341033936, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.78it/s]                                               {'loss': 2.395, 'grad_norm': 19.257177352905273, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.78it/s]                                               {'train_runtime': 15.6117, 'train_samples_per_second': 36.191, 'train_steps_per_second': 2.562, 'train_loss': 2.43822004199028, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.78it/s]100%|██████████| 40/40 [00:15<00:00,  2.56it/s]
CLIENT:11
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.25it/s]                                              {'loss': 2.4369, 'grad_norm': 2.9233908653259277, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.25it/s]  5%|▌         | 2/40 [00:00<00:16,  2.27it/s]                                              {'loss': 2.4404, 'grad_norm': 3.052208662033081, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.27it/s]  8%|▊         | 3/40 [00:01<00:16,  2.22it/s]                                              {'loss': 2.7474, 'grad_norm': 3.2376396656036377, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.22it/s] 10%|█         | 4/40 [00:01<00:14,  2.44it/s]                                              {'loss': 2.6841, 'grad_norm': 4.202122211456299, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.44it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.39it/s]                                              {'loss': 2.4911, 'grad_norm': 2.7882890701293945, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.39it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.35it/s]                                              {'loss': 2.5356, 'grad_norm': 2.6320431232452393, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.35it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.31it/s]                                              {'loss': 2.6277, 'grad_norm': 3.583043336868286, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.31it/s] 20%|██        | 8/40 [00:03<00:10,  2.92it/s]                                              {'loss': 2.5323, 'grad_norm': 9.463788032531738, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.92it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s]                                              {'loss': 2.3347, 'grad_norm': 2.50577974319458, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.47it/s]                                               {'loss': 2.3056, 'grad_norm': 2.2198548316955566, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.47it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.43it/s]                                               {'loss': 2.4742, 'grad_norm': 2.735856533050537, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.43it/s] 30%|███       | 12/40 [00:04<00:12,  2.33it/s]                                               {'loss': 2.4257, 'grad_norm': 2.7470476627349854, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.33it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.5745, 'grad_norm': 4.152946472167969, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s]                                               {'loss': 2.3383, 'grad_norm': 2.5053725242614746, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.4119, 'grad_norm': 2.7698252201080322, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s] 40%|████      | 16/40 [00:06<00:08,  2.87it/s]                                               {'loss': 2.3982, 'grad_norm': 8.378196716308594, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.87it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s]                                               {'loss': 2.4325, 'grad_norm': 3.049010753631592, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.2959, 'grad_norm': 2.3555305004119873, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s]                                               {'loss': 2.289, 'grad_norm': 2.784179925918579, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s] 50%|█████     | 20/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.4449, 'grad_norm': 3.0178637504577637, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.31it/s]                                               {'loss': 2.2587, 'grad_norm': 3.784132242202759, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.31it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.4352, 'grad_norm': 2.5104246139526367, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.4174, 'grad_norm': 3.0641515254974365, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s] 60%|██████    | 24/40 [00:09<00:05,  2.88it/s]                                               {'loss': 2.3584, 'grad_norm': 9.503351211547852, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.67it/s]                                               {'loss': 2.2886, 'grad_norm': 3.1387722492218018, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.67it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.5052, 'grad_norm': 3.1677393913269043, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.42it/s]                                               {'loss': 2.4102, 'grad_norm': 2.7348291873931885, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.42it/s] 70%|███████   | 28/40 [00:11<00:04,  2.46it/s]                                               {'loss': 2.3185, 'grad_norm': 3.075298547744751, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.46it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.36it/s]                                               {'loss': 2.3703, 'grad_norm': 2.3109467029571533, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.36it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s]                                               {'loss': 2.2912, 'grad_norm': 2.5903148651123047, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.32it/s]                                               {'loss': 2.2337, 'grad_norm': 2.2875468730926514, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.32it/s] 80%|████████  | 32/40 [00:12<00:02,  2.90it/s]                                               {'loss': 1.6984, 'grad_norm': 7.980700492858887, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s]                                               {'loss': 2.2936, 'grad_norm': 2.4223711490631104, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s]                                               {'loss': 2.1899, 'grad_norm': 3.399428606033325, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s]                                               {'loss': 2.288, 'grad_norm': 2.626727342605591, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.38it/s]                                               {'loss': 2.2037, 'grad_norm': 2.6483194828033447, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.38it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s]                                               {'loss': 2.285, 'grad_norm': 3.179267644882202, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s]                                               {'loss': 2.5284, 'grad_norm': 3.3189849853515625, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.34it/s]                                               {'loss': 2.3168, 'grad_norm': 2.4924161434173584, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.34it/s]100%|██████████| 40/40 [00:16<00:00,  2.97it/s]                                               {'loss': 2.1131, 'grad_norm': 9.294702529907227, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.97it/s]                                               {'train_runtime': 16.2657, 'train_samples_per_second': 34.736, 'train_steps_per_second': 2.459, 'train_loss': 2.3756308406591415, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.97it/s]100%|██████████| 40/40 [00:16<00:00,  2.46it/s]
CLIENT:40
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:31,  1.25it/s]                                              {'loss': 2.7335, 'grad_norm': 2.972100019454956, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:31,  1.25it/s]  5%|▌         | 2/40 [00:01<00:23,  1.63it/s]                                              {'loss': 2.4414, 'grad_norm': 2.6513140201568604, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:23,  1.63it/s]  8%|▊         | 3/40 [00:01<00:20,  1.81it/s]                                              {'loss': 2.4867, 'grad_norm': 3.09416127204895, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:20,  1.81it/s] 10%|█         | 4/40 [00:02<00:18,  1.96it/s]                                              {'loss': 2.3653, 'grad_norm': 2.566033124923706, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:18,  1.96it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.01it/s]                                              {'loss': 2.4854, 'grad_norm': 3.466536521911621, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.01it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.07it/s]                                              {'loss': 2.6943, 'grad_norm': 3.7039220333099365, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.07it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s]                                              {'loss': 2.59, 'grad_norm': 3.08611798286438, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.11it/s] 20%|██        | 8/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.9621, 'grad_norm': 18.172697067260742, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.22it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.23it/s]                                              {'loss': 2.3816, 'grad_norm': 2.9416587352752686, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.23it/s] 25%|██▌       | 10/40 [00:04<00:13,  2.21it/s]                                               {'loss': 2.5283, 'grad_norm': 2.7523701190948486, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:13,  2.21it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s]                                               {'loss': 2.5633, 'grad_norm': 3.5339016914367676, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s] 30%|███       | 12/40 [00:05<00:12,  2.26it/s]                                               {'loss': 2.6536, 'grad_norm': 2.99446177482605, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.21it/s]                                               {'loss': 2.4183, 'grad_norm': 3.962829113006592, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.21it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.3274, 'grad_norm': 3.8113415241241455, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.21it/s]                                               {'loss': 2.3407, 'grad_norm': 2.8647897243499756, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.21it/s] 40%|████      | 16/40 [00:07<00:08,  2.86it/s]                                               {'loss': 2.2033, 'grad_norm': 9.076123237609863, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.86it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s]                                               {'loss': 2.5424, 'grad_norm': 4.5713701248168945, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.53it/s]                                               {'loss': 2.1838, 'grad_norm': 3.3054115772247314, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.53it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.42it/s]                                               {'loss': 2.2401, 'grad_norm': 2.825385570526123, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.42it/s] 50%|█████     | 20/40 [00:09<00:08,  2.40it/s]                                               {'loss': 2.4693, 'grad_norm': 4.566320896148682, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.40it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.35it/s]                                               {'loss': 2.5382, 'grad_norm': 2.5672848224639893, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.35it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s]                                               {'loss': 2.3818, 'grad_norm': 3.1214401721954346, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.30it/s]                                               {'loss': 2.4658, 'grad_norm': 2.9361469745635986, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.30it/s] 60%|██████    | 24/40 [00:10<00:05,  2.85it/s]                                               {'loss': 2.4941, 'grad_norm': 14.81806755065918, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s]                                               {'loss': 2.3599, 'grad_norm': 3.4412598609924316, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.49it/s]                                               {'loss': 2.4138, 'grad_norm': 2.8706510066986084, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.49it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s]                                               {'loss': 2.4441, 'grad_norm': 2.8420491218566895, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s] 70%|███████   | 28/40 [00:12<00:05,  2.33it/s]                                               {'loss': 2.2903, 'grad_norm': 3.68479061126709, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.5256, 'grad_norm': 3.9190895557403564, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s]                                               {'loss': 2.3632, 'grad_norm': 2.615372657775879, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.32it/s]                                               {'loss': 2.283, 'grad_norm': 3.824939012527466, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.32it/s] 80%|████████  | 32/40 [00:13<00:02,  2.91it/s]                                               {'loss': 1.8742, 'grad_norm': 12.05764389038086, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.91it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.59it/s]                                               {'loss': 2.2342, 'grad_norm': 3.3623292446136475, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.5367, 'grad_norm': 3.012590169906616, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.43it/s]                                               {'loss': 2.3038, 'grad_norm': 2.983179807662964, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s]                                               {'loss': 2.348, 'grad_norm': 2.9150609970092773, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.28it/s]                                               {'loss': 2.2608, 'grad_norm': 2.7139389514923096, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.22it/s]                                               {'loss': 2.4739, 'grad_norm': 3.9375782012939453, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.22it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]                                               {'loss': 2.3468, 'grad_norm': 3.4154319763183594, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]100%|██████████| 40/40 [00:17<00:00,  2.89it/s]                                               {'loss': 1.6854, 'grad_norm': 15.086963653564453, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.89it/s]                                               {'train_runtime': 17.2084, 'train_samples_per_second': 32.833, 'train_steps_per_second': 2.324, 'train_loss': 2.4058538764715194, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.89it/s]100%|██████████| 40/40 [00:17<00:00,  2.32it/s]
CLIENT:45
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]                                              {'loss': 2.5091, 'grad_norm': 3.2614245414733887, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.6195, 'grad_norm': 3.129995346069336, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]  8%|▊         | 3/40 [00:01<00:17,  2.14it/s]                                              {'loss': 2.5389, 'grad_norm': 3.02555513381958, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.14it/s] 10%|█         | 4/40 [00:01<00:16,  2.14it/s]                                              {'loss': 2.6986, 'grad_norm': 3.0702552795410156, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.14it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s]                                              {'loss': 2.6253, 'grad_norm': 3.490553379058838, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.22it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.37it/s]                                              {'loss': 2.6829, 'grad_norm': 3.5721194744110107, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.37it/s] 18%|█▊        | 7/40 [00:03<00:13,  2.49it/s]                                              {'loss': 2.6875, 'grad_norm': 3.2530112266540527, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:13,  2.49it/s]                                              {'loss': 2.929, 'grad_norm': 9.498078346252441, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:12,  2.49it/s] 22%|██▎       | 9/40 [00:03<00:09,  3.22it/s]                                              {'loss': 2.4662, 'grad_norm': 3.678483247756958, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:09,  3.22it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.09it/s]                                               {'loss': 2.5431, 'grad_norm': 2.5471184253692627, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.09it/s] 28%|██▊       | 11/40 [00:04<00:09,  2.98it/s]                                               {'loss': 2.3697, 'grad_norm': 3.4473724365234375, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:09,  2.98it/s] 30%|███       | 12/40 [00:04<00:09,  2.89it/s]                                               {'loss': 2.5297, 'grad_norm': 2.5183050632476807, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.89it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.83it/s]                                               {'loss': 2.5593, 'grad_norm': 2.8240902423858643, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.83it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.79it/s]                                               {'loss': 2.5725, 'grad_norm': 3.137526750564575, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.79it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.77it/s]                                               {'loss': 2.5345, 'grad_norm': 3.1990602016448975, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.77it/s] 40%|████      | 16/40 [00:05<00:06,  3.51it/s]                                               {'loss': 2.9502, 'grad_norm': 11.383512496948242, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:06,  3.51it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.47it/s]                                               {'loss': 2.4151, 'grad_norm': 2.5009450912475586, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.47it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.51it/s]                                               {'loss': 2.6092, 'grad_norm': 2.95481014251709, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.51it/s] 48%|████▊     | 19/40 [00:06<00:05,  3.53it/s]                                               {'loss': 2.586, 'grad_norm': 2.8606529235839844, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:05,  3.53it/s] 50%|█████     | 20/40 [00:06<00:05,  3.49it/s]                                               {'loss': 2.3718, 'grad_norm': 3.4453933238983154, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:05,  3.49it/s] 52%|█████▎    | 21/40 [00:07<00:05,  3.45it/s]                                               {'loss': 2.4024, 'grad_norm': 3.619832992553711, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:05,  3.45it/s] 55%|█████▌    | 22/40 [00:07<00:05,  3.41it/s]                                               {'loss': 2.4384, 'grad_norm': 3.171628952026367, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:05,  3.41it/s] 57%|█████▊    | 23/40 [00:07<00:04,  3.52it/s]                                               {'loss': 2.5308, 'grad_norm': 3.05322003364563, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:04,  3.52it/s]                                               {'loss': 2.4563, 'grad_norm': 7.305394649505615, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:04,  3.52it/s] 62%|██████▎   | 25/40 [00:08<00:03,  4.68it/s]                                               {'loss': 2.4824, 'grad_norm': 3.558030605316162, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:03,  4.68it/s] 65%|██████▌   | 26/40 [00:08<00:03,  4.64it/s]                                               {'loss': 2.3293, 'grad_norm': 3.126389265060425, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:03,  4.64it/s] 68%|██████▊   | 27/40 [00:08<00:03,  4.20it/s]                                               {'loss': 2.3229, 'grad_norm': 2.989182472229004, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:03,  4.20it/s] 70%|███████   | 28/40 [00:08<00:03,  3.53it/s]                                               {'loss': 2.5397, 'grad_norm': 3.3396315574645996, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:08<00:03,  3.53it/s] 72%|███████▎  | 29/40 [00:09<00:03,  3.22it/s]                                               {'loss': 2.4486, 'grad_norm': 3.1521472930908203, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:09<00:03,  3.22it/s] 75%|███████▌  | 30/40 [00:09<00:03,  3.03it/s]                                               {'loss': 2.4234, 'grad_norm': 2.7119975090026855, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:09<00:03,  3.03it/s] 78%|███████▊  | 31/40 [00:10<00:03,  2.84it/s]                                               {'loss': 2.3156, 'grad_norm': 2.9011335372924805, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:10<00:03,  2.84it/s] 80%|████████  | 32/40 [00:10<00:02,  3.44it/s]                                               {'loss': 2.4483, 'grad_norm': 11.430888175964355, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:10<00:02,  3.44it/s] 82%|████████▎ | 33/40 [00:10<00:02,  3.07it/s]                                               {'loss': 2.38, 'grad_norm': 2.436749219894409, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:10<00:02,  3.07it/s] 85%|████████▌ | 34/40 [00:11<00:02,  2.81it/s]                                               {'loss': 2.4251, 'grad_norm': 2.8157732486724854, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:11<00:02,  2.81it/s] 88%|████████▊ | 35/40 [00:11<00:01,  2.67it/s]                                               {'loss': 2.3522, 'grad_norm': 2.4980404376983643, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:11<00:01,  2.67it/s] 90%|█████████ | 36/40 [00:11<00:01,  2.50it/s]                                               {'loss': 2.3449, 'grad_norm': 2.8263862133026123, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:11<00:01,  2.50it/s] 92%|█████████▎| 37/40 [00:12<00:01,  2.41it/s]                                               {'loss': 2.4259, 'grad_norm': 3.2536630630493164, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:12<00:01,  2.41it/s] 95%|█████████▌| 38/40 [00:12<00:00,  2.34it/s]                                               {'loss': 2.3121, 'grad_norm': 3.8142566680908203, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:12<00:00,  2.34it/s] 98%|█████████▊| 39/40 [00:13<00:00,  2.28it/s]                                               {'loss': 2.3944, 'grad_norm': 3.189203977584839, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:13<00:00,  2.28it/s]100%|██████████| 40/40 [00:13<00:00,  2.90it/s]                                               {'loss': 2.8184, 'grad_norm': 9.889678001403809, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:13<00:00,  2.90it/s]                                               {'train_runtime': 13.5892, 'train_samples_per_second': 41.577, 'train_steps_per_second': 2.944, 'train_loss': 2.509732609987259, 'epoch': 5.0}
100%|██████████| 40/40 [00:13<00:00,  2.90it/s]100%|██████████| 40/40 [00:13<00:00,  2.95it/s]
CLIENT:39
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.39it/s]                                              {'loss': 2.4914, 'grad_norm': 3.054971933364868, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.39it/s]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 2.3528, 'grad_norm': 2.7290101051330566, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:01<00:22,  1.63it/s]                                              {'loss': 2.5637, 'grad_norm': 3.002722978591919, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.63it/s] 10%|█         | 4/40 [00:02<00:19,  1.81it/s]                                              {'loss': 2.6559, 'grad_norm': 3.302856206893921, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.81it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.93it/s]                                              {'loss': 2.4742, 'grad_norm': 2.9840023517608643, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.93it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.03it/s]                                              {'loss': 2.6546, 'grad_norm': 3.015702486038208, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.03it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s]                                              {'loss': 2.5945, 'grad_norm': 3.6321282386779785, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s] 20%|██        | 8/40 [00:04<00:15,  2.03it/s]                                              {'loss': 2.3899, 'grad_norm': 9.255447387695312, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.03it/s] 22%|██▎       | 9/40 [00:04<00:15,  2.04it/s]                                              {'loss': 2.3906, 'grad_norm': 3.0247559547424316, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:15,  2.04it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s]                                               {'loss': 2.4298, 'grad_norm': 2.693521738052368, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.14it/s]                                               {'loss': 2.4994, 'grad_norm': 3.680636167526245, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.14it/s] 30%|███       | 12/40 [00:06<00:12,  2.29it/s]                                               {'loss': 2.5218, 'grad_norm': 3.0683512687683105, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:12,  2.29it/s] 32%|███▎      | 13/40 [00:06<00:10,  2.49it/s]                                               {'loss': 2.4004, 'grad_norm': 3.2365293502807617, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:10,  2.49it/s] 35%|███▌      | 14/40 [00:06<00:10,  2.53it/s]                                               {'loss': 2.4115, 'grad_norm': 2.8477110862731934, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:10,  2.53it/s] 38%|███▊      | 15/40 [00:07<00:09,  2.55it/s]                                               {'loss': 2.5294, 'grad_norm': 3.5642645359039307, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:09,  2.55it/s] 40%|████      | 16/40 [00:07<00:07,  3.26it/s]                                               {'loss': 3.0503, 'grad_norm': 15.512012481689453, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:07,  3.26it/s] 42%|████▎     | 17/40 [00:07<00:07,  3.28it/s]                                               {'loss': 2.3984, 'grad_norm': 3.6745493412017822, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:07,  3.28it/s] 45%|████▌     | 18/40 [00:07<00:07,  3.05it/s]                                               {'loss': 2.4792, 'grad_norm': 3.204611301422119, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  3.05it/s] 48%|████▊     | 19/40 [00:08<00:07,  2.93it/s]                                               {'loss': 2.379, 'grad_norm': 2.976660966873169, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:07,  2.93it/s] 50%|█████     | 20/40 [00:08<00:07,  2.83it/s]                                               {'loss': 2.2949, 'grad_norm': 3.6881752014160156, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.83it/s] 52%|█████▎    | 21/40 [00:09<00:07,  2.57it/s]                                               {'loss': 2.2786, 'grad_norm': 2.753781795501709, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:07,  2.57it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.47it/s]                                               {'loss': 2.3972, 'grad_norm': 3.0779573917388916, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.47it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.34it/s]                                               {'loss': 2.295, 'grad_norm': 3.260754346847534, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.34it/s] 60%|██████    | 24/40 [00:10<00:05,  2.93it/s]                                               {'loss': 1.9649, 'grad_norm': 8.31326961517334, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.93it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.75it/s]                                               {'loss': 2.2847, 'grad_norm': 2.8218672275543213, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.75it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.55it/s]                                               {'loss': 2.4422, 'grad_norm': 2.8123579025268555, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.49it/s]                                               {'loss': 2.186, 'grad_norm': 3.1131558418273926, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.49it/s] 70%|███████   | 28/40 [00:11<00:04,  2.44it/s]                                               {'loss': 2.2876, 'grad_norm': 3.527747631072998, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.44it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s]                                               {'loss': 2.4482, 'grad_norm': 3.8864338397979736, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.32it/s]                                               {'loss': 2.2727, 'grad_norm': 3.5158231258392334, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.32it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.24it/s]                                               {'loss': 2.3225, 'grad_norm': 3.5123093128204346, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.24it/s] 80%|████████  | 32/40 [00:13<00:02,  2.90it/s]                                               {'loss': 2.9949, 'grad_norm': 15.446043968200684, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.73it/s]                                               {'loss': 2.3901, 'grad_norm': 3.1939949989318848, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.73it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s]                                               {'loss': 2.3036, 'grad_norm': 3.196983814239502, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.3449, 'grad_norm': 4.091671943664551, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.44it/s]                                               {'loss': 2.3174, 'grad_norm': 2.7839818000793457, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.44it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.35it/s]                                               {'loss': 2.3668, 'grad_norm': 3.272840738296509, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.35it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.31it/s]                                               {'loss': 2.2096, 'grad_norm': 3.3953020572662354, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.29it/s]                                               {'loss': 2.2489, 'grad_norm': 3.45989990234375, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.29it/s]100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'loss': 2.328, 'grad_norm': 9.794316291809082, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'train_runtime': 16.7521, 'train_samples_per_second': 33.727, 'train_steps_per_second': 2.388, 'train_loss': 2.4161398470401765, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.88it/s]100%|██████████| 40/40 [00:16<00:00,  2.39it/s]
CLIENT:62
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.42it/s]                                              {'loss': 2.4347, 'grad_norm': 2.9727609157562256, 'learning_rate': 0.00017573593128807148, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.42it/s]  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]                                              {'loss': 2.5934, 'grad_norm': 3.6504063606262207, 'learning_rate': 0.0001713425330058697, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]  8%|▊         | 3/40 [00:01<00:15,  2.42it/s]                                              {'loss': 2.443, 'grad_norm': 3.2206690311431885, 'learning_rate': 0.0001669491347236679, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.42it/s] 10%|█         | 4/40 [00:01<00:15,  2.28it/s]                                              {'loss': 2.4919, 'grad_norm': 3.28308367729187, 'learning_rate': 0.00016255573644146612, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.28it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.6524, 'grad_norm': 4.130692005157471, 'learning_rate': 0.00015816233815926434, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.4805, 'grad_norm': 2.627577066421509, 'learning_rate': 0.00015376893987706255, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.4335, 'grad_norm': 3.3307080268859863, 'learning_rate': 0.00014937554159486074, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s] 20%|██        | 8/40 [00:03<00:11,  2.83it/s]                                              {'loss': 2.5475, 'grad_norm': 10.394028663635254, 'learning_rate': 0.00014498214331265896, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s]                                              {'loss': 2.4523, 'grad_norm': 3.1220877170562744, 'learning_rate': 0.0001405887450304572, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s]                                               {'loss': 2.5331, 'grad_norm': 2.7970197200775146, 'learning_rate': 0.00013619534674825539, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s]                                               {'loss': 2.4643, 'grad_norm': 3.1776516437530518, 'learning_rate': 0.0001318019484660536, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s] 30%|███       | 12/40 [00:05<00:12,  2.32it/s]                                               {'loss': 2.2602, 'grad_norm': 2.9469144344329834, 'learning_rate': 0.00012740855018385182, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.32it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.3113, 'grad_norm': 2.517495632171631, 'learning_rate': 0.00012301515190165003, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s]                                               {'loss': 2.4459, 'grad_norm': 2.765015125274658, 'learning_rate': 0.00011862175361944826, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.38it/s]                                               {'loss': 2.3653, 'grad_norm': 3.470651388168335, 'learning_rate': 0.00011422835533724646, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.38it/s]                                               {'loss': 2.8161, 'grad_norm': 15.483489990234375, 'learning_rate': 0.00010983495705504468, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:10,  2.38it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.02it/s]                                               {'loss': 2.203, 'grad_norm': 2.692283868789673, 'learning_rate': 0.00010544155877284288, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.02it/s] 45%|████▌     | 18/40 [00:07<00:07,  2.90it/s]                                               {'loss': 2.4642, 'grad_norm': 3.7089462280273438, 'learning_rate': 0.0001010481604906411, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  2.90it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.80it/s]                                               {'loss': 2.4671, 'grad_norm': 2.818251848220825, 'learning_rate': 9.665476220843932e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.80it/s] 50%|█████     | 20/40 [00:07<00:07,  2.69it/s]                                               {'loss': 2.4109, 'grad_norm': 3.176609754562378, 'learning_rate': 9.226136392623752e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.69it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.56it/s]                                               {'loss': 2.4506, 'grad_norm': 3.566695213317871, 'learning_rate': 8.786796564403574e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.56it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.46it/s]                                               {'loss': 2.1772, 'grad_norm': 2.914210557937622, 'learning_rate': 8.347456736183395e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.46it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.37it/s]                                               {'loss': 2.2129, 'grad_norm': 3.322148561477661, 'learning_rate': 7.908116907963217e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.37it/s] 60%|██████    | 24/40 [00:09<00:05,  2.97it/s]                                               {'loss': 2.2879, 'grad_norm': 13.580822944641113, 'learning_rate': 7.468777079743037e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.97it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.73it/s]                                               {'loss': 2.2511, 'grad_norm': 3.694410562515259, 'learning_rate': 7.02943725152286e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.73it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s]                                               {'loss': 2.3261, 'grad_norm': 2.7377965450286865, 'learning_rate': 6.59009742330268e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.44it/s]                                               {'loss': 2.2338, 'grad_norm': 3.134368419647217, 'learning_rate': 6.150757595082502e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.44it/s] 70%|███████   | 28/40 [00:11<00:04,  2.44it/s]                                               {'loss': 2.3513, 'grad_norm': 2.5501575469970703, 'learning_rate': 5.711417766862323e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.44it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.52it/s]                                               {'loss': 2.3998, 'grad_norm': 3.641040086746216, 'learning_rate': 5.272077938642144e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.52it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.58it/s]                                               {'loss': 2.2992, 'grad_norm': 3.535942316055298, 'learning_rate': 4.832738110421966e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.58it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.61it/s]                                               {'loss': 2.213, 'grad_norm': 2.8514862060546875, 'learning_rate': 4.393398282201787e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.61it/s] 80%|████████  | 32/40 [00:12<00:02,  3.29it/s]                                               {'loss': 2.1961, 'grad_norm': 11.558974266052246, 'learning_rate': 3.9540584539816085e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.29it/s] 82%|████████▎ | 33/40 [00:12<00:02,  3.24it/s]                                               {'loss': 2.277, 'grad_norm': 2.5858192443847656, 'learning_rate': 3.51471862576143e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  3.24it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.19it/s]                                               {'loss': 2.2753, 'grad_norm': 3.2328500747680664, 'learning_rate': 3.075378797541251e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.19it/s] 88%|████████▊ | 35/40 [00:13<00:01,  3.06it/s]                                               {'loss': 2.2676, 'grad_norm': 2.6554293632507324, 'learning_rate': 2.636038969321072e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  3.06it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.95it/s]                                               {'loss': 2.382, 'grad_norm': 2.641435146331787, 'learning_rate': 2.1966991411008935e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.95it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.87it/s]                                               {'loss': 2.2523, 'grad_norm': 3.4413809776306152, 'learning_rate': 1.757359312880715e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.87it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.82it/s]                                               {'loss': 2.334, 'grad_norm': 3.0790505409240723, 'learning_rate': 1.318019484660536e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.82it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.78it/s]                                               {'loss': 2.18, 'grad_norm': 2.9609365463256836, 'learning_rate': 8.786796564403575e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.78it/s]100%|██████████| 40/40 [00:14<00:00,  3.49it/s]                                               {'loss': 1.9482, 'grad_norm': 9.620185852050781, 'learning_rate': 4.3933982822017874e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.49it/s]                                               {'train_runtime': 15.1135, 'train_samples_per_second': 37.384, 'train_steps_per_second': 2.647, 'train_loss': 2.3646450102329255, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.49it/s]100%|██████████| 40/40 [00:15<00:00,  2.65it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:49,  9.45it/s]  1%|          | 3/471 [00:00<01:07,  6.91it/s]  1%|          | 4/471 [00:00<01:19,  5.86it/s]  1%|          | 5/471 [00:00<01:25,  5.48it/s]  1%|▏         | 6/471 [00:01<01:34,  4.94it/s]  1%|▏         | 7/471 [00:01<01:32,  5.00it/s]  2%|▏         | 8/471 [00:01<01:37,  4.73it/s]  2%|▏         | 9/471 [00:01<01:33,  4.96it/s]  2%|▏         | 10/471 [00:01<01:37,  4.74it/s]  2%|▏         | 11/471 [00:02<01:35,  4.81it/s]  3%|▎         | 12/471 [00:02<01:40,  4.55it/s]  3%|▎         | 13/471 [00:02<01:37,  4.69it/s]  3%|▎         | 14/471 [00:02<01:37,  4.67it/s]  3%|▎         | 15/471 [00:02<01:35,  4.78it/s]  3%|▎         | 16/471 [00:03<01:37,  4.65it/s]  4%|▎         | 17/471 [00:03<01:39,  4.57it/s]  4%|▍         | 18/471 [00:03<01:37,  4.64it/s]  4%|▍         | 19/471 [00:03<01:39,  4.54it/s]  4%|▍         | 20/471 [00:04<01:33,  4.81it/s]  4%|▍         | 21/471 [00:04<01:38,  4.55it/s]  5%|▍         | 22/471 [00:04<01:36,  4.67it/s]  5%|▍         | 23/471 [00:04<01:40,  4.45it/s]  5%|▌         | 24/471 [00:04<01:33,  4.78it/s]  5%|▌         | 25/471 [00:05<01:38,  4.53it/s]  6%|▌         | 26/471 [00:05<01:24,  5.24it/s]  6%|▌         | 27/471 [00:05<01:27,  5.10it/s]  6%|▌         | 28/471 [00:05<01:20,  5.48it/s]  6%|▌         | 29/471 [00:05<01:21,  5.40it/s]  6%|▋         | 30/471 [00:06<01:24,  5.24it/s]  7%|▋         | 31/471 [00:06<01:27,  5.00it/s]  7%|▋         | 32/471 [00:06<01:32,  4.75it/s]  7%|▋         | 33/471 [00:06<01:27,  4.98it/s]  7%|▋         | 34/471 [00:06<01:32,  4.74it/s]  7%|▋         | 35/471 [00:07<01:21,  5.36it/s]  8%|▊         | 36/471 [00:07<01:31,  4.77it/s]  8%|▊         | 37/471 [00:07<01:27,  4.98it/s]  8%|▊         | 38/471 [00:07<01:32,  4.69it/s]  8%|▊         | 39/471 [00:07<01:31,  4.72it/s]  8%|▊         | 40/471 [00:08<01:29,  4.82it/s]  9%|▊         | 41/471 [00:08<01:31,  4.70it/s]  9%|▉         | 42/471 [00:08<01:27,  4.88it/s]  9%|▉         | 43/471 [00:08<01:33,  4.59it/s]  9%|▉         | 44/471 [00:08<01:25,  4.97it/s] 10%|▉         | 45/471 [00:09<01:31,  4.64it/s] 10%|▉         | 46/471 [00:09<01:23,  5.09it/s] 10%|▉         | 47/471 [00:09<01:32,  4.58it/s] 10%|█         | 48/471 [00:09<01:29,  4.70it/s] 10%|█         | 49/471 [00:10<01:30,  4.67it/s] 11%|█         | 50/471 [00:10<01:30,  4.63it/s] 11%|█         | 51/471 [00:10<01:24,  4.97it/s] 11%|█         | 52/471 [00:10<01:30,  4.65it/s] 11%|█▏        | 53/471 [00:10<01:26,  4.82it/s] 11%|█▏        | 54/471 [00:11<01:31,  4.55it/s] 12%|█▏        | 55/471 [00:11<01:24,  4.92it/s] 12%|█▏        | 56/471 [00:11<01:28,  4.67it/s] 12%|█▏        | 57/471 [00:11<01:22,  5.00it/s] 12%|█▏        | 58/471 [00:11<01:29,  4.60it/s] 13%|█▎        | 59/471 [00:12<01:27,  4.73it/s] 13%|█▎        | 60/471 [00:12<01:27,  4.72it/s] 13%|█▎        | 61/471 [00:12<01:27,  4.68it/s] 13%|█▎        | 62/471 [00:12<01:25,  4.77it/s] 13%|█▎        | 63/471 [00:12<01:27,  4.67it/s] 14%|█▎        | 64/471 [00:13<01:26,  4.69it/s] 14%|█▍        | 65/471 [00:13<01:27,  4.62it/s] 14%|█▍        | 66/471 [00:13<01:25,  4.75it/s] 14%|█▍        | 67/471 [00:13<01:24,  4.76it/s] 14%|█▍        | 68/471 [00:14<01:18,  5.12it/s] 15%|█▍        | 69/471 [00:14<01:18,  5.13it/s] 15%|█▍        | 70/471 [00:14<01:14,  5.39it/s] 15%|█▌        | 71/471 [00:14<01:19,  5.04it/s] 15%|█▌        | 72/471 [00:14<01:22,  4.81it/s] 15%|█▌        | 73/471 [00:15<01:24,  4.74it/s] 16%|█▌        | 74/471 [00:15<01:23,  4.76it/s] 16%|█▌        | 75/471 [00:15<01:23,  4.72it/s] 16%|█▌        | 76/471 [00:15<01:21,  4.82it/s] 16%|█▋        | 77/471 [00:15<01:24,  4.67it/s] 17%|█▋        | 78/471 [00:16<01:23,  4.70it/s] 17%|█▋        | 79/471 [00:16<01:23,  4.70it/s] 17%|█▋        | 80/471 [00:16<01:22,  4.73it/s] 17%|█▋        | 81/471 [00:16<01:22,  4.74it/s] 17%|█▋        | 82/471 [00:16<01:22,  4.74it/s] 18%|█▊        | 83/471 [00:17<01:23,  4.65it/s] 18%|█▊        | 84/471 [00:17<01:23,  4.64it/s] 18%|█▊        | 85/471 [00:17<01:22,  4.71it/s] 18%|█▊        | 86/471 [00:17<01:22,  4.67it/s] 18%|█▊        | 87/471 [00:18<01:21,  4.71it/s] 19%|█▊        | 88/471 [00:18<01:25,  4.49it/s] 19%|█▉        | 89/471 [00:18<01:21,  4.71it/s] 19%|█▉        | 90/471 [00:18<01:23,  4.58it/s] 19%|█▉        | 91/471 [00:18<01:20,  4.73it/s] 20%|█▉        | 92/471 [00:19<01:22,  4.61it/s] 20%|█▉        | 93/471 [00:19<01:22,  4.60it/s] 20%|█▉        | 94/471 [00:19<01:24,  4.49it/s] 20%|██        | 95/471 [00:19<01:21,  4.64it/s] 20%|██        | 96/471 [00:19<01:21,  4.59it/s] 21%|██        | 97/471 [00:20<01:17,  4.82it/s] 21%|██        | 98/471 [00:20<01:20,  4.62it/s] 21%|██        | 99/471 [00:20<01:18,  4.73it/s] 21%|██        | 100/471 [00:20<01:21,  4.57it/s] 21%|██▏       | 101/471 [00:21<01:17,  4.76it/s] 22%|██▏       | 102/471 [00:21<01:18,  4.68it/s] 22%|██▏       | 103/471 [00:21<01:18,  4.67it/s] 22%|██▏       | 104/471 [00:21<01:21,  4.52it/s] 22%|██▏       | 105/471 [00:21<01:20,  4.54it/s] 23%|██▎       | 106/471 [00:22<01:19,  4.57it/s] 23%|██▎       | 107/471 [00:22<01:17,  4.69it/s] 23%|██▎       | 108/471 [00:22<01:13,  4.96it/s] 23%|██▎       | 109/471 [00:22<01:17,  4.64it/s] 23%|██▎       | 110/471 [00:22<01:16,  4.72it/s] 24%|██▎       | 111/471 [00:23<01:20,  4.49it/s] 24%|██▍       | 112/471 [00:23<01:16,  4.72it/s] 24%|██▍       | 113/471 [00:23<01:17,  4.60it/s] 24%|██▍       | 114/471 [00:23<01:14,  4.80it/s] 24%|██▍       | 115/471 [00:24<01:19,  4.48it/s] 25%|██▍       | 116/471 [00:24<01:15,  4.73it/s] 25%|██▍       | 117/471 [00:24<01:17,  4.54it/s] 25%|██▌       | 118/471 [00:24<01:14,  4.77it/s] 25%|██▌       | 119/471 [00:24<01:16,  4.58it/s] 25%|██▌       | 120/471 [00:25<01:14,  4.73it/s] 26%|██▌       | 121/471 [00:25<01:16,  4.56it/s] 26%|██▌       | 122/471 [00:25<01:15,  4.59it/s] 26%|██▌       | 123/471 [00:25<01:14,  4.69it/s] 26%|██▋       | 124/471 [00:25<01:14,  4.63it/s] 27%|██▋       | 125/471 [00:26<01:12,  4.80it/s] 27%|██▋       | 126/471 [00:26<01:16,  4.54it/s] 27%|██▋       | 127/471 [00:26<01:11,  4.81it/s] 27%|██▋       | 128/471 [00:26<01:15,  4.55it/s] 27%|██▋       | 129/471 [00:26<01:07,  5.08it/s] 28%|██▊       | 130/471 [00:27<01:13,  4.64it/s] 28%|██▊       | 131/471 [00:27<01:09,  4.91it/s] 28%|██▊       | 132/471 [00:27<01:12,  4.66it/s] 28%|██▊       | 133/471 [00:27<01:12,  4.69it/s] 28%|██▊       | 134/471 [00:28<01:09,  4.84it/s] 29%|██▊       | 135/471 [00:28<01:10,  4.75it/s] 29%|██▉       | 136/471 [00:28<01:08,  4.88it/s] 29%|██▉       | 137/471 [00:28<01:12,  4.58it/s] 29%|██▉       | 138/471 [00:28<01:06,  4.98it/s] 30%|██▉       | 139/471 [00:29<01:11,  4.65it/s] 30%|██▉       | 140/471 [00:29<01:04,  5.15it/s] 30%|██▉       | 141/471 [00:29<01:10,  4.71it/s] 30%|███       | 142/471 [00:29<01:09,  4.73it/s] 30%|███       | 143/471 [00:29<01:11,  4.60it/s] 31%|███       | 144/471 [00:30<01:09,  4.70it/s] 31%|███       | 145/471 [00:30<01:06,  4.88it/s] 31%|███       | 146/471 [00:30<01:05,  4.94it/s] 31%|███       | 147/471 [00:30<01:06,  4.87it/s] 31%|███▏      | 148/471 [00:31<01:09,  4.66it/s] 32%|███▏      | 149/471 [00:31<01:08,  4.68it/s] 32%|███▏      | 150/471 [00:31<01:09,  4.62it/s] 32%|███▏      | 151/471 [00:31<01:07,  4.77it/s] 32%|███▏      | 152/471 [00:31<01:08,  4.64it/s] 32%|███▏      | 153/471 [00:32<01:08,  4.65it/s] 33%|███▎      | 154/471 [00:32<01:10,  4.48it/s] 33%|███▎      | 155/471 [00:32<01:07,  4.69it/s] 33%|███▎      | 156/471 [00:32<01:09,  4.54it/s] 33%|███▎      | 157/471 [00:32<01:03,  4.93it/s] 34%|███▎      | 158/471 [00:33<01:08,  4.55it/s] 34%|███▍      | 159/471 [00:33<01:06,  4.71it/s] 34%|███▍      | 160/471 [00:33<01:08,  4.53it/s] 34%|███▍      | 161/471 [00:33<01:05,  4.70it/s] 34%|███▍      | 162/471 [00:34<01:05,  4.73it/s] 35%|███▍      | 163/471 [00:34<01:06,  4.67it/s] 35%|███▍      | 164/471 [00:34<01:06,  4.60it/s] 35%|███▌      | 165/471 [00:34<01:06,  4.58it/s] 35%|███▌      | 166/471 [00:34<01:04,  4.70it/s] 35%|███▌      | 167/471 [00:35<01:04,  4.68it/s] 36%|███▌      | 168/471 [00:35<01:04,  4.70it/s] 36%|███▌      | 169/471 [00:35<01:07,  4.49it/s] 36%|███▌      | 170/471 [00:35<01:05,  4.63it/s] 36%|███▋      | 171/471 [00:35<01:06,  4.51it/s] 37%|███▋      | 172/471 [00:36<01:02,  4.76it/s] 37%|███▋      | 173/471 [00:36<01:05,  4.58it/s] 37%|███▋      | 174/471 [00:36<01:01,  4.79it/s] 37%|███▋      | 175/471 [00:36<01:06,  4.45it/s] 37%|███▋      | 176/471 [00:37<01:01,  4.83it/s] 38%|███▊      | 177/471 [00:37<01:05,  4.48it/s] 38%|███▊      | 178/471 [00:37<00:59,  4.89it/s] 38%|███▊      | 179/471 [00:37<01:04,  4.55it/s] 38%|███▊      | 180/471 [00:37<01:03,  4.57it/s] 38%|███▊      | 181/471 [00:38<01:03,  4.59it/s] 39%|███▊      | 182/471 [00:38<01:03,  4.58it/s] 39%|███▉      | 183/471 [00:38<00:59,  4.86it/s] 39%|███▉      | 184/471 [00:38<00:59,  4.82it/s] 39%|███▉      | 185/471 [00:38<00:50,  5.65it/s] 39%|███▉      | 186/471 [00:39<00:53,  5.29it/s] 40%|███▉      | 187/471 [00:39<00:46,  6.08it/s] 40%|███▉      | 188/471 [00:39<00:50,  5.60it/s] 40%|████      | 189/471 [00:39<00:48,  5.86it/s] 40%|████      | 190/471 [00:39<00:46,  6.04it/s] 41%|████      | 191/471 [00:39<00:48,  5.75it/s] 41%|████      | 193/471 [00:40<00:45,  6.13it/s] 41%|████      | 194/471 [00:40<00:42,  6.58it/s] 41%|████▏     | 195/471 [00:40<00:43,  6.41it/s] 42%|████▏     | 196/471 [00:40<00:45,  6.03it/s] 42%|████▏     | 197/471 [00:40<00:41,  6.67it/s] 42%|████▏     | 198/471 [00:40<00:45,  6.03it/s] 42%|████▏     | 199/471 [00:41<00:40,  6.70it/s] 42%|████▏     | 200/471 [00:41<00:45,  6.00it/s] 43%|████▎     | 201/471 [00:41<00:43,  6.25it/s] 43%|████▎     | 202/471 [00:41<00:45,  5.92it/s] 43%|████▎     | 203/471 [00:41<00:45,  5.92it/s] 43%|████▎     | 204/471 [00:41<00:44,  5.96it/s] 44%|████▎     | 205/471 [00:42<00:46,  5.77it/s] 44%|████▎     | 206/471 [00:42<00:44,  5.96it/s] 44%|████▍     | 207/471 [00:42<00:45,  5.75it/s] 44%|████▍     | 208/471 [00:42<00:42,  6.12it/s] 44%|████▍     | 209/471 [00:42<00:45,  5.77it/s] 45%|████▍     | 210/471 [00:42<00:42,  6.13it/s] 45%|████▍     | 211/471 [00:43<00:45,  5.68it/s] 45%|████▌     | 212/471 [00:43<00:43,  5.96it/s] 45%|████▌     | 213/471 [00:43<00:44,  5.84it/s] 45%|████▌     | 214/471 [00:43<00:44,  5.78it/s] 46%|████▌     | 215/471 [00:43<00:43,  5.94it/s] 46%|████▌     | 216/471 [00:44<00:44,  5.78it/s] 46%|████▌     | 217/471 [00:44<00:43,  5.82it/s] 46%|████▋     | 218/471 [00:44<00:48,  5.22it/s] 46%|████▋     | 219/471 [00:44<00:48,  5.15it/s] 47%|████▋     | 220/471 [00:44<00:51,  4.84it/s] 47%|████▋     | 221/471 [00:45<00:50,  5.00it/s] 47%|████▋     | 222/471 [00:45<00:51,  4.84it/s] 47%|████▋     | 223/471 [00:45<00:50,  4.87it/s] 48%|████▊     | 224/471 [00:45<00:53,  4.60it/s] 48%|████▊     | 225/471 [00:45<00:53,  4.64it/s] 48%|████▊     | 226/471 [00:46<00:52,  4.64it/s] 48%|████▊     | 227/471 [00:46<00:52,  4.66it/s] 48%|████▊     | 228/471 [00:46<00:50,  4.81it/s] 49%|████▊     | 229/471 [00:46<00:52,  4.59it/s] 49%|████▉     | 230/471 [00:47<00:52,  4.63it/s] 49%|████▉     | 231/471 [00:47<00:52,  4.57it/s] 49%|████▉     | 232/471 [00:47<00:49,  4.82it/s] 49%|████▉     | 233/471 [00:47<00:48,  4.88it/s] 50%|████▉     | 234/471 [00:47<00:48,  4.84it/s] 50%|████▉     | 235/471 [00:48<00:50,  4.71it/s] 50%|█████     | 236/471 [00:48<00:50,  4.70it/s] 50%|█████     | 237/471 [00:48<00:49,  4.70it/s] 51%|█████     | 238/471 [00:48<00:49,  4.73it/s] 51%|█████     | 239/471 [00:48<00:49,  4.68it/s] 51%|█████     | 240/471 [00:49<00:50,  4.60it/s] 51%|█████     | 241/471 [00:49<00:48,  4.70it/s] 51%|█████▏    | 242/471 [00:49<00:49,  4.63it/s] 52%|█████▏    | 243/471 [00:49<00:47,  4.76it/s] 52%|█████▏    | 244/471 [00:49<00:48,  4.67it/s] 52%|█████▏    | 245/471 [00:50<00:47,  4.74it/s] 52%|█████▏    | 246/471 [00:50<00:49,  4.58it/s] 52%|█████▏    | 247/471 [00:50<00:47,  4.75it/s] 53%|█████▎    | 248/471 [00:50<00:48,  4.62it/s] 53%|█████▎    | 249/471 [00:51<00:45,  4.85it/s] 53%|█████▎    | 250/471 [00:51<00:47,  4.61it/s] 53%|█████▎    | 251/471 [00:51<00:47,  4.63it/s] 54%|█████▎    | 252/471 [00:51<00:47,  4.59it/s] 54%|█████▎    | 253/471 [00:51<00:46,  4.64it/s] 54%|█████▍    | 254/471 [00:52<00:44,  4.91it/s] 54%|█████▍    | 255/471 [00:52<00:43,  4.96it/s] 54%|█████▍    | 256/471 [00:52<00:38,  5.55it/s] 55%|█████▍    | 257/471 [00:52<00:40,  5.34it/s] 55%|█████▍    | 258/471 [00:52<00:36,  5.88it/s] 55%|█████▍    | 259/471 [00:52<00:39,  5.34it/s] 55%|█████▌    | 260/471 [00:53<00:38,  5.42it/s] 55%|█████▌    | 261/471 [00:53<00:43,  4.86it/s] 56%|█████▌    | 262/471 [00:53<00:42,  4.92it/s] 56%|█████▌    | 263/471 [00:53<00:43,  4.77it/s] 56%|█████▌    | 264/471 [00:54<00:43,  4.77it/s] 56%|█████▋    | 265/471 [00:54<00:42,  4.90it/s] 56%|█████▋    | 266/471 [00:54<00:43,  4.69it/s] 57%|█████▋    | 267/471 [00:54<00:42,  4.84it/s] 57%|█████▋    | 268/471 [00:54<00:43,  4.64it/s] 57%|█████▋    | 269/471 [00:55<00:40,  5.00it/s] 57%|█████▋    | 270/471 [00:55<00:42,  4.74it/s] 58%|█████▊    | 271/471 [00:55<00:39,  5.05it/s] 58%|█████▊    | 272/471 [00:55<00:43,  4.59it/s] 58%|█████▊    | 273/471 [00:55<00:40,  4.85it/s] 58%|█████▊    | 274/471 [00:56<00:41,  4.70it/s] 58%|█████▊    | 275/471 [00:56<00:41,  4.78it/s] 59%|█████▊    | 276/471 [00:56<00:38,  5.00it/s] 59%|█████▉    | 277/471 [00:56<00:40,  4.75it/s] 59%|█████▉    | 278/471 [00:56<00:39,  4.87it/s] 59%|█████▉    | 279/471 [00:57<00:41,  4.66it/s] 59%|█████▉    | 280/471 [00:57<00:38,  5.01it/s] 60%|█████▉    | 281/471 [00:57<00:40,  4.73it/s] 60%|█████▉    | 282/471 [00:57<00:37,  5.02it/s] 60%|██████    | 283/471 [00:57<00:40,  4.61it/s] 60%|██████    | 284/471 [00:58<00:39,  4.74it/s] 61%|██████    | 285/471 [00:58<00:39,  4.70it/s] 61%|██████    | 286/471 [00:58<00:38,  4.81it/s] 61%|██████    | 287/471 [00:58<00:38,  4.80it/s] 61%|██████    | 288/471 [00:59<00:38,  4.69it/s] 61%|██████▏   | 289/471 [00:59<00:38,  4.78it/s] 62%|██████▏   | 290/471 [00:59<00:38,  4.69it/s] 62%|██████▏   | 291/471 [00:59<00:37,  4.81it/s] 62%|██████▏   | 292/471 [00:59<00:38,  4.67it/s] 62%|██████▏   | 293/471 [01:00<00:37,  4.77it/s] 62%|██████▏   | 294/471 [01:00<00:38,  4.56it/s] 63%|██████▎   | 295/471 [01:00<00:36,  4.82it/s] 63%|██████▎   | 296/471 [01:00<00:38,  4.55it/s] 63%|██████▎   | 297/471 [01:00<00:34,  4.97it/s] 63%|██████▎   | 298/471 [01:01<00:36,  4.73it/s] 63%|██████▎   | 299/471 [01:01<00:35,  4.87it/s] 64%|██████▎   | 300/471 [01:01<00:36,  4.63it/s] 64%|██████▍   | 301/471 [01:01<00:36,  4.70it/s] 64%|██████▍   | 302/471 [01:01<00:35,  4.72it/s] 64%|██████▍   | 303/471 [01:02<00:34,  4.84it/s] 65%|██████▍   | 304/471 [01:02<00:34,  4.80it/s] 65%|██████▍   | 305/471 [01:02<00:35,  4.68it/s] 65%|██████▍   | 306/471 [01:02<00:35,  4.71it/s] 65%|██████▌   | 307/471 [01:03<00:35,  4.60it/s] 65%|██████▌   | 308/471 [01:03<00:34,  4.78it/s] 66%|██████▌   | 309/471 [01:03<00:35,  4.58it/s] 66%|██████▌   | 310/471 [01:03<00:33,  4.78it/s] 66%|██████▌   | 311/471 [01:03<00:35,  4.52it/s] 66%|██████▌   | 312/471 [01:04<00:32,  4.85it/s] 66%|██████▋   | 313/471 [01:04<00:34,  4.56it/s] 67%|██████▋   | 314/471 [01:04<00:31,  4.91it/s] 67%|██████▋   | 315/471 [01:04<00:34,  4.58it/s] 67%|██████▋   | 316/471 [01:04<00:33,  4.68it/s] 67%|██████▋   | 317/471 [01:05<00:32,  4.68it/s] 68%|██████▊   | 318/471 [01:05<00:32,  4.70it/s] 68%|██████▊   | 319/471 [01:05<00:31,  4.83it/s] 68%|██████▊   | 320/471 [01:05<00:32,  4.67it/s] 68%|██████▊   | 321/471 [01:06<00:31,  4.72it/s] 68%|██████▊   | 322/471 [01:06<00:32,  4.57it/s] 69%|██████▊   | 323/471 [01:06<00:30,  4.78it/s] 69%|██████▉   | 324/471 [01:06<00:32,  4.58it/s] 69%|██████▉   | 325/471 [01:06<00:30,  4.81it/s] 69%|██████▉   | 326/471 [01:07<00:31,  4.54it/s] 69%|██████▉   | 327/471 [01:07<00:29,  4.83it/s] 70%|██████▉   | 328/471 [01:07<00:31,  4.55it/s] 70%|██████▉   | 329/471 [01:07<00:29,  4.83it/s] 70%|███████   | 330/471 [01:07<00:30,  4.57it/s] 70%|███████   | 331/471 [01:08<00:29,  4.75it/s] 70%|███████   | 332/471 [01:08<00:30,  4.61it/s] 71%|███████   | 333/471 [01:08<00:29,  4.62it/s] 71%|███████   | 334/471 [01:08<00:29,  4.69it/s] 71%|███████   | 335/471 [01:09<00:28,  4.74it/s] 71%|███████▏  | 336/471 [01:09<00:26,  5.13it/s] 72%|███████▏  | 337/471 [01:09<00:28,  4.74it/s] 72%|███████▏  | 338/471 [01:09<00:26,  4.96it/s] 72%|███████▏  | 339/471 [01:09<00:28,  4.63it/s] 72%|███████▏  | 340/471 [01:10<00:26,  5.00it/s] 72%|███████▏  | 341/471 [01:10<00:27,  4.78it/s] 73%|███████▎  | 342/471 [01:10<00:26,  4.87it/s] 73%|███████▎  | 343/471 [01:10<00:28,  4.54it/s] 73%|███████▎  | 344/471 [01:10<00:26,  4.71it/s] 73%|███████▎  | 345/471 [01:11<00:27,  4.64it/s] 73%|███████▎  | 346/471 [01:11<00:26,  4.69it/s] 74%|███████▎  | 347/471 [01:11<00:25,  4.86it/s] 74%|███████▍  | 348/471 [01:11<00:25,  4.75it/s] 74%|███████▍  | 349/471 [01:11<00:25,  4.70it/s] 74%|███████▍  | 350/471 [01:12<00:26,  4.64it/s] 75%|███████▍  | 351/471 [01:12<00:25,  4.77it/s] 75%|███████▍  | 352/471 [01:12<00:25,  4.75it/s] 75%|███████▍  | 353/471 [01:12<00:24,  4.79it/s] 75%|███████▌  | 354/471 [01:13<00:25,  4.62it/s] 75%|███████▌  | 355/471 [01:13<00:24,  4.73it/s] 76%|███████▌  | 356/471 [01:13<00:24,  4.63it/s] 76%|███████▌  | 357/471 [01:13<00:23,  4.88it/s] 76%|███████▌  | 358/471 [01:13<00:24,  4.60it/s] 76%|███████▌  | 359/471 [01:14<00:23,  4.76it/s] 76%|███████▋  | 360/471 [01:14<00:24,  4.53it/s] 77%|███████▋  | 361/471 [01:14<00:23,  4.75it/s] 77%|███████▋  | 362/471 [01:14<00:23,  4.59it/s] 77%|███████▋  | 363/471 [01:14<00:22,  4.83it/s] 77%|███████▋  | 364/471 [01:15<00:23,  4.60it/s] 77%|███████▋  | 365/471 [01:15<00:22,  4.64it/s] 78%|███████▊  | 366/471 [01:15<00:23,  4.56it/s] 78%|███████▊  | 367/471 [01:15<00:22,  4.68it/s] 78%|███████▊  | 368/471 [01:16<00:21,  4.69it/s] 78%|███████▊  | 369/471 [01:16<00:22,  4.61it/s] 79%|███████▊  | 370/471 [01:16<00:22,  4.57it/s] 79%|███████▉  | 371/471 [01:16<00:22,  4.50it/s] 79%|███████▉  | 372/471 [01:16<00:20,  4.72it/s] 79%|███████▉  | 373/471 [01:17<00:20,  4.75it/s] 79%|███████▉  | 374/471 [01:17<00:19,  4.94it/s] 80%|███████▉  | 375/471 [01:17<00:20,  4.80it/s] 80%|███████▉  | 376/471 [01:17<00:19,  4.77it/s] 80%|████████  | 377/471 [01:17<00:20,  4.58it/s] 80%|████████  | 378/471 [01:18<00:19,  4.73it/s] 80%|████████  | 379/471 [01:18<00:20,  4.53it/s] 81%|████████  | 380/471 [01:18<00:18,  4.80it/s] 81%|████████  | 381/471 [01:18<00:19,  4.53it/s] 81%|████████  | 382/471 [01:19<00:18,  4.76it/s] 81%|████████▏ | 383/471 [01:19<00:19,  4.51it/s] 82%|████████▏ | 384/471 [01:19<00:18,  4.80it/s] 82%|████████▏ | 385/471 [01:19<00:18,  4.62it/s] 82%|████████▏ | 386/471 [01:19<00:18,  4.70it/s] 82%|████████▏ | 387/471 [01:20<00:18,  4.53it/s] 82%|████████▏ | 388/471 [01:20<00:17,  4.61it/s] 83%|████████▎ | 389/471 [01:20<00:17,  4.63it/s] 83%|████████▎ | 390/471 [01:20<00:17,  4.73it/s] 83%|████████▎ | 391/471 [01:20<00:17,  4.64it/s] 83%|████████▎ | 392/471 [01:21<00:17,  4.55it/s] 83%|████████▎ | 393/471 [01:21<00:16,  4.64it/s] 84%|████████▎ | 394/471 [01:21<00:16,  4.53it/s] 84%|████████▍ | 395/471 [01:21<00:15,  4.78it/s] 84%|████████▍ | 396/471 [01:22<00:16,  4.57it/s] 84%|████████▍ | 397/471 [01:22<00:15,  4.76it/s] 85%|████████▍ | 398/471 [01:22<00:16,  4.51it/s] 85%|████████▍ | 399/471 [01:22<00:14,  4.88it/s] 85%|████████▍ | 400/471 [01:22<00:15,  4.58it/s] 85%|████████▌ | 401/471 [01:23<00:14,  4.95it/s] 85%|████████▌ | 402/471 [01:23<00:14,  4.64it/s] 86%|████████▌ | 403/471 [01:23<00:14,  4.66it/s] 86%|████████▌ | 404/471 [01:23<00:14,  4.76it/s] 86%|████████▌ | 405/471 [01:23<00:14,  4.61it/s] 86%|████████▌ | 406/471 [01:24<00:12,  5.03it/s] 86%|████████▋ | 407/471 [01:24<00:13,  4.68it/s] 87%|████████▋ | 408/471 [01:24<00:12,  4.92it/s] 87%|████████▋ | 409/471 [01:24<00:13,  4.60it/s] 87%|████████▋ | 410/471 [01:24<00:12,  4.97it/s] 87%|████████▋ | 411/471 [01:25<00:12,  4.69it/s] 87%|████████▋ | 412/471 [01:25<00:11,  5.08it/s] 88%|████████▊ | 413/471 [01:25<00:11,  5.12it/s] 88%|████████▊ | 414/471 [01:25<00:10,  5.31it/s] 88%|████████▊ | 415/471 [01:25<00:09,  5.84it/s] 88%|████████▊ | 416/471 [01:26<00:09,  5.61it/s] 89%|████████▊ | 417/471 [01:26<00:08,  6.29it/s] 89%|████████▊ | 418/471 [01:26<00:09,  5.76it/s] 89%|████████▉ | 419/471 [01:26<00:08,  6.28it/s] 89%|████████▉ | 420/471 [01:26<00:08,  5.79it/s] 89%|████████▉ | 421/471 [01:26<00:08,  5.97it/s] 90%|████████▉ | 422/471 [01:27<00:08,  5.88it/s] 90%|████████▉ | 423/471 [01:27<00:08,  5.82it/s] 90%|█████████ | 424/471 [01:27<00:07,  6.08it/s] 90%|█████████ | 425/471 [01:27<00:07,  5.77it/s] 90%|█████████ | 426/471 [01:27<00:07,  6.16it/s] 91%|█████████ | 427/471 [01:27<00:07,  5.82it/s] 91%|█████████ | 428/471 [01:28<00:07,  5.94it/s] 91%|█████████ | 429/471 [01:28<00:07,  5.78it/s] 91%|█████████▏| 430/471 [01:28<00:06,  5.93it/s] 92%|█████████▏| 431/471 [01:28<00:07,  5.70it/s] 92%|█████████▏| 432/471 [01:28<00:06,  5.93it/s] 92%|█████████▏| 433/471 [01:28<00:06,  5.70it/s] 92%|█████████▏| 434/471 [01:29<00:06,  5.87it/s] 92%|█████████▏| 435/471 [01:29<00:06,  5.78it/s] 93%|█████████▎| 436/471 [01:29<00:06,  5.45it/s] 93%|█████████▎| 437/471 [01:29<00:06,  5.08it/s] 93%|█████████▎| 438/471 [01:29<00:06,  4.96it/s] 93%|█████████▎| 439/471 [01:30<00:06,  4.81it/s] 93%|█████████▎| 440/471 [01:30<00:06,  4.84it/s] 94%|█████████▎| 441/471 [01:30<00:05,  5.02it/s] 94%|█████████▍| 442/471 [01:30<00:05,  5.17it/s] 94%|█████████▍| 443/471 [01:30<00:05,  5.44it/s] 94%|█████████▍| 444/471 [01:31<00:05,  5.39it/s] 94%|█████████▍| 445/471 [01:31<00:04,  5.74it/s] 95%|█████████▍| 446/471 [01:31<00:04,  5.11it/s] 95%|█████████▍| 447/471 [01:31<00:04,  5.15it/s] 95%|█████████▌| 448/471 [01:31<00:04,  4.75it/s] 95%|█████████▌| 449/471 [01:32<00:04,  5.00it/s] 96%|█████████▌| 450/471 [01:32<00:04,  4.66it/s] 96%|█████████▌| 451/471 [01:32<00:03,  5.00it/s] 96%|█████████▌| 452/471 [01:32<00:04,  4.61it/s] 96%|█████████▌| 453/471 [01:32<00:03,  4.74it/s] 96%|█████████▋| 454/471 [01:33<00:03,  4.58it/s] 97%|█████████▋| 455/471 [01:33<00:03,  4.70it/s] 97%|█████████▋| 456/471 [01:33<00:03,  4.76it/s] 97%|█████████▋| 457/471 [01:33<00:03,  4.64it/s] 97%|█████████▋| 458/471 [01:33<00:02,  4.64it/s] 97%|█████████▋| 459/471 [01:34<00:02,  4.54it/s] 98%|█████████▊| 460/471 [01:34<00:02,  4.80it/s] 98%|█████████▊| 461/471 [01:34<00:02,  4.70it/s] 98%|█████████▊| 462/471 [01:34<00:01,  4.92it/s] 98%|█████████▊| 463/471 [01:35<00:01,  4.53it/s] 99%|█████████▊| 464/471 [01:35<00:01,  4.89it/s] 99%|█████████▊| 465/471 [01:35<00:01,  4.59it/s] 99%|█████████▉| 466/471 [01:35<00:01,  4.85it/s] 99%|█████████▉| 467/471 [01:35<00:00,  4.69it/s] 99%|█████████▉| 468/471 [01:36<00:00,  4.67it/s]100%|█████████▉| 469/471 [01:36<00:00,  4.65it/s]100%|█████████▉| 470/471 [01:36<00:00,  4.61it/s]100%|██████████| 471/471 [01:36<00:00,  5.19it/s]100%|██████████| 471/471 [01:36<00:00,  4.87it/s]
{'eval_loss': 2.411930561065674, 'eval_model_preparation_time': 0.0051, 'eval_acc': 0.39365374402549125, 'eval_runtime': 96.9125, 'eval_samples_per_second': 77.72, 'eval_steps_per_second': 4.86}
ROUND:6
CLIENT:69
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:25,  1.50it/s]                                              {'loss': 2.4486, 'grad_norm': 3.1975159645080566, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:25,  1.50it/s]  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]                                              {'loss': 2.4314, 'grad_norm': 3.2553772926330566, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.33it/s]  8%|▊         | 3/40 [00:01<00:21,  1.73it/s]                                              {'loss': 2.6018, 'grad_norm': 3.364342212677002, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:21,  1.73it/s] 10%|█         | 4/40 [00:02<00:17,  2.03it/s]                                              {'loss': 2.5317, 'grad_norm': 3.698326349258423, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:17,  2.03it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.34it/s]                                              {'loss': 2.3639, 'grad_norm': 2.9858319759368896, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.34it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.48it/s]                                              {'loss': 2.572, 'grad_norm': 3.141753673553467, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.48it/s] 18%|█▊        | 7/40 [00:03<00:13,  2.52it/s]                                              {'loss': 2.3599, 'grad_norm': 3.9314920902252197, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:13,  2.52it/s] 20%|██        | 8/40 [00:03<00:09,  3.30it/s]                                              {'loss': 1.7527, 'grad_norm': 9.442138671875, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:09,  3.30it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.07it/s]                                              {'loss': 2.2959, 'grad_norm': 3.772146463394165, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.07it/s] 25%|██▌       | 10/40 [00:04<00:10,  2.89it/s]                                               {'loss': 2.2585, 'grad_norm': 2.9907665252685547, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:10,  2.89it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.85it/s]                                               {'loss': 2.36, 'grad_norm': 3.9300358295440674, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.85it/s] 30%|███       | 12/40 [00:04<00:10,  2.57it/s]                                               {'loss': 2.47, 'grad_norm': 3.590749502182007, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.57it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.45it/s]                                               {'loss': 2.3275, 'grad_norm': 3.392240047454834, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.45it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.42it/s]                                               {'loss': 2.3407, 'grad_norm': 3.147026300430298, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.42it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.31it/s]                                               {'loss': 2.398, 'grad_norm': 3.62424898147583, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.31it/s] 40%|████      | 16/40 [00:06<00:08,  2.94it/s]                                               {'loss': 2.1397, 'grad_norm': 11.972733497619629, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.94it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.74it/s]                                               {'loss': 2.1785, 'grad_norm': 3.355450391769409, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.74it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.4467, 'grad_norm': 3.7924952507019043, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s]                                               {'loss': 2.4411, 'grad_norm': 3.2587058544158936, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s] 50%|█████     | 20/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.3084, 'grad_norm': 3.578688621520996, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.37it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.2162, 'grad_norm': 3.702181577682495, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.33it/s]                                               {'loss': 2.2216, 'grad_norm': 2.867396116256714, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.33it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.0628, 'grad_norm': 3.2339999675750732, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.87it/s]                                               {'loss': 2.755, 'grad_norm': 10.39963150024414, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s]                                               {'loss': 2.2529, 'grad_norm': 3.1427836418151855, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.49it/s]                                               {'loss': 2.4105, 'grad_norm': 2.59499454498291, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.49it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s]                                               {'loss': 2.278, 'grad_norm': 3.2729837894439697, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s] 70%|███████   | 28/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.2431, 'grad_norm': 3.00795841217041, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s]                                               {'loss': 2.0924, 'grad_norm': 3.525906801223755, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.33it/s]                                               {'loss': 2.217, 'grad_norm': 3.1797358989715576, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.33it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.32it/s]                                               {'loss': 2.1513, 'grad_norm': 3.7422587871551514, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.32it/s] 80%|████████  | 32/40 [00:12<00:02,  2.87it/s]                                               {'loss': 2.5896, 'grad_norm': 13.308545112609863, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.87it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s]                                               {'loss': 2.3392, 'grad_norm': 2.7866153717041016, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.60it/s]                                               {'loss': 2.2877, 'grad_norm': 3.3543505668640137, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.60it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.1452, 'grad_norm': 2.777801513671875, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s]                                               {'loss': 2.2004, 'grad_norm': 2.5879108905792236, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.37it/s]                                               {'loss': 2.2219, 'grad_norm': 3.183873176574707, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.37it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s]                                               {'loss': 2.1065, 'grad_norm': 3.276782751083374, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.34it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.39it/s]                                               {'loss': 2.2014, 'grad_norm': 4.531990051269531, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.39it/s]100%|██████████| 40/40 [00:16<00:00,  2.94it/s]                                               {'loss': 2.0807, 'grad_norm': 24.886043548583984, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.94it/s]                                               {'train_runtime': 16.2562, 'train_samples_per_second': 34.756, 'train_steps_per_second': 2.461, 'train_loss': 2.3025181204080583, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.94it/s]100%|██████████| 40/40 [00:16<00:00,  2.46it/s]
CLIENT:74
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.63it/s]                                              {'loss': 2.709, 'grad_norm': 3.997417688369751, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.63it/s]  5%|▌         | 2/40 [00:00<00:14,  2.57it/s]                                              {'loss': 2.5188, 'grad_norm': 3.215064764022827, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:14,  2.57it/s]  8%|▊         | 3/40 [00:01<00:13,  2.67it/s]                                              {'loss': 2.4162, 'grad_norm': 3.183429479598999, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.67it/s] 10%|█         | 4/40 [00:01<00:14,  2.47it/s]                                              {'loss': 2.59, 'grad_norm': 4.125173568725586, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.47it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.34it/s]                                              {'loss': 2.5222, 'grad_norm': 2.8642330169677734, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.34it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.32it/s]                                              {'loss': 2.7364, 'grad_norm': 3.8078367710113525, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.32it/s] 18%|█▊        | 7/40 [00:02<00:14,  2.24it/s]                                              {'loss': 2.4826, 'grad_norm': 3.94795823097229, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:14,  2.24it/s] 20%|██        | 8/40 [00:03<00:11,  2.90it/s]                                              {'loss': 3.1263, 'grad_norm': 11.495499610900879, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.90it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s]                                              {'loss': 2.4905, 'grad_norm': 3.779890775680542, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.73it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.52it/s]                                               {'loss': 2.4562, 'grad_norm': 2.996845245361328, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.52it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.46it/s]                                               {'loss': 2.5353, 'grad_norm': 3.11065411567688, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.46it/s] 30%|███       | 12/40 [00:04<00:11,  2.42it/s]                                               {'loss': 2.5697, 'grad_norm': 3.1058411598205566, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.42it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.37it/s]                                               {'loss': 2.4303, 'grad_norm': 3.067697525024414, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.37it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.37it/s]                                               {'loss': 2.4991, 'grad_norm': 3.628014087677002, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.37it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.28it/s]                                               {'loss': 2.5605, 'grad_norm': 2.9555394649505615, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.28it/s] 40%|████      | 16/40 [00:06<00:08,  2.89it/s]                                               {'loss': 2.098, 'grad_norm': 12.002606391906738, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.89it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.74it/s]                                               {'loss': 2.4641, 'grad_norm': 3.202789545059204, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.74it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.5132, 'grad_norm': 3.055497169494629, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.58it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.51it/s]                                               {'loss': 2.2196, 'grad_norm': 2.705531120300293, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.51it/s] 50%|█████     | 20/40 [00:08<00:08,  2.44it/s]                                               {'loss': 2.5074, 'grad_norm': 3.1403565406799316, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.44it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.34it/s]                                               {'loss': 2.4956, 'grad_norm': 4.004377365112305, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.34it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.31it/s]                                               {'loss': 2.4219, 'grad_norm': 2.7350659370422363, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.31it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.38it/s]                                               {'loss': 2.3168, 'grad_norm': 3.170661687850952, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.38it/s] 60%|██████    | 24/40 [00:09<00:05,  3.06it/s]                                               {'loss': 2.1688, 'grad_norm': 10.525810241699219, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  3.06it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.06it/s]                                               {'loss': 2.471, 'grad_norm': 3.860708475112915, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.06it/s] 65%|██████▌   | 26/40 [00:10<00:04,  3.04it/s]                                               {'loss': 2.314, 'grad_norm': 2.977651357650757, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  3.04it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.98it/s]                                               {'loss': 2.528, 'grad_norm': 4.238214015960693, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.98it/s] 70%|███████   | 28/40 [00:10<00:04,  2.90it/s]                                               {'loss': 2.4125, 'grad_norm': 3.149806261062622, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.90it/s] 72%|███████▎  | 29/40 [00:11<00:03,  2.83it/s]                                               {'loss': 2.3404, 'grad_norm': 3.564016342163086, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:03,  2.83it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.82it/s]                                               {'loss': 2.4594, 'grad_norm': 3.0182225704193115, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.82it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.81it/s]                                               {'loss': 2.5774, 'grad_norm': 4.124332427978516, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.81it/s] 80%|████████  | 32/40 [00:12<00:02,  3.54it/s]                                               {'loss': 1.7452, 'grad_norm': 7.443808078765869, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.54it/s] 82%|████████▎ | 33/40 [00:12<00:02,  3.27it/s]                                               {'loss': 2.3017, 'grad_norm': 3.5483665466308594, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  3.27it/s] 85%|████████▌ | 34/40 [00:12<00:01,  3.08it/s]                                               {'loss': 2.3901, 'grad_norm': 3.8068432807922363, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:01,  3.08it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.92it/s]                                               {'loss': 2.35, 'grad_norm': 2.893186569213867, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.92it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.64it/s]                                               {'loss': 2.278, 'grad_norm': 3.5791778564453125, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.64it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.53it/s]                                               {'loss': 2.4792, 'grad_norm': 3.5269558429718018, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.53it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.67it/s]                                               {'loss': 2.4405, 'grad_norm': 2.8873772621154785, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.67it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.69it/s]                                               {'loss': 2.3592, 'grad_norm': 2.5381195545196533, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.69it/s]                                               {'loss': 2.4342, 'grad_norm': 8.336323738098145, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.69it/s]                                               {'train_runtime': 14.9281, 'train_samples_per_second': 37.848, 'train_steps_per_second': 2.68, 'train_loss': 2.443234583735466, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.69it/s]100%|██████████| 40/40 [00:14<00:00,  2.68it/s]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.7534, 'grad_norm': 3.3491201400756836, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.3508, 'grad_norm': 4.04994010925293, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]  8%|▊         | 3/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.5911, 'grad_norm': 5.0714802742004395, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.20it/s] 10%|█         | 4/40 [00:01<00:16,  2.17it/s]                                              {'loss': 2.5046, 'grad_norm': 3.730954647064209, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.17it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s]                                              {'loss': 2.5868, 'grad_norm': 3.4871890544891357, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.34it/s]                                              {'loss': 2.3405, 'grad_norm': 3.117547035217285, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.34it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.25it/s]                                              {'loss': 2.251, 'grad_norm': 3.212080717086792, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.25it/s] 20%|██        | 8/40 [00:03<00:10,  2.96it/s]                                              {'loss': 2.824, 'grad_norm': 9.915372848510742, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.96it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.68it/s]                                              {'loss': 2.2478, 'grad_norm': 2.87044358253479, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.68it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.52it/s]                                               {'loss': 2.4388, 'grad_norm': 2.7365596294403076, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.52it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.42it/s]                                               {'loss': 2.2328, 'grad_norm': 3.3671321868896484, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.42it/s] 30%|███       | 12/40 [00:05<00:11,  2.38it/s]                                               {'loss': 2.4699, 'grad_norm': 2.753505229949951, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.38it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.3664, 'grad_norm': 2.892212390899658, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.25it/s]                                               {'loss': 2.3292, 'grad_norm': 3.043855905532837, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.25it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.3139, 'grad_norm': 3.1086373329162598, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s] 40%|████      | 16/40 [00:06<00:08,  2.86it/s]                                               {'loss': 3.2697, 'grad_norm': 20.0909423828125, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.86it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.64it/s]                                               {'loss': 2.2885, 'grad_norm': 3.33174991607666, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.4019, 'grad_norm': 4.2422614097595215, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s]                                               {'loss': 2.3889, 'grad_norm': 3.3633997440338135, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s] 50%|█████     | 20/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.2233, 'grad_norm': 2.892706871032715, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.41it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.3174, 'grad_norm': 2.899184226989746, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.1889, 'grad_norm': 3.4411001205444336, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.30it/s]                                               {'loss': 2.1457, 'grad_norm': 3.1485283374786377, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.30it/s] 60%|██████    | 24/40 [00:09<00:05,  2.85it/s]                                               {'loss': 2.4922, 'grad_norm': 16.580629348754883, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 2.1882, 'grad_norm': 2.892612934112549, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.54it/s]                                               {'loss': 2.4096, 'grad_norm': 2.421401023864746, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.54it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.43it/s]                                               {'loss': 2.1598, 'grad_norm': 3.250990390777588, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.43it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.2585, 'grad_norm': 3.4276747703552246, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s]                                               {'loss': 2.2871, 'grad_norm': 3.7781100273132324, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.2001, 'grad_norm': 3.2238824367523193, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.1338, 'grad_norm': 3.301529884338379, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s] 80%|████████  | 32/40 [00:13<00:02,  2.90it/s]                                               {'loss': 2.4021, 'grad_norm': 11.515190124511719, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.59it/s]                                               {'loss': 2.2315, 'grad_norm': 4.189791202545166, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s]                                               {'loss': 2.221, 'grad_norm': 3.555894374847412, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s]                                               {'loss': 2.1982, 'grad_norm': 2.9570748805999756, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.28it/s]                                               {'loss': 2.2668, 'grad_norm': 3.0020430088043213, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.28it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s]                                               {'loss': 2.2574, 'grad_norm': 3.261530637741089, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s]                                               {'loss': 2.0865, 'grad_norm': 2.58077335357666, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.23it/s]                                               {'loss': 2.1604, 'grad_norm': 2.5991125106811523, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.23it/s]                                               {'loss': 2.0215, 'grad_norm': 9.83535099029541, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.23it/s]                                               {'train_runtime': 16.5013, 'train_samples_per_second': 34.24, 'train_steps_per_second': 2.424, 'train_loss': 2.345005226135254, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.23it/s]100%|██████████| 40/40 [00:16<00:00,  2.43it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.12it/s]                                              {'loss': 2.3628, 'grad_norm': 2.871652603149414, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.12it/s]  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.324, 'grad_norm': 2.958101987838745, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]  8%|▊         | 3/40 [00:01<00:16,  2.18it/s]                                              {'loss': 2.416, 'grad_norm': 3.5229880809783936, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.18it/s] 10%|█         | 4/40 [00:01<00:16,  2.17it/s]                                              {'loss': 2.5423, 'grad_norm': 3.911748170852661, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.17it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.4887, 'grad_norm': 3.3623218536376953, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.17it/s]                                              {'loss': 2.4148, 'grad_norm': 3.214334726333618, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.17it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.19it/s]                                              {'loss': 2.4495, 'grad_norm': 3.348557949066162, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.19it/s]                                              {'loss': 2.7147, 'grad_norm': 11.747591972351074, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.19it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s]                                              {'loss': 2.435, 'grad_norm': 2.960888624191284, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s]                                               {'loss': 2.4103, 'grad_norm': 3.2585816383361816, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.43it/s]                                               {'loss': 2.6507, 'grad_norm': 3.775949239730835, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.43it/s] 30%|███       | 12/40 [00:05<00:11,  2.35it/s]                                               {'loss': 2.3969, 'grad_norm': 3.6779944896698, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.35it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s]                                               {'loss': 2.3158, 'grad_norm': 3.099057912826538, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.3021, 'grad_norm': 2.9676296710968018, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.281, 'grad_norm': 2.295682668685913, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 1.6145, 'grad_norm': 8.754469871520996, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:10,  2.23it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.71it/s]                                               {'loss': 2.3927, 'grad_norm': 3.402681589126587, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.71it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.3673, 'grad_norm': 3.091665506362915, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.57it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.54it/s]                                               {'loss': 2.4011, 'grad_norm': 3.1631407737731934, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.54it/s] 50%|█████     | 20/40 [00:08<00:08,  2.43it/s]                                               {'loss': 2.3629, 'grad_norm': 2.806640625, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.43it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.1883, 'grad_norm': 2.7546916007995605, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.37it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.34it/s]                                               {'loss': 2.2912, 'grad_norm': 3.236724853515625, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.34it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.193, 'grad_norm': 3.69494366645813, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.83it/s]                                               {'loss': 2.8019, 'grad_norm': 16.945589065551758, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.71it/s]                                               {'loss': 2.3383, 'grad_norm': 3.1284782886505127, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.71it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.409, 'grad_norm': 3.0077128410339355, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s]                                               {'loss': 2.2907, 'grad_norm': 3.145301342010498, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s] 70%|███████   | 28/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.4857, 'grad_norm': 3.0874252319335938, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s]                                               {'loss': 2.142, 'grad_norm': 3.421105146408081, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.33it/s]                                               {'loss': 2.0819, 'grad_norm': 3.1023917198181152, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.33it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s]                                               {'loss': 2.2911, 'grad_norm': 3.143604040145874, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s] 80%|████████  | 32/40 [00:13<00:02,  2.84it/s]                                               {'loss': 2.5987, 'grad_norm': 9.631505966186523, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.84it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s]                                               {'loss': 2.2408, 'grad_norm': 3.127858877182007, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s]                                               {'loss': 2.2667, 'grad_norm': 3.2783772945404053, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.44it/s]                                               {'loss': 2.0637, 'grad_norm': 3.1337530612945557, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.44it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s]                                               {'loss': 2.4437, 'grad_norm': 3.8495359420776367, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.37it/s]                                               {'loss': 2.1664, 'grad_norm': 3.2716803550720215, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.37it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.35it/s]                                               {'loss': 2.3041, 'grad_norm': 3.085716724395752, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.35it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.41it/s]                                               {'loss': 2.2596, 'grad_norm': 2.600665330886841, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.41it/s]100%|██████████| 40/40 [00:16<00:00,  3.08it/s]                                               {'loss': 3.2221, 'grad_norm': 18.019264221191406, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.08it/s]                                               {'train_runtime': 16.3706, 'train_samples_per_second': 34.513, 'train_steps_per_second': 2.443, 'train_loss': 2.3680523484945297, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.08it/s]100%|██████████| 40/40 [00:16<00:00,  2.44it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.80it/s]                                              {'loss': 2.4262, 'grad_norm': 2.986684799194336, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.80it/s]  5%|▌         | 2/40 [00:00<00:13,  2.81it/s]                                              {'loss': 2.6113, 'grad_norm': 2.8604941368103027, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.81it/s]  8%|▊         | 3/40 [00:01<00:12,  2.88it/s]                                              {'loss': 2.4246, 'grad_norm': 4.119275093078613, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.88it/s] 10%|█         | 4/40 [00:01<00:12,  2.91it/s]                                              {'loss': 2.5537, 'grad_norm': 3.603834867477417, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.91it/s] 12%|█▎        | 5/40 [00:01<00:13,  2.66it/s]                                              {'loss': 2.4203, 'grad_norm': 3.6729390621185303, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:13,  2.66it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.49it/s]                                              {'loss': 2.6188, 'grad_norm': 3.0880768299102783, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.49it/s] 18%|█▊        | 7/40 [00:02<00:13,  2.43it/s]                                              {'loss': 2.4924, 'grad_norm': 3.4553089141845703, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:13,  2.43it/s] 20%|██        | 8/40 [00:02<00:11,  2.85it/s]                                              {'loss': 2.641, 'grad_norm': 10.291006088256836, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.85it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s]                                              {'loss': 2.5613, 'grad_norm': 3.2917840480804443, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s] 25%|██▌       | 10/40 [00:03<00:12,  2.40it/s]                                               {'loss': 2.4565, 'grad_norm': 3.1520700454711914, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:12,  2.40it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.34it/s]                                               {'loss': 2.2007, 'grad_norm': 2.6104602813720703, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.34it/s] 30%|███       | 12/40 [00:04<00:12,  2.26it/s]                                               {'loss': 2.4315, 'grad_norm': 3.6003482341766357, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.241, 'grad_norm': 2.645087957382202, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.20it/s]                                               {'loss': 2.3612, 'grad_norm': 2.9558770656585693, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.20it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.4789, 'grad_norm': 3.206127166748047, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.3418, 'grad_norm': 12.441363334655762, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:10,  2.21it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.75it/s]                                               {'loss': 2.3306, 'grad_norm': 3.07987904548645, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.75it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.59it/s]                                               {'loss': 2.1322, 'grad_norm': 3.552616596221924, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.59it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.49it/s]                                               {'loss': 2.3639, 'grad_norm': 3.345820665359497, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.49it/s] 50%|█████     | 20/40 [00:08<00:08,  2.38it/s]                                               {'loss': 2.4388, 'grad_norm': 3.2007322311401367, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.38it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.34it/s]                                               {'loss': 2.2857, 'grad_norm': 2.938983678817749, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.34it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.29it/s]                                               {'loss': 2.4558, 'grad_norm': 3.3666727542877197, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.3897, 'grad_norm': 3.9450979232788086, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s] 60%|██████    | 24/40 [00:09<00:05,  2.83it/s]                                               {'loss': 2.7906, 'grad_norm': 14.363966941833496, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.73it/s]                                               {'loss': 2.229, 'grad_norm': 2.925229072570801, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.73it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.3001, 'grad_norm': 3.1071386337280273, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.45it/s]                                               {'loss': 2.3422, 'grad_norm': 2.8396358489990234, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.45it/s] 70%|███████   | 28/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.3111, 'grad_norm': 3.199568033218384, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.33it/s]                                               {'loss': 2.1782, 'grad_norm': 3.360348701477051, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.33it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.36it/s]                                               {'loss': 2.3048, 'grad_norm': 2.922017812728882, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.36it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s]                                               {'loss': 2.2241, 'grad_norm': 3.352916717529297, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s] 80%|████████  | 32/40 [00:12<00:02,  2.90it/s]                                               {'loss': 2.2699, 'grad_norm': 12.597832679748535, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.68it/s]                                               {'loss': 2.2412, 'grad_norm': 3.1530754566192627, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.68it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.53it/s]                                               {'loss': 2.0332, 'grad_norm': 3.280320882797241, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.53it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s]                                               {'loss': 2.23, 'grad_norm': 3.0717875957489014, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.37it/s]                                               {'loss': 2.3388, 'grad_norm': 3.290057420730591, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.37it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s]                                               {'loss': 2.1524, 'grad_norm': 3.4823732376098633, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s]                                               {'loss': 2.3558, 'grad_norm': 3.267507791519165, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.26it/s]                                               {'loss': 2.333, 'grad_norm': 3.4566714763641357, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.26it/s]100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'loss': 2.0814, 'grad_norm': 13.816651344299316, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'train_runtime': 16.1682, 'train_samples_per_second': 34.945, 'train_steps_per_second': 2.474, 'train_loss': 2.3593429565429687, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]100%|██████████| 40/40 [00:16<00:00,  2.48it/s]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.36it/s]                                              {'loss': 2.3248, 'grad_norm': 4.80864143371582, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.36it/s]  5%|▌         | 2/40 [00:00<00:16,  2.31it/s]                                              {'loss': 2.4157, 'grad_norm': 3.3907148838043213, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.31it/s]  8%|▊         | 3/40 [00:01<00:16,  2.26it/s]                                              {'loss': 2.3546, 'grad_norm': 3.37756609916687, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.26it/s] 10%|█         | 4/40 [00:01<00:15,  2.31it/s]                                              {'loss': 2.5265, 'grad_norm': 3.238616466522217, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.31it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.4209, 'grad_norm': 3.479522228240967, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.27it/s]                                              {'loss': 2.4178, 'grad_norm': 3.990048885345459, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.27it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s]                                              {'loss': 2.3553, 'grad_norm': 3.0507731437683105, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s] 20%|██        | 8/40 [00:03<00:11,  2.83it/s]                                              {'loss': 2.8095, 'grad_norm': 12.38309097290039, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.65it/s]                                              {'loss': 2.3561, 'grad_norm': 2.9254226684570312, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.65it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s]                                               {'loss': 2.4026, 'grad_norm': 3.0462000370025635, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s]                                               {'loss': 2.3606, 'grad_norm': 3.043454885482788, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s] 30%|███       | 12/40 [00:04<00:11,  2.43it/s]                                               {'loss': 2.27, 'grad_norm': 3.21492862701416, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.43it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.38it/s]                                               {'loss': 2.1443, 'grad_norm': 3.2869176864624023, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.38it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.1554, 'grad_norm': 3.6877427101135254, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.34it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.34it/s]                                               {'loss': 2.4809, 'grad_norm': 3.7819182872772217, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.34it/s] 40%|████      | 16/40 [00:06<00:08,  2.99it/s]                                               {'loss': 2.6593, 'grad_norm': 11.301810264587402, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.99it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s]                                               {'loss': 2.2884, 'grad_norm': 3.4265947341918945, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.55it/s]                                               {'loss': 2.3162, 'grad_norm': 3.4217023849487305, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.55it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.1901, 'grad_norm': 2.5648305416107178, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.47it/s] 50%|█████     | 20/40 [00:08<00:08,  2.42it/s]                                               {'loss': 2.3571, 'grad_norm': 3.2076516151428223, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.42it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.43it/s]                                               {'loss': 2.2064, 'grad_norm': 3.0211308002471924, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.43it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.34it/s]                                               {'loss': 2.4467, 'grad_norm': 3.304551362991333, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.34it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.29it/s]                                               {'loss': 2.1672, 'grad_norm': 2.3263063430786133, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.29it/s] 60%|██████    | 24/40 [00:09<00:05,  2.90it/s]                                               {'loss': 1.7706, 'grad_norm': 9.617023468017578, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.90it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.70it/s]                                               {'loss': 2.2304, 'grad_norm': 3.0762579441070557, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.70it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.58it/s]                                               {'loss': 2.2453, 'grad_norm': 3.679328680038452, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.58it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.2797, 'grad_norm': 3.0161919593811035, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.53it/s] 70%|███████   | 28/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.2815, 'grad_norm': 2.860398292541504, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.37it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.35it/s]                                               {'loss': 2.061, 'grad_norm': 3.4631097316741943, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.35it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.30it/s]                                               {'loss': 2.2693, 'grad_norm': 2.557770252227783, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.28it/s]                                               {'loss': 2.2099, 'grad_norm': 2.890263319015503, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.28it/s] 80%|████████  | 32/40 [00:12<00:02,  2.85it/s]                                               {'loss': 2.6577, 'grad_norm': 14.270464897155762, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.1871, 'grad_norm': 2.6121206283569336, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s]                                               {'loss': 2.1905, 'grad_norm': 3.489435911178589, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s]                                               {'loss': 2.2834, 'grad_norm': 3.1440200805664062, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.1591, 'grad_norm': 2.9253385066986084, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s]                                               {'loss': 2.1578, 'grad_norm': 3.035081386566162, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s]                                               {'loss': 2.1794, 'grad_norm': 3.233705759048462, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.23it/s]                                               {'loss': 2.2385, 'grad_norm': 2.9008982181549072, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.23it/s]100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'loss': 1.8922, 'grad_norm': 10.99882698059082, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'train_runtime': 16.2739, 'train_samples_per_second': 34.718, 'train_steps_per_second': 2.458, 'train_loss': 2.292990654706955, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]100%|██████████| 40/40 [00:16<00:00,  2.46it/s]
CLIENT:32
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:15,  2.53it/s]                                              {'loss': 2.5145, 'grad_norm': 4.09916353225708, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:15,  2.53it/s]  5%|▌         | 2/40 [00:00<00:16,  2.31it/s]                                              {'loss': 2.3835, 'grad_norm': 2.92584490776062, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.31it/s]  8%|▊         | 3/40 [00:01<00:16,  2.26it/s]                                              {'loss': 2.5866, 'grad_norm': 3.7635135650634766, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.26it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.5561, 'grad_norm': 2.586578369140625, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.5012, 'grad_norm': 3.1417789459228516, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.5538, 'grad_norm': 3.2565736770629883, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.35it/s]                                              {'loss': 2.4182, 'grad_norm': 4.02803897857666, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.35it/s]                                              {'loss': 2.6191, 'grad_norm': 12.169776916503906, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:13,  2.35it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.00it/s]                                              {'loss': 2.5986, 'grad_norm': 3.0538432598114014, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.00it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.90it/s]                                               {'loss': 2.334, 'grad_norm': 3.265152931213379, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.90it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.83it/s]                                               {'loss': 2.4002, 'grad_norm': 3.3672287464141846, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.83it/s] 30%|███       | 12/40 [00:04<00:10,  2.78it/s]                                               {'loss': 2.4736, 'grad_norm': 3.433300495147705, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.78it/s] 32%|███▎      | 13/40 [00:05<00:09,  2.74it/s]                                               {'loss': 2.4411, 'grad_norm': 4.505586624145508, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:09,  2.74it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.73it/s]                                               {'loss': 2.3398, 'grad_norm': 3.5343213081359863, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.73it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.71it/s]                                               {'loss': 2.3737, 'grad_norm': 3.9810914993286133, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.71it/s]                                               {'loss': 2.5342, 'grad_norm': 16.438066482543945, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:08,  2.71it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.37it/s]                                               {'loss': 2.3444, 'grad_norm': 3.7944843769073486, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.37it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.20it/s]                                               {'loss': 2.4991, 'grad_norm': 3.028447389602661, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.20it/s] 48%|████▊     | 19/40 [00:06<00:06,  3.07it/s]                                               {'loss': 2.4991, 'grad_norm': 2.9559781551361084, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:06,  3.07it/s] 50%|█████     | 20/40 [00:07<00:06,  2.94it/s]                                               {'loss': 2.4171, 'grad_norm': 3.3736441135406494, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  2.94it/s] 52%|█████▎    | 21/40 [00:07<00:06,  2.86it/s]                                               {'loss': 2.3225, 'grad_norm': 3.856785535812378, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  2.86it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.78it/s]                                               {'loss': 2.2703, 'grad_norm': 3.6066806316375732, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.78it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.69it/s]                                               {'loss': 2.2238, 'grad_norm': 3.368288278579712, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.69it/s] 60%|██████    | 24/40 [00:08<00:04,  3.36it/s]                                               {'loss': 2.3107, 'grad_norm': 10.833703994750977, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:04,  3.36it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.88it/s]                                               {'loss': 2.3762, 'grad_norm': 3.7131717205047607, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.88it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.67it/s]                                               {'loss': 2.2373, 'grad_norm': 2.8051698207855225, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.67it/s] 68%|██████▊   | 27/40 [00:09<00:05,  2.54it/s]                                               {'loss': 2.3107, 'grad_norm': 3.0734524726867676, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:05,  2.54it/s] 70%|███████   | 28/40 [00:10<00:04,  2.43it/s]                                               {'loss': 2.403, 'grad_norm': 2.9200735092163086, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.43it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.36it/s]                                               {'loss': 2.364, 'grad_norm': 2.877732038497925, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.36it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.29it/s]                                               {'loss': 2.3652, 'grad_norm': 4.393184185028076, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.29it/s] 78%|███████▊  | 31/40 [00:11<00:04,  2.25it/s]                                               {'loss': 2.4408, 'grad_norm': 3.8840324878692627, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:04,  2.25it/s] 80%|████████  | 32/40 [00:11<00:02,  2.83it/s]                                               {'loss': 1.8665, 'grad_norm': 6.716678142547607, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.83it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.65it/s]                                               {'loss': 2.3935, 'grad_norm': 4.114749908447266, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s]                                               {'loss': 2.3089, 'grad_norm': 3.975494384765625, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.48it/s]                                               {'loss': 2.346, 'grad_norm': 3.255080461502075, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.48it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.37it/s]                                               {'loss': 2.2693, 'grad_norm': 4.080132961273193, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.37it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.29it/s]                                               {'loss': 2.1562, 'grad_norm': 4.085596084594727, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.23it/s]                                               {'loss': 2.3725, 'grad_norm': 3.1310927867889404, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.20it/s]                                               {'loss': 2.1367, 'grad_norm': 3.9494895935058594, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.20it/s]100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'loss': 2.4287, 'grad_norm': 9.572441101074219, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'train_runtime': 15.291, 'train_samples_per_second': 36.95, 'train_steps_per_second': 2.616, 'train_loss': 2.3822655946016313, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]100%|██████████| 40/40 [00:15<00:00,  2.62it/s]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.4315, 'grad_norm': 3.562741756439209, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]  5%|▌         | 2/40 [00:00<00:18,  2.11it/s]                                              {'loss': 2.5813, 'grad_norm': 3.5993218421936035, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:18,  2.11it/s]  8%|▊         | 3/40 [00:01<00:17,  2.09it/s]                                              {'loss': 2.4866, 'grad_norm': 3.059854507446289, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.09it/s] 10%|█         | 4/40 [00:01<00:17,  2.08it/s]                                              {'loss': 2.7598, 'grad_norm': 3.708250045776367, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:17,  2.08it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.414, 'grad_norm': 3.1229259967803955, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s] 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.5149, 'grad_norm': 3.2381539344787598, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.614, 'grad_norm': 6.723763465881348, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s] 20%|██        | 8/40 [00:03<00:11,  2.80it/s]                                              {'loss': 2.4956, 'grad_norm': 12.376019477844238, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.80it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.57it/s]                                              {'loss': 2.4311, 'grad_norm': 3.0214295387268066, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.57it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s]                                               {'loss': 2.5758, 'grad_norm': 3.3297152519226074, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.35it/s]                                               {'loss': 2.3751, 'grad_norm': 2.8441402912139893, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.35it/s] 30%|███       | 12/40 [00:05<00:12,  2.30it/s]                                               {'loss': 2.477, 'grad_norm': 4.396189212799072, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.30it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.26it/s]                                               {'loss': 2.3892, 'grad_norm': 3.2985994815826416, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.26it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.3267, 'grad_norm': 3.715665817260742, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.3562, 'grad_norm': 3.841848611831665, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.79it/s]                                               {'loss': 2.0584, 'grad_norm': 14.87614917755127, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.79it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.2916, 'grad_norm': 3.3343911170959473, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.4256, 'grad_norm': 3.556291341781616, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.3576, 'grad_norm': 3.362205743789673, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.3255, 'grad_norm': 3.7887015342712402, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.28it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.27it/s]                                               {'loss': 2.294, 'grad_norm': 2.8596038818359375, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.25it/s]                                               {'loss': 2.3807, 'grad_norm': 2.5464985370635986, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.25it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.4605, 'grad_norm': 3.9604263305664062, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:10<00:05,  2.81it/s]                                               {'loss': 2.1134, 'grad_norm': 13.77778434753418, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 2.4055, 'grad_norm': 2.7313387393951416, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s]                                               {'loss': 2.3654, 'grad_norm': 3.113447666168213, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.3413, 'grad_norm': 2.4565610885620117, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.33it/s]                                               {'loss': 2.2818, 'grad_norm': 2.9898574352264404, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.41it/s]                                               {'loss': 2.2275, 'grad_norm': 2.9130446910858154, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.41it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.49it/s]                                               {'loss': 2.2666, 'grad_norm': 3.4088728427886963, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.49it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.57it/s]                                               {'loss': 2.1945, 'grad_norm': 2.792452573776245, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.57it/s] 80%|████████  | 32/40 [00:13<00:02,  3.24it/s]                                               {'loss': 2.433, 'grad_norm': 12.811056137084961, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  3.24it/s] 82%|████████▎ | 33/40 [00:13<00:02,  3.05it/s]                                               {'loss': 2.1904, 'grad_norm': 3.0738394260406494, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  3.05it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.12it/s]                                               {'loss': 2.1658, 'grad_norm': 3.1171953678131104, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.12it/s] 88%|████████▊ | 35/40 [00:14<00:01,  3.18it/s]                                               {'loss': 2.3315, 'grad_norm': 3.6742494106292725, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  3.18it/s] 90%|█████████ | 36/40 [00:14<00:01,  3.20it/s]                                               {'loss': 2.3181, 'grad_norm': 3.118279218673706, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  3.20it/s] 92%|█████████▎| 37/40 [00:14<00:00,  3.18it/s]                                               {'loss': 2.3169, 'grad_norm': 3.3687429428100586, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:00,  3.18it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.91it/s]                                               {'loss': 2.2598, 'grad_norm': 2.7327780723571777, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.91it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.78it/s]                                               {'loss': 2.4637, 'grad_norm': 3.104750871658325, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.78it/s]100%|██████████| 40/40 [00:15<00:00,  3.48it/s]                                               {'loss': 2.3029, 'grad_norm': 11.550517082214355, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.48it/s]                                               {'train_runtime': 15.8042, 'train_samples_per_second': 35.75, 'train_steps_per_second': 2.531, 'train_loss': 2.37001748085022, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.48it/s]100%|██████████| 40/40 [00:15<00:00,  2.53it/s]
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]                                              {'loss': 2.3064, 'grad_norm': 3.2943713665008545, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]  5%|▌         | 2/40 [00:00<00:17,  2.17it/s]                                              {'loss': 2.482, 'grad_norm': 3.932441473007202, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.17it/s]  8%|▊         | 3/40 [00:01<00:17,  2.14it/s]                                              {'loss': 2.4106, 'grad_norm': 4.080793380737305, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.14it/s] 10%|█         | 4/40 [00:01<00:16,  2.13it/s]                                              {'loss': 2.6209, 'grad_norm': 3.404898166656494, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.13it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s]                                              {'loss': 2.6371, 'grad_norm': 4.134823799133301, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s] 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.6161, 'grad_norm': 3.3171708583831787, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.4608, 'grad_norm': 3.5670697689056396, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s] 20%|██        | 8/40 [00:03<00:11,  2.79it/s]                                              {'loss': 1.7879, 'grad_norm': 7.751917839050293, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.79it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s]                                              {'loss': 2.3967, 'grad_norm': 3.718596935272217, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s]                                               {'loss': 2.305, 'grad_norm': 2.5747323036193848, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.33it/s]                                               {'loss': 2.4626, 'grad_norm': 3.4197521209716797, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.33it/s] 30%|███       | 12/40 [00:05<00:12,  2.28it/s]                                               {'loss': 2.4291, 'grad_norm': 2.8464107513427734, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.28it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.3094, 'grad_norm': 3.510632038116455, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.22it/s]                                               {'loss': 2.4762, 'grad_norm': 3.6177287101745605, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.22it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.4655, 'grad_norm': 4.240262031555176, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s] 40%|████      | 16/40 [00:06<00:08,  2.78it/s]                                               {'loss': 1.828, 'grad_norm': 17.816041946411133, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.78it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.2526, 'grad_norm': 3.5549893379211426, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s]                                               {'loss': 2.2786, 'grad_norm': 3.9518744945526123, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.5242, 'grad_norm': 4.074123382568359, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.2762, 'grad_norm': 3.402629852294922, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s]                                               {'loss': 2.5276, 'grad_norm': 4.109464645385742, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.2278, 'grad_norm': 3.113722324371338, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.27it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.3757, 'grad_norm': 4.132800102233887, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:10<00:05,  2.81it/s]                                               {'loss': 2.1117, 'grad_norm': 13.510129928588867, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s]                                               {'loss': 2.0462, 'grad_norm': 3.184462070465088, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s]                                               {'loss': 2.3093, 'grad_norm': 3.949418544769287, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.4421, 'grad_norm': 3.150073289871216, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s] 70%|███████   | 28/40 [00:11<00:05,  2.31it/s]                                               {'loss': 2.4276, 'grad_norm': 4.2019734382629395, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.31it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.3988, 'grad_norm': 3.194040536880493, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 2.213, 'grad_norm': 4.445376396179199, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.29it/s]                                               {'loss': 2.2877, 'grad_norm': 4.017245292663574, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.29it/s] 80%|████████  | 32/40 [00:13<00:02,  2.86it/s]                                               {'loss': 1.7108, 'grad_norm': 12.980901718139648, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.86it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.78it/s]                                               {'loss': 2.3024, 'grad_norm': 4.353278160095215, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.78it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.74it/s]                                               {'loss': 2.2758, 'grad_norm': 3.7586047649383545, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.74it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.70it/s]                                               {'loss': 2.1937, 'grad_norm': 3.2672224044799805, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.70it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.68it/s]                                               {'loss': 2.1749, 'grad_norm': 3.6416432857513428, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.68it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.66it/s]                                               {'loss': 2.2658, 'grad_norm': 4.036001205444336, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.66it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.68it/s]                                               {'loss': 2.334, 'grad_norm': 3.328669786453247, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.68it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.70it/s]                                               {'loss': 2.3119, 'grad_norm': 3.5235683917999268, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.70it/s]100%|██████████| 40/40 [00:16<00:00,  3.33it/s]                                               {'loss': 2.1001, 'grad_norm': 18.493377685546875, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.33it/s]                                               {'train_runtime': 16.273, 'train_samples_per_second': 34.72, 'train_steps_per_second': 2.458, 'train_loss': 2.3090638488531114, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.33it/s]100%|██████████| 40/40 [00:16<00:00,  2.46it/s]
CLIENT:3
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.31it/s]                                              {'loss': 2.3853, 'grad_norm': 3.1765263080596924, 'learning_rate': 0.00016905249806888745, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.31it/s]  5%|▌         | 2/40 [00:00<00:16,  2.25it/s]                                              {'loss': 2.2865, 'grad_norm': 3.3945279121398926, 'learning_rate': 0.00016482618561716527, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.25it/s]  8%|▊         | 3/40 [00:01<00:16,  2.24it/s]                                              {'loss': 2.7034, 'grad_norm': 4.9088215827941895, 'learning_rate': 0.00016059987316544306, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.24it/s] 10%|█         | 4/40 [00:01<00:15,  2.28it/s]                                              {'loss': 2.3653, 'grad_norm': 3.2294931411743164, 'learning_rate': 0.0001563735607137209, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.28it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.30it/s]                                              {'loss': 2.4446, 'grad_norm': 3.795980215072632, 'learning_rate': 0.0001521472482619987, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.30it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.27it/s]                                              {'loss': 2.3979, 'grad_norm': 3.699174404144287, 'learning_rate': 0.00014792093581027653, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.27it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s]                                              {'loss': 2.5916, 'grad_norm': 3.6076478958129883, 'learning_rate': 0.00014369462335855432, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s] 20%|██        | 8/40 [00:03<00:11,  2.88it/s]                                              {'loss': 2.6255, 'grad_norm': 11.051407814025879, 'learning_rate': 0.00013946831090683214, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.88it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.3988, 'grad_norm': 2.844386100769043, 'learning_rate': 0.00013524199845510996, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.52it/s]                                               {'loss': 2.3737, 'grad_norm': 3.1761085987091064, 'learning_rate': 0.00013101568600338778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.52it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s]                                               {'loss': 2.4095, 'grad_norm': 3.313974618911743, 'learning_rate': 0.0001267893735516656, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s] 30%|███       | 12/40 [00:05<00:11,  2.38it/s]                                               {'loss': 2.2357, 'grad_norm': 3.192656993865967, 'learning_rate': 0.0001225630610999434, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.38it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.32it/s]                                               {'loss': 2.4623, 'grad_norm': 4.929624080657959, 'learning_rate': 0.0001183367486482212, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.32it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s]                                               {'loss': 2.379, 'grad_norm': 3.9654364585876465, 'learning_rate': 0.00011411043619649904, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s]                                               {'loss': 2.2273, 'grad_norm': 3.4079294204711914, 'learning_rate': 0.00010988412374477684, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s] 40%|████      | 16/40 [00:06<00:08,  2.80it/s]                                               {'loss': 2.5445, 'grad_norm': 11.328295707702637, 'learning_rate': 0.00010565781129305465, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.319, 'grad_norm': 4.1518354415893555, 'learning_rate': 0.00010143149884133247, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s]                                               {'loss': 2.2493, 'grad_norm': 3.0467514991760254, 'learning_rate': 9.720518638961028e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.34it/s]                                               {'loss': 2.1939, 'grad_norm': 3.195375442504883, 'learning_rate': 9.297887393788811e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.34it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.3336, 'grad_norm': 2.8695874214172363, 'learning_rate': 8.875256148616592e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.24it/s]                                               {'loss': 2.3221, 'grad_norm': 3.036240816116333, 'learning_rate': 8.452624903444373e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.24it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.20it/s]                                               {'loss': 2.1563, 'grad_norm': 3.1283693313598633, 'learning_rate': 8.029993658272153e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.20it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.18it/s]                                               {'loss': 2.2472, 'grad_norm': 3.363384485244751, 'learning_rate': 7.607362413099935e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.18it/s] 60%|██████    | 24/40 [00:09<00:05,  2.81it/s]                                               {'loss': 2.3486, 'grad_norm': 14.779457092285156, 'learning_rate': 7.184731167927716e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s]                                               {'loss': 2.1977, 'grad_norm': 3.37308931350708, 'learning_rate': 6.762099922755498e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.40it/s]                                               {'loss': 2.422, 'grad_norm': 2.906879186630249, 'learning_rate': 6.33946867758328e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.40it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.3225, 'grad_norm': 2.852219343185425, 'learning_rate': 5.91683743241106e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s] 70%|███████   | 28/40 [00:11<00:04,  2.41it/s]                                               {'loss': 2.2366, 'grad_norm': 2.88618803024292, 'learning_rate': 5.494206187238842e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.41it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.44it/s]                                               {'loss': 2.2314, 'grad_norm': 3.0678234100341797, 'learning_rate': 5.0715749420666235e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.44it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.47it/s]                                               {'loss': 2.2884, 'grad_norm': 3.2690482139587402, 'learning_rate': 4.6489436968944056e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.47it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.48it/s]                                               {'loss': 2.2853, 'grad_norm': 3.072171688079834, 'learning_rate': 4.226312451722186e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.48it/s] 80%|████████  | 32/40 [00:12<00:02,  3.19it/s]                                               {'loss': 1.2128, 'grad_norm': 10.40343189239502, 'learning_rate': 3.8036812065499676e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  3.19it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.98it/s]                                               {'loss': 2.2972, 'grad_norm': 3.300065040588379, 'learning_rate': 3.381049961377749e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.98it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.70it/s]                                               {'loss': 2.244, 'grad_norm': 3.5042951107025146, 'learning_rate': 2.95841871620553e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.70it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.51it/s]                                               {'loss': 2.1551, 'grad_norm': 2.5521860122680664, 'learning_rate': 2.5357874710333118e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.51it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s]                                               {'loss': 2.3143, 'grad_norm': 3.5179684162139893, 'learning_rate': 2.113156225861093e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s]                                               {'loss': 2.3758, 'grad_norm': 2.8915698528289795, 'learning_rate': 1.6905249806888745e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s]                                               {'loss': 2.1458, 'grad_norm': 4.7062668800354, 'learning_rate': 1.2678937355166559e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]                                               {'loss': 2.1997, 'grad_norm': 2.825054883956909, 'learning_rate': 8.452624903444373e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'loss': 2.4176, 'grad_norm': 15.400044441223145, 'learning_rate': 4.226312451722186e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'train_runtime': 16.3785, 'train_samples_per_second': 34.496, 'train_steps_per_second': 2.442, 'train_loss': 2.3086786776781083, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]100%|██████████| 40/40 [00:16<00:00,  2.44it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:48,  9.57it/s]  1%|          | 3/471 [00:00<01:11,  6.51it/s]  1%|          | 4/471 [00:00<01:21,  5.70it/s]  1%|          | 5/471 [00:00<01:28,  5.25it/s]  1%|▏         | 6/471 [00:01<01:31,  5.08it/s]  1%|▏         | 7/471 [00:01<01:37,  4.77it/s]  2%|▏         | 8/471 [00:01<01:36,  4.81it/s]  2%|▏         | 9/471 [00:01<01:41,  4.53it/s]  2%|▏         | 10/471 [00:01<01:36,  4.79it/s]  2%|▏         | 11/471 [00:02<01:43,  4.44it/s]  3%|▎         | 12/471 [00:02<01:35,  4.83it/s]  3%|▎         | 13/471 [00:02<01:42,  4.47it/s]  3%|▎         | 14/471 [00:02<01:38,  4.66it/s]  3%|▎         | 15/471 [00:03<01:42,  4.44it/s]  3%|▎         | 16/471 [00:03<01:39,  4.57it/s]  4%|▎         | 17/471 [00:03<01:40,  4.50it/s]  4%|▍         | 18/471 [00:03<01:40,  4.50it/s]  4%|▍         | 19/471 [00:03<01:39,  4.53it/s]  4%|▍         | 20/471 [00:04<01:39,  4.51it/s]  4%|▍         | 21/471 [00:04<01:37,  4.62it/s]  5%|▍         | 22/471 [00:04<01:38,  4.55it/s]  5%|▍         | 23/471 [00:04<01:35,  4.68it/s]  5%|▌         | 24/471 [00:05<01:40,  4.46it/s]  5%|▌         | 25/471 [00:05<01:33,  4.76it/s]  6%|▌         | 26/471 [00:05<01:40,  4.43it/s]  6%|▌         | 27/471 [00:05<01:32,  4.78it/s]  6%|▌         | 28/471 [00:05<01:39,  4.43it/s]  6%|▌         | 29/471 [00:06<01:35,  4.64it/s]  6%|▋         | 30/471 [00:06<01:37,  4.54it/s]  7%|▋         | 31/471 [00:06<01:36,  4.54it/s]  7%|▋         | 32/471 [00:06<01:36,  4.56it/s]  7%|▋         | 33/471 [00:07<01:36,  4.52it/s]  7%|▋         | 34/471 [00:07<01:35,  4.60it/s]  7%|▋         | 35/471 [00:07<01:36,  4.53it/s]  8%|▊         | 36/471 [00:07<01:33,  4.68it/s]  8%|▊         | 37/471 [00:07<01:35,  4.53it/s]  8%|▊         | 38/471 [00:08<01:33,  4.62it/s]  8%|▊         | 39/471 [00:08<01:36,  4.50it/s]  8%|▊         | 40/471 [00:08<01:33,  4.61it/s]  9%|▊         | 41/471 [00:08<01:36,  4.45it/s]  9%|▉         | 42/471 [00:08<01:33,  4.56it/s]  9%|▉         | 43/471 [00:09<01:36,  4.42it/s]  9%|▉         | 44/471 [00:09<01:32,  4.64it/s] 10%|▉         | 45/471 [00:09<01:34,  4.49it/s] 10%|▉         | 46/471 [00:09<01:31,  4.64it/s] 10%|▉         | 47/471 [00:10<01:36,  4.41it/s] 10%|█         | 48/471 [00:10<01:30,  4.65it/s] 10%|█         | 49/471 [00:10<01:33,  4.49it/s] 11%|█         | 50/471 [00:10<01:30,  4.64it/s] 11%|█         | 51/471 [00:10<01:32,  4.54it/s] 11%|█         | 52/471 [00:11<01:33,  4.50it/s] 11%|█▏        | 53/471 [00:11<01:29,  4.66it/s] 11%|█▏        | 54/471 [00:11<01:33,  4.46it/s] 12%|█▏        | 55/471 [00:11<01:29,  4.65it/s] 12%|█▏        | 56/471 [00:12<01:33,  4.44it/s] 12%|█▏        | 57/471 [00:12<01:30,  4.59it/s] 12%|█▏        | 58/471 [00:12<01:32,  4.44it/s] 13%|█▎        | 59/471 [00:12<01:28,  4.68it/s] 13%|█▎        | 60/471 [00:12<01:32,  4.42it/s] 13%|█▎        | 61/471 [00:13<01:26,  4.77it/s] 13%|█▎        | 62/471 [00:13<01:31,  4.46it/s] 13%|█▎        | 63/471 [00:13<01:27,  4.66it/s] 14%|█▎        | 64/471 [00:13<01:29,  4.56it/s] 14%|█▍        | 65/471 [00:14<01:30,  4.50it/s] 14%|█▍        | 66/471 [00:14<01:26,  4.66it/s] 14%|█▍        | 67/471 [00:14<01:29,  4.53it/s] 14%|█▍        | 68/471 [00:14<01:22,  4.88it/s] 15%|█▍        | 69/471 [00:14<01:28,  4.56it/s] 15%|█▍        | 70/471 [00:15<01:22,  4.84it/s] 15%|█▌        | 71/471 [00:15<01:28,  4.52it/s] 15%|█▌        | 72/471 [00:15<01:22,  4.84it/s] 15%|█▌        | 73/471 [00:15<01:26,  4.58it/s] 16%|█▌        | 74/471 [00:15<01:25,  4.67it/s] 16%|█▌        | 75/471 [00:16<01:25,  4.61it/s] 16%|█▌        | 76/471 [00:16<01:26,  4.56it/s] 16%|█▋        | 77/471 [00:16<01:23,  4.73it/s] 17%|█▋        | 78/471 [00:16<01:25,  4.61it/s] 17%|█▋        | 79/471 [00:16<01:19,  4.90it/s] 17%|█▋        | 80/471 [00:17<01:24,  4.65it/s] 17%|█▋        | 81/471 [00:17<01:21,  4.80it/s] 17%|█▋        | 82/471 [00:17<01:25,  4.54it/s] 18%|█▊        | 83/471 [00:17<01:21,  4.78it/s] 18%|█▊        | 84/471 [00:18<01:25,  4.54it/s] 18%|█▊        | 85/471 [00:18<01:22,  4.68it/s] 18%|█▊        | 86/471 [00:18<01:25,  4.49it/s] 18%|█▊        | 87/471 [00:18<01:23,  4.59it/s] 19%|█▊        | 88/471 [00:18<01:24,  4.52it/s] 19%|█▉        | 89/471 [00:19<01:22,  4.61it/s] 19%|█▉        | 90/471 [00:19<01:25,  4.47it/s] 19%|█▉        | 91/471 [00:19<01:22,  4.59it/s] 20%|█▉        | 92/471 [00:19<01:23,  4.53it/s] 20%|█▉        | 93/471 [00:20<01:22,  4.58it/s] 20%|█▉        | 94/471 [00:20<01:22,  4.58it/s] 20%|██        | 95/471 [00:20<01:22,  4.56it/s] 20%|██        | 96/471 [00:20<01:21,  4.62it/s] 21%|██        | 97/471 [00:20<01:22,  4.51it/s] 21%|██        | 98/471 [00:21<01:20,  4.62it/s] 21%|██        | 99/471 [00:21<01:23,  4.47it/s] 21%|██        | 100/471 [00:21<01:20,  4.60it/s] 21%|██▏       | 101/471 [00:21<01:23,  4.45it/s] 22%|██▏       | 102/471 [00:22<01:19,  4.66it/s] 22%|██▏       | 103/471 [00:22<01:24,  4.37it/s] 22%|██▏       | 104/471 [00:22<01:18,  4.68it/s] 22%|██▏       | 105/471 [00:22<01:23,  4.37it/s] 23%|██▎       | 106/471 [00:22<01:16,  4.74it/s] 23%|██▎       | 107/471 [00:23<01:21,  4.48it/s] 23%|██▎       | 108/471 [00:23<01:18,  4.64it/s] 23%|██▎       | 109/471 [00:23<01:19,  4.56it/s] 23%|██▎       | 110/471 [00:23<01:19,  4.53it/s] 24%|██▎       | 111/471 [00:24<01:18,  4.58it/s] 24%|██▍       | 112/471 [00:24<01:19,  4.50it/s] 24%|██▍       | 113/471 [00:24<01:17,  4.63it/s] 24%|██▍       | 114/471 [00:24<01:17,  4.63it/s] 24%|██▍       | 115/471 [00:24<01:16,  4.64it/s] 25%|██▍       | 116/471 [00:25<01:18,  4.52it/s] 25%|██▍       | 117/471 [00:25<01:16,  4.61it/s] 25%|██▌       | 118/471 [00:25<01:19,  4.47it/s] 25%|██▌       | 119/471 [00:25<01:14,  4.74it/s] 25%|██▌       | 120/471 [00:26<01:18,  4.49it/s] 26%|██▌       | 121/471 [00:26<01:14,  4.72it/s] 26%|██▌       | 122/471 [00:26<01:18,  4.45it/s] 26%|██▌       | 123/471 [00:26<01:14,  4.66it/s] 26%|██▋       | 124/471 [00:26<01:18,  4.44it/s] 27%|██▋       | 125/471 [00:27<01:15,  4.60it/s] 27%|██▋       | 126/471 [00:27<01:17,  4.43it/s] 27%|██▋       | 127/471 [00:27<01:15,  4.58it/s] 27%|██▋       | 128/471 [00:27<01:15,  4.55it/s] 27%|██▋       | 129/471 [00:27<01:14,  4.57it/s] 28%|██▊       | 130/471 [00:28<01:15,  4.54it/s] 28%|██▊       | 131/471 [00:28<01:15,  4.48it/s] 28%|██▊       | 132/471 [00:28<01:13,  4.63it/s] 28%|██▊       | 133/471 [00:28<01:16,  4.43it/s] 28%|██▊       | 134/471 [00:29<01:12,  4.62it/s] 29%|██▊       | 135/471 [00:29<01:15,  4.42it/s] 29%|██▉       | 136/471 [00:29<01:12,  4.65it/s] 29%|██▉       | 137/471 [00:29<01:14,  4.48it/s] 29%|██▉       | 138/471 [00:29<01:10,  4.71it/s] 30%|██▉       | 139/471 [00:30<01:14,  4.44it/s] 30%|██▉       | 140/471 [00:30<01:10,  4.69it/s] 30%|██▉       | 141/471 [00:30<01:14,  4.45it/s] 30%|███       | 142/471 [00:30<01:11,  4.63it/s] 30%|███       | 143/471 [00:31<01:11,  4.56it/s] 31%|███       | 144/471 [00:31<01:12,  4.52it/s] 31%|███       | 145/471 [00:31<01:12,  4.53it/s] 31%|███       | 146/471 [00:31<01:12,  4.46it/s] 31%|███       | 147/471 [00:31<01:08,  4.76it/s] 31%|███▏      | 148/471 [00:32<01:11,  4.52it/s] 32%|███▏      | 149/471 [00:32<01:09,  4.64it/s] 32%|███▏      | 150/471 [00:32<01:11,  4.47it/s] 32%|███▏      | 151/471 [00:32<01:08,  4.70it/s] 32%|███▏      | 152/471 [00:33<01:11,  4.44it/s] 32%|███▏      | 153/471 [00:33<01:07,  4.71it/s] 33%|███▎      | 154/471 [00:33<01:11,  4.41it/s] 33%|███▎      | 155/471 [00:33<01:07,  4.69it/s] 33%|███▎      | 156/471 [00:33<01:09,  4.51it/s] 33%|███▎      | 157/471 [00:34<01:07,  4.63it/s] 34%|███▎      | 158/471 [00:34<01:08,  4.59it/s] 34%|███▍      | 159/471 [00:34<01:08,  4.53it/s] 34%|███▍      | 160/471 [00:34<01:06,  4.70it/s] 34%|███▍      | 161/471 [00:34<01:08,  4.50it/s] 34%|███▍      | 162/471 [00:35<01:06,  4.67it/s] 35%|███▍      | 163/471 [00:35<01:09,  4.46it/s] 35%|███▍      | 164/471 [00:35<01:05,  4.70it/s] 35%|███▌      | 165/471 [00:35<01:07,  4.51it/s] 35%|███▌      | 166/471 [00:36<01:04,  4.74it/s] 35%|███▌      | 167/471 [00:36<01:08,  4.45it/s] 36%|███▌      | 168/471 [00:36<01:03,  4.74it/s] 36%|███▌      | 169/471 [00:36<01:07,  4.45it/s] 36%|███▌      | 170/471 [00:36<01:04,  4.68it/s] 36%|███▋      | 171/471 [00:37<01:05,  4.57it/s] 37%|███▋      | 172/471 [00:37<01:06,  4.53it/s] 37%|███▋      | 173/471 [00:37<01:03,  4.66it/s] 37%|███▋      | 174/471 [00:37<01:05,  4.56it/s] 37%|███▋      | 175/471 [00:38<01:02,  4.71it/s] 37%|███▋      | 176/471 [00:38<01:05,  4.49it/s] 38%|███▊      | 177/471 [00:38<01:03,  4.65it/s] 38%|███▊      | 178/471 [00:38<01:04,  4.57it/s] 38%|███▊      | 179/471 [00:38<01:03,  4.60it/s] 38%|███▊      | 180/471 [00:39<01:04,  4.51it/s] 38%|███▊      | 181/471 [00:39<01:03,  4.59it/s] 39%|███▊      | 182/471 [00:39<01:05,  4.41it/s] 39%|███▉      | 183/471 [00:39<01:01,  4.68it/s] 39%|███▉      | 184/471 [00:40<01:04,  4.45it/s] 39%|███▉      | 185/471 [00:40<01:00,  4.73it/s] 39%|███▉      | 186/471 [00:40<01:03,  4.48it/s] 40%|███▉      | 187/471 [00:40<01:01,  4.59it/s] 40%|███▉      | 188/471 [00:40<01:03,  4.47it/s] 40%|████      | 189/471 [00:41<01:01,  4.59it/s] 40%|████      | 190/471 [00:41<01:01,  4.57it/s] 41%|████      | 191/471 [00:41<01:01,  4.55it/s] 41%|████      | 192/471 [00:41<01:01,  4.51it/s] 41%|████      | 193/471 [00:41<01:01,  4.54it/s] 41%|████      | 194/471 [00:42<01:00,  4.58it/s] 41%|████▏     | 195/471 [00:42<01:01,  4.50it/s] 42%|████▏     | 196/471 [00:42<00:59,  4.65it/s] 42%|████▏     | 197/471 [00:42<01:01,  4.44it/s] 42%|████▏     | 198/471 [00:43<00:57,  4.77it/s] 42%|████▏     | 199/471 [00:43<01:01,  4.44it/s] 42%|████▏     | 200/471 [00:43<00:56,  4.78it/s] 43%|████▎     | 201/471 [00:43<01:00,  4.48it/s] 43%|████▎     | 202/471 [00:43<00:57,  4.69it/s] 43%|████▎     | 203/471 [00:44<01:00,  4.43it/s] 43%|████▎     | 204/471 [00:44<00:57,  4.65it/s] 44%|████▎     | 205/471 [00:44<00:58,  4.51it/s] 44%|████▎     | 206/471 [00:44<00:57,  4.62it/s] 44%|████▍     | 207/471 [00:45<00:57,  4.60it/s] 44%|████▍     | 208/471 [00:45<00:57,  4.57it/s] 44%|████▍     | 209/471 [00:45<00:56,  4.62it/s] 45%|████▍     | 210/471 [00:45<00:57,  4.51it/s] 45%|████▍     | 211/471 [00:45<00:54,  4.78it/s] 45%|████▌     | 212/471 [00:46<00:57,  4.52it/s] 45%|████▌     | 213/471 [00:46<00:53,  4.84it/s] 45%|████▌     | 214/471 [00:46<00:57,  4.48it/s] 46%|████▌     | 215/471 [00:46<00:53,  4.78it/s] 46%|████▌     | 216/471 [00:47<00:56,  4.48it/s] 46%|████▌     | 217/471 [00:47<00:54,  4.67it/s] 46%|████▋     | 218/471 [00:47<00:56,  4.48it/s] 46%|████▋     | 219/471 [00:47<00:54,  4.60it/s] 47%|████▋     | 220/471 [00:47<00:54,  4.56it/s] 47%|████▋     | 221/471 [00:48<00:53,  4.64it/s] 47%|████▋     | 222/471 [00:48<00:54,  4.59it/s] 47%|████▋     | 223/471 [00:48<00:53,  4.62it/s] 48%|████▊     | 224/471 [00:48<00:53,  4.62it/s] 48%|████▊     | 225/471 [00:48<00:53,  4.58it/s] 48%|████▊     | 226/471 [00:49<00:52,  4.65it/s] 48%|████▊     | 227/471 [00:49<00:54,  4.50it/s] 48%|████▊     | 228/471 [00:49<00:52,  4.63it/s] 49%|████▊     | 229/471 [00:49<00:53,  4.55it/s] 49%|████▉     | 230/471 [00:50<00:52,  4.58it/s] 49%|████▉     | 231/471 [00:50<00:52,  4.55it/s] 49%|████▉     | 232/471 [00:50<00:51,  4.63it/s] 49%|████▉     | 233/471 [00:50<00:53,  4.44it/s] 50%|████▉     | 234/471 [00:50<00:51,  4.63it/s] 50%|████▉     | 235/471 [00:51<00:53,  4.43it/s] 50%|█████     | 236/471 [00:51<00:50,  4.69it/s] 50%|█████     | 237/471 [00:51<00:53,  4.40it/s] 51%|█████     | 238/471 [00:51<00:50,  4.62it/s] 51%|█████     | 239/471 [00:52<00:52,  4.41it/s] 51%|█████     | 240/471 [00:52<00:49,  4.68it/s] 51%|█████     | 241/471 [00:52<00:51,  4.47it/s] 51%|█████▏    | 242/471 [00:52<00:49,  4.67it/s] 52%|█████▏    | 243/471 [00:52<00:50,  4.48it/s] 52%|█████▏    | 244/471 [00:53<00:48,  4.63it/s] 52%|█████▏    | 245/471 [00:53<00:49,  4.58it/s] 52%|█████▏    | 246/471 [00:53<00:49,  4.54it/s] 52%|█████▏    | 247/471 [00:53<00:48,  4.67it/s] 53%|█████▎    | 248/471 [00:53<00:49,  4.53it/s] 53%|█████▎    | 249/471 [00:54<00:45,  4.85it/s] 53%|█████▎    | 250/471 [00:54<00:48,  4.57it/s] 53%|█████▎    | 251/471 [00:54<00:44,  4.98it/s] 54%|█████▎    | 252/471 [00:54<00:48,  4.56it/s] 54%|█████▎    | 253/471 [00:55<00:45,  4.81it/s] 54%|█████▍    | 254/471 [00:55<00:46,  4.66it/s] 54%|█████▍    | 255/471 [00:55<00:46,  4.66it/s] 54%|█████▍    | 256/471 [00:55<00:45,  4.69it/s] 55%|█████▍    | 257/471 [00:55<00:46,  4.64it/s] 55%|█████▍    | 258/471 [00:56<00:45,  4.66it/s] 55%|█████▍    | 259/471 [00:56<00:45,  4.63it/s] 55%|█████▌    | 260/471 [00:56<00:45,  4.65it/s] 55%|█████▌    | 261/471 [00:56<00:46,  4.54it/s] 56%|█████▌    | 262/471 [00:56<00:45,  4.61it/s] 56%|█████▌    | 263/471 [00:57<00:46,  4.47it/s] 56%|█████▌    | 264/471 [00:57<00:43,  4.72it/s] 56%|█████▋    | 265/471 [00:57<00:45,  4.50it/s] 56%|█████▋    | 266/471 [00:57<00:43,  4.70it/s] 57%|█████▋    | 267/471 [00:58<00:46,  4.43it/s] 57%|█████▋    | 268/471 [00:58<00:43,  4.65it/s] 57%|█████▋    | 269/471 [00:58<00:45,  4.44it/s] 57%|█████▋    | 270/471 [00:58<00:43,  4.63it/s] 58%|█████▊    | 271/471 [00:58<00:44,  4.51it/s] 58%|█████▊    | 272/471 [00:59<00:42,  4.64it/s] 58%|█████▊    | 273/471 [00:59<00:43,  4.60it/s] 58%|█████▊    | 274/471 [00:59<00:42,  4.60it/s] 58%|█████▊    | 275/471 [00:59<00:42,  4.62it/s] 59%|█████▊    | 276/471 [01:00<00:43,  4.52it/s] 59%|█████▉    | 277/471 [01:00<00:41,  4.68it/s] 59%|█████▉    | 278/471 [01:00<00:43,  4.47it/s] 59%|█████▉    | 279/471 [01:00<00:40,  4.72it/s] 59%|█████▉    | 280/471 [01:00<00:42,  4.49it/s] 60%|█████▉    | 281/471 [01:01<00:40,  4.71it/s] 60%|█████▉    | 282/471 [01:01<00:41,  4.51it/s] 60%|██████    | 283/471 [01:01<00:38,  4.83it/s] 60%|██████    | 284/471 [01:01<00:41,  4.51it/s] 61%|██████    | 285/471 [01:01<00:39,  4.75it/s] 61%|██████    | 286/471 [01:02<00:40,  4.57it/s] 61%|██████    | 287/471 [01:02<00:39,  4.66it/s] 61%|██████    | 288/471 [01:02<00:39,  4.67it/s] 61%|██████▏   | 289/471 [01:02<00:39,  4.56it/s] 62%|██████▏   | 290/471 [01:03<00:37,  4.77it/s] 62%|██████▏   | 291/471 [01:03<00:39,  4.52it/s] 62%|██████▏   | 292/471 [01:03<00:36,  4.86it/s] 62%|██████▏   | 293/471 [01:03<00:38,  4.57it/s] 62%|██████▏   | 294/471 [01:03<00:35,  4.92it/s] 63%|██████▎   | 295/471 [01:04<00:38,  4.56it/s] 63%|██████▎   | 296/471 [01:04<00:36,  4.80it/s] 63%|██████▎   | 297/471 [01:04<00:37,  4.63it/s] 63%|██████▎   | 298/471 [01:04<00:37,  4.59it/s] 63%|██████▎   | 299/471 [01:04<00:37,  4.64it/s] 64%|██████▎   | 300/471 [01:05<00:37,  4.57it/s] 64%|██████▍   | 301/471 [01:05<00:35,  4.75it/s] 64%|██████▍   | 302/471 [01:05<00:36,  4.63it/s] 64%|██████▍   | 303/471 [01:05<00:34,  4.87it/s] 65%|██████▍   | 304/471 [01:06<00:37,  4.50it/s] 65%|██████▍   | 305/471 [01:06<00:33,  4.95it/s] 65%|██████▍   | 306/471 [01:06<00:36,  4.54it/s] 65%|██████▌   | 307/471 [01:06<00:33,  4.83it/s] 65%|██████▌   | 308/471 [01:06<00:34,  4.70it/s] 66%|██████▌   | 309/471 [01:07<00:35,  4.58it/s] 66%|██████▌   | 310/471 [01:07<00:33,  4.84it/s] 66%|██████▌   | 311/471 [01:07<00:34,  4.64it/s] 66%|██████▌   | 312/471 [01:07<00:32,  4.88it/s] 66%|██████▋   | 313/471 [01:07<00:34,  4.62it/s] 67%|██████▋   | 314/471 [01:08<00:31,  4.97it/s] 67%|██████▋   | 315/471 [01:08<00:33,  4.60it/s] 67%|██████▋   | 316/471 [01:08<00:31,  4.86it/s] 67%|██████▋   | 317/471 [01:08<00:33,  4.66it/s] 68%|██████▊   | 318/471 [01:09<00:32,  4.67it/s] 68%|██████▊   | 319/471 [01:09<00:31,  4.86it/s] 68%|██████▊   | 320/471 [01:09<00:32,  4.71it/s] 68%|██████▊   | 321/471 [01:09<00:31,  4.80it/s] 68%|██████▊   | 322/471 [01:09<00:32,  4.62it/s] 69%|██████▊   | 323/471 [01:10<00:30,  4.78it/s] 69%|██████▉   | 324/471 [01:10<00:32,  4.59it/s] 69%|██████▉   | 325/471 [01:10<00:30,  4.82it/s] 69%|██████▉   | 326/471 [01:10<00:31,  4.62it/s] 69%|██████▉   | 327/471 [01:10<00:31,  4.64it/s] 70%|██████▉   | 328/471 [01:11<00:30,  4.69it/s] 70%|██████▉   | 329/471 [01:11<00:31,  4.57it/s] 70%|███████   | 330/471 [01:11<00:29,  4.79it/s] 70%|███████   | 331/471 [01:11<00:30,  4.60it/s] 70%|███████   | 332/471 [01:11<00:29,  4.72it/s] 71%|███████   | 333/471 [01:12<00:29,  4.60it/s] 71%|███████   | 334/471 [01:12<00:28,  4.73it/s] 71%|███████   | 335/471 [01:12<00:30,  4.51it/s] 71%|███████▏  | 336/471 [01:12<00:28,  4.79it/s] 72%|███████▏  | 337/471 [01:13<00:29,  4.52it/s] 72%|███████▏  | 338/471 [01:13<00:28,  4.73it/s] 72%|███████▏  | 339/471 [01:13<00:28,  4.57it/s] 72%|███████▏  | 340/471 [01:13<00:28,  4.54it/s] 72%|███████▏  | 341/471 [01:13<00:27,  4.69it/s] 73%|███████▎  | 342/471 [01:14<00:28,  4.55it/s] 73%|███████▎  | 343/471 [01:14<00:27,  4.72it/s] 73%|███████▎  | 344/471 [01:14<00:28,  4.49it/s] 73%|███████▎  | 345/471 [01:14<00:26,  4.71it/s] 73%|███████▎  | 346/471 [01:15<00:27,  4.52it/s] 74%|███████▎  | 347/471 [01:15<00:25,  4.83it/s] 74%|███████▍  | 348/471 [01:15<00:27,  4.52it/s] 74%|███████▍  | 349/471 [01:15<00:25,  4.86it/s] 74%|███████▍  | 350/471 [01:15<00:26,  4.50it/s] 75%|███████▍  | 351/471 [01:16<00:25,  4.72it/s] 75%|███████▍  | 352/471 [01:16<00:25,  4.59it/s] 75%|███████▍  | 353/471 [01:16<00:25,  4.54it/s] 75%|███████▌  | 354/471 [01:16<00:24,  4.71it/s] 75%|███████▌  | 355/471 [01:16<00:25,  4.56it/s] 76%|███████▌  | 356/471 [01:17<00:23,  4.99it/s] 76%|███████▌  | 357/471 [01:17<00:24,  4.64it/s] 76%|███████▌  | 358/471 [01:17<00:22,  5.08it/s] 76%|███████▌  | 359/471 [01:17<00:23,  4.69it/s] 76%|███████▋  | 360/471 [01:17<00:23,  4.76it/s] 77%|███████▋  | 361/471 [01:18<00:23,  4.69it/s] 77%|███████▋  | 362/471 [01:18<00:23,  4.57it/s] 77%|███████▋  | 363/471 [01:18<00:22,  4.78it/s] 77%|███████▋  | 364/471 [01:18<00:23,  4.64it/s] 77%|███████▋  | 365/471 [01:19<00:22,  4.75it/s] 78%|███████▊  | 366/471 [01:19<00:22,  4.64it/s] 78%|███████▊  | 367/471 [01:19<00:21,  4.76it/s] 78%|███████▊  | 368/471 [01:19<00:22,  4.57it/s] 78%|███████▊  | 369/471 [01:19<00:21,  4.82it/s] 79%|███████▊  | 370/471 [01:20<00:22,  4.54it/s] 79%|███████▉  | 371/471 [01:20<00:21,  4.70it/s] 79%|███████▉  | 372/471 [01:20<00:21,  4.64it/s] 79%|███████▉  | 373/471 [01:20<00:21,  4.55it/s] 79%|███████▉  | 374/471 [01:21<00:20,  4.68it/s] 80%|███████▉  | 375/471 [01:21<00:21,  4.56it/s] 80%|███████▉  | 376/471 [01:21<00:20,  4.69it/s] 80%|████████  | 377/471 [01:21<00:20,  4.59it/s] 80%|████████  | 378/471 [01:21<00:20,  4.64it/s] 80%|████████  | 379/471 [01:22<00:19,  4.62it/s] 81%|████████  | 380/471 [01:22<00:19,  4.66it/s] 81%|████████  | 381/471 [01:22<00:19,  4.63it/s] 81%|████████  | 382/471 [01:22<00:19,  4.65it/s] 81%|████████▏ | 383/471 [01:22<00:19,  4.58it/s] 82%|████████▏ | 384/471 [01:23<00:18,  4.61it/s] 82%|████████▏ | 385/471 [01:23<00:18,  4.62it/s] 82%|████████▏ | 386/471 [01:23<00:18,  4.54it/s] 82%|████████▏ | 387/471 [01:23<00:17,  4.78it/s] 82%|████████▏ | 388/471 [01:24<00:18,  4.54it/s] 83%|████████▎ | 389/471 [01:24<00:17,  4.77it/s] 83%|████████▎ | 390/471 [01:24<00:17,  4.54it/s] 83%|████████▎ | 391/471 [01:24<00:16,  4.76it/s] 83%|████████▎ | 392/471 [01:24<00:17,  4.55it/s] 83%|████████▎ | 393/471 [01:25<00:16,  4.73it/s] 84%|████████▎ | 394/471 [01:25<00:16,  4.58it/s] 84%|████████▍ | 395/471 [01:25<00:16,  4.69it/s] 84%|████████▍ | 396/471 [01:25<00:16,  4.55it/s] 84%|████████▍ | 397/471 [01:25<00:16,  4.58it/s] 85%|████████▍ | 398/471 [01:26<00:15,  4.67it/s] 85%|████████▍ | 399/471 [01:26<00:15,  4.58it/s] 85%|████████▍ | 400/471 [01:26<00:15,  4.61it/s] 85%|████████▌ | 401/471 [01:26<00:15,  4.49it/s] 85%|████████▌ | 402/471 [01:27<00:14,  4.67it/s] 86%|████████▌ | 403/471 [01:27<00:15,  4.53it/s] 86%|████████▌ | 404/471 [01:27<00:14,  4.72it/s] 86%|████████▌ | 405/471 [01:27<00:14,  4.56it/s] 86%|████████▌ | 406/471 [01:27<00:13,  4.69it/s] 86%|████████▋ | 407/471 [01:28<00:13,  4.58it/s] 87%|████████▋ | 408/471 [01:28<00:13,  4.67it/s] 87%|████████▋ | 409/471 [01:28<00:13,  4.53it/s] 87%|████████▋ | 410/471 [01:28<00:13,  4.57it/s] 87%|████████▋ | 411/471 [01:29<00:13,  4.60it/s] 87%|████████▋ | 412/471 [01:29<00:12,  4.55it/s] 88%|████████▊ | 413/471 [01:29<00:12,  4.68it/s] 88%|████████▊ | 414/471 [01:29<00:12,  4.58it/s] 88%|████████▊ | 415/471 [01:29<00:11,  4.77it/s] 88%|████████▊ | 416/471 [01:30<00:12,  4.52it/s] 89%|████████▊ | 417/471 [01:30<00:11,  4.87it/s] 89%|████████▊ | 418/471 [01:30<00:11,  4.53it/s] 89%|████████▉ | 419/471 [01:30<00:10,  4.79it/s] 89%|████████▉ | 420/471 [01:30<00:11,  4.53it/s] 89%|████████▉ | 421/471 [01:31<00:10,  4.70it/s] 90%|████████▉ | 422/471 [01:31<00:10,  4.56it/s] 90%|████████▉ | 423/471 [01:31<00:10,  4.61it/s] 90%|█████████ | 424/471 [01:31<00:10,  4.60it/s] 90%|█████████ | 425/471 [01:32<00:10,  4.54it/s] 90%|█████████ | 426/471 [01:32<00:09,  4.77it/s] 91%|█████████ | 427/471 [01:32<00:09,  4.57it/s] 91%|█████████ | 428/471 [01:32<00:08,  4.85it/s] 91%|█████████ | 429/471 [01:32<00:09,  4.56it/s] 91%|█████████▏| 430/471 [01:33<00:08,  5.04it/s] 92%|█████████▏| 431/471 [01:33<00:08,  4.58it/s] 92%|█████████▏| 432/471 [01:33<00:08,  4.78it/s] 92%|█████████▏| 433/471 [01:33<00:08,  4.68it/s] 92%|█████████▏| 434/471 [01:33<00:08,  4.55it/s] 92%|█████████▏| 435/471 [01:34<00:07,  4.88it/s] 93%|█████████▎| 436/471 [01:34<00:07,  4.59it/s] 93%|█████████▎| 437/471 [01:34<00:06,  5.17it/s] 93%|█████████▎| 438/471 [01:34<00:07,  4.67it/s] 93%|█████████▎| 439/471 [01:34<00:06,  4.93it/s] 93%|█████████▎| 440/471 [01:35<00:06,  4.70it/s] 94%|█████████▎| 441/471 [01:35<00:06,  4.68it/s] 94%|█████████▍| 442/471 [01:35<00:05,  4.93it/s] 94%|█████████▍| 443/471 [01:35<00:05,  4.70it/s] 94%|█████████▍| 444/471 [01:35<00:05,  4.98it/s] 94%|█████████▍| 445/471 [01:36<00:05,  4.69it/s] 95%|█████████▍| 446/471 [01:36<00:04,  5.09it/s] 95%|█████████▍| 447/471 [01:36<00:05,  4.63it/s] 95%|█████████▌| 448/471 [01:36<00:04,  4.84it/s] 95%|█████████▌| 449/471 [01:37<00:04,  4.66it/s] 96%|█████████▌| 450/471 [01:37<00:04,  4.66it/s] 96%|█████████▌| 451/471 [01:37<00:04,  4.83it/s] 96%|█████████▌| 452/471 [01:37<00:04,  4.64it/s] 96%|█████████▌| 453/471 [01:37<00:03,  4.95it/s] 96%|█████████▋| 454/471 [01:38<00:03,  4.62it/s] 97%|█████████▋| 455/471 [01:38<00:03,  5.10it/s] 97%|█████████▋| 456/471 [01:38<00:03,  4.64it/s] 97%|█████████▋| 457/471 [01:38<00:02,  4.77it/s] 97%|█████████▋| 458/471 [01:38<00:02,  4.68it/s] 97%|█████████▋| 459/471 [01:39<00:02,  4.56it/s] 98%|█████████▊| 460/471 [01:39<00:02,  4.74it/s] 98%|█████████▊| 461/471 [01:39<00:02,  4.59it/s] 98%|█████████▊| 462/471 [01:39<00:01,  4.86it/s] 98%|█████████▊| 463/471 [01:40<00:01,  4.69it/s] 99%|█████████▊| 464/471 [01:40<00:01,  4.71it/s] 99%|█████████▊| 465/471 [01:40<00:01,  4.60it/s] 99%|█████████▉| 466/471 [01:40<00:01,  4.70it/s] 99%|█████████▉| 467/471 [01:40<00:00,  4.52it/s] 99%|█████████▉| 468/471 [01:41<00:00,  4.75it/s]100%|█████████▉| 469/471 [01:41<00:00,  4.50it/s]100%|█████████▉| 470/471 [01:41<00:00,  4.75it/s]100%|██████████| 471/471 [01:41<00:00,  4.88it/s]100%|██████████| 471/471 [01:41<00:00,  4.63it/s]
{'eval_loss': 2.3412797451019287, 'eval_model_preparation_time': 0.0047, 'eval_acc': 0.4480881571959639, 'eval_runtime': 101.9475, 'eval_samples_per_second': 73.881, 'eval_steps_per_second': 4.62}
ROUND:7
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.32it/s]                                              {'loss': 2.4754, 'grad_norm': 3.5772199630737305, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.32it/s]  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.3345, 'grad_norm': 3.4155256748199463, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]  8%|▊         | 3/40 [00:01<00:17,  2.17it/s]                                              {'loss': 2.4757, 'grad_norm': 3.6085007190704346, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.17it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.3168, 'grad_norm': 3.648062229156494, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s]                                              {'loss': 2.3701, 'grad_norm': 3.7293577194213867, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s]                                              {'loss': 2.3181, 'grad_norm': 3.079511880874634, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s]                                              {'loss': 2.3227, 'grad_norm': 3.078070640563965, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s] 20%|██        | 8/40 [00:03<00:11,  2.81it/s]                                              {'loss': 1.642, 'grad_norm': 8.07600212097168, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.81it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.2082, 'grad_norm': 3.1986641883850098, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.50it/s]                                               {'loss': 2.2079, 'grad_norm': 3.137007474899292, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.50it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s]                                               {'loss': 2.3458, 'grad_norm': 3.616725444793701, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s] 30%|███       | 12/40 [00:05<00:11,  2.43it/s]                                               {'loss': 2.2294, 'grad_norm': 3.5748488903045654, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.43it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.45it/s]                                               {'loss': 2.4029, 'grad_norm': 3.5723628997802734, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.45it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.46it/s]                                               {'loss': 2.2801, 'grad_norm': 3.273632287979126, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.46it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.48it/s]                                               {'loss': 2.2784, 'grad_norm': 5.049951553344727, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.48it/s]                                               {'loss': 2.5584, 'grad_norm': 13.438872337341309, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:09,  2.48it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.23it/s]                                               {'loss': 2.1694, 'grad_norm': 3.6274774074554443, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.23it/s] 45%|████▌     | 18/40 [00:07<00:06,  3.20it/s]                                               {'loss': 2.327, 'grad_norm': 2.6513965129852295, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:06,  3.20it/s] 48%|████▊     | 19/40 [00:07<00:06,  3.19it/s]                                               {'loss': 2.2054, 'grad_norm': 2.7817351818084717, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:06,  3.19it/s] 50%|█████     | 20/40 [00:07<00:06,  3.15it/s]                                               {'loss': 2.447, 'grad_norm': 4.110494136810303, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  3.15it/s] 52%|█████▎    | 21/40 [00:07<00:06,  3.13it/s]                                               {'loss': 2.2247, 'grad_norm': 3.220501661300659, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  3.13it/s] 55%|█████▌    | 22/40 [00:08<00:05,  3.12it/s]                                               {'loss': 2.2483, 'grad_norm': 3.86434006690979, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:05,  3.12it/s] 57%|█████▊    | 23/40 [00:08<00:05,  3.09it/s]                                               {'loss': 2.2232, 'grad_norm': 3.670491933822632, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:05,  3.09it/s] 60%|██████    | 24/40 [00:08<00:04,  3.87it/s]                                               {'loss': 2.3469, 'grad_norm': 10.68603229522705, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:04,  3.87it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.18it/s]                                               {'loss': 1.973, 'grad_norm': 2.596987247467041, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.18it/s] 65%|██████▌   | 26/40 [00:09<00:04,  2.90it/s]                                               {'loss': 2.2687, 'grad_norm': 3.2990565299987793, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  2.90it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.62it/s]                                               {'loss': 2.4735, 'grad_norm': 3.2617721557617188, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.62it/s] 70%|███████   | 28/40 [00:10<00:04,  2.47it/s]                                               {'loss': 2.102, 'grad_norm': 3.3235714435577393, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.47it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.39it/s]                                               {'loss': 2.2513, 'grad_norm': 3.362962484359741, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.39it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.30it/s]                                               {'loss': 2.0736, 'grad_norm': 3.1502797603607178, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.27it/s]                                               {'loss': 2.1779, 'grad_norm': 3.144054412841797, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.27it/s] 80%|████████  | 32/40 [00:12<00:02,  2.86it/s]                                               {'loss': 2.0802, 'grad_norm': 13.59643268585205, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.86it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.61it/s]                                               {'loss': 2.4423, 'grad_norm': 3.665635108947754, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.61it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.48it/s]                                               {'loss': 2.2255, 'grad_norm': 3.1952850818634033, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.48it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.38it/s]                                               {'loss': 2.1239, 'grad_norm': 3.1781363487243652, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.31it/s]                                               {'loss': 2.2251, 'grad_norm': 3.317430019378662, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.31it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.29it/s]                                               {'loss': 2.1798, 'grad_norm': 3.3493621349334717, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.26it/s]                                               {'loss': 2.2397, 'grad_norm': 3.3886940479278564, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.26it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.25it/s]                                               {'loss': 1.9417, 'grad_norm': 4.477391242980957, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.25it/s]100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'loss': 2.2049, 'grad_norm': 12.3485689163208, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'train_runtime': 15.4773, 'train_samples_per_second': 36.505, 'train_steps_per_second': 2.584, 'train_loss': 2.2485387176275253, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]100%|██████████| 40/40 [00:15<00:00,  2.58it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.40it/s]                                              {'loss': 2.3326, 'grad_norm': 3.0883145332336426, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.40it/s]  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]                                              {'loss': 2.4177, 'grad_norm': 4.174419403076172, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]  8%|▊         | 3/40 [00:01<00:16,  2.30it/s]                                              {'loss': 2.5076, 'grad_norm': 5.1807332038879395, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.30it/s] 10%|█         | 4/40 [00:01<00:15,  2.26it/s]                                              {'loss': 2.5053, 'grad_norm': 3.5050814151763916, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.26it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.5116, 'grad_norm': 5.0945000648498535, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s]                                              {'loss': 2.4475, 'grad_norm': 4.305609703063965, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.19it/s]                                              {'loss': 2.4644, 'grad_norm': 3.762795925140381, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.19it/s] 20%|██        | 8/40 [00:03<00:11,  2.84it/s]                                              {'loss': 2.6032, 'grad_norm': 14.151618003845215, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.84it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.64it/s]                                              {'loss': 2.4131, 'grad_norm': 2.8597865104675293, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.64it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.52it/s]                                               {'loss': 2.3548, 'grad_norm': 2.881478786468506, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.52it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s]                                               {'loss': 2.2885, 'grad_norm': 2.920431137084961, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s] 30%|███       | 12/40 [00:05<00:11,  2.39it/s]                                               {'loss': 2.4606, 'grad_norm': 3.861133575439453, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.39it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.4784, 'grad_norm': 4.195275783538818, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s]                                               {'loss': 2.2017, 'grad_norm': 3.3764090538024902, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s]                                               {'loss': 2.3279, 'grad_norm': 3.2055890560150146, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 1.9829, 'grad_norm': 13.789865493774414, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.77it/s]                                               {'loss': 2.2705, 'grad_norm': 4.14109992980957, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.77it/s] 45%|████▌     | 18/40 [00:07<00:07,  2.75it/s]                                               {'loss': 2.2554, 'grad_norm': 2.906113386154175, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  2.75it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.76it/s]                                               {'loss': 2.2678, 'grad_norm': 2.750380039215088, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.76it/s] 50%|█████     | 20/40 [00:08<00:07,  2.70it/s]                                               {'loss': 2.2004, 'grad_norm': 2.5346500873565674, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.70it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.64it/s]                                               {'loss': 2.3923, 'grad_norm': 3.6772496700286865, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.64it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.59it/s]                                               {'loss': 2.1963, 'grad_norm': 4.011552333831787, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.59it/s] 57%|█████▊    | 23/40 [00:09<00:06,  2.56it/s]                                               {'loss': 2.2568, 'grad_norm': 4.916204452514648, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:06,  2.56it/s]                                               {'loss': 2.59, 'grad_norm': 13.356729507446289, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:06,  2.56it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.19it/s]                                               {'loss': 2.2322, 'grad_norm': 2.989199161529541, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.19it/s] 65%|██████▌   | 26/40 [00:10<00:04,  3.05it/s]                                               {'loss': 2.3068, 'grad_norm': 3.645425796508789, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  3.05it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.79it/s]                                               {'loss': 2.2237, 'grad_norm': 4.046492099761963, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.79it/s] 70%|███████   | 28/40 [00:10<00:04,  2.59it/s]                                               {'loss': 2.395, 'grad_norm': 3.3990399837493896, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.59it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.44it/s]                                               {'loss': 2.2739, 'grad_norm': 4.321436882019043, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.44it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.35it/s]                                               {'loss': 2.2912, 'grad_norm': 4.310610294342041, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.35it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.28it/s]                                               {'loss': 2.0606, 'grad_norm': 3.447456121444702, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.28it/s] 80%|████████  | 32/40 [00:12<00:02,  2.91it/s]                                               {'loss': 2.6488, 'grad_norm': 16.06878662109375, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.91it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.65it/s]                                               {'loss': 2.2338, 'grad_norm': 3.175373077392578, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.51it/s]                                               {'loss': 2.3022, 'grad_norm': 3.58658766746521, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.51it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.43it/s]                                               {'loss': 2.2228, 'grad_norm': 3.135425090789795, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.2684, 'grad_norm': 4.341185569763184, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s]                                               {'loss': 2.2066, 'grad_norm': 3.8014986515045166, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s]                                               {'loss': 2.0969, 'grad_norm': 3.942617177963257, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.26it/s]                                               {'loss': 2.0853, 'grad_norm': 3.442239999771118, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.26it/s]100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'loss': 2.266, 'grad_norm': 14.46281623840332, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'train_runtime': 15.8888, 'train_samples_per_second': 35.56, 'train_steps_per_second': 2.517, 'train_loss': 2.3210426211357116, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]100%|██████████| 40/40 [00:15<00:00,  2.52it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:30,  1.28it/s]                                              {'loss': 2.4768, 'grad_norm': 3.8563590049743652, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:30,  1.28it/s]  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]                                              {'loss': 2.4997, 'grad_norm': 4.216944694519043, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:25,  1.48it/s]  8%|▊         | 3/40 [00:01<00:21,  1.71it/s]                                              {'loss': 2.4885, 'grad_norm': 3.735663414001465, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:21,  1.71it/s] 10%|█         | 4/40 [00:02<00:19,  1.89it/s]                                              {'loss': 2.3349, 'grad_norm': 2.7046728134155273, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.89it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.99it/s]                                              {'loss': 2.3372, 'grad_norm': 3.423496961593628, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.99it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.06it/s]                                              {'loss': 2.4169, 'grad_norm': 3.14729642868042, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.06it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s]                                              {'loss': 2.2996, 'grad_norm': 3.028167724609375, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s] 20%|██        | 8/40 [00:04<00:13,  2.31it/s]                                              {'loss': 2.0658, 'grad_norm': 16.12542152404785, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:13,  2.31it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.31it/s]                                              {'loss': 2.3151, 'grad_norm': 2.8140270709991455, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.31it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.36it/s]                                               {'loss': 2.2097, 'grad_norm': 2.8455121517181396, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.36it/s] 28%|██▊       | 11/40 [00:05<00:12,  2.41it/s]                                               {'loss': 2.291, 'grad_norm': 2.654364585876465, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:12,  2.41it/s] 30%|███       | 12/40 [00:05<00:11,  2.44it/s]                                               {'loss': 2.2353, 'grad_norm': 3.4417009353637695, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.44it/s] 32%|███▎      | 13/40 [00:06<00:10,  2.47it/s]                                               {'loss': 2.5124, 'grad_norm': 3.4996471405029297, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:10,  2.47it/s] 35%|███▌      | 14/40 [00:06<00:10,  2.50it/s]                                               {'loss': 2.4341, 'grad_norm': 2.931530714035034, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:10,  2.50it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.52it/s]                                               {'loss': 2.3799, 'grad_norm': 3.4578540325164795, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.52it/s] 40%|████      | 16/40 [00:06<00:07,  3.23it/s]                                               {'loss': 3.651, 'grad_norm': 14.447396278381348, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.23it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.82it/s]                                               {'loss': 2.1287, 'grad_norm': 3.105376720428467, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.82it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.60it/s]                                               {'loss': 2.2625, 'grad_norm': 3.064271926879883, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.60it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.47it/s]                                               {'loss': 2.4185, 'grad_norm': 3.2689526081085205, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.47it/s] 50%|█████     | 20/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.3206, 'grad_norm': 3.5312271118164062, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.33it/s]                                               {'loss': 2.2876, 'grad_norm': 3.302107810974121, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s]                                               {'loss': 2.1534, 'grad_norm': 2.965672492980957, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s]                                               {'loss': 2.2815, 'grad_norm': 3.1951048374176025, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s] 60%|██████    | 24/40 [00:10<00:05,  2.86it/s]                                               {'loss': 1.8374, 'grad_norm': 11.828271865844727, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.86it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.66it/s]                                               {'loss': 2.2296, 'grad_norm': 2.7856523990631104, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.66it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.53it/s]                                               {'loss': 2.104, 'grad_norm': 2.6057097911834717, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s]                                               {'loss': 2.4092, 'grad_norm': 3.52205491065979, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s] 70%|███████   | 28/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.2917, 'grad_norm': 3.0782675743103027, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s]                                               {'loss': 2.3421, 'grad_norm': 3.395141124725342, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s]                                               {'loss': 2.1017, 'grad_norm': 3.5756595134735107, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.29it/s]                                               {'loss': 2.2097, 'grad_norm': 3.412221908569336, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.29it/s] 80%|████████  | 32/40 [00:13<00:02,  2.90it/s]                                               {'loss': 2.2923, 'grad_norm': 11.36927318572998, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.68it/s]                                               {'loss': 2.2129, 'grad_norm': 3.0132360458374023, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.68it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.56it/s]                                               {'loss': 2.2114, 'grad_norm': 3.8330063819885254, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.56it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.3126, 'grad_norm': 2.8146564960479736, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.40it/s]                                               {'loss': 2.168, 'grad_norm': 3.5300474166870117, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s]                                               {'loss': 2.1993, 'grad_norm': 3.9518351554870605, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.28it/s]                                               {'loss': 2.2927, 'grad_norm': 2.8466522693634033, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]                                               {'loss': 2.2441, 'grad_norm': 3.214812994003296, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'loss': 2.2999, 'grad_norm': 10.494572639465332, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]                                               {'train_runtime': 16.8207, 'train_samples_per_second': 33.59, 'train_steps_per_second': 2.378, 'train_loss': 2.313988944888115, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.84it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]                                              {'loss': 2.5172, 'grad_norm': 4.600967884063721, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.4749, 'grad_norm': 3.461374282836914, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]  8%|▊         | 3/40 [00:01<00:17,  2.17it/s]                                              {'loss': 2.6215, 'grad_norm': 4.459029197692871, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.17it/s] 10%|█         | 4/40 [00:01<00:16,  2.18it/s]                                              {'loss': 2.3497, 'grad_norm': 3.903705358505249, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.18it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.4006, 'grad_norm': 3.165402889251709, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.23it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.3257, 'grad_norm': 4.137682914733887, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s]                                              {'loss': 2.555, 'grad_norm': 3.3089582920074463, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s] 20%|██        | 8/40 [00:03<00:11,  2.86it/s]                                              {'loss': 2.377, 'grad_norm': 10.759212493896484, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.86it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s]                                              {'loss': 2.3231, 'grad_norm': 2.724799871444702, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.3268, 'grad_norm': 3.1695797443389893, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.35it/s]                                               {'loss': 2.2709, 'grad_norm': 3.300870180130005, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.35it/s] 30%|███       | 12/40 [00:05<00:12,  2.28it/s]                                               {'loss': 2.4155, 'grad_norm': 2.914443016052246, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.28it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.24it/s]                                               {'loss': 2.2772, 'grad_norm': 2.888244390487671, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.24it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.3195, 'grad_norm': 3.2259397506713867, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.20it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.3069, 'grad_norm': 3.247077703475952, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 2.1109, 'grad_norm': 11.950878143310547, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.1224, 'grad_norm': 4.336754322052002, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.46it/s]                                               {'loss': 2.1245, 'grad_norm': 2.8414306640625, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.46it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s]                                               {'loss': 2.2408, 'grad_norm': 3.727900266647339, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s] 50%|█████     | 20/40 [00:08<00:08,  2.34it/s]                                               {'loss': 2.3776, 'grad_norm': 4.036895751953125, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.34it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.3239, 'grad_norm': 2.5420260429382324, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.24it/s]                                               {'loss': 2.233, 'grad_norm': 3.848200559616089, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.24it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s]                                               {'loss': 2.4445, 'grad_norm': 3.287442207336426, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s] 60%|██████    | 24/40 [00:10<00:05,  2.81it/s]                                               {'loss': 2.3061, 'grad_norm': 9.160618782043457, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s]                                               {'loss': 2.3713, 'grad_norm': 3.62986421585083, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.46it/s]                                               {'loss': 2.2731, 'grad_norm': 3.3345303535461426, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.46it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.03, 'grad_norm': 2.878441095352173, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s] 70%|███████   | 28/40 [00:11<00:05,  2.35it/s]                                               {'loss': 2.2203, 'grad_norm': 3.3258578777313232, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.35it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s]                                               {'loss': 2.2453, 'grad_norm': 3.1263153553009033, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.31it/s]                                               {'loss': 2.2879, 'grad_norm': 3.571938991546631, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.31it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.25it/s]                                               {'loss': 2.1865, 'grad_norm': 3.453655481338501, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.25it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 1.4531, 'grad_norm': 10.237604141235352, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.57it/s]                                               {'loss': 2.1819, 'grad_norm': 3.41277813911438, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.57it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s]                                               {'loss': 2.118, 'grad_norm': 4.0852251052856445, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.32it/s]                                               {'loss': 2.2828, 'grad_norm': 2.7915217876434326, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.32it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.26it/s]                                               {'loss': 2.2558, 'grad_norm': 3.2809741497039795, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.26it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.21it/s]                                               {'loss': 2.1098, 'grad_norm': 3.235747814178467, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.21it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.19it/s]                                               {'loss': 2.2125, 'grad_norm': 3.9600584506988525, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.19it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.16it/s]                                               {'loss': 2.2116, 'grad_norm': 3.259852409362793, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.16it/s]                                               {'loss': 1.3878, 'grad_norm': 7.715373992919922, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.16it/s]                                               {'train_runtime': 16.8012, 'train_samples_per_second': 33.629, 'train_steps_per_second': 2.381, 'train_loss': 2.2493183583021166, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.16it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:44
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]                                              {'loss': 2.3178, 'grad_norm': 3.2685680389404297, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]  5%|▌         | 2/40 [00:01<00:31,  1.20it/s]                                              {'loss': 2.4014, 'grad_norm': 3.7562029361724854, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:31,  1.20it/s]  8%|▊         | 3/40 [00:02<00:24,  1.51it/s]                                              {'loss': 2.5213, 'grad_norm': 4.113183975219727, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.51it/s] 10%|█         | 4/40 [00:02<00:21,  1.70it/s]                                              {'loss': 2.577, 'grad_norm': 4.363295078277588, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:21,  1.70it/s] 12%|█▎        | 5/40 [00:02<00:19,  1.84it/s]                                              {'loss': 2.429, 'grad_norm': 3.5550575256347656, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:19,  1.84it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.93it/s]                                              {'loss': 2.5043, 'grad_norm': 3.505997896194458, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.93it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.01it/s]                                              {'loss': 2.4561, 'grad_norm': 3.6660988330841064, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.01it/s] 20%|██        | 8/40 [00:04<00:14,  2.14it/s]                                              {'loss': 2.6374, 'grad_norm': 12.455945014953613, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.14it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.26it/s]                                              {'loss': 2.3892, 'grad_norm': 4.388396739959717, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.26it/s] 25%|██▌       | 10/40 [00:05<00:12,  2.39it/s]                                               {'loss': 2.389, 'grad_norm': 3.191704273223877, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:12,  2.39it/s] 28%|██▊       | 11/40 [00:05<00:11,  2.48it/s]                                               {'loss': 2.3479, 'grad_norm': 3.6995866298675537, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:11,  2.48it/s] 30%|███       | 12/40 [00:05<00:10,  2.55it/s]                                               {'loss': 2.3546, 'grad_norm': 3.081317663192749, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:10,  2.55it/s] 32%|███▎      | 13/40 [00:06<00:10,  2.59it/s]                                               {'loss': 2.384, 'grad_norm': 3.311638116836548, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:10,  2.59it/s] 35%|███▌      | 14/40 [00:06<00:09,  2.63it/s]                                               {'loss': 2.2439, 'grad_norm': 4.443817615509033, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:09,  2.63it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.68it/s]                                               {'loss': 2.4092, 'grad_norm': 3.1698148250579834, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.68it/s]                                               {'loss': 2.2256, 'grad_norm': 22.288894653320312, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.68it/s] 42%|████▎     | 17/40 [00:07<00:06,  3.36it/s]                                               {'loss': 2.2717, 'grad_norm': 3.1090476512908936, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:06,  3.36it/s] 45%|████▌     | 18/40 [00:07<00:06,  3.16it/s]                                               {'loss': 2.3767, 'grad_norm': 3.5036110877990723, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:06,  3.16it/s] 48%|████▊     | 19/40 [00:08<00:07,  2.98it/s]                                               {'loss': 2.273, 'grad_norm': 4.451058864593506, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:07,  2.98it/s] 50%|█████     | 20/40 [00:08<00:07,  2.69it/s]                                               {'loss': 2.3695, 'grad_norm': 3.378156900405884, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.69it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.54it/s]                                               {'loss': 2.4753, 'grad_norm': 3.545572280883789, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.54it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.43it/s]                                               {'loss': 2.1859, 'grad_norm': 2.9583709239959717, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.43it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.416, 'grad_norm': 3.3374764919281006, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s] 60%|██████    | 24/40 [00:10<00:05,  2.95it/s]                                               {'loss': 2.1837, 'grad_norm': 16.766876220703125, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.95it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.71it/s]                                               {'loss': 2.3904, 'grad_norm': 3.252458333969116, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.71it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s]                                               {'loss': 2.4231, 'grad_norm': 3.051431655883789, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.50it/s]                                               {'loss': 2.2128, 'grad_norm': 2.946077585220337, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.50it/s] 70%|███████   | 28/40 [00:11<00:05,  2.36it/s]                                               {'loss': 2.1617, 'grad_norm': 3.016710042953491, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.36it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.31it/s]                                               {'loss': 2.1803, 'grad_norm': 3.379122018814087, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.31it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.30it/s]                                               {'loss': 2.1799, 'grad_norm': 4.844902038574219, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s]                                               {'loss': 2.2396, 'grad_norm': 3.0692801475524902, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s] 80%|████████  | 32/40 [00:13<00:02,  2.83it/s]                                               {'loss': 2.4377, 'grad_norm': 24.5504207611084, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.83it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s]                                               {'loss': 2.2775, 'grad_norm': 3.2856037616729736, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s]                                               {'loss': 2.2078, 'grad_norm': 4.397192478179932, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s]                                               {'loss': 2.1134, 'grad_norm': 3.5329408645629883, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.29it/s]                                               {'loss': 2.1717, 'grad_norm': 3.407724380493164, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.29it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s]                                               {'loss': 2.2126, 'grad_norm': 3.1964592933654785, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.27it/s]                                               {'loss': 2.2641, 'grad_norm': 3.0855650901794434, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.27it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]                                               {'loss': 2.265, 'grad_norm': 4.359871864318848, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]100%|██████████| 40/40 [00:16<00:00,  2.92it/s]                                               {'loss': 2.9186, 'grad_norm': 10.281274795532227, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.92it/s]                                               {'train_runtime': 16.6964, 'train_samples_per_second': 33.84, 'train_steps_per_second': 2.396, 'train_loss': 2.3448880314826965, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.92it/s]100%|██████████| 40/40 [00:16<00:00,  2.40it/s]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.6571, 'grad_norm': 3.8698928356170654, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.2472, 'grad_norm': 4.474511623382568, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.23it/s]  8%|▊         | 3/40 [00:01<00:16,  2.25it/s]                                              {'loss': 2.5534, 'grad_norm': 5.570457935333252, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.25it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.439, 'grad_norm': 4.484598636627197, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.24it/s]                                              {'loss': 2.5462, 'grad_norm': 3.895881175994873, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.24it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.2547, 'grad_norm': 3.3583462238311768, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s]                                              {'loss': 2.178, 'grad_norm': 3.4543209075927734, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s] 20%|██        | 8/40 [00:03<00:11,  2.85it/s]                                              {'loss': 2.7919, 'grad_norm': 10.766347885131836, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.85it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.58it/s]                                              {'loss': 2.1716, 'grad_norm': 3.246103048324585, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.58it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s]                                               {'loss': 2.3653, 'grad_norm': 2.9302806854248047, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.42it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s]                                               {'loss': 2.1454, 'grad_norm': 3.9604437351226807, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s] 30%|███       | 12/40 [00:05<00:12,  2.31it/s]                                               {'loss': 2.4024, 'grad_norm': 2.9562737941741943, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.31it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.2965, 'grad_norm': 2.9617185592651367, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.2684, 'grad_norm': 2.8150064945220947, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.26, 'grad_norm': 3.0936896800994873, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s]                                               {'loss': 3.17, 'grad_norm': 24.378786087036133, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:10,  2.20it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.78it/s]                                               {'loss': 2.2437, 'grad_norm': 3.5340263843536377, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.78it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.3303, 'grad_norm': 3.971123456954956, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.58it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.3406, 'grad_norm': 3.670043706893921, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.47it/s] 50%|█████     | 20/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.1461, 'grad_norm': 3.009430408477783, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.41it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.2462, 'grad_norm': 3.049989938735962, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.35it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.34it/s]                                               {'loss': 2.1445, 'grad_norm': 3.616410255432129, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.34it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.29it/s]                                               {'loss': 2.0622, 'grad_norm': 3.2754435539245605, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.29it/s] 60%|██████    | 24/40 [00:09<00:05,  2.85it/s]                                               {'loss': 2.4284, 'grad_norm': 17.43223762512207, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 2.1171, 'grad_norm': 2.9060745239257812, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s]                                               {'loss': 2.3512, 'grad_norm': 2.5441229343414307, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s]                                               {'loss': 2.076, 'grad_norm': 3.3665764331817627, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s] 70%|███████   | 28/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.2026, 'grad_norm': 3.8595595359802246, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.37it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.29it/s]                                               {'loss': 2.2568, 'grad_norm': 3.8073456287384033, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.29it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.30it/s]                                               {'loss': 2.1397, 'grad_norm': 3.6784565448760986, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.37it/s]                                               {'loss': 2.0763, 'grad_norm': 3.564229965209961, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.37it/s] 80%|████████  | 32/40 [00:13<00:02,  2.95it/s]                                               {'loss': 2.4415, 'grad_norm': 13.316521644592285, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.95it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s]                                               {'loss': 2.1601, 'grad_norm': 4.1610565185546875, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.62it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.48it/s]                                               {'loss': 2.1774, 'grad_norm': 3.8976290225982666, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.48it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.33it/s]                                               {'loss': 2.1445, 'grad_norm': 2.859767436981201, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.33it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.28it/s]                                               {'loss': 2.1955, 'grad_norm': 3.0777664184570312, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.28it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s]                                               {'loss': 2.2222, 'grad_norm': 3.6792163848876953, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.20it/s]                                               {'loss': 2.0243, 'grad_norm': 2.6615636348724365, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.20it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.1161, 'grad_norm': 2.7183306217193604, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.0057, 'grad_norm': 10.138689041137695, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.21it/s]                                               {'train_runtime': 16.576, 'train_samples_per_second': 34.086, 'train_steps_per_second': 2.413, 'train_loss': 2.2849034309387206, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.21it/s]100%|██████████| 40/40 [00:16<00:00,  2.41it/s]
CLIENT:24
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.5047, 'grad_norm': 3.0935003757476807, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.3329, 'grad_norm': 3.468268871307373, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]  8%|▊         | 3/40 [00:01<00:16,  2.25it/s]                                              {'loss': 2.5554, 'grad_norm': 3.634890556335449, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.25it/s] 10%|█         | 4/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.2631, 'grad_norm': 2.9651033878326416, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.19it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.7346, 'grad_norm': 3.3883612155914307, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s]                                              {'loss': 2.4798, 'grad_norm': 4.343425273895264, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.20it/s]                                              {'loss': 2.3905, 'grad_norm': 3.522580623626709, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.20it/s] 20%|██        | 8/40 [00:03<00:11,  2.83it/s]                                              {'loss': 2.604, 'grad_norm': 13.876534461975098, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.4624, 'grad_norm': 3.555699348449707, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s]                                               {'loss': 2.2785, 'grad_norm': 3.042311906814575, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s]                                               {'loss': 2.449, 'grad_norm': 2.8525967597961426, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.36it/s] 30%|███       | 12/40 [00:05<00:12,  2.29it/s]                                               {'loss': 2.2565, 'grad_norm': 4.267714023590088, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.29it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.2747, 'grad_norm': 3.0712993144989014, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.3266, 'grad_norm': 3.276714324951172, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.3933, 'grad_norm': 3.4069859981536865, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 1.5119, 'grad_norm': 10.49083137512207, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.60it/s]                                               {'loss': 2.0938, 'grad_norm': 3.3317370414733887, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.60it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.42it/s]                                               {'loss': 2.1851, 'grad_norm': 3.2519776821136475, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.42it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s]                                               {'loss': 2.4211, 'grad_norm': 3.51444935798645, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s] 50%|█████     | 20/40 [00:08<00:08,  2.31it/s]                                               {'loss': 2.2085, 'grad_norm': 3.4387049674987793, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.31it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.3718, 'grad_norm': 3.9047799110412598, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.3742, 'grad_norm': 3.4056177139282227, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.38it/s]                                               {'loss': 2.2258, 'grad_norm': 3.925436496734619, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.38it/s]                                               {'loss': 2.3361, 'grad_norm': 9.67604923248291, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:06,  2.38it/s] 62%|██████▎   | 25/40 [00:10<00:04,  3.12it/s]                                               {'loss': 2.3293, 'grad_norm': 3.0188212394714355, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:04,  3.12it/s] 65%|██████▌   | 26/40 [00:10<00:04,  3.04it/s]                                               {'loss': 2.2728, 'grad_norm': 3.4286656379699707, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  3.04it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.95it/s]                                               {'loss': 2.3185, 'grad_norm': 3.198110342025757, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.95it/s] 70%|███████   | 28/40 [00:11<00:04,  2.88it/s]                                               {'loss': 2.2038, 'grad_norm': 2.775448799133301, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.88it/s] 72%|███████▎  | 29/40 [00:11<00:03,  2.84it/s]                                               {'loss': 2.1726, 'grad_norm': 2.8926234245300293, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:03,  2.84it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.81it/s]                                               {'loss': 2.1514, 'grad_norm': 3.1575725078582764, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:03,  2.81it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.81it/s]                                               {'loss': 2.2107, 'grad_norm': 3.082425594329834, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.81it/s] 80%|████████  | 32/40 [00:12<00:02,  3.49it/s]                                               {'loss': 2.4394, 'grad_norm': 13.347966194152832, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.49it/s] 82%|████████▎ | 33/40 [00:12<00:02,  3.19it/s]                                               {'loss': 2.2055, 'grad_norm': 3.365668296813965, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  3.19it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.03it/s]                                               {'loss': 2.259, 'grad_norm': 3.151735544204712, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.03it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.93it/s]                                               {'loss': 2.2875, 'grad_norm': 3.770742893218994, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.93it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.87it/s]                                               {'loss': 2.3379, 'grad_norm': 3.9356563091278076, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.87it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.76it/s]                                               {'loss': 2.1503, 'grad_norm': 3.2317161560058594, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.76it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.49it/s]                                               {'loss': 2.1905, 'grad_norm': 2.8023056983947754, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.49it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.40it/s]                                               {'loss': 2.1779, 'grad_norm': 4.252081394195557, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.40it/s]                                               {'loss': 1.6695, 'grad_norm': 9.224604606628418, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.40it/s]                                               {'train_runtime': 15.4705, 'train_samples_per_second': 36.521, 'train_steps_per_second': 2.586, 'train_loss': 2.2852725982666016, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.40it/s]100%|██████████| 40/40 [00:15<00:00,  2.59it/s]
CLIENT:98
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:32,  1.19it/s]                                              {'loss': 2.2846, 'grad_norm': 4.294105052947998, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:32,  1.19it/s]  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]                                              {'loss': 2.5858, 'grad_norm': 3.5318408012390137, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.35it/s]  8%|▊         | 3/40 [00:01<00:22,  1.64it/s]                                              {'loss': 2.3891, 'grad_norm': 5.641360759735107, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.64it/s] 10%|█         | 4/40 [00:02<00:19,  1.86it/s]                                              {'loss': 2.5804, 'grad_norm': 5.183159351348877, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.86it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.95it/s]                                              {'loss': 2.4309, 'grad_norm': 3.8552350997924805, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.95it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.05it/s]                                              {'loss': 2.3097, 'grad_norm': 3.423677444458008, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.05it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.3076, 'grad_norm': 3.5711774826049805, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s] 20%|██        | 8/40 [00:04<00:15,  2.03it/s]                                              {'loss': 2.7294, 'grad_norm': 11.342028617858887, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.03it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.13it/s]                                              {'loss': 2.2219, 'grad_norm': 3.640423536300659, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.13it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.13it/s]                                               {'loss': 2.4006, 'grad_norm': 4.373197078704834, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.13it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.14it/s]                                               {'loss': 2.2154, 'grad_norm': 3.270655870437622, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.14it/s] 30%|███       | 12/40 [00:06<00:12,  2.17it/s]                                               {'loss': 2.2994, 'grad_norm': 3.8888635635375977, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:12,  2.17it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.14it/s]                                               {'loss': 2.3001, 'grad_norm': 3.6097002029418945, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.14it/s] 35%|███▌      | 14/40 [00:07<00:12,  2.16it/s]                                               {'loss': 2.2694, 'grad_norm': 3.0225579738616943, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:12,  2.16it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.14it/s]                                               {'loss': 2.2639, 'grad_norm': 3.3210678100585938, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.14it/s] 40%|████      | 16/40 [00:07<00:08,  2.74it/s]                                               {'loss': 2.6945, 'grad_norm': 16.700273513793945, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.74it/s] 42%|████▎     | 17/40 [00:08<00:09,  2.55it/s]                                               {'loss': 2.341, 'grad_norm': 2.8258001804351807, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:09,  2.55it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.45it/s]                                               {'loss': 2.2672, 'grad_norm': 3.1927542686462402, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.45it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.2925, 'grad_norm': 3.4850168228149414, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:09<00:08,  2.32it/s]                                               {'loss': 2.1565, 'grad_norm': 3.0376436710357666, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.32it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.23it/s]                                               {'loss': 2.1624, 'grad_norm': 3.271871566772461, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.23it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.24it/s]                                               {'loss': 2.2749, 'grad_norm': 3.023144483566284, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.24it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.23it/s]                                               {'loss': 2.2259, 'grad_norm': 3.2270355224609375, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.23it/s]                                               {'loss': 1.7793, 'grad_norm': 17.4807071685791, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:07,  2.23it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.71it/s]                                               {'loss': 2.2027, 'grad_norm': 2.990731954574585, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.71it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.59it/s]                                               {'loss': 2.288, 'grad_norm': 3.850926399230957, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.59it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.46it/s]                                               {'loss': 2.4459, 'grad_norm': 3.200162649154663, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.46it/s] 70%|███████   | 28/40 [00:12<00:04,  2.43it/s]                                               {'loss': 2.2178, 'grad_norm': 3.8093461990356445, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:04,  2.43it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.39it/s]                                               {'loss': 2.1986, 'grad_norm': 3.0976550579071045, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.39it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s]                                               {'loss': 2.0837, 'grad_norm': 3.204705238342285, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s] 78%|███████▊  | 31/40 [00:14<00:03,  2.33it/s]                                               {'loss': 2.1528, 'grad_norm': 2.823254108428955, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:03,  2.33it/s] 80%|████████  | 32/40 [00:14<00:02,  2.89it/s]                                               {'loss': 2.2062, 'grad_norm': 18.024211883544922, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.89it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.59it/s]                                               {'loss': 2.4225, 'grad_norm': 3.6685142517089844, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:15<00:02,  2.47it/s]                                               {'loss': 2.0206, 'grad_norm': 3.005892276763916, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:15<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.37it/s]                                               {'loss': 2.2076, 'grad_norm': 3.464109420776367, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:16<00:01,  2.30it/s]                                               {'loss': 2.2309, 'grad_norm': 3.328420877456665, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:16<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.27it/s]                                               {'loss': 2.2445, 'grad_norm': 3.487751007080078, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.032, 'grad_norm': 4.468175888061523, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.20it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.19it/s]                                               {'loss': 2.163, 'grad_norm': 3.2132601737976074, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.19it/s]100%|██████████| 40/40 [00:17<00:00,  2.85it/s]                                               {'loss': 1.6578, 'grad_norm': 10.095754623413086, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.85it/s]                                               {'train_runtime': 17.6156, 'train_samples_per_second': 32.074, 'train_steps_per_second': 2.271, 'train_loss': 2.2639240860939025, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.85it/s]100%|██████████| 40/40 [00:17<00:00,  2.27it/s]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.11it/s]                                              {'loss': 2.367, 'grad_norm': 4.175488471984863, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.11it/s]  5%|▌         | 2/40 [00:00<00:17,  2.14it/s]                                              {'loss': 2.3851, 'grad_norm': 3.349575996398926, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.14it/s]  8%|▊         | 3/40 [00:01<00:16,  2.18it/s]                                              {'loss': 2.2778, 'grad_norm': 3.9416663646698, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.18it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.2734, 'grad_norm': 4.02400541305542, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:13,  2.52it/s]                                              {'loss': 2.2241, 'grad_norm': 2.5266313552856445, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.52it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.64it/s]                                              {'loss': 2.1563, 'grad_norm': 3.4455881118774414, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.64it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.81it/s]                                              {'loss': 2.3255, 'grad_norm': 2.997093915939331, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.81it/s]                                              {'loss': 3.2561, 'grad_norm': 30.954986572265625, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.81it/s] 22%|██▎       | 9/40 [00:03<00:08,  3.57it/s]                                              {'loss': 2.0708, 'grad_norm': 4.3861236572265625, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:08,  3.57it/s] 25%|██▌       | 10/40 [00:03<00:08,  3.48it/s]                                               {'loss': 2.2321, 'grad_norm': 3.3586292266845703, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:08,  3.48it/s] 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s]                                               {'loss': 2.25, 'grad_norm': 3.2939016819000244, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:08,  3.43it/s] 30%|███       | 12/40 [00:04<00:08,  3.29it/s]                                               {'loss': 2.2252, 'grad_norm': 2.764735221862793, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:08,  3.29it/s] 32%|███▎      | 13/40 [00:04<00:08,  3.32it/s]                                               {'loss': 2.262, 'grad_norm': 3.9483935832977295, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:08,  3.32it/s] 35%|███▌      | 14/40 [00:04<00:08,  3.05it/s]                                               {'loss': 2.3205, 'grad_norm': 2.977940797805786, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:08,  3.05it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.77it/s]                                               {'loss': 2.2292, 'grad_norm': 4.043961048126221, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.77it/s] 40%|████      | 16/40 [00:05<00:07,  3.38it/s]                                               {'loss': 2.7695, 'grad_norm': 30.333642959594727, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.38it/s] 42%|████▎     | 17/40 [00:05<00:07,  2.89it/s]                                               {'loss': 2.0541, 'grad_norm': 2.7977330684661865, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:07,  2.89it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.62it/s]                                               {'loss': 2.3148, 'grad_norm': 3.5343000888824463, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.62it/s] 48%|████▊     | 19/40 [00:06<00:08,  2.50it/s]                                               {'loss': 2.0176, 'grad_norm': 3.580925703048706, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:08,  2.50it/s] 50%|█████     | 20/40 [00:07<00:08,  2.35it/s]                                               {'loss': 1.9926, 'grad_norm': 4.614632606506348, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.35it/s] 52%|█████▎    | 21/40 [00:07<00:08,  2.29it/s]                                               {'loss': 2.1649, 'grad_norm': 2.9477665424346924, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:08,  2.29it/s] 55%|█████▌    | 22/40 [00:08<00:08,  2.24it/s]                                               {'loss': 2.1442, 'grad_norm': 2.748986005783081, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:08,  2.24it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.19it/s]                                               {'loss': 2.2312, 'grad_norm': 3.2766788005828857, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.19it/s]                                               {'loss': 1.7087, 'grad_norm': 10.690007209777832, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:07,  2.19it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.72it/s]                                               {'loss': 1.9939, 'grad_norm': 3.996525764465332, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.72it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.55it/s]                                               {'loss': 2.0748, 'grad_norm': 2.6449966430664062, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.45it/s]                                               {'loss': 1.9229, 'grad_norm': 3.51239013671875, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.45it/s] 70%|███████   | 28/40 [00:10<00:05,  2.37it/s]                                               {'loss': 2.23, 'grad_norm': 2.7742671966552734, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.37it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.30it/s]                                               {'loss': 2.0331, 'grad_norm': 3.2991979122161865, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.30it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.29it/s]                                               {'loss': 2.3336, 'grad_norm': 4.5968337059021, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.29it/s] 78%|███████▊  | 31/40 [00:11<00:04,  2.23it/s]                                               {'loss': 2.0848, 'grad_norm': 3.2212297916412354, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:04,  2.23it/s] 80%|████████  | 32/40 [00:12<00:02,  2.81it/s]                                               {'loss': 2.2068, 'grad_norm': 11.349418640136719, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.81it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s]                                               {'loss': 1.8994, 'grad_norm': 2.859959840774536, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.52it/s]                                               {'loss': 2.1616, 'grad_norm': 2.8683393001556396, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.52it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.44it/s]                                               {'loss': 2.0426, 'grad_norm': 2.9672276973724365, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.44it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s]                                               {'loss': 2.1857, 'grad_norm': 3.4241530895233154, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s]                                               {'loss': 1.9857, 'grad_norm': 2.636706590652466, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.36it/s]                                               {'loss': 1.9549, 'grad_norm': 3.0700364112854004, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.36it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.42it/s]                                               {'loss': 2.1393, 'grad_norm': 3.009033679962158, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.42it/s]100%|██████████| 40/40 [00:15<00:00,  3.09it/s]                                               {'loss': 1.697, 'grad_norm': 9.238588333129883, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.09it/s]                                               {'train_runtime': 15.3159, 'train_samples_per_second': 36.89, 'train_steps_per_second': 2.612, 'train_loss': 2.1799578934907915, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.09it/s]100%|██████████| 40/40 [00:15<00:00,  2.61it/s]
CLIENT:95
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.76it/s]                                              {'loss': 2.2926, 'grad_norm': 3.725966215133667, 'learning_rate': 0.00016333997346592444, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.76it/s]  5%|▌         | 2/40 [00:00<00:13,  2.86it/s]                                              {'loss': 2.3124, 'grad_norm': 3.475487232208252, 'learning_rate': 0.00015925647412927632, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.86it/s]  8%|▊         | 3/40 [00:00<00:11,  3.20it/s]                                              {'loss': 2.6298, 'grad_norm': 3.7580316066741943, 'learning_rate': 0.0001551729747926282, 'epoch': 0.38}
  8%|▊         | 3/40 [00:00<00:11,  3.20it/s] 10%|█         | 4/40 [00:01<00:10,  3.37it/s]                                              {'loss': 2.3522, 'grad_norm': 3.4890706539154053, 'learning_rate': 0.00015108947545598012, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:10,  3.37it/s] 12%|█▎        | 5/40 [00:01<00:10,  3.46it/s]                                              {'loss': 2.3741, 'grad_norm': 6.418680667877197, 'learning_rate': 0.000147005976119332, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:10,  3.46it/s] 15%|█▌        | 6/40 [00:01<00:09,  3.55it/s]                                              {'loss': 2.5909, 'grad_norm': 4.182100772857666, 'learning_rate': 0.0001429224767826839, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:01<00:09,  3.55it/s] 18%|█▊        | 7/40 [00:02<00:09,  3.40it/s]                                              {'loss': 2.2026, 'grad_norm': 4.500668048858643, 'learning_rate': 0.00013883897744603577, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:09,  3.40it/s] 20%|██        | 8/40 [00:02<00:07,  4.10it/s]                                              {'loss': 2.827, 'grad_norm': 16.143421173095703, 'learning_rate': 0.00013475547810938766, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:07,  4.10it/s] 22%|██▎       | 9/40 [00:02<00:08,  3.45it/s]                                              {'loss': 2.447, 'grad_norm': 3.4248218536376953, 'learning_rate': 0.00013067197877273954, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:02<00:08,  3.45it/s] 25%|██▌       | 10/40 [00:02<00:09,  3.21it/s]                                               {'loss': 2.4149, 'grad_norm': 4.179140567779541, 'learning_rate': 0.00012658847943609143, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.21it/s] 28%|██▊       | 11/40 [00:03<00:09,  2.93it/s]                                               {'loss': 2.4658, 'grad_norm': 3.891117811203003, 'learning_rate': 0.00012250498009944334, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  2.93it/s] 30%|███       | 12/40 [00:03<00:10,  2.67it/s]                                               {'loss': 2.2617, 'grad_norm': 4.27586030960083, 'learning_rate': 0.00011842148076279521, 'epoch': 1.5}
 30%|███       | 12/40 [00:03<00:10,  2.67it/s] 32%|███▎      | 13/40 [00:04<00:10,  2.51it/s]                                               {'loss': 2.4278, 'grad_norm': 5.593697547912598, 'learning_rate': 0.0001143379814261471, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:10,  2.51it/s] 35%|███▌      | 14/40 [00:04<00:10,  2.39it/s]                                               {'loss': 2.3284, 'grad_norm': 3.081001043319702, 'learning_rate': 0.000110254482089499, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:04<00:10,  2.39it/s] 38%|███▊      | 15/40 [00:05<00:10,  2.35it/s]                                               {'loss': 2.2455, 'grad_norm': 3.45382022857666, 'learning_rate': 0.00010617098275285088, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:10,  2.35it/s] 40%|████      | 16/40 [00:05<00:08,  2.94it/s]                                               {'loss': 2.8886, 'grad_norm': 13.007553100585938, 'learning_rate': 0.00010208748341620277, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:08,  2.94it/s] 42%|████▎     | 17/40 [00:05<00:08,  2.59it/s]                                               {'loss': 2.2123, 'grad_norm': 3.0599007606506348, 'learning_rate': 9.800398407955466e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:08,  2.59it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.46it/s]                                               {'loss': 2.3622, 'grad_norm': 3.016047239303589, 'learning_rate': 9.392048474290655e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.46it/s] 48%|████▊     | 19/40 [00:06<00:09,  2.33it/s]                                               {'loss': 2.3296, 'grad_norm': 3.266188621520996, 'learning_rate': 8.983698540625845e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:09,  2.33it/s] 50%|█████     | 20/40 [00:07<00:08,  2.27it/s]                                               {'loss': 2.3471, 'grad_norm': 4.2187819480896, 'learning_rate': 8.575348606961033e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.27it/s] 52%|█████▎    | 21/40 [00:07<00:08,  2.24it/s]                                               {'loss': 2.3326, 'grad_norm': 3.435375213623047, 'learning_rate': 8.166998673296222e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:08,  2.24it/s] 55%|█████▌    | 22/40 [00:08<00:08,  2.20it/s]                                               {'loss': 2.0649, 'grad_norm': 3.575878143310547, 'learning_rate': 7.75864873963141e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:08,  2.20it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.22it/s]                                               {'loss': 2.2118, 'grad_norm': 3.547987461090088, 'learning_rate': 7.3502988059666e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.22it/s]                                               {'loss': 1.8479, 'grad_norm': 10.934123992919922, 'learning_rate': 6.941948872301789e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:07,  2.22it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s]                                               {'loss': 2.2289, 'grad_norm': 2.9512929916381836, 'learning_rate': 6.533598938636977e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.55it/s]                                               {'loss': 2.1253, 'grad_norm': 3.2139792442321777, 'learning_rate': 6.125249004972167e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.45it/s]                                               {'loss': 2.2216, 'grad_norm': 3.8384463787078857, 'learning_rate': 5.716899071307355e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.45it/s] 70%|███████   | 28/40 [00:10<00:05,  2.35it/s]                                               {'loss': 2.2067, 'grad_norm': 2.8570499420166016, 'learning_rate': 5.308549137642544e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.35it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s]                                               {'loss': 2.2191, 'grad_norm': 3.104358673095703, 'learning_rate': 4.900199203977733e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.24it/s]                                               {'loss': 2.2472, 'grad_norm': 3.8974225521087646, 'learning_rate': 4.4918492703129224e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.24it/s] 78%|███████▊  | 31/40 [00:11<00:04,  2.23it/s]                                               {'loss': 2.2286, 'grad_norm': 2.868889331817627, 'learning_rate': 4.083499336648111e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:04,  2.23it/s] 80%|████████  | 32/40 [00:12<00:02,  2.85it/s]                                               {'loss': 2.627, 'grad_norm': 10.254940032958984, 'learning_rate': 3.6751494029833e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.61it/s]                                               {'loss': 2.252, 'grad_norm': 3.333662509918213, 'learning_rate': 3.2667994693184886e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.61it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.52it/s]                                               {'loss': 2.1337, 'grad_norm': 3.4133870601654053, 'learning_rate': 2.8584495356536774e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.52it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.45it/s]                                               {'loss': 2.1939, 'grad_norm': 3.4133198261260986, 'learning_rate': 2.4500996019888666e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.45it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s]                                               {'loss': 2.2787, 'grad_norm': 3.318662166595459, 'learning_rate': 2.0417496683240555e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.37it/s]                                               {'loss': 2.0608, 'grad_norm': 3.3882265090942383, 'learning_rate': 1.6333997346592443e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.37it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.35it/s]                                               {'loss': 2.2028, 'grad_norm': 3.4001855850219727, 'learning_rate': 1.2250498009944333e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.35it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.41it/s]                                               {'loss': 2.1818, 'grad_norm': 3.2258870601654053, 'learning_rate': 8.166998673296221e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.41it/s]100%|██████████| 40/40 [00:15<00:00,  3.11it/s]                                               {'loss': 2.2405, 'grad_norm': 12.642006874084473, 'learning_rate': 4.083499336648111e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.11it/s]                                               {'train_runtime': 15.2878, 'train_samples_per_second': 36.958, 'train_steps_per_second': 2.616, 'train_loss': 2.3104546546936033, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.11it/s]100%|██████████| 40/40 [00:15<00:00,  2.62it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:39, 11.93it/s]  1%|          | 4/471 [00:00<01:19,  5.88it/s]  1%|          | 5/471 [00:00<01:26,  5.38it/s]  1%|▏         | 6/471 [00:01<01:29,  5.20it/s]  1%|▏         | 7/471 [00:01<01:30,  5.12it/s]  2%|▏         | 8/471 [00:01<01:35,  4.87it/s]  2%|▏         | 9/471 [00:01<01:35,  4.85it/s]  2%|▏         | 10/471 [00:01<01:39,  4.65it/s]  2%|▏         | 11/471 [00:02<01:35,  4.83it/s]  3%|▎         | 12/471 [00:02<01:39,  4.59it/s]  3%|▎         | 13/471 [00:02<01:35,  4.81it/s]  3%|▎         | 14/471 [00:02<01:42,  4.46it/s]  3%|▎         | 15/471 [00:03<01:37,  4.69it/s]  3%|▎         | 16/471 [00:03<01:41,  4.47it/s]  4%|▎         | 17/471 [00:03<01:34,  4.79it/s]  4%|▍         | 18/471 [00:03<01:40,  4.53it/s]  4%|▍         | 19/471 [00:03<01:35,  4.73it/s]  4%|▍         | 20/471 [00:04<01:39,  4.53it/s]  4%|▍         | 21/471 [00:04<01:38,  4.58it/s]  5%|▍         | 22/471 [00:04<01:35,  4.68it/s]  5%|▍         | 23/471 [00:04<01:36,  4.63it/s]  5%|▌         | 24/471 [00:04<01:33,  4.76it/s]  5%|▌         | 25/471 [00:05<01:38,  4.52it/s]  6%|▌         | 26/471 [00:05<01:32,  4.79it/s]  6%|▌         | 27/471 [00:05<01:37,  4.54it/s]  6%|▌         | 28/471 [00:05<01:28,  5.01it/s]  6%|▌         | 29/471 [00:06<01:36,  4.59it/s]  6%|▋         | 30/471 [00:06<01:31,  4.83it/s]  7%|▋         | 31/471 [00:06<01:37,  4.50it/s]  7%|▋         | 32/471 [00:06<01:32,  4.73it/s]  7%|▋         | 33/471 [00:06<01:34,  4.63it/s]  7%|▋         | 34/471 [00:07<01:32,  4.75it/s]  7%|▋         | 35/471 [00:07<01:23,  5.22it/s]  8%|▊         | 36/471 [00:07<01:30,  4.79it/s]  8%|▊         | 37/471 [00:07<01:29,  4.87it/s]  8%|▊         | 38/471 [00:07<01:34,  4.59it/s]  8%|▊         | 39/471 [00:08<01:27,  4.96it/s]  8%|▊         | 40/471 [00:08<01:31,  4.72it/s]  9%|▊         | 41/471 [00:08<01:26,  4.97it/s]  9%|▉         | 42/471 [00:08<01:33,  4.56it/s]  9%|▉         | 43/471 [00:08<01:31,  4.67it/s]  9%|▉         | 44/471 [00:09<01:30,  4.72it/s] 10%|▉         | 45/471 [00:09<01:31,  4.68it/s] 10%|▉         | 46/471 [00:09<01:25,  4.99it/s] 10%|▉         | 47/471 [00:09<01:31,  4.65it/s] 10%|█         | 48/471 [00:09<01:28,  4.77it/s] 10%|█         | 49/471 [00:10<01:33,  4.52it/s] 11%|█         | 50/471 [00:10<01:25,  4.91it/s] 11%|█         | 51/471 [00:10<01:29,  4.67it/s] 11%|█         | 52/471 [00:10<01:25,  4.88it/s] 11%|█▏        | 53/471 [00:11<01:34,  4.44it/s] 11%|█▏        | 54/471 [00:11<01:29,  4.68it/s] 12%|█▏        | 55/471 [00:11<01:31,  4.56it/s] 12%|█▏        | 56/471 [00:11<01:28,  4.68it/s] 12%|█▏        | 57/471 [00:11<01:29,  4.65it/s] 12%|█▏        | 58/471 [00:12<01:31,  4.52it/s] 13%|█▎        | 59/471 [00:12<01:27,  4.72it/s] 13%|█▎        | 60/471 [00:12<01:29,  4.57it/s] 13%|█▎        | 61/471 [00:12<01:22,  4.99it/s] 13%|█▎        | 62/471 [00:13<01:28,  4.61it/s] 13%|█▎        | 63/471 [00:13<01:23,  4.88it/s] 14%|█▎        | 64/471 [00:13<01:30,  4.50it/s] 14%|█▍        | 65/471 [00:13<01:24,  4.83it/s] 14%|█▍        | 66/471 [00:13<01:29,  4.54it/s] 14%|█▍        | 67/471 [00:14<01:24,  4.79it/s] 14%|█▍        | 68/471 [00:14<01:26,  4.69it/s] 15%|█▍        | 69/471 [00:14<01:26,  4.64it/s] 15%|█▍        | 70/471 [00:14<01:25,  4.67it/s] 15%|█▌        | 71/471 [00:14<01:26,  4.62it/s] 15%|█▌        | 72/471 [00:15<01:21,  4.88it/s] 15%|█▌        | 73/471 [00:15<01:21,  4.87it/s] 16%|█▌        | 74/471 [00:15<01:22,  4.82it/s] 16%|█▌        | 75/471 [00:15<01:25,  4.63it/s] 16%|█▌        | 76/471 [00:15<01:23,  4.73it/s] 16%|█▋        | 77/471 [00:16<01:25,  4.62it/s] 17%|█▋        | 78/471 [00:16<01:21,  4.83it/s] 17%|█▋        | 79/471 [00:16<01:25,  4.60it/s] 17%|█▋        | 80/471 [00:16<01:22,  4.77it/s] 17%|█▋        | 81/471 [00:17<01:26,  4.52it/s] 17%|█▋        | 82/471 [00:17<01:21,  4.77it/s] 18%|█▊        | 83/471 [00:17<01:24,  4.58it/s] 18%|█▊        | 84/471 [00:17<01:20,  4.80it/s] 18%|█▊        | 85/471 [00:17<01:23,  4.63it/s] 18%|█▊        | 86/471 [00:18<01:23,  4.60it/s] 18%|█▊        | 87/471 [00:18<01:22,  4.64it/s] 19%|█▊        | 88/471 [00:18<01:22,  4.67it/s] 19%|█▉        | 89/471 [00:18<01:18,  4.88it/s] 19%|█▉        | 90/471 [00:18<01:22,  4.62it/s] 19%|█▉        | 91/471 [00:19<01:21,  4.69it/s] 20%|█▉        | 92/471 [00:19<01:23,  4.54it/s] 20%|█▉        | 93/471 [00:19<01:19,  4.76it/s] 20%|█▉        | 94/471 [00:19<01:22,  4.54it/s] 20%|██        | 95/471 [00:20<01:18,  4.82it/s] 20%|██        | 96/471 [00:20<01:23,  4.46it/s] 21%|██        | 97/471 [00:20<01:19,  4.71it/s] 21%|██        | 98/471 [00:20<01:23,  4.48it/s] 21%|██        | 99/471 [00:20<01:17,  4.81it/s] 21%|██        | 100/471 [00:21<01:20,  4.61it/s] 21%|██▏       | 101/471 [00:21<01:18,  4.70it/s] 22%|██▏       | 102/471 [00:21<01:20,  4.61it/s] 22%|██▏       | 103/471 [00:21<01:21,  4.53it/s] 22%|██▏       | 104/471 [00:21<01:19,  4.64it/s] 22%|██▏       | 105/471 [00:22<01:19,  4.60it/s] 23%|██▎       | 106/471 [00:22<01:15,  4.83it/s] 23%|██▎       | 107/471 [00:22<01:19,  4.55it/s] 23%|██▎       | 108/471 [00:22<01:13,  4.93it/s] 23%|██▎       | 109/471 [00:23<01:18,  4.62it/s] 23%|██▎       | 110/471 [00:23<01:10,  5.10it/s] 24%|██▎       | 111/471 [00:23<01:14,  4.86it/s] 24%|██▍       | 112/471 [00:23<01:08,  5.24it/s] 24%|██▍       | 113/471 [00:23<01:05,  5.44it/s] 24%|██▍       | 114/471 [00:23<01:06,  5.39it/s] 24%|██▍       | 115/471 [00:24<01:00,  5.93it/s] 25%|██▍       | 116/471 [00:24<01:03,  5.58it/s] 25%|██▍       | 117/471 [00:24<00:56,  6.30it/s] 25%|██▌       | 118/471 [00:24<01:02,  5.68it/s] 25%|██▌       | 119/471 [00:24<00:56,  6.23it/s] 25%|██▌       | 120/471 [00:24<01:00,  5.77it/s] 26%|██▌       | 121/471 [00:25<00:59,  5.91it/s] 26%|██▌       | 122/471 [00:25<01:00,  5.77it/s] 26%|██▌       | 123/471 [00:25<01:00,  5.79it/s] 26%|██▋       | 124/471 [00:25<00:58,  5.90it/s] 27%|██▋       | 125/471 [00:25<00:57,  6.01it/s] 27%|██▋       | 126/471 [00:25<01:00,  5.71it/s] 27%|██▋       | 127/471 [00:26<00:57,  5.94it/s] 27%|██▋       | 128/471 [00:26<01:00,  5.71it/s] 27%|██▋       | 129/471 [00:26<00:57,  5.90it/s] 28%|██▊       | 130/471 [00:26<00:59,  5.71it/s] 28%|██▊       | 131/471 [00:26<00:58,  5.78it/s] 28%|██▊       | 132/471 [00:26<00:58,  5.80it/s] 28%|██▊       | 133/471 [00:27<00:59,  5.64it/s] 28%|██▊       | 134/471 [00:27<00:57,  5.84it/s] 29%|██▊       | 135/471 [00:27<00:58,  5.71it/s] 29%|██▉       | 136/471 [00:27<00:56,  5.92it/s] 29%|██▉       | 137/471 [00:27<00:58,  5.69it/s] 29%|██▉       | 138/471 [00:28<01:00,  5.47it/s] 30%|██▉       | 139/471 [00:28<01:07,  4.94it/s] 30%|██▉       | 140/471 [00:28<01:05,  5.05it/s] 30%|██▉       | 141/471 [00:28<01:10,  4.69it/s] 30%|███       | 142/471 [00:28<01:06,  4.97it/s] 30%|███       | 143/471 [00:29<01:09,  4.72it/s] 31%|███       | 144/471 [00:29<01:07,  4.86it/s] 31%|███       | 145/471 [00:29<01:11,  4.59it/s] 31%|███       | 146/471 [00:29<01:09,  4.69it/s] 31%|███       | 147/471 [00:30<01:09,  4.69it/s] 31%|███▏      | 148/471 [00:30<01:07,  4.77it/s] 32%|███▏      | 149/471 [00:30<01:07,  4.76it/s] 32%|███▏      | 150/471 [00:30<01:09,  4.60it/s] 32%|███▏      | 151/471 [00:30<01:06,  4.79it/s] 32%|███▏      | 152/471 [00:31<01:09,  4.62it/s] 32%|███▏      | 153/471 [00:31<01:05,  4.88it/s] 33%|███▎      | 154/471 [00:31<01:08,  4.61it/s] 33%|███▎      | 155/471 [00:31<01:05,  4.80it/s] 33%|███▎      | 156/471 [00:31<01:10,  4.45it/s] 33%|███▎      | 157/471 [00:32<01:05,  4.79it/s] 34%|███▎      | 158/471 [00:32<01:09,  4.52it/s] 34%|███▍      | 159/471 [00:32<01:04,  4.86it/s] 34%|███▍      | 160/471 [00:32<01:09,  4.45it/s] 34%|███▍      | 161/471 [00:33<01:06,  4.63it/s] 34%|███▍      | 162/471 [00:33<01:06,  4.62it/s] 35%|███▍      | 163/471 [00:33<01:06,  4.60it/s] 35%|███▍      | 164/471 [00:33<01:01,  4.99it/s] 35%|███▌      | 165/471 [00:33<01:05,  4.66it/s] 35%|███▌      | 166/471 [00:34<01:02,  4.90it/s] 35%|███▌      | 167/471 [00:34<01:06,  4.59it/s] 36%|███▌      | 168/471 [00:34<01:01,  4.94it/s] 36%|███▌      | 169/471 [00:34<01:05,  4.64it/s] 36%|███▌      | 170/471 [00:34<01:01,  4.93it/s] 36%|███▋      | 171/471 [00:35<01:04,  4.64it/s] 37%|███▋      | 172/471 [00:35<01:04,  4.63it/s] 37%|███▋      | 173/471 [00:35<01:03,  4.70it/s] 37%|███▋      | 174/471 [00:35<01:04,  4.57it/s] 37%|███▋      | 175/471 [00:35<00:58,  5.10it/s] 37%|███▋      | 176/471 [00:36<00:57,  5.11it/s] 38%|███▊      | 177/471 [00:36<00:50,  5.85it/s] 38%|███▊      | 178/471 [00:36<00:53,  5.50it/s] 38%|███▊      | 179/471 [00:36<00:50,  5.81it/s] 38%|███▊      | 180/471 [00:36<00:56,  5.18it/s] 38%|███▊      | 181/471 [00:37<00:56,  5.14it/s] 39%|███▊      | 182/471 [00:37<00:59,  4.89it/s] 39%|███▉      | 183/471 [00:37<01:00,  4.80it/s] 39%|███▉      | 184/471 [00:37<00:57,  4.97it/s] 39%|███▉      | 185/471 [00:37<00:59,  4.81it/s] 39%|███▉      | 186/471 [00:38<00:57,  4.94it/s] 40%|███▉      | 187/471 [00:38<01:01,  4.61it/s] 40%|███▉      | 188/471 [00:38<00:56,  4.97it/s] 40%|████      | 189/471 [00:38<01:00,  4.64it/s] 40%|████      | 190/471 [00:38<00:56,  5.01it/s] 41%|████      | 191/471 [00:39<00:58,  4.80it/s] 41%|████      | 192/471 [00:39<00:59,  4.69it/s] 41%|████      | 193/471 [00:39<00:58,  4.72it/s] 41%|████      | 194/471 [00:39<01:00,  4.58it/s] 41%|████▏     | 195/471 [00:39<00:56,  4.86it/s] 42%|████▏     | 196/471 [00:40<00:59,  4.66it/s] 42%|████▏     | 197/471 [00:40<00:56,  4.89it/s] 42%|████▏     | 198/471 [00:40<01:00,  4.51it/s] 42%|████▏     | 199/471 [00:40<00:55,  4.90it/s] 42%|████▏     | 200/471 [00:41<00:59,  4.59it/s] 43%|████▎     | 201/471 [00:41<00:54,  5.00it/s] 43%|████▎     | 202/471 [00:41<00:58,  4.62it/s] 43%|████▎     | 203/471 [00:41<00:57,  4.64it/s] 43%|████▎     | 204/471 [00:41<00:55,  4.77it/s] 44%|████▎     | 205/471 [00:42<00:56,  4.69it/s] 44%|████▎     | 206/471 [00:42<00:52,  5.01it/s] 44%|████▍     | 207/471 [00:42<00:56,  4.70it/s] 44%|████▍     | 208/471 [00:42<00:53,  4.94it/s] 44%|████▍     | 209/471 [00:42<00:57,  4.54it/s] 45%|████▍     | 210/471 [00:43<00:52,  4.93it/s] 45%|████▍     | 211/471 [00:43<00:55,  4.66it/s] 45%|████▌     | 212/471 [00:43<00:52,  4.93it/s] 45%|████▌     | 213/471 [00:43<00:56,  4.57it/s] 45%|████▌     | 214/471 [00:43<00:54,  4.67it/s] 46%|████▌     | 215/471 [00:44<00:56,  4.56it/s] 46%|████▌     | 216/471 [00:44<00:54,  4.68it/s] 46%|████▌     | 217/471 [00:44<00:52,  4.80it/s] 46%|████▋     | 218/471 [00:44<00:51,  4.88it/s] 46%|████▋     | 219/471 [00:45<00:53,  4.74it/s] 47%|████▋     | 220/471 [00:45<00:53,  4.66it/s] 47%|████▋     | 221/471 [00:45<00:53,  4.67it/s] 47%|████▋     | 222/471 [00:45<00:54,  4.60it/s] 47%|████▋     | 223/471 [00:45<00:51,  4.79it/s] 48%|████▊     | 224/471 [00:46<00:54,  4.57it/s] 48%|████▊     | 225/471 [00:46<00:52,  4.66it/s] 48%|████▊     | 226/471 [00:46<00:55,  4.45it/s] 48%|████▊     | 227/471 [00:46<00:50,  4.79it/s] 48%|████▊     | 228/471 [00:47<00:53,  4.53it/s] 49%|████▊     | 229/471 [00:47<00:48,  4.94it/s] 49%|████▉     | 230/471 [00:47<00:53,  4.53it/s] 49%|████▉     | 231/471 [00:47<00:50,  4.76it/s] 49%|████▉     | 232/471 [00:47<00:51,  4.60it/s] 49%|████▉     | 233/471 [00:48<00:50,  4.70it/s] 50%|████▉     | 234/471 [00:48<00:49,  4.75it/s] 50%|████▉     | 235/471 [00:48<00:50,  4.63it/s] 50%|█████     | 236/471 [00:48<00:49,  4.71it/s] 50%|█████     | 237/471 [00:48<00:51,  4.57it/s] 51%|█████     | 238/471 [00:49<00:48,  4.80it/s] 51%|█████     | 239/471 [00:49<00:49,  4.67it/s] 51%|█████     | 240/471 [00:49<00:47,  4.90it/s] 51%|█████     | 241/471 [00:49<00:50,  4.52it/s] 51%|█████▏    | 242/471 [00:49<00:47,  4.86it/s] 52%|█████▏    | 243/471 [00:50<00:49,  4.59it/s] 52%|█████▏    | 244/471 [00:50<00:47,  4.82it/s] 52%|█████▏    | 245/471 [00:50<00:47,  4.71it/s] 52%|█████▏    | 246/471 [00:50<00:48,  4.65it/s] 52%|█████▏    | 247/471 [00:51<00:47,  4.73it/s] 53%|█████▎    | 248/471 [00:51<00:48,  4.60it/s] 53%|█████▎    | 249/471 [00:51<00:45,  4.86it/s] 53%|█████▎    | 250/471 [00:51<00:46,  4.73it/s] 53%|█████▎    | 251/471 [00:51<00:44,  4.96it/s] 54%|█████▎    | 252/471 [00:52<00:48,  4.55it/s] 54%|█████▎    | 253/471 [00:52<00:44,  4.92it/s] 54%|█████▍    | 254/471 [00:52<00:47,  4.61it/s] 54%|█████▍    | 255/471 [00:52<00:43,  4.97it/s] 54%|█████▍    | 256/471 [00:52<00:44,  4.88it/s] 55%|█████▍    | 257/471 [00:53<00:44,  4.84it/s] 55%|█████▍    | 258/471 [00:53<00:44,  4.76it/s] 55%|█████▍    | 259/471 [00:53<00:46,  4.60it/s] 55%|█████▌    | 260/471 [00:53<00:43,  4.87it/s] 55%|█████▌    | 261/471 [00:53<00:45,  4.66it/s] 56%|█████▌    | 262/471 [00:54<00:41,  5.03it/s] 56%|█████▌    | 263/471 [00:54<00:45,  4.59it/s] 56%|█████▌    | 264/471 [00:54<00:42,  4.84it/s] 56%|█████▋    | 265/471 [00:54<00:45,  4.48it/s] 56%|█████▋    | 266/471 [00:54<00:42,  4.85it/s] 57%|█████▋    | 267/471 [00:55<00:43,  4.74it/s] 57%|█████▋    | 268/471 [00:55<00:43,  4.72it/s] 57%|█████▋    | 269/471 [00:55<00:44,  4.54it/s] 57%|█████▋    | 270/471 [00:55<00:43,  4.63it/s] 58%|█████▊    | 271/471 [00:56<00:43,  4.62it/s] 58%|█████▊    | 272/471 [00:56<00:41,  4.82it/s] 58%|█████▊    | 273/471 [00:56<00:42,  4.70it/s] 58%|█████▊    | 274/471 [00:56<00:41,  4.71it/s] 58%|█████▊    | 275/471 [00:56<00:42,  4.63it/s] 59%|█████▊    | 276/471 [00:57<00:41,  4.68it/s] 59%|█████▉    | 277/471 [00:57<00:41,  4.66it/s] 59%|█████▉    | 278/471 [00:57<00:39,  4.85it/s] 59%|█████▉    | 279/471 [00:57<00:42,  4.55it/s] 59%|█████▉    | 280/471 [00:58<00:41,  4.64it/s] 60%|█████▉    | 281/471 [00:58<00:41,  4.54it/s] 60%|█████▉    | 282/471 [00:58<00:40,  4.64it/s] 60%|██████    | 283/471 [00:58<00:39,  4.76it/s] 60%|██████    | 284/471 [00:58<00:40,  4.59it/s] 61%|██████    | 285/471 [00:59<00:39,  4.69it/s] 61%|██████    | 286/471 [00:59<00:40,  4.56it/s] 61%|██████    | 287/471 [00:59<00:38,  4.76it/s] 61%|██████    | 288/471 [00:59<00:39,  4.59it/s] 61%|██████▏   | 289/471 [00:59<00:38,  4.76it/s] 62%|██████▏   | 290/471 [01:00<00:40,  4.51it/s] 62%|██████▏   | 291/471 [01:00<00:37,  4.82it/s] 62%|██████▏   | 292/471 [01:00<00:39,  4.56it/s] 62%|██████▏   | 293/471 [01:00<00:36,  4.88it/s] 62%|██████▏   | 294/471 [01:00<00:35,  4.98it/s] 63%|██████▎   | 295/471 [01:01<00:35,  4.93it/s] 63%|██████▎   | 296/471 [01:01<00:34,  5.03it/s] 63%|██████▎   | 297/471 [01:01<00:37,  4.69it/s] 63%|██████▎   | 298/471 [01:01<00:35,  4.93it/s] 63%|██████▎   | 299/471 [01:02<00:37,  4.62it/s] 64%|██████▎   | 300/471 [01:02<00:32,  5.24it/s] 64%|██████▍   | 301/471 [01:02<00:36,  4.71it/s] 64%|██████▍   | 302/471 [01:02<00:34,  4.93it/s] 64%|██████▍   | 303/471 [01:02<00:36,  4.65it/s] 65%|██████▍   | 304/471 [01:03<00:35,  4.73it/s] 65%|██████▍   | 305/471 [01:03<00:34,  4.75it/s] 65%|██████▍   | 306/471 [01:03<00:35,  4.65it/s] 65%|██████▌   | 307/471 [01:03<00:33,  4.84it/s] 65%|██████▌   | 308/471 [01:03<00:35,  4.57it/s] 66%|██████▌   | 309/471 [01:04<00:32,  4.97it/s] 66%|██████▌   | 310/471 [01:04<00:34,  4.65it/s] 66%|██████▌   | 311/471 [01:04<00:31,  5.09it/s] 66%|██████▌   | 312/471 [01:04<00:34,  4.61it/s] 66%|██████▋   | 313/471 [01:04<00:32,  4.82it/s] 67%|██████▋   | 314/471 [01:05<00:33,  4.63it/s] 67%|██████▋   | 315/471 [01:05<00:33,  4.68it/s] 67%|██████▋   | 316/471 [01:05<00:31,  4.89it/s] 67%|██████▋   | 317/471 [01:05<00:32,  4.68it/s] 68%|██████▊   | 318/471 [01:05<00:31,  4.88it/s] 68%|██████▊   | 319/471 [01:06<00:33,  4.60it/s] 68%|██████▊   | 320/471 [01:06<00:30,  4.99it/s] 68%|██████▊   | 321/471 [01:06<00:31,  4.73it/s] 68%|██████▊   | 322/471 [01:06<00:29,  5.04it/s] 69%|██████▊   | 323/471 [01:07<00:32,  4.54it/s] 69%|██████▉   | 324/471 [01:07<00:31,  4.73it/s] 69%|██████▉   | 325/471 [01:07<00:31,  4.65it/s] 69%|██████▉   | 326/471 [01:07<00:30,  4.69it/s] 69%|██████▉   | 327/471 [01:07<00:27,  5.15it/s] 70%|██████▉   | 328/471 [01:08<00:30,  4.75it/s] 70%|██████▉   | 329/471 [01:08<00:28,  5.04it/s] 70%|███████   | 330/471 [01:08<00:30,  4.68it/s] 70%|███████   | 331/471 [01:08<00:27,  5.05it/s] 70%|███████   | 332/471 [01:08<00:29,  4.73it/s] 71%|███████   | 333/471 [01:09<00:27,  5.07it/s] 71%|███████   | 334/471 [01:09<00:25,  5.35it/s] 71%|███████   | 335/471 [01:09<00:25,  5.38it/s] 71%|███████▏  | 336/471 [01:09<00:21,  6.19it/s] 72%|███████▏  | 337/471 [01:09<00:23,  5.71it/s] 72%|███████▏  | 338/471 [01:09<00:20,  6.48it/s] 72%|███████▏  | 339/471 [01:10<00:21,  6.18it/s] 72%|███████▏  | 340/471 [01:10<00:21,  5.97it/s] 73%|███████▎  | 342/471 [01:10<00:20,  6.34it/s] 73%|███████▎  | 343/471 [01:10<00:18,  6.81it/s] 73%|███████▎  | 344/471 [01:10<00:20,  6.07it/s] 73%|███████▎  | 345/471 [01:10<00:20,  6.29it/s] 73%|███████▎  | 346/471 [01:11<00:20,  6.21it/s] 74%|███████▎  | 347/471 [01:11<00:20,  5.98it/s] 74%|███████▍  | 348/471 [01:11<00:18,  6.61it/s] 74%|███████▍  | 349/471 [01:11<00:20,  5.98it/s] 74%|███████▍  | 350/471 [01:11<00:18,  6.68it/s] 75%|███████▍  | 351/471 [01:11<00:20,  5.93it/s] 75%|███████▍  | 352/471 [01:12<00:19,  6.25it/s] 75%|███████▍  | 353/471 [01:12<00:19,  6.04it/s] 75%|███████▌  | 354/471 [01:12<00:19,  5.90it/s] 75%|███████▌  | 355/471 [01:12<00:18,  6.38it/s] 76%|███████▌  | 356/471 [01:12<00:18,  6.08it/s] 76%|███████▌  | 357/471 [01:12<00:18,  6.18it/s] 76%|███████▌  | 358/471 [01:13<00:19,  5.94it/s] 76%|███████▌  | 359/471 [01:13<00:17,  6.23it/s] 76%|███████▋  | 360/471 [01:13<00:19,  5.82it/s] 77%|███████▋  | 361/471 [01:13<00:18,  6.10it/s] 77%|███████▋  | 362/471 [01:13<00:18,  5.79it/s] 77%|███████▋  | 363/471 [01:13<00:18,  5.93it/s] 77%|███████▋  | 364/471 [01:14<00:18,  5.80it/s] 77%|███████▋  | 365/471 [01:14<00:18,  5.87it/s] 78%|███████▊  | 366/471 [01:14<00:17,  5.91it/s] 78%|███████▊  | 367/471 [01:14<00:17,  5.82it/s] 78%|███████▊  | 368/471 [01:14<00:17,  5.91it/s] 78%|███████▊  | 369/471 [01:14<00:17,  5.68it/s] 79%|███████▊  | 370/471 [01:15<00:18,  5.35it/s] 79%|███████▉  | 371/471 [01:15<00:20,  4.96it/s] 79%|███████▉  | 372/471 [01:15<00:19,  4.97it/s] 79%|███████▉  | 373/471 [01:15<00:20,  4.78it/s] 79%|███████▉  | 374/471 [01:16<00:19,  5.05it/s] 80%|███████▉  | 375/471 [01:16<00:20,  4.72it/s] 80%|███████▉  | 376/471 [01:16<00:19,  4.88it/s] 80%|████████  | 377/471 [01:16<00:20,  4.59it/s] 80%|████████  | 378/471 [01:16<00:19,  4.80it/s] 80%|████████  | 379/471 [01:17<00:19,  4.60it/s] 81%|████████  | 380/471 [01:17<00:18,  4.84it/s] 81%|████████  | 381/471 [01:17<00:19,  4.63it/s] 81%|████████  | 382/471 [01:17<00:18,  4.69it/s] 81%|████████▏ | 383/471 [01:17<00:18,  4.66it/s] 82%|████████▏ | 384/471 [01:18<00:18,  4.69it/s] 82%|████████▏ | 385/471 [01:18<00:18,  4.77it/s] 82%|████████▏ | 386/471 [01:18<00:18,  4.63it/s] 82%|████████▏ | 387/471 [01:18<00:17,  4.69it/s] 82%|████████▏ | 388/471 [01:19<00:18,  4.55it/s] 83%|████████▎ | 389/471 [01:19<00:17,  4.77it/s] 83%|████████▎ | 390/471 [01:19<00:17,  4.65it/s] 83%|████████▎ | 391/471 [01:19<00:16,  4.84it/s] 83%|████████▎ | 392/471 [01:19<00:17,  4.48it/s] 83%|████████▎ | 393/471 [01:20<00:16,  4.86it/s] 84%|████████▎ | 394/471 [01:20<00:17,  4.49it/s] 84%|████████▍ | 395/471 [01:20<00:15,  4.80it/s] 84%|████████▍ | 396/471 [01:20<00:16,  4.64it/s] 84%|████████▍ | 397/471 [01:20<00:15,  4.70it/s] 85%|████████▍ | 398/471 [01:21<00:15,  4.61it/s] 85%|████████▍ | 399/471 [01:21<00:15,  4.59it/s] 85%|████████▍ | 400/471 [01:21<00:14,  4.83it/s] 85%|████████▌ | 401/471 [01:21<00:14,  4.73it/s] 85%|████████▌ | 402/471 [01:22<00:13,  4.95it/s] 86%|████████▌ | 403/471 [01:22<00:14,  4.62it/s] 86%|████████▌ | 404/471 [01:22<00:13,  5.07it/s] 86%|████████▌ | 405/471 [01:22<00:14,  4.63it/s] 86%|████████▌ | 406/471 [01:22<00:12,  5.03it/s] 86%|████████▋ | 407/471 [01:22<00:12,  5.25it/s] 87%|████████▋ | 408/471 [01:23<00:11,  5.32it/s] 87%|████████▋ | 409/471 [01:23<00:10,  5.93it/s] 87%|████████▋ | 410/471 [01:23<00:10,  5.67it/s] 87%|████████▋ | 411/471 [01:23<00:09,  6.37it/s] 87%|████████▋ | 412/471 [01:23<00:10,  5.79it/s] 88%|████████▊ | 413/471 [01:24<00:10,  5.30it/s] 88%|████████▊ | 414/471 [01:24<00:11,  4.97it/s] 88%|████████▊ | 415/471 [01:24<00:11,  4.90it/s] 88%|████████▊ | 416/471 [01:24<00:11,  4.74it/s] 89%|████████▊ | 417/471 [01:24<00:11,  4.85it/s] 89%|████████▊ | 418/471 [01:25<00:11,  4.70it/s] 89%|████████▉ | 419/471 [01:25<00:11,  4.67it/s] 89%|████████▉ | 420/471 [01:25<00:11,  4.54it/s] 89%|████████▉ | 421/471 [01:25<00:10,  4.64it/s] 90%|████████▉ | 422/471 [01:26<00:10,  4.57it/s] 90%|████████▉ | 423/471 [01:26<00:09,  4.97it/s] 90%|█████████ | 424/471 [01:26<00:10,  4.60it/s] 90%|█████████ | 425/471 [01:26<00:09,  4.76it/s] 90%|█████████ | 426/471 [01:26<00:09,  4.56it/s] 91%|█████████ | 427/471 [01:27<00:09,  4.80it/s] 91%|█████████ | 428/471 [01:27<00:09,  4.61it/s] 91%|█████████ | 429/471 [01:27<00:08,  4.76it/s] 91%|█████████▏| 430/471 [01:27<00:09,  4.46it/s] 92%|█████████▏| 431/471 [01:27<00:08,  4.59it/s] 92%|█████████▏| 432/471 [01:28<00:08,  4.56it/s] 92%|█████████▏| 433/471 [01:28<00:08,  4.63it/s] 92%|█████████▏| 434/471 [01:28<00:07,  4.81it/s] 92%|█████████▏| 435/471 [01:28<00:07,  4.55it/s] 93%|█████████▎| 436/471 [01:28<00:07,  4.81it/s] 93%|█████████▎| 437/471 [01:29<00:07,  4.55it/s] 93%|█████████▎| 438/471 [01:29<00:06,  4.94it/s] 93%|█████████▎| 439/471 [01:29<00:06,  4.62it/s] 93%|█████████▎| 440/471 [01:29<00:06,  4.96it/s] 94%|█████████▎| 441/471 [01:30<00:06,  4.54it/s] 94%|█████████▍| 442/471 [01:30<00:06,  4.78it/s] 94%|█████████▍| 443/471 [01:30<00:05,  4.70it/s] 94%|█████████▍| 444/471 [01:30<00:05,  4.73it/s] 94%|█████████▍| 445/471 [01:30<00:05,  4.72it/s] 95%|█████████▍| 446/471 [01:31<00:05,  4.57it/s] 95%|█████████▍| 447/471 [01:31<00:04,  4.83it/s] 95%|█████████▌| 448/471 [01:31<00:04,  4.64it/s] 95%|█████████▌| 449/471 [01:31<00:04,  5.20it/s] 96%|█████████▌| 450/471 [01:31<00:04,  4.89it/s] 96%|█████████▌| 451/471 [01:32<00:03,  5.20it/s] 96%|█████████▌| 452/471 [01:32<00:04,  4.69it/s] 96%|█████████▌| 453/471 [01:32<00:03,  4.85it/s] 96%|█████████▋| 454/471 [01:32<00:03,  4.79it/s] 97%|█████████▋| 455/471 [01:32<00:03,  4.72it/s] 97%|█████████▋| 456/471 [01:33<00:02,  5.44it/s] 97%|█████████▋| 457/471 [01:33<00:02,  4.83it/s] 97%|█████████▋| 458/471 [01:33<00:02,  5.12it/s] 97%|█████████▋| 459/471 [01:33<00:02,  4.65it/s] 98%|█████████▊| 460/471 [01:33<00:02,  4.98it/s] 98%|█████████▊| 461/471 [01:34<00:02,  4.75it/s] 98%|█████████▊| 462/471 [01:34<00:01,  4.78it/s] 98%|█████████▊| 463/471 [01:34<00:01,  4.67it/s] 99%|█████████▊| 464/471 [01:34<00:01,  4.63it/s] 99%|█████████▊| 465/471 [01:35<00:01,  4.88it/s] 99%|█████████▉| 466/471 [01:35<00:01,  4.76it/s] 99%|█████████▉| 467/471 [01:35<00:00,  5.05it/s] 99%|█████████▉| 468/471 [01:35<00:00,  4.60it/s]100%|█████████▉| 469/471 [01:35<00:00,  4.99it/s]100%|█████████▉| 470/471 [01:36<00:00,  4.57it/s]100%|██████████| 471/471 [01:36<00:00,  4.97it/s]100%|██████████| 471/471 [01:36<00:00,  4.89it/s]
{'eval_loss': 2.2826321125030518, 'eval_model_preparation_time': 0.0047, 'eval_acc': 0.44065321295804566, 'eval_runtime': 96.4844, 'eval_samples_per_second': 78.064, 'eval_steps_per_second': 4.882}
ROUND:8
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:15,  2.49it/s]                                              {'loss': 2.338, 'grad_norm': 3.818678855895996, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:15,  2.49it/s]  5%|▌         | 2/40 [00:00<00:16,  2.34it/s]                                              {'loss': 2.4089, 'grad_norm': 4.329331874847412, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.34it/s]  8%|▊         | 3/40 [00:01<00:16,  2.25it/s]                                              {'loss': 2.2068, 'grad_norm': 3.5767576694488525, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.25it/s] 10%|█         | 4/40 [00:01<00:16,  2.25it/s]                                              {'loss': 2.2552, 'grad_norm': 4.577775478363037, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.25it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.19it/s]                                              {'loss': 2.4809, 'grad_norm': 3.978754758834839, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s]                                              {'loss': 2.2583, 'grad_norm': 3.795414447784424, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 2.3736, 'grad_norm': 3.7289793491363525, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s] 20%|██        | 8/40 [00:03<00:11,  2.89it/s]                                              {'loss': 1.405, 'grad_norm': 7.722500801086426, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.89it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s]                                              {'loss': 2.1743, 'grad_norm': 3.126798391342163, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s]                                               {'loss': 2.1211, 'grad_norm': 3.296522855758667, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.43it/s]                                               {'loss': 2.1439, 'grad_norm': 3.3955678939819336, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.43it/s] 30%|███       | 12/40 [00:05<00:11,  2.39it/s]                                               {'loss': 2.2405, 'grad_norm': 3.7982661724090576, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.39it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.30it/s]                                               {'loss': 2.1284, 'grad_norm': 3.8651490211486816, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.30it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.2895, 'grad_norm': 4.476691722869873, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.27it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.2514, 'grad_norm': 3.144782066345215, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s] 40%|████      | 16/40 [00:06<00:08,  2.81it/s]                                               {'loss': 2.1372, 'grad_norm': 10.92721176147461, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.81it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.64it/s]                                               {'loss': 2.0605, 'grad_norm': 3.39255690574646, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.53it/s]                                               {'loss': 2.1408, 'grad_norm': 3.787605047225952, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.53it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s]                                               {'loss': 2.0047, 'grad_norm': 3.468066930770874, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.44it/s] 50%|█████     | 20/40 [00:08<00:08,  2.42it/s]                                               {'loss': 2.1641, 'grad_norm': 3.522580623626709, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.42it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.43it/s]                                               {'loss': 2.4609, 'grad_norm': 3.581315755844116, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.43it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.35it/s]                                               {'loss': 2.1986, 'grad_norm': 3.9823715686798096, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.35it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.33it/s]                                               {'loss': 2.0645, 'grad_norm': 2.9784257411956787, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.33it/s] 60%|██████    | 24/40 [00:09<00:05,  2.94it/s]                                               {'loss': 2.2005, 'grad_norm': 10.753177642822266, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.94it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.67it/s]                                               {'loss': 2.1937, 'grad_norm': 3.3254735469818115, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.67it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.56it/s]                                               {'loss': 2.1864, 'grad_norm': 3.5237183570861816, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.56it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.47it/s]                                               {'loss': 2.1113, 'grad_norm': 3.1358940601348877, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.47it/s] 70%|███████   | 28/40 [00:11<00:04,  2.40it/s]                                               {'loss': 2.382, 'grad_norm': 4.082594871520996, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.40it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.44it/s]                                               {'loss': 1.9985, 'grad_norm': 4.111281394958496, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.44it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.35it/s]                                               {'loss': 1.9395, 'grad_norm': 4.096014499664307, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.35it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.31it/s]                                               {'loss': 2.2635, 'grad_norm': 5.445534706115723, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.31it/s] 80%|████████  | 32/40 [00:12<00:02,  2.92it/s]                                               {'loss': 2.3333, 'grad_norm': 15.84666633605957, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.92it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.67it/s]                                               {'loss': 2.0087, 'grad_norm': 3.815244436264038, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.67it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.56it/s]                                               {'loss': 2.4025, 'grad_norm': 3.5369677543640137, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.56it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.49it/s]                                               {'loss': 2.0915, 'grad_norm': 4.1248273849487305, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.49it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.43it/s]                                               {'loss': 1.9765, 'grad_norm': 3.6183600425720215, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.43it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.51it/s]                                               {'loss': 2.1333, 'grad_norm': 3.8965678215026855, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.51it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.68it/s]                                               {'loss': 2.0176, 'grad_norm': 3.2765119075775146, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.68it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.79it/s]                                               {'loss': 2.076, 'grad_norm': 3.9574077129364014, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.79it/s]                                               {'loss': 2.3119, 'grad_norm': 20.340238571166992, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.79it/s]                                               {'train_runtime': 15.8598, 'train_samples_per_second': 35.625, 'train_steps_per_second': 2.522, 'train_loss': 2.1733386754989623, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.79it/s]100%|██████████| 40/40 [00:15<00:00,  2.52it/s]
CLIENT:49
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.81it/s]                                              {'loss': 2.2902, 'grad_norm': 3.3348615169525146, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.81it/s]  5%|▌         | 2/40 [00:00<00:13,  2.76it/s]                                              {'loss': 2.2016, 'grad_norm': 2.770512580871582, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.76it/s]  8%|▊         | 3/40 [00:01<00:13,  2.74it/s]                                              {'loss': 2.4095, 'grad_norm': 4.582062721252441, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.74it/s] 10%|█         | 4/40 [00:01<00:13,  2.73it/s]                                              {'loss': 2.2281, 'grad_norm': 2.694598436355591, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.73it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.73it/s]                                              {'loss': 2.2638, 'grad_norm': 3.808488130569458, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.73it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.57it/s]                                              {'loss': 2.2549, 'grad_norm': 3.8775150775909424, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.57it/s] 18%|█▊        | 7/40 [00:02<00:13,  2.39it/s]                                              {'loss': 2.2613, 'grad_norm': 2.759561777114868, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:13,  2.39it/s] 20%|██        | 8/40 [00:02<00:10,  3.13it/s]                                              {'loss': 1.7582, 'grad_norm': 20.941017150878906, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.13it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.78it/s]                                              {'loss': 2.2353, 'grad_norm': 2.715940475463867, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.78it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.55it/s]                                               {'loss': 2.1794, 'grad_norm': 3.871483325958252, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.55it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.46it/s]                                               {'loss': 2.3267, 'grad_norm': 4.302628040313721, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.46it/s] 30%|███       | 12/40 [00:04<00:11,  2.36it/s]                                               {'loss': 2.1696, 'grad_norm': 4.26018762588501, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.3924, 'grad_norm': 4.367890357971191, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s]                                               {'loss': 2.177, 'grad_norm': 2.7411677837371826, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.1051, 'grad_norm': 2.838440179824829, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s] 40%|████      | 16/40 [00:06<00:08,  2.84it/s]                                               {'loss': 1.4764, 'grad_norm': 8.865880966186523, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.84it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.71it/s]                                               {'loss': 1.8864, 'grad_norm': 2.8731472492218018, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.71it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.50it/s]                                               {'loss': 2.0174, 'grad_norm': 2.9829742908477783, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.50it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s]                                               {'loss': 2.0308, 'grad_norm': 3.299755573272705, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s] 50%|█████     | 20/40 [00:07<00:08,  2.38it/s]                                               {'loss': 2.1841, 'grad_norm': 3.4852912425994873, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.38it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.243, 'grad_norm': 3.359389305114746, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.36it/s]                                               {'loss': 2.0786, 'grad_norm': 4.199470043182373, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.36it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.35it/s]                                               {'loss': 2.2353, 'grad_norm': 3.4876513481140137, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.35it/s] 60%|██████    | 24/40 [00:09<00:05,  3.03it/s]                                               {'loss': 2.3961, 'grad_norm': 13.944091796875, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  3.03it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.91it/s]                                               {'loss': 1.9742, 'grad_norm': 3.4828367233276367, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.91it/s] 65%|██████▌   | 26/40 [00:09<00:04,  3.05it/s]                                               {'loss': 2.1533, 'grad_norm': 2.8381359577178955, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  3.05it/s] 68%|██████▊   | 27/40 [00:10<00:04,  3.19it/s]                                               {'loss': 2.4219, 'grad_norm': 6.404078960418701, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  3.19it/s] 70%|███████   | 28/40 [00:10<00:03,  3.31it/s]                                               {'loss': 2.2869, 'grad_norm': 3.6197142601013184, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:03,  3.31it/s] 72%|███████▎  | 29/40 [00:10<00:03,  3.21it/s]                                               {'loss': 2.0075, 'grad_norm': 4.060032844543457, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:03,  3.21it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.83it/s]                                               {'loss': 1.9563, 'grad_norm': 3.3744664192199707, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.83it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.64it/s]                                               {'loss': 2.0263, 'grad_norm': 3.3962035179138184, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.64it/s] 80%|████████  | 32/40 [00:11<00:02,  3.28it/s]                                               {'loss': 1.1354, 'grad_norm': 6.898044109344482, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  3.28it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.81it/s]                                               {'loss': 2.2551, 'grad_norm': 3.692160129547119, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.81it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.60it/s]                                               {'loss': 2.0795, 'grad_norm': 3.3452136516571045, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.60it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.46it/s]                                               {'loss': 2.0448, 'grad_norm': 3.5938236713409424, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.36it/s]                                               {'loss': 2.0155, 'grad_norm': 3.478105068206787, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s]                                               {'loss': 1.9925, 'grad_norm': 3.761828660964966, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.26it/s]                                               {'loss': 2.1904, 'grad_norm': 4.494539737701416, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.26it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.24it/s]                                               {'loss': 1.8497, 'grad_norm': 2.655291795730591, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.24it/s]100%|██████████| 40/40 [00:15<00:00,  2.91it/s]                                               {'loss': 3.4054, 'grad_norm': 13.403411865234375, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.91it/s]                                               {'train_runtime': 15.3225, 'train_samples_per_second': 36.874, 'train_steps_per_second': 2.611, 'train_loss': 2.1399010092020037, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.91it/s]100%|██████████| 40/40 [00:15<00:00,  2.61it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.4058, 'grad_norm': 3.9348011016845703, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]  5%|▌         | 2/40 [00:00<00:16,  2.29it/s]                                              {'loss': 2.2667, 'grad_norm': 3.917869806289673, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.29it/s]  8%|▊         | 3/40 [00:01<00:16,  2.30it/s]                                              {'loss': 2.1504, 'grad_norm': 3.30324649810791, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.30it/s] 10%|█         | 4/40 [00:01<00:15,  2.29it/s]                                              {'loss': 2.4276, 'grad_norm': 3.627938985824585, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.29it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.30it/s]                                              {'loss': 2.3099, 'grad_norm': 3.259190559387207, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.30it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.3583, 'grad_norm': 4.279825687408447, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s]                                              {'loss': 2.2965, 'grad_norm': 3.3944404125213623, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s] 20%|██        | 8/40 [00:03<00:11,  2.86it/s]                                              {'loss': 1.7783, 'grad_norm': 9.794977188110352, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.86it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s]                                              {'loss': 2.117, 'grad_norm': 3.931403160095215, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.1885, 'grad_norm': 3.569901704788208, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.70it/s]                                               {'loss': 2.1971, 'grad_norm': 3.8007254600524902, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.70it/s] 30%|███       | 12/40 [00:04<00:10,  2.66it/s]                                               {'loss': 2.0258, 'grad_norm': 3.339157819747925, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.66it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.65it/s]                                               {'loss': 2.459, 'grad_norm': 3.804537773132324, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.65it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.64it/s]                                               {'loss': 2.2151, 'grad_norm': 3.172199249267578, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.64it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.60it/s]                                               {'loss': 2.209, 'grad_norm': 3.2831263542175293, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.60it/s]                                               {'loss': 2.7369, 'grad_norm': 16.386873245239258, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:09,  2.60it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.03it/s]                                               {'loss': 1.8963, 'grad_norm': 3.6613566875457764, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.03it/s] 45%|████▌     | 18/40 [00:06<00:07,  2.90it/s]                                               {'loss': 2.2012, 'grad_norm': 3.981020450592041, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:07,  2.90it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.86it/s]                                               {'loss': 2.1319, 'grad_norm': 3.6381218433380127, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.86it/s] 50%|█████     | 20/40 [00:07<00:07,  2.69it/s]                                               {'loss': 2.1384, 'grad_norm': 3.931548833847046, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.69it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.51it/s]                                               {'loss': 2.1225, 'grad_norm': 3.411776304244995, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.51it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.45it/s]                                               {'loss': 2.0232, 'grad_norm': 3.9858696460723877, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.45it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.37it/s]                                               {'loss': 2.4696, 'grad_norm': 3.50909161567688, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.37it/s] 60%|██████    | 24/40 [00:09<00:05,  2.93it/s]                                               {'loss': 1.907, 'grad_norm': 12.283089637756348, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.93it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.67it/s]                                               {'loss': 2.1145, 'grad_norm': 2.931790828704834, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.67it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.50it/s]                                               {'loss': 2.0997, 'grad_norm': 3.2601401805877686, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.50it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.39it/s]                                               {'loss': 1.9345, 'grad_norm': 3.600285530090332, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.33it/s]                                               {'loss': 2.1575, 'grad_norm': 3.280665397644043, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s]                                               {'loss': 1.9666, 'grad_norm': 2.9157443046569824, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.22it/s]                                               {'loss': 2.2887, 'grad_norm': 4.11473274230957, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.22it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.21it/s]                                               {'loss': 2.1786, 'grad_norm': 3.652383804321289, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.21it/s]                                               {'loss': 2.4629, 'grad_norm': 13.2670316696167, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:03,  2.21it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.73it/s]                                               {'loss': 2.0631, 'grad_norm': 3.410734176635742, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.73it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.60it/s]                                               {'loss': 2.2161, 'grad_norm': 3.818275213241577, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.60it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.46it/s]                                               {'loss': 2.0315, 'grad_norm': 2.780714750289917, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.41it/s]                                               {'loss': 1.9576, 'grad_norm': 2.645134210586548, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.41it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.32it/s]                                               {'loss': 2.0632, 'grad_norm': 2.9883768558502197, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.32it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s]                                               {'loss': 2.1243, 'grad_norm': 3.010937213897705, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.31it/s]                                               {'loss': 2.0908, 'grad_norm': 3.790496826171875, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.31it/s]100%|██████████| 40/40 [00:15<00:00,  2.88it/s]                                               {'loss': 2.9457, 'grad_norm': 19.094356536865234, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.88it/s]                                               {'train_runtime': 15.9145, 'train_samples_per_second': 35.502, 'train_steps_per_second': 2.513, 'train_loss': 2.19318368434906, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.88it/s]100%|██████████| 40/40 [00:15<00:00,  2.51it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]                                              {'loss': 2.3023, 'grad_norm': 2.8884634971618652, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.28it/s]  5%|▌         | 2/40 [00:00<00:17,  2.17it/s]                                              {'loss': 2.2878, 'grad_norm': 3.6083099842071533, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.17it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.4035, 'grad_norm': 3.721050500869751, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.3515, 'grad_norm': 4.1623454093933105, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.594, 'grad_norm': 4.525665283203125, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.24it/s]                                              {'loss': 2.4362, 'grad_norm': 4.605120658874512, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.24it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s]                                              {'loss': 2.3166, 'grad_norm': 4.308963775634766, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s] 20%|██        | 8/40 [00:03<00:11,  2.87it/s]                                              {'loss': 2.6432, 'grad_norm': 10.894251823425293, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.87it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s]                                              {'loss': 2.3058, 'grad_norm': 3.891756057739258, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.68it/s]                                               {'loss': 2.1482, 'grad_norm': 2.798943042755127, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.68it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.70it/s]                                               {'loss': 2.1624, 'grad_norm': 3.981800079345703, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.70it/s] 30%|███       | 12/40 [00:04<00:10,  2.72it/s]                                               {'loss': 2.2852, 'grad_norm': 4.008078098297119, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.72it/s] 32%|███▎      | 13/40 [00:05<00:09,  2.72it/s]                                               {'loss': 2.1375, 'grad_norm': 3.3666493892669678, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:09,  2.72it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.72it/s]                                               {'loss': 2.4584, 'grad_norm': 4.295848846435547, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.72it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.73it/s]                                               {'loss': 2.245, 'grad_norm': 4.212681293487549, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.73it/s] 40%|████      | 16/40 [00:06<00:07,  3.43it/s]                                               {'loss': 1.7027, 'grad_norm': 11.885285377502441, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.43it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.15it/s]                                               {'loss': 2.2416, 'grad_norm': 3.158707618713379, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.15it/s] 45%|████▌     | 18/40 [00:06<00:07,  2.99it/s]                                               {'loss': 2.2057, 'grad_norm': 3.4129228591918945, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:07,  2.99it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.89it/s]                                               {'loss': 2.2268, 'grad_norm': 3.3781235218048096, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.89it/s] 50%|█████     | 20/40 [00:07<00:07,  2.80it/s]                                               {'loss': 2.2294, 'grad_norm': 3.801424026489258, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.80it/s] 52%|█████▎    | 21/40 [00:07<00:06,  2.76it/s]                                               {'loss': 2.1166, 'grad_norm': 3.5545990467071533, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  2.76it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.73it/s]                                               {'loss': 2.1224, 'grad_norm': 3.131474733352661, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.73it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.71it/s]                                               {'loss': 2.2383, 'grad_norm': 4.119485855102539, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.71it/s]                                               {'loss': 2.4073, 'grad_norm': 13.933117866516113, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.71it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.29it/s]                                               {'loss': 2.0449, 'grad_norm': 3.658799409866333, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.29it/s] 65%|██████▌   | 26/40 [00:09<00:04,  2.90it/s]                                               {'loss': 2.2009, 'grad_norm': 3.373541831970215, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  2.90it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.69it/s]                                               {'loss': 2.1383, 'grad_norm': 2.6986470222473145, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.69it/s] 70%|███████   | 28/40 [00:10<00:04,  2.54it/s]                                               {'loss': 2.4868, 'grad_norm': 3.950453519821167, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.54it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.42it/s]                                               {'loss': 2.1765, 'grad_norm': 4.118983745574951, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.42it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.37it/s]                                               {'loss': 2.1284, 'grad_norm': 3.4887313842773438, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.37it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.30it/s]                                               {'loss': 1.9892, 'grad_norm': 3.1862120628356934, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.30it/s] 80%|████████  | 32/40 [00:11<00:02,  2.88it/s]                                               {'loss': 1.3693, 'grad_norm': 14.18497371673584, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.88it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.74it/s]                                               {'loss': 2.2493, 'grad_norm': 3.3186628818511963, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.74it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.52it/s]                                               {'loss': 2.1817, 'grad_norm': 3.562627077102661, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.52it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.44it/s]                                               {'loss': 2.2317, 'grad_norm': 3.9974377155303955, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.44it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.37it/s]                                               {'loss': 2.1796, 'grad_norm': 3.3200016021728516, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.37it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.31it/s]                                               {'loss': 1.9362, 'grad_norm': 3.5443687438964844, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.35it/s]                                               {'loss': 2.2603, 'grad_norm': 2.9720189571380615, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.35it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]                                               {'loss': 1.8526, 'grad_norm': 3.4143550395965576, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'loss': 2.0244, 'grad_norm': 12.352445602416992, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]                                               {'train_runtime': 15.3556, 'train_samples_per_second': 36.794, 'train_steps_per_second': 2.605, 'train_loss': 2.2004560619592666, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.86it/s]100%|██████████| 40/40 [00:15<00:00,  2.61it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]                                              {'loss': 2.3947, 'grad_norm': 4.361815929412842, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.479, 'grad_norm': 4.833788871765137, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]  8%|▊         | 3/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.4131, 'grad_norm': 3.9466075897216797, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.20it/s] 10%|█         | 4/40 [00:01<00:16,  2.16it/s]                                              {'loss': 2.2693, 'grad_norm': 2.826997756958008, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.16it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.2411, 'grad_norm': 3.3945939540863037, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s]                                              {'loss': 2.3457, 'grad_norm': 3.221217632293701, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.16it/s]                                              {'loss': 2.2403, 'grad_norm': 3.1087183952331543, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.16it/s]                                              {'loss': 2.0672, 'grad_norm': 18.30391502380371, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.16it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s]                                              {'loss': 2.2516, 'grad_norm': 3.151127576828003, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s]                                               {'loss': 2.1595, 'grad_norm': 3.0147769451141357, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.55it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s]                                               {'loss': 2.2181, 'grad_norm': 2.7255148887634277, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s] 30%|███       | 12/40 [00:05<00:11,  2.37it/s]                                               {'loss': 2.1674, 'grad_norm': 3.1340067386627197, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.37it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s]                                               {'loss': 2.4634, 'grad_norm': 3.6420843601226807, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.29it/s]                                               {'loss': 2.3713, 'grad_norm': 3.120232343673706, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.29it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.27it/s]                                               {'loss': 2.3457, 'grad_norm': 3.7018964290618896, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.27it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 3.687, 'grad_norm': 15.514001846313477, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.74it/s]                                               {'loss': 2.0723, 'grad_norm': 3.4464399814605713, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.74it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.53it/s]                                               {'loss': 2.2063, 'grad_norm': 3.2613494396209717, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.53it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.3935, 'grad_norm': 3.43583345413208, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.45it/s] 50%|█████     | 20/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.2465, 'grad_norm': 3.765685558319092, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.41it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.2392, 'grad_norm': 3.41698956489563, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.35it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.40it/s]                                               {'loss': 2.0991, 'grad_norm': 3.064915418624878, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.40it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.2428, 'grad_norm': 3.2837603092193604, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s] 60%|██████    | 24/40 [00:09<00:05,  2.89it/s]                                               {'loss': 1.75, 'grad_norm': 10.768189430236816, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.89it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s]                                               {'loss': 2.1734, 'grad_norm': 2.8140385150909424, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.54it/s]                                               {'loss': 2.0611, 'grad_norm': 2.7603466510772705, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.54it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.47it/s]                                               {'loss': 2.3723, 'grad_norm': 3.9328579902648926, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.47it/s] 70%|███████   | 28/40 [00:11<00:04,  2.47it/s]                                               {'loss': 2.2668, 'grad_norm': 3.284482479095459, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.47it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.40it/s]                                               {'loss': 2.2763, 'grad_norm': 3.4359028339385986, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.40it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s]                                               {'loss': 2.0441, 'grad_norm': 3.9283339977264404, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.33it/s]                                               {'loss': 2.1367, 'grad_norm': 3.481593608856201, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.33it/s] 80%|████████  | 32/40 [00:13<00:02,  2.90it/s]                                               {'loss': 2.225, 'grad_norm': 11.986903190612793, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s]                                               {'loss': 2.1519, 'grad_norm': 3.219435453414917, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s]                                               {'loss': 2.1576, 'grad_norm': 3.545302391052246, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s]                                               {'loss': 2.2683, 'grad_norm': 3.006734609603882, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.38it/s]                                               {'loss': 2.102, 'grad_norm': 3.585599899291992, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.38it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.38it/s]                                               {'loss': 2.1545, 'grad_norm': 3.9626221656799316, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.38it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s]                                               {'loss': 2.26, 'grad_norm': 2.958491325378418, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.31it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.31it/s]                                               {'loss': 2.1979, 'grad_norm': 3.4249796867370605, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.31it/s]100%|██████████| 40/40 [00:16<00:00,  2.93it/s]                                               {'loss': 2.282, 'grad_norm': 11.134467124938965, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.93it/s]                                               {'train_runtime': 16.3345, 'train_samples_per_second': 34.589, 'train_steps_per_second': 2.449, 'train_loss': 2.2623516023159027, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.93it/s]100%|██████████| 40/40 [00:16<00:00,  2.45it/s]
CLIENT:12
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.34it/s]                                              {'loss': 2.3371, 'grad_norm': 6.3739519119262695, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.34it/s]  5%|▌         | 2/40 [00:00<00:16,  2.34it/s]                                              {'loss': 2.633, 'grad_norm': 6.5259222984313965, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.34it/s]  8%|▊         | 3/40 [00:01<00:15,  2.39it/s]                                              {'loss': 2.3268, 'grad_norm': 4.183223724365234, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.39it/s] 10%|█         | 4/40 [00:01<00:15,  2.36it/s]                                              {'loss': 2.3492, 'grad_norm': 4.232117176055908, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.36it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.32it/s]                                              {'loss': 2.4316, 'grad_norm': 3.5208804607391357, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.32it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.28it/s]                                              {'loss': 2.364, 'grad_norm': 4.427529811859131, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.28it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s]                                              {'loss': 2.2195, 'grad_norm': 3.503730535507202, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s] 20%|██        | 8/40 [00:03<00:11,  2.90it/s]                                              {'loss': 1.5972, 'grad_norm': 8.471298217773438, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.90it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.90it/s]                                              {'loss': 2.1909, 'grad_norm': 5.080230236053467, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.90it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.66it/s]                                               {'loss': 2.2629, 'grad_norm': 3.095452308654785, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.66it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.52it/s]                                               {'loss': 2.275, 'grad_norm': 3.1837422847747803, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.52it/s] 30%|███       | 12/40 [00:04<00:11,  2.42it/s]                                               {'loss': 2.2443, 'grad_norm': 4.940281867980957, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.42it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.32it/s]                                               {'loss': 2.2006, 'grad_norm': 4.492996692657471, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.32it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s]                                               {'loss': 2.4612, 'grad_norm': 4.978484630584717, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.2791, 'grad_norm': 3.8754470348358154, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s] 40%|████      | 16/40 [00:06<00:08,  2.90it/s]                                               {'loss': 2.3669, 'grad_norm': 11.939285278320312, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.90it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.83it/s]                                               {'loss': 2.0956, 'grad_norm': 3.1092238426208496, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.83it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.2938, 'grad_norm': 3.863516330718994, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.61it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.46it/s]                                               {'loss': 2.2, 'grad_norm': 4.11769437789917, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.46it/s] 50%|█████     | 20/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.1403, 'grad_norm': 3.6939072608947754, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.3912, 'grad_norm': 4.013236045837402, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s]                                               {'loss': 2.2556, 'grad_norm': 3.670299530029297, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s]                                               {'loss': 2.1665, 'grad_norm': 3.9004249572753906, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s] 60%|██████    | 24/40 [00:09<00:05,  2.83it/s]                                               {'loss': 2.6885, 'grad_norm': 10.767202377319336, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.66it/s]                                               {'loss': 2.0292, 'grad_norm': 3.044671058654785, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.66it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s]                                               {'loss': 2.1167, 'grad_norm': 2.8340718746185303, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.39it/s]                                               {'loss': 2.1908, 'grad_norm': 3.210202693939209, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.0965, 'grad_norm': 4.448107719421387, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.48it/s]                                               {'loss': 2.2732, 'grad_norm': 3.5866637229919434, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.48it/s] 75%|███████▌  | 30/40 [00:12<00:03,  2.55it/s]                                               {'loss': 2.1323, 'grad_norm': 3.663058042526245, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:03,  2.55it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.60it/s]                                               {'loss': 2.248, 'grad_norm': 3.300339937210083, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.60it/s]                                               {'loss': 1.9601, 'grad_norm': 9.676078796386719, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:03,  2.60it/s] 82%|████████▎ | 33/40 [00:12<00:02,  3.24it/s]                                               {'loss': 2.2028, 'grad_norm': 3.001056432723999, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  3.24it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.12it/s]                                               {'loss': 2.0545, 'grad_norm': 2.853823661804199, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.12it/s] 88%|████████▊ | 35/40 [00:13<00:01,  3.03it/s]                                               {'loss': 2.1328, 'grad_norm': 3.3122332096099854, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  3.03it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.97it/s]                                               {'loss': 1.9322, 'grad_norm': 3.3362388610839844, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.97it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.92it/s]                                               {'loss': 2.2215, 'grad_norm': 3.4935429096221924, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.92it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.87it/s]                                               {'loss': 2.1037, 'grad_norm': 3.537898063659668, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.87it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.84it/s]                                               {'loss': 2.0998, 'grad_norm': 2.994204044342041, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.84it/s]100%|██████████| 40/40 [00:15<00:00,  3.59it/s]                                               {'loss': 3.0303, 'grad_norm': 22.03468894958496, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.59it/s]                                               {'train_runtime': 15.2881, 'train_samples_per_second': 36.957, 'train_steps_per_second': 2.616, 'train_loss': 2.2398800015449525, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.59it/s]100%|██████████| 40/40 [00:15<00:00,  2.62it/s]
CLIENT:87
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]                                              {'loss': 2.4584, 'grad_norm': 3.6533050537109375, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.30it/s]  5%|▌         | 2/40 [00:00<00:16,  2.27it/s]                                              {'loss': 2.4456, 'grad_norm': 3.4472224712371826, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.27it/s]  8%|▊         | 3/40 [00:01<00:16,  2.22it/s]                                              {'loss': 2.314, 'grad_norm': 3.673764228820801, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.22it/s] 10%|█         | 4/40 [00:01<00:16,  2.24it/s]                                              {'loss': 2.3869, 'grad_norm': 4.226102352142334, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.24it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s]                                              {'loss': 2.32, 'grad_norm': 3.9574897289276123, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s]                                              {'loss': 2.2384, 'grad_norm': 3.7842226028442383, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.20it/s]                                              {'loss': 2.4019, 'grad_norm': 4.14587926864624, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.20it/s] 20%|██        | 8/40 [00:03<00:11,  2.89it/s]                                              {'loss': 2.697, 'grad_norm': 11.65463924407959, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.89it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.2012, 'grad_norm': 3.925912380218506, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.3845, 'grad_norm': 4.043065071105957, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s]                                               {'loss': 2.2545, 'grad_norm': 3.6040213108062744, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s] 30%|███       | 12/40 [00:05<00:12,  2.33it/s]                                               {'loss': 2.3877, 'grad_norm': 3.7265822887420654, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.33it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.29it/s]                                               {'loss': 2.127, 'grad_norm': 3.7485129833221436, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.29it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.2834, 'grad_norm': 3.8071932792663574, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.28it/s]                                               {'loss': 2.4128, 'grad_norm': 3.250763177871704, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.28it/s]                                               {'loss': 1.7822, 'grad_norm': 12.46536636352539, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:10,  2.28it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.80it/s]                                               {'loss': 2.2131, 'grad_norm': 3.1891438961029053, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.80it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.66it/s]                                               {'loss': 2.1855, 'grad_norm': 3.0589895248413086, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.66it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.54it/s]                                               {'loss': 2.2854, 'grad_norm': 3.45214581489563, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.54it/s] 50%|█████     | 20/40 [00:08<00:08,  2.44it/s]                                               {'loss': 2.1797, 'grad_norm': 3.4849026203155518, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.44it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.39it/s]                                               {'loss': 2.214, 'grad_norm': 3.4347636699676514, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.39it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.1485, 'grad_norm': 4.176789283752441, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.3427, 'grad_norm': 3.265486001968384, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s] 60%|██████    | 24/40 [00:09<00:05,  2.87it/s]                                               {'loss': 2.5736, 'grad_norm': 13.34245777130127, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s]                                               {'loss': 2.2187, 'grad_norm': 2.6714470386505127, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.49it/s]                                               {'loss': 2.3027, 'grad_norm': 3.4941811561584473, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.49it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.48it/s]                                               {'loss': 2.2767, 'grad_norm': 2.967103958129883, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.48it/s] 70%|███████   | 28/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.2022, 'grad_norm': 3.411358118057251, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.37it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.35it/s]                                               {'loss': 2.2641, 'grad_norm': 3.1701557636260986, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.35it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.32it/s]                                               {'loss': 2.0705, 'grad_norm': 3.675830602645874, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.32it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s]                                               {'loss': 2.1544, 'grad_norm': 3.5039162635803223, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.29it/s] 80%|████████  | 32/40 [00:13<00:02,  2.86it/s]                                               {'loss': 2.0219, 'grad_norm': 10.04934310913086, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.86it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.69it/s]                                               {'loss': 2.1941, 'grad_norm': 3.3861711025238037, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.69it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.48it/s]                                               {'loss': 2.2598, 'grad_norm': 3.8353657722473145, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.48it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s]                                               {'loss': 2.2439, 'grad_norm': 4.36855936050415, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.41it/s]                                               {'loss': 2.1077, 'grad_norm': 4.046634674072266, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.41it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.32it/s]                                               {'loss': 2.1352, 'grad_norm': 3.394871950149536, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.32it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.32it/s]                                               {'loss': 2.1249, 'grad_norm': 3.8727166652679443, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.32it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.29it/s]                                               {'loss': 2.2023, 'grad_norm': 3.3228378295898438, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.29it/s]100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'loss': 2.3838, 'grad_norm': 13.065896034240723, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'train_runtime': 16.4049, 'train_samples_per_second': 34.441, 'train_steps_per_second': 2.438, 'train_loss': 2.260023829340935, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]100%|██████████| 40/40 [00:16<00:00,  2.44it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]                                              {'loss': 2.3313, 'grad_norm': 3.565676212310791, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]  5%|▌         | 2/40 [00:00<00:16,  2.30it/s]                                              {'loss': 2.4565, 'grad_norm': 3.5038275718688965, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.30it/s]  8%|▊         | 3/40 [00:01<00:16,  2.26it/s]                                              {'loss': 2.3108, 'grad_norm': 5.036172866821289, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.26it/s] 10%|█         | 4/40 [00:01<00:15,  2.31it/s]                                              {'loss': 2.441, 'grad_norm': 3.8779244422912598, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.31it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s]                                              {'loss': 2.2682, 'grad_norm': 4.455014705657959, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.5356, 'grad_norm': 3.5181119441986084, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.30it/s]                                              {'loss': 2.3991, 'grad_norm': 3.90661883354187, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.30it/s] 20%|██        | 8/40 [00:03<00:10,  2.94it/s]                                              {'loss': 2.6866, 'grad_norm': 11.678877830505371, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.94it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.4865, 'grad_norm': 3.6471874713897705, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s]                                               {'loss': 2.3946, 'grad_norm': 3.380509614944458, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.1019, 'grad_norm': 3.265533685684204, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s] 30%|███       | 12/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.3063, 'grad_norm': 3.892411470413208, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.39it/s]                                               {'loss': 2.1159, 'grad_norm': 3.3681845664978027, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.39it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s]                                               {'loss': 2.2492, 'grad_norm': 3.288705348968506, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.33it/s]                                               {'loss': 2.3531, 'grad_norm': 3.4501094818115234, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.33it/s] 40%|████      | 16/40 [00:06<00:08,  2.91it/s]                                               {'loss': 1.8783, 'grad_norm': 12.95753288269043, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.91it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s]                                               {'loss': 2.2658, 'grad_norm': 3.1927645206451416, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.50it/s]                                               {'loss': 2.0372, 'grad_norm': 3.8306877613067627, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.50it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.2236, 'grad_norm': 3.8606560230255127, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.45it/s] 50%|█████     | 20/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.3122, 'grad_norm': 3.447518825531006, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.33it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.1095, 'grad_norm': 3.200399875640869, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s]                                               {'loss': 2.3805, 'grad_norm': 3.8746466636657715, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.279, 'grad_norm': 4.3491902351379395, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.85it/s]                                               {'loss': 2.7484, 'grad_norm': 16.478548049926758, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s]                                               {'loss': 2.1221, 'grad_norm': 3.3450119495391846, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s]                                               {'loss': 2.2126, 'grad_norm': 3.2498440742492676, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.47it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.41it/s]                                               {'loss': 2.222, 'grad_norm': 3.226874828338623, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.41it/s] 70%|███████   | 28/40 [00:11<00:05,  2.37it/s]                                               {'loss': 2.2091, 'grad_norm': 3.8196394443511963, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.37it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.29it/s]                                               {'loss': 2.0431, 'grad_norm': 3.4984848499298096, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.29it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.1562, 'grad_norm': 3.089719295501709, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.1269, 'grad_norm': 3.6890475749969482, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s] 80%|████████  | 32/40 [00:13<00:02,  2.88it/s]                                               {'loss': 2.1369, 'grad_norm': 15.134963989257812, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.88it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.64it/s]                                               {'loss': 2.1067, 'grad_norm': 3.3109188079833984, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.64it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s]                                               {'loss': 1.9708, 'grad_norm': 3.444840669631958, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s]                                               {'loss': 2.1592, 'grad_norm': 3.480228900909424, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.31it/s]                                               {'loss': 2.2183, 'grad_norm': 3.246980905532837, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.31it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s]                                               {'loss': 2.036, 'grad_norm': 3.6789987087249756, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.24it/s]                                               {'loss': 2.2031, 'grad_norm': 3.5749731063842773, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.24it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.2071, 'grad_norm': 3.692592144012451, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 1.8374, 'grad_norm': 13.27074909210205, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.20it/s]                                               {'train_runtime': 16.4425, 'train_samples_per_second': 34.362, 'train_steps_per_second': 2.433, 'train_loss': 2.240959620475769, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.20it/s]100%|██████████| 40/40 [00:16<00:00,  2.43it/s]
CLIENT:99
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.86it/s]                                              {'loss': 2.2027, 'grad_norm': 2.7975223064422607, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.86it/s]  5%|▌         | 2/40 [00:00<00:13,  2.81it/s]                                              {'loss': 2.2354, 'grad_norm': 3.058222532272339, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.81it/s]  8%|▊         | 3/40 [00:01<00:13,  2.84it/s]                                              {'loss': 2.4017, 'grad_norm': 4.725392818450928, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.84it/s] 10%|█         | 4/40 [00:01<00:12,  2.84it/s]                                              {'loss': 2.3861, 'grad_norm': 3.707906723022461, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.84it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.84it/s]                                              {'loss': 2.4026, 'grad_norm': 4.414916038513184, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.84it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.85it/s]                                              {'loss': 2.3777, 'grad_norm': 3.40983247756958, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.85it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.89it/s]                                              {'loss': 2.257, 'grad_norm': 3.8270647525787354, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.89it/s] 20%|██        | 8/40 [00:02<00:10,  2.99it/s]                                              {'loss': 2.4952, 'grad_norm': 4.427303314208984, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  2.99it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.99it/s]                                              {'loss': 2.338, 'grad_norm': 3.5554425716400146, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.99it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.96it/s]                                               {'loss': 2.2659, 'grad_norm': 3.429311513900757, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.96it/s] 28%|██▊       | 11/40 [00:03<00:09,  2.90it/s]                                               {'loss': 2.2367, 'grad_norm': 3.106438636779785, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:09,  2.90it/s] 30%|███       | 12/40 [00:04<00:09,  2.83it/s]                                               {'loss': 2.1949, 'grad_norm': 3.256287097930908, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.83it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.78it/s]                                               {'loss': 2.2223, 'grad_norm': 3.6539511680603027, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.78it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.55it/s]                                               {'loss': 2.0916, 'grad_norm': 2.675360679626465, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.55it/s] 38%|███▊      | 15/40 [00:05<00:10,  2.43it/s]                                               {'loss': 2.3646, 'grad_norm': 3.535858631134033, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:10,  2.43it/s] 40%|████      | 16/40 [00:05<00:10,  2.39it/s]                                               {'loss': 2.1802, 'grad_norm': 3.5824122428894043, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:10,  2.39it/s] 42%|████▎     | 17/40 [00:06<00:09,  2.32it/s]                                               {'loss': 2.2784, 'grad_norm': 3.5593302249908447, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:09,  2.32it/s] 45%|████▌     | 18/40 [00:06<00:09,  2.30it/s]                                               {'loss': 2.0701, 'grad_norm': 3.13867449760437, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:09,  2.30it/s] 48%|████▊     | 19/40 [00:07<00:09,  2.25it/s]                                               {'loss': 2.1369, 'grad_norm': 3.1449596881866455, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:09,  2.25it/s] 50%|█████     | 20/40 [00:07<00:08,  2.24it/s]                                               {'loss': 2.157, 'grad_norm': 3.2792792320251465, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.24it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s]                                               {'loss': 2.4256, 'grad_norm': 3.7161712646484375, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.27it/s]                                               {'loss': 2.2364, 'grad_norm': 2.5760560035705566, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.27it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.38it/s]                                               {'loss': 2.0833, 'grad_norm': 3.4104220867156982, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.38it/s] 60%|██████    | 24/40 [00:09<00:06,  2.51it/s]                                               {'loss': 2.2752, 'grad_norm': 4.365970134735107, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:06,  2.51it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.52it/s]                                               {'loss': 2.0653, 'grad_norm': 3.512509822845459, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.52it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.64it/s]                                               {'loss': 2.1251, 'grad_norm': 3.2435519695281982, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.64it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.74it/s]                                               {'loss': 2.1607, 'grad_norm': 3.325969934463501, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.74it/s] 70%|███████   | 28/40 [00:10<00:04,  2.85it/s]                                               {'loss': 2.0479, 'grad_norm': 3.7621517181396484, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.85it/s] 72%|███████▎  | 29/40 [00:11<00:03,  2.94it/s]                                               {'loss': 2.1399, 'grad_norm': 3.3338522911071777, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:03,  2.94it/s] 75%|███████▌  | 30/40 [00:11<00:03,  3.00it/s]                                               {'loss': 2.1879, 'grad_norm': 4.074807167053223, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  3.00it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.96it/s]                                               {'loss': 2.1614, 'grad_norm': 3.6936089992523193, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.96it/s] 80%|████████  | 32/40 [00:12<00:02,  2.91it/s]                                               {'loss': 2.4257, 'grad_norm': 3.584473133087158, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.91it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.71it/s]                                               {'loss': 2.0549, 'grad_norm': 2.631366729736328, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.71it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s]                                               {'loss': 2.0455, 'grad_norm': 3.094830274581909, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.39it/s]                                               {'loss': 2.0763, 'grad_norm': 3.1672489643096924, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.39it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.32it/s]                                               {'loss': 1.9818, 'grad_norm': 2.8705031871795654, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.32it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.27it/s]                                               {'loss': 2.314, 'grad_norm': 3.300725221633911, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.22it/s]                                               {'loss': 2.2432, 'grad_norm': 4.5368242263793945, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.22it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.22it/s]                                               {'loss': 2.2769, 'grad_norm': 3.6462597846984863, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.22it/s]100%|██████████| 40/40 [00:15<00:00,  2.24it/s]                                               {'loss': 2.0604, 'grad_norm': 3.100318431854248, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.24it/s]                                               {'train_runtime': 15.7835, 'train_samples_per_second': 40.232, 'train_steps_per_second': 2.534, 'train_loss': 2.217059478163719, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.24it/s]100%|██████████| 40/40 [00:15<00:00,  2.54it/s]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.41it/s]                                              {'loss': 2.2685, 'grad_norm': 4.508697986602783, 'learning_rate': 0.00015835921350012617, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.41it/s]  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.2442, 'grad_norm': 4.161170959472656, 'learning_rate': 0.000154400233162623, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]  8%|▊         | 3/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.2381, 'grad_norm': 4.515889644622803, 'learning_rate': 0.00015044125282511985, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.21it/s] 10%|█         | 4/40 [00:01<00:15,  2.32it/s]                                              {'loss': 2.307, 'grad_norm': 3.660552978515625, 'learning_rate': 0.00014648227248761672, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.32it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s]                                              {'loss': 2.2435, 'grad_norm': 3.3190832138061523, 'learning_rate': 0.00014252329215011357, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.25it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s]                                              {'loss': 2.0936, 'grad_norm': 3.5916378498077393, 'learning_rate': 0.00013856431181261038, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.28it/s]                                              {'loss': 2.5086, 'grad_norm': 4.606098175048828, 'learning_rate': 0.00013460533147510723, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.28it/s] 20%|██        | 8/40 [00:03<00:10,  3.00it/s]                                              {'loss': 1.3648, 'grad_norm': 9.440762519836426, 'learning_rate': 0.00013064635113760407, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  3.00it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.82it/s]                                              {'loss': 2.3628, 'grad_norm': 3.3329825401306152, 'learning_rate': 0.00012668737080010094, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.82it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.80it/s]                                               {'loss': 2.1469, 'grad_norm': 3.284054756164551, 'learning_rate': 0.00012272839046259778, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.80it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.66it/s]                                               {'loss': 2.2786, 'grad_norm': 3.97686767578125, 'learning_rate': 0.00011876941012509463, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.66it/s] 30%|███       | 12/40 [00:04<00:10,  2.66it/s]                                               {'loss': 2.2319, 'grad_norm': 3.9514236450195312, 'learning_rate': 0.00011481042978759147, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.66it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.64it/s]                                               {'loss': 2.0911, 'grad_norm': 4.223237991333008, 'learning_rate': 0.00011085144945008831, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.64it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.60it/s]                                               {'loss': 2.119, 'grad_norm': 3.8265135288238525, 'learning_rate': 0.00010689246911258517, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.60it/s] 38%|███▊      | 15/40 [00:05<00:10,  2.49it/s]                                               {'loss': 2.1331, 'grad_norm': 2.6839003562927246, 'learning_rate': 0.00010293348877508201, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:10,  2.49it/s] 40%|████      | 16/40 [00:06<00:07,  3.12it/s]                                               {'loss': 1.7019, 'grad_norm': 8.324210166931152, 'learning_rate': 9.897450843757885e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.12it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.71it/s]                                               {'loss': 2.2193, 'grad_norm': 2.566821575164795, 'learning_rate': 9.50155281000757e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.71it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.51it/s]                                               {'loss': 2.1004, 'grad_norm': 3.47843074798584, 'learning_rate': 9.105654776257254e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.51it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.35it/s]                                               {'loss': 1.991, 'grad_norm': 2.8586325645446777, 'learning_rate': 8.70975674250694e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.29it/s]                                               {'loss': 2.2793, 'grad_norm': 4.431934833526611, 'learning_rate': 8.313858708756624e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.29it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s]                                               {'loss': 2.0926, 'grad_norm': 2.7322983741760254, 'learning_rate': 7.917960675006308e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:08<00:08,  2.18it/s]                                               {'loss': 2.2146, 'grad_norm': 3.3367536067962646, 'learning_rate': 7.522062641255993e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:08,  2.18it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.18it/s]                                               {'loss': 2.2256, 'grad_norm': 3.506563186645508, 'learning_rate': 7.126164607505678e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.18it/s] 60%|██████    | 24/40 [00:09<00:05,  2.81it/s]                                               {'loss': 1.7324, 'grad_norm': 20.8123836517334, 'learning_rate': 6.730266573755361e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s]                                               {'loss': 2.1675, 'grad_norm': 3.1823227405548096, 'learning_rate': 6.334368540005047e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.42it/s]                                               {'loss': 2.0562, 'grad_norm': 3.494215726852417, 'learning_rate': 5.938470506254731e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.42it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.35it/s]                                               {'loss': 2.1098, 'grad_norm': 3.273037910461426, 'learning_rate': 5.5425724725044156e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.35it/s] 70%|███████   | 28/40 [00:11<00:05,  2.24it/s]                                               {'loss': 2.0612, 'grad_norm': 2.8857195377349854, 'learning_rate': 5.1466744387541006e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.24it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.22it/s]                                               {'loss': 1.9357, 'grad_norm': 2.9407646656036377, 'learning_rate': 4.750776405003785e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.22it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.20it/s]                                               {'loss': 2.1762, 'grad_norm': 2.9411537647247314, 'learning_rate': 4.35487837125347e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.20it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.17it/s]                                               {'loss': 2.2439, 'grad_norm': 3.2017645835876465, 'learning_rate': 3.958980337503154e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.17it/s] 80%|████████  | 32/40 [00:12<00:02,  2.78it/s]                                               {'loss': 2.4134, 'grad_norm': 14.388042449951172, 'learning_rate': 3.563082303752839e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.78it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.56it/s]                                               {'loss': 1.9499, 'grad_norm': 3.068864345550537, 'learning_rate': 3.1671842700025235e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.56it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.40it/s]                                               {'loss': 2.1821, 'grad_norm': 3.0303852558135986, 'learning_rate': 2.7712862362522078e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.40it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s]                                               {'loss': 2.2059, 'grad_norm': 4.739190101623535, 'learning_rate': 2.3753882025018924e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.26it/s]                                               {'loss': 2.0688, 'grad_norm': 2.8118324279785156, 'learning_rate': 1.979490168751577e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.26it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s]                                               {'loss': 1.9629, 'grad_norm': 2.4239487648010254, 'learning_rate': 1.5835921350012617e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.22it/s]                                               {'loss': 2.2522, 'grad_norm': 2.9656217098236084, 'learning_rate': 1.1876941012509462e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.22it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.18it/s]                                               {'loss': 2.0805, 'grad_norm': 3.117901563644409, 'learning_rate': 7.917960675006309e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.18it/s]100%|██████████| 40/40 [00:16<00:00,  2.77it/s]                                               {'loss': 2.0024, 'grad_norm': 11.303754806518555, 'learning_rate': 3.958980337503154e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.77it/s]                                               {'train_runtime': 16.4704, 'train_samples_per_second': 34.304, 'train_steps_per_second': 2.429, 'train_loss': 2.126437583565712, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.77it/s]100%|██████████| 40/40 [00:16<00:00,  2.43it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:41, 11.40it/s]  1%|          | 4/471 [00:00<01:07,  6.93it/s]  1%|          | 5/471 [00:00<01:10,  6.57it/s]  1%|▏         | 6/471 [00:00<01:16,  6.05it/s]  1%|▏         | 7/471 [00:01<01:20,  5.75it/s]  2%|▏         | 8/471 [00:01<01:23,  5.56it/s]  2%|▏         | 9/471 [00:01<01:28,  5.21it/s]  2%|▏         | 10/471 [00:01<01:29,  5.14it/s]  2%|▏         | 11/471 [00:01<01:34,  4.86it/s]  3%|▎         | 12/471 [00:02<01:37,  4.70it/s]  3%|▎         | 13/471 [00:02<01:38,  4.67it/s]  3%|▎         | 14/471 [00:02<01:38,  4.65it/s]  3%|▎         | 15/471 [00:02<01:37,  4.68it/s]  3%|▎         | 16/471 [00:03<01:38,  4.60it/s]  4%|▎         | 17/471 [00:03<01:40,  4.52it/s]  4%|▍         | 18/471 [00:03<01:41,  4.48it/s]  4%|▍         | 19/471 [00:03<01:40,  4.51it/s]  4%|▍         | 20/471 [00:03<01:39,  4.53it/s]  4%|▍         | 21/471 [00:04<01:36,  4.64it/s]  5%|▍         | 22/471 [00:04<01:38,  4.54it/s]  5%|▍         | 23/471 [00:04<01:39,  4.48it/s]  5%|▌         | 24/471 [00:04<01:39,  4.50it/s]  5%|▌         | 25/471 [00:05<01:38,  4.53it/s]  6%|▌         | 26/471 [00:05<01:35,  4.64it/s]  6%|▌         | 27/471 [00:05<01:37,  4.53it/s]  6%|▌         | 28/471 [00:05<01:38,  4.48it/s]  6%|▌         | 29/471 [00:05<01:38,  4.51it/s]  6%|▋         | 30/471 [00:06<01:37,  4.53it/s]  7%|▋         | 31/471 [00:06<01:36,  4.56it/s]  7%|▋         | 32/471 [00:06<01:33,  4.71it/s]  7%|▋         | 33/471 [00:06<01:29,  4.92it/s]  7%|▋         | 34/471 [00:06<01:25,  5.12it/s]  7%|▋         | 35/471 [00:07<01:22,  5.27it/s]  8%|▊         | 36/471 [00:07<01:20,  5.37it/s]  8%|▊         | 37/471 [00:07<01:19,  5.45it/s]  8%|▊         | 38/471 [00:07<01:18,  5.50it/s]  8%|▊         | 39/471 [00:07<01:17,  5.55it/s]  8%|▊         | 40/471 [00:07<01:17,  5.58it/s]  9%|▊         | 41/471 [00:08<01:16,  5.60it/s]  9%|▉         | 42/471 [00:08<01:16,  5.62it/s]  9%|▉         | 43/471 [00:08<01:16,  5.63it/s]  9%|▉         | 44/471 [00:08<01:15,  5.63it/s] 10%|▉         | 45/471 [00:08<01:15,  5.64it/s] 10%|▉         | 46/471 [00:09<01:15,  5.64it/s] 10%|▉         | 47/471 [00:09<01:15,  5.64it/s] 10%|█         | 48/471 [00:09<01:14,  5.65it/s] 10%|█         | 49/471 [00:09<01:14,  5.65it/s] 11%|█         | 50/471 [00:09<01:14,  5.65it/s] 11%|█         | 51/471 [00:09<01:14,  5.65it/s] 11%|█         | 52/471 [00:10<01:14,  5.63it/s] 11%|█▏        | 53/471 [00:10<01:14,  5.62it/s] 11%|█▏        | 54/471 [00:10<01:14,  5.62it/s] 12%|█▏        | 55/471 [00:10<01:13,  5.62it/s] 12%|█▏        | 56/471 [00:10<01:13,  5.63it/s] 12%|█▏        | 57/471 [00:10<01:13,  5.63it/s] 12%|█▏        | 58/471 [00:11<01:13,  5.63it/s] 13%|█▎        | 59/471 [00:11<01:12,  5.65it/s] 13%|█▎        | 60/471 [00:11<01:12,  5.65it/s] 13%|█▎        | 61/471 [00:11<01:12,  5.64it/s] 13%|█▎        | 62/471 [00:11<01:14,  5.46it/s] 13%|█▎        | 63/471 [00:12<01:21,  5.03it/s] 14%|█▎        | 64/471 [00:12<01:24,  4.81it/s] 14%|█▍        | 65/471 [00:12<01:25,  4.75it/s] 14%|█▍        | 66/471 [00:12<01:26,  4.69it/s] 14%|█▍        | 67/471 [00:13<01:26,  4.68it/s] 14%|█▍        | 68/471 [00:13<01:25,  4.72it/s] 15%|█▍        | 69/471 [00:13<01:27,  4.59it/s] 15%|█▍        | 70/471 [00:13<01:28,  4.53it/s] 15%|█▌        | 71/471 [00:13<01:28,  4.54it/s] 15%|█▌        | 72/471 [00:14<01:27,  4.56it/s] 15%|█▌        | 73/471 [00:14<01:25,  4.67it/s] 16%|█▌        | 74/471 [00:14<01:27,  4.56it/s] 16%|█▌        | 75/471 [00:14<01:28,  4.49it/s] 16%|█▌        | 76/471 [00:15<01:27,  4.51it/s] 16%|█▋        | 77/471 [00:15<01:26,  4.54it/s] 17%|█▋        | 78/471 [00:15<01:24,  4.63it/s] 17%|█▋        | 79/471 [00:15<01:26,  4.55it/s] 17%|█▋        | 80/471 [00:15<01:27,  4.49it/s] 17%|█▋        | 81/471 [00:16<01:26,  4.51it/s] 17%|█▋        | 82/471 [00:16<01:25,  4.55it/s] 18%|█▊        | 83/471 [00:16<01:24,  4.58it/s] 18%|█▊        | 84/471 [00:16<01:23,  4.66it/s] 18%|█▊        | 85/471 [00:16<01:24,  4.56it/s] 18%|█▊        | 86/471 [00:17<01:25,  4.50it/s] 18%|█▊        | 87/471 [00:17<01:25,  4.52it/s] 19%|█▊        | 88/471 [00:17<01:24,  4.55it/s] 19%|█▉        | 89/471 [00:17<01:21,  4.66it/s] 19%|█▉        | 90/471 [00:18<01:23,  4.55it/s] 19%|█▉        | 91/471 [00:18<01:24,  4.49it/s] 20%|█▉        | 92/471 [00:18<01:23,  4.52it/s] 20%|█▉        | 93/471 [00:18<01:23,  4.55it/s] 20%|█▉        | 94/471 [00:18<01:22,  4.60it/s] 20%|██        | 95/471 [00:19<01:21,  4.59it/s] 20%|██        | 96/471 [00:19<01:23,  4.52it/s] 21%|██        | 97/471 [00:19<01:23,  4.46it/s] 21%|██        | 98/471 [00:19<01:22,  4.50it/s] 21%|██        | 99/471 [00:20<01:21,  4.54it/s] 21%|██        | 100/471 [00:20<01:17,  4.77it/s] 21%|██▏       | 101/471 [00:20<01:13,  5.02it/s] 22%|██▏       | 102/471 [00:20<01:13,  5.01it/s] 22%|██▏       | 103/471 [00:20<01:14,  4.97it/s] 22%|██▏       | 104/471 [00:21<01:17,  4.76it/s] 22%|██▏       | 105/471 [00:21<01:19,  4.63it/s] 23%|██▎       | 106/471 [00:21<01:19,  4.60it/s] 23%|██▎       | 107/471 [00:21<01:18,  4.61it/s] 23%|██▎       | 108/471 [00:21<01:17,  4.71it/s] 23%|██▎       | 109/471 [00:22<01:18,  4.58it/s] 23%|██▎       | 110/471 [00:22<01:19,  4.52it/s] 24%|██▎       | 111/471 [00:22<01:19,  4.55it/s] 24%|██▍       | 112/471 [00:22<01:18,  4.57it/s] 24%|██▍       | 113/471 [00:23<01:17,  4.65it/s] 24%|██▍       | 114/471 [00:23<01:18,  4.57it/s] 24%|██▍       | 115/471 [00:23<01:18,  4.51it/s] 25%|██▍       | 116/471 [00:23<01:18,  4.53it/s] 25%|██▍       | 117/471 [00:23<01:17,  4.55it/s] 25%|██▌       | 118/471 [00:24<01:17,  4.58it/s] 25%|██▌       | 119/471 [00:24<01:15,  4.67it/s] 25%|██▌       | 120/471 [00:24<01:17,  4.55it/s] 26%|██▌       | 121/471 [00:24<01:17,  4.50it/s] 26%|██▌       | 122/471 [00:25<01:17,  4.52it/s] 26%|██▌       | 123/471 [00:25<01:16,  4.56it/s] 26%|██▋       | 124/471 [00:25<01:14,  4.67it/s] 27%|██▋       | 125/471 [00:25<01:16,  4.55it/s] 27%|██▋       | 126/471 [00:25<01:16,  4.49it/s] 27%|██▋       | 127/471 [00:26<01:16,  4.52it/s] 27%|██▋       | 128/471 [00:26<01:15,  4.54it/s] 27%|██▋       | 129/471 [00:26<01:14,  4.61it/s] 28%|██▊       | 130/471 [00:26<01:14,  4.55it/s] 28%|██▊       | 131/471 [00:26<01:15,  4.49it/s] 28%|██▊       | 132/471 [00:27<01:14,  4.53it/s] 28%|██▊       | 133/471 [00:27<01:14,  4.54it/s] 28%|██▊       | 134/471 [00:27<01:14,  4.55it/s] 29%|██▊       | 135/471 [00:27<01:12,  4.64it/s] 29%|██▉       | 136/471 [00:28<01:13,  4.53it/s] 29%|██▉       | 137/471 [00:28<01:14,  4.48it/s] 29%|██▉       | 138/471 [00:28<01:13,  4.52it/s] 30%|██▉       | 139/471 [00:28<01:12,  4.55it/s] 30%|██▉       | 140/471 [00:28<01:10,  4.68it/s] 30%|██▉       | 141/471 [00:29<01:09,  4.74it/s] 30%|███       | 142/471 [00:29<01:11,  4.61it/s] 30%|███       | 143/471 [00:29<01:12,  4.53it/s] 31%|███       | 144/471 [00:29<01:11,  4.55it/s] 31%|███       | 145/471 [00:30<01:11,  4.57it/s] 31%|███       | 146/471 [00:30<01:10,  4.61it/s] 31%|███       | 147/471 [00:30<01:09,  4.66it/s] 31%|███▏      | 148/471 [00:30<01:10,  4.56it/s] 32%|███▏      | 149/471 [00:30<01:11,  4.49it/s] 32%|███▏      | 150/471 [00:31<01:11,  4.51it/s] 32%|███▏      | 151/471 [00:31<01:10,  4.54it/s] 32%|███▏      | 152/471 [00:31<01:08,  4.65it/s] 32%|███▏      | 153/471 [00:31<01:09,  4.54it/s] 33%|███▎      | 154/471 [00:32<01:10,  4.49it/s] 33%|███▎      | 155/471 [00:32<01:09,  4.53it/s] 33%|███▎      | 156/471 [00:32<01:09,  4.56it/s] 33%|███▎      | 157/471 [00:32<01:07,  4.67it/s] 34%|███▎      | 158/471 [00:32<01:08,  4.56it/s] 34%|███▍      | 159/471 [00:33<01:09,  4.50it/s] 34%|███▍      | 160/471 [00:33<01:08,  4.53it/s] 34%|███▍      | 161/471 [00:33<01:08,  4.55it/s] 34%|███▍      | 162/471 [00:33<01:07,  4.56it/s] 35%|███▍      | 163/471 [00:33<01:06,  4.65it/s] 35%|███▍      | 164/471 [00:34<01:07,  4.56it/s] 35%|███▌      | 165/471 [00:34<01:08,  4.50it/s] 35%|███▌      | 166/471 [00:34<01:07,  4.52it/s] 35%|███▌      | 167/471 [00:34<01:06,  4.56it/s] 36%|███▌      | 168/471 [00:35<01:05,  4.65it/s] 36%|███▌      | 169/471 [00:35<01:06,  4.54it/s] 36%|███▌      | 170/471 [00:35<01:07,  4.49it/s] 36%|███▋      | 171/471 [00:35<01:06,  4.53it/s] 37%|███▋      | 172/471 [00:35<01:05,  4.55it/s] 37%|███▋      | 173/471 [00:36<01:04,  4.63it/s] 37%|███▋      | 174/471 [00:36<01:05,  4.54it/s] 37%|███▋      | 175/471 [00:36<01:05,  4.49it/s] 37%|███▋      | 176/471 [00:36<01:06,  4.45it/s] 38%|███▊      | 177/471 [00:37<01:05,  4.49it/s] 38%|███▊      | 178/471 [00:37<01:04,  4.53it/s] 38%|███▊      | 179/471 [00:37<01:02,  4.68it/s] 38%|███▊      | 180/471 [00:37<01:01,  4.74it/s] 38%|███▊      | 181/471 [00:37<01:03,  4.60it/s] 39%|███▊      | 182/471 [00:38<01:03,  4.52it/s] 39%|███▉      | 183/471 [00:38<01:03,  4.55it/s] 39%|███▉      | 184/471 [00:38<01:02,  4.57it/s] 39%|███▉      | 185/471 [00:38<01:01,  4.66it/s] 39%|███▉      | 186/471 [00:39<01:02,  4.54it/s] 40%|███▉      | 187/471 [00:39<01:03,  4.48it/s] 40%|███▉      | 188/471 [00:39<01:02,  4.52it/s] 40%|████      | 189/471 [00:39<01:01,  4.55it/s] 40%|████      | 190/471 [00:39<01:01,  4.59it/s] 41%|████      | 191/471 [00:40<01:00,  4.66it/s] 41%|████      | 192/471 [00:40<01:01,  4.57it/s] 41%|████      | 193/471 [00:40<01:01,  4.50it/s] 41%|████      | 194/471 [00:40<01:01,  4.52it/s] 41%|████▏     | 195/471 [00:41<01:00,  4.55it/s] 42%|████▏     | 196/471 [00:41<00:59,  4.64it/s] 42%|████▏     | 197/471 [00:41<01:00,  4.53it/s] 42%|████▏     | 198/471 [00:41<01:01,  4.47it/s] 42%|████▏     | 199/471 [00:41<01:00,  4.51it/s] 42%|████▏     | 200/471 [00:42<00:59,  4.54it/s] 43%|████▎     | 201/471 [00:42<00:58,  4.65it/s] 43%|████▎     | 202/471 [00:42<00:59,  4.56it/s] 43%|████▎     | 203/471 [00:42<00:59,  4.49it/s] 43%|████▎     | 204/471 [00:43<00:59,  4.50it/s] 44%|████▎     | 205/471 [00:43<00:58,  4.53it/s] 44%|████▎     | 206/471 [00:43<00:58,  4.56it/s] 44%|████▍     | 207/471 [00:43<00:56,  4.67it/s] 44%|████▍     | 208/471 [00:43<00:57,  4.55it/s] 44%|████▍     | 209/471 [00:44<00:58,  4.49it/s] 45%|████▍     | 210/471 [00:44<00:57,  4.51it/s] 45%|████▍     | 211/471 [00:44<00:57,  4.55it/s] 45%|████▌     | 212/471 [00:44<00:55,  4.65it/s] 45%|████▌     | 213/471 [00:44<00:56,  4.55it/s] 45%|████▌     | 214/471 [00:45<00:56,  4.57it/s] 46%|████▌     | 215/471 [00:45<00:53,  4.76it/s] 46%|████▌     | 216/471 [00:45<00:51,  4.94it/s] 46%|████▌     | 217/471 [00:45<00:48,  5.19it/s] 46%|████▋     | 218/471 [00:45<00:46,  5.40it/s] 46%|████▋     | 219/471 [00:46<00:47,  5.33it/s] 47%|████▋     | 220/471 [00:46<00:46,  5.42it/s] 47%|████▋     | 221/471 [00:46<00:44,  5.66it/s] 47%|████▋     | 222/471 [00:46<00:41,  6.01it/s] 47%|████▋     | 223/471 [00:46<00:39,  6.24it/s] 48%|████▊     | 224/471 [00:46<00:36,  6.70it/s] 48%|████▊     | 225/471 [00:47<00:37,  6.54it/s] 48%|████▊     | 226/471 [00:47<00:41,  5.93it/s] 48%|████▊     | 227/471 [00:47<00:42,  5.74it/s] 48%|████▊     | 228/471 [00:47<00:43,  5.61it/s] 49%|████▊     | 229/471 [00:47<00:42,  5.74it/s] 49%|████▉     | 230/471 [00:47<00:43,  5.54it/s] 49%|████▉     | 231/471 [00:48<00:44,  5.43it/s] 49%|████▉     | 232/471 [00:48<00:43,  5.46it/s] 49%|████▉     | 233/471 [00:48<00:44,  5.30it/s] 50%|████▉     | 234/471 [00:48<00:46,  5.09it/s] 50%|████▉     | 235/471 [00:48<00:47,  4.98it/s] 50%|█████     | 236/471 [00:49<00:49,  4.75it/s] 50%|█████     | 237/471 [00:49<00:50,  4.67it/s] 51%|█████     | 238/471 [00:49<00:50,  4.64it/s] 51%|█████     | 239/471 [00:49<00:50,  4.60it/s] 51%|█████     | 240/471 [00:50<00:49,  4.67it/s] 51%|█████     | 241/471 [00:50<00:51,  4.50it/s] 51%|█████▏    | 242/471 [00:50<00:50,  4.50it/s] 52%|█████▏    | 243/471 [00:50<00:50,  4.49it/s] 52%|█████▏    | 244/471 [00:50<00:49,  4.56it/s] 52%|█████▏    | 245/471 [00:51<00:48,  4.64it/s] 52%|█████▏    | 246/471 [00:51<00:48,  4.59it/s] 52%|█████▏    | 247/471 [00:51<00:49,  4.49it/s] 53%|█████▎    | 248/471 [00:51<00:49,  4.50it/s] 53%|█████▎    | 249/471 [00:52<00:49,  4.51it/s] 53%|█████▎    | 250/471 [00:52<00:47,  4.61it/s] 53%|█████▎    | 251/471 [00:52<00:47,  4.64it/s] 54%|█████▎    | 252/471 [00:52<00:47,  4.58it/s] 54%|█████▎    | 253/471 [00:52<00:47,  4.56it/s] 54%|█████▍    | 254/471 [00:53<00:47,  4.57it/s] 54%|█████▍    | 255/471 [00:53<00:46,  4.68it/s] 54%|█████▍    | 256/471 [00:53<00:46,  4.66it/s] 55%|█████▍    | 257/471 [00:53<00:43,  4.96it/s] 55%|█████▍    | 258/471 [00:53<00:41,  5.08it/s] 55%|█████▍    | 259/471 [00:54<00:40,  5.29it/s] 55%|█████▌    | 260/471 [00:54<00:39,  5.38it/s] 55%|█████▌    | 261/471 [00:54<00:38,  5.52it/s] 56%|█████▌    | 262/471 [00:54<00:37,  5.53it/s] 56%|█████▌    | 263/471 [00:54<00:36,  5.63it/s] 56%|█████▌    | 264/471 [00:54<00:37,  5.58it/s] 56%|█████▋    | 265/471 [00:55<00:36,  5.65it/s] 56%|█████▋    | 266/471 [00:55<00:36,  5.64it/s] 57%|█████▋    | 267/471 [00:55<00:36,  5.64it/s] 57%|█████▋    | 268/471 [00:55<00:35,  5.72it/s] 57%|█████▋    | 269/471 [00:55<00:36,  5.56it/s] 57%|█████▋    | 270/471 [00:56<00:34,  5.75it/s] 58%|█████▊    | 271/471 [00:56<00:35,  5.59it/s] 58%|█████▊    | 272/471 [00:56<00:34,  5.72it/s] 58%|█████▊    | 273/471 [00:56<00:35,  5.64it/s] 58%|█████▊    | 274/471 [00:56<00:34,  5.70it/s] 58%|█████▊    | 275/471 [00:56<00:34,  5.66it/s] 59%|█████▊    | 276/471 [00:57<00:32,  5.96it/s] 59%|█████▉    | 277/471 [00:57<00:31,  6.24it/s] 59%|█████▉    | 278/471 [00:57<00:29,  6.49it/s] 59%|█████▉    | 279/471 [00:57<00:28,  6.65it/s] 59%|█████▉    | 280/471 [00:57<00:28,  6.71it/s] 60%|█████▉    | 281/471 [00:57<00:26,  7.06it/s] 60%|█████▉    | 282/471 [00:57<00:27,  6.76it/s] 60%|██████    | 283/471 [00:58<00:29,  6.41it/s] 60%|██████    | 284/471 [00:58<00:32,  5.79it/s] 61%|██████    | 285/471 [00:58<00:32,  5.79it/s] 61%|██████    | 286/471 [00:58<00:33,  5.48it/s] 61%|██████    | 287/471 [00:58<00:33,  5.54it/s] 61%|██████    | 288/471 [00:59<00:36,  5.01it/s] 61%|██████▏   | 289/471 [00:59<00:37,  4.92it/s] 62%|██████▏   | 290/471 [00:59<00:38,  4.73it/s] 62%|██████▏   | 291/471 [00:59<00:38,  4.69it/s] 62%|██████▏   | 292/471 [00:59<00:38,  4.65it/s] 62%|██████▏   | 293/471 [01:00<00:38,  4.59it/s] 62%|██████▏   | 294/471 [01:00<00:38,  4.63it/s] 63%|██████▎   | 295/471 [01:00<00:38,  4.53it/s] 63%|██████▎   | 296/471 [01:00<00:37,  4.62it/s] 63%|██████▎   | 297/471 [01:01<00:38,  4.51it/s] 63%|██████▎   | 298/471 [01:01<00:36,  4.70it/s] 63%|██████▎   | 299/471 [01:01<00:38,  4.43it/s] 64%|██████▎   | 300/471 [01:01<00:36,  4.69it/s] 64%|██████▍   | 301/471 [01:01<00:38,  4.43it/s] 64%|██████▍   | 302/471 [01:02<00:36,  4.65it/s] 64%|██████▍   | 303/471 [01:02<00:37,  4.42it/s] 65%|██████▍   | 304/471 [01:02<00:36,  4.58it/s] 65%|██████▍   | 305/471 [01:02<00:36,  4.50it/s] 65%|██████▍   | 306/471 [01:03<00:36,  4.48it/s] 65%|██████▌   | 307/471 [01:03<00:35,  4.58it/s] 65%|██████▌   | 308/471 [01:03<00:36,  4.49it/s] 66%|██████▌   | 309/471 [01:03<00:34,  4.63it/s] 66%|██████▌   | 310/471 [01:03<00:35,  4.53it/s] 66%|██████▌   | 311/471 [01:04<00:34,  4.70it/s] 66%|██████▌   | 312/471 [01:04<00:35,  4.44it/s] 66%|██████▋   | 313/471 [01:04<00:33,  4.68it/s] 67%|██████▋   | 314/471 [01:04<00:35,  4.42it/s] 67%|██████▋   | 315/471 [01:05<00:33,  4.69it/s] 67%|██████▋   | 316/471 [01:05<00:34,  4.45it/s] 67%|██████▋   | 317/471 [01:05<00:33,  4.54it/s] 68%|██████▊   | 318/471 [01:05<00:33,  4.51it/s] 68%|██████▊   | 319/471 [01:05<00:33,  4.48it/s] 68%|██████▊   | 320/471 [01:06<00:32,  4.62it/s] 68%|██████▊   | 321/471 [01:06<00:33,  4.47it/s] 68%|██████▊   | 322/471 [01:06<00:32,  4.59it/s] 69%|██████▊   | 323/471 [01:06<00:33,  4.48it/s] 69%|██████▉   | 324/471 [01:06<00:31,  4.69it/s] 69%|██████▉   | 325/471 [01:07<00:32,  4.45it/s] 69%|██████▉   | 326/471 [01:07<00:31,  4.65it/s] 69%|██████▉   | 327/471 [01:07<00:32,  4.40it/s] 70%|██████▉   | 328/471 [01:07<00:30,  4.68it/s] 70%|██████▉   | 329/471 [01:08<00:32,  4.43it/s] 70%|███████   | 330/471 [01:08<00:31,  4.53it/s] 70%|███████   | 331/471 [01:08<00:31,  4.48it/s] 70%|███████   | 332/471 [01:08<00:31,  4.46it/s] 71%|███████   | 333/471 [01:08<00:29,  4.68it/s] 71%|███████   | 334/471 [01:09<00:30,  4.50it/s] 71%|███████   | 335/471 [01:09<00:29,  4.62it/s] 71%|███████▏  | 336/471 [01:09<00:29,  4.51it/s] 72%|███████▏  | 337/471 [01:09<00:28,  4.71it/s] 72%|███████▏  | 338/471 [01:10<00:29,  4.49it/s] 72%|███████▏  | 339/471 [01:10<00:28,  4.66it/s] 72%|███████▏  | 340/471 [01:10<00:29,  4.40it/s] 72%|███████▏  | 341/471 [01:10<00:27,  4.66it/s] 73%|███████▎  | 342/471 [01:10<00:29,  4.40it/s] 73%|███████▎  | 343/471 [01:11<00:28,  4.54it/s] 73%|███████▎  | 344/471 [01:11<00:28,  4.47it/s] 73%|███████▎  | 345/471 [01:11<00:28,  4.45it/s] 73%|███████▎  | 346/471 [01:11<00:27,  4.63it/s] 74%|███████▎  | 347/471 [01:12<00:27,  4.48it/s] 74%|███████▍  | 348/471 [01:12<00:25,  4.77it/s] 74%|███████▍  | 349/471 [01:12<00:25,  4.79it/s] 74%|███████▍  | 350/471 [01:12<00:22,  5.27it/s] 75%|███████▍  | 351/471 [01:12<00:23,  5.10it/s] 75%|███████▍  | 352/471 [01:12<00:22,  5.35it/s] 75%|███████▍  | 353/471 [01:13<00:22,  5.18it/s] 75%|███████▌  | 354/471 [01:13<00:22,  5.24it/s] 75%|███████▌  | 355/471 [01:13<00:21,  5.34it/s] 76%|███████▌  | 356/471 [01:13<00:21,  5.32it/s] 76%|███████▌  | 357/471 [01:13<00:20,  5.54it/s] 76%|███████▌  | 358/471 [01:14<00:21,  5.32it/s] 76%|███████▌  | 359/471 [01:14<00:19,  5.68it/s] 76%|███████▋  | 360/471 [01:14<00:20,  5.29it/s] 77%|███████▋  | 361/471 [01:14<00:19,  5.73it/s] 77%|███████▋  | 362/471 [01:14<00:21,  4.97it/s] 77%|███████▋  | 363/471 [01:15<00:21,  4.92it/s] 77%|███████▋  | 364/471 [01:15<00:22,  4.79it/s] 77%|███████▋  | 365/471 [01:15<00:22,  4.63it/s] 78%|███████▊  | 366/471 [01:15<00:21,  4.87it/s] 78%|███████▊  | 367/471 [01:15<00:22,  4.66it/s] 78%|███████▊  | 368/471 [01:16<00:22,  4.68it/s] 78%|███████▊  | 369/471 [01:16<00:22,  4.56it/s] 79%|███████▊  | 370/471 [01:16<00:22,  4.59it/s] 79%|███████▉  | 371/471 [01:16<00:22,  4.51it/s] 79%|███████▉  | 372/471 [01:17<00:21,  4.63it/s] 79%|███████▉  | 373/471 [01:17<00:21,  4.50it/s] 79%|███████▉  | 374/471 [01:17<00:20,  4.70it/s] 80%|███████▉  | 375/471 [01:17<00:21,  4.55it/s] 80%|███████▉  | 376/471 [01:17<00:20,  4.59it/s] 80%|████████  | 377/471 [01:18<00:20,  4.48it/s] 80%|████████  | 378/471 [01:18<00:20,  4.49it/s] 80%|████████  | 379/471 [01:18<00:20,  4.51it/s] 81%|████████  | 380/471 [01:18<00:20,  4.49it/s] 81%|████████  | 381/471 [01:19<00:19,  4.52it/s] 81%|████████  | 382/471 [01:19<00:19,  4.50it/s] 81%|████████▏ | 383/471 [01:19<00:19,  4.48it/s] 82%|████████▏ | 384/471 [01:19<00:19,  4.51it/s] 82%|████████▏ | 385/471 [01:19<00:19,  4.49it/s] 82%|████████▏ | 386/471 [01:20<00:18,  4.53it/s] 82%|████████▏ | 387/471 [01:20<00:18,  4.50it/s] 82%|████████▏ | 388/471 [01:20<00:18,  4.54it/s] 83%|████████▎ | 389/471 [01:20<00:17,  4.59it/s] 83%|████████▎ | 390/471 [01:21<00:18,  4.49it/s] 83%|████████▎ | 391/471 [01:21<00:17,  4.57it/s] 83%|████████▎ | 392/471 [01:21<00:17,  4.45it/s] 83%|████████▎ | 393/471 [01:21<00:17,  4.51it/s] 84%|████████▎ | 394/471 [01:21<00:17,  4.44it/s] 84%|████████▍ | 395/471 [01:22<00:16,  4.52it/s] 84%|████████▍ | 396/471 [01:22<00:16,  4.51it/s] 84%|████████▍ | 397/471 [01:22<00:16,  4.57it/s] 85%|████████▍ | 398/471 [01:22<00:16,  4.53it/s] 85%|████████▍ | 399/471 [01:23<00:15,  4.64it/s] 85%|████████▍ | 400/471 [01:23<00:15,  4.58it/s] 85%|████████▌ | 401/471 [01:23<00:15,  4.64it/s] 85%|████████▌ | 402/471 [01:23<00:15,  4.59it/s] 86%|████████▌ | 403/471 [01:23<00:14,  4.56it/s] 86%|████████▌ | 404/471 [01:24<00:14,  4.63it/s] 86%|████████▌ | 405/471 [01:24<00:14,  4.47it/s] 86%|████████▌ | 406/471 [01:24<00:14,  4.59it/s] 86%|████████▋ | 407/471 [01:24<00:14,  4.43it/s] 87%|████████▋ | 408/471 [01:25<00:13,  4.57it/s] 87%|████████▋ | 409/471 [01:25<00:13,  4.43it/s] 87%|████████▋ | 410/471 [01:25<00:13,  4.65it/s] 87%|████████▋ | 411/471 [01:25<00:13,  4.37it/s] 87%|████████▋ | 412/471 [01:25<00:12,  4.64it/s] 88%|████████▊ | 413/471 [01:26<00:13,  4.37it/s] 88%|████████▊ | 414/471 [01:26<00:12,  4.67it/s] 88%|████████▊ | 415/471 [01:26<00:12,  4.46it/s] 88%|████████▊ | 416/471 [01:26<00:12,  4.54it/s] 89%|████████▊ | 417/471 [01:27<00:12,  4.47it/s] 89%|████████▊ | 418/471 [01:27<00:11,  4.50it/s] 89%|████████▉ | 419/471 [01:27<00:11,  4.59it/s] 89%|████████▉ | 420/471 [01:27<00:11,  4.51it/s] 89%|████████▉ | 421/471 [01:27<00:10,  4.61it/s] 90%|████████▉ | 422/471 [01:28<00:10,  4.54it/s] 90%|████████▉ | 423/471 [01:28<00:10,  4.65it/s] 90%|█████████ | 424/471 [01:28<00:10,  4.48it/s] 90%|█████████ | 425/471 [01:28<00:09,  4.72it/s] 90%|█████████ | 426/471 [01:29<00:10,  4.41it/s] 91%|█████████ | 427/471 [01:29<00:09,  4.77it/s] 91%|█████████ | 428/471 [01:29<00:09,  4.48it/s] 91%|█████████ | 429/471 [01:29<00:08,  4.68it/s] 91%|█████████▏| 430/471 [01:29<00:09,  4.41it/s] 92%|█████████▏| 431/471 [01:30<00:08,  4.61it/s] 92%|█████████▏| 432/471 [01:30<00:08,  4.41it/s] 92%|█████████▏| 433/471 [01:30<00:08,  4.55it/s] 92%|█████████▏| 434/471 [01:30<00:08,  4.45it/s] 92%|█████████▏| 435/471 [01:30<00:07,  4.50it/s] 93%|█████████▎| 436/471 [01:31<00:07,  4.50it/s] 93%|█████████▎| 437/471 [01:31<00:07,  4.55it/s] 93%|█████████▎| 438/471 [01:31<00:07,  4.51it/s] 93%|█████████▎| 439/471 [01:31<00:07,  4.52it/s] 93%|█████████▎| 440/471 [01:32<00:06,  4.61it/s] 94%|█████████▎| 441/471 [01:32<00:06,  4.46it/s] 94%|█████████▍| 442/471 [01:32<00:06,  4.67it/s] 94%|█████████▍| 443/471 [01:32<00:06,  4.46it/s] 94%|█████████▍| 444/471 [01:32<00:05,  4.69it/s] 94%|█████████▍| 445/471 [01:33<00:05,  4.43it/s] 95%|█████████▍| 446/471 [01:33<00:05,  4.65it/s] 95%|█████████▍| 447/471 [01:33<00:05,  4.41it/s] 95%|█████████▌| 448/471 [01:33<00:04,  4.66it/s] 95%|█████████▌| 449/471 [01:34<00:05,  4.39it/s] 96%|█████████▌| 450/471 [01:34<00:04,  4.63it/s] 96%|█████████▌| 451/471 [01:34<00:04,  4.52it/s] 96%|█████████▌| 452/471 [01:34<00:04,  4.57it/s] 96%|█████████▌| 453/471 [01:34<00:03,  4.55it/s] 96%|█████████▋| 454/471 [01:35<00:03,  4.49it/s] 97%|█████████▋| 455/471 [01:35<00:03,  4.67it/s] 97%|█████████▋| 456/471 [01:35<00:03,  4.46it/s] 97%|█████████▋| 457/471 [01:35<00:02,  4.68it/s] 97%|█████████▋| 458/471 [01:36<00:02,  4.46it/s] 97%|█████████▋| 459/471 [01:36<00:02,  4.67it/s] 98%|█████████▊| 460/471 [01:36<00:02,  4.42it/s] 98%|█████████▊| 461/471 [01:36<00:02,  4.73it/s] 98%|█████████▊| 462/471 [01:36<00:02,  4.44it/s] 98%|█████████▊| 463/471 [01:37<00:01,  4.70it/s] 99%|█████████▊| 464/471 [01:37<00:01,  4.54it/s] 99%|█████████▊| 465/471 [01:37<00:01,  4.63it/s] 99%|█████████▉| 466/471 [01:37<00:01,  4.65it/s] 99%|█████████▉| 467/471 [01:37<00:00,  4.53it/s] 99%|█████████▉| 468/471 [01:38<00:00,  4.69it/s]100%|█████████▉| 469/471 [01:38<00:00,  4.47it/s]100%|█████████▉| 470/471 [01:38<00:00,  4.81it/s]100%|██████████| 471/471 [01:38<00:00,  4.81it/s]100%|██████████| 471/471 [01:38<00:00,  4.77it/s]
{'eval_loss': 2.2267637252807617, 'eval_model_preparation_time': 0.0053, 'eval_acc': 0.45193839617631437, 'eval_runtime': 99.0167, 'eval_samples_per_second': 76.068, 'eval_steps_per_second': 4.757}
ROUND:9
CLIENT:8
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.14it/s]                                              {'loss': 2.1589, 'grad_norm': 4.0756001472473145, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.14it/s]  5%|▌         | 2/40 [00:01<00:30,  1.23it/s]                                              {'loss': 2.2795, 'grad_norm': 4.9576311111450195, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:30,  1.23it/s]  8%|▊         | 3/40 [00:01<00:24,  1.53it/s]                                              {'loss': 2.1876, 'grad_norm': 4.475869655609131, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:24,  1.53it/s] 10%|█         | 4/40 [00:02<00:20,  1.73it/s]                                              {'loss': 2.4093, 'grad_norm': 3.812128782272339, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.73it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.87it/s]                                              {'loss': 2.4252, 'grad_norm': 4.677271366119385, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.87it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.97it/s]                                              {'loss': 2.4296, 'grad_norm': 5.056310653686523, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.97it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s]                                              {'loss': 2.3052, 'grad_norm': 4.349552631378174, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s] 20%|██        | 8/40 [00:04<00:15,  2.10it/s]                                              {'loss': 1.4735, 'grad_norm': 7.761253356933594, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.10it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.10it/s]                                              {'loss': 2.2618, 'grad_norm': 5.422825336456299, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.10it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.11it/s]                                               {'loss': 2.2026, 'grad_norm': 3.129223585128784, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.11it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.11it/s]                                               {'loss': 2.2469, 'grad_norm': 4.460057258605957, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.11it/s] 30%|███       | 12/40 [00:06<00:13,  2.11it/s]                                               {'loss': 2.2746, 'grad_norm': 3.133906126022339, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:13,  2.11it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.12it/s]                                               {'loss': 2.1496, 'grad_norm': 3.7297918796539307, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.12it/s] 35%|███▌      | 14/40 [00:07<00:12,  2.15it/s]                                               {'loss': 2.327, 'grad_norm': 3.938347816467285, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:12,  2.15it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.14it/s]                                               {'loss': 2.3597, 'grad_norm': 5.591533660888672, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.14it/s] 40%|████      | 16/40 [00:07<00:08,  2.79it/s]                                               {'loss': 1.3915, 'grad_norm': 15.200211524963379, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.79it/s] 42%|████▎     | 17/40 [00:08<00:08,  2.60it/s]                                               {'loss': 2.0501, 'grad_norm': 3.937138319015503, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:08,  2.60it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.46it/s]                                               {'loss': 2.0661, 'grad_norm': 3.8356895446777344, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.46it/s] 48%|████▊     | 19/40 [00:09<00:08,  2.37it/s]                                               {'loss': 2.4306, 'grad_norm': 4.900846004486084, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:08,  2.37it/s] 50%|█████     | 20/40 [00:09<00:08,  2.31it/s]                                               {'loss': 2.1065, 'grad_norm': 4.02016544342041, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.31it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s]                                               {'loss': 2.3918, 'grad_norm': 4.151804447174072, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.24it/s]                                               {'loss': 2.0574, 'grad_norm': 3.6838538646698, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.24it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.22it/s]                                               {'loss': 2.2097, 'grad_norm': 4.278422832489014, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.22it/s] 60%|██████    | 24/40 [00:10<00:05,  2.79it/s]                                               {'loss': 1.843, 'grad_norm': 14.487296104431152, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:11<00:05,  2.79it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.66it/s]                                               {'loss': 1.866, 'grad_norm': 3.529114007949829, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.66it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.54it/s]                                               {'loss': 2.1739, 'grad_norm': 4.132779121398926, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.54it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.45it/s]                                               {'loss': 2.284, 'grad_norm': 3.2737748622894287, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.45it/s] 70%|███████   | 28/40 [00:12<00:05,  2.36it/s]                                               {'loss': 2.2942, 'grad_norm': 4.523685455322266, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.36it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.30it/s]                                               {'loss': 2.2725, 'grad_norm': 3.6448543071746826, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.30it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.25it/s]                                               {'loss': 2.0189, 'grad_norm': 4.972986698150635, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:14<00:04,  2.22it/s]                                               {'loss': 2.133, 'grad_norm': 4.219249725341797, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:04,  2.22it/s] 80%|████████  | 32/40 [00:14<00:02,  2.85it/s]                                               {'loss': 1.3158, 'grad_norm': 12.109378814697266, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.66it/s]                                               {'loss': 2.1772, 'grad_norm': 4.3613762855529785, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.66it/s] 85%|████████▌ | 34/40 [00:15<00:02,  2.55it/s]                                               {'loss': 2.0448, 'grad_norm': 4.129587650299072, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:15<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.43it/s]                                               {'loss': 2.08, 'grad_norm': 4.002696990966797, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:16<00:01,  2.34it/s]                                               {'loss': 1.9728, 'grad_norm': 3.8815805912017822, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:16<00:01,  2.34it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.28it/s]                                               {'loss': 2.0932, 'grad_norm': 4.171360969543457, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s]                                               {'loss': 2.1781, 'grad_norm': 3.7661547660827637, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]                                               {'loss': 2.1499, 'grad_norm': 3.87930965423584, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]100%|██████████| 40/40 [00:17<00:00,  2.81it/s]                                               {'loss': 1.8205, 'grad_norm': 17.818538665771484, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.81it/s]                                               {'train_runtime': 17.6788, 'train_samples_per_second': 31.959, 'train_steps_per_second': 2.263, 'train_loss': 2.1228153467178346, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.81it/s]100%|██████████| 40/40 [00:17<00:00,  2.26it/s]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.27it/s]                                              {'loss': 2.4071, 'grad_norm': 4.03904390335083, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.27it/s]  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.1757, 'grad_norm': 3.371943712234497, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]  8%|▊         | 3/40 [00:01<00:16,  2.22it/s]                                              {'loss': 2.6321, 'grad_norm': 4.763648986816406, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.22it/s] 10%|█         | 4/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.4796, 'grad_norm': 5.531507968902588, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.20it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s]                                              {'loss': 2.2137, 'grad_norm': 3.7281765937805176, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.5368, 'grad_norm': 4.320088863372803, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s]                                              {'loss': 2.4957, 'grad_norm': 4.322284698486328, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.18it/s] 20%|██        | 8/40 [00:03<00:11,  2.78it/s]                                              {'loss': 2.2931, 'grad_norm': 13.452911376953125, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.78it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s]                                              {'loss': 2.3923, 'grad_norm': 3.976264476776123, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.2176, 'grad_norm': 3.574920654296875, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.40it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.29it/s]                                               {'loss': 2.1658, 'grad_norm': 3.812434196472168, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.29it/s] 30%|███       | 12/40 [00:05<00:12,  2.24it/s]                                               {'loss': 2.2056, 'grad_norm': 4.09522819519043, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.24it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s]                                               {'loss': 2.4344, 'grad_norm': 4.937612533569336, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.3267, 'grad_norm': 3.4746668338775635, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s]                                               {'loss': 2.5232, 'grad_norm': 4.4915924072265625, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s]                                               {'loss': 2.0915, 'grad_norm': 23.235074996948242, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:11,  2.16it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s]                                               {'loss': 2.3954, 'grad_norm': 4.359586238861084, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.3339, 'grad_norm': 4.44524621963501, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.42it/s]                                               {'loss': 2.2669, 'grad_norm': 4.274428844451904, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.42it/s] 50%|█████     | 20/40 [00:08<00:08,  2.34it/s]                                               {'loss': 2.3189, 'grad_norm': 3.952254295349121, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.34it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.28it/s]                                               {'loss': 2.2565, 'grad_norm': 3.1881179809570312, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.24it/s]                                               {'loss': 2.0487, 'grad_norm': 4.311143398284912, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.24it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s]                                               {'loss': 2.2773, 'grad_norm': 3.2980804443359375, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s] 60%|██████    | 24/40 [00:10<00:05,  2.80it/s]                                               {'loss': 2.0842, 'grad_norm': 21.407819747924805, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.80it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s]                                               {'loss': 2.2899, 'grad_norm': 3.5354533195495605, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.43it/s]                                               {'loss': 2.2855, 'grad_norm': 3.0179381370544434, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.43it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s]                                               {'loss': 2.0864, 'grad_norm': 3.10310959815979, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s] 70%|███████   | 28/40 [00:11<00:05,  2.30it/s]                                               {'loss': 2.183, 'grad_norm': 2.9847114086151123, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.30it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s]                                               {'loss': 2.1528, 'grad_norm': 3.693150043487549, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s]                                               {'loss': 2.3829, 'grad_norm': 3.287879228591919, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.34it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.30it/s]                                               {'loss': 2.2355, 'grad_norm': 4.119317531585693, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.30it/s] 80%|████████  | 32/40 [00:13<00:02,  2.90it/s]                                               {'loss': 1.7892, 'grad_norm': 16.65308380126953, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.0981, 'grad_norm': 3.5363965034484863, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s]                                               {'loss': 2.4448, 'grad_norm': 4.825685024261475, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.46it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s]                                               {'loss': 2.1167, 'grad_norm': 3.5726399421691895, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s]                                               {'loss': 2.0488, 'grad_norm': 2.8938965797424316, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s]                                               {'loss': 2.0478, 'grad_norm': 2.96797251701355, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.23it/s]                                               {'loss': 2.1755, 'grad_norm': 3.6962883472442627, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.3288, 'grad_norm': 3.6315155029296875, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.3854, 'grad_norm': 20.920791625976562, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.20it/s]                                               {'train_runtime': 16.8342, 'train_samples_per_second': 33.563, 'train_steps_per_second': 2.376, 'train_loss': 2.265585646033287, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.20it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.0887, 'grad_norm': 5.097299575805664, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.18it/s]  5%|▌         | 2/40 [00:00<00:17,  2.17it/s]                                              {'loss': 2.2078, 'grad_norm': 4.245524883270264, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.17it/s]  8%|▊         | 3/40 [00:01<00:17,  2.16it/s]                                              {'loss': 2.4128, 'grad_norm': 3.7031896114349365, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.16it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.4732, 'grad_norm': 4.751721382141113, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.4155, 'grad_norm': 3.5525856018066406, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.1671, 'grad_norm': 3.5023109912872314, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.13it/s]                                              {'loss': 2.5236, 'grad_norm': 5.413039207458496, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.13it/s] 20%|██        | 8/40 [00:03<00:11,  2.80it/s]                                              {'loss': 2.4499, 'grad_norm': 11.094592094421387, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.80it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s]                                              {'loss': 2.3972, 'grad_norm': 3.869626522064209, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s]                                               {'loss': 2.2673, 'grad_norm': 3.399747133255005, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s]                                               {'loss': 2.1101, 'grad_norm': 2.7443668842315674, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s] 30%|███       | 12/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.2442, 'grad_norm': 3.295605182647705, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.34it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.2362, 'grad_norm': 3.04012393951416, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s]                                               {'loss': 2.2898, 'grad_norm': 3.4566047191619873, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.27it/s]                                               {'loss': 2.3491, 'grad_norm': 3.7673633098602295, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.27it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 1.8441, 'grad_norm': 15.312024116516113, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s]                                               {'loss': 2.0372, 'grad_norm': 2.862339735031128, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.53it/s]                                               {'loss': 2.3449, 'grad_norm': 3.6010935306549072, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.53it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.46it/s]                                               {'loss': 2.2453, 'grad_norm': 3.4410526752471924, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.46it/s] 50%|█████     | 20/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.3832, 'grad_norm': 5.04815149307251, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.41it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.1217, 'grad_norm': 3.71598744392395, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.2149, 'grad_norm': 5.392829895019531, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.2877, 'grad_norm': 5.01533842086792, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.84it/s]                                               {'loss': 2.6982, 'grad_norm': 14.756317138671875, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.84it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s]                                               {'loss': 2.216, 'grad_norm': 3.8173718452453613, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.44it/s]                                               {'loss': 2.2286, 'grad_norm': 3.538649082183838, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.44it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s]                                               {'loss': 2.1784, 'grad_norm': 3.0658822059631348, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s] 70%|███████   | 28/40 [00:11<00:05,  2.30it/s]                                               {'loss': 2.3278, 'grad_norm': 3.7055723667144775, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.30it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s]                                               {'loss': 2.2159, 'grad_norm': 3.9919686317443848, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s]                                               {'loss': 2.1764, 'grad_norm': 3.3768742084503174, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.1374, 'grad_norm': 3.4065937995910645, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 1.9832, 'grad_norm': 11.215703964233398, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.56it/s]                                               {'loss': 2.2784, 'grad_norm': 3.239236354827881, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.56it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s]                                               {'loss': 2.2389, 'grad_norm': 3.130798101425171, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.32it/s]                                               {'loss': 2.1632, 'grad_norm': 3.21867036819458, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.32it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.27it/s]                                               {'loss': 2.1419, 'grad_norm': 3.475755214691162, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.27it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s]                                               {'loss': 2.1704, 'grad_norm': 3.8949198722839355, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.352, 'grad_norm': 4.13379430770874, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.21it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.19it/s]                                               {'loss': 1.9461, 'grad_norm': 3.120000123977661, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.19it/s]                                               {'loss': 2.6262, 'grad_norm': 11.548961639404297, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.19it/s]                                               {'train_runtime': 16.728, 'train_samples_per_second': 33.776, 'train_steps_per_second': 2.391, 'train_loss': 2.254759120941162, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.19it/s]100%|██████████| 40/40 [00:16<00:00,  2.39it/s]
CLIENT:5
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]                                              {'loss': 2.194, 'grad_norm': 3.7243499755859375, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:44,  1.15s/it]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 2.3705, 'grad_norm': 4.911738872528076, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:02<00:22,  1.61it/s]                                              {'loss': 2.2569, 'grad_norm': 3.1683170795440674, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:22,  1.61it/s] 10%|█         | 4/40 [00:02<00:20,  1.79it/s]                                              {'loss': 2.3939, 'grad_norm': 4.364164352416992, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.79it/s] 12%|█▎        | 5/40 [00:03<00:18,  1.91it/s]                                              {'loss': 2.6251, 'grad_norm': 5.0654215812683105, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:18,  1.91it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.99it/s]                                              {'loss': 2.2411, 'grad_norm': 4.405799865722656, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.99it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.04it/s]                                              {'loss': 2.3645, 'grad_norm': 4.9582414627075195, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.04it/s] 20%|██        | 8/40 [00:04<00:11,  2.72it/s]                                              {'loss': 1.389, 'grad_norm': 8.506561279296875, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:11,  2.72it/s] 22%|██▎       | 9/40 [00:04<00:12,  2.58it/s]                                              {'loss': 2.2897, 'grad_norm': 3.6943297386169434, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:12,  2.58it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s]                                               {'loss': 2.0257, 'grad_norm': 4.818832874298096, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.46it/s] 28%|██▊       | 11/40 [00:05<00:12,  2.35it/s]                                               {'loss': 2.2871, 'grad_norm': 3.737126588821411, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:12,  2.35it/s] 30%|███       | 12/40 [00:05<00:12,  2.32it/s]                                               {'loss': 2.2933, 'grad_norm': 4.025741100311279, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.32it/s] 32%|███▎      | 13/40 [00:06<00:11,  2.28it/s]                                               {'loss': 2.4921, 'grad_norm': 5.224084377288818, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:11,  2.28it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s]                                               {'loss': 1.8794, 'grad_norm': 4.1372294425964355, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.22it/s]                                               {'loss': 2.1603, 'grad_norm': 2.947971820831299, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.22it/s] 40%|████      | 16/40 [00:07<00:08,  2.79it/s]                                               {'loss': 1.1848, 'grad_norm': 14.422477722167969, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.79it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s]                                               {'loss': 2.155, 'grad_norm': 4.762758255004883, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s] 45%|████▌     | 18/40 [00:08<00:09,  2.43it/s]                                               {'loss': 2.279, 'grad_norm': 6.232391834259033, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:09,  2.43it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.32it/s]                                               {'loss': 2.3432, 'grad_norm': 3.474090576171875, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:09,  2.32it/s] 50%|█████     | 20/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.1582, 'grad_norm': 3.592078924179077, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.25it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.21it/s]                                               {'loss': 2.3404, 'grad_norm': 3.7257797718048096, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.21it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.19it/s]                                               {'loss': 2.0136, 'grad_norm': 3.8102877140045166, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.19it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s]                                               {'loss': 2.1359, 'grad_norm': 3.8434677124023438, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s]                                               {'loss': 1.7238, 'grad_norm': 10.082948684692383, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:07,  2.17it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.70it/s]                                               {'loss': 1.9867, 'grad_norm': 3.6102516651153564, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.70it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.56it/s]                                               {'loss': 2.0699, 'grad_norm': 3.5216400623321533, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.56it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.45it/s]                                               {'loss': 2.2693, 'grad_norm': 3.7196404933929443, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.45it/s] 70%|███████   | 28/40 [00:12<00:05,  2.37it/s]                                               {'loss': 2.3364, 'grad_norm': 3.4566268920898438, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.37it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.30it/s]                                               {'loss': 2.2869, 'grad_norm': 3.2167904376983643, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.30it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.25it/s]                                               {'loss': 1.9787, 'grad_norm': 4.677661418914795, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s]                                               {'loss': 1.9196, 'grad_norm': 4.146104335784912, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s] 80%|████████  | 32/40 [00:14<00:02,  2.76it/s]                                               {'loss': 2.2407, 'grad_norm': 15.25032901763916, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.76it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.55it/s]                                               {'loss': 2.0797, 'grad_norm': 3.9967451095581055, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.55it/s] 85%|████████▌ | 34/40 [00:15<00:02,  2.43it/s]                                               {'loss': 2.1679, 'grad_norm': 3.119049310684204, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:15<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.36it/s]                                               {'loss': 1.8825, 'grad_norm': 3.400982618331909, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.36it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.34it/s]                                               {'loss': 2.3966, 'grad_norm': 4.255148410797119, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.34it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.33it/s]                                               {'loss': 1.9752, 'grad_norm': 4.256772994995117, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.30it/s]                                               {'loss': 2.1839, 'grad_norm': 3.4059298038482666, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.29it/s]                                               {'loss': 2.0802, 'grad_norm': 4.066977024078369, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.29it/s]100%|██████████| 40/40 [00:17<00:00,  2.86it/s]                                               {'loss': 3.0375, 'grad_norm': 14.807266235351562, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.86it/s]                                               {'train_runtime': 17.4695, 'train_samples_per_second': 32.342, 'train_steps_per_second': 2.29, 'train_loss': 2.16220383644104, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.86it/s]100%|██████████| 40/40 [00:17<00:00,  2.29it/s]
CLIENT:52
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.322, 'grad_norm': 4.22759485244751, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.20it/s]  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]                                              {'loss': 2.3282, 'grad_norm': 4.189028263092041, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]  8%|▊         | 3/40 [00:01<00:17,  2.14it/s]                                              {'loss': 2.3693, 'grad_norm': 4.438197135925293, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.14it/s] 10%|█         | 4/40 [00:01<00:16,  2.13it/s]                                              {'loss': 2.2168, 'grad_norm': 4.007836818695068, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.13it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.4602, 'grad_norm': 3.9139628410339355, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.4851, 'grad_norm': 3.570157289505005, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s]                                              {'loss': 2.2109, 'grad_norm': 4.509425640106201, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s] 20%|██        | 8/40 [00:03<00:11,  2.85it/s]                                              {'loss': 1.8635, 'grad_norm': 8.720678329467773, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.85it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.64it/s]                                              {'loss': 2.2433, 'grad_norm': 3.879415988922119, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.64it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.1616, 'grad_norm': 3.063577175140381, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.39it/s]                                               {'loss': 2.2974, 'grad_norm': 3.0224416255950928, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.39it/s] 30%|███       | 12/40 [00:05<00:12,  2.31it/s]                                               {'loss': 2.252, 'grad_norm': 4.0280232429504395, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.31it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.26it/s]                                               {'loss': 2.1831, 'grad_norm': 4.0997314453125, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.26it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.22it/s]                                               {'loss': 2.2637, 'grad_norm': 3.16780686378479, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.22it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s]                                               {'loss': 2.2103, 'grad_norm': 3.0135340690612793, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s] 40%|████      | 16/40 [00:06<00:08,  2.80it/s]                                               {'loss': 1.8177, 'grad_norm': 13.326550483703613, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s]                                               {'loss': 2.1422, 'grad_norm': 3.1485297679901123, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.2546, 'grad_norm': 3.632218837738037, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.1475, 'grad_norm': 3.7235682010650635, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.41it/s] 50%|█████     | 20/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.162, 'grad_norm': 3.2439260482788086, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.37it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.36it/s]                                               {'loss': 2.1421, 'grad_norm': 3.246314287185669, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.36it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.30it/s]                                               {'loss': 2.1444, 'grad_norm': 3.8752503395080566, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.30it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.1082, 'grad_norm': 3.1405086517333984, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s] 60%|██████    | 24/40 [00:09<00:05,  2.87it/s]                                               {'loss': 3.1249, 'grad_norm': 21.163949966430664, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s]                                               {'loss': 2.2059, 'grad_norm': 3.9106552600860596, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.3378, 'grad_norm': 3.755300760269165, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s]                                               {'loss': 1.9648, 'grad_norm': 2.9449872970581055, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.45it/s] 70%|███████   | 28/40 [00:11<00:05,  2.40it/s]                                               {'loss': 2.2685, 'grad_norm': 3.632854461669922, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.40it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s]                                               {'loss': 2.1365, 'grad_norm': 3.311199188232422, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.29it/s]                                               {'loss': 2.0726, 'grad_norm': 5.023585796356201, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.29it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s]                                               {'loss': 2.1562, 'grad_norm': 4.339066028594971, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s] 80%|████████  | 32/40 [00:13<00:02,  2.84it/s]                                               {'loss': 1.5311, 'grad_norm': 7.442688465118408, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.84it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.61it/s]                                               {'loss': 2.0638, 'grad_norm': 3.439424753189087, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.61it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s]                                               {'loss': 2.0255, 'grad_norm': 2.781860113143921, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s]                                               {'loss': 2.1489, 'grad_norm': 3.4638876914978027, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.34it/s]                                               {'loss': 2.0086, 'grad_norm': 2.79949951171875, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.34it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s]                                               {'loss': 1.9771, 'grad_norm': 3.6062450408935547, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s]                                               {'loss': 2.2438, 'grad_norm': 4.625594615936279, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.32it/s]                                               {'loss': 2.1557, 'grad_norm': 3.0363736152648926, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.32it/s]100%|██████████| 40/40 [00:16<00:00,  2.99it/s]                                               {'loss': 2.8297, 'grad_norm': 20.19721794128418, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.99it/s]                                               {'train_runtime': 16.5628, 'train_samples_per_second': 34.113, 'train_steps_per_second': 2.415, 'train_loss': 2.2009373247623443, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.99it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
CLIENT:41
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:15,  2.52it/s]                                              {'loss': 2.421, 'grad_norm': 3.809532880783081, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:15,  2.52it/s]  5%|▌         | 2/40 [00:00<00:14,  2.54it/s]                                              {'loss': 2.265, 'grad_norm': 3.955461263656616, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:14,  2.54it/s]  8%|▊         | 3/40 [00:01<00:14,  2.54it/s]                                              {'loss': 2.2007, 'grad_norm': 4.81631326675415, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:14,  2.54it/s] 10%|█         | 4/40 [00:01<00:14,  2.51it/s]                                              {'loss': 2.1703, 'grad_norm': 3.814265489578247, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.51it/s] 12%|█▎        | 5/40 [00:02<00:14,  2.40it/s]                                              {'loss': 2.4634, 'grad_norm': 3.8022823333740234, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.40it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.32it/s]                                              {'loss': 2.5417, 'grad_norm': 4.8461527824401855, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.32it/s] 18%|█▊        | 7/40 [00:02<00:14,  2.26it/s]                                              {'loss': 2.3103, 'grad_norm': 3.537473440170288, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:14,  2.26it/s] 20%|██        | 8/40 [00:03<00:10,  2.93it/s]                                              {'loss': 2.4488, 'grad_norm': 14.161569595336914, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.93it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.3802, 'grad_norm': 3.5222647190093994, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s]                                               {'loss': 2.3154, 'grad_norm': 4.381527900695801, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s]                                               {'loss': 2.2439, 'grad_norm': 3.446648120880127, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s] 30%|███       | 12/40 [00:04<00:11,  2.37it/s]                                               {'loss': 2.1742, 'grad_norm': 3.3318538665771484, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.37it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.4351, 'grad_norm': 5.012753486633301, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s]                                               {'loss': 2.2758, 'grad_norm': 4.0926833152771, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.33it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.30it/s]                                               {'loss': 2.2767, 'grad_norm': 4.0370378494262695, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.30it/s] 40%|████      | 16/40 [00:06<00:08,  2.91it/s]                                               {'loss': 1.8994, 'grad_norm': 14.426775932312012, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.91it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.69it/s]                                               {'loss': 2.1572, 'grad_norm': 3.5545737743377686, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.69it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.1342, 'grad_norm': 3.18487548828125, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.57it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.48it/s]                                               {'loss': 2.2177, 'grad_norm': 3.5826563835144043, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.48it/s] 50%|█████     | 20/40 [00:08<00:08,  2.40it/s]                                               {'loss': 2.1458, 'grad_norm': 3.6390702724456787, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.40it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.38it/s]                                               {'loss': 2.3282, 'grad_norm': 4.21657133102417, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.38it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.42it/s]                                               {'loss': 2.1775, 'grad_norm': 6.353588104248047, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.42it/s] 57%|█████▊    | 23/40 [00:09<00:06,  2.43it/s]                                               {'loss': 2.2413, 'grad_norm': 3.8882193565368652, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:06,  2.43it/s]                                               {'loss': 2.4654, 'grad_norm': 11.090782165527344, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:06,  2.43it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.12it/s]                                               {'loss': 2.1034, 'grad_norm': 3.602987051010132, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.12it/s] 65%|██████▌   | 26/40 [00:10<00:04,  2.95it/s]                                               {'loss': 2.242, 'grad_norm': 3.3756775856018066, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  2.95it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.84it/s]                                               {'loss': 2.2927, 'grad_norm': 4.052346229553223, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.84it/s] 70%|███████   | 28/40 [00:10<00:04,  2.69it/s]                                               {'loss': 2.0927, 'grad_norm': 3.112908363342285, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.69it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.63it/s]                                               {'loss': 2.2417, 'grad_norm': 3.8119709491729736, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.63it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.52it/s]                                               {'loss': 2.245, 'grad_norm': 3.650482416152954, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.52it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.40it/s]                                               {'loss': 1.9757, 'grad_norm': 4.302779197692871, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.40it/s] 80%|████████  | 32/40 [00:12<00:02,  3.08it/s]                                               {'loss': 2.827, 'grad_norm': 15.580955505371094, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.08it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.80it/s]                                               {'loss': 2.1736, 'grad_norm': 4.118573188781738, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.80it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.64it/s]                                               {'loss': 2.0829, 'grad_norm': 3.783353567123413, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.64it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.48it/s]                                               {'loss': 2.111, 'grad_norm': 3.1497867107391357, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.48it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.38it/s]                                               {'loss': 2.3032, 'grad_norm': 4.024398326873779, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.38it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.31it/s]                                               {'loss': 1.913, 'grad_norm': 3.1814754009246826, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.26it/s]                                               {'loss': 2.312, 'grad_norm': 4.547781467437744, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.26it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.22it/s]                                               {'loss': 2.1959, 'grad_norm': 5.024986743927002, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.22it/s]100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'loss': 2.3097, 'grad_norm': 11.386255264282227, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]                                               {'train_runtime': 15.7853, 'train_samples_per_second': 35.793, 'train_steps_per_second': 2.534, 'train_loss': 2.2527692705392837, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.85it/s]100%|██████████| 40/40 [00:15<00:00,  2.53it/s]
CLIENT:0
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.1248, 'grad_norm': 4.632351398468018, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.2168, 'grad_norm': 3.3015353679656982, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]  8%|▊         | 3/40 [00:01<00:17,  2.17it/s]                                              {'loss': 2.1507, 'grad_norm': 3.8638389110565186, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.17it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.3553, 'grad_norm': 3.9909257888793945, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.3844, 'grad_norm': 4.640265941619873, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.2568, 'grad_norm': 4.3204665184021, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.21it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s]                                              {'loss': 2.2116, 'grad_norm': 3.5506930351257324, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s] 20%|██        | 8/40 [00:03<00:11,  2.83it/s]                                              {'loss': 2.6681, 'grad_norm': 15.468868255615234, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.83it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.58it/s]                                              {'loss': 2.1247, 'grad_norm': 3.4057488441467285, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.58it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.2185, 'grad_norm': 3.293924570083618, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.51it/s]                                               {'loss': 2.2682, 'grad_norm': 4.041191577911377, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.51it/s] 30%|███       | 12/40 [00:04<00:10,  2.56it/s]                                               {'loss': 2.1125, 'grad_norm': 3.5153472423553467, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.56it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.59it/s]                                               {'loss': 1.9785, 'grad_norm': 3.560791492462158, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.59it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.59it/s]                                               {'loss': 1.9972, 'grad_norm': 4.074264049530029, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.59it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.62it/s]                                               {'loss': 2.4039, 'grad_norm': 4.424241065979004, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.62it/s] 40%|████      | 16/40 [00:06<00:07,  3.31it/s]                                               {'loss': 2.3065, 'grad_norm': 15.586702346801758, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.31it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.03it/s]                                               {'loss': 2.1391, 'grad_norm': 4.155971527099609, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.03it/s] 45%|████▌     | 18/40 [00:07<00:07,  2.88it/s]                                               {'loss': 2.1745, 'grad_norm': 3.7550458908081055, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  2.88it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.65it/s]                                               {'loss': 2.0301, 'grad_norm': 2.9102623462677, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.65it/s] 50%|█████     | 20/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.1882, 'grad_norm': 3.4935526847839355, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.45it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.34it/s]                                               {'loss': 2.0794, 'grad_norm': 3.4935402870178223, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.34it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.27it/s]                                               {'loss': 2.3144, 'grad_norm': 4.033121109008789, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.27it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s]                                               {'loss': 2.0281, 'grad_norm': 2.6404261589050293, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s]                                               {'loss': 1.5568, 'grad_norm': 8.673684120178223, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:07,  2.22it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s]                                               {'loss': 2.0572, 'grad_norm': 3.2386956214904785, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.156, 'grad_norm': 3.788163185119629, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.42it/s]                                               {'loss': 2.1106, 'grad_norm': 3.222273826599121, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.42it/s] 70%|███████   | 28/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.1524, 'grad_norm': 3.0442683696746826, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.32it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s]                                               {'loss': 1.9019, 'grad_norm': 3.619591474533081, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s]                                               {'loss': 2.0565, 'grad_norm': 3.488654851913452, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.19it/s]                                               {'loss': 2.1245, 'grad_norm': 3.4290406703948975, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.19it/s] 80%|████████  | 32/40 [00:12<00:02,  2.79it/s]                                               {'loss': 2.6594, 'grad_norm': 16.43851661682129, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.79it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s]                                               {'loss': 2.1109, 'grad_norm': 3.218763828277588, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.45it/s]                                               {'loss': 2.0838, 'grad_norm': 4.3780517578125, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.45it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.36it/s]                                               {'loss': 2.0996, 'grad_norm': 3.218578815460205, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.36it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.32it/s]                                               {'loss': 1.9873, 'grad_norm': 3.289854049682617, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.32it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s]                                               {'loss': 2.0102, 'grad_norm': 3.3053135871887207, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s]                                               {'loss': 2.0644, 'grad_norm': 3.4929099082946777, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.22it/s]                                               {'loss': 2.0589, 'grad_norm': 3.547069549560547, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.22it/s]100%|██████████| 40/40 [00:16<00:00,  2.80it/s]                                               {'loss': 1.718, 'grad_norm': 12.355839729309082, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.80it/s]                                               {'train_runtime': 16.3194, 'train_samples_per_second': 34.621, 'train_steps_per_second': 2.451, 'train_loss': 2.1410075962543487, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.80it/s]100%|██████████| 40/40 [00:16<00:00,  2.45it/s]
CLIENT:73
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.2278, 'grad_norm': 4.473234176635742, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.18it/s]  5%|▌         | 2/40 [00:00<00:17,  2.13it/s]                                              {'loss': 2.2503, 'grad_norm': 3.8107845783233643, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.13it/s]  8%|▊         | 3/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.1458, 'grad_norm': 4.011031627655029, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.12it/s] 10%|█         | 4/40 [00:01<00:16,  2.12it/s]                                              {'loss': 2.1309, 'grad_norm': 3.836465835571289, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.12it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.10it/s]                                              {'loss': 2.0672, 'grad_norm': 2.7498388290405273, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.10it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s]                                              {'loss': 1.983, 'grad_norm': 4.171482563018799, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 2.2023, 'grad_norm': 3.3515689373016357, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s] 20%|██        | 8/40 [00:03<00:11,  2.82it/s]                                              {'loss': 3.4847, 'grad_norm': 35.37428665161133, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.82it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.57it/s]                                              {'loss': 1.9624, 'grad_norm': 5.433187961578369, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.57it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.41it/s]                                               {'loss': 2.1337, 'grad_norm': 3.996952533721924, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.41it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s]                                               {'loss': 2.0873, 'grad_norm': 3.204617738723755, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s] 30%|███       | 12/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.0974, 'grad_norm': 3.2252421379089355, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.25it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s]                                               {'loss': 2.1253, 'grad_norm': 4.264568328857422, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.2089, 'grad_norm': 3.1783530712127686, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.15it/s]                                               {'loss': 2.1179, 'grad_norm': 4.339513301849365, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.15it/s] 40%|████      | 16/40 [00:06<00:08,  2.78it/s]                                               {'loss': 2.6613, 'grad_norm': 22.998859405517578, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.78it/s] 42%|████▎     | 17/40 [00:07<00:09,  2.55it/s]                                               {'loss': 1.9283, 'grad_norm': 3.1435015201568604, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:09,  2.55it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.2128, 'grad_norm': 3.7183399200439453, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s]                                               {'loss': 1.8833, 'grad_norm': 3.5543689727783203, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s] 50%|█████     | 20/40 [00:08<00:08,  2.34it/s]                                               {'loss': 1.8371, 'grad_norm': 4.156930446624756, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.34it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.31it/s]                                               {'loss': 2.0574, 'grad_norm': 3.057293176651001, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.31it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.0552, 'grad_norm': 3.0609166622161865, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.21it/s]                                               {'loss': 2.067, 'grad_norm': 3.541102409362793, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.21it/s] 60%|██████    | 24/40 [00:10<00:05,  2.86it/s]                                               {'loss': 1.5983, 'grad_norm': 11.097110748291016, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.86it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 1.8889, 'grad_norm': 4.4789862632751465, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.50it/s]                                               {'loss': 1.9234, 'grad_norm': 2.5611507892608643, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.50it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.41it/s]                                               {'loss': 1.7563, 'grad_norm': 3.4368321895599365, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.41it/s] 70%|███████   | 28/40 [00:11<00:05,  2.36it/s]                                               {'loss': 2.1201, 'grad_norm': 2.840764045715332, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.36it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s]                                               {'loss': 1.9254, 'grad_norm': 3.408712387084961, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.1963, 'grad_norm': 4.422338962554932, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 1.9667, 'grad_norm': 3.117048978805542, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s] 80%|████████  | 32/40 [00:13<00:02,  2.81it/s]                                               {'loss': 1.9798, 'grad_norm': 12.23928451538086, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.81it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 1.7607, 'grad_norm': 2.936708450317383, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.49it/s]                                               {'loss': 2.0732, 'grad_norm': 2.9762721061706543, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.49it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.44it/s]                                               {'loss': 1.9604, 'grad_norm': 3.004310131072998, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.44it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.36it/s]                                               {'loss': 2.1054, 'grad_norm': 3.821859121322632, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s]                                               {'loss': 1.8706, 'grad_norm': 2.747908115386963, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.24it/s]                                               {'loss': 1.8378, 'grad_norm': 3.230184555053711, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.24it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.0308, 'grad_norm': 2.961496353149414, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.20it/s]                                               {'loss': 1.4945, 'grad_norm': 9.49405288696289, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.20it/s]                                               {'train_runtime': 16.8302, 'train_samples_per_second': 33.571, 'train_steps_per_second': 2.377, 'train_loss': 2.0603964418172835, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.20it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.2279, 'grad_norm': 4.307444095611572, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]                                              {'loss': 2.4899, 'grad_norm': 4.4292988777160645, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]  8%|▊         | 3/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.2974, 'grad_norm': 3.6499781608581543, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.12it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.6139, 'grad_norm': 4.208134651184082, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.14it/s]                                              {'loss': 2.2513, 'grad_norm': 3.571420192718506, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.14it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.2866, 'grad_norm': 4.478953838348389, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.3997, 'grad_norm': 4.092731475830078, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s] 20%|██        | 8/40 [00:03<00:11,  2.78it/s]                                              {'loss': 2.4825, 'grad_norm': 13.758087158203125, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.78it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.54it/s]                                              {'loss': 2.2265, 'grad_norm': 3.7891197204589844, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.54it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s]                                               {'loss': 2.4322, 'grad_norm': 3.7313637733459473, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s]                                               {'loss': 2.1889, 'grad_norm': 3.4963462352752686, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s] 30%|███       | 12/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.355, 'grad_norm': 4.474427700042725, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.23it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.19it/s]                                               {'loss': 2.2507, 'grad_norm': 3.961543083190918, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.19it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.1186, 'grad_norm': 4.320911884307861, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.17it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.15it/s]                                               {'loss': 2.1586, 'grad_norm': 3.6090734004974365, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.15it/s] 40%|████      | 16/40 [00:06<00:08,  2.80it/s]                                               {'loss': 2.0423, 'grad_norm': 15.610486030578613, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.0822, 'grad_norm': 4.485724449157715, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.2685, 'grad_norm': 4.124355792999268, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.1989, 'grad_norm': 3.574927806854248, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.1389, 'grad_norm': 4.994509696960449, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s]                                               {'loss': 2.1282, 'grad_norm': 3.284482002258301, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s]                                               {'loss': 2.1982, 'grad_norm': 2.815845251083374, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.21it/s]                                               {'loss': 2.3617, 'grad_norm': 4.36380672454834, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.21it/s] 60%|██████    | 24/40 [00:10<00:05,  2.76it/s]                                               {'loss': 1.9791, 'grad_norm': 15.319022178649902, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.76it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.2596, 'grad_norm': 3.0657968521118164, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.53it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.1789, 'grad_norm': 3.469639301300049, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.39it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.2318, 'grad_norm': 2.9347963333129883, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.32it/s] 70%|███████   | 28/40 [00:12<00:05,  2.29it/s]                                               {'loss': 2.103, 'grad_norm': 3.835754156112671, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.29it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.0577, 'grad_norm': 3.319420099258423, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.24it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.19it/s]                                               {'loss': 2.0245, 'grad_norm': 4.247190952301025, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.19it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s]                                               {'loss': 1.9764, 'grad_norm': 3.237835645675659, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s] 80%|████████  | 32/40 [00:13<00:02,  2.76it/s]                                               {'loss': 2.6051, 'grad_norm': 15.089176177978516, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.76it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.55it/s]                                               {'loss': 1.9784, 'grad_norm': 3.401459217071533, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.55it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.40it/s]                                               {'loss': 1.921, 'grad_norm': 3.748023271560669, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.40it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.32it/s]                                               {'loss': 2.1441, 'grad_norm': 3.9229462146759033, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.32it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.26it/s]                                               {'loss': 2.1686, 'grad_norm': 3.691894054412842, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.26it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.21it/s]                                               {'loss': 2.191, 'grad_norm': 3.773716688156128, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.21it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.17it/s]                                               {'loss': 2.0484, 'grad_norm': 2.987759828567505, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.17it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.15it/s]                                               {'loss': 2.4145, 'grad_norm': 3.856652021408081, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.15it/s]100%|██████████| 40/40 [00:17<00:00,  2.76it/s]                                               {'loss': 2.1935, 'grad_norm': 12.340269088745117, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.76it/s]                                               {'train_runtime': 17.126, 'train_samples_per_second': 32.991, 'train_steps_per_second': 2.336, 'train_loss': 2.2168547421693803, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.76it/s]100%|██████████| 40/40 [00:17<00:00,  2.34it/s]
CLIENT:68
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.1014, 'grad_norm': 3.8246359825134277, 'learning_rate': 0.00015395010584845858, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.1892, 'grad_norm': 3.5984292030334473, 'learning_rate': 0.0001501013532022471, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.21it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.1863, 'grad_norm': 3.959986686706543, 'learning_rate': 0.00014625260055603566, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:16,  2.25it/s]                                              {'loss': 2.4178, 'grad_norm': 4.318775177001953, 'learning_rate': 0.0001424038479098242, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.25it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.3215, 'grad_norm': 3.7705771923065186, 'learning_rate': 0.00013855509526361273, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.23it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.2873, 'grad_norm': 3.611032724380493, 'learning_rate': 0.00013470634261740125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s]                                              {'loss': 2.2185, 'grad_norm': 3.327662467956543, 'learning_rate': 0.00013085758997118978, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s] 20%|██        | 8/40 [00:03<00:11,  2.86it/s]                                              {'loss': 2.5302, 'grad_norm': 12.399904251098633, 'learning_rate': 0.00012700883732497833, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.86it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s]                                              {'loss': 2.2276, 'grad_norm': 3.9743313789367676, 'learning_rate': 0.00012316008467876688, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.2466, 'grad_norm': 3.621511459350586, 'learning_rate': 0.0001193113320325554, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.42it/s]                                               {'loss': 2.5349, 'grad_norm': 4.063637733459473, 'learning_rate': 0.00011546257938634393, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.42it/s] 30%|███       | 12/40 [00:05<00:11,  2.37it/s]                                               {'loss': 2.2283, 'grad_norm': 3.972554922103882, 'learning_rate': 0.00011161382674013247, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.37it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.1384, 'grad_norm': 4.4976067543029785, 'learning_rate': 0.000107765074093921, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.1313, 'grad_norm': 3.3727798461914062, 'learning_rate': 0.00010391632144770955, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.25it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.1362, 'grad_norm': 2.5150306224823, 'learning_rate': 0.00010006756880149808, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.80it/s]                                               {'loss': 1.5096, 'grad_norm': 8.712032318115234, 'learning_rate': 9.621881615528662e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 2.2625, 'grad_norm': 3.5294759273529053, 'learning_rate': 9.237006350907514e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.46it/s]                                               {'loss': 2.2046, 'grad_norm': 3.42964506149292, 'learning_rate': 8.852131086286368e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.46it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.41it/s]                                               {'loss': 2.2695, 'grad_norm': 3.6909255981445312, 'learning_rate': 8.467255821665223e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.41it/s] 50%|█████     | 20/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.2082, 'grad_norm': 3.1112356185913086, 'learning_rate': 8.082380557044075e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.37it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s]                                               {'loss': 1.9816, 'grad_norm': 2.892998695373535, 'learning_rate': 7.697505292422929e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.32it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.1266, 'grad_norm': 3.8981125354766846, 'learning_rate': 7.312630027801783e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.21it/s]                                               {'loss': 2.0239, 'grad_norm': 4.021335124969482, 'learning_rate': 6.927754763180637e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.21it/s] 60%|██████    | 24/40 [00:09<00:05,  2.77it/s]                                               {'loss': 2.6482, 'grad_norm': 21.44025993347168, 'learning_rate': 6.542879498559489e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.77it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s]                                               {'loss': 2.13, 'grad_norm': 3.5566837787628174, 'learning_rate': 6.158004233938344e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.44it/s]                                               {'loss': 2.2695, 'grad_norm': 3.823533296585083, 'learning_rate': 5.7731289693171964e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.44it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.36it/s]                                               {'loss': 2.1361, 'grad_norm': 3.4154391288757324, 'learning_rate': 5.38825370469605e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.36it/s] 70%|███████   | 28/40 [00:11<00:05,  2.30it/s]                                               {'loss': 2.3389, 'grad_norm': 3.4967634677886963, 'learning_rate': 5.003378440074904e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.30it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s]                                               {'loss': 1.9548, 'grad_norm': 3.5279977321624756, 'learning_rate': 4.618503175453757e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s]                                               {'loss': 1.9254, 'grad_norm': 3.3638930320739746, 'learning_rate': 4.2336279108326114e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s]                                               {'loss': 2.1406, 'grad_norm': 3.3017120361328125, 'learning_rate': 3.8487526462114645e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s] 80%|████████  | 32/40 [00:13<00:02,  2.80it/s]                                               {'loss': 2.619, 'grad_norm': 11.54776668548584, 'learning_rate': 3.463877381590318e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s]                                               {'loss': 2.0988, 'grad_norm': 3.7235589027404785, 'learning_rate': 3.079002116969172e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.58it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s]                                               {'loss': 2.0792, 'grad_norm': 3.904637575149536, 'learning_rate': 2.694126852348025e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.34it/s]                                               {'loss': 1.8831, 'grad_norm': 3.153745174407959, 'learning_rate': 2.3092515877268785e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.34it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.28it/s]                                               {'loss': 2.3352, 'grad_norm': 4.293264865875244, 'learning_rate': 1.9243763231057323e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.28it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s]                                               {'loss': 2.0201, 'grad_norm': 3.7862727642059326, 'learning_rate': 1.539501058484586e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.25it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.23it/s]                                               {'loss': 2.125, 'grad_norm': 3.7829203605651855, 'learning_rate': 1.1546257938634393e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.1506, 'grad_norm': 2.91520619392395, 'learning_rate': 7.69750529242293e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'loss': 2.9588, 'grad_norm': 18.783300399780273, 'learning_rate': 3.848752646211465e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'train_runtime': 16.7604, 'train_samples_per_second': 33.71, 'train_steps_per_second': 2.387, 'train_loss': 2.207389885187149, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]100%|██████████| 40/40 [00:16<00:00,  2.39it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:58,  7.97it/s]  1%|          | 3/471 [00:00<01:12,  6.42it/s]  1%|          | 4/471 [00:00<01:27,  5.35it/s]  1%|          | 5/471 [00:00<01:31,  5.09it/s]  1%|▏         | 6/471 [00:01<01:35,  4.87it/s]  1%|▏         | 7/471 [00:01<01:37,  4.76it/s]  2%|▏         | 8/471 [00:01<01:39,  4.65it/s]  2%|▏         | 9/471 [00:01<01:39,  4.63it/s]  2%|▏         | 10/471 [00:01<01:38,  4.67it/s]  2%|▏         | 11/471 [00:02<01:42,  4.48it/s]  3%|▎         | 12/471 [00:02<01:38,  4.66it/s]  3%|▎         | 13/471 [00:02<01:42,  4.45it/s]  3%|▎         | 14/471 [00:02<01:35,  4.77it/s]  3%|▎         | 15/471 [00:03<01:42,  4.43it/s]  3%|▎         | 16/471 [00:03<01:37,  4.67it/s]  4%|▎         | 17/471 [00:03<01:43,  4.40it/s]  4%|▍         | 18/471 [00:03<01:37,  4.63it/s]  4%|▍         | 19/471 [00:04<01:42,  4.40it/s]  4%|▍         | 20/471 [00:04<01:39,  4.55it/s]  4%|▍         | 21/471 [00:04<01:41,  4.43it/s]  5%|▍         | 22/471 [00:04<01:40,  4.48it/s]  5%|▍         | 23/471 [00:04<01:39,  4.52it/s]  5%|▌         | 24/471 [00:05<01:39,  4.48it/s]  5%|▌         | 25/471 [00:05<01:35,  4.69it/s]  6%|▌         | 26/471 [00:05<01:38,  4.54it/s]  6%|▌         | 27/471 [00:05<01:34,  4.72it/s]  6%|▌         | 28/471 [00:05<01:37,  4.55it/s]  6%|▌         | 29/471 [00:06<01:32,  4.76it/s]  6%|▋         | 30/471 [00:06<01:37,  4.50it/s]  7%|▋         | 31/471 [00:06<01:35,  4.61it/s]  7%|▋         | 32/471 [00:06<01:37,  4.49it/s]  7%|▋         | 33/471 [00:07<01:36,  4.52it/s]  7%|▋         | 34/471 [00:07<01:36,  4.52it/s]  7%|▋         | 35/471 [00:07<01:38,  4.45it/s]  8%|▊         | 36/471 [00:07<01:35,  4.53it/s]  8%|▊         | 37/471 [00:07<01:37,  4.47it/s]  8%|▊         | 38/471 [00:08<01:35,  4.52it/s]  8%|▊         | 39/471 [00:08<01:36,  4.47it/s]  8%|▊         | 40/471 [00:08<01:34,  4.54it/s]  9%|▊         | 41/471 [00:08<01:36,  4.44it/s]  9%|▉         | 42/471 [00:09<01:31,  4.66it/s]  9%|▉         | 43/471 [00:09<01:34,  4.51it/s]  9%|▉         | 44/471 [00:09<01:31,  4.67it/s] 10%|▉         | 45/471 [00:09<01:35,  4.47it/s] 10%|▉         | 46/471 [00:09<01:32,  4.60it/s] 10%|▉         | 47/471 [00:10<01:35,  4.46it/s] 10%|█         | 48/471 [00:10<01:34,  4.49it/s] 10%|█         | 49/471 [00:10<01:34,  4.48it/s] 11%|█         | 50/471 [00:10<01:34,  4.46it/s] 11%|█         | 51/471 [00:11<01:30,  4.65it/s] 11%|█         | 52/471 [00:11<01:33,  4.49it/s] 11%|█▏        | 53/471 [00:11<01:30,  4.61it/s] 11%|█▏        | 54/471 [00:11<01:34,  4.41it/s] 12%|█▏        | 55/471 [00:11<01:27,  4.76it/s] 12%|█▏        | 56/471 [00:12<01:33,  4.44it/s] 12%|█▏        | 57/471 [00:12<01:25,  4.86it/s] 12%|█▏        | 58/471 [00:12<01:32,  4.48it/s] 13%|█▎        | 59/471 [00:12<01:29,  4.59it/s] 13%|█▎        | 60/471 [00:12<01:25,  4.82it/s] 13%|█▎        | 61/471 [00:13<01:21,  5.02it/s] 13%|█▎        | 62/471 [00:13<01:15,  5.40it/s] 13%|█▎        | 63/471 [00:13<01:16,  5.32it/s] 14%|█▎        | 64/471 [00:13<01:08,  5.92it/s] 14%|█▍        | 65/471 [00:13<01:13,  5.55it/s] 14%|█▍        | 66/471 [00:13<01:05,  6.19it/s] 14%|█▍        | 67/471 [00:14<01:12,  5.59it/s] 14%|█▍        | 68/471 [00:14<01:07,  5.97it/s] 15%|█▍        | 69/471 [00:14<01:10,  5.70it/s] 15%|█▍        | 70/471 [00:14<01:10,  5.69it/s] 15%|█▌        | 71/471 [00:14<01:04,  6.17it/s] 15%|█▌        | 72/471 [00:15<01:08,  5.80it/s] 15%|█▌        | 73/471 [00:15<01:01,  6.45it/s] 16%|█▌        | 74/471 [00:15<01:07,  5.84it/s] 16%|█▌        | 75/471 [00:15<01:02,  6.31it/s] 16%|█▌        | 76/471 [00:15<01:08,  5.79it/s] 16%|█▋        | 77/471 [00:15<01:06,  5.92it/s] 17%|█▋        | 78/471 [00:15<01:05,  6.03it/s] 17%|█▋        | 79/471 [00:16<01:08,  5.76it/s] 17%|█▋        | 80/471 [00:16<01:03,  6.16it/s] 17%|█▋        | 81/471 [00:16<01:08,  5.71it/s] 17%|█▋        | 82/471 [00:16<01:03,  6.17it/s] 18%|█▊        | 83/471 [00:16<01:13,  5.28it/s] 18%|█▊        | 84/471 [00:17<01:12,  5.31it/s] 18%|█▊        | 85/471 [00:17<01:21,  4.75it/s] 18%|█▊        | 86/471 [00:17<01:17,  4.96it/s] 18%|█▊        | 87/471 [00:17<01:22,  4.67it/s] 19%|█▊        | 88/471 [00:17<01:15,  5.04it/s] 19%|█▉        | 89/471 [00:18<01:17,  4.90it/s] 19%|█▉        | 90/471 [00:18<01:19,  4.77it/s] 19%|█▉        | 91/471 [00:18<01:20,  4.70it/s] 20%|█▉        | 92/471 [00:18<01:22,  4.62it/s] 20%|█▉        | 93/471 [00:19<01:21,  4.67it/s] 20%|█▉        | 94/471 [00:19<01:21,  4.65it/s] 20%|██        | 95/471 [00:19<01:19,  4.71it/s] 20%|██        | 96/471 [00:19<01:23,  4.48it/s] 21%|██        | 97/471 [00:19<01:19,  4.70it/s] 21%|██        | 98/471 [00:20<01:23,  4.48it/s] 21%|██        | 99/471 [00:20<01:15,  4.95it/s] 21%|██        | 100/471 [00:20<01:20,  4.61it/s] 21%|██▏       | 101/471 [00:20<01:19,  4.66it/s] 22%|██▏       | 102/471 [00:20<01:22,  4.46it/s] 22%|██▏       | 103/471 [00:21<01:19,  4.63it/s] 22%|██▏       | 104/471 [00:21<01:21,  4.48it/s] 22%|██▏       | 105/471 [00:21<01:18,  4.69it/s] 23%|██▎       | 106/471 [00:21<01:21,  4.48it/s] 23%|██▎       | 107/471 [00:22<01:19,  4.55it/s] 23%|██▎       | 108/471 [00:22<01:20,  4.53it/s] 23%|██▎       | 109/471 [00:22<01:18,  4.64it/s] 23%|██▎       | 110/471 [00:22<01:15,  4.75it/s] 24%|██▎       | 111/471 [00:22<01:15,  4.74it/s] 24%|██▍       | 112/471 [00:23<01:18,  4.56it/s] 24%|██▍       | 113/471 [00:23<01:17,  4.61it/s] 24%|██▍       | 114/471 [00:23<01:18,  4.56it/s] 24%|██▍       | 115/471 [00:23<01:15,  4.68it/s] 25%|██▍       | 116/471 [00:24<01:17,  4.55it/s] 25%|██▍       | 117/471 [00:24<01:18,  4.52it/s] 25%|██▌       | 118/471 [00:24<01:16,  4.62it/s] 25%|██▌       | 119/471 [00:24<01:16,  4.60it/s] 25%|██▌       | 120/471 [00:24<01:16,  4.62it/s] 26%|██▌       | 121/471 [00:25<01:14,  4.70it/s] 26%|██▌       | 122/471 [00:25<01:12,  4.80it/s] 26%|██▌       | 123/471 [00:25<01:15,  4.60it/s] 26%|██▋       | 124/471 [00:25<01:14,  4.63it/s] 27%|██▋       | 125/471 [00:25<01:16,  4.53it/s] 27%|██▋       | 126/471 [00:26<01:13,  4.72it/s] 27%|██▋       | 127/471 [00:26<01:15,  4.58it/s] 27%|██▋       | 128/471 [00:26<01:12,  4.74it/s] 27%|██▋       | 129/471 [00:26<01:16,  4.45it/s] 28%|██▊       | 130/471 [00:27<01:12,  4.70it/s] 28%|██▊       | 131/471 [00:27<01:15,  4.52it/s] 28%|██▊       | 132/471 [00:27<01:10,  4.79it/s] 28%|██▊       | 133/471 [00:27<01:14,  4.56it/s] 28%|██▊       | 134/471 [00:27<01:12,  4.62it/s] 29%|██▊       | 135/471 [00:28<01:15,  4.47it/s] 29%|██▉       | 136/471 [00:28<01:13,  4.58it/s] 29%|██▉       | 137/471 [00:28<01:12,  4.60it/s] 29%|██▉       | 138/471 [00:28<01:12,  4.60it/s] 30%|██▉       | 139/471 [00:29<01:12,  4.58it/s] 30%|██▉       | 140/471 [00:29<01:13,  4.48it/s] 30%|██▉       | 141/471 [00:29<01:10,  4.71it/s] 30%|███       | 142/471 [00:29<01:12,  4.56it/s] 30%|███       | 143/471 [00:29<01:04,  5.10it/s] 31%|███       | 144/471 [00:30<01:10,  4.62it/s] 31%|███       | 145/471 [00:30<01:07,  4.81it/s] 31%|███       | 146/471 [00:30<01:12,  4.46it/s] 31%|███       | 147/471 [00:30<01:08,  4.73it/s] 31%|███▏      | 148/471 [00:30<01:12,  4.48it/s] 32%|███▏      | 149/471 [00:31<01:08,  4.73it/s] 32%|███▏      | 150/471 [00:31<01:11,  4.51it/s] 32%|███▏      | 151/471 [00:31<01:11,  4.47it/s] 32%|███▏      | 152/471 [00:31<01:09,  4.58it/s] 32%|███▏      | 153/471 [00:32<01:10,  4.49it/s] 33%|███▎      | 154/471 [00:32<01:02,  5.06it/s] 33%|███▎      | 155/471 [00:32<01:07,  4.69it/s] 33%|███▎      | 156/471 [00:32<01:04,  4.91it/s] 33%|███▎      | 157/471 [00:32<01:08,  4.60it/s] 34%|███▎      | 158/471 [00:33<01:03,  4.96it/s] 34%|███▍      | 159/471 [00:33<01:07,  4.62it/s] 34%|███▍      | 160/471 [00:33<01:02,  5.00it/s] 34%|███▍      | 161/471 [00:33<01:04,  4.83it/s] 34%|███▍      | 162/471 [00:33<01:06,  4.67it/s] 35%|███▍      | 163/471 [00:34<01:06,  4.64it/s] 35%|███▍      | 164/471 [00:34<01:06,  4.60it/s] 35%|███▌      | 165/471 [00:34<01:01,  4.94it/s] 35%|███▌      | 166/471 [00:34<01:02,  4.87it/s] 35%|███▌      | 167/471 [00:34<01:03,  4.82it/s] 36%|███▌      | 168/471 [00:35<01:05,  4.62it/s] 36%|███▌      | 169/471 [00:35<01:03,  4.74it/s] 36%|███▌      | 170/471 [00:35<01:06,  4.55it/s] 36%|███▋      | 171/471 [00:35<01:01,  4.87it/s] 37%|███▋      | 172/471 [00:36<01:06,  4.50it/s] 37%|███▋      | 173/471 [00:36<01:04,  4.65it/s] 37%|███▋      | 174/471 [00:36<01:05,  4.54it/s] 37%|███▋      | 175/471 [00:36<01:04,  4.62it/s] 37%|███▋      | 176/471 [00:36<01:03,  4.67it/s] 38%|███▊      | 177/471 [00:37<01:03,  4.63it/s] 38%|███▊      | 178/471 [00:37<01:04,  4.55it/s] 38%|███▊      | 179/471 [00:37<01:04,  4.53it/s] 38%|███▊      | 180/471 [00:37<01:03,  4.57it/s] 38%|███▊      | 181/471 [00:38<01:03,  4.53it/s] 39%|███▊      | 182/471 [00:38<01:01,  4.67it/s] 39%|███▉      | 183/471 [00:38<01:04,  4.48it/s] 39%|███▉      | 184/471 [00:38<01:02,  4.59it/s] 39%|███▉      | 185/471 [00:38<01:04,  4.41it/s] 39%|███▉      | 186/471 [00:39<01:01,  4.67it/s] 40%|███▉      | 187/471 [00:39<01:02,  4.53it/s] 40%|███▉      | 188/471 [00:39<00:59,  4.73it/s] 40%|████      | 189/471 [00:39<01:03,  4.41it/s] 40%|████      | 190/471 [00:39<00:59,  4.72it/s] 41%|████      | 191/471 [00:40<01:03,  4.44it/s] 41%|████      | 192/471 [00:40<00:58,  4.75it/s] 41%|████      | 193/471 [00:40<01:00,  4.60it/s] 41%|████      | 194/471 [00:40<01:00,  4.58it/s] 41%|████▏     | 195/471 [00:41<00:59,  4.64it/s] 42%|████▏     | 196/471 [00:41<00:59,  4.63it/s] 42%|████▏     | 197/471 [00:41<00:57,  4.77it/s] 42%|████▏     | 198/471 [00:41<00:57,  4.72it/s] 42%|████▏     | 199/471 [00:41<00:54,  5.04it/s] 42%|████▏     | 200/471 [00:42<00:57,  4.67it/s] 43%|████▎     | 201/471 [00:42<00:55,  4.85it/s] 43%|████▎     | 202/471 [00:42<00:58,  4.56it/s] 43%|████▎     | 203/471 [00:42<00:54,  4.90it/s] 43%|████▎     | 204/471 [00:42<00:57,  4.64it/s] 44%|████▎     | 205/471 [00:43<00:55,  4.78it/s] 44%|████▎     | 206/471 [00:43<00:58,  4.56it/s] 44%|████▍     | 207/471 [00:43<00:58,  4.52it/s] 44%|████▍     | 208/471 [00:43<00:57,  4.61it/s] 44%|████▍     | 209/471 [00:44<00:57,  4.57it/s] 45%|████▍     | 210/471 [00:44<00:55,  4.75it/s] 45%|████▍     | 211/471 [00:44<00:57,  4.51it/s] 45%|████▌     | 212/471 [00:44<00:53,  4.81it/s] 45%|████▌     | 213/471 [00:44<00:56,  4.55it/s] 45%|████▌     | 214/471 [00:45<00:51,  4.94it/s] 46%|████▌     | 215/471 [00:45<00:55,  4.62it/s] 46%|████▌     | 216/471 [00:45<00:52,  4.89it/s] 46%|████▌     | 217/471 [00:45<00:55,  4.54it/s] 46%|████▋     | 218/471 [00:45<00:54,  4.62it/s] 46%|████▋     | 219/471 [00:46<00:53,  4.71it/s] 47%|████▋     | 220/471 [00:46<00:54,  4.65it/s] 47%|████▋     | 221/471 [00:46<00:51,  4.85it/s] 47%|████▋     | 222/471 [00:46<00:54,  4.58it/s] 47%|████▋     | 223/471 [00:46<00:49,  4.99it/s] 48%|████▊     | 224/471 [00:47<00:53,  4.64it/s] 48%|████▊     | 225/471 [00:47<00:48,  5.05it/s] 48%|████▊     | 226/471 [00:47<00:50,  4.87it/s] 48%|████▊     | 227/471 [00:47<00:51,  4.70it/s] 48%|████▊     | 228/471 [00:48<00:50,  4.82it/s] 49%|████▊     | 229/471 [00:48<00:52,  4.64it/s] 49%|████▉     | 230/471 [00:48<00:49,  4.89it/s] 49%|████▉     | 231/471 [00:48<00:51,  4.67it/s] 49%|████▉     | 232/471 [00:48<00:48,  4.90it/s] 49%|████▉     | 233/471 [00:49<00:52,  4.51it/s] 50%|████▉     | 234/471 [00:49<00:48,  4.89it/s] 50%|████▉     | 235/471 [00:49<00:52,  4.51it/s] 50%|█████     | 236/471 [00:49<00:47,  4.93it/s] 50%|█████     | 237/471 [00:49<00:48,  4.87it/s] 51%|█████     | 238/471 [00:50<00:49,  4.72it/s] 51%|█████     | 239/471 [00:50<00:49,  4.69it/s] 51%|█████     | 240/471 [00:50<00:50,  4.56it/s] 51%|█████     | 241/471 [00:50<00:47,  4.87it/s] 51%|█████▏    | 242/471 [00:50<00:47,  4.78it/s] 52%|█████▏    | 243/471 [00:51<00:47,  4.81it/s] 52%|█████▏    | 244/471 [00:51<00:49,  4.62it/s] 52%|█████▏    | 245/471 [00:51<00:48,  4.64it/s] 52%|█████▏    | 246/471 [00:51<00:49,  4.54it/s] 52%|█████▏    | 247/471 [00:52<00:47,  4.71it/s] 53%|█████▎    | 248/471 [00:52<00:48,  4.55it/s] 53%|█████▎    | 249/471 [00:52<00:46,  4.76it/s] 53%|█████▎    | 250/471 [00:52<00:49,  4.43it/s] 53%|█████▎    | 251/471 [00:52<00:46,  4.75it/s] 54%|█████▎    | 252/471 [00:53<00:48,  4.55it/s] 54%|█████▎    | 253/471 [00:53<00:42,  5.13it/s] 54%|█████▍    | 254/471 [00:53<00:42,  5.06it/s] 54%|█████▍    | 255/471 [00:53<00:41,  5.18it/s] 54%|█████▍    | 256/471 [00:53<00:41,  5.23it/s] 55%|█████▍    | 257/471 [00:54<00:40,  5.30it/s] 55%|█████▍    | 258/471 [00:54<00:39,  5.38it/s] 55%|█████▍    | 259/471 [00:54<00:38,  5.44it/s] 55%|█████▌    | 260/471 [00:54<00:38,  5.52it/s] 55%|█████▌    | 261/471 [00:54<00:38,  5.45it/s] 56%|█████▌    | 262/471 [00:54<00:34,  5.98it/s] 56%|█████▌    | 263/471 [00:55<00:34,  6.01it/s] 56%|█████▋    | 265/471 [00:55<00:31,  6.48it/s] 56%|█████▋    | 266/471 [00:55<00:30,  6.63it/s] 57%|█████▋    | 267/471 [00:55<00:31,  6.44it/s] 57%|█████▋    | 268/471 [00:55<00:31,  6.54it/s] 57%|█████▋    | 269/471 [00:55<00:33,  6.10it/s] 57%|█████▋    | 270/471 [00:56<00:33,  6.05it/s] 58%|█████▊    | 271/471 [00:56<00:35,  5.66it/s] 58%|█████▊    | 272/471 [00:56<00:35,  5.57it/s] 58%|█████▊    | 273/471 [00:56<00:35,  5.60it/s] 58%|█████▊    | 274/471 [00:56<00:36,  5.47it/s] 58%|█████▊    | 275/471 [00:57<00:32,  6.01it/s] 59%|█████▊    | 276/471 [00:57<00:33,  5.91it/s] 59%|█████▉    | 277/471 [00:57<00:32,  6.06it/s] 59%|█████▉    | 278/471 [00:57<00:34,  5.66it/s] 59%|█████▉    | 279/471 [00:57<00:32,  5.94it/s] 59%|█████▉    | 280/471 [00:57<00:34,  5.57it/s] 60%|█████▉    | 281/471 [00:58<00:31,  6.10it/s] 60%|█████▉    | 282/471 [00:58<00:34,  5.56it/s] 60%|██████    | 283/471 [00:58<00:31,  5.93it/s] 60%|██████    | 284/471 [00:58<00:33,  5.62it/s] 61%|██████    | 285/471 [00:58<00:32,  5.76it/s] 61%|██████    | 286/471 [00:58<00:32,  5.67it/s] 61%|██████    | 287/471 [00:59<00:32,  5.72it/s] 61%|██████    | 288/471 [00:59<00:31,  5.82it/s] 61%|██████▏   | 289/471 [00:59<00:32,  5.65it/s] 62%|██████▏   | 290/471 [00:59<00:30,  5.92it/s] 62%|██████▏   | 291/471 [00:59<00:31,  5.64it/s] 62%|██████▏   | 292/471 [00:59<00:29,  6.11it/s] 62%|██████▏   | 293/471 [01:00<00:31,  5.65it/s] 62%|██████▏   | 294/471 [01:00<00:28,  6.12it/s] 63%|██████▎   | 295/471 [01:00<00:31,  5.61it/s] 63%|██████▎   | 296/471 [01:00<00:29,  5.89it/s] 63%|██████▎   | 297/471 [01:00<00:30,  5.62it/s] 63%|██████▎   | 298/471 [01:01<00:30,  5.71it/s] 63%|██████▎   | 299/471 [01:01<00:29,  5.83it/s] 64%|██████▎   | 300/471 [01:01<00:30,  5.70it/s] 64%|██████▍   | 301/471 [01:01<00:28,  6.02it/s] 64%|██████▍   | 302/471 [01:01<00:29,  5.73it/s] 64%|██████▍   | 303/471 [01:01<00:27,  6.18it/s] 65%|██████▍   | 304/471 [01:02<00:31,  5.36it/s] 65%|██████▍   | 305/471 [01:02<00:30,  5.36it/s] 65%|██████▍   | 306/471 [01:02<00:34,  4.77it/s] 65%|██████▌   | 307/471 [01:02<00:33,  4.93it/s] 65%|██████▌   | 308/471 [01:02<00:34,  4.76it/s] 66%|██████▌   | 309/471 [01:03<00:31,  5.15it/s] 66%|██████▌   | 310/471 [01:03<00:31,  5.16it/s] 66%|██████▌   | 311/471 [01:03<00:30,  5.23it/s] 66%|██████▌   | 312/471 [01:03<00:29,  5.36it/s] 66%|██████▋   | 313/471 [01:03<00:29,  5.32it/s] 67%|██████▋   | 314/471 [01:04<00:27,  5.62it/s] 67%|██████▋   | 315/471 [01:04<00:28,  5.42it/s] 67%|██████▋   | 316/471 [01:04<00:27,  5.55it/s] 67%|██████▋   | 317/471 [01:04<00:29,  5.22it/s] 68%|██████▊   | 318/471 [01:04<00:27,  5.51it/s] 68%|██████▊   | 319/471 [01:04<00:28,  5.29it/s] 68%|██████▊   | 320/471 [01:05<00:26,  5.65it/s] 68%|██████▊   | 321/471 [01:05<00:28,  5.26it/s] 68%|██████▊   | 322/471 [01:05<00:27,  5.50it/s] 69%|██████▊   | 323/471 [01:05<00:28,  5.22it/s] 69%|██████▉   | 324/471 [01:05<00:26,  5.50it/s] 69%|██████▉   | 325/471 [01:06<00:27,  5.30it/s] 69%|██████▉   | 326/471 [01:06<00:28,  5.01it/s] 69%|██████▉   | 327/471 [01:06<00:29,  4.83it/s] 70%|██████▉   | 328/471 [01:06<00:30,  4.68it/s] 70%|██████▉   | 329/471 [01:06<00:29,  4.81it/s] 70%|███████   | 330/471 [01:07<00:30,  4.70it/s] 70%|███████   | 331/471 [01:07<00:29,  4.80it/s] 70%|███████   | 332/471 [01:07<00:30,  4.53it/s] 71%|███████   | 333/471 [01:07<00:29,  4.73it/s] 71%|███████   | 334/471 [01:08<00:30,  4.51it/s] 71%|███████   | 335/471 [01:08<00:28,  4.79it/s] 71%|███████▏  | 336/471 [01:08<00:29,  4.57it/s] 72%|███████▏  | 337/471 [01:08<00:28,  4.71it/s] 72%|███████▏  | 338/471 [01:08<00:29,  4.45it/s] 72%|███████▏  | 339/471 [01:09<00:28,  4.62it/s] 72%|███████▏  | 340/471 [01:09<00:28,  4.61it/s] 72%|███████▏  | 341/471 [01:09<00:27,  4.77it/s] 73%|███████▎  | 342/471 [01:09<00:24,  5.17it/s] 73%|███████▎  | 343/471 [01:09<00:24,  5.16it/s] 73%|███████▎  | 344/471 [01:10<00:22,  5.61it/s] 73%|███████▎  | 345/471 [01:10<00:23,  5.28it/s] 73%|███████▎  | 346/471 [01:10<00:22,  5.49it/s] 74%|███████▎  | 347/471 [01:10<00:25,  4.85it/s] 74%|███████▍  | 348/471 [01:10<00:24,  4.98it/s] 74%|███████▍  | 349/471 [01:11<00:26,  4.56it/s] 74%|███████▍  | 350/471 [01:11<00:24,  4.86it/s] 75%|███████▍  | 351/471 [01:11<00:25,  4.65it/s] 75%|███████▍  | 352/471 [01:11<00:24,  4.76it/s] 75%|███████▍  | 353/471 [01:12<00:26,  4.45it/s] 75%|███████▌  | 354/471 [01:12<00:25,  4.59it/s] 75%|███████▌  | 355/471 [01:12<00:25,  4.62it/s] 76%|███████▌  | 356/471 [01:12<00:25,  4.59it/s] 76%|███████▌  | 357/471 [01:12<00:23,  4.77it/s] 76%|███████▌  | 358/471 [01:13<00:24,  4.54it/s] 76%|███████▌  | 359/471 [01:13<00:24,  4.64it/s] 76%|███████▋  | 360/471 [01:13<00:24,  4.52it/s] 77%|███████▋  | 361/471 [01:13<00:23,  4.75it/s] 77%|███████▋  | 362/471 [01:13<00:23,  4.58it/s] 77%|███████▋  | 363/471 [01:14<00:22,  4.78it/s] 77%|███████▋  | 364/471 [01:14<00:24,  4.44it/s] 77%|███████▋  | 365/471 [01:14<00:22,  4.79it/s] 78%|███████▊  | 366/471 [01:14<00:23,  4.47it/s] 78%|███████▊  | 367/471 [01:14<00:21,  4.81it/s] 78%|███████▊  | 368/471 [01:15<00:22,  4.53it/s] 78%|███████▊  | 369/471 [01:15<00:22,  4.55it/s] 79%|███████▊  | 370/471 [01:15<00:21,  4.60it/s] 79%|███████▉  | 371/471 [01:15<00:22,  4.51it/s] 79%|███████▉  | 372/471 [01:16<00:20,  4.85it/s] 79%|███████▉  | 373/471 [01:16<00:21,  4.58it/s] 79%|███████▉  | 374/471 [01:16<00:20,  4.85it/s] 80%|███████▉  | 375/471 [01:16<00:21,  4.56it/s] 80%|███████▉  | 376/471 [01:16<00:19,  4.92it/s] 80%|████████  | 377/471 [01:17<00:20,  4.53it/s] 80%|████████  | 378/471 [01:17<00:18,  4.95it/s] 80%|████████  | 379/471 [01:17<00:20,  4.54it/s] 81%|████████  | 380/471 [01:17<00:19,  4.59it/s] 81%|████████  | 381/471 [01:18<00:19,  4.64it/s] 81%|████████  | 382/471 [01:18<00:19,  4.61it/s] 81%|████████▏ | 383/471 [01:18<00:17,  5.14it/s] 82%|████████▏ | 384/471 [01:18<00:16,  5.18it/s] 82%|████████▏ | 386/471 [01:18<00:14,  5.87it/s] 82%|████████▏ | 387/471 [01:19<00:14,  5.86it/s] 82%|████████▏ | 388/471 [01:19<00:14,  5.68it/s] 83%|████████▎ | 389/471 [01:19<00:14,  5.53it/s] 83%|████████▎ | 390/471 [01:19<00:13,  5.82it/s] 83%|████████▎ | 391/471 [01:19<00:14,  5.70it/s] 83%|████████▎ | 392/471 [01:19<00:13,  5.81it/s] 83%|████████▎ | 393/471 [01:20<00:14,  5.38it/s] 84%|████████▎ | 394/471 [01:20<00:13,  5.68it/s] 84%|████████▍ | 395/471 [01:20<00:14,  5.38it/s] 84%|████████▍ | 396/471 [01:20<00:12,  5.79it/s] 84%|████████▍ | 397/471 [01:20<00:12,  5.95it/s] 85%|████████▍ | 398/471 [01:21<00:13,  5.26it/s] 85%|████████▍ | 399/471 [01:21<00:14,  5.08it/s] 85%|████████▍ | 400/471 [01:21<00:13,  5.09it/s] 85%|████████▌ | 401/471 [01:21<00:12,  5.57it/s] 85%|████████▌ | 402/471 [01:21<00:13,  5.29it/s] 86%|████████▌ | 403/471 [01:21<00:12,  5.27it/s] 86%|████████▌ | 404/471 [01:22<00:13,  4.81it/s] 86%|████████▌ | 405/471 [01:22<00:13,  4.86it/s] 86%|████████▌ | 406/471 [01:22<00:13,  4.65it/s] 86%|████████▋ | 407/471 [01:22<00:13,  4.81it/s] 87%|████████▋ | 408/471 [01:23<00:13,  4.81it/s] 87%|████████▋ | 409/471 [01:23<00:13,  4.63it/s] 87%|████████▋ | 410/471 [01:23<00:12,  4.70it/s] 87%|████████▋ | 411/471 [01:23<00:12,  4.67it/s] 87%|████████▋ | 412/471 [01:23<00:12,  4.71it/s] 88%|████████▊ | 413/471 [01:24<00:12,  4.72it/s] 88%|████████▊ | 414/471 [01:24<00:12,  4.63it/s] 88%|████████▊ | 415/471 [01:24<00:12,  4.56it/s] 88%|████████▊ | 416/471 [01:24<00:11,  4.61it/s] 89%|████████▊ | 417/471 [01:25<00:11,  4.64it/s] 89%|████████▊ | 418/471 [01:25<00:11,  4.79it/s] 89%|████████▉ | 419/471 [01:25<00:10,  4.76it/s] 89%|████████▉ | 420/471 [01:25<00:11,  4.54it/s] 89%|████████▉ | 421/471 [01:25<00:10,  4.65it/s] 90%|████████▉ | 422/471 [01:26<00:10,  4.53it/s] 90%|████████▉ | 423/471 [01:26<00:10,  4.69it/s] 90%|█████████ | 424/471 [01:26<00:09,  4.75it/s] 90%|█████████ | 425/471 [01:26<00:09,  4.84it/s] 90%|█████████ | 426/471 [01:26<00:09,  4.61it/s] 91%|█████████ | 427/471 [01:27<00:09,  4.60it/s] 91%|█████████ | 428/471 [01:27<00:09,  4.60it/s] 91%|█████████ | 429/471 [01:27<00:09,  4.59it/s] 91%|█████████▏| 430/471 [01:27<00:08,  4.70it/s] 92%|█████████▏| 431/471 [01:28<00:08,  4.54it/s] 92%|█████████▏| 432/471 [01:28<00:08,  4.57it/s] 92%|█████████▏| 433/471 [01:28<00:08,  4.51it/s] 92%|█████████▏| 434/471 [01:28<00:07,  4.70it/s] 92%|█████████▏| 435/471 [01:28<00:07,  4.61it/s] 93%|█████████▎| 436/471 [01:29<00:07,  4.80it/s] 93%|█████████▎| 437/471 [01:29<00:07,  4.45it/s] 93%|█████████▎| 438/471 [01:29<00:07,  4.67it/s] 93%|█████████▎| 439/471 [01:29<00:07,  4.47it/s] 93%|█████████▎| 440/471 [01:29<00:06,  4.73it/s] 94%|█████████▎| 441/471 [01:30<00:06,  4.55it/s] 94%|█████████▍| 442/471 [01:30<00:06,  4.64it/s] 94%|█████████▍| 443/471 [01:30<00:06,  4.50it/s] 94%|█████████▍| 444/471 [01:30<00:05,  4.58it/s] 94%|█████████▍| 445/471 [01:31<00:05,  4.61it/s] 95%|█████████▍| 446/471 [01:31<00:05,  4.63it/s] 95%|█████████▍| 447/471 [01:31<00:05,  4.59it/s] 95%|█████████▌| 448/471 [01:31<00:05,  4.49it/s] 95%|█████████▌| 449/471 [01:31<00:04,  4.71it/s] 96%|█████████▌| 450/471 [01:32<00:04,  4.56it/s] 96%|█████████▌| 451/471 [01:32<00:04,  4.83it/s] 96%|█████████▌| 452/471 [01:32<00:04,  4.56it/s] 96%|█████████▌| 453/471 [01:32<00:03,  4.80it/s] 96%|█████████▋| 454/471 [01:33<00:03,  4.45it/s] 97%|█████████▋| 455/471 [01:33<00:03,  4.75it/s] 97%|█████████▋| 456/471 [01:33<00:03,  4.58it/s] 97%|█████████▋| 457/471 [01:33<00:02,  4.76it/s] 97%|█████████▋| 458/471 [01:33<00:02,  4.65it/s] 97%|█████████▋| 459/471 [01:34<00:02,  4.57it/s] 98%|█████████▊| 460/471 [01:34<00:02,  4.63it/s] 98%|█████████▊| 461/471 [01:34<00:02,  4.54it/s] 98%|█████████▊| 462/471 [01:34<00:01,  4.89it/s] 98%|█████████▊| 463/471 [01:34<00:01,  4.76it/s] 99%|█████████▊| 464/471 [01:35<00:01,  4.84it/s] 99%|█████████▊| 465/471 [01:35<00:01,  4.55it/s] 99%|█████████▉| 466/471 [01:35<00:01,  4.83it/s] 99%|█████████▉| 467/471 [01:35<00:00,  4.63it/s] 99%|█████████▉| 468/471 [01:35<00:00,  4.79it/s]100%|█████████▉| 469/471 [01:36<00:00,  4.69it/s]100%|█████████▉| 470/471 [01:36<00:00,  4.64it/s]100%|██████████| 471/471 [01:36<00:00,  4.93it/s]100%|██████████| 471/471 [01:36<00:00,  4.87it/s]
{'eval_loss': 2.1758501529693604, 'eval_model_preparation_time': 0.0046, 'eval_acc': 0.4646840148698885, 'eval_runtime': 96.7879, 'eval_samples_per_second': 77.82, 'eval_steps_per_second': 4.866}
ROUND:10
CLIENT:26
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.43it/s]                                              {'loss': 2.1908, 'grad_norm': 3.386812448501587, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.43it/s]  5%|▌         | 2/40 [00:00<00:16,  2.37it/s]                                              {'loss': 2.129, 'grad_norm': 3.610238552093506, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.37it/s]  8%|▊         | 3/40 [00:01<00:16,  2.28it/s]                                              {'loss': 2.3503, 'grad_norm': 4.447786808013916, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.28it/s] 10%|█         | 4/40 [00:01<00:15,  2.30it/s]                                              {'loss': 2.2303, 'grad_norm': 6.376156806945801, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.30it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.5175, 'grad_norm': 3.795553684234619, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.2372, 'grad_norm': 3.6289854049682617, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.21it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s]                                              {'loss': 2.1987, 'grad_norm': 3.5669913291931152, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.24it/s] 20%|██        | 8/40 [00:03<00:10,  2.94it/s]                                              {'loss': 2.2714, 'grad_norm': 11.032340049743652, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.94it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.00it/s]                                              {'loss': 2.0303, 'grad_norm': 3.379002571105957, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.00it/s] 25%|██▌       | 10/40 [00:03<00:09,  3.02it/s]                                               {'loss': 2.1434, 'grad_norm': 4.014652252197266, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:09,  3.02it/s] 28%|██▊       | 11/40 [00:04<00:09,  2.92it/s]                                               {'loss': 2.2036, 'grad_norm': 4.1519551277160645, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:09,  2.92it/s] 30%|███       | 12/40 [00:04<00:09,  2.84it/s]                                               {'loss': 2.069, 'grad_norm': 3.9467296600341797, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.84it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.79it/s]                                               {'loss': 1.9392, 'grad_norm': 4.459264755249023, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.79it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.75it/s]                                               {'loss': 2.2504, 'grad_norm': 3.585632562637329, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.75it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.73it/s]                                               {'loss': 2.2596, 'grad_norm': 4.227779865264893, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.73it/s]                                               {'loss': 1.431, 'grad_norm': 8.487771987915039, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:08,  2.73it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.38it/s]                                               {'loss': 1.9886, 'grad_norm': 3.072392225265503, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.38it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.25it/s]                                               {'loss': 2.0445, 'grad_norm': 3.4832754135131836, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.25it/s] 48%|████▊     | 19/40 [00:06<00:06,  3.12it/s]                                               {'loss': 2.1029, 'grad_norm': 6.854945182800293, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:06,  3.12it/s] 50%|█████     | 20/40 [00:07<00:06,  2.98it/s]                                               {'loss': 2.292, 'grad_norm': 5.019808769226074, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  2.98it/s] 52%|█████▎    | 21/40 [00:07<00:06,  2.89it/s]                                               {'loss': 2.2315, 'grad_norm': 4.019505500793457, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  2.89it/s] 55%|█████▌    | 22/40 [00:07<00:06,  2.82it/s]                                               {'loss': 2.068, 'grad_norm': 3.8455846309661865, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:06,  2.82it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.76it/s]                                               {'loss': 1.9442, 'grad_norm': 3.2354841232299805, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.76it/s]                                               {'loss': 2.5784, 'grad_norm': 34.082340240478516, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.76it/s] 62%|██████▎   | 25/40 [00:08<00:04,  3.32it/s]                                               {'loss': 2.1399, 'grad_norm': 4.317632675170898, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:04,  3.32it/s] 65%|██████▌   | 26/40 [00:09<00:04,  2.95it/s]                                               {'loss': 2.1064, 'grad_norm': 3.3818562030792236, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  2.95it/s] 68%|██████▊   | 27/40 [00:09<00:04,  2.75it/s]                                               {'loss': 2.1943, 'grad_norm': 4.90201473236084, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  2.75it/s] 70%|███████   | 28/40 [00:10<00:04,  2.61it/s]                                               {'loss': 2.0374, 'grad_norm': 4.308525562286377, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.61it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.45it/s]                                               {'loss': 2.1755, 'grad_norm': 3.2106242179870605, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.45it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.38it/s]                                               {'loss': 1.8997, 'grad_norm': 3.642930030822754, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.38it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.29it/s]                                               {'loss': 2.0437, 'grad_norm': 5.821540832519531, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.29it/s] 80%|████████  | 32/40 [00:11<00:02,  2.87it/s]                                               {'loss': 2.2795, 'grad_norm': 13.89504337310791, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.87it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s]                                               {'loss': 1.9783, 'grad_norm': 3.3838932514190674, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.68it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.51it/s]                                               {'loss': 1.9722, 'grad_norm': 3.52128529548645, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.51it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.41it/s]                                               {'loss': 2.0789, 'grad_norm': 5.899267673492432, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.41it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.35it/s]                                               {'loss': 1.9244, 'grad_norm': 3.855546712875366, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.35it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.28it/s]                                               {'loss': 2.2507, 'grad_norm': 4.130319118499756, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.28it/s]                                               {'loss': 2.322, 'grad_norm': 4.252605438232422, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.22it/s]                                               {'loss': 1.9441, 'grad_norm': 2.6254734992980957, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.22it/s]100%|██████████| 40/40 [00:14<00:00,  2.83it/s]                                               {'loss': 1.3814, 'grad_norm': 12.199894905090332, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.83it/s]                                               {'train_runtime': 15.0759, 'train_samples_per_second': 37.477, 'train_steps_per_second': 2.653, 'train_loss': 2.110750985145569, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.83it/s]100%|██████████| 40/40 [00:15<00:00,  2.65it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.24it/s]                                              {'loss': 2.1249, 'grad_norm': 3.7427868843078613, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.24it/s]  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]                                              {'loss': 2.1773, 'grad_norm': 3.8251593112945557, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]  8%|▊         | 3/40 [00:01<00:17,  2.17it/s]                                              {'loss': 2.3181, 'grad_norm': 4.222630500793457, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.17it/s] 10%|█         | 4/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.2537, 'grad_norm': 4.704371929168701, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:17,  2.12it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.4912, 'grad_norm': 5.143733501434326, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.301, 'grad_norm': 4.727569580078125, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.1334, 'grad_norm': 4.0118255615234375, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.5363, 'grad_norm': 11.448108673095703, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:15,  2.12it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s]                                              {'loss': 2.2239, 'grad_norm': 4.132811069488525, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s]                                               {'loss': 2.028, 'grad_norm': 3.0573418140411377, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.49it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.42it/s]                                               {'loss': 2.0132, 'grad_norm': 3.9218578338623047, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.42it/s] 30%|███       | 12/40 [00:05<00:12,  2.31it/s]                                               {'loss': 2.2149, 'grad_norm': 4.263889789581299, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.31it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.0706, 'grad_norm': 4.588390827178955, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.3978, 'grad_norm': 4.638408660888672, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.1454, 'grad_norm': 4.31109094619751, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.84it/s]                                               {'loss': 1.5939, 'grad_norm': 10.923542976379395, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.84it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.74it/s]                                               {'loss': 2.1403, 'grad_norm': 3.445594549179077, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.74it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.50it/s]                                               {'loss': 2.1209, 'grad_norm': 4.358638763427734, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.50it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.41it/s]                                               {'loss': 2.1054, 'grad_norm': 3.5207698345184326, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.41it/s] 50%|█████     | 20/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.1167, 'grad_norm': 3.6763765811920166, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.35it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.0471, 'grad_norm': 3.873581647872925, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s]                                               {'loss': 2.033, 'grad_norm': 3.5212814807891846, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s]                                               {'loss': 2.1355, 'grad_norm': 3.6844441890716553, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s] 60%|██████    | 24/40 [00:10<00:05,  2.81it/s]                                               {'loss': 2.3539, 'grad_norm': 13.803948402404785, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s]                                               {'loss': 1.967, 'grad_norm': 3.9733388423919678, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s]                                               {'loss': 2.0924, 'grad_norm': 3.458214521408081, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s]                                               {'loss': 2.0523, 'grad_norm': 2.7770369052886963, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s] 70%|███████   | 28/40 [00:11<00:05,  2.38it/s]                                               {'loss': 2.4055, 'grad_norm': 3.8791468143463135, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.38it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s]                                               {'loss': 2.0155, 'grad_norm': 4.046054363250732, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.31it/s]                                               {'loss': 2.0726, 'grad_norm': 3.3521552085876465, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.31it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.28it/s]                                               {'loss': 1.8878, 'grad_norm': 3.315000534057617, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.28it/s] 80%|████████  | 32/40 [00:13<00:02,  2.84it/s]                                               {'loss': 1.2447, 'grad_norm': 13.630178451538086, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.84it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s]                                               {'loss': 2.1646, 'grad_norm': 3.6611719131469727, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.63it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.53it/s]                                               {'loss': 2.1034, 'grad_norm': 3.605950355529785, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.53it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.44it/s]                                               {'loss': 2.1257, 'grad_norm': 5.148061275482178, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.44it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.45it/s]                                               {'loss': 2.0997, 'grad_norm': 3.298966407775879, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.45it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.41it/s]                                               {'loss': 1.813, 'grad_norm': 3.5758607387542725, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.41it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.32it/s]                                               {'loss': 2.1846, 'grad_norm': 2.8869762420654297, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.32it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]                                               {'loss': 1.7679, 'grad_norm': 3.3715970516204834, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'loss': 1.9101, 'grad_norm': 13.059240341186523, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'train_runtime': 16.6181, 'train_samples_per_second': 33.999, 'train_steps_per_second': 2.407, 'train_loss': 2.0995804399251936, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]100%|██████████| 40/40 [00:16<00:00,  2.41it/s]
CLIENT:37
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.64it/s]                                              {'loss': 2.3228, 'grad_norm': 4.931990146636963, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.64it/s]  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]                                              {'loss': 2.428, 'grad_norm': 5.455748558044434, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.3364, 'grad_norm': 4.123902797698975, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.1584, 'grad_norm': 3.085568428039551, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s]                                              {'loss': 2.1509, 'grad_norm': 3.409477710723877, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.2243, 'grad_norm': 3.150467872619629, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 2.146, 'grad_norm': 3.092095375061035, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 1.9142, 'grad_norm': 15.84805679321289, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.15it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.74it/s]                                              {'loss': 2.1402, 'grad_norm': 3.2173283100128174, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.74it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.61it/s]                                               {'loss': 2.0641, 'grad_norm': 3.141197681427002, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.61it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s]                                               {'loss': 2.1324, 'grad_norm': 3.077810764312744, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s] 30%|███       | 12/40 [00:05<00:11,  2.42it/s]                                               {'loss': 2.1161, 'grad_norm': 3.87558913230896, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.42it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.35it/s]                                               {'loss': 2.3787, 'grad_norm': 3.8877928256988525, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.35it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.28it/s]                                               {'loss': 2.2695, 'grad_norm': 3.2198452949523926, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.28it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.2349, 'grad_norm': 3.5408976078033447, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 3.7606, 'grad_norm': 16.2742977142334, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 1.9685, 'grad_norm': 3.447289228439331, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s]                                               {'loss': 2.0879, 'grad_norm': 3.4734158515930176, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.36it/s]                                               {'loss': 2.3408, 'grad_norm': 3.6639904975891113, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.36it/s] 50%|█████     | 20/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.1559, 'grad_norm': 4.049543380737305, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.32it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.29it/s]                                               {'loss': 2.1608, 'grad_norm': 4.018601894378662, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.29it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s]                                               {'loss': 1.9962, 'grad_norm': 2.9416637420654297, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s]                                               {'loss': 2.1853, 'grad_norm': 3.474475383758545, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s]                                               {'loss': 1.6155, 'grad_norm': 12.223736763000488, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:07,  2.22it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s]                                               {'loss': 2.1004, 'grad_norm': 2.952150583267212, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.69it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.57it/s]                                               {'loss': 1.9584, 'grad_norm': 3.15879225730896, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.57it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.42it/s]                                               {'loss': 2.2891, 'grad_norm': 3.5446722507476807, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.42it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.1903, 'grad_norm': 3.404259443283081, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s]                                               {'loss': 2.1767, 'grad_norm': 3.446594476699829, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.37it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.45it/s]                                               {'loss': 1.965, 'grad_norm': 4.005758285522461, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.45it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.46it/s]                                               {'loss': 2.0298, 'grad_norm': 3.469287633895874, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.46it/s] 80%|████████  | 32/40 [00:13<00:02,  3.13it/s]                                               {'loss': 2.1926, 'grad_norm': 14.307737350463867, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  3.13it/s] 82%|████████▎ | 33/40 [00:13<00:02,  3.07it/s]                                               {'loss': 2.0436, 'grad_norm': 3.334408760070801, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  3.07it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.06it/s]                                               {'loss': 2.0532, 'grad_norm': 3.69655442237854, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.06it/s] 88%|████████▊ | 35/40 [00:14<00:01,  3.01it/s]                                               {'loss': 2.1714, 'grad_norm': 3.1105823516845703, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  3.01it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.91it/s]                                               {'loss': 2.0166, 'grad_norm': 4.07070255279541, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.91it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.84it/s]                                               {'loss': 2.0785, 'grad_norm': 3.9831204414367676, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.84it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.77it/s]                                               {'loss': 2.2167, 'grad_norm': 3.3350205421447754, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.77it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.74it/s]                                               {'loss': 2.1508, 'grad_norm': 3.3829057216644287, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.74it/s]                                               {'loss': 2.1904, 'grad_norm': 11.149286270141602, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.74it/s]                                               {'train_runtime': 15.6976, 'train_samples_per_second': 35.993, 'train_steps_per_second': 2.548, 'train_loss': 2.1777946919202806, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.74it/s]100%|██████████| 40/40 [00:15<00:00,  2.55it/s]
CLIENT:86
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]                                              {'loss': 2.2439, 'grad_norm': 3.173614263534546, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]  5%|▌         | 2/40 [00:01<00:30,  1.25it/s]                                              {'loss': 2.2034, 'grad_norm': 3.9781713485717773, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:30,  1.25it/s]  8%|▊         | 3/40 [00:01<00:23,  1.56it/s]                                              {'loss': 2.3651, 'grad_norm': 4.4167094230651855, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.56it/s] 10%|█         | 4/40 [00:02<00:20,  1.77it/s]                                              {'loss': 2.2297, 'grad_norm': 4.895806312561035, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.77it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.89it/s]                                              {'loss': 2.2999, 'grad_norm': 4.798951148986816, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.89it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.02it/s]                                              {'loss': 2.3997, 'grad_norm': 6.142708778381348, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.02it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s]                                              {'loss': 2.244, 'grad_norm': 4.887289047241211, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s] 20%|██        | 8/40 [00:04<00:15,  2.07it/s]                                              {'loss': 2.8857, 'grad_norm': 14.068011283874512, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.07it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.11it/s]                                              {'loss': 2.2566, 'grad_norm': 3.298666000366211, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.11it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.14it/s]                                               {'loss': 2.2633, 'grad_norm': 3.9939451217651367, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.14it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s]                                               {'loss': 2.1892, 'grad_norm': 4.606492519378662, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s] 30%|███       | 12/40 [00:06<00:12,  2.19it/s]                                               {'loss': 2.2514, 'grad_norm': 4.374679088592529, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:12,  2.19it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.23it/s]                                               {'loss': 2.2504, 'grad_norm': 3.8254706859588623, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.23it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.32it/s]                                               {'loss': 2.3022, 'grad_norm': 4.134671688079834, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.32it/s] 38%|███▊      | 15/40 [00:07<00:10,  2.39it/s]                                               {'loss': 2.2769, 'grad_norm': 3.9763195514678955, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:10,  2.39it/s] 40%|████      | 16/40 [00:07<00:07,  3.03it/s]                                               {'loss': 2.2306, 'grad_norm': 16.353639602661133, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:07,  3.03it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.69it/s]                                               {'loss': 1.9851, 'grad_norm': 3.2013676166534424, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.69it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.53it/s]                                               {'loss': 2.1749, 'grad_norm': 3.9133872985839844, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.53it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.42it/s]                                               {'loss': 2.3038, 'grad_norm': 4.017356872558594, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.42it/s] 50%|█████     | 20/40 [00:09<00:08,  2.36it/s]                                               {'loss': 2.2024, 'grad_norm': 3.99755597114563, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.36it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.36it/s]                                               {'loss': 2.1879, 'grad_norm': 4.0027031898498535, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.36it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.29it/s]                                               {'loss': 2.058, 'grad_norm': 3.783940076828003, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.29it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s]                                               {'loss': 2.225, 'grad_norm': 4.8894124031066895, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.27it/s] 60%|██████    | 24/40 [00:10<00:05,  2.84it/s]                                               {'loss': 3.0052, 'grad_norm': 17.906614303588867, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.84it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.59it/s]                                               {'loss': 2.1714, 'grad_norm': 4.413082599639893, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s]                                               {'loss': 2.1703, 'grad_norm': 4.453195095062256, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.46it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.41it/s]                                               {'loss': 2.2775, 'grad_norm': 4.405551910400391, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.41it/s] 70%|███████   | 28/40 [00:12<00:05,  2.31it/s]                                               {'loss': 2.0441, 'grad_norm': 3.6257431507110596, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.31it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s]                                               {'loss': 2.0534, 'grad_norm': 3.7780637741088867, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.30it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s]                                               {'loss': 2.3073, 'grad_norm': 4.657775402069092, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.26it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s]                                               {'loss': 2.053, 'grad_norm': 3.5001182556152344, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s] 80%|████████  | 32/40 [00:13<00:02,  2.90it/s]                                               {'loss': 1.8304, 'grad_norm': 8.037510871887207, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.90it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s]                                               {'loss': 2.2527, 'grad_norm': 3.047832727432251, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.64it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s]                                               {'loss': 2.0942, 'grad_norm': 3.6909339427948, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.37it/s]                                               {'loss': 1.9008, 'grad_norm': 3.3098039627075195, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.33it/s]                                               {'loss': 2.2848, 'grad_norm': 5.111206531524658, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.33it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.30it/s]                                               {'loss': 2.259, 'grad_norm': 3.646430730819702, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.29it/s]                                               {'loss': 2.0521, 'grad_norm': 4.490599155426025, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]                                               {'loss': 2.0885, 'grad_norm': 4.072106838226318, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.22it/s]100%|██████████| 40/40 [00:17<00:00,  2.85it/s]                                               {'loss': 1.4823, 'grad_norm': 9.989740371704102, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.85it/s]                                               {'train_runtime': 17.3977, 'train_samples_per_second': 32.476, 'train_steps_per_second': 2.299, 'train_loss': 2.2088968724012377, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.85it/s]100%|██████████| 40/40 [00:17<00:00,  2.30it/s]
CLIENT:76
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:15,  2.50it/s]                                              {'loss': 2.2802, 'grad_norm': 4.637063980102539, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:15,  2.50it/s]  5%|▌         | 2/40 [00:00<00:16,  2.29it/s]                                              {'loss': 2.166, 'grad_norm': 3.586437940597534, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.29it/s]  8%|▊         | 3/40 [00:01<00:16,  2.26it/s]                                              {'loss': 2.4186, 'grad_norm': 5.846455097198486, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.26it/s] 10%|█         | 4/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.2514, 'grad_norm': 3.7112741470336914, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.23it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.1864, 'grad_norm': 5.829408168792725, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.25it/s]                                              {'loss': 2.3572, 'grad_norm': 5.086989402770996, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.25it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s]                                              {'loss': 2.1692, 'grad_norm': 3.273920774459839, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s] 20%|██        | 8/40 [00:03<00:11,  2.84it/s]                                              {'loss': 2.3419, 'grad_norm': 11.137415885925293, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.84it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s]                                              {'loss': 2.1886, 'grad_norm': 3.8126413822174072, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s]                                               {'loss': 2.099, 'grad_norm': 3.7457313537597656, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.44it/s]                                               {'loss': 2.2968, 'grad_norm': 4.5392889976501465, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.44it/s] 30%|███       | 12/40 [00:04<00:11,  2.46it/s]                                               {'loss': 2.2392, 'grad_norm': 3.443087339401245, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.46it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.35it/s]                                               {'loss': 2.1445, 'grad_norm': 2.6718883514404297, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.35it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.29it/s]                                               {'loss': 2.1052, 'grad_norm': 3.0957508087158203, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.29it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.0757, 'grad_norm': 3.4986140727996826, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.26it/s] 40%|████      | 16/40 [00:06<00:08,  2.86it/s]                                               {'loss': 1.9463, 'grad_norm': 14.048247337341309, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.86it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s]                                               {'loss': 2.0485, 'grad_norm': 4.022584915161133, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.018, 'grad_norm': 3.8061959743499756, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s]                                               {'loss': 2.0422, 'grad_norm': 3.6850571632385254, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.39it/s] 50%|█████     | 20/40 [00:08<00:08,  2.34it/s]                                               {'loss': 2.2377, 'grad_norm': 5.852015018463135, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.34it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s]                                               {'loss': 1.9272, 'grad_norm': 3.4231536388397217, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.0908, 'grad_norm': 3.7740817070007324, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.0154, 'grad_norm': 3.0792324542999268, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.84it/s]                                               {'loss': 2.5028, 'grad_norm': 20.148624420166016, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.84it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s]                                               {'loss': 2.0056, 'grad_norm': 3.782971143722534, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.45it/s]                                               {'loss': 2.1614, 'grad_norm': 3.135683298110962, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.45it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.36it/s]                                               {'loss': 2.0882, 'grad_norm': 3.4703407287597656, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.36it/s] 70%|███████   | 28/40 [00:11<00:05,  2.27it/s]                                               {'loss': 1.9864, 'grad_norm': 3.137159824371338, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.27it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.1692, 'grad_norm': 3.7694480419158936, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.19it/s]                                               {'loss': 1.9119, 'grad_norm': 4.583320617675781, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.19it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s]                                               {'loss': 2.0353, 'grad_norm': 4.0472731590271, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.19it/s]                                               {'loss': 1.7858, 'grad_norm': 16.629093170166016, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.19it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.73it/s]                                               {'loss': 2.0026, 'grad_norm': 3.1776883602142334, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.73it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.58it/s]                                               {'loss': 2.3251, 'grad_norm': 3.741878032684326, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.58it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.47it/s]                                               {'loss': 2.2673, 'grad_norm': 2.7521417140960693, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.47it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s]                                               {'loss': 1.8745, 'grad_norm': 3.749760627746582, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s]                                               {'loss': 1.8543, 'grad_norm': 2.9160940647125244, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.33it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.27it/s]                                               {'loss': 2.2266, 'grad_norm': 3.746802806854248, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.27it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]                                               {'loss': 1.7335, 'grad_norm': 3.6047861576080322, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'loss': 1.9843, 'grad_norm': 10.57335090637207, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]                                               {'train_runtime': 16.5423, 'train_samples_per_second': 34.155, 'train_steps_per_second': 2.418, 'train_loss': 2.1140208661556246, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.85it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.79it/s]                                              {'loss': 2.2662, 'grad_norm': 5.065427303314209, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.79it/s]  5%|▌         | 2/40 [00:00<00:13,  2.74it/s]                                              {'loss': 2.3452, 'grad_norm': 3.796444892883301, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.74it/s]  8%|▊         | 3/40 [00:01<00:13,  2.72it/s]                                              {'loss': 2.0916, 'grad_norm': 4.8780059814453125, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.72it/s] 10%|█         | 4/40 [00:01<00:13,  2.75it/s]                                              {'loss': 2.2938, 'grad_norm': 4.736372470855713, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.75it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.77it/s]                                              {'loss': 2.2684, 'grad_norm': 3.8451099395751953, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.77it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.78it/s]                                              {'loss': 2.433, 'grad_norm': 5.030477523803711, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.78it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.81it/s]                                              {'loss': 2.4411, 'grad_norm': 4.19405460357666, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.81it/s] 20%|██        | 8/40 [00:02<00:11,  2.78it/s]                                              {'loss': 2.1139, 'grad_norm': 43.763877868652344, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.78it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.75it/s]                                              {'loss': 2.2475, 'grad_norm': 4.064122676849365, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.75it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.76it/s]                                               {'loss': 2.1438, 'grad_norm': 4.426026344299316, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.76it/s] 28%|██▊       | 11/40 [00:03<00:10,  2.75it/s]                                               {'loss': 2.1648, 'grad_norm': 3.3434274196624756, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:10,  2.75it/s] 30%|███       | 12/40 [00:04<00:10,  2.74it/s]                                               {'loss': 2.2745, 'grad_norm': 4.085521221160889, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.74it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.80it/s]                                               {'loss': 2.2176, 'grad_norm': 5.066247940063477, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.80it/s] 35%|███▌      | 14/40 [00:04<00:08,  2.95it/s]                                               {'loss': 2.1685, 'grad_norm': 3.888842821121216, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:08,  2.95it/s] 38%|███▊      | 15/40 [00:05<00:08,  3.05it/s]                                               {'loss': 2.1062, 'grad_norm': 3.5213167667388916, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:08,  3.05it/s]                                               {'loss': 2.7989, 'grad_norm': 38.49793243408203, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.05it/s] 42%|████▎     | 17/40 [00:05<00:05,  3.88it/s]                                               {'loss': 1.9289, 'grad_norm': 4.189955711364746, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:05<00:05,  3.88it/s] 45%|████▌     | 18/40 [00:05<00:05,  3.87it/s]                                               {'loss': 2.1157, 'grad_norm': 4.670812606811523, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:05<00:05,  3.87it/s] 48%|████▊     | 19/40 [00:06<00:05,  3.64it/s]                                               {'loss': 2.1955, 'grad_norm': 3.2979671955108643, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:05,  3.64it/s] 50%|█████     | 20/40 [00:06<00:05,  3.48it/s]                                               {'loss': 2.1192, 'grad_norm': 4.491702556610107, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:06<00:05,  3.48it/s] 52%|█████▎    | 21/40 [00:06<00:05,  3.42it/s]                                               {'loss': 2.2224, 'grad_norm': 3.985133409500122, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:06<00:05,  3.42it/s] 55%|█████▌    | 22/40 [00:07<00:05,  3.22it/s]                                               {'loss': 2.2008, 'grad_norm': 3.9331490993499756, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:07<00:05,  3.22it/s] 57%|█████▊    | 23/40 [00:07<00:05,  3.04it/s]                                               {'loss': 1.9185, 'grad_norm': 3.1143975257873535, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:07<00:05,  3.04it/s] 60%|██████    | 24/40 [00:07<00:04,  3.82it/s]                                               {'loss': 1.974, 'grad_norm': 11.110573768615723, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:07<00:04,  3.82it/s] 62%|██████▎   | 25/40 [00:08<00:04,  3.29it/s]                                               {'loss': 2.1333, 'grad_norm': 4.390000820159912, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:08<00:04,  3.29it/s] 65%|██████▌   | 26/40 [00:08<00:04,  3.05it/s]                                               {'loss': 1.9879, 'grad_norm': 3.6635992527008057, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:08<00:04,  3.05it/s] 68%|██████▊   | 27/40 [00:08<00:04,  2.80it/s]                                               {'loss': 2.1448, 'grad_norm': 3.5144412517547607, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:08<00:04,  2.80it/s] 70%|███████   | 28/40 [00:09<00:04,  2.57it/s]                                               {'loss': 2.0019, 'grad_norm': 3.976530075073242, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:09<00:04,  2.57it/s] 72%|███████▎  | 29/40 [00:09<00:04,  2.47it/s]                                               {'loss': 2.3453, 'grad_norm': 3.403454065322876, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:09<00:04,  2.47it/s] 75%|███████▌  | 30/40 [00:10<00:04,  2.35it/s]                                               {'loss': 2.0842, 'grad_norm': 3.8722574710845947, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:10<00:04,  2.35it/s] 78%|███████▊  | 31/40 [00:10<00:03,  2.31it/s]                                               {'loss': 1.9388, 'grad_norm': 3.1270134449005127, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:10<00:03,  2.31it/s] 80%|████████  | 32/40 [00:10<00:02,  2.93it/s]                                               {'loss': 2.5108, 'grad_norm': 11.99495792388916, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:10<00:02,  2.93it/s] 82%|████████▎ | 33/40 [00:11<00:02,  2.59it/s]                                               {'loss': 2.053, 'grad_norm': 3.168776512145996, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:11<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:11<00:02,  2.46it/s]                                               {'loss': 2.0175, 'grad_norm': 3.3787147998809814, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:11<00:02,  2.46it/s] 88%|████████▊ | 35/40 [00:12<00:02,  2.38it/s]                                               {'loss': 2.0906, 'grad_norm': 4.0987396240234375, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:12<00:02,  2.38it/s] 90%|█████████ | 36/40 [00:12<00:01,  2.30it/s]                                               {'loss': 2.0437, 'grad_norm': 4.874056339263916, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:12<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.30it/s]                                               {'loss': 2.2087, 'grad_norm': 3.816927909851074, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:13<00:00,  2.27it/s]                                               {'loss': 2.1736, 'grad_norm': 3.609917163848877, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:13<00:00,  2.27it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.23it/s]                                               {'loss': 1.8595, 'grad_norm': 3.9220693111419678, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.23it/s]                                               {'loss': 1.68, 'grad_norm': 13.830684661865234, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.23it/s]                                               {'train_runtime': 14.281, 'train_samples_per_second': 39.563, 'train_steps_per_second': 2.801, 'train_loss': 2.158093881607056, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.23it/s]100%|██████████| 40/40 [00:14<00:00,  2.80it/s]
CLIENT:88
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:25,  1.53it/s]                                              {'loss': 2.1127, 'grad_norm': 4.257627010345459, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:25,  1.53it/s]  5%|▌         | 2/40 [00:01<00:27,  1.40it/s]                                              {'loss': 2.4118, 'grad_norm': 4.621457099914551, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:27,  1.40it/s]  8%|▊         | 3/40 [00:01<00:22,  1.68it/s]                                              {'loss': 2.2385, 'grad_norm': 3.8398916721343994, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.68it/s] 10%|█         | 4/40 [00:02<00:19,  1.82it/s]                                              {'loss': 2.5577, 'grad_norm': 4.106069087982178, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.82it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.95it/s]                                              {'loss': 2.1791, 'grad_norm': 3.6095120906829834, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.95it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.00it/s]                                              {'loss': 2.2152, 'grad_norm': 4.731841087341309, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.00it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s]                                              {'loss': 2.3181, 'grad_norm': 4.1211419105529785, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.05it/s] 20%|██        | 8/40 [00:04<00:14,  2.21it/s]                                              {'loss': 2.3759, 'grad_norm': 14.837966918945312, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.21it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.18it/s]                                              {'loss': 2.1511, 'grad_norm': 4.06903076171875, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.18it/s] 25%|██▌       | 10/40 [00:05<00:13,  2.17it/s]                                               {'loss': 2.3622, 'grad_norm': 3.913907051086426, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:13,  2.17it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.17it/s]                                               {'loss': 2.1216, 'grad_norm': 3.4823760986328125, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.17it/s] 30%|███       | 12/40 [00:05<00:13,  2.15it/s]                                               {'loss': 2.3107, 'grad_norm': 4.500248908996582, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:13,  2.15it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s]                                               {'loss': 2.1972, 'grad_norm': 4.166897773742676, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s] 35%|███▌      | 14/40 [00:06<00:12,  2.15it/s]                                               {'loss': 2.05, 'grad_norm': 4.003905296325684, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:12,  2.15it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.16it/s]                                               {'loss': 2.0966, 'grad_norm': 3.689924955368042, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.16it/s]                                               {'loss': 2.0496, 'grad_norm': 16.628278732299805, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:11,  2.16it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s]                                               {'loss': 2.0123, 'grad_norm': 4.752476692199707, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.67it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.57it/s]                                               {'loss': 2.1946, 'grad_norm': 4.052000045776367, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.57it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.50it/s]                                               {'loss': 2.119, 'grad_norm': 3.730069398880005, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.50it/s] 50%|█████     | 20/40 [00:09<00:08,  2.39it/s]                                               {'loss': 2.0718, 'grad_norm': 4.992495059967041, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.35it/s]                                               {'loss': 2.0893, 'grad_norm': 3.471644878387451, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.35it/s] 55%|█████▌    | 22/40 [00:10<00:07,  2.28it/s]                                               {'loss': 2.1431, 'grad_norm': 2.922232151031494, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.25it/s]                                               {'loss': 2.3109, 'grad_norm': 4.752186298370361, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.25it/s] 60%|██████    | 24/40 [00:10<00:05,  2.83it/s]                                               {'loss': 1.9458, 'grad_norm': 15.469141006469727, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.64it/s]                                               {'loss': 2.2252, 'grad_norm': 3.330148220062256, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s]                                               {'loss': 2.1094, 'grad_norm': 3.310908317565918, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.50it/s]                                               {'loss': 2.1814, 'grad_norm': 2.957827568054199, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.50it/s] 70%|███████   | 28/40 [00:12<00:04,  2.44it/s]                                               {'loss': 2.045, 'grad_norm': 3.8944053649902344, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:04,  2.44it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.38it/s]                                               {'loss': 2.0152, 'grad_norm': 3.4569265842437744, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.38it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.41it/s]                                               {'loss': 1.9501, 'grad_norm': 4.223360538482666, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.41it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.42it/s]                                               {'loss': 1.9118, 'grad_norm': 3.302816867828369, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.42it/s]                                               {'loss': 2.574, 'grad_norm': 16.676908493041992, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.42it/s] 82%|████████▎ | 33/40 [00:14<00:02,  3.13it/s]                                               {'loss': 1.9193, 'grad_norm': 3.381035566329956, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  3.13it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.98it/s]                                               {'loss': 1.8346, 'grad_norm': 3.673907518386841, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.98it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.88it/s]                                               {'loss': 2.0891, 'grad_norm': 3.9433469772338867, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.88it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.81it/s]                                               {'loss': 2.1079, 'grad_norm': 3.845790147781372, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.81it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.72it/s]                                               {'loss': 2.1295, 'grad_norm': 3.8377668857574463, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.72it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.58it/s]                                               {'loss': 1.9939, 'grad_norm': 3.0801894664764404, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.58it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.41it/s]                                               {'loss': 2.3797, 'grad_norm': 3.927544355392456, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.41it/s]100%|██████████| 40/40 [00:16<00:00,  3.05it/s]                                               {'loss': 2.1648, 'grad_norm': 12.361801147460938, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.05it/s]                                               {'train_runtime': 16.8226, 'train_samples_per_second': 33.586, 'train_steps_per_second': 2.378, 'train_loss': 2.1566451281309127, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.05it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:48
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.27it/s]                                              {'loss': 2.3633, 'grad_norm': 3.549194574356079, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.27it/s]  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]                                              {'loss': 2.0569, 'grad_norm': 4.191679954528809, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.15it/s]  8%|▊         | 3/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.4095, 'grad_norm': 4.618016242980957, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.19it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.528, 'grad_norm': 3.55861759185791, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s]                                              {'loss': 2.4038, 'grad_norm': 4.1503448486328125, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.17it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.105, 'grad_norm': 3.645617723464966, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s]                                              {'loss': 2.2931, 'grad_norm': 3.6965911388397217, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s] 20%|██        | 8/40 [00:03<00:11,  2.82it/s]                                              {'loss': 3.0782, 'grad_norm': 24.10946273803711, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.82it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.62it/s]                                              {'loss': 1.968, 'grad_norm': 3.779989242553711, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.62it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.1718, 'grad_norm': 3.234830141067505, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.4535, 'grad_norm': 4.2337422370910645, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s] 30%|███       | 12/40 [00:05<00:12,  2.33it/s]                                               {'loss': 2.2125, 'grad_norm': 3.748244524002075, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.33it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.30it/s]                                               {'loss': 2.282, 'grad_norm': 4.052395343780518, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.30it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.29it/s]                                               {'loss': 2.188, 'grad_norm': 4.328033447265625, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.29it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s]                                               {'loss': 2.2236, 'grad_norm': 3.648056983947754, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s] 40%|████      | 16/40 [00:06<00:08,  2.83it/s]                                               {'loss': 2.0037, 'grad_norm': 10.878186225891113, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.83it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.63it/s]                                               {'loss': 2.1635, 'grad_norm': 3.55574631690979, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.63it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s]                                               {'loss': 2.1084, 'grad_norm': 3.4439966678619385, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.2353, 'grad_norm': 4.291271209716797, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.2098, 'grad_norm': 3.8099567890167236, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.48it/s]                                               {'loss': 1.9876, 'grad_norm': 3.5196523666381836, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.48it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.55it/s]                                               {'loss': 2.1047, 'grad_norm': 2.9528024196624756, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.55it/s] 57%|█████▊    | 23/40 [00:09<00:06,  2.62it/s]                                               {'loss': 2.2107, 'grad_norm': 3.202362537384033, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:06,  2.62it/s] 60%|██████    | 24/40 [00:09<00:04,  3.34it/s]                                               {'loss': 1.5252, 'grad_norm': 7.814415454864502, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:04,  3.34it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.13it/s]                                               {'loss': 2.1285, 'grad_norm': 4.5628814697265625, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:04,  3.13it/s] 65%|██████▌   | 26/40 [00:10<00:04,  3.00it/s]                                               {'loss': 1.9549, 'grad_norm': 3.494030475616455, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  3.00it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.94it/s]                                               {'loss': 2.0727, 'grad_norm': 3.5779025554656982, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.94it/s] 70%|███████   | 28/40 [00:11<00:04,  2.86it/s]                                               {'loss': 2.2545, 'grad_norm': 3.7563884258270264, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.86it/s] 72%|███████▎  | 29/40 [00:11<00:03,  2.81it/s]                                               {'loss': 2.049, 'grad_norm': 3.250560998916626, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:03,  2.81it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.78it/s]                                               {'loss': 2.2154, 'grad_norm': 4.01140022277832, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.78it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.74it/s]                                               {'loss': 2.2392, 'grad_norm': 4.507942199707031, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.74it/s]                                               {'loss': 2.2133, 'grad_norm': 13.105595588684082, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.74it/s] 82%|████████▎ | 33/40 [00:12<00:02,  3.25it/s]                                               {'loss': 2.1949, 'grad_norm': 3.680217981338501, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  3.25it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.86it/s]                                               {'loss': 2.1508, 'grad_norm': 3.2943081855773926, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.86it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.66it/s]                                               {'loss': 1.8805, 'grad_norm': 2.996096134185791, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.66it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.65it/s]                                               {'loss': 2.0188, 'grad_norm': 2.7146012783050537, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.65it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.58it/s]                                               {'loss': 1.9342, 'grad_norm': 4.063642978668213, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.58it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.43it/s]                                               {'loss': 2.4326, 'grad_norm': 3.4273788928985596, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.43it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.37it/s]                                               {'loss': 2.1409, 'grad_norm': 3.70855975151062, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.37it/s]100%|██████████| 40/40 [00:15<00:00,  3.00it/s]                                               {'loss': 1.9465, 'grad_norm': 35.340457916259766, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.00it/s]                                               {'train_runtime': 15.5575, 'train_samples_per_second': 36.317, 'train_steps_per_second': 2.571, 'train_loss': 2.177813556790352, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.00it/s]100%|██████████| 40/40 [00:15<00:00,  2.57it/s]
CLIENT:71
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.3529, 'grad_norm': 4.109804630279541, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.1971, 'grad_norm': 4.19385290145874, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:17,  2.17it/s]                                              {'loss': 2.3277, 'grad_norm': 4.023784637451172, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.17it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 2.1617, 'grad_norm': 3.6635916233062744, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s]                                              {'loss': 2.2147, 'grad_norm': 4.185944080352783, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.18, 'grad_norm': 3.315267562866211, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s]                                              {'loss': 2.1389, 'grad_norm': 3.2673795223236084, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s] 20%|██        | 8/40 [00:03<00:11,  2.90it/s]                                              {'loss': 1.4266, 'grad_norm': 8.145723342895508, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.90it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s]                                              {'loss': 2.0499, 'grad_norm': 3.2657949924468994, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.69it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.59it/s]                                               {'loss': 2.0599, 'grad_norm': 3.7949342727661133, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.59it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s]                                               {'loss': 2.2283, 'grad_norm': 4.163451194763184, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.45it/s] 30%|███       | 12/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.091, 'grad_norm': 3.853407859802246, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.36it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.2829, 'grad_norm': 3.949704885482788, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s]                                               {'loss': 2.1285, 'grad_norm': 3.952566623687744, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s]                                               {'loss': 2.1233, 'grad_norm': 5.897507667541504, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s] 40%|████      | 16/40 [00:06<00:08,  2.83it/s]                                               {'loss': 2.3959, 'grad_norm': 12.658114433288574, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.83it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s]                                               {'loss': 2.0548, 'grad_norm': 4.058492660522461, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.2211, 'grad_norm': 2.91648006439209, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.40it/s]                                               {'loss': 2.0697, 'grad_norm': 2.934431791305542, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.40it/s] 50%|█████     | 20/40 [00:08<00:08,  2.36it/s]                                               {'loss': 2.3025, 'grad_norm': 4.849557876586914, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.36it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.31it/s]                                               {'loss': 2.0641, 'grad_norm': 3.4268949031829834, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.31it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.0709, 'grad_norm': 4.324773788452148, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.0921, 'grad_norm': 4.177484512329102, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.87it/s]                                               {'loss': 2.3056, 'grad_norm': 11.563368797302246, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 1.8152, 'grad_norm': 2.6968564987182617, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 2.1514, 'grad_norm': 3.5344345569610596, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.46it/s]                                               {'loss': 2.3409, 'grad_norm': 3.965707302093506, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.46it/s] 70%|███████   | 28/40 [00:11<00:05,  2.36it/s]                                               {'loss': 1.9474, 'grad_norm': 3.7010929584503174, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.36it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s]                                               {'loss': 2.1016, 'grad_norm': 3.73309588432312, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 1.9465, 'grad_norm': 3.4431421756744385, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.25it/s]                                               {'loss': 2.0397, 'grad_norm': 3.4544899463653564, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.25it/s] 80%|████████  | 32/40 [00:13<00:02,  2.89it/s]                                               {'loss': 2.1322, 'grad_norm': 14.949440002441406, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.89it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s]                                               {'loss': 2.3507, 'grad_norm': 4.062737464904785, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s]                                               {'loss': 2.1036, 'grad_norm': 3.541860818862915, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.43it/s]                                               {'loss': 2.0034, 'grad_norm': 3.473586320877075, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.34it/s]                                               {'loss': 2.1019, 'grad_norm': 3.3976528644561768, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.34it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.32it/s]                                               {'loss': 2.079, 'grad_norm': 3.588916540145874, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.32it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s]                                               {'loss': 2.063, 'grad_norm': 3.2785959243774414, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.26it/s]                                               {'loss': 1.7589, 'grad_norm': 4.87272834777832, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.26it/s]100%|██████████| 40/40 [00:16<00:00,  2.83it/s]                                               {'loss': 1.9737, 'grad_norm': 14.041629791259766, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.83it/s]                                               {'train_runtime': 16.5064, 'train_samples_per_second': 34.229, 'train_steps_per_second': 2.423, 'train_loss': 2.1112303882837296, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.83it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
CLIENT:67
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:26,  1.49it/s]                                              {'loss': 2.1905, 'grad_norm': 3.0749990940093994, 'learning_rate': 0.00015, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:26,  1.49it/s]  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]                                              {'loss': 2.0199, 'grad_norm': 4.565279006958008, 'learning_rate': 0.00014624999999999998, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.45it/s]  8%|▊         | 3/40 [00:01<00:21,  1.73it/s]                                              {'loss': 2.0393, 'grad_norm': 3.0836105346679688, 'learning_rate': 0.0001425, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:21,  1.73it/s] 10%|█         | 4/40 [00:02<00:18,  1.91it/s]                                              {'loss': 2.4493, 'grad_norm': 3.803678512573242, 'learning_rate': 0.00013874999999999998, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:18,  1.91it/s] 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s]                                              {'loss': 2.5366, 'grad_norm': 5.713630199432373, 'learning_rate': 0.000135, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  1.98it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.06it/s]                                              {'loss': 2.1079, 'grad_norm': 3.5594024658203125, 'learning_rate': 0.00013125, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.06it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.07it/s]                                              {'loss': 2.1156, 'grad_norm': 4.551154613494873, 'learning_rate': 0.00012749999999999998, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.07it/s] 20%|██        | 8/40 [00:04<00:14,  2.23it/s]                                              {'loss': 2.9138, 'grad_norm': 18.43478012084961, 'learning_rate': 0.00012374999999999997, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.23it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.21it/s]                                              {'loss': 2.1903, 'grad_norm': 3.639694929122925, 'learning_rate': 0.00011999999999999999, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.21it/s] 25%|██▌       | 10/40 [00:04<00:13,  2.20it/s]                                               {'loss': 1.9811, 'grad_norm': 3.381345748901367, 'learning_rate': 0.00011624999999999999, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:13,  2.20it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.20it/s]                                               {'loss': 2.2563, 'grad_norm': 3.89882755279541, 'learning_rate': 0.0001125, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.20it/s] 30%|███       | 12/40 [00:05<00:12,  2.18it/s]                                               {'loss': 2.0498, 'grad_norm': 3.0463030338287354, 'learning_rate': 0.00010874999999999999, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.18it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.22it/s]                                               {'loss': 2.2159, 'grad_norm': 3.944802761077881, 'learning_rate': 0.00010499999999999999, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.22it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.0045, 'grad_norm': 3.082700490951538, 'learning_rate': 0.00010125, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.20it/s]                                               {'loss': 2.1066, 'grad_norm': 4.451554775238037, 'learning_rate': 9.75e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.20it/s] 40%|████      | 16/40 [00:07<00:08,  2.87it/s]                                               {'loss': 2.4208, 'grad_norm': 13.609350204467773, 'learning_rate': 9.374999999999999e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.87it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.71it/s]                                               {'loss': 2.1753, 'grad_norm': 5.895662784576416, 'learning_rate': 8.999999999999999e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.71it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.48it/s]                                               {'loss': 2.1688, 'grad_norm': 3.278761863708496, 'learning_rate': 8.624999999999998e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.48it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.2706, 'grad_norm': 3.4726784229278564, 'learning_rate': 8.25e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.39it/s] 50%|█████     | 20/40 [00:09<00:08,  2.30it/s]                                               {'loss': 1.926, 'grad_norm': 3.4263272285461426, 'learning_rate': 7.874999999999999e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.24it/s]                                               {'loss': 1.8516, 'grad_norm': 3.457979202270508, 'learning_rate': 7.5e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.24it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.23it/s]                                               {'loss': 2.2535, 'grad_norm': 3.670668363571167, 'learning_rate': 7.125e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.20it/s]                                               {'loss': 1.9407, 'grad_norm': 4.272357940673828, 'learning_rate': 6.75e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.20it/s] 60%|██████    | 24/40 [00:10<00:05,  2.80it/s]                                               {'loss': 1.8385, 'grad_norm': 11.214956283569336, 'learning_rate': 6.374999999999999e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.80it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.64it/s]                                               {'loss': 2.0667, 'grad_norm': 3.7192070484161377, 'learning_rate': 5.9999999999999995e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s]                                               {'loss': 1.9848, 'grad_norm': 3.8890833854675293, 'learning_rate': 5.625e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.49it/s]                                               {'loss': 2.0085, 'grad_norm': 3.5426509380340576, 'learning_rate': 5.2499999999999995e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.49it/s] 70%|███████   | 28/40 [00:12<00:04,  2.40it/s]                                               {'loss': 2.3712, 'grad_norm': 4.2184343338012695, 'learning_rate': 4.875e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:04,  2.40it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s]                                               {'loss': 1.8274, 'grad_norm': 3.3822176456451416, 'learning_rate': 4.4999999999999996e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.36it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s]                                               {'loss': 2.0061, 'grad_norm': 3.1220755577087402, 'learning_rate': 4.125e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.32it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s]                                               {'loss': 1.9323, 'grad_norm': 3.968451499938965, 'learning_rate': 3.75e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s] 80%|████████  | 32/40 [00:13<00:02,  2.85it/s]                                               {'loss': 2.511, 'grad_norm': 14.126748085021973, 'learning_rate': 3.375e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.85it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.71it/s]                                               {'loss': 2.1351, 'grad_norm': 4.249069690704346, 'learning_rate': 2.9999999999999997e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.71it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.55it/s]                                               {'loss': 1.7646, 'grad_norm': 3.3146886825561523, 'learning_rate': 2.6249999999999998e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.48it/s]                                               {'loss': 1.9978, 'grad_norm': 2.2706196308135986, 'learning_rate': 2.2499999999999998e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.48it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.58it/s]                                               {'loss': 2.2351, 'grad_norm': 3.5422956943511963, 'learning_rate': 1.875e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.58it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.61it/s]                                               {'loss': 1.91, 'grad_norm': 3.5358824729919434, 'learning_rate': 1.4999999999999999e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.61it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.62it/s]                                               {'loss': 2.1377, 'grad_norm': 3.5600943565368652, 'learning_rate': 1.1249999999999999e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.62it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.65it/s]                                               {'loss': 1.9389, 'grad_norm': 5.136690139770508, 'learning_rate': 7.499999999999999e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.65it/s]100%|██████████| 40/40 [00:16<00:00,  3.38it/s]                                               {'loss': 3.2024, 'grad_norm': 15.784106254577637, 'learning_rate': 3.7499999999999997e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.38it/s]                                               {'train_runtime': 16.8818, 'train_samples_per_second': 33.468, 'train_steps_per_second': 2.369, 'train_loss': 2.151324611902237, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  3.38it/s]100%|██████████| 40/40 [00:16<00:00,  2.37it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:43, 10.68it/s]  1%|          | 4/471 [00:00<01:15,  6.22it/s]  1%|          | 5/471 [00:00<01:26,  5.40it/s]  1%|▏         | 6/471 [00:01<01:27,  5.29it/s]  1%|▏         | 7/471 [00:01<01:35,  4.87it/s]  2%|▏         | 8/471 [00:01<01:34,  4.90it/s]  2%|▏         | 9/471 [00:01<01:36,  4.78it/s]  2%|▏         | 10/471 [00:01<01:33,  4.91it/s]  2%|▏         | 11/471 [00:02<01:37,  4.72it/s]  3%|▎         | 12/471 [00:02<01:38,  4.68it/s]  3%|▎         | 13/471 [00:02<01:36,  4.73it/s]  3%|▎         | 14/471 [00:02<01:37,  4.67it/s]  3%|▎         | 15/471 [00:02<01:34,  4.85it/s]  3%|▎         | 16/471 [00:03<01:37,  4.65it/s]  4%|▎         | 17/471 [00:03<01:37,  4.66it/s]  4%|▍         | 18/471 [00:03<01:38,  4.60it/s]  4%|▍         | 19/471 [00:03<01:35,  4.71it/s]  4%|▍         | 20/471 [00:04<01:36,  4.66it/s]  4%|▍         | 21/471 [00:04<01:33,  4.79it/s]  5%|▍         | 22/471 [00:04<01:38,  4.56it/s]  5%|▍         | 23/471 [00:04<01:35,  4.70it/s]  5%|▌         | 24/471 [00:04<01:38,  4.54it/s]  5%|▌         | 25/471 [00:05<01:33,  4.75it/s]  6%|▌         | 26/471 [00:05<01:35,  4.67it/s]  6%|▌         | 27/471 [00:05<01:34,  4.71it/s]  6%|▌         | 28/471 [00:05<01:38,  4.52it/s]  6%|▌         | 29/471 [00:05<01:35,  4.63it/s]  6%|▋         | 30/471 [00:06<01:35,  4.61it/s]  7%|▋         | 31/471 [00:06<01:32,  4.73it/s]  7%|▋         | 32/471 [00:06<01:34,  4.63it/s]  7%|▋         | 33/471 [00:06<01:35,  4.57it/s]  7%|▋         | 34/471 [00:07<01:34,  4.65it/s]  7%|▋         | 35/471 [00:07<01:36,  4.54it/s]  8%|▊         | 36/471 [00:07<01:30,  4.82it/s]  8%|▊         | 37/471 [00:07<01:31,  4.73it/s]  8%|▊         | 38/471 [00:07<01:29,  4.83it/s]  8%|▊         | 39/471 [00:08<01:34,  4.55it/s]  8%|▊         | 40/471 [00:08<01:30,  4.77it/s]  9%|▊         | 41/471 [00:08<01:35,  4.52it/s]  9%|▉         | 42/471 [00:08<01:28,  4.85it/s]  9%|▉         | 43/471 [00:09<01:34,  4.55it/s]  9%|▉         | 44/471 [00:09<01:28,  4.81it/s] 10%|▉         | 45/471 [00:09<01:35,  4.48it/s] 10%|▉         | 46/471 [00:09<01:30,  4.70it/s] 10%|▉         | 47/471 [00:09<01:31,  4.61it/s] 10%|█         | 48/471 [00:10<01:29,  4.71it/s] 10%|█         | 49/471 [00:10<01:31,  4.61it/s] 11%|█         | 50/471 [00:10<01:33,  4.51it/s] 11%|█         | 51/471 [00:10<01:27,  4.80it/s] 11%|█         | 52/471 [00:10<01:28,  4.71it/s] 11%|█▏        | 53/471 [00:11<01:25,  4.89it/s] 11%|█▏        | 54/471 [00:11<01:29,  4.67it/s] 12%|█▏        | 55/471 [00:11<01:29,  4.66it/s] 12%|█▏        | 56/471 [00:11<01:30,  4.60it/s] 12%|█▏        | 57/471 [00:11<01:27,  4.72it/s] 12%|█▏        | 58/471 [00:12<01:29,  4.64it/s] 13%|█▎        | 59/471 [00:12<01:25,  4.84it/s] 13%|█▎        | 60/471 [00:12<01:30,  4.56it/s] 13%|█▎        | 61/471 [00:12<01:26,  4.75it/s] 13%|█▎        | 62/471 [00:13<01:30,  4.53it/s] 13%|█▎        | 63/471 [00:13<01:26,  4.73it/s] 14%|█▎        | 64/471 [00:13<01:26,  4.70it/s] 14%|█▍        | 65/471 [00:13<01:27,  4.65it/s] 14%|█▍        | 66/471 [00:13<01:28,  4.58it/s] 14%|█▍        | 67/471 [00:14<01:27,  4.63it/s] 14%|█▍        | 68/471 [00:14<01:26,  4.66it/s] 15%|█▍        | 69/471 [00:14<01:24,  4.76it/s] 15%|█▍        | 70/471 [00:14<01:24,  4.75it/s] 15%|█▌        | 71/471 [00:14<01:27,  4.60it/s] 15%|█▌        | 72/471 [00:15<01:23,  4.80it/s] 15%|█▌        | 73/471 [00:15<01:26,  4.62it/s] 16%|█▌        | 74/471 [00:15<01:20,  4.95it/s] 16%|█▌        | 75/471 [00:15<01:23,  4.73it/s] 16%|█▌        | 76/471 [00:15<01:19,  4.97it/s] 16%|█▋        | 77/471 [00:16<01:26,  4.56it/s] 17%|█▋        | 78/471 [00:16<01:22,  4.75it/s] 17%|█▋        | 79/471 [00:16<01:24,  4.65it/s] 17%|█▋        | 80/471 [00:16<01:23,  4.71it/s] 17%|█▋        | 81/471 [00:17<01:20,  4.82it/s] 17%|█▋        | 82/471 [00:17<01:22,  4.70it/s] 18%|█▊        | 83/471 [00:17<01:23,  4.63it/s] 18%|█▊        | 84/471 [00:17<01:25,  4.55it/s] 18%|█▊        | 85/471 [00:17<01:21,  4.73it/s] 18%|█▊        | 86/471 [00:18<01:22,  4.66it/s] 18%|█▊        | 87/471 [00:18<01:19,  4.81it/s] 19%|█▊        | 88/471 [00:18<01:24,  4.54it/s] 19%|█▉        | 89/471 [00:18<01:17,  4.91it/s] 19%|█▉        | 90/471 [00:19<01:22,  4.61it/s] 19%|█▉        | 91/471 [00:19<01:15,  5.05it/s] 20%|█▉        | 92/471 [00:19<01:19,  4.74it/s] 20%|█▉        | 93/471 [00:19<01:19,  4.78it/s] 20%|█▉        | 94/471 [00:19<01:20,  4.67it/s] 20%|██        | 95/471 [00:20<01:20,  4.67it/s] 20%|██        | 96/471 [00:20<01:17,  4.84it/s] 21%|██        | 97/471 [00:20<01:18,  4.74it/s] 21%|██        | 98/471 [00:20<01:16,  4.86it/s] 21%|██        | 99/471 [00:20<01:21,  4.58it/s] 21%|██        | 100/471 [00:21<01:15,  4.91it/s] 21%|██▏       | 101/471 [00:21<01:20,  4.61it/s] 22%|██▏       | 102/471 [00:21<01:11,  5.13it/s] 22%|██▏       | 103/471 [00:21<01:18,  4.67it/s] 22%|██▏       | 104/471 [00:21<01:16,  4.80it/s] 22%|██▏       | 105/471 [00:22<01:18,  4.64it/s] 23%|██▎       | 106/471 [00:22<01:18,  4.65it/s] 23%|██▎       | 107/471 [00:22<01:16,  4.78it/s] 23%|██▎       | 108/471 [00:22<01:18,  4.65it/s] 23%|██▎       | 109/471 [00:22<01:15,  4.79it/s] 23%|██▎       | 110/471 [00:23<01:19,  4.54it/s] 24%|██▎       | 111/471 [00:23<01:14,  4.82it/s] 24%|██▍       | 112/471 [00:23<01:18,  4.55it/s] 24%|██▍       | 113/471 [00:23<01:10,  5.06it/s] 24%|██▍       | 114/471 [00:24<01:14,  4.77it/s] 24%|██▍       | 115/471 [00:24<01:11,  4.98it/s] 25%|██▍       | 116/471 [00:24<01:17,  4.58it/s] 25%|██▍       | 117/471 [00:24<01:15,  4.70it/s] 25%|██▌       | 118/471 [00:24<01:15,  4.69it/s] 25%|██▌       | 119/471 [00:25<01:14,  4.74it/s] 25%|██▌       | 120/471 [00:25<01:12,  4.87it/s] 26%|██▌       | 121/471 [00:25<01:16,  4.59it/s] 26%|██▌       | 122/471 [00:25<01:11,  4.88it/s] 26%|██▌       | 123/471 [00:25<01:13,  4.74it/s] 26%|██▋       | 124/471 [00:26<01:10,  4.96it/s] 27%|██▋       | 125/471 [00:26<01:12,  4.77it/s] 27%|██▋       | 126/471 [00:26<01:11,  4.83it/s] 27%|██▋       | 127/471 [00:26<01:14,  4.60it/s] 27%|██▋       | 128/471 [00:26<01:12,  4.73it/s] 27%|██▋       | 129/471 [00:27<01:12,  4.74it/s] 28%|██▊       | 130/471 [00:27<01:11,  4.74it/s] 28%|██▊       | 131/471 [00:27<01:12,  4.72it/s] 28%|██▊       | 132/471 [00:27<01:13,  4.64it/s] 28%|██▊       | 133/471 [00:28<01:11,  4.74it/s] 28%|██▊       | 134/471 [00:28<01:12,  4.66it/s] 29%|██▊       | 135/471 [00:28<01:08,  4.90it/s] 29%|██▉       | 136/471 [00:28<01:11,  4.67it/s] 29%|██▉       | 137/471 [00:28<01:09,  4.81it/s] 29%|██▉       | 138/471 [00:29<01:10,  4.70it/s] 30%|██▉       | 139/471 [00:29<01:10,  4.70it/s] 30%|██▉       | 140/471 [00:29<01:10,  4.71it/s] 30%|██▉       | 141/471 [00:29<01:09,  4.75it/s] 30%|███       | 142/471 [00:29<01:10,  4.65it/s] 30%|███       | 143/471 [00:30<01:12,  4.53it/s] 31%|███       | 144/471 [00:30<01:10,  4.61it/s] 31%|███       | 145/471 [00:30<01:10,  4.61it/s] 31%|███       | 146/471 [00:30<01:08,  4.74it/s] 31%|███       | 147/471 [00:31<01:09,  4.64it/s] 31%|███▏      | 148/471 [00:31<01:08,  4.70it/s] 32%|███▏      | 149/471 [00:31<01:07,  4.78it/s] 32%|███▏      | 150/471 [00:31<01:08,  4.69it/s] 32%|███▏      | 151/471 [00:31<01:04,  4.97it/s] 32%|███▏      | 152/471 [00:32<01:04,  4.92it/s] 32%|███▏      | 153/471 [00:32<01:04,  4.93it/s] 33%|███▎      | 154/471 [00:32<01:07,  4.70it/s] 33%|███▎      | 155/471 [00:32<01:06,  4.72it/s] 33%|███▎      | 156/471 [00:32<01:06,  4.70it/s] 33%|███▎      | 157/471 [00:33<01:05,  4.78it/s] 34%|███▎      | 158/471 [00:33<01:05,  4.77it/s] 34%|███▍      | 159/471 [00:33<01:06,  4.72it/s] 34%|███▍      | 160/471 [00:33<01:06,  4.67it/s] 34%|███▍      | 161/471 [00:33<01:06,  4.64it/s] 34%|███▍      | 162/471 [00:34<01:05,  4.72it/s] 35%|███▍      | 163/471 [00:34<01:04,  4.74it/s] 35%|███▍      | 164/471 [00:34<01:04,  4.72it/s] 35%|███▌      | 165/471 [00:34<01:07,  4.56it/s] 35%|███▌      | 166/471 [00:35<01:05,  4.69it/s] 35%|███▌      | 167/471 [00:35<01:05,  4.62it/s] 36%|███▌      | 168/471 [00:35<01:03,  4.79it/s] 36%|███▌      | 169/471 [00:35<01:05,  4.64it/s] 36%|███▌      | 170/471 [00:35<01:04,  4.70it/s] 36%|███▋      | 171/471 [00:36<01:05,  4.57it/s] 37%|███▋      | 172/471 [00:36<01:04,  4.62it/s] 37%|███▋      | 173/471 [00:36<01:05,  4.56it/s] 37%|███▋      | 174/471 [00:36<01:03,  4.68it/s] 37%|███▋      | 175/471 [00:37<01:04,  4.58it/s] 37%|███▋      | 176/471 [00:37<01:04,  4.57it/s] 38%|███▊      | 177/471 [00:37<01:02,  4.67it/s] 38%|███▊      | 178/471 [00:37<01:03,  4.62it/s] 38%|███▊      | 179/471 [00:37<01:00,  4.82it/s] 38%|███▊      | 180/471 [00:38<01:02,  4.63it/s] 38%|███▊      | 181/471 [00:38<01:02,  4.65it/s] 39%|███▊      | 182/471 [00:38<01:02,  4.60it/s] 39%|███▉      | 183/471 [00:38<01:01,  4.72it/s] 39%|███▉      | 184/471 [00:38<01:01,  4.66it/s] 39%|███▉      | 185/471 [00:39<00:59,  4.84it/s] 39%|███▉      | 186/471 [00:39<01:02,  4.57it/s] 40%|███▉      | 187/471 [00:39<01:00,  4.73it/s] 40%|███▉      | 188/471 [00:39<01:02,  4.53it/s] 40%|████      | 189/471 [00:39<00:59,  4.75it/s] 40%|████      | 190/471 [00:40<00:59,  4.71it/s] 41%|████      | 191/471 [00:40<00:55,  5.04it/s] 41%|████      | 192/471 [00:40<00:53,  5.21it/s] 41%|████      | 193/471 [00:40<00:51,  5.43it/s] 41%|████      | 194/471 [00:40<00:48,  5.71it/s] 41%|████▏     | 195/471 [00:41<00:49,  5.52it/s] 42%|████▏     | 196/471 [00:41<00:45,  6.01it/s] 42%|████▏     | 197/471 [00:41<00:48,  5.63it/s] 42%|████▏     | 198/471 [00:41<00:44,  6.14it/s] 42%|████▏     | 199/471 [00:41<00:48,  5.64it/s] 42%|████▏     | 200/471 [00:41<00:45,  5.98it/s] 43%|████▎     | 201/471 [00:42<00:46,  5.81it/s] 43%|████▎     | 202/471 [00:42<00:46,  5.80it/s] 43%|████▎     | 203/471 [00:42<00:45,  5.93it/s] 43%|████▎     | 204/471 [00:42<00:46,  5.72it/s] 44%|████▎     | 205/471 [00:42<00:44,  6.01it/s] 44%|████▎     | 206/471 [00:42<00:46,  5.71it/s] 44%|████▍     | 207/471 [00:43<00:42,  6.25it/s] 44%|████▍     | 208/471 [00:43<00:45,  5.74it/s] 44%|████▍     | 209/471 [00:43<00:42,  6.20it/s] 45%|████▍     | 210/471 [00:43<00:45,  5.74it/s] 45%|████▍     | 211/471 [00:43<00:43,  5.99it/s] 45%|████▌     | 212/471 [00:43<00:44,  5.81it/s] 45%|████▌     | 213/471 [00:44<00:44,  5.86it/s] 45%|████▌     | 214/471 [00:44<00:43,  5.86it/s] 46%|████▌     | 215/471 [00:44<00:43,  5.82it/s] 46%|████▌     | 216/471 [00:44<00:42,  6.03it/s] 46%|████▌     | 217/471 [00:44<00:44,  5.75it/s] 46%|████▋     | 218/471 [00:44<00:40,  6.18it/s] 46%|████▋     | 219/471 [00:45<00:44,  5.72it/s] 47%|████▋     | 220/471 [00:45<00:40,  6.23it/s] 47%|████▋     | 221/471 [00:45<00:45,  5.52it/s] 47%|████▋     | 222/471 [00:45<00:45,  5.52it/s] 47%|████▋     | 223/471 [00:45<00:50,  4.91it/s] 48%|████▊     | 224/471 [00:46<00:49,  4.98it/s] 48%|████▊     | 225/471 [00:46<00:51,  4.82it/s] 48%|████▊     | 226/471 [00:46<00:50,  4.87it/s] 48%|████▊     | 227/471 [00:46<00:49,  4.89it/s] 48%|████▊     | 228/471 [00:46<00:51,  4.74it/s] 49%|████▊     | 229/471 [00:47<00:50,  4.75it/s] 49%|████▉     | 230/471 [00:47<00:52,  4.61it/s] 49%|████▉     | 231/471 [00:47<00:50,  4.78it/s] 49%|████▉     | 232/471 [00:47<00:51,  4.62it/s] 49%|████▉     | 233/471 [00:48<00:49,  4.80it/s] 50%|████▉     | 234/471 [00:48<00:53,  4.46it/s] 50%|████▉     | 235/471 [00:48<00:49,  4.77it/s] 50%|█████     | 236/471 [00:48<00:51,  4.52it/s] 50%|█████     | 237/471 [00:48<00:46,  5.01it/s] 51%|█████     | 238/471 [00:49<00:50,  4.64it/s] 51%|█████     | 239/471 [00:49<00:48,  4.74it/s] 51%|█████     | 240/471 [00:49<00:49,  4.63it/s] 51%|█████     | 241/471 [00:49<00:49,  4.65it/s] 51%|█████▏    | 242/471 [00:49<00:48,  4.74it/s] 52%|█████▏    | 243/471 [00:50<00:48,  4.69it/s] 52%|█████▏    | 244/471 [00:50<00:47,  4.75it/s] 52%|█████▏    | 245/471 [00:50<00:50,  4.51it/s] 52%|█████▏    | 246/471 [00:50<00:46,  4.81it/s] 52%|█████▏    | 247/471 [00:51<00:48,  4.62it/s] 53%|█████▎    | 248/471 [00:51<00:43,  5.09it/s] 53%|█████▎    | 249/471 [00:51<00:48,  4.62it/s] 53%|█████▎    | 250/471 [00:51<00:45,  4.86it/s] 53%|█████▎    | 251/471 [00:51<00:48,  4.53it/s] 54%|█████▎    | 252/471 [00:52<00:46,  4.75it/s] 54%|█████▎    | 253/471 [00:52<00:46,  4.68it/s] 54%|█████▍    | 254/471 [00:52<00:46,  4.66it/s] 54%|█████▍    | 255/471 [00:52<00:46,  4.60it/s] 54%|█████▍    | 256/471 [00:52<00:47,  4.55it/s] 55%|█████▍    | 257/471 [00:53<00:46,  4.65it/s] 55%|█████▍    | 258/471 [00:53<00:46,  4.56it/s] 55%|█████▍    | 259/471 [00:53<00:41,  5.10it/s] 55%|█████▌    | 260/471 [00:53<00:41,  5.03it/s] 55%|█████▌    | 261/471 [00:53<00:36,  5.70it/s] 56%|█████▌    | 262/471 [00:54<00:39,  5.25it/s] 56%|█████▌    | 263/471 [00:54<00:37,  5.55it/s] 56%|█████▌    | 264/471 [00:54<00:41,  4.97it/s] 56%|█████▋    | 265/471 [00:54<00:42,  4.85it/s] 56%|█████▋    | 266/471 [00:54<00:42,  4.82it/s] 57%|█████▋    | 267/471 [00:55<00:43,  4.65it/s] 57%|█████▋    | 268/471 [00:55<00:40,  4.97it/s] 57%|█████▋    | 269/471 [00:55<00:43,  4.64it/s] 57%|█████▋    | 270/471 [00:55<00:41,  4.79it/s] 58%|█████▊    | 271/471 [00:56<00:43,  4.56it/s] 58%|█████▊    | 272/471 [00:56<00:41,  4.80it/s] 58%|█████▊    | 273/471 [00:56<00:42,  4.64it/s] 58%|█████▊    | 274/471 [00:56<00:40,  4.88it/s] 58%|█████▊    | 275/471 [00:56<00:42,  4.58it/s] 59%|█████▊    | 276/471 [00:57<00:41,  4.75it/s] 59%|█████▉    | 277/471 [00:57<00:42,  4.62it/s] 59%|█████▉    | 278/471 [00:57<00:41,  4.68it/s] 59%|█████▉    | 279/471 [00:57<00:40,  4.80it/s] 59%|█████▉    | 280/471 [00:57<00:39,  4.87it/s] 60%|█████▉    | 281/471 [00:58<00:36,  5.18it/s] 60%|█████▉    | 282/471 [00:58<00:37,  5.09it/s] 60%|██████    | 283/471 [00:58<00:33,  5.61it/s] 60%|██████    | 284/471 [00:58<00:34,  5.47it/s] 61%|██████    | 285/471 [00:58<00:32,  5.69it/s] 61%|██████    | 286/471 [00:58<00:34,  5.29it/s] 61%|██████    | 287/471 [00:59<00:33,  5.55it/s] 61%|██████    | 288/471 [00:59<00:33,  5.47it/s] 61%|██████▏   | 289/471 [00:59<00:32,  5.53it/s] 62%|██████▏   | 290/471 [00:59<00:31,  5.68it/s] 62%|██████▏   | 291/471 [00:59<00:31,  5.79it/s] 62%|██████▏   | 292/471 [00:59<00:28,  6.25it/s] 62%|██████▏   | 293/471 [01:00<00:29,  5.99it/s] 62%|██████▏   | 294/471 [01:00<00:29,  6.07it/s] 63%|██████▎   | 295/471 [01:00<00:29,  5.95it/s] 63%|██████▎   | 296/471 [01:00<00:29,  5.88it/s] 63%|██████▎   | 297/471 [01:00<00:31,  5.53it/s] 63%|██████▎   | 298/471 [01:01<00:31,  5.51it/s] 63%|██████▎   | 299/471 [01:01<00:30,  5.61it/s] 64%|██████▎   | 300/471 [01:01<00:30,  5.57it/s] 64%|██████▍   | 301/471 [01:01<00:28,  5.99it/s] 64%|██████▍   | 302/471 [01:01<00:30,  5.62it/s] 64%|██████▍   | 303/471 [01:01<00:29,  5.78it/s] 65%|██████▍   | 304/471 [01:02<00:31,  5.38it/s] 65%|██████▍   | 305/471 [01:02<00:29,  5.66it/s] 65%|██████▍   | 306/471 [01:02<00:30,  5.44it/s] 65%|██████▌   | 307/471 [01:02<00:28,  5.78it/s] 65%|██████▌   | 308/471 [01:02<00:30,  5.36it/s] 66%|██████▌   | 309/471 [01:03<00:31,  5.10it/s] 66%|██████▌   | 310/471 [01:03<00:32,  4.92it/s] 66%|██████▌   | 311/471 [01:03<00:33,  4.77it/s] 66%|██████▌   | 312/471 [01:03<00:32,  4.86it/s] 66%|██████▋   | 313/471 [01:03<00:34,  4.59it/s] 67%|██████▋   | 314/471 [01:04<00:33,  4.69it/s] 67%|██████▋   | 315/471 [01:04<00:34,  4.48it/s] 67%|██████▋   | 316/471 [01:04<00:32,  4.71it/s] 67%|██████▋   | 317/471 [01:04<00:33,  4.53it/s] 68%|██████▊   | 318/471 [01:04<00:32,  4.78it/s] 68%|██████▊   | 319/471 [01:05<00:34,  4.44it/s] 68%|██████▊   | 320/471 [01:05<00:32,  4.65it/s] 68%|██████▊   | 321/471 [01:05<00:33,  4.47it/s] 68%|██████▊   | 322/471 [01:05<00:31,  4.74it/s] 69%|██████▊   | 323/471 [01:06<00:32,  4.55it/s] 69%|██████▉   | 324/471 [01:06<00:31,  4.68it/s] 69%|██████▉   | 325/471 [01:06<00:32,  4.47it/s] 69%|██████▉   | 326/471 [01:06<00:31,  4.60it/s] 69%|██████▉   | 327/471 [01:06<00:31,  4.59it/s] 70%|██████▉   | 328/471 [01:07<00:30,  4.65it/s] 70%|██████▉   | 329/471 [01:07<00:29,  4.75it/s] 70%|███████   | 330/471 [01:07<00:31,  4.50it/s] 70%|███████   | 331/471 [01:07<00:29,  4.81it/s] 70%|███████   | 332/471 [01:08<00:30,  4.55it/s] 71%|███████   | 333/471 [01:08<00:27,  5.10it/s] 71%|███████   | 334/471 [01:08<00:29,  4.64it/s] 71%|███████   | 335/471 [01:08<00:27,  4.92it/s] 71%|███████▏  | 336/471 [01:08<00:28,  4.66it/s] 72%|███████▏  | 337/471 [01:09<00:27,  4.92it/s] 72%|███████▏  | 338/471 [01:09<00:25,  5.14it/s] 72%|███████▏  | 339/471 [01:09<00:24,  5.31it/s] 72%|███████▏  | 341/471 [01:09<00:22,  5.72it/s] 73%|███████▎  | 342/471 [01:09<00:21,  5.97it/s] 73%|███████▎  | 343/471 [01:10<00:23,  5.53it/s] 73%|███████▎  | 344/471 [01:10<00:22,  5.76it/s] 73%|███████▎  | 345/471 [01:10<00:22,  5.72it/s] 73%|███████▎  | 346/471 [01:10<00:22,  5.53it/s] 74%|███████▎  | 347/471 [01:10<00:22,  5.58it/s] 74%|███████▍  | 348/471 [01:10<00:22,  5.43it/s] 74%|███████▍  | 349/471 [01:11<00:21,  5.79it/s] 74%|███████▍  | 350/471 [01:11<00:21,  5.55it/s] 75%|███████▍  | 351/471 [01:11<00:20,  5.83it/s] 75%|███████▍  | 352/471 [01:11<00:23,  5.03it/s] 75%|███████▍  | 353/471 [01:11<00:22,  5.21it/s] 75%|███████▌  | 354/471 [01:12<00:24,  4.74it/s] 75%|███████▌  | 355/471 [01:12<00:23,  4.87it/s] 76%|███████▌  | 356/471 [01:12<00:23,  4.99it/s] 76%|███████▌  | 357/471 [01:12<00:24,  4.75it/s] 76%|███████▌  | 358/471 [01:12<00:22,  4.95it/s] 76%|███████▌  | 359/471 [01:13<00:24,  4.64it/s] 76%|███████▋  | 360/471 [01:13<00:22,  5.04it/s] 77%|███████▋  | 361/471 [01:13<00:23,  4.77it/s] 77%|███████▋  | 362/471 [01:13<00:21,  5.06it/s] 77%|███████▋  | 363/471 [01:14<00:23,  4.53it/s] 77%|███████▋  | 364/471 [01:14<00:22,  4.72it/s] 77%|███████▋  | 365/471 [01:14<00:22,  4.70it/s] 78%|███████▊  | 366/471 [01:14<00:22,  4.69it/s] 78%|███████▊  | 367/471 [01:14<00:21,  4.83it/s] 78%|███████▊  | 368/471 [01:15<00:22,  4.56it/s] 78%|███████▊  | 369/471 [01:15<00:21,  4.81it/s] 79%|███████▊  | 370/471 [01:15<00:22,  4.55it/s] 79%|███████▉  | 371/471 [01:15<00:20,  4.94it/s] 79%|███████▉  | 372/471 [01:15<00:21,  4.63it/s] 79%|███████▉  | 373/471 [01:16<00:19,  4.95it/s] 79%|███████▉  | 374/471 [01:16<00:21,  4.56it/s] 80%|███████▉  | 375/471 [01:16<00:20,  4.73it/s] 80%|███████▉  | 376/471 [01:16<00:20,  4.73it/s] 80%|████████  | 377/471 [01:16<00:20,  4.69it/s] 80%|████████  | 378/471 [01:17<00:17,  5.21it/s] 80%|████████  | 379/471 [01:17<00:19,  4.79it/s] 81%|████████  | 380/471 [01:17<00:17,  5.07it/s] 81%|████████  | 381/471 [01:17<00:19,  4.61it/s] 81%|████████  | 382/471 [01:17<00:17,  5.02it/s] 81%|████████▏ | 383/471 [01:18<00:18,  4.67it/s] 82%|████████▏ | 384/471 [01:18<00:18,  4.80it/s] 82%|████████▏ | 385/471 [01:18<00:18,  4.66it/s] 82%|████████▏ | 386/471 [01:18<00:18,  4.54it/s] 82%|████████▏ | 387/471 [01:19<00:17,  4.85it/s] 82%|████████▏ | 388/471 [01:19<00:17,  4.67it/s] 83%|████████▎ | 389/471 [01:19<00:16,  5.06it/s] 83%|████████▎ | 390/471 [01:19<00:17,  4.61it/s] 83%|████████▎ | 391/471 [01:19<00:16,  4.98it/s] 83%|████████▎ | 392/471 [01:20<00:17,  4.62it/s] 83%|████████▎ | 393/471 [01:20<00:16,  4.77it/s] 84%|████████▎ | 394/471 [01:20<00:16,  4.70it/s] 84%|████████▍ | 395/471 [01:20<00:16,  4.58it/s] 84%|████████▍ | 396/471 [01:20<00:15,  4.81it/s] 84%|████████▍ | 397/471 [01:21<00:15,  4.63it/s] 85%|████████▍ | 398/471 [01:21<00:14,  4.89it/s] 85%|████████▍ | 399/471 [01:21<00:15,  4.68it/s] 85%|████████▍ | 400/471 [01:21<00:14,  4.99it/s] 85%|████████▌ | 401/471 [01:22<00:15,  4.56it/s] 85%|████████▌ | 402/471 [01:22<00:14,  4.90it/s] 86%|████████▌ | 403/471 [01:22<00:14,  4.55it/s] 86%|████████▌ | 404/471 [01:22<00:13,  4.85it/s] 86%|████████▌ | 405/471 [01:22<00:14,  4.69it/s] 86%|████████▌ | 406/471 [01:23<00:14,  4.57it/s] 86%|████████▋ | 407/471 [01:23<00:13,  4.79it/s] 87%|████████▋ | 408/471 [01:23<00:13,  4.81it/s] 87%|████████▋ | 409/471 [01:23<00:11,  5.24it/s] 87%|████████▋ | 410/471 [01:23<00:11,  5.23it/s] 87%|████████▋ | 411/471 [01:23<00:10,  5.64it/s] 87%|████████▋ | 412/471 [01:24<00:11,  5.19it/s] 88%|████████▊ | 413/471 [01:24<00:10,  5.59it/s] 88%|████████▊ | 414/471 [01:24<00:10,  5.38it/s] 88%|████████▊ | 415/471 [01:24<00:09,  5.74it/s] 88%|████████▊ | 416/471 [01:24<00:09,  5.92it/s] 89%|████████▊ | 417/471 [01:25<00:08,  6.10it/s] 89%|████████▊ | 418/471 [01:25<00:07,  6.75it/s] 89%|████████▉ | 419/471 [01:25<00:07,  6.65it/s] 89%|████████▉ | 421/471 [01:25<00:07,  7.05it/s] 90%|████████▉ | 422/471 [01:25<00:06,  7.54it/s] 90%|████████▉ | 423/471 [01:25<00:06,  7.23it/s] 90%|█████████ | 424/471 [01:25<00:06,  7.23it/s] 90%|█████████ | 425/471 [01:26<00:06,  7.32it/s] 90%|█████████ | 426/471 [01:26<00:06,  6.53it/s] 91%|█████████ | 427/471 [01:26<00:06,  7.06it/s] 91%|█████████ | 428/471 [01:26<00:06,  6.22it/s] 91%|█████████ | 429/471 [01:26<00:06,  6.66it/s] 91%|█████████▏| 430/471 [01:26<00:06,  6.07it/s] 92%|█████████▏| 431/471 [01:27<00:06,  6.09it/s] 92%|█████████▏| 432/471 [01:27<00:06,  5.94it/s] 92%|█████████▏| 433/471 [01:27<00:06,  5.86it/s] 92%|█████████▏| 434/471 [01:27<00:06,  5.90it/s] 92%|█████████▏| 435/471 [01:27<00:06,  5.71it/s] 93%|█████████▎| 436/471 [01:27<00:05,  6.03it/s] 93%|█████████▎| 437/471 [01:28<00:05,  5.84it/s] 93%|█████████▎| 438/471 [01:28<00:05,  5.98it/s] 93%|█████████▎| 439/471 [01:28<00:05,  5.81it/s] 93%|█████████▎| 440/471 [01:28<00:05,  5.93it/s] 94%|█████████▎| 441/471 [01:28<00:05,  5.67it/s] 94%|█████████▍| 442/471 [01:28<00:04,  5.94it/s] 94%|█████████▍| 443/471 [01:29<00:04,  5.63it/s] 94%|█████████▍| 444/471 [01:29<00:04,  5.81it/s] 94%|█████████▍| 445/471 [01:29<00:05,  5.12it/s] 95%|█████████▍| 446/471 [01:29<00:04,  5.09it/s] 95%|█████████▍| 447/471 [01:29<00:05,  4.80it/s] 95%|█████████▌| 448/471 [01:30<00:04,  4.87it/s] 95%|█████████▌| 449/471 [01:30<00:04,  4.75it/s] 96%|█████████▌| 450/471 [01:30<00:04,  4.79it/s] 96%|█████████▌| 451/471 [01:30<00:04,  4.69it/s] 96%|█████████▌| 452/471 [01:31<00:04,  4.71it/s] 96%|█████████▌| 453/471 [01:31<00:03,  4.63it/s] 96%|█████████▋| 454/471 [01:31<00:03,  4.67it/s] 97%|█████████▋| 455/471 [01:31<00:03,  4.76it/s] 97%|█████████▋| 456/471 [01:31<00:03,  4.64it/s] 97%|█████████▋| 457/471 [01:32<00:03,  4.62it/s] 97%|█████████▋| 458/471 [01:32<00:02,  4.60it/s] 97%|█████████▋| 459/471 [01:32<00:02,  4.68it/s] 98%|█████████▊| 460/471 [01:32<00:02,  4.69it/s] 98%|█████████▊| 461/471 [01:32<00:02,  4.70it/s] 98%|█████████▊| 462/471 [01:33<00:01,  4.54it/s] 98%|█████████▊| 463/471 [01:33<00:01,  4.63it/s] 99%|█████████▊| 464/471 [01:33<00:01,  4.51it/s] 99%|█████████▊| 465/471 [01:33<00:01,  4.70it/s] 99%|█████████▉| 466/471 [01:34<00:01,  4.61it/s] 99%|█████████▉| 467/471 [01:34<00:00,  4.56it/s] 99%|█████████▉| 468/471 [01:34<00:00,  4.51it/s]100%|█████████▉| 469/471 [01:34<00:00,  4.65it/s]100%|█████████▉| 470/471 [01:34<00:00,  4.66it/s]100%|██████████| 471/471 [01:35<00:00,  5.03it/s]100%|██████████| 471/471 [01:35<00:00,  4.95it/s]
{'eval_loss': 2.1378822326660156, 'eval_model_preparation_time': 0.0048, 'eval_acc': 0.47371216144450345, 'eval_runtime': 95.3425, 'eval_samples_per_second': 78.999, 'eval_steps_per_second': 4.94}
ROUND:11
CLIENT:23
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]                                              {'loss': 2.1969, 'grad_norm': 4.195133209228516, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]  5%|▌         | 2/40 [00:00<00:16,  2.28it/s]                                              {'loss': 2.1232, 'grad_norm': 3.6260077953338623, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.28it/s]  8%|▊         | 3/40 [00:01<00:16,  2.31it/s]                                              {'loss': 2.1601, 'grad_norm': 3.755465507507324, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.31it/s] 10%|█         | 4/40 [00:01<00:16,  2.24it/s]                                              {'loss': 2.3802, 'grad_norm': 4.0778279304504395, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.24it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.24it/s]                                              {'loss': 2.1673, 'grad_norm': 3.7177317142486572, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.24it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.2947, 'grad_norm': 4.5085601806640625, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s]                                              {'loss': 2.077, 'grad_norm': 5.36616325378418, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s] 20%|██        | 8/40 [00:03<00:11,  2.87it/s]                                              {'loss': 2.0478, 'grad_norm': 22.789505004882812, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.87it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.65it/s]                                              {'loss': 2.2209, 'grad_norm': 4.4502339363098145, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.65it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s]                                               {'loss': 2.0079, 'grad_norm': 5.836296558380127, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.48it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s]                                               {'loss': 2.1442, 'grad_norm': 3.6836140155792236, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s] 30%|███       | 12/40 [00:05<00:12,  2.33it/s]                                               {'loss': 1.8919, 'grad_norm': 4.143397331237793, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.33it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.29it/s]                                               {'loss': 2.1165, 'grad_norm': 3.4025306701660156, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.29it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s]                                               {'loss': 2.0828, 'grad_norm': 3.5982093811035156, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.1602, 'grad_norm': 4.422657012939453, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s] 40%|████      | 16/40 [00:06<00:08,  2.86it/s]                                               {'loss': 1.8952, 'grad_norm': 13.540172576904297, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.86it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.65it/s]                                               {'loss': 2.0651, 'grad_norm': 4.715027809143066, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.65it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 2.0413, 'grad_norm': 3.688124418258667, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.41it/s]                                               {'loss': 2.162, 'grad_norm': 3.8994925022125244, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.41it/s] 50%|█████     | 20/40 [00:08<00:08,  2.42it/s]                                               {'loss': 1.8887, 'grad_norm': 3.3537778854370117, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.42it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s]                                               {'loss': 1.9128, 'grad_norm': 6.343644142150879, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s]                                               {'loss': 2.1423, 'grad_norm': 3.9568471908569336, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s]                                               {'loss': 2.0253, 'grad_norm': 2.6825268268585205, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s] 60%|██████    | 24/40 [00:09<00:05,  2.85it/s]                                               {'loss': 2.8829, 'grad_norm': 14.231348037719727, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s]                                               {'loss': 2.175, 'grad_norm': 3.9583847522735596, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.62it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.46it/s]                                               {'loss': 1.8746, 'grad_norm': 3.307699680328369, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.46it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.2502, 'grad_norm': 4.2589898109436035, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s] 70%|███████   | 28/40 [00:11<00:05,  2.30it/s]                                               {'loss': 1.8757, 'grad_norm': 3.752082347869873, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.30it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.23it/s]                                               {'loss': 1.8084, 'grad_norm': 2.8455281257629395, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.23it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.20it/s]                                               {'loss': 1.9538, 'grad_norm': 3.875828981399536, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.20it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.20it/s]                                               {'loss': 2.2974, 'grad_norm': 3.735640048980713, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.20it/s]                                               {'loss': 2.5801, 'grad_norm': 10.445480346679688, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.20it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.70it/s]                                               {'loss': 1.9705, 'grad_norm': 4.213715553283691, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.70it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s]                                               {'loss': 2.0399, 'grad_norm': 3.678603410720825, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.45it/s]                                               {'loss': 2.0983, 'grad_norm': 3.713811159133911, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.45it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s]                                               {'loss': 1.9079, 'grad_norm': 3.8814454078674316, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.40it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.31it/s]                                               {'loss': 1.7586, 'grad_norm': 3.1095519065856934, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s]                                               {'loss': 2.0148, 'grad_norm': 5.581746578216553, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]                                               {'loss': 2.2601, 'grad_norm': 4.457944393157959, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'loss': 2.2071, 'grad_norm': 11.149293899536133, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]                                               {'train_runtime': 16.5631, 'train_samples_per_second': 34.112, 'train_steps_per_second': 2.415, 'train_loss': 2.103994366526604, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.86it/s]100%|██████████| 40/40 [00:16<00:00,  2.42it/s]
CLIENT:81
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.29it/s]                                              {'loss': 2.1083, 'grad_norm': 3.992227792739868, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.29it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.0932, 'grad_norm': 6.982141017913818, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:16,  2.24it/s]                                              {'loss': 2.2171, 'grad_norm': 3.5559144020080566, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.24it/s] 10%|█         | 4/40 [00:01<00:16,  2.18it/s]                                              {'loss': 2.406, 'grad_norm': 4.061408996582031, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.18it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.2998, 'grad_norm': 6.143967628479004, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.3978, 'grad_norm': 5.012615203857422, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.19it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s]                                              {'loss': 2.2433, 'grad_norm': 4.710301876068115, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s] 20%|██        | 8/40 [00:03<00:11,  2.84it/s]                                              {'loss': 2.2027, 'grad_norm': 9.699795722961426, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.84it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s]                                              {'loss': 1.9747, 'grad_norm': 4.1730499267578125, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.2564, 'grad_norm': 3.472125291824341, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s]                                               {'loss': 2.1452, 'grad_norm': 4.007242202758789, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.41it/s] 30%|███       | 12/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.1422, 'grad_norm': 5.633934497833252, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.34it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s]                                               {'loss': 2.0833, 'grad_norm': 3.425687074661255, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s]                                               {'loss': 2.3135, 'grad_norm': 5.555882930755615, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s]                                               {'loss': 2.0601, 'grad_norm': 4.364908695220947, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s] 40%|████      | 16/40 [00:06<00:08,  2.86it/s]                                               {'loss': 1.31, 'grad_norm': 10.051353454589844, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.86it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.69it/s]                                               {'loss': 2.015, 'grad_norm': 3.4600775241851807, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.69it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s]                                               {'loss': 1.8655, 'grad_norm': 5.5231499671936035, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.49it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s]                                               {'loss': 2.134, 'grad_norm': 3.526815414428711, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.43it/s] 50%|█████     | 20/40 [00:08<00:08,  2.39it/s]                                               {'loss': 2.2238, 'grad_norm': 4.238114833831787, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.39it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.31it/s]                                               {'loss': 2.0752, 'grad_norm': 4.093589782714844, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.31it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.30it/s]                                               {'loss': 2.0852, 'grad_norm': 4.711092472076416, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.30it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s]                                               {'loss': 1.964, 'grad_norm': 3.6854825019836426, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.26it/s] 60%|██████    | 24/40 [00:09<00:05,  2.82it/s]                                               {'loss': 2.0928, 'grad_norm': 42.20182800292969, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.82it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.61it/s]                                               {'loss': 2.0507, 'grad_norm': 5.323609352111816, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.61it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.44it/s]                                               {'loss': 2.3002, 'grad_norm': 5.126034259796143, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.44it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s]                                               {'loss': 2.1314, 'grad_norm': 3.7987470626831055, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.35it/s] 70%|███████   | 28/40 [00:11<00:05,  2.31it/s]                                               {'loss': 2.1493, 'grad_norm': 3.414292573928833, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.31it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s]                                               {'loss': 1.7965, 'grad_norm': 3.41916561126709, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.26it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.0851, 'grad_norm': 3.5740506649017334, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.33it/s]                                               {'loss': 1.8346, 'grad_norm': 3.7339205741882324, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.33it/s]                                               {'loss': 2.5193, 'grad_norm': 40.202213287353516, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.33it/s] 82%|████████▎ | 33/40 [00:13<00:02,  3.02it/s]                                               {'loss': 2.1683, 'grad_norm': 3.5061328411102295, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  3.02it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.95it/s]                                               {'loss': 1.7483, 'grad_norm': 4.030794620513916, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.95it/s] 88%|████████▊ | 35/40 [00:14<00:01,  2.89it/s]                                               {'loss': 1.9852, 'grad_norm': 4.131831169128418, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:01,  2.89it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.85it/s]                                               {'loss': 2.031, 'grad_norm': 3.9679019451141357, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.85it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.82it/s]                                               {'loss': 2.09, 'grad_norm': 4.0841498374938965, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.82it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.79it/s]                                               {'loss': 2.1217, 'grad_norm': 3.837373733520508, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.79it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.76it/s]                                               {'loss': 1.8743, 'grad_norm': 3.2853503227233887, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.76it/s]100%|██████████| 40/40 [00:15<00:00,  3.47it/s]                                               {'loss': 1.625, 'grad_norm': 9.39776611328125, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.47it/s]                                               {'train_runtime': 15.8835, 'train_samples_per_second': 35.572, 'train_steps_per_second': 2.518, 'train_loss': 2.08050200343132, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.47it/s]100%|██████████| 40/40 [00:15<00:00,  2.52it/s]
CLIENT:85
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:25,  1.50it/s]                                              {'loss': 2.066, 'grad_norm': 4.200618743896484, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:25,  1.50it/s]  5%|▌         | 2/40 [00:01<00:21,  1.74it/s]                                              {'loss': 2.1366, 'grad_norm': 4.279253005981445, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:21,  1.74it/s]  8%|▊         | 3/40 [00:01<00:19,  1.88it/s]                                              {'loss': 2.1186, 'grad_norm': 4.47144889831543, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:19,  1.88it/s] 10%|█         | 4/40 [00:02<00:17,  2.01it/s]                                              {'loss': 2.1891, 'grad_norm': 3.7298171520233154, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:17,  2.01it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.09it/s]                                              {'loss': 2.103, 'grad_norm': 3.655914068222046, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.09it/s] 15%|█▌        | 6/40 [00:03<00:15,  2.13it/s]                                              {'loss': 1.9038, 'grad_norm': 3.9401254653930664, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.16it/s]                                              {'loss': 2.3384, 'grad_norm': 5.2863969802856445, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.16it/s] 20%|██        | 8/40 [00:03<00:13,  2.31it/s]                                              {'loss': 1.111, 'grad_norm': 9.987268447875977, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:13,  2.31it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.27it/s]                                              {'loss': 2.1857, 'grad_norm': 3.55718994140625, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.27it/s] 25%|██▌       | 10/40 [00:04<00:13,  2.26it/s]                                               {'loss': 1.9921, 'grad_norm': 5.067500114440918, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:13,  2.26it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.22it/s]                                               {'loss': 2.1349, 'grad_norm': 4.579346179962158, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.22it/s] 30%|███       | 12/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.1281, 'grad_norm': 4.743912696838379, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.23it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s]                                               {'loss': 1.9679, 'grad_norm': 4.489336013793945, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.0175, 'grad_norm': 3.8608808517456055, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.29it/s]                                               {'loss': 2.0041, 'grad_norm': 2.857605457305908, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.29it/s] 40%|████      | 16/40 [00:07<00:08,  2.98it/s]                                               {'loss': 1.5911, 'grad_norm': 8.872820854187012, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.98it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s]                                               {'loss': 2.131, 'grad_norm': 2.936709403991699, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.64it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.51it/s]                                               {'loss': 1.9534, 'grad_norm': 3.99916410446167, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.51it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s]                                               {'loss': 1.8638, 'grad_norm': 3.8705427646636963, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s] 50%|█████     | 20/40 [00:08<00:08,  2.31it/s]                                               {'loss': 2.1662, 'grad_norm': 4.222265243530273, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.31it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s]                                               {'loss': 2.0114, 'grad_norm': 3.0550150871276855, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.26it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s]                                               {'loss': 2.0516, 'grad_norm': 3.5248754024505615, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s]                                               {'loss': 2.1174, 'grad_norm': 4.444407939910889, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.24it/s] 60%|██████    | 24/40 [00:10<00:05,  2.87it/s]                                               {'loss': 1.6449, 'grad_norm': 23.630224227905273, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.87it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s]                                               {'loss': 1.955, 'grad_norm': 3.4517338275909424, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.52it/s]                                               {'loss': 1.982, 'grad_norm': 3.420538902282715, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.52it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s]                                               {'loss': 2.0571, 'grad_norm': 3.7198829650878906, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s] 70%|███████   | 28/40 [00:12<00:05,  2.35it/s]                                               {'loss': 1.9765, 'grad_norm': 3.27890682220459, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.35it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s]                                               {'loss': 1.8154, 'grad_norm': 2.9046833515167236, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.27it/s]                                               {'loss': 2.0692, 'grad_norm': 3.4720075130462646, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s]                                               {'loss': 2.0627, 'grad_norm': 3.310516357421875, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.27it/s] 80%|████████  | 32/40 [00:13<00:02,  2.87it/s]                                               {'loss': 2.246, 'grad_norm': 14.699642181396484, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.87it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.60it/s]                                               {'loss': 1.8188, 'grad_norm': 3.29119873046875, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.60it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s]                                               {'loss': 2.0559, 'grad_norm': 3.1667604446411133, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.50it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.48it/s]                                               {'loss': 2.0774, 'grad_norm': 4.452452182769775, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.48it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.37it/s]                                               {'loss': 2.0045, 'grad_norm': 3.1175637245178223, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.37it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s]                                               {'loss': 1.8545, 'grad_norm': 2.76119327545166, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.34it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.30it/s]                                               {'loss': 2.1385, 'grad_norm': 3.1163489818573, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.27it/s]                                               {'loss': 1.9471, 'grad_norm': 3.3457138538360596, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.27it/s]100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'loss': 1.8021, 'grad_norm': 11.579729080200195, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'train_runtime': 17.0505, 'train_samples_per_second': 33.137, 'train_steps_per_second': 2.346, 'train_loss': 1.9947527199983597, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.88it/s]100%|██████████| 40/40 [00:17<00:00,  2.35it/s]
CLIENT:34
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.6117, 'grad_norm': 6.095311164855957, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]                                              {'loss': 1.9369, 'grad_norm': 4.798065185546875, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.22it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.3731, 'grad_norm': 6.634067535400391, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.3121, 'grad_norm': 8.111882209777832, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.19it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.4249, 'grad_norm': 4.3686676025390625, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.066, 'grad_norm': 4.344900131225586, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.26it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.20it/s]                                              {'loss': 1.8994, 'grad_norm': 3.8894801139831543, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.20it/s] 20%|██        | 8/40 [00:03<00:11,  2.88it/s]                                              {'loss': 2.6756, 'grad_norm': 12.718286514282227, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.88it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s]                                              {'loss': 1.97, 'grad_norm': 3.4646027088165283, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.67it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.1689, 'grad_norm': 3.4254677295684814, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.39it/s]                                               {'loss': 1.8817, 'grad_norm': 4.606653690338135, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.39it/s] 30%|███       | 12/40 [00:05<00:11,  2.34it/s]                                               {'loss': 2.2393, 'grad_norm': 4.704634189605713, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.34it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s]                                               {'loss': 2.1732, 'grad_norm': 3.315969467163086, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.28it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.29it/s]                                               {'loss': 2.1081, 'grad_norm': 3.192373037338257, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.29it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.075, 'grad_norm': 3.7222740650177, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 2.9139, 'grad_norm': 34.76103591918945, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.63it/s]                                               {'loss': 2.056, 'grad_norm': 4.763225078582764, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.63it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.1737, 'grad_norm': 3.961912155151367, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.38it/s]                                               {'loss': 2.1799, 'grad_norm': 3.7476646900177, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.38it/s] 50%|█████     | 20/40 [00:08<00:08,  2.35it/s]                                               {'loss': 1.9726, 'grad_norm': 3.7822954654693604, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.35it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.0799, 'grad_norm': 3.7748167514801025, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s]                                               {'loss': 2.015, 'grad_norm': 4.212756156921387, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.31it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s]                                               {'loss': 1.8703, 'grad_norm': 4.4191436767578125, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.28it/s] 60%|██████    | 24/40 [00:09<00:05,  2.85it/s]                                               {'loss': 2.1765, 'grad_norm': 18.12126922607422, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.85it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s]                                               {'loss': 1.9316, 'grad_norm': 3.0270657539367676, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.60it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.50it/s]                                               {'loss': 2.1933, 'grad_norm': 2.881922721862793, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.50it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s]                                               {'loss': 1.8295, 'grad_norm': 3.4037678241729736, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.37it/s] 70%|███████   | 28/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.0342, 'grad_norm': 4.564655780792236, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.32it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.1235, 'grad_norm': 4.709763050079346, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.21it/s]                                               {'loss': 1.9692, 'grad_norm': 4.03061056137085, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.21it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 1.8846, 'grad_norm': 4.224567890167236, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.5954, 'grad_norm': 15.964524269104004, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.21it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.67it/s]                                               {'loss': 1.9641, 'grad_norm': 4.672055721282959, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.67it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.54it/s]                                               {'loss': 1.9868, 'grad_norm': 5.1777215003967285, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.54it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s]                                               {'loss': 2.0048, 'grad_norm': 2.872389316558838, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.41it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.37it/s]                                               {'loss': 2.0069, 'grad_norm': 3.2432236671447754, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.37it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.31it/s]                                               {'loss': 2.088, 'grad_norm': 4.316055774688721, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s]                                               {'loss': 1.8449, 'grad_norm': 2.853398561477661, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]                                               {'loss': 1.953, 'grad_norm': 3.1083009243011475, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.30it/s]100%|██████████| 40/40 [00:16<00:00,  2.95it/s]                                               {'loss': 1.9409, 'grad_norm': 11.156187057495117, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.95it/s]                                               {'train_runtime': 16.5843, 'train_samples_per_second': 34.068, 'train_steps_per_second': 2.412, 'train_loss': 2.117605817317963, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.95it/s]100%|██████████| 40/40 [00:16<00:00,  2.41it/s]
CLIENT:62
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.74it/s]                                              {'loss': 2.0246, 'grad_norm': 3.6148335933685303, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.74it/s]  5%|▌         | 2/40 [00:00<00:13,  2.73it/s]                                              {'loss': 2.1462, 'grad_norm': 5.576324462890625, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.73it/s]  8%|▊         | 3/40 [00:01<00:13,  2.72it/s]                                              {'loss': 2.0542, 'grad_norm': 3.7788007259368896, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.72it/s] 10%|█         | 4/40 [00:01<00:13,  2.70it/s]                                              {'loss': 2.0819, 'grad_norm': 4.010135650634766, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.70it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.72it/s]                                              {'loss': 2.0913, 'grad_norm': 3.568779945373535, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.72it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.72it/s]                                              {'loss': 2.2915, 'grad_norm': 3.4005775451660156, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.72it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.72it/s]                                              {'loss': 2.068, 'grad_norm': 4.605528831481934, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.72it/s] 20%|██        | 8/40 [00:02<00:11,  2.77it/s]                                              {'loss': 2.282, 'grad_norm': 12.31843090057373, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:11,  2.77it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.77it/s]                                              {'loss': 2.0619, 'grad_norm': 4.8671064376831055, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.77it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.80it/s]                                               {'loss': 2.2326, 'grad_norm': 3.859501600265503, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.80it/s] 28%|██▊       | 11/40 [00:03<00:10,  2.81it/s]                                               {'loss': 2.119, 'grad_norm': 4.477192401885986, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:10,  2.81it/s] 30%|███       | 12/40 [00:04<00:09,  2.84it/s]                                               {'loss': 1.9348, 'grad_norm': 3.6118416786193848, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:09,  2.84it/s] 32%|███▎      | 13/40 [00:04<00:09,  2.86it/s]                                               {'loss': 1.9831, 'grad_norm': 3.033372163772583, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:09,  2.86it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.83it/s]                                               {'loss': 2.0829, 'grad_norm': 3.0027658939361572, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.83it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.75it/s]                                               {'loss': 2.0383, 'grad_norm': 4.820228099822998, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.75it/s] 40%|████      | 16/40 [00:05<00:07,  3.38it/s]                                               {'loss': 2.8189, 'grad_norm': 19.289743423461914, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.38it/s] 42%|████▎     | 17/40 [00:06<00:07,  2.89it/s]                                               {'loss': 1.8466, 'grad_norm': 3.052941083908081, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  2.89it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.64it/s]                                               {'loss': 2.1025, 'grad_norm': 3.9384918212890625, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.64it/s] 48%|████▊     | 19/40 [00:06<00:08,  2.49it/s]                                               {'loss': 2.1096, 'grad_norm': 3.445648193359375, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:06<00:08,  2.49it/s] 50%|█████     | 20/40 [00:07<00:08,  2.38it/s]                                               {'loss': 2.0713, 'grad_norm': 4.078591346740723, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.38it/s] 52%|█████▎    | 21/40 [00:07<00:08,  2.33it/s]                                               {'loss': 2.067, 'grad_norm': 3.589573383331299, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:08,  2.33it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.30it/s]                                               {'loss': 1.894, 'grad_norm': 3.904317855834961, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.30it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.28it/s]                                               {'loss': 1.9041, 'grad_norm': 4.237749099731445, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.28it/s] 60%|██████    | 24/40 [00:08<00:05,  2.88it/s]                                               {'loss': 1.8407, 'grad_norm': 18.221050262451172, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.63it/s]                                               {'loss': 1.9283, 'grad_norm': 3.706174373626709, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.54it/s]                                               {'loss': 1.9366, 'grad_norm': 2.8755338191986084, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.54it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.43it/s]                                               {'loss': 1.9064, 'grad_norm': 3.515408992767334, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.43it/s] 70%|███████   | 28/40 [00:10<00:05,  2.38it/s]                                               {'loss': 1.992, 'grad_norm': 3.3767566680908203, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.38it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s]                                               {'loss': 2.1908, 'grad_norm': 4.409056663513184, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.27it/s]                                               {'loss': 2.0844, 'grad_norm': 4.280134677886963, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s]                                               {'loss': 1.8474, 'grad_norm': 3.900512933731079, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s] 80%|████████  | 32/40 [00:12<00:02,  2.81it/s]                                               {'loss': 2.0253, 'grad_norm': 12.408875465393066, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.81it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.58it/s]                                               {'loss': 1.9881, 'grad_norm': 3.0400705337524414, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.58it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.45it/s]                                               {'loss': 1.9631, 'grad_norm': 2.952864646911621, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.45it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.34it/s]                                               {'loss': 1.9187, 'grad_norm': 3.231015920639038, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.34it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.26it/s]                                               {'loss': 2.0096, 'grad_norm': 3.0731189250946045, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.26it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.23it/s]                                               {'loss': 1.9906, 'grad_norm': 3.8529951572418213, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.23it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.19it/s]                                               {'loss': 1.9863, 'grad_norm': 4.526212692260742, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.19it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.19it/s]                                               {'loss': 1.8533, 'grad_norm': 3.4988996982574463, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.19it/s]100%|██████████| 40/40 [00:15<00:00,  2.81it/s]                                               {'loss': 1.4542, 'grad_norm': 9.209458351135254, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.81it/s]                                               {'train_runtime': 15.6593, 'train_samples_per_second': 36.081, 'train_steps_per_second': 2.554, 'train_loss': 2.0305532693862913, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.81it/s]100%|██████████| 40/40 [00:15<00:00,  2.55it/s]
CLIENT:46
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]                                              {'loss': 2.0263, 'grad_norm': 3.5686306953430176, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.37it/s]  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]                                              {'loss': 2.1711, 'grad_norm': 3.6753854751586914, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.33it/s]  8%|▊         | 3/40 [00:01<00:15,  2.33it/s]                                              {'loss': 2.1131, 'grad_norm': 3.7779407501220703, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.33it/s] 10%|█         | 4/40 [00:01<00:15,  2.34it/s]                                              {'loss': 2.1926, 'grad_norm': 3.0263679027557373, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.34it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.27it/s]                                              {'loss': 2.1183, 'grad_norm': 4.925510406494141, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.27it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.1623, 'grad_norm': 6.295873165130615, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.23it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s]                                              {'loss': 2.0789, 'grad_norm': 5.719899654388428, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s] 20%|██        | 8/40 [00:03<00:11,  2.88it/s]                                              {'loss': 2.3721, 'grad_norm': 11.261848449707031, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.88it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s]                                              {'loss': 1.9846, 'grad_norm': 3.619809150695801, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.53it/s]                                               {'loss': 2.0852, 'grad_norm': 4.127449035644531, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.53it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s]                                               {'loss': 2.2255, 'grad_norm': 6.357151985168457, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.47it/s] 30%|███       | 12/40 [00:04<00:11,  2.39it/s]                                               {'loss': 1.9608, 'grad_norm': 3.1204519271850586, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.39it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.1008, 'grad_norm': 3.356180429458618, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s]                                               {'loss': 1.922, 'grad_norm': 3.199880599975586, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s]                                               {'loss': 2.0584, 'grad_norm': 3.491248607635498, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.21it/s] 40%|████      | 16/40 [00:06<00:08,  2.89it/s]                                               {'loss': 2.5081, 'grad_norm': 11.856698036193848, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.89it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.68it/s]                                               {'loss': 1.8498, 'grad_norm': 3.464728593826294, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.68it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.57it/s]                                               {'loss': 1.9979, 'grad_norm': 3.238588333129883, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.57it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s]                                               {'loss': 2.2578, 'grad_norm': 3.848278522491455, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.42it/s] 50%|█████     | 20/40 [00:08<00:08,  2.33it/s]                                               {'loss': 2.024, 'grad_norm': 4.776429176330566, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.33it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s]                                               {'loss': 1.9571, 'grad_norm': 3.708420515060425, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.21it/s]                                               {'loss': 1.9061, 'grad_norm': 4.124588489532471, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.21it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.19it/s]                                               {'loss': 2.1442, 'grad_norm': 4.032135486602783, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.19it/s] 60%|██████    | 24/40 [00:09<00:05,  2.82it/s]                                               {'loss': 1.1603, 'grad_norm': 7.6212158203125, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.82it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.71it/s]                                               {'loss': 1.8211, 'grad_norm': 4.046110153198242, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.71it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.69it/s]                                               {'loss': 1.6578, 'grad_norm': 3.2333147525787354, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.69it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.67it/s]                                               {'loss': 2.3352, 'grad_norm': 4.98488187789917, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.67it/s] 70%|███████   | 28/40 [00:11<00:04,  2.65it/s]                                               {'loss': 2.1197, 'grad_norm': 3.9348316192626953, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.65it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.62it/s]                                               {'loss': 2.0754, 'grad_norm': 3.2591640949249268, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.62it/s] 75%|███████▌  | 30/40 [00:12<00:03,  2.62it/s]                                               {'loss': 1.8849, 'grad_norm': 3.2611031532287598, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:03,  2.62it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.58it/s]                                               {'loss': 2.0056, 'grad_norm': 3.6564228534698486, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.58it/s] 80%|████████  | 32/40 [00:12<00:02,  3.30it/s]                                               {'loss': 1.5667, 'grad_norm': 10.015113830566406, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.30it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.89it/s]                                               {'loss': 1.9575, 'grad_norm': 3.5659356117248535, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.89it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.76it/s]                                               {'loss': 1.7276, 'grad_norm': 3.038356065750122, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.76it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.71it/s]                                               {'loss': 2.0524, 'grad_norm': 6.45272159576416, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.71it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.66it/s]                                               {'loss': 1.9292, 'grad_norm': 2.6289844512939453, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.66it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.63it/s]                                               {'loss': 1.9639, 'grad_norm': 3.6903164386749268, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.63it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.63it/s]                                               {'loss': 1.8121, 'grad_norm': 3.7193315029144287, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.63it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.62it/s]                                               {'loss': 2.147, 'grad_norm': 3.2678449153900146, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.62it/s]100%|██████████| 40/40 [00:15<00:00,  3.30it/s]                                               {'loss': 2.712, 'grad_norm': 17.937889099121094, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.30it/s]                                               {'train_runtime': 15.6283, 'train_samples_per_second': 36.152, 'train_steps_per_second': 2.559, 'train_loss': 2.0286313354969026, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.30it/s]100%|██████████| 40/40 [00:15<00:00,  2.56it/s]
CLIENT:42
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]                                              {'loss': 2.1691, 'grad_norm': 3.911930799484253, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.23it/s]  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]                                              {'loss': 2.3078, 'grad_norm': 4.563933849334717, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.20it/s]  8%|▊         | 3/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.1862, 'grad_norm': 5.497226715087891, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.19it/s] 10%|█         | 4/40 [00:01<00:16,  2.18it/s]                                              {'loss': 2.3031, 'grad_norm': 4.819923400878906, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.18it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.19it/s]                                              {'loss': 2.0712, 'grad_norm': 5.047513484954834, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.3821, 'grad_norm': 3.8866844177246094, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s]                                              {'loss': 2.2828, 'grad_norm': 4.229384422302246, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s] 20%|██        | 8/40 [00:03<00:11,  2.76it/s]                                              {'loss': 2.3995, 'grad_norm': 11.062926292419434, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.76it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.51it/s]                                              {'loss': 2.396, 'grad_norm': 4.107605457305908, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.51it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.50it/s]                                               {'loss': 2.3189, 'grad_norm': 4.734409332275391, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.50it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.52it/s]                                               {'loss': 1.9759, 'grad_norm': 3.4414286613464355, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.52it/s] 30%|███       | 12/40 [00:05<00:10,  2.57it/s]                                               {'loss': 2.1646, 'grad_norm': 3.8262672424316406, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:10,  2.57it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.58it/s]                                               {'loss': 1.9693, 'grad_norm': 3.425555944442749, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.58it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.56it/s]                                               {'loss': 2.0773, 'grad_norm': 3.4107542037963867, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.56it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.54it/s]                                               {'loss': 2.1884, 'grad_norm': 3.743284225463867, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.54it/s] 40%|████      | 16/40 [00:06<00:07,  3.23it/s]                                               {'loss': 1.3803, 'grad_norm': 12.01298999786377, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.23it/s] 42%|████▎     | 17/40 [00:06<00:07,  2.97it/s]                                               {'loss': 2.1951, 'grad_norm': 3.6384174823760986, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  2.97it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.65it/s]                                               {'loss': 1.8847, 'grad_norm': 4.407441139221191, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.65it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.48it/s]                                               {'loss': 2.0622, 'grad_norm': 4.57597017288208, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.48it/s] 50%|█████     | 20/40 [00:08<00:08,  2.38it/s]                                               {'loss': 2.1772, 'grad_norm': 3.771775960922241, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.38it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s]                                               {'loss': 1.9318, 'grad_norm': 3.480868101119995, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s]                                               {'loss': 2.2507, 'grad_norm': 4.387834072113037, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.25it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.21it/s]                                               {'loss': 2.1102, 'grad_norm': 5.088645935058594, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.21it/s]                                               {'loss': 2.5933, 'grad_norm': 17.72552490234375, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:07,  2.21it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.68it/s]                                               {'loss': 1.9785, 'grad_norm': 3.3216919898986816, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.68it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.52it/s]                                               {'loss': 2.101, 'grad_norm': 3.460155487060547, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.52it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s]                                               {'loss': 2.1024, 'grad_norm': 3.6048853397369385, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.40it/s] 70%|███████   | 28/40 [00:11<00:05,  2.31it/s]                                               {'loss': 2.0596, 'grad_norm': 4.072322368621826, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.31it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.24it/s]                                               {'loss': 1.8778, 'grad_norm': 3.675908088684082, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.24it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s]                                               {'loss': 1.9683, 'grad_norm': 3.1932904720306396, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.18it/s]                                               {'loss': 1.9947, 'grad_norm': 4.108242034912109, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.18it/s] 80%|████████  | 32/40 [00:13<00:02,  2.80it/s]                                               {'loss': 1.9393, 'grad_norm': 17.28398323059082, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.80it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.59it/s]                                               {'loss': 1.9723, 'grad_norm': 3.35543155670166, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s]                                               {'loss': 1.8991, 'grad_norm': 3.9006311893463135, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s]                                               {'loss': 2.0335, 'grad_norm': 3.713298797607422, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.40it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s]                                               {'loss': 2.0995, 'grad_norm': 3.7607290744781494, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.36it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s]                                               {'loss': 1.904, 'grad_norm': 3.55700945854187, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.29it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.25it/s]                                               {'loss': 2.039, 'grad_norm': 3.9298317432403564, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.25it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.22it/s]                                               {'loss': 2.0562, 'grad_norm': 4.231381416320801, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.22it/s]100%|██████████| 40/40 [00:16<00:00,  2.76it/s]                                               {'loss': 1.6009, 'grad_norm': 13.806288719177246, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.76it/s]                                               {'train_runtime': 16.4587, 'train_samples_per_second': 34.328, 'train_steps_per_second': 2.43, 'train_loss': 2.085088109970093, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.76it/s]100%|██████████| 40/40 [00:16<00:00,  2.43it/s]
CLIENT:31
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.63it/s]                                              {'loss': 2.0252, 'grad_norm': 5.047216892242432, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.63it/s]  5%|▌         | 2/40 [00:00<00:14,  2.58it/s]                                              {'loss': 2.1193, 'grad_norm': 3.858419418334961, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:14,  2.58it/s]  8%|▊         | 3/40 [00:01<00:14,  2.56it/s]                                              {'loss': 2.2693, 'grad_norm': 5.467267990112305, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:14,  2.56it/s] 10%|█         | 4/40 [00:01<00:14,  2.54it/s]                                              {'loss': 2.2538, 'grad_norm': 5.306454181671143, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.54it/s] 12%|█▎        | 5/40 [00:01<00:14,  2.46it/s]                                              {'loss': 2.4609, 'grad_norm': 5.633917331695557, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:14,  2.46it/s] 15%|█▌        | 6/40 [00:02<00:14,  2.33it/s]                                              {'loss': 2.2548, 'grad_norm': 4.967851638793945, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:14,  2.33it/s] 18%|█▊        | 7/40 [00:02<00:14,  2.25it/s]                                              {'loss': 2.0697, 'grad_norm': 4.232422351837158, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:14,  2.25it/s] 20%|██        | 8/40 [00:03<00:11,  2.90it/s]                                              {'loss': 2.4232, 'grad_norm': 11.70877742767334, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.90it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.1501, 'grad_norm': 3.9932379722595215, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 1.9696, 'grad_norm': 3.0273406505584717, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.33it/s]                                               {'loss': 1.9663, 'grad_norm': 3.8912463188171387, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.33it/s] 30%|███       | 12/40 [00:04<00:12,  2.25it/s]                                               {'loss': 2.1985, 'grad_norm': 4.230853080749512, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.25it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.24it/s]                                               {'loss': 2.0379, 'grad_norm': 4.424315929412842, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.24it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.19it/s]                                               {'loss': 2.3638, 'grad_norm': 4.921116352081299, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.103, 'grad_norm': 4.744664669036865, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s]                                               {'loss': 1.5953, 'grad_norm': 10.675619125366211, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:11,  2.17it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.63it/s]                                               {'loss': 2.0917, 'grad_norm': 3.394618034362793, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.63it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.51it/s]                                               {'loss': 2.0903, 'grad_norm': 5.030508995056152, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.51it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.41it/s]                                               {'loss': 2.0467, 'grad_norm': 3.577685594558716, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.41it/s] 50%|█████     | 20/40 [00:08<00:08,  2.32it/s]                                               {'loss': 2.0796, 'grad_norm': 3.78305721282959, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.32it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s]                                               {'loss': 2.0102, 'grad_norm': 4.01124906539917, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.21it/s]                                               {'loss': 1.9845, 'grad_norm': 3.3884854316711426, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.21it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.17it/s]                                               {'loss': 2.0852, 'grad_norm': 3.647115707397461, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.17it/s] 60%|██████    | 24/40 [00:09<00:05,  2.74it/s]                                               {'loss': 2.3422, 'grad_norm': 14.616353988647461, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.74it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.54it/s]                                               {'loss': 1.933, 'grad_norm': 3.906013011932373, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.54it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.39it/s]                                               {'loss': 2.0438, 'grad_norm': 3.4260809421539307, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.39it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.33it/s]                                               {'loss': 2.0053, 'grad_norm': 2.781933069229126, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.33it/s] 70%|███████   | 28/40 [00:11<00:05,  2.28it/s]                                               {'loss': 2.3713, 'grad_norm': 3.9756290912628174, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.28it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 1.9726, 'grad_norm': 3.829505681991577, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s]                                               {'loss': 2.0415, 'grad_norm': 3.381828784942627, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.22it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s]                                               {'loss': 1.8503, 'grad_norm': 3.394068717956543, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s] 80%|████████  | 32/40 [00:13<00:02,  2.78it/s]                                               {'loss': 1.1956, 'grad_norm': 13.847577095031738, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.78it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.57it/s]                                               {'loss': 2.1318, 'grad_norm': 3.8345794677734375, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.57it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s]                                               {'loss': 2.0679, 'grad_norm': 3.7183477878570557, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s]                                               {'loss': 2.0633, 'grad_norm': 4.637610912322998, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s]                                               {'loss': 2.0621, 'grad_norm': 3.301448106765747, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.31it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s]                                               {'loss': 1.7735, 'grad_norm': 3.5243654251098633, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.30it/s]                                               {'loss': 2.1385, 'grad_norm': 2.8215701580047607, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.29it/s]                                               {'loss': 1.7304, 'grad_norm': 3.443105697631836, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.29it/s]100%|██████████| 40/40 [00:16<00:00,  2.83it/s]                                               {'loss': 1.866, 'grad_norm': 16.11985969543457, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.83it/s]                                               {'train_runtime': 16.67, 'train_samples_per_second': 33.893, 'train_steps_per_second': 2.4, 'train_loss': 2.0559536784887316, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.83it/s]100%|██████████| 40/40 [00:16<00:00,  2.40it/s]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]                                              {'loss': 2.2778, 'grad_norm': 3.8478775024414062, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]  5%|▌         | 2/40 [00:00<00:17,  2.12it/s]                                              {'loss': 2.0844, 'grad_norm': 3.9684455394744873, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.12it/s]  8%|▊         | 3/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.5024, 'grad_norm': 5.099081993103027, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.12it/s] 10%|█         | 4/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.4258, 'grad_norm': 5.792959213256836, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:17,  2.12it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s]                                              {'loss': 2.0911, 'grad_norm': 3.795497179031372, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.408, 'grad_norm': 4.629812240600586, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 2.3818, 'grad_norm': 3.966597318649292, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s] 20%|██        | 8/40 [00:03<00:11,  2.78it/s]                                              {'loss': 2.2155, 'grad_norm': 12.47590446472168, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.78it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s]                                              {'loss': 2.2855, 'grad_norm': 4.772602081298828, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.53it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.38it/s]                                               {'loss': 2.1472, 'grad_norm': 4.676215648651123, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.38it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.28it/s]                                               {'loss': 2.112, 'grad_norm': 5.0925116539001465, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.28it/s] 30%|███       | 12/40 [00:05<00:12,  2.23it/s]                                               {'loss': 2.1561, 'grad_norm': 4.847886562347412, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.23it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s]                                               {'loss': 2.3738, 'grad_norm': 5.789852142333984, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.21it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.18it/s]                                               {'loss': 2.2544, 'grad_norm': 3.7612998485565186, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.18it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s]                                               {'loss': 2.4294, 'grad_norm': 4.414627552032471, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.16it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 2.0964, 'grad_norm': 21.33950424194336, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s]                                               {'loss': 2.3246, 'grad_norm': 4.420888900756836, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s]                                               {'loss': 2.2313, 'grad_norm': 3.685518741607666, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.52it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s]                                               {'loss': 2.1669, 'grad_norm': 4.780252456665039, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.2531, 'grad_norm': 4.6753692626953125, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.23it/s]                                               {'loss': 2.2262, 'grad_norm': 4.103490352630615, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.23it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.20it/s]                                               {'loss': 1.9184, 'grad_norm': 4.574103832244873, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.20it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s]                                               {'loss': 2.191, 'grad_norm': 3.501926898956299, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.17it/s] 60%|██████    | 24/40 [00:10<00:05,  2.81it/s]                                               {'loss': 2.0275, 'grad_norm': 25.7431583404541, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s]                                               {'loss': 2.2069, 'grad_norm': 3.253965377807617, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.45it/s]                                               {'loss': 2.2241, 'grad_norm': 3.2938175201416016, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.45it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.36it/s]                                               {'loss': 1.9878, 'grad_norm': 3.0845632553100586, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.36it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.1248, 'grad_norm': 3.2182934284210205, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.0773, 'grad_norm': 4.015753269195557, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.2939, 'grad_norm': 3.8997914791107178, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.25it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s]                                               {'loss': 2.173, 'grad_norm': 4.232780933380127, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.23it/s] 80%|████████  | 32/40 [00:13<00:02,  2.77it/s]                                               {'loss': 1.6463, 'grad_norm': 17.536428451538086, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.77it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.56it/s]                                               {'loss': 1.9946, 'grad_norm': 3.6188502311706543, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.56it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s]                                               {'loss': 2.3561, 'grad_norm': 5.5834455490112305, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s]                                               {'loss': 2.0611, 'grad_norm': 4.094521522521973, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s]                                               {'loss': 1.9876, 'grad_norm': 2.985795736312866, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.30it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s]                                               {'loss': 1.9439, 'grad_norm': 3.2339251041412354, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.0944, 'grad_norm': 4.289927959442139, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.21it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.2187, 'grad_norm': 3.77970552444458, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.21it/s]100%|██████████| 40/40 [00:16<00:00,  2.81it/s]                                               {'loss': 2.4136, 'grad_norm': 20.321788787841797, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.81it/s]                                               {'train_runtime': 16.9724, 'train_samples_per_second': 33.289, 'train_steps_per_second': 2.357, 'train_loss': 2.1846134543418883, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.81it/s]100%|██████████| 40/40 [00:16<00:00,  2.36it/s]
CLIENT:11
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]                                              {'loss': 1.9276, 'grad_norm': 3.471353530883789, 'learning_rate': 0.0001464265445104546, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:27,  1.42it/s]  5%|▌         | 2/40 [00:01<00:26,  1.41it/s]                                              {'loss': 2.035, 'grad_norm': 4.1676483154296875, 'learning_rate': 0.00014276588089769324, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:26,  1.41it/s]  8%|▊         | 3/40 [00:01<00:22,  1.66it/s]                                              {'loss': 2.4385, 'grad_norm': 4.410367012023926, 'learning_rate': 0.00013910521728493187, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:22,  1.66it/s] 10%|█         | 4/40 [00:02<00:19,  1.82it/s]                                              {'loss': 2.2623, 'grad_norm': 4.581362247467041, 'learning_rate': 0.00013544455367217053, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:19,  1.82it/s] 12%|█▎        | 5/40 [00:02<00:18,  1.90it/s]                                              {'loss': 2.1743, 'grad_norm': 3.4823479652404785, 'learning_rate': 0.00013178389005940916, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:18,  1.90it/s] 15%|█▌        | 6/40 [00:03<00:17,  1.97it/s]                                              {'loss': 2.1922, 'grad_norm': 3.77060604095459, 'learning_rate': 0.0001281232264466478, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:17,  1.97it/s] 18%|█▊        | 7/40 [00:03<00:16,  2.02it/s]                                              {'loss': 2.3717, 'grad_norm': 3.9691717624664307, 'learning_rate': 0.00012446256283388642, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:16,  2.02it/s] 20%|██        | 8/40 [00:04<00:13,  2.36it/s]                                              {'loss': 2.147, 'grad_norm': 11.612281799316406, 'learning_rate': 0.00012080189922112505, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:13,  2.36it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.26it/s]                                              {'loss': 1.9215, 'grad_norm': 3.111677646636963, 'learning_rate': 0.00011714123560836369, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.26it/s] 25%|██▌       | 10/40 [00:05<00:13,  2.19it/s]                                               {'loss': 1.9779, 'grad_norm': 2.8244481086730957, 'learning_rate': 0.00011348057199560232, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:13,  2.19it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.14it/s]                                               {'loss': 2.2069, 'grad_norm': 3.158160448074341, 'learning_rate': 0.00010981990838284097, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.14it/s] 30%|███       | 12/40 [00:06<00:13,  2.12it/s]                                               {'loss': 2.0494, 'grad_norm': 3.4579482078552246, 'learning_rate': 0.0001061592447700796, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:13,  2.12it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.13it/s]                                               {'loss': 2.2492, 'grad_norm': 5.320992469787598, 'learning_rate': 0.00010249858115731823, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.13it/s] 35%|███▌      | 14/40 [00:06<00:12,  2.12it/s]                                               {'loss': 1.9515, 'grad_norm': 3.420647621154785, 'learning_rate': 9.883791754455687e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:12,  2.12it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.11it/s]                                               {'loss': 2.2061, 'grad_norm': 3.1691675186157227, 'learning_rate': 9.51772539317955e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.11it/s]                                               {'loss': 1.9883, 'grad_norm': 15.713958740234375, 'learning_rate': 9.151659031903413e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:11,  2.11it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.1677, 'grad_norm': 3.4183595180511475, 'learning_rate': 8.785592670627276e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:08<00:08,  2.47it/s]                                               {'loss': 1.9865, 'grad_norm': 2.8321051597595215, 'learning_rate': 8.419526309351139e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.0537, 'grad_norm': 2.917513370513916, 'learning_rate': 8.053459948075005e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s] 50%|█████     | 20/40 [00:09<00:08,  2.28it/s]                                               {'loss': 2.1418, 'grad_norm': 5.114934921264648, 'learning_rate': 7.687393586798868e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.28it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.24it/s]                                               {'loss': 1.8846, 'grad_norm': 4.3832197189331055, 'learning_rate': 7.32132722552273e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.24it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.21it/s]                                               {'loss': 2.0557, 'grad_norm': 3.3927083015441895, 'learning_rate': 6.955260864246594e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.21it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.18it/s]                                               {'loss': 2.0762, 'grad_norm': 3.6499335765838623, 'learning_rate': 6.589194502970458e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.18it/s] 60%|██████    | 24/40 [00:10<00:05,  2.77it/s]                                               {'loss': 1.8083, 'grad_norm': 11.914690017700195, 'learning_rate': 6.223128141694321e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.77it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.57it/s]                                               {'loss': 2.0018, 'grad_norm': 3.131483793258667, 'learning_rate': 5.8570617804181846e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.57it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.44it/s]                                               {'loss': 2.1186, 'grad_norm': 4.120423793792725, 'learning_rate': 5.490995419142048e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.44it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.35it/s]                                               {'loss': 2.1353, 'grad_norm': 3.5086677074432373, 'learning_rate': 5.124929057865911e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.35it/s] 70%|███████   | 28/40 [00:12<00:05,  2.29it/s]                                               {'loss': 2.0172, 'grad_norm': 3.2516801357269287, 'learning_rate': 4.758862696589775e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.29it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.25it/s]                                               {'loss': 2.0184, 'grad_norm': 3.099172830581665, 'learning_rate': 4.392796335313638e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.20it/s]                                               {'loss': 1.9422, 'grad_norm': 3.686908006668091, 'learning_rate': 4.026729974037502e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.20it/s] 78%|███████▊  | 31/40 [00:14<00:04,  2.19it/s]                                               {'loss': 1.9217, 'grad_norm': 3.169339895248413, 'learning_rate': 3.660663612761365e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:04,  2.19it/s] 80%|████████  | 32/40 [00:14<00:02,  2.75it/s]                                               {'loss': 1.5393, 'grad_norm': 9.178475379943848, 'learning_rate': 3.294597251485229e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:02,  2.75it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.50it/s]                                               {'loss': 2.0096, 'grad_norm': 3.2517151832580566, 'learning_rate': 2.9285308902090923e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.50it/s] 85%|████████▌ | 34/40 [00:15<00:02,  2.35it/s]                                               {'loss': 1.886, 'grad_norm': 4.48225736618042, 'learning_rate': 2.5624645289329557e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:15<00:02,  2.35it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.25it/s]                                               {'loss': 1.9958, 'grad_norm': 3.7672665119171143, 'learning_rate': 2.196398167656819e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.25it/s] 90%|█████████ | 36/40 [00:16<00:01,  2.19it/s]                                               {'loss': 1.8329, 'grad_norm': 2.724923610687256, 'learning_rate': 1.8303318063806827e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:16<00:01,  2.19it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.17it/s]                                               {'loss': 2.0239, 'grad_norm': 3.6531920433044434, 'learning_rate': 1.4642654451045462e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.17it/s] 95%|█████████▌| 38/40 [00:17<00:00,  2.15it/s]                                               {'loss': 2.2321, 'grad_norm': 4.981656551361084, 'learning_rate': 1.0981990838284095e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:17<00:00,  2.15it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.13it/s]                                               {'loss': 1.9898, 'grad_norm': 3.2795116901397705, 'learning_rate': 7.321327225522731e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.13it/s]                                               {'loss': 1.9427, 'grad_norm': 12.315011978149414, 'learning_rate': 3.6606636127613654e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.13it/s]                                               {'train_runtime': 17.8731, 'train_samples_per_second': 31.612, 'train_steps_per_second': 2.238, 'train_loss': 2.0470272839069366, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.13it/s]100%|██████████| 40/40 [00:17<00:00,  2.24it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:54,  8.55it/s]  1%|          | 3/471 [00:00<01:04,  7.30it/s]  1%|          | 4/471 [00:00<01:28,  5.30it/s]  1%|          | 5/471 [00:00<01:24,  5.53it/s]  1%|▏         | 6/471 [00:01<01:36,  4.84it/s]  1%|▏         | 7/471 [00:01<01:36,  4.83it/s]  2%|▏         | 8/471 [00:01<01:35,  4.85it/s]  2%|▏         | 9/471 [00:01<01:39,  4.65it/s]  2%|▏         | 10/471 [00:01<01:35,  4.85it/s]  2%|▏         | 11/471 [00:02<01:40,  4.56it/s]  3%|▎         | 12/471 [00:02<01:34,  4.83it/s]  3%|▎         | 13/471 [00:02<01:41,  4.52it/s]  3%|▎         | 14/471 [00:02<01:35,  4.80it/s]  3%|▎         | 15/471 [00:03<01:41,  4.49it/s]  3%|▎         | 16/471 [00:03<01:35,  4.78it/s]  4%|▎         | 17/471 [00:03<01:42,  4.41it/s]  4%|▍         | 18/471 [00:03<01:38,  4.58it/s]  4%|▍         | 19/471 [00:03<01:41,  4.46it/s]  4%|▍         | 20/471 [00:04<01:40,  4.49it/s]  4%|▍         | 21/471 [00:04<01:38,  4.57it/s]  5%|▍         | 22/471 [00:04<01:40,  4.47it/s]  5%|▍         | 23/471 [00:04<01:37,  4.57it/s]  5%|▌         | 24/471 [00:05<01:40,  4.47it/s]  5%|▌         | 25/471 [00:05<01:37,  4.57it/s]  6%|▌         | 26/471 [00:05<01:39,  4.46it/s]  6%|▌         | 27/471 [00:05<01:36,  4.61it/s]  6%|▌         | 28/471 [00:05<01:37,  4.52it/s]  6%|▌         | 29/471 [00:06<01:34,  4.65it/s]  6%|▋         | 30/471 [00:06<01:36,  4.56it/s]  7%|▋         | 31/471 [00:06<01:34,  4.66it/s]  7%|▋         | 32/471 [00:06<01:38,  4.47it/s]  7%|▋         | 33/471 [00:06<01:35,  4.58it/s]  7%|▋         | 34/471 [00:07<01:35,  4.59it/s]  7%|▋         | 35/471 [00:07<01:36,  4.54it/s]  8%|▊         | 36/471 [00:07<01:35,  4.55it/s]  8%|▊         | 37/471 [00:07<01:36,  4.50it/s]  8%|▊         | 38/471 [00:08<01:34,  4.59it/s]  8%|▊         | 39/471 [00:08<01:34,  4.55it/s]  8%|▊         | 40/471 [00:08<01:32,  4.64it/s]  9%|▊         | 41/471 [00:08<01:33,  4.59it/s]  9%|▉         | 42/471 [00:08<01:34,  4.54it/s]  9%|▉         | 43/471 [00:09<01:33,  4.56it/s]  9%|▉         | 44/471 [00:09<01:34,  4.52it/s] 10%|▉         | 45/471 [00:09<01:33,  4.55it/s] 10%|▉         | 46/471 [00:09<01:34,  4.51it/s] 10%|▉         | 47/471 [00:10<01:34,  4.50it/s] 10%|█         | 48/471 [00:10<01:33,  4.54it/s] 10%|█         | 49/471 [00:10<01:32,  4.57it/s] 11%|█         | 50/471 [00:10<01:32,  4.55it/s] 11%|█         | 51/471 [00:10<01:32,  4.56it/s] 11%|█         | 52/471 [00:11<01:33,  4.49it/s] 11%|█▏        | 53/471 [00:11<01:32,  4.54it/s] 11%|█▏        | 54/471 [00:11<01:31,  4.57it/s] 12%|█▏        | 55/471 [00:11<01:31,  4.57it/s] 12%|█▏        | 56/471 [00:12<01:29,  4.62it/s] 12%|█▏        | 57/471 [00:12<01:32,  4.50it/s] 12%|█▏        | 58/471 [00:12<01:29,  4.61it/s] 13%|█▎        | 59/471 [00:12<01:32,  4.46it/s] 13%|█▎        | 60/471 [00:12<01:29,  4.57it/s] 13%|█▎        | 61/471 [00:13<01:32,  4.44it/s] 13%|█▎        | 62/471 [00:13<01:27,  4.65it/s] 13%|█▎        | 63/471 [00:13<01:31,  4.48it/s] 14%|█▎        | 64/471 [00:13<01:26,  4.68it/s] 14%|█▍        | 65/471 [00:14<01:31,  4.41it/s] 14%|█▍        | 66/471 [00:14<01:27,  4.62it/s] 14%|█▍        | 67/471 [00:14<01:30,  4.45it/s] 14%|█▍        | 68/471 [00:14<01:27,  4.60it/s] 15%|█▍        | 69/471 [00:14<01:27,  4.58it/s] 15%|█▍        | 70/471 [00:15<01:28,  4.54it/s] 15%|█▌        | 71/471 [00:15<01:25,  4.66it/s] 15%|█▌        | 72/471 [00:15<01:27,  4.54it/s] 15%|█▌        | 73/471 [00:15<01:24,  4.69it/s] 16%|█▌        | 74/471 [00:16<01:28,  4.47it/s] 16%|█▌        | 75/471 [00:16<01:24,  4.68it/s] 16%|█▌        | 76/471 [00:16<01:27,  4.50it/s] 16%|█▋        | 77/471 [00:16<01:23,  4.73it/s] 17%|█▋        | 78/471 [00:16<01:28,  4.45it/s] 17%|█▋        | 79/471 [00:17<01:22,  4.74it/s] 17%|█▋        | 80/471 [00:17<01:27,  4.45it/s] 17%|█▋        | 81/471 [00:17<01:23,  4.67it/s] 17%|█▋        | 82/471 [00:17<01:25,  4.55it/s] 18%|█▊        | 83/471 [00:17<01:25,  4.52it/s] 18%|█▊        | 84/471 [00:18<01:23,  4.66it/s] 18%|█▊        | 85/471 [00:18<01:25,  4.54it/s] 18%|█▊        | 86/471 [00:18<01:22,  4.69it/s] 18%|█▊        | 87/471 [00:18<01:25,  4.48it/s] 19%|█▊        | 88/471 [00:19<01:22,  4.63it/s] 19%|█▉        | 89/471 [00:19<01:25,  4.47it/s] 19%|█▉        | 90/471 [00:19<01:21,  4.69it/s] 19%|█▉        | 91/471 [00:19<01:25,  4.43it/s] 20%|█▉        | 92/471 [00:19<01:20,  4.69it/s] 20%|█▉        | 93/471 [00:20<01:26,  4.38it/s] 20%|█▉        | 94/471 [00:20<01:19,  4.76it/s] 20%|██        | 95/471 [00:20<01:22,  4.58it/s] 20%|██        | 96/471 [00:20<01:22,  4.55it/s] 21%|██        | 97/471 [00:21<01:20,  4.67it/s] 21%|██        | 98/471 [00:21<01:23,  4.49it/s] 21%|██        | 99/471 [00:21<01:18,  4.75it/s] 21%|██        | 100/471 [00:21<01:21,  4.55it/s] 21%|██▏       | 101/471 [00:21<01:18,  4.72it/s] 22%|██▏       | 102/471 [00:22<01:22,  4.48it/s] 22%|██▏       | 103/471 [00:22<01:19,  4.63it/s] 22%|██▏       | 104/471 [00:22<01:22,  4.45it/s] 22%|██▏       | 105/471 [00:22<01:19,  4.60it/s] 23%|██▎       | 106/471 [00:23<01:22,  4.44it/s] 23%|██▎       | 107/471 [00:23<01:19,  4.57it/s] 23%|██▎       | 108/471 [00:23<01:22,  4.40it/s] 23%|██▎       | 109/471 [00:23<01:19,  4.56it/s] 23%|██▎       | 110/471 [00:23<01:19,  4.55it/s] 24%|██▎       | 111/471 [00:24<01:20,  4.50it/s] 24%|██▍       | 112/471 [00:24<01:17,  4.66it/s] 24%|██▍       | 113/471 [00:24<01:20,  4.45it/s] 24%|██▍       | 114/471 [00:24<01:16,  4.67it/s] 24%|██▍       | 115/471 [00:24<01:19,  4.45it/s] 25%|██▍       | 116/471 [00:25<01:15,  4.71it/s] 25%|██▍       | 117/471 [00:25<01:19,  4.43it/s] 25%|██▌       | 118/471 [00:25<01:15,  4.68it/s] 25%|██▌       | 119/471 [00:25<01:19,  4.42it/s] 25%|██▌       | 120/471 [00:26<01:14,  4.72it/s] 26%|██▌       | 121/471 [00:26<01:19,  4.42it/s] 26%|██▌       | 122/471 [00:26<01:15,  4.65it/s] 26%|██▌       | 123/471 [00:26<01:16,  4.54it/s] 26%|██▋       | 124/471 [00:26<01:16,  4.54it/s] 27%|██▋       | 125/471 [00:27<01:15,  4.57it/s] 27%|██▋       | 126/471 [00:27<01:17,  4.47it/s] 27%|██▋       | 127/471 [00:27<01:13,  4.66it/s] 27%|██▋       | 128/471 [00:27<01:16,  4.46it/s] 27%|██▋       | 129/471 [00:28<01:11,  4.79it/s] 28%|██▊       | 130/471 [00:28<01:16,  4.45it/s] 28%|██▊       | 131/471 [00:28<01:12,  4.72it/s] 28%|██▊       | 132/471 [00:28<01:16,  4.44it/s] 28%|██▊       | 133/471 [00:28<01:10,  4.79it/s] 28%|██▊       | 134/471 [00:29<01:15,  4.44it/s] 29%|██▊       | 135/471 [00:29<01:12,  4.65it/s] 29%|██▉       | 136/471 [00:29<01:14,  4.51it/s] 29%|██▉       | 137/471 [00:29<01:13,  4.57it/s] 29%|██▉       | 138/471 [00:30<01:11,  4.63it/s] 30%|██▉       | 139/471 [00:30<01:12,  4.55it/s] 30%|██▉       | 140/471 [00:30<01:10,  4.72it/s] 30%|██▉       | 141/471 [00:30<01:13,  4.48it/s] 30%|███       | 142/471 [00:30<01:09,  4.77it/s] 30%|███       | 143/471 [00:31<01:13,  4.44it/s] 31%|███       | 144/471 [00:31<01:09,  4.72it/s] 31%|███       | 145/471 [00:31<01:14,  4.41it/s] 31%|███       | 146/471 [00:31<01:08,  4.76it/s] 31%|███       | 147/471 [00:31<01:12,  4.49it/s] 31%|███▏      | 148/471 [00:32<01:09,  4.64it/s] 32%|███▏      | 149/471 [00:32<01:10,  4.57it/s] 32%|███▏      | 150/471 [00:32<01:11,  4.50it/s] 32%|███▏      | 151/471 [00:32<01:08,  4.66it/s] 32%|███▏      | 152/471 [00:33<01:09,  4.58it/s] 32%|███▏      | 153/471 [00:33<01:06,  4.75it/s] 33%|███▎      | 154/471 [00:33<01:10,  4.50it/s] 33%|███▎      | 155/471 [00:33<01:05,  4.85it/s] 33%|███▎      | 156/471 [00:33<01:10,  4.48it/s] 33%|███▎      | 157/471 [00:34<01:04,  4.87it/s] 34%|███▎      | 158/471 [00:34<01:09,  4.53it/s] 34%|███▍      | 159/471 [00:34<01:07,  4.65it/s] 34%|███▍      | 160/471 [00:34<01:06,  4.68it/s] 34%|███▍      | 161/471 [00:34<01:07,  4.61it/s] 34%|███▍      | 162/471 [00:35<01:06,  4.68it/s] 35%|███▍      | 163/471 [00:35<01:07,  4.55it/s] 35%|███▍      | 164/471 [00:35<01:06,  4.59it/s] 35%|███▌      | 165/471 [00:35<01:07,  4.51it/s] 35%|███▌      | 166/471 [00:36<01:05,  4.64it/s] 35%|███▌      | 167/471 [00:36<01:07,  4.52it/s] 36%|███▌      | 168/471 [00:36<01:04,  4.70it/s] 36%|███▌      | 169/471 [00:36<01:07,  4.47it/s] 36%|███▌      | 170/471 [00:36<01:04,  4.66it/s] 36%|███▋      | 171/471 [00:37<01:07,  4.44it/s] 37%|███▋      | 172/471 [00:37<01:06,  4.52it/s] 37%|███▋      | 173/471 [00:37<01:06,  4.47it/s] 37%|███▋      | 174/471 [00:37<01:06,  4.43it/s] 37%|███▋      | 175/471 [00:38<01:03,  4.64it/s] 37%|███▋      | 176/471 [00:38<01:05,  4.51it/s] 38%|███▊      | 177/471 [00:38<01:03,  4.61it/s] 38%|███▊      | 178/471 [00:38<01:04,  4.57it/s] 38%|███▊      | 179/471 [00:38<01:03,  4.61it/s] 38%|███▊      | 180/471 [00:39<01:03,  4.61it/s] 38%|███▊      | 181/471 [00:39<01:02,  4.64it/s] 39%|███▊      | 182/471 [00:39<01:03,  4.57it/s] 39%|███▉      | 183/471 [00:39<01:01,  4.66it/s] 39%|███▉      | 184/471 [00:40<01:02,  4.57it/s] 39%|███▉      | 185/471 [00:40<01:02,  4.55it/s] 39%|███▉      | 186/471 [00:40<01:03,  4.51it/s] 40%|███▉      | 187/471 [00:40<01:04,  4.43it/s] 40%|███▉      | 188/471 [00:40<01:02,  4.55it/s] 40%|████      | 189/471 [00:41<01:03,  4.45it/s] 40%|████      | 190/471 [00:41<01:00,  4.68it/s] 41%|████      | 191/471 [00:41<01:00,  4.61it/s] 41%|████      | 192/471 [00:41<01:00,  4.61it/s] 41%|████      | 193/471 [00:41<00:59,  4.64it/s] 41%|████      | 194/471 [00:42<01:01,  4.53it/s] 41%|████▏     | 195/471 [00:42<00:59,  4.61it/s] 42%|████▏     | 196/471 [00:42<01:01,  4.49it/s] 42%|████▏     | 197/471 [00:42<01:00,  4.56it/s] 42%|████▏     | 198/471 [00:43<01:00,  4.48it/s] 42%|████▏     | 199/471 [00:43<00:59,  4.55it/s] 42%|████▏     | 200/471 [00:43<01:01,  4.44it/s] 43%|████▎     | 201/471 [00:43<00:58,  4.62it/s] 43%|████▎     | 202/471 [00:43<01:00,  4.46it/s] 43%|████▎     | 203/471 [00:44<00:57,  4.63it/s] 43%|████▎     | 204/471 [00:44<01:00,  4.44it/s] 44%|████▎     | 205/471 [00:44<00:58,  4.57it/s] 44%|████▎     | 206/471 [00:44<00:59,  4.48it/s] 44%|████▍     | 207/471 [00:45<00:57,  4.56it/s] 44%|████▍     | 208/471 [00:45<00:58,  4.48it/s] 44%|████▍     | 209/471 [00:45<00:57,  4.54it/s] 45%|████▍     | 210/471 [00:45<00:58,  4.43it/s] 45%|████▍     | 211/471 [00:45<00:57,  4.51it/s] 45%|████▌     | 212/471 [00:46<00:58,  4.45it/s] 45%|████▌     | 213/471 [00:46<00:57,  4.48it/s] 45%|████▌     | 214/471 [00:46<00:57,  4.48it/s] 46%|████▌     | 215/471 [00:46<00:58,  4.41it/s] 46%|████▌     | 216/471 [00:47<00:54,  4.68it/s] 46%|████▌     | 217/471 [00:47<00:56,  4.46it/s] 46%|████▋     | 218/471 [00:47<00:53,  4.73it/s] 46%|████▋     | 219/471 [00:47<00:57,  4.42it/s] 47%|████▋     | 220/471 [00:47<00:53,  4.73it/s] 47%|████▋     | 221/471 [00:48<00:56,  4.45it/s] 47%|████▋     | 222/471 [00:48<00:52,  4.72it/s] 47%|████▋     | 223/471 [00:48<00:55,  4.49it/s] 48%|████▊     | 224/471 [00:48<00:53,  4.64it/s] 48%|████▊     | 225/471 [00:49<00:53,  4.56it/s] 48%|████▊     | 226/471 [00:49<00:53,  4.56it/s] 48%|████▊     | 227/471 [00:49<00:53,  4.53it/s] 48%|████▊     | 228/471 [00:49<00:54,  4.49it/s] 49%|████▊     | 229/471 [00:49<00:51,  4.69it/s] 49%|████▉     | 230/471 [00:50<00:53,  4.47it/s] 49%|████▉     | 231/471 [00:50<00:49,  4.80it/s] 49%|████▉     | 232/471 [00:50<00:53,  4.46it/s] 49%|████▉     | 233/471 [00:50<00:49,  4.84it/s] 50%|████▉     | 234/471 [00:51<00:53,  4.47it/s] 50%|████▉     | 235/471 [00:51<00:49,  4.75it/s] 50%|█████     | 236/471 [00:51<00:50,  4.68it/s] 50%|█████     | 237/471 [00:51<00:51,  4.56it/s] 51%|█████     | 238/471 [00:51<00:49,  4.71it/s] 51%|█████     | 239/471 [00:52<00:51,  4.52it/s] 51%|█████     | 240/471 [00:52<00:50,  4.57it/s] 51%|█████     | 241/471 [00:52<00:51,  4.49it/s] 51%|█████▏    | 242/471 [00:52<00:49,  4.65it/s] 52%|█████▏    | 243/471 [00:52<00:51,  4.46it/s] 52%|█████▏    | 244/471 [00:53<00:49,  4.62it/s] 52%|█████▏    | 245/471 [00:53<00:51,  4.41it/s] 52%|█████▏    | 246/471 [00:53<00:48,  4.61it/s] 52%|█████▏    | 247/471 [00:53<00:50,  4.41it/s] 53%|█████▎    | 248/471 [00:54<00:48,  4.60it/s] 53%|█████▎    | 249/471 [00:54<00:49,  4.45it/s] 53%|█████▎    | 250/471 [00:54<00:49,  4.47it/s] 53%|█████▎    | 251/471 [00:54<00:48,  4.52it/s] 54%|█████▎    | 252/471 [00:54<00:49,  4.44it/s] 54%|█████▎    | 253/471 [00:55<00:46,  4.64it/s] 54%|█████▍    | 254/471 [00:55<00:48,  4.45it/s] 54%|█████▍    | 255/471 [00:55<00:46,  4.67it/s] 54%|█████▍    | 256/471 [00:55<00:47,  4.50it/s] 55%|█████▍    | 257/471 [00:56<00:45,  4.71it/s] 55%|█████▍    | 258/471 [00:56<00:48,  4.41it/s] 55%|█████▍    | 259/471 [00:56<00:45,  4.69it/s] 55%|█████▌    | 260/471 [00:56<00:48,  4.38it/s] 55%|█████▌    | 261/471 [00:56<00:43,  4.79it/s] 56%|█████▌    | 262/471 [00:57<00:47,  4.39it/s] 56%|█████▌    | 263/471 [00:57<00:45,  4.61it/s] 56%|█████▌    | 264/471 [00:57<00:45,  4.53it/s] 56%|█████▋    | 265/471 [00:57<00:45,  4.50it/s] 56%|█████▋    | 266/471 [00:58<00:44,  4.59it/s] 57%|█████▋    | 267/471 [00:58<00:45,  4.49it/s] 57%|█████▋    | 268/471 [00:58<00:43,  4.68it/s] 57%|█████▋    | 269/471 [00:58<00:44,  4.52it/s] 57%|█████▋    | 270/471 [00:58<00:41,  4.79it/s] 58%|█████▊    | 271/471 [00:59<00:43,  4.56it/s] 58%|█████▊    | 272/471 [00:59<00:41,  4.85it/s] 58%|█████▊    | 273/471 [00:59<00:44,  4.47it/s] 58%|█████▊    | 274/471 [00:59<00:40,  4.82it/s] 58%|█████▊    | 275/471 [00:59<00:43,  4.53it/s] 59%|█████▊    | 276/471 [01:00<00:42,  4.59it/s] 59%|█████▉    | 277/471 [01:00<00:40,  4.76it/s] 59%|█████▉    | 278/471 [01:00<00:42,  4.59it/s] 59%|█████▉    | 279/471 [01:00<00:39,  4.81it/s] 59%|█████▉    | 280/471 [01:01<00:42,  4.54it/s] 60%|█████▉    | 281/471 [01:01<00:39,  4.82it/s] 60%|█████▉    | 282/471 [01:01<00:41,  4.51it/s] 60%|██████    | 283/471 [01:01<00:38,  4.87it/s] 60%|██████    | 284/471 [01:01<00:41,  4.53it/s] 61%|██████    | 285/471 [01:02<00:39,  4.71it/s] 61%|██████    | 286/471 [01:02<00:41,  4.48it/s] 61%|██████    | 287/471 [01:02<00:40,  4.59it/s] 61%|██████    | 288/471 [01:02<00:40,  4.56it/s] 61%|██████▏   | 289/471 [01:03<00:40,  4.52it/s] 62%|██████▏   | 290/471 [01:03<00:38,  4.70it/s] 62%|██████▏   | 291/471 [01:03<00:40,  4.48it/s] 62%|██████▏   | 292/471 [01:03<00:37,  4.81it/s] 62%|██████▏   | 293/471 [01:03<00:39,  4.53it/s] 62%|██████▏   | 294/471 [01:04<00:36,  4.86it/s] 63%|██████▎   | 295/471 [01:04<00:39,  4.49it/s] 63%|██████▎   | 296/471 [01:04<00:36,  4.79it/s] 63%|██████▎   | 297/471 [01:04<00:38,  4.54it/s] 63%|██████▎   | 298/471 [01:04<00:37,  4.60it/s] 63%|██████▎   | 299/471 [01:05<00:37,  4.64it/s] 64%|██████▎   | 300/471 [01:05<00:37,  4.55it/s] 64%|██████▍   | 301/471 [01:05<00:35,  4.74it/s] 64%|██████▍   | 302/471 [01:05<00:35,  4.70it/s] 64%|██████▍   | 303/471 [01:06<00:35,  4.69it/s] 65%|██████▍   | 304/471 [01:06<00:36,  4.55it/s] 65%|██████▍   | 305/471 [01:06<00:35,  4.65it/s] 65%|██████▍   | 306/471 [01:06<00:36,  4.48it/s] 65%|██████▌   | 307/471 [01:06<00:34,  4.76it/s] 65%|██████▌   | 308/471 [01:07<00:36,  4.43it/s] 66%|██████▌   | 309/471 [01:07<00:34,  4.66it/s] 66%|██████▌   | 310/471 [01:07<00:36,  4.43it/s] 66%|██████▌   | 311/471 [01:07<00:34,  4.61it/s] 66%|██████▌   | 312/471 [01:08<00:35,  4.49it/s] 66%|██████▋   | 313/471 [01:08<00:34,  4.55it/s] 67%|██████▋   | 314/471 [01:08<00:35,  4.48it/s] 67%|██████▋   | 315/471 [01:08<00:34,  4.54it/s] 67%|██████▋   | 316/471 [01:08<00:33,  4.56it/s] 67%|██████▋   | 317/471 [01:09<00:32,  4.77it/s] 68%|██████▊   | 318/471 [01:09<00:31,  4.89it/s] 68%|██████▊   | 319/471 [01:09<00:30,  4.93it/s] 68%|██████▊   | 320/471 [01:09<00:29,  5.21it/s] 68%|██████▊   | 321/471 [01:09<00:29,  5.10it/s] 68%|██████▊   | 322/471 [01:09<00:27,  5.48it/s] 69%|██████▊   | 323/471 [01:10<00:28,  5.27it/s] 69%|██████▉   | 324/471 [01:10<00:26,  5.53it/s] 69%|██████▉   | 325/471 [01:10<00:27,  5.26it/s] 69%|██████▉   | 326/471 [01:10<00:26,  5.52it/s] 69%|██████▉   | 327/471 [01:10<00:27,  5.23it/s] 70%|██████▉   | 328/471 [01:11<00:26,  5.45it/s] 70%|██████▉   | 329/471 [01:11<00:27,  5.22it/s] 70%|███████   | 330/471 [01:11<00:26,  5.39it/s] 70%|███████   | 331/471 [01:11<00:26,  5.34it/s] 70%|███████   | 332/471 [01:11<00:24,  5.64it/s] 71%|███████   | 333/471 [01:12<00:24,  5.58it/s] 71%|███████   | 334/471 [01:12<00:25,  5.43it/s] 71%|███████   | 335/471 [01:12<00:23,  5.69it/s] 71%|███████▏  | 336/471 [01:12<00:24,  5.41it/s] 72%|███████▏  | 337/471 [01:12<00:23,  5.72it/s] 72%|███████▏  | 338/471 [01:12<00:24,  5.40it/s] 72%|███████▏  | 339/471 [01:13<00:23,  5.72it/s] 72%|███████▏  | 340/471 [01:13<00:24,  5.37it/s] 72%|███████▏  | 341/471 [01:13<00:23,  5.52it/s] 73%|███████▎  | 342/471 [01:13<00:24,  5.33it/s] 73%|███████▎  | 343/471 [01:13<00:23,  5.35it/s] 73%|███████▎  | 344/471 [01:14<00:23,  5.41it/s] 73%|███████▎  | 345/471 [01:14<00:23,  5.37it/s] 73%|███████▎  | 346/471 [01:14<00:22,  5.55it/s] 74%|███████▎  | 347/471 [01:14<00:23,  5.32it/s] 74%|███████▍  | 348/471 [01:14<00:21,  5.68it/s] 74%|███████▍  | 349/471 [01:15<00:24,  4.95it/s] 74%|███████▍  | 350/471 [01:15<00:22,  5.31it/s] 75%|███████▍  | 351/471 [01:15<00:24,  4.81it/s] 75%|███████▍  | 352/471 [01:15<00:24,  4.81it/s] 75%|███████▍  | 353/471 [01:15<00:24,  4.86it/s] 75%|███████▌  | 354/471 [01:16<00:25,  4.66it/s] 75%|███████▌  | 355/471 [01:16<00:23,  4.87it/s] 76%|███████▌  | 356/471 [01:16<00:25,  4.58it/s] 76%|███████▌  | 357/471 [01:16<00:23,  4.83it/s] 76%|███████▌  | 358/471 [01:16<00:25,  4.52it/s] 76%|███████▌  | 359/471 [01:17<00:23,  4.79it/s] 76%|███████▋  | 360/471 [01:17<00:24,  4.47it/s] 77%|███████▋  | 361/471 [01:17<00:23,  4.78it/s] 77%|███████▋  | 362/471 [01:17<00:24,  4.43it/s] 77%|███████▋  | 363/471 [01:17<00:23,  4.63it/s] 77%|███████▋  | 364/471 [01:18<00:23,  4.56it/s] 77%|███████▋  | 365/471 [01:18<00:23,  4.49it/s] 78%|███████▊  | 366/471 [01:18<00:22,  4.77it/s] 78%|███████▊  | 367/471 [01:18<00:23,  4.52it/s] 78%|███████▊  | 368/471 [01:19<00:20,  4.95it/s] 78%|███████▊  | 369/471 [01:19<00:22,  4.54it/s] 79%|███████▊  | 370/471 [01:19<00:20,  4.81it/s] 79%|███████▉  | 371/471 [01:19<00:22,  4.50it/s] 79%|███████▉  | 372/471 [01:19<00:20,  4.73it/s] 79%|███████▉  | 373/471 [01:20<00:22,  4.42it/s] 79%|███████▉  | 374/471 [01:20<00:21,  4.59it/s] 80%|███████▉  | 375/471 [01:20<00:21,  4.50it/s] 80%|███████▉  | 376/471 [01:20<00:21,  4.49it/s] 80%|████████  | 377/471 [01:21<00:20,  4.57it/s] 80%|████████  | 378/471 [01:21<00:19,  4.72it/s] 80%|████████  | 379/471 [01:21<00:18,  5.11it/s] 81%|████████  | 380/471 [01:21<00:18,  4.95it/s] 81%|████████  | 381/471 [01:21<00:16,  5.46it/s] 81%|████████  | 382/471 [01:21<00:17,  5.16it/s] 81%|████████▏ | 383/471 [01:22<00:15,  5.58it/s] 82%|████████▏ | 384/471 [01:22<00:16,  5.40it/s] 82%|████████▏ | 385/471 [01:22<00:16,  5.31it/s] 82%|████████▏ | 386/471 [01:22<00:14,  5.73it/s] 82%|████████▏ | 387/471 [01:22<00:15,  5.42it/s] 82%|████████▏ | 388/471 [01:23<00:14,  5.84it/s] 83%|████████▎ | 389/471 [01:23<00:15,  5.40it/s] 83%|████████▎ | 390/471 [01:23<00:14,  5.73it/s] 83%|████████▎ | 391/471 [01:23<00:15,  5.11it/s] 83%|████████▎ | 392/471 [01:23<00:15,  4.97it/s] 83%|████████▎ | 393/471 [01:24<00:16,  4.83it/s] 84%|████████▎ | 394/471 [01:24<00:16,  4.65it/s] 84%|████████▍ | 395/471 [01:24<00:15,  4.79it/s] 84%|████████▍ | 396/471 [01:24<00:16,  4.67it/s] 84%|████████▍ | 397/471 [01:24<00:15,  4.82it/s] 85%|████████▍ | 398/471 [01:25<00:16,  4.56it/s] 85%|████████▍ | 399/471 [01:25<00:14,  4.87it/s] 85%|████████▍ | 400/471 [01:25<00:15,  4.49it/s] 85%|████████▌ | 401/471 [01:25<00:14,  4.86it/s] 85%|████████▌ | 402/471 [01:26<00:15,  4.46it/s] 86%|████████▌ | 403/471 [01:26<00:14,  4.62it/s] 86%|████████▌ | 404/471 [01:26<00:14,  4.62it/s] 86%|████████▌ | 405/471 [01:26<00:14,  4.53it/s] 86%|████████▌ | 406/471 [01:26<00:13,  4.74it/s] 86%|████████▋ | 407/471 [01:27<00:13,  4.58it/s] 87%|████████▋ | 408/471 [01:27<00:13,  4.70it/s] 87%|████████▋ | 409/471 [01:27<00:13,  4.51it/s] 87%|████████▋ | 410/471 [01:27<00:12,  4.78it/s] 87%|████████▋ | 411/471 [01:27<00:13,  4.49it/s] 87%|████████▋ | 412/471 [01:28<00:12,  4.76it/s] 88%|████████▊ | 413/471 [01:28<00:13,  4.42it/s] 88%|████████▊ | 414/471 [01:28<00:12,  4.72it/s] 88%|████████▊ | 415/471 [01:28<00:12,  4.46it/s] 88%|████████▊ | 416/471 [01:29<00:12,  4.57it/s] 89%|████████▊ | 417/471 [01:29<00:11,  4.57it/s] 89%|████████▊ | 418/471 [01:29<00:11,  4.48it/s] 89%|████████▉ | 419/471 [01:29<00:10,  4.76it/s] 89%|████████▉ | 420/471 [01:29<00:11,  4.52it/s] 89%|████████▉ | 421/471 [01:30<00:10,  4.79it/s] 90%|████████▉ | 422/471 [01:30<00:10,  4.56it/s] 90%|████████▉ | 423/471 [01:30<00:09,  4.82it/s] 90%|█████████ | 424/471 [01:30<00:10,  4.51it/s] 90%|█████████ | 425/471 [01:30<00:09,  4.80it/s] 90%|█████████ | 426/471 [01:31<00:10,  4.43it/s] 91%|█████████ | 427/471 [01:31<00:09,  4.62it/s] 91%|█████████ | 428/471 [01:31<00:09,  4.54it/s] 91%|█████████ | 429/471 [01:31<00:09,  4.51it/s] 91%|█████████▏| 430/471 [01:32<00:08,  4.74it/s] 92%|█████████▏| 431/471 [01:32<00:08,  4.50it/s] 92%|█████████▏| 432/471 [01:32<00:07,  4.88it/s] 92%|█████████▏| 433/471 [01:32<00:08,  4.50it/s] 92%|█████████▏| 434/471 [01:32<00:07,  4.84it/s] 92%|█████████▏| 435/471 [01:33<00:08,  4.48it/s] 93%|█████████▎| 436/471 [01:33<00:07,  4.80it/s] 93%|█████████▎| 437/471 [01:33<00:07,  4.56it/s] 93%|█████████▎| 438/471 [01:33<00:07,  4.59it/s] 93%|█████████▎| 439/471 [01:34<00:07,  4.56it/s] 93%|█████████▎| 440/471 [01:34<00:06,  4.47it/s] 94%|█████████▎| 441/471 [01:34<00:06,  4.62it/s] 94%|█████████▍| 442/471 [01:34<00:06,  4.55it/s] 94%|█████████▍| 443/471 [01:34<00:05,  4.72it/s] 94%|█████████▍| 444/471 [01:35<00:05,  4.51it/s] 94%|█████████▍| 445/471 [01:35<00:05,  4.83it/s] 95%|█████████▍| 446/471 [01:35<00:05,  4.57it/s] 95%|█████████▍| 447/471 [01:35<00:04,  5.10it/s] 95%|█████████▌| 448/471 [01:35<00:04,  4.87it/s] 95%|█████████▌| 449/471 [01:36<00:04,  5.17it/s] 96%|█████████▌| 450/471 [01:36<00:03,  5.27it/s] 96%|█████████▌| 451/471 [01:36<00:03,  5.23it/s] 96%|█████████▌| 452/471 [01:36<00:03,  5.61it/s] 96%|█████████▌| 453/471 [01:36<00:03,  5.34it/s] 96%|█████████▋| 454/471 [01:36<00:02,  5.71it/s] 97%|█████████▋| 455/471 [01:37<00:02,  5.37it/s] 97%|█████████▋| 456/471 [01:37<00:02,  5.63it/s] 97%|█████████▋| 457/471 [01:37<00:02,  5.48it/s] 97%|█████████▋| 458/471 [01:37<00:02,  5.37it/s] 97%|█████████▋| 459/471 [01:37<00:02,  5.65it/s] 98%|█████████▊| 460/471 [01:38<00:02,  5.45it/s] 98%|█████████▊| 461/471 [01:38<00:01,  5.20it/s] 98%|█████████▊| 462/471 [01:38<00:01,  4.86it/s] 98%|█████████▊| 463/471 [01:38<00:01,  5.27it/s] 99%|█████████▊| 464/471 [01:38<00:01,  4.95it/s] 99%|█████████▊| 465/471 [01:39<00:01,  5.30it/s] 99%|█████████▉| 466/471 [01:39<00:01,  4.98it/s] 99%|█████████▉| 467/471 [01:39<00:00,  4.88it/s] 99%|█████████▉| 468/471 [01:39<00:00,  4.78it/s]100%|█████████▉| 469/471 [01:39<00:00,  4.61it/s]100%|█████████▉| 470/471 [01:40<00:00,  4.94it/s]100%|██████████| 471/471 [01:40<00:00,  4.91it/s]100%|██████████| 471/471 [01:40<00:00,  4.69it/s]
{'eval_loss': 2.1017987728118896, 'eval_model_preparation_time': 0.0043, 'eval_acc': 0.46654275092936803, 'eval_runtime': 100.5252, 'eval_samples_per_second': 74.926, 'eval_steps_per_second': 4.685}
ROUND:12
CLIENT:80
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.10it/s]                                              {'loss': 2.1863, 'grad_norm': 6.303117275238037, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.10it/s]  5%|▌         | 2/40 [00:00<00:17,  2.12it/s]                                              {'loss': 2.1235, 'grad_norm': 3.5585336685180664, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.12it/s]  8%|▊         | 3/40 [00:01<00:17,  2.13it/s]                                              {'loss': 2.188, 'grad_norm': 4.8890886306762695, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.13it/s] 10%|█         | 4/40 [00:01<00:17,  2.11it/s]                                              {'loss': 2.2599, 'grad_norm': 6.571560382843018, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:17,  2.11it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.2961, 'grad_norm': 4.236615180969238, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.12it/s] 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s]                                              {'loss': 2.2211, 'grad_norm': 4.150453090667725, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:16,  2.12it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s]                                              {'loss': 2.593, 'grad_norm': 5.113535404205322, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.10it/s] 20%|██        | 8/40 [00:03<00:11,  2.79it/s]                                              {'loss': 1.9175, 'grad_norm': 13.889392852783203, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.79it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.55it/s]                                              {'loss': 2.0097, 'grad_norm': 4.828975677490234, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.55it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s]                                               {'loss': 2.1861, 'grad_norm': 3.7025997638702393, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s]                                               {'loss': 2.256, 'grad_norm': 4.004409313201904, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s] 30%|███       | 12/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.1264, 'grad_norm': 5.073024272918701, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.25it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.22it/s]                                               {'loss': 2.3642, 'grad_norm': 6.3670148849487305, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.22it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.0807, 'grad_norm': 5.861203670501709, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s]                                               {'loss': 2.2453, 'grad_norm': 3.7058634757995605, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.17it/s] 40%|████      | 16/40 [00:06<00:08,  2.78it/s]                                               {'loss': 1.0037, 'grad_norm': 10.466794967651367, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.78it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s]                                               {'loss': 2.2354, 'grad_norm': 4.797703742980957, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.1631, 'grad_norm': 4.883433818817139, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.33it/s]                                               {'loss': 2.1439, 'grad_norm': 3.422607898712158, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:09,  2.33it/s] 50%|█████     | 20/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.0548, 'grad_norm': 3.478888750076294, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.28it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s]                                               {'loss': 1.8229, 'grad_norm': 3.682128667831421, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s]                                               {'loss': 2.2898, 'grad_norm': 4.012063503265381, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.21it/s]                                               {'loss': 1.9903, 'grad_norm': 4.144224166870117, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.21it/s] 60%|██████    | 24/40 [00:10<00:05,  2.80it/s]                                               {'loss': 1.853, 'grad_norm': 9.34835147857666, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.80it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s]                                               {'loss': 2.2546, 'grad_norm': 4.556702613830566, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.59it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.45it/s]                                               {'loss': 2.0384, 'grad_norm': 3.6618335247039795, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.45it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.0643, 'grad_norm': 4.104759693145752, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.34it/s] 70%|███████   | 28/40 [00:12<00:05,  2.28it/s]                                               {'loss': 2.1804, 'grad_norm': 4.240248203277588, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.28it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 1.8502, 'grad_norm': 4.156803131103516, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s]                                               {'loss': 1.7568, 'grad_norm': 4.140784740447998, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.23it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s]                                               {'loss': 2.0182, 'grad_norm': 3.875638008117676, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s] 80%|████████  | 32/40 [00:13<00:02,  2.79it/s]                                               {'loss': 3.3119, 'grad_norm': 17.10999298095703, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.79it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.55it/s]                                               {'loss': 1.9372, 'grad_norm': 3.9045939445495605, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.55it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.39it/s]                                               {'loss': 2.1163, 'grad_norm': 3.905195474624634, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.39it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.30it/s]                                               {'loss': 2.1079, 'grad_norm': 4.850629806518555, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.30it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.23it/s]                                               {'loss': 1.9707, 'grad_norm': 3.889491081237793, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.23it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.19it/s]                                               {'loss': 1.8473, 'grad_norm': 3.2750587463378906, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.19it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.17it/s]                                               {'loss': 2.1091, 'grad_norm': 4.437561511993408, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.17it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.14it/s]                                               {'loss': 1.9608, 'grad_norm': 3.4258346557617188, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.14it/s]100%|██████████| 40/40 [00:17<00:00,  2.76it/s]                                               {'loss': 1.2294, 'grad_norm': 7.426070690155029, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.76it/s]                                               {'train_runtime': 17.1148, 'train_samples_per_second': 33.012, 'train_steps_per_second': 2.337, 'train_loss': 2.084102523326874, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.76it/s]100%|██████████| 40/40 [00:17<00:00,  2.34it/s]
CLIENT:84
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]                                              {'loss': 1.8235, 'grad_norm': 3.26385760307312, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.15it/s]  5%|▌         | 2/40 [00:00<00:17,  2.16it/s]                                              {'loss': 2.2198, 'grad_norm': 3.8066437244415283, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.16it/s]  8%|▊         | 3/40 [00:01<00:17,  2.14it/s]                                              {'loss': 2.0364, 'grad_norm': 4.095139503479004, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.14it/s] 10%|█         | 4/40 [00:01<00:16,  2.13it/s]                                              {'loss': 2.223, 'grad_norm': 6.556457042694092, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.13it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s]                                              {'loss': 1.9189, 'grad_norm': 4.301808834075928, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s]                                              {'loss': 2.4517, 'grad_norm': 5.74776554107666, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.15it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.13it/s]                                              {'loss': 2.1274, 'grad_norm': 4.551392555236816, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.13it/s] 20%|██        | 8/40 [00:03<00:11,  2.74it/s]                                              {'loss': 0.8967, 'grad_norm': 7.383059024810791, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.74it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.51it/s]                                              {'loss': 2.3505, 'grad_norm': 3.398695230484009, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.51it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.36it/s]                                               {'loss': 2.0167, 'grad_norm': 3.946547269821167, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.36it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.29it/s]                                               {'loss': 1.8835, 'grad_norm': 3.808332681655884, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.29it/s] 30%|███       | 12/40 [00:05<00:12,  2.26it/s]                                               {'loss': 2.0338, 'grad_norm': 4.626996040344238, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s]                                               {'loss': 1.7453, 'grad_norm': 2.833836555480957, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.23it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.23, 'grad_norm': 3.7079198360443115, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s]                                               {'loss': 1.9599, 'grad_norm': 4.1258015632629395, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.19it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 1.5504, 'grad_norm': 7.705305576324463, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.0004, 'grad_norm': 4.52037239074707, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 1.9996, 'grad_norm': 3.4949285984039307, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s]                                               {'loss': 2.069, 'grad_norm': 5.12441349029541, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.29it/s]                                               {'loss': 1.9897, 'grad_norm': 7.317021369934082, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.29it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.23it/s]                                               {'loss': 1.9504, 'grad_norm': 4.202554225921631, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.23it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.21it/s]                                               {'loss': 1.9148, 'grad_norm': 3.5622127056121826, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.21it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.20it/s]                                               {'loss': 1.9008, 'grad_norm': 3.287259101867676, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.20it/s] 60%|██████    | 24/40 [00:10<00:05,  2.78it/s]                                               {'loss': 1.9358, 'grad_norm': 21.96530532836914, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.78it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.54it/s]                                               {'loss': 1.7724, 'grad_norm': 3.4683308601379395, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.54it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.39it/s]                                               {'loss': 1.9939, 'grad_norm': 3.877211332321167, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.39it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.30it/s]                                               {'loss': 1.809, 'grad_norm': 3.832249164581299, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.30it/s] 70%|███████   | 28/40 [00:12<00:05,  2.24it/s]                                               {'loss': 1.9303, 'grad_norm': 3.438863754272461, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.24it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.20it/s]                                               {'loss': 2.0859, 'grad_norm': 3.7257614135742188, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.20it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.18it/s]                                               {'loss': 1.9552, 'grad_norm': 4.544625759124756, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.18it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.16it/s]                                               {'loss': 2.0209, 'grad_norm': 3.611804246902466, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.16it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 2.3462, 'grad_norm': 10.599424362182617, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.57it/s]                                               {'loss': 1.9238, 'grad_norm': 2.992011308670044, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.57it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s]                                               {'loss': 1.7338, 'grad_norm': 3.412836790084839, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s]                                               {'loss': 1.9363, 'grad_norm': 3.380155563354492, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.35it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.29it/s]                                               {'loss': 1.9458, 'grad_norm': 3.349731206893921, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.29it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s]                                               {'loss': 2.0151, 'grad_norm': 3.5100791454315186, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.23it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.20it/s]                                               {'loss': 2.0157, 'grad_norm': 3.941906213760376, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.20it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.17it/s]                                               {'loss': 1.6836, 'grad_norm': 3.0781197547912598, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.17it/s]100%|██████████| 40/40 [00:16<00:00,  2.81it/s]                                               {'loss': 1.7487, 'grad_norm': 11.000991821289062, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.81it/s]                                               {'train_runtime': 17.0608, 'train_samples_per_second': 33.117, 'train_steps_per_second': 2.345, 'train_loss': 1.9536154866218567, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.81it/s]100%|██████████| 40/40 [00:17<00:00,  2.35it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]                                              {'loss': 2.0359, 'grad_norm': 3.4294722080230713, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.32it/s]  5%|▌         | 2/40 [00:01<00:24,  1.57it/s]                                              {'loss': 2.26, 'grad_norm': 6.256097316741943, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.57it/s]  8%|▊         | 3/40 [00:01<00:20,  1.83it/s]                                              {'loss': 2.1761, 'grad_norm': 5.319948673248291, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:20,  1.83it/s] 10%|█         | 4/40 [00:02<00:18,  1.94it/s]                                              {'loss': 2.3916, 'grad_norm': 4.678532600402832, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:18,  1.94it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.01it/s]                                              {'loss': 2.2692, 'grad_norm': 7.108842372894287, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.01it/s] 15%|█▌        | 6/40 [00:03<00:15,  2.21it/s]                                              {'loss': 2.1673, 'grad_norm': 6.02482795715332, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:15,  2.21it/s] 18%|█▊        | 7/40 [00:03<00:13,  2.39it/s]                                              {'loss': 2.2423, 'grad_norm': 4.410168170928955, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:13,  2.39it/s] 20%|██        | 8/40 [00:03<00:14,  2.14it/s]                                              {'loss': 2.5994, 'grad_norm': 25.67819595336914, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.14it/s] 22%|██▎       | 9/40 [00:04<00:13,  2.29it/s]                                              {'loss': 2.1526, 'grad_norm': 4.286550998687744, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:13,  2.29it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.0808, 'grad_norm': 3.4177465438842773, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.40it/s] 28%|██▊       | 11/40 [00:05<00:11,  2.51it/s]                                               {'loss': 2.0174, 'grad_norm': 7.017622947692871, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:11,  2.51it/s] 30%|███       | 12/40 [00:05<00:10,  2.59it/s]                                               {'loss': 2.3316, 'grad_norm': 7.105559349060059, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:10,  2.59it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.66it/s]                                               {'loss': 2.313, 'grad_norm': 4.149672985076904, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.66it/s] 35%|███▌      | 14/40 [00:06<00:09,  2.71it/s]                                               {'loss': 2.0027, 'grad_norm': 3.593536853790283, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:09,  2.71it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.74it/s]                                               {'loss': 2.109, 'grad_norm': 4.503546714782715, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.74it/s] 40%|████      | 16/40 [00:06<00:06,  3.48it/s]                                               {'loss': 2.1017, 'grad_norm': 16.06723976135254, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:06,  3.48it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.29it/s]                                               {'loss': 1.9645, 'grad_norm': 4.067011833190918, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.29it/s] 45%|████▌     | 18/40 [00:07<00:07,  2.83it/s]                                               {'loss': 2.0884, 'grad_norm': 3.875849723815918, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  2.83it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.62it/s]                                               {'loss': 2.0641, 'grad_norm': 3.4646527767181396, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.62it/s] 50%|█████     | 20/40 [00:08<00:07,  2.52it/s]                                               {'loss': 2.0507, 'grad_norm': 3.529029130935669, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:07,  2.52it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.1978, 'grad_norm': 4.449227809906006, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.37it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.33it/s]                                               {'loss': 1.9867, 'grad_norm': 4.2963690757751465, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.33it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s]                                               {'loss': 2.0699, 'grad_norm': 5.4518232345581055, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.27it/s] 60%|██████    | 24/40 [00:09<00:05,  2.88it/s]                                               {'loss': 2.367, 'grad_norm': 16.00933074951172, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.88it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s]                                               {'loss': 1.9925, 'grad_norm': 3.7073967456817627, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.65it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s]                                               {'loss': 2.1649, 'grad_norm': 3.766613721847534, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.48it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s]                                               {'loss': 2.0562, 'grad_norm': 6.436511516571045, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.38it/s] 70%|███████   | 28/40 [00:11<00:05,  2.32it/s]                                               {'loss': 2.2441, 'grad_norm': 3.6399779319763184, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.32it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s]                                               {'loss': 2.1077, 'grad_norm': 4.7153401374816895, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s]                                               {'loss': 1.9975, 'grad_norm': 4.142104625701904, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.27it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s]                                               {'loss': 1.8538, 'grad_norm': 3.8644754886627197, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.22it/s]                                               {'loss': 2.5086, 'grad_norm': 16.714794158935547, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.22it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.78it/s]                                               {'loss': 2.0274, 'grad_norm': 3.324413299560547, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.78it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s]                                               {'loss': 2.0833, 'grad_norm': 4.11400032043457, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.57it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.45it/s]                                               {'loss': 2.0433, 'grad_norm': 3.758948802947998, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.45it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s]                                               {'loss': 2.0661, 'grad_norm': 5.03276252746582, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.42it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s]                                               {'loss': 2.0294, 'grad_norm': 4.492359161376953, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.27it/s]                                               {'loss': 1.8589, 'grad_norm': 4.451858043670654, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.27it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]                                               {'loss': 1.85, 'grad_norm': 4.456843852996826, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]                                               {'loss': 2.1475, 'grad_norm': 16.251529693603516, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.25it/s]                                               {'train_runtime': 16.4833, 'train_samples_per_second': 34.277, 'train_steps_per_second': 2.427, 'train_loss': 2.1267778247594835, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.25it/s]100%|██████████| 40/40 [00:16<00:00,  2.43it/s]
CLIENT:81
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]                                              {'loss': 2.0227, 'grad_norm': 4.219177722930908, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.35it/s]  5%|▌         | 2/40 [00:00<00:16,  2.24it/s]                                              {'loss': 2.0287, 'grad_norm': 7.686252593994141, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.24it/s]  8%|▊         | 3/40 [00:01<00:16,  2.25it/s]                                              {'loss': 2.1719, 'grad_norm': 3.6962735652923584, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.25it/s] 10%|█         | 4/40 [00:01<00:16,  2.24it/s]                                              {'loss': 2.3602, 'grad_norm': 4.136669158935547, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.24it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.23it/s]                                              {'loss': 2.2137, 'grad_norm': 5.522919178009033, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.23it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.25it/s]                                              {'loss': 2.363, 'grad_norm': 5.498997211456299, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.25it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s]                                              {'loss': 2.211, 'grad_norm': 5.224852561950684, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s] 20%|██        | 8/40 [00:03<00:11,  2.85it/s]                                              {'loss': 2.2251, 'grad_norm': 10.110020637512207, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.85it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s]                                              {'loss': 1.8995, 'grad_norm': 4.142134189605713, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.61it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s]                                               {'loss': 2.2311, 'grad_norm': 3.5729243755340576, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.54it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s]                                               {'loss': 2.0929, 'grad_norm': 4.040424346923828, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.38it/s] 30%|███       | 12/40 [00:05<00:12,  2.33it/s]                                               {'loss': 2.0548, 'grad_norm': 5.1790595054626465, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.33it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.0237, 'grad_norm': 3.4911019802093506, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.24it/s]                                               {'loss': 2.263, 'grad_norm': 5.773870944976807, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.24it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.0318, 'grad_norm': 4.607008934020996, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s] 40%|████      | 16/40 [00:06<00:08,  2.83it/s]                                               {'loss': 1.2699, 'grad_norm': 10.136879920959473, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.83it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s]                                               {'loss': 1.9617, 'grad_norm': 3.5988199710845947, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s]                                               {'loss': 1.8347, 'grad_norm': 6.1194539070129395, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.34it/s]                                               {'loss': 2.0891, 'grad_norm': 3.4831061363220215, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.34it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.1706, 'grad_norm': 4.284391403198242, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.26it/s]                                               {'loss': 2.0211, 'grad_norm': 4.132480621337891, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.26it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.22it/s]                                               {'loss': 2.0134, 'grad_norm': 4.1906914710998535, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.22it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s]                                               {'loss': 1.9217, 'grad_norm': 3.7748520374298096, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s] 60%|██████    | 24/40 [00:09<00:05,  2.89it/s]                                               {'loss': 2.0789, 'grad_norm': 51.07889175415039, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.89it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s]                                               {'loss': 1.9955, 'grad_norm': 5.385146617889404, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s]                                               {'loss': 2.2699, 'grad_norm': 5.459223747253418, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.55it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s]                                               {'loss': 2.1001, 'grad_norm': 4.115637302398682, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.39it/s] 70%|███████   | 28/40 [00:11<00:05,  2.34it/s]                                               {'loss': 2.0962, 'grad_norm': 3.495089530944824, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.34it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.34it/s]                                               {'loss': 1.7449, 'grad_norm': 3.5232441425323486, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.34it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.0629, 'grad_norm': 3.699277639389038, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.28it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s]                                               {'loss': 1.7785, 'grad_norm': 3.874391555786133, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.26it/s] 80%|████████  | 32/40 [00:13<00:02,  2.84it/s]                                               {'loss': 2.3533, 'grad_norm': 46.76864242553711, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.84it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.59it/s]                                               {'loss': 2.1319, 'grad_norm': 3.3171513080596924, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.59it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s]                                               {'loss': 1.6895, 'grad_norm': 4.303189754486084, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.44it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s]                                               {'loss': 1.9507, 'grad_norm': 4.146257400512695, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.27it/s]                                               {'loss': 1.9785, 'grad_norm': 4.127620697021484, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.27it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s]                                               {'loss': 2.0495, 'grad_norm': 4.602558612823486, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.22it/s]                                               {'loss': 2.0888, 'grad_norm': 3.960552215576172, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.22it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.19it/s]                                               {'loss': 1.8231, 'grad_norm': 3.3820362091064453, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.19it/s]100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'loss': 1.589, 'grad_norm': 9.036543846130371, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]                                               {'train_runtime': 16.6538, 'train_samples_per_second': 33.926, 'train_steps_per_second': 2.402, 'train_loss': 2.031405049562454, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.82it/s]100%|██████████| 40/40 [00:16<00:00,  2.40it/s]
CLIENT:93
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]                                              {'loss': 2.2008, 'grad_norm': 4.229285717010498, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.16it/s]  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.0039, 'grad_norm': 3.7576122283935547, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.19it/s]  8%|▊         | 3/40 [00:01<00:16,  2.29it/s]                                              {'loss': 2.4699, 'grad_norm': 5.5626702308654785, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.29it/s] 10%|█         | 4/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.4313, 'grad_norm': 6.7660813331604, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.20it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s]                                              {'loss': 2.0259, 'grad_norm': 3.85557222366333, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.21it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s]                                              {'loss': 2.3398, 'grad_norm': 4.547242641448975, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.18it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s]                                              {'loss': 2.3522, 'grad_norm': 4.050350666046143, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s] 20%|██        | 8/40 [00:03<00:11,  2.81it/s]                                              {'loss': 2.116, 'grad_norm': 12.39901065826416, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.81it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s]                                              {'loss': 2.2169, 'grad_norm': 4.871609210968018, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.60it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s]                                               {'loss': 2.0811, 'grad_norm': 5.443412780761719, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.43it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s]                                               {'loss': 2.072, 'grad_norm': 5.369194030761719, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.37it/s] 30%|███       | 12/40 [00:05<00:12,  2.27it/s]                                               {'loss': 2.0891, 'grad_norm': 4.976225852966309, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.27it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.25it/s]                                               {'loss': 2.3589, 'grad_norm': 6.282310485839844, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.25it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.201, 'grad_norm': 3.823406457901001, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s]                                               {'loss': 2.3944, 'grad_norm': 4.894545078277588, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.22it/s] 40%|████      | 16/40 [00:06<00:08,  2.87it/s]                                               {'loss': 2.0897, 'grad_norm': 13.844985961914062, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.87it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s]                                               {'loss': 2.2865, 'grad_norm': 4.688985824584961, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s]                                               {'loss': 2.1749, 'grad_norm': 4.218020439147949, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.44it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s]                                               {'loss': 2.127, 'grad_norm': 5.078866958618164, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.37it/s] 50%|█████     | 20/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.1993, 'grad_norm': 7.102313995361328, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.27it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s]                                               {'loss': 2.1898, 'grad_norm': 4.232264041900635, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.25it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s]                                               {'loss': 1.8424, 'grad_norm': 4.761685371398926, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.41it/s]                                               {'loss': 2.162, 'grad_norm': 3.5808534622192383, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.41it/s]                                               {'loss': 1.9015, 'grad_norm': 23.54510498046875, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:06,  2.41it/s] 62%|██████▎   | 25/40 [00:10<00:04,  3.15it/s]                                               {'loss': 2.1771, 'grad_norm': 3.4399445056915283, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:04,  3.15it/s] 65%|██████▌   | 26/40 [00:10<00:04,  3.00it/s]                                               {'loss': 2.1848, 'grad_norm': 3.4283952713012695, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  3.00it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.91it/s]                                               {'loss': 1.9446, 'grad_norm': 3.222116231918335, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.91it/s] 70%|███████   | 28/40 [00:11<00:04,  2.83it/s]                                               {'loss': 2.0935, 'grad_norm': 3.472874641418457, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.83it/s] 72%|███████▎  | 29/40 [00:11<00:03,  2.77it/s]                                               {'loss': 2.0456, 'grad_norm': 4.55668306350708, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:03,  2.77it/s] 75%|███████▌  | 30/40 [00:12<00:03,  2.74it/s]                                               {'loss': 2.2316, 'grad_norm': 4.3420610427856445, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:03,  2.74it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.73it/s]                                               {'loss': 2.123, 'grad_norm': 4.328433036804199, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.73it/s]                                               {'loss': 1.5395, 'grad_norm': 17.827539443969727, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.73it/s] 82%|████████▎ | 33/40 [00:12<00:02,  3.40it/s]                                               {'loss': 1.9574, 'grad_norm': 4.221933364868164, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  3.40it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.23it/s]                                               {'loss': 2.2837, 'grad_norm': 5.7565789222717285, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.23it/s] 88%|████████▊ | 35/40 [00:13<00:01,  3.05it/s]                                               {'loss': 1.9838, 'grad_norm': 4.648216247558594, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  3.05it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.75it/s]                                               {'loss': 1.941, 'grad_norm': 2.9650533199310303, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.75it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.57it/s]                                               {'loss': 1.8925, 'grad_norm': 3.418135643005371, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.57it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.48it/s]                                               {'loss': 2.0494, 'grad_norm': 4.8894524574279785, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.48it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.35it/s]                                               {'loss': 2.1708, 'grad_norm': 3.9313905239105225, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.35it/s]100%|██████████| 40/40 [00:15<00:00,  2.93it/s]                                               {'loss': 2.5609, 'grad_norm': 21.60116195678711, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.93it/s]                                               {'train_runtime': 15.6484, 'train_samples_per_second': 36.106, 'train_steps_per_second': 2.556, 'train_loss': 2.13763542175293, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.93it/s]100%|██████████| 40/40 [00:15<00:00,  2.56it/s]
CLIENT:17
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:31,  1.24it/s]                                              {'loss': 2.0893, 'grad_norm': 4.021928787231445, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:31,  1.24it/s]  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]                                              {'loss': 2.3005, 'grad_norm': 7.066206932067871, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]  8%|▊         | 3/40 [00:01<00:20,  1.79it/s]                                              {'loss': 1.9444, 'grad_norm': 4.64804744720459, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:20,  1.79it/s] 10%|█         | 4/40 [00:02<00:18,  1.94it/s]                                              {'loss': 2.3628, 'grad_norm': 4.381595134735107, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:18,  1.94it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.04it/s]                                              {'loss': 2.1053, 'grad_norm': 4.603400230407715, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.04it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.09it/s]                                              {'loss': 2.4265, 'grad_norm': 3.8398690223693848, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.09it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s]                                              {'loss': 2.2708, 'grad_norm': 3.937985897064209, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.15it/s] 20%|██        | 8/40 [00:04<00:14,  2.19it/s]                                              {'loss': 1.6184, 'grad_norm': 17.596405029296875, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.19it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.19it/s]                                              {'loss': 2.5963, 'grad_norm': 4.933329105377197, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.19it/s] 25%|██▌       | 10/40 [00:04<00:13,  2.18it/s]                                               {'loss': 1.9152, 'grad_norm': 5.5567731857299805, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:13,  2.18it/s] 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s]                                               {'loss': 1.979, 'grad_norm': 4.8559088706970215, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:13,  2.21it/s] 30%|███       | 12/40 [00:05<00:12,  2.17it/s]                                               {'loss': 2.0077, 'grad_norm': 4.448750019073486, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.17it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s]                                               {'loss': 1.9047, 'grad_norm': 5.9794697761535645, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.18it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s]                                               {'loss': 2.1557, 'grad_norm': 4.098552703857422, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.19it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s]                                               {'loss': 2.1711, 'grad_norm': 4.754643440246582, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.18it/s] 40%|████      | 16/40 [00:07<00:08,  2.80it/s]                                               {'loss': 1.2942, 'grad_norm': 11.623687744140625, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.80it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s]                                               {'loss': 1.848, 'grad_norm': 3.8680968284606934, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s] 45%|████▌     | 18/40 [00:08<00:09,  2.42it/s]                                               {'loss': 1.8013, 'grad_norm': 4.234386444091797, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:09,  2.42it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.38it/s]                                               {'loss': 2.0496, 'grad_norm': 3.637186288833618, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.38it/s] 50%|█████     | 20/40 [00:09<00:08,  2.28it/s]                                               {'loss': 2.0827, 'grad_norm': 3.8389103412628174, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.28it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.24it/s]                                               {'loss': 1.8715, 'grad_norm': 4.7737603187561035, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.24it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.23it/s]                                               {'loss': 2.2621, 'grad_norm': 3.489779233932495, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.19it/s]                                               {'loss': 2.108, 'grad_norm': 4.35064172744751, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.19it/s] 60%|██████    | 24/40 [00:10<00:05,  2.83it/s]                                               {'loss': 2.3185, 'grad_norm': 10.489200592041016, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.64it/s]                                               {'loss': 2.1087, 'grad_norm': 3.438349723815918, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.64it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s]                                               {'loss': 2.087, 'grad_norm': 4.63382625579834, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.45it/s]                                               {'loss': 1.6708, 'grad_norm': 3.3498120307922363, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.45it/s] 70%|███████   | 28/40 [00:12<00:04,  2.43it/s]                                               {'loss': 2.008, 'grad_norm': 3.642277240753174, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:04,  2.43it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.33it/s]                                               {'loss': 2.0486, 'grad_norm': 3.938058376312256, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.33it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.30it/s]                                               {'loss': 1.9926, 'grad_norm': 3.9259517192840576, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.30it/s] 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s]                                               {'loss': 1.9789, 'grad_norm': 4.379997730255127, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:03,  2.25it/s] 80%|████████  | 32/40 [00:13<00:02,  2.82it/s]                                               {'loss': 2.5348, 'grad_norm': 10.892763137817383, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.65it/s]                                               {'loss': 1.833, 'grad_norm': 3.5759634971618652, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.65it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s]                                               {'loss': 1.9312, 'grad_norm': 3.1440227031707764, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.43it/s]                                               {'loss': 1.9999, 'grad_norm': 4.868901252746582, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.45it/s]                                               {'loss': 2.0261, 'grad_norm': 3.3803493976593018, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.45it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.35it/s]                                               {'loss': 1.8889, 'grad_norm': 3.5477192401885986, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.35it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.30it/s]                                               {'loss': 2.1339, 'grad_norm': 4.649730205535889, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]                                               {'loss': 1.8091, 'grad_norm': 3.592843532562256, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]100%|██████████| 40/40 [00:17<00:00,  2.86it/s]                                               {'loss': 1.8855, 'grad_norm': 11.73747730255127, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.86it/s]                                               {'train_runtime': 17.2924, 'train_samples_per_second': 32.673, 'train_steps_per_second': 2.313, 'train_loss': 2.035516065359116, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.86it/s]100%|██████████| 40/40 [00:17<00:00,  2.31it/s]
CLIENT:36
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]                                              {'loss': 2.2143, 'grad_norm': 4.129963397979736, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.19it/s]  5%|▌         | 2/40 [00:00<00:15,  2.39it/s]                                              {'loss': 2.1478, 'grad_norm': 3.9509949684143066, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:15,  2.39it/s]  8%|▊         | 3/40 [00:01<00:14,  2.48it/s]                                              {'loss': 2.0779, 'grad_norm': 4.792840480804443, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:14,  2.48it/s] 10%|█         | 4/40 [00:01<00:14,  2.51it/s]                                              {'loss': 2.1848, 'grad_norm': 4.781472206115723, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.51it/s] 12%|█▎        | 5/40 [00:01<00:13,  2.59it/s]                                              {'loss': 2.1785, 'grad_norm': 3.4382894039154053, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.59it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.55it/s]                                              {'loss': 2.3997, 'grad_norm': 6.655913829803467, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.55it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.58it/s]                                              {'loss': 2.2, 'grad_norm': 5.4717864990234375, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.58it/s]                                              {'loss': 2.9678, 'grad_norm': 12.42548942565918, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:12,  2.58it/s] 22%|██▎       | 9/40 [00:03<00:10,  3.02it/s]                                              {'loss': 2.3939, 'grad_norm': 4.364180088043213, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  3.02it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.73it/s]                                               {'loss': 2.1906, 'grad_norm': 5.5702900886535645, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.73it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.62it/s]                                               {'loss': 2.0075, 'grad_norm': 4.030941009521484, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.62it/s] 30%|███       | 12/40 [00:04<00:10,  2.58it/s]                                               {'loss': 1.9924, 'grad_norm': 5.495429992675781, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.58it/s] 32%|███▎      | 13/40 [00:04<00:10,  2.61it/s]                                               {'loss': 1.8539, 'grad_norm': 3.0233497619628906, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:10,  2.61it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.55it/s]                                               {'loss': 2.0813, 'grad_norm': 3.219144582748413, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.55it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.55it/s]                                               {'loss': 2.2874, 'grad_norm': 3.278916358947754, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.55it/s] 40%|████      | 16/40 [00:05<00:07,  3.26it/s]                                               {'loss': 2.1259, 'grad_norm': 17.788883209228516, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:07,  3.26it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.02it/s]                                               {'loss': 2.0446, 'grad_norm': 3.051934003829956, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.02it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.71it/s]                                               {'loss': 2.0643, 'grad_norm': 3.5978667736053467, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.71it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.69it/s]                                               {'loss': 2.0819, 'grad_norm': 5.135603904724121, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.69it/s] 50%|█████     | 20/40 [00:07<00:07,  2.51it/s]                                               {'loss': 2.1038, 'grad_norm': 5.6937689781188965, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.51it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.39it/s]                                               {'loss': 1.9548, 'grad_norm': 3.1149742603302, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.39it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.33it/s]                                               {'loss': 2.0461, 'grad_norm': 2.9104561805725098, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.33it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.25it/s]                                               {'loss': 1.8921, 'grad_norm': 3.966562032699585, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.25it/s]                                               {'loss': 1.8856, 'grad_norm': 11.602315902709961, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:07,  2.25it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.77it/s]                                               {'loss': 2.1876, 'grad_norm': 3.665919542312622, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.77it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.57it/s]                                               {'loss': 1.8757, 'grad_norm': 2.803548574447632, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.57it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.47it/s]                                               {'loss': 1.9878, 'grad_norm': 3.066235303878784, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.47it/s] 70%|███████   | 28/40 [00:10<00:05,  2.39it/s]                                               {'loss': 2.1736, 'grad_norm': 3.1199121475219727, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.39it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s]                                               {'loss': 1.9153, 'grad_norm': 3.6472854614257812, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.32it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.31it/s]                                               {'loss': 1.8978, 'grad_norm': 3.516631603240967, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.31it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s]                                               {'loss': 1.9375, 'grad_norm': 3.547884464263916, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.24it/s] 80%|████████  | 32/40 [00:12<00:02,  2.79it/s]                                               {'loss': 1.6188, 'grad_norm': 13.849555015563965, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.79it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.80it/s]                                               {'loss': 1.9303, 'grad_norm': 3.0381722450256348, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.80it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.77it/s]                                               {'loss': 1.8255, 'grad_norm': 2.983401298522949, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.77it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.76it/s]                                               {'loss': 1.998, 'grad_norm': 3.2607617378234863, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.76it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.75it/s]                                               {'loss': 1.9584, 'grad_norm': 3.7107903957366943, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.75it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.66it/s]                                               {'loss': 1.8867, 'grad_norm': 3.598351001739502, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.66it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.65it/s]                                               {'loss': 2.0403, 'grad_norm': 3.6950056552886963, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.65it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.67it/s]                                               {'loss': 2.0474, 'grad_norm': 3.6971588134765625, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.67it/s]                                               {'loss': 2.7717, 'grad_norm': 17.73758316040039, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.67it/s]                                               {'train_runtime': 15.2072, 'train_samples_per_second': 37.154, 'train_steps_per_second': 2.63, 'train_loss': 2.085735109448433, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.67it/s]100%|██████████| 40/40 [00:15<00:00,  2.63it/s]
CLIENT:82
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:13,  2.94it/s]                                              {'loss': 2.2951, 'grad_norm': 4.631038665771484, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:13,  2.94it/s]  5%|▌         | 2/40 [00:00<00:13,  2.89it/s]                                              {'loss': 2.0304, 'grad_norm': 4.627135276794434, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:13,  2.89it/s]  8%|▊         | 3/40 [00:01<00:12,  2.91it/s]                                              {'loss': 1.9657, 'grad_norm': 5.388553619384766, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:12,  2.91it/s] 10%|█         | 4/40 [00:01<00:12,  2.91it/s]                                              {'loss': 2.3414, 'grad_norm': 4.902420520782471, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:12,  2.91it/s] 12%|█▎        | 5/40 [00:01<00:12,  2.91it/s]                                              {'loss': 2.1972, 'grad_norm': 3.579533100128174, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:12,  2.91it/s] 15%|█▌        | 6/40 [00:02<00:11,  2.95it/s]                                              {'loss': 2.1802, 'grad_norm': 5.256587028503418, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:11,  2.95it/s] 18%|█▊        | 7/40 [00:02<00:11,  2.76it/s]                                              {'loss': 2.1027, 'grad_norm': 3.511340618133545, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:11,  2.76it/s] 20%|██        | 8/40 [00:02<00:09,  3.37it/s]                                              {'loss': 1.6963, 'grad_norm': 11.56450080871582, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.37it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.92it/s]                                              {'loss': 1.9088, 'grad_norm': 3.7384448051452637, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.92it/s] 25%|██▌       | 10/40 [00:03<00:10,  2.78it/s]                                               {'loss': 1.9701, 'grad_norm': 4.319722652435303, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:10,  2.78it/s] 28%|██▊       | 11/40 [00:03<00:11,  2.57it/s]                                               {'loss': 2.0071, 'grad_norm': 3.5698089599609375, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:03<00:11,  2.57it/s] 30%|███       | 12/40 [00:04<00:11,  2.50it/s]                                               {'loss': 1.8486, 'grad_norm': 3.6606945991516113, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.50it/s] 32%|███▎      | 13/40 [00:04<00:11,  2.41it/s]                                               {'loss': 2.3707, 'grad_norm': 5.2178521156311035, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:04<00:11,  2.41it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.1459, 'grad_norm': 3.620807647705078, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.31it/s] 38%|███▊      | 15/40 [00:05<00:10,  2.28it/s]                                               {'loss': 2.0276, 'grad_norm': 3.283409357070923, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:10,  2.28it/s]                                               {'loss': 2.5699, 'grad_norm': 19.761974334716797, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:05<00:10,  2.28it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.76it/s]                                               {'loss': 1.6944, 'grad_norm': 3.589078903198242, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.76it/s] 45%|████▌     | 18/40 [00:06<00:08,  2.68it/s]                                               {'loss': 2.0605, 'grad_norm': 3.8062827587127686, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:08,  2.68it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.50it/s]                                               {'loss': 1.9688, 'grad_norm': 5.765976428985596, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.50it/s] 50%|█████     | 20/40 [00:07<00:08,  2.40it/s]                                               {'loss': 1.9264, 'grad_norm': 3.4943323135375977, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:08,  2.40it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.39it/s]                                               {'loss': 1.92, 'grad_norm': 3.540804147720337, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.39it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.41it/s]                                               {'loss': 1.8829, 'grad_norm': 4.121182918548584, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.41it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.49it/s]                                               {'loss': 2.3408, 'grad_norm': 4.174375534057617, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.49it/s]                                               {'loss': 1.9142, 'grad_norm': 18.25153160095215, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:06,  2.49it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.08it/s]                                               {'loss': 1.9853, 'grad_norm': 4.07765531539917, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.08it/s] 65%|██████▌   | 26/40 [00:09<00:04,  2.99it/s]                                               {'loss': 1.9484, 'grad_norm': 4.9997758865356445, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  2.99it/s] 68%|██████▊   | 27/40 [00:09<00:04,  3.08it/s]                                               {'loss': 1.7383, 'grad_norm': 3.795319080352783, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:09<00:04,  3.08it/s] 70%|███████   | 28/40 [00:10<00:03,  3.11it/s]                                               {'loss': 2.0255, 'grad_norm': 3.954188585281372, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:03,  3.11it/s] 72%|███████▎  | 29/40 [00:10<00:03,  3.06it/s]                                               {'loss': 1.8274, 'grad_norm': 3.405827045440674, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:03,  3.06it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.75it/s]                                               {'loss': 2.1557, 'grad_norm': 3.5419976711273193, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.75it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.45it/s]                                               {'loss': 2.0494, 'grad_norm': 4.272279739379883, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.45it/s]                                               {'loss': 2.227, 'grad_norm': 12.4873628616333, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:03,  2.45it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.88it/s]                                               {'loss': 1.9164, 'grad_norm': 3.954631805419922, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.88it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.75it/s]                                               {'loss': 1.9904, 'grad_norm': 4.237189769744873, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.75it/s] 88%|████████▊ | 35/40 [00:12<00:01,  2.55it/s]                                               {'loss': 1.8885, 'grad_norm': 3.0797319412231445, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.55it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.44it/s]                                               {'loss': 1.822, 'grad_norm': 3.184390068054199, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.44it/s] 92%|█████████▎| 37/40 [00:13<00:01,  2.38it/s]                                               {'loss': 1.9081, 'grad_norm': 3.2801549434661865, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:13<00:01,  2.38it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.30it/s]                                               {'loss': 2.0151, 'grad_norm': 3.7243471145629883, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:14<00:00,  2.29it/s]                                               {'loss': 1.9109, 'grad_norm': 4.246756553649902, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:14<00:00,  2.29it/s]100%|██████████| 40/40 [00:14<00:00,  2.87it/s]                                               {'loss': 3.0556, 'grad_norm': 22.517955780029297, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:14<00:00,  2.87it/s]                                               {'train_runtime': 15.0563, 'train_samples_per_second': 37.526, 'train_steps_per_second': 2.657, 'train_loss': 2.045740616321564, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.87it/s]100%|██████████| 40/40 [00:15<00:00,  2.66it/s]
CLIENT:69
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]                                              {'loss': 2.1183, 'grad_norm': 3.899230718612671, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.21it/s]  5%|▌         | 2/40 [00:00<00:17,  2.14it/s]                                              {'loss': 2.1055, 'grad_norm': 3.7283761501312256, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.14it/s]  8%|▊         | 3/40 [00:01<00:17,  2.17it/s]                                              {'loss': 2.4177, 'grad_norm': 5.652839660644531, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.17it/s] 10%|█         | 4/40 [00:01<00:17,  2.12it/s]                                              {'loss': 2.1715, 'grad_norm': 4.169346332550049, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:17,  2.12it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s]                                              {'loss': 2.1277, 'grad_norm': 4.761160850524902, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.13it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s]                                              {'loss': 2.2788, 'grad_norm': 6.38025426864624, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 1.9208, 'grad_norm': 4.5868988037109375, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.12it/s]                                              {'loss': 1.2905, 'grad_norm': 8.164690971374512, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:15,  2.12it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s]                                              {'loss': 1.985, 'grad_norm': 4.28236722946167, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.66it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.51it/s]                                               {'loss': 1.9338, 'grad_norm': 3.4437522888183594, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.51it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.48it/s]                                               {'loss': 2.0632, 'grad_norm': 5.023066520690918, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.48it/s] 30%|███       | 12/40 [00:05<00:11,  2.38it/s]                                               {'loss': 2.1498, 'grad_norm': 4.520744323730469, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:11,  2.38it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s]                                               {'loss': 1.9145, 'grad_norm': 3.862086057662964, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.33it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s]                                               {'loss': 2.0139, 'grad_norm': 3.7043702602386475, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.28it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.1978, 'grad_norm': 4.464402675628662, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 1.5606, 'grad_norm': 11.149454116821289, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s]                                               {'loss': 1.8962, 'grad_norm': 3.4061529636383057, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.66it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s]                                               {'loss': 2.1801, 'grad_norm': 5.294113636016846, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s]                                               {'loss': 2.2368, 'grad_norm': 3.816812753677368, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s] 50%|█████     | 20/40 [00:08<00:08,  2.38it/s]                                               {'loss': 2.0596, 'grad_norm': 5.311976909637451, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.38it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s]                                               {'loss': 1.8412, 'grad_norm': 3.7919039726257324, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.30it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s]                                               {'loss': 1.887, 'grad_norm': 3.5627596378326416, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.28it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s]                                               {'loss': 1.7052, 'grad_norm': 3.6201722621917725, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.23it/s] 60%|██████    | 24/40 [00:09<00:05,  2.79it/s]                                               {'loss': 2.6075, 'grad_norm': 13.666675567626953, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.79it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s]                                               {'loss': 1.9232, 'grad_norm': 3.735243082046509, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.56it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.40it/s]                                               {'loss': 2.1627, 'grad_norm': 3.5637588500976562, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.40it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.29it/s]                                               {'loss': 1.9639, 'grad_norm': 4.4542460441589355, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.29it/s] 70%|███████   | 28/40 [00:11<00:05,  2.24it/s]                                               {'loss': 1.9741, 'grad_norm': 3.683788537979126, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.24it/s] 72%|███████▎  | 29/40 [00:12<00:05,  2.17it/s]                                               {'loss': 1.7604, 'grad_norm': 4.54636812210083, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:05,  2.17it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.18it/s]                                               {'loss': 1.9579, 'grad_norm': 3.377558708190918, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.18it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.14it/s]                                               {'loss': 1.9079, 'grad_norm': 3.758781909942627, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.14it/s]                                               {'loss': 2.2895, 'grad_norm': 17.4346923828125, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:03,  2.14it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.66it/s]                                               {'loss': 2.1097, 'grad_norm': 3.321035385131836, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.66it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s]                                               {'loss': 2.0933, 'grad_norm': 3.998542547225952, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.52it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.43it/s]                                               {'loss': 1.8256, 'grad_norm': 3.356118679046631, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.38it/s]                                               {'loss': 1.9257, 'grad_norm': 2.961949348449707, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.38it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s]                                               {'loss': 1.9, 'grad_norm': 3.943413257598877, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.27it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s]                                               {'loss': 1.804, 'grad_norm': 4.177948474884033, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.25it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.28it/s]                                               {'loss': 1.9202, 'grad_norm': 5.369771957397461, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.28it/s]100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'loss': 1.673, 'grad_norm': 23.979333877563477, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'train_runtime': 16.8114, 'train_samples_per_second': 33.608, 'train_steps_per_second': 2.379, 'train_loss': 1.9963494449853898, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.88it/s]100%|██████████| 40/40 [00:16<00:00,  2.38it/s]
CLIENT:65
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.29it/s]                                              {'loss': 2.1502, 'grad_norm': 5.130675315856934, 'learning_rate': 0.00014316767251549832, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.29it/s]  5%|▌         | 2/40 [00:00<00:16,  2.27it/s]                                              {'loss': 2.2634, 'grad_norm': 4.666319847106934, 'learning_rate': 0.00013958848070261086, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.27it/s]  8%|▊         | 3/40 [00:01<00:16,  2.19it/s]                                              {'loss': 2.3661, 'grad_norm': 5.331841468811035, 'learning_rate': 0.0001360092888897234, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.19it/s] 10%|█         | 4/40 [00:01<00:16,  2.20it/s]                                              {'loss': 2.0205, 'grad_norm': 4.593794345855713, 'learning_rate': 0.00013243009707683594, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.20it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s]                                              {'loss': 2.0133, 'grad_norm': 4.445492267608643, 'learning_rate': 0.00012885090526394848, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.18it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.17it/s]                                              {'loss': 2.1704, 'grad_norm': 4.306399822235107, 'learning_rate': 0.00012527171345106102, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.17it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s]                                              {'loss': 2.4421, 'grad_norm': 4.865950584411621, 'learning_rate': 0.00012169252163817357, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.23it/s] 20%|██        | 8/40 [00:03<00:11,  2.86it/s]                                              {'loss': 2.0002, 'grad_norm': 12.582663536071777, 'learning_rate': 0.00011811332982528611, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.86it/s] 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s]                                              {'loss': 2.0606, 'grad_norm': 3.783163547515869, 'learning_rate': 0.00011453413801239867, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:12,  2.56it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s]                                               {'loss': 2.2298, 'grad_norm': 4.501231670379639, 'learning_rate': 0.00011095494619951121, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.45it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s]                                               {'loss': 2.056, 'grad_norm': 4.301199436187744, 'learning_rate': 0.00010737575438662375, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.30it/s] 30%|███       | 12/40 [00:05<00:12,  2.26it/s]                                               {'loss': 1.9416, 'grad_norm': 3.473459482192993, 'learning_rate': 0.00010379656257373627, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.26it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s]                                               {'loss': 2.1126, 'grad_norm': 5.283915996551514, 'learning_rate': 0.00010021737076084881, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:05<00:10,  2.43it/s]                                               {'loss': 2.0074, 'grad_norm': 4.685476779937744, 'learning_rate': 9.663817894796137e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:10,  2.43it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.51it/s]                                               {'loss': 2.2132, 'grad_norm': 3.827082395553589, 'learning_rate': 9.305898713507391e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.51it/s]                                               {'loss': 2.2148, 'grad_norm': 23.904979705810547, 'learning_rate': 8.947979532218645e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:09,  2.51it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.15it/s]                                               {'loss': 1.8738, 'grad_norm': 3.7486565113067627, 'learning_rate': 8.590060350929899e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.15it/s] 45%|████▌     | 18/40 [00:07<00:07,  3.05it/s]                                               {'loss': 1.9629, 'grad_norm': 4.380283832550049, 'learning_rate': 8.232141169641153e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:07,  3.05it/s] 48%|████▊     | 19/40 [00:07<00:07,  2.98it/s]                                               {'loss': 1.8856, 'grad_norm': 4.950552940368652, 'learning_rate': 7.874221988352408e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:07,  2.98it/s] 50%|█████     | 20/40 [00:07<00:06,  2.90it/s]                                               {'loss': 2.1661, 'grad_norm': 4.537581443786621, 'learning_rate': 7.516302807063662e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  2.90it/s] 52%|█████▎    | 21/40 [00:08<00:06,  2.88it/s]                                               {'loss': 1.9705, 'grad_norm': 3.8371741771698, 'learning_rate': 7.158383625774916e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:06,  2.88it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.84it/s]                                               {'loss': 1.8911, 'grad_norm': 3.0541038513183594, 'learning_rate': 6.80046444448617e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.84it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.82it/s]                                               {'loss': 2.2016, 'grad_norm': 3.5865602493286133, 'learning_rate': 6.442545263197424e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.82it/s] 60%|██████    | 24/40 [00:09<00:04,  3.49it/s]                                               {'loss': 1.569, 'grad_norm': 7.751527309417725, 'learning_rate': 6.084626081908679e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:04,  3.49it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.19it/s]                                               {'loss': 2.004, 'grad_norm': 3.564330816268921, 'learning_rate': 5.7267069006199334e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.19it/s] 65%|██████▌   | 26/40 [00:09<00:04,  2.93it/s]                                               {'loss': 2.0692, 'grad_norm': 4.4416704177856445, 'learning_rate': 5.3687877193311874e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  2.93it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.59it/s]                                               {'loss': 1.9987, 'grad_norm': 4.90651273727417, 'learning_rate': 5.010868538042441e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.59it/s] 70%|███████   | 28/40 [00:10<00:04,  2.41it/s]                                               {'loss': 1.939, 'grad_norm': 3.7162373065948486, 'learning_rate': 4.6529493567536954e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.41it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.45it/s]                                               {'loss': 1.9521, 'grad_norm': 3.0478515625, 'learning_rate': 4.2950301754649493e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.45it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.46it/s]                                               {'loss': 1.9628, 'grad_norm': 3.84368634223938, 'learning_rate': 3.937110994176204e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.46it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.31it/s]                                               {'loss': 2.0361, 'grad_norm': 4.687448501586914, 'learning_rate': 3.579191812887458e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.31it/s]                                               {'loss': 0.978, 'grad_norm': 5.906976699829102, 'learning_rate': 3.221272631598712e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:03,  2.31it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.83it/s]                                               {'loss': 2.0589, 'grad_norm': 4.126758098602295, 'learning_rate': 2.8633534503099667e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.83it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.61it/s]                                               {'loss': 2.0533, 'grad_norm': 4.151641845703125, 'learning_rate': 2.5054342690212203e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.61it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.49it/s]                                               {'loss': 2.1294, 'grad_norm': 4.944951057434082, 'learning_rate': 2.1475150877324747e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.49it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s]                                               {'loss': 1.6617, 'grad_norm': 3.546738624572754, 'learning_rate': 1.789595906443729e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.31it/s]                                               {'loss': 1.9026, 'grad_norm': 3.8901641368865967, 'learning_rate': 1.4316767251549833e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.29it/s]                                               {'loss': 2.0867, 'grad_norm': 4.724483489990234, 'learning_rate': 1.0737575438662373e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.29it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.23it/s]                                               {'loss': 1.7977, 'grad_norm': 3.344957113265991, 'learning_rate': 7.158383625774917e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.23it/s]100%|██████████| 40/40 [00:15<00:00,  2.78it/s]                                               {'loss': 1.3027, 'grad_norm': 9.876229286193848, 'learning_rate': 3.5791918128874584e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.78it/s]                                               {'train_runtime': 15.6659, 'train_samples_per_second': 36.066, 'train_steps_per_second': 2.553, 'train_loss': 1.9928910166025162, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.78it/s]100%|██████████| 40/40 [00:15<00:00,  2.55it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:41, 11.43it/s]  1%|          | 4/471 [00:00<01:15,  6.17it/s]  1%|          | 5/471 [00:00<01:29,  5.21it/s]  1%|▏         | 6/471 [00:01<01:28,  5.28it/s]  1%|▏         | 7/471 [00:01<01:36,  4.81it/s]  2%|▏         | 8/471 [00:01<01:32,  5.00it/s]  2%|▏         | 9/471 [00:01<01:39,  4.65it/s]  2%|▏         | 10/471 [00:01<01:40,  4.61it/s]  2%|▏         | 11/471 [00:02<01:38,  4.66it/s]  3%|▎         | 12/471 [00:02<01:40,  4.59it/s]  3%|▎         | 13/471 [00:02<01:37,  4.71it/s]  3%|▎         | 14/471 [00:02<01:40,  4.56it/s]  3%|▎         | 15/471 [00:03<01:37,  4.67it/s]  3%|▎         | 16/471 [00:03<01:42,  4.46it/s]  4%|▎         | 17/471 [00:03<01:37,  4.68it/s]  4%|▍         | 18/471 [00:03<01:40,  4.49it/s]  4%|▍         | 19/471 [00:03<01:34,  4.77it/s]  4%|▍         | 20/471 [00:04<01:41,  4.44it/s]  4%|▍         | 21/471 [00:04<01:35,  4.73it/s]  5%|▍         | 22/471 [00:04<01:41,  4.42it/s]  5%|▍         | 23/471 [00:04<01:34,  4.73it/s]  5%|▌         | 24/471 [00:04<01:37,  4.61it/s]  5%|▌         | 25/471 [00:05<01:37,  4.59it/s]  6%|▌         | 26/471 [00:05<01:37,  4.57it/s]  6%|▌         | 27/471 [00:05<01:38,  4.51it/s]  6%|▌         | 28/471 [00:05<01:36,  4.61it/s]  6%|▌         | 29/471 [00:06<01:36,  4.57it/s]  6%|▋         | 30/471 [00:06<01:33,  4.73it/s]  7%|▋         | 31/471 [00:06<01:37,  4.49it/s]  7%|▋         | 32/471 [00:06<01:32,  4.77it/s]  7%|▋         | 33/471 [00:06<01:36,  4.52it/s]  7%|▋         | 34/471 [00:07<01:26,  5.06it/s]  7%|▋         | 35/471 [00:07<01:32,  4.73it/s]  8%|▊         | 36/471 [00:07<01:29,  4.87it/s]  8%|▊         | 37/471 [00:07<01:35,  4.54it/s]  8%|▊         | 38/471 [00:08<01:34,  4.58it/s]  8%|▊         | 39/471 [00:08<01:32,  4.69it/s]  8%|▊         | 40/471 [00:08<01:34,  4.57it/s]  9%|▊         | 41/471 [00:08<01:25,  5.02it/s]  9%|▉         | 42/471 [00:08<01:31,  4.67it/s]  9%|▉         | 43/471 [00:09<01:26,  4.97it/s]  9%|▉         | 44/471 [00:09<01:33,  4.56it/s] 10%|▉         | 45/471 [00:09<01:26,  4.91it/s] 10%|▉         | 46/471 [00:09<01:31,  4.64it/s] 10%|▉         | 47/471 [00:09<01:31,  4.65it/s] 10%|█         | 48/471 [00:10<01:31,  4.63it/s] 10%|█         | 49/471 [00:10<01:33,  4.52it/s] 11%|█         | 50/471 [00:10<01:26,  4.86it/s] 11%|█         | 51/471 [00:10<01:30,  4.65it/s] 11%|█         | 52/471 [00:10<01:24,  4.95it/s] 11%|█▏        | 53/471 [00:11<01:32,  4.54it/s] 11%|█▏        | 54/471 [00:11<01:24,  4.93it/s] 12%|█▏        | 55/471 [00:11<01:30,  4.58it/s] 12%|█▏        | 56/471 [00:11<01:27,  4.73it/s] 12%|█▏        | 57/471 [00:11<01:23,  4.96it/s] 12%|█▏        | 58/471 [00:12<01:27,  4.72it/s] 13%|█▎        | 59/471 [00:12<01:24,  4.86it/s] 13%|█▎        | 60/471 [00:12<01:29,  4.57it/s] 13%|█▎        | 61/471 [00:12<01:22,  5.00it/s] 13%|█▎        | 62/471 [00:13<01:24,  4.83it/s] 13%|█▎        | 63/471 [00:13<01:24,  4.86it/s] 14%|█▎        | 64/471 [00:13<01:29,  4.56it/s] 14%|█▍        | 65/471 [00:13<01:28,  4.59it/s] 14%|█▍        | 66/471 [00:13<01:27,  4.61it/s] 14%|█▍        | 67/471 [00:14<01:28,  4.56it/s] 14%|█▍        | 68/471 [00:14<01:25,  4.73it/s] 15%|█▍        | 69/471 [00:14<01:28,  4.57it/s] 15%|█▍        | 70/471 [00:14<01:26,  4.62it/s] 15%|█▌        | 71/471 [00:15<01:28,  4.50it/s] 15%|█▌        | 72/471 [00:15<01:24,  4.74it/s] 15%|█▌        | 73/471 [00:15<01:25,  4.68it/s] 16%|█▌        | 74/471 [00:15<01:19,  4.97it/s] 16%|█▌        | 75/471 [00:15<01:24,  4.68it/s] 16%|█▌        | 76/471 [00:16<01:25,  4.63it/s] 16%|█▋        | 77/471 [00:16<01:27,  4.53it/s] 17%|█▋        | 78/471 [00:16<01:25,  4.60it/s] 17%|█▋        | 79/471 [00:16<01:25,  4.61it/s] 17%|█▋        | 80/471 [00:16<01:26,  4.54it/s] 17%|█▋        | 81/471 [00:17<01:26,  4.53it/s] 17%|█▋        | 82/471 [00:17<01:26,  4.51it/s] 18%|█▊        | 83/471 [00:17<01:23,  4.63it/s] 18%|█▊        | 84/471 [00:17<01:23,  4.65it/s] 18%|█▊        | 85/471 [00:18<01:22,  4.65it/s] 18%|█▊        | 86/471 [00:18<01:24,  4.56it/s] 18%|█▊        | 87/471 [00:18<01:23,  4.61it/s] 19%|█▊        | 88/471 [00:18<01:22,  4.65it/s] 19%|█▉        | 89/471 [00:18<01:21,  4.68it/s] 19%|█▉        | 90/471 [00:19<01:21,  4.67it/s] 19%|█▉        | 91/471 [00:19<01:22,  4.63it/s] 20%|█▉        | 92/471 [00:19<01:24,  4.50it/s] 20%|█▉        | 93/471 [00:19<01:22,  4.59it/s] 20%|█▉        | 94/471 [00:19<01:21,  4.64it/s] 20%|██        | 95/471 [00:20<01:19,  4.72it/s] 20%|██        | 96/471 [00:20<01:20,  4.64it/s] 21%|██        | 97/471 [00:20<01:21,  4.58it/s] 21%|██        | 98/471 [00:20<01:20,  4.61it/s] 21%|██        | 99/471 [00:21<01:19,  4.65it/s] 21%|██        | 100/471 [00:21<01:19,  4.65it/s] 21%|██▏       | 101/471 [00:21<01:18,  4.69it/s] 22%|██▏       | 102/471 [00:21<01:21,  4.53it/s] 22%|██▏       | 103/471 [00:21<01:20,  4.59it/s] 22%|██▏       | 104/471 [00:22<01:21,  4.48it/s] 22%|██▏       | 105/471 [00:22<01:19,  4.63it/s] 23%|██▎       | 106/471 [00:22<01:19,  4.57it/s] 23%|██▎       | 107/471 [00:22<01:19,  4.56it/s] 23%|██▎       | 108/471 [00:23<01:21,  4.47it/s] 23%|██▎       | 109/471 [00:23<01:19,  4.54it/s] 23%|██▎       | 110/471 [00:23<01:20,  4.50it/s] 24%|██▎       | 111/471 [00:23<01:17,  4.67it/s] 24%|██▍       | 112/471 [00:23<01:16,  4.66it/s] 24%|██▍       | 113/471 [00:24<01:16,  4.67it/s] 24%|██▍       | 114/471 [00:24<01:18,  4.54it/s] 24%|██▍       | 115/471 [00:24<01:18,  4.55it/s] 25%|██▍       | 116/471 [00:24<01:17,  4.56it/s] 25%|██▍       | 117/471 [00:24<01:16,  4.63it/s] 25%|██▌       | 118/471 [00:25<01:16,  4.62it/s] 25%|██▌       | 119/471 [00:25<01:18,  4.51it/s] 25%|██▌       | 120/471 [00:25<01:16,  4.56it/s] 26%|██▌       | 121/471 [00:25<01:17,  4.54it/s] 26%|██▌       | 122/471 [00:26<01:14,  4.66it/s] 26%|██▌       | 123/471 [00:26<01:16,  4.57it/s] 26%|██▋       | 124/471 [00:26<01:14,  4.64it/s] 27%|██▋       | 125/471 [00:26<01:18,  4.43it/s] 27%|██▋       | 126/471 [00:26<01:12,  4.74it/s] 27%|██▋       | 127/471 [00:27<01:16,  4.50it/s] 27%|██▋       | 128/471 [00:27<01:10,  4.88it/s] 27%|██▋       | 129/471 [00:27<01:15,  4.53it/s] 28%|██▊       | 130/471 [00:27<01:13,  4.62it/s] 28%|██▊       | 131/471 [00:28<01:15,  4.50it/s] 28%|██▊       | 132/471 [00:28<01:13,  4.62it/s] 28%|██▊       | 133/471 [00:28<01:09,  4.83it/s] 28%|██▊       | 134/471 [00:28<01:13,  4.57it/s] 29%|██▊       | 135/471 [00:28<01:12,  4.66it/s] 29%|██▉       | 136/471 [00:29<01:14,  4.48it/s] 29%|██▉       | 137/471 [00:29<01:11,  4.64it/s] 29%|██▉       | 138/471 [00:29<01:14,  4.50it/s] 30%|██▉       | 139/471 [00:29<01:10,  4.71it/s] 30%|██▉       | 140/471 [00:30<01:14,  4.47it/s] 30%|██▉       | 141/471 [00:30<01:11,  4.63it/s] 30%|███       | 142/471 [00:30<01:14,  4.42it/s] 30%|███       | 143/471 [00:30<01:10,  4.65it/s] 31%|███       | 144/471 [00:30<01:12,  4.52it/s] 31%|███       | 145/471 [00:31<01:11,  4.55it/s] 31%|███       | 146/471 [00:31<01:12,  4.50it/s] 31%|███       | 147/471 [00:31<01:12,  4.44it/s] 31%|███▏      | 148/471 [00:31<01:08,  4.73it/s] 32%|███▏      | 149/471 [00:31<01:08,  4.68it/s] 32%|███▏      | 150/471 [00:32<01:02,  5.16it/s] 32%|███▏      | 151/471 [00:32<01:04,  4.97it/s] 32%|███▏      | 152/471 [00:32<00:55,  5.74it/s] 32%|███▏      | 153/471 [00:32<00:59,  5.35it/s] 33%|███▎      | 154/471 [00:32<00:56,  5.63it/s] 33%|███▎      | 155/471 [00:32<00:55,  5.73it/s] 33%|███▎      | 156/471 [00:33<00:56,  5.57it/s] 33%|███▎      | 157/471 [00:33<00:51,  6.05it/s] 34%|███▎      | 158/471 [00:33<00:55,  5.63it/s] 34%|███▍      | 159/471 [00:33<00:49,  6.30it/s] 34%|███▍      | 160/471 [00:33<00:54,  5.66it/s] 34%|███▍      | 161/471 [00:33<00:50,  6.14it/s] 34%|███▍      | 162/471 [00:34<00:54,  5.67it/s] 35%|███▍      | 163/471 [00:34<00:52,  5.85it/s] 35%|███▍      | 164/471 [00:34<00:52,  5.84it/s] 35%|███▌      | 165/471 [00:34<00:52,  5.79it/s] 35%|███▌      | 166/471 [00:34<00:50,  6.07it/s] 35%|███▌      | 167/471 [00:35<00:52,  5.75it/s] 36%|███▌      | 168/471 [00:35<00:48,  6.28it/s] 36%|███▌      | 169/471 [00:35<00:52,  5.75it/s] 36%|███▌      | 170/471 [00:35<00:49,  6.10it/s] 36%|███▋      | 171/471 [00:35<00:51,  5.87it/s] 37%|███▋      | 172/471 [00:35<00:50,  5.90it/s] 37%|███▋      | 173/471 [00:36<00:51,  5.77it/s] 37%|███▋      | 174/471 [00:36<00:55,  5.38it/s] 37%|███▋      | 175/471 [00:36<00:58,  5.03it/s] 37%|███▋      | 176/471 [00:36<01:01,  4.83it/s] 38%|███▊      | 177/471 [00:36<01:00,  4.83it/s] 38%|███▊      | 178/471 [00:37<01:02,  4.68it/s] 38%|███▊      | 179/471 [00:37<00:58,  4.97it/s] 38%|███▊      | 180/471 [00:37<01:02,  4.64it/s] 38%|███▊      | 181/471 [00:37<01:00,  4.82it/s] 39%|███▊      | 182/471 [00:37<01:03,  4.54it/s] 39%|███▉      | 183/471 [00:38<00:59,  4.83it/s] 39%|███▉      | 184/471 [00:38<01:01,  4.64it/s] 39%|███▉      | 185/471 [00:38<01:00,  4.70it/s] 39%|███▉      | 186/471 [00:38<01:03,  4.48it/s] 40%|███▉      | 187/471 [00:39<01:02,  4.56it/s] 40%|███▉      | 188/471 [00:39<01:01,  4.61it/s] 40%|████      | 189/471 [00:39<01:00,  4.64it/s] 40%|████      | 190/471 [00:39<00:58,  4.77it/s] 41%|████      | 191/471 [00:39<01:01,  4.54it/s] 41%|████      | 192/471 [00:40<01:00,  4.62it/s] 41%|████      | 193/471 [00:40<01:01,  4.51it/s] 41%|████      | 194/471 [00:40<00:58,  4.72it/s] 41%|████▏     | 195/471 [00:40<01:00,  4.56it/s] 42%|████▏     | 196/471 [00:40<00:57,  4.76it/s] 42%|████▏     | 197/471 [00:41<01:01,  4.43it/s] 42%|████▏     | 198/471 [00:41<00:57,  4.76it/s] 42%|████▏     | 199/471 [00:41<01:01,  4.46it/s] 42%|████▏     | 200/471 [00:41<00:56,  4.83it/s] 43%|████▎     | 201/471 [00:42<00:58,  4.58it/s] 43%|████▎     | 202/471 [00:42<00:58,  4.58it/s] 43%|████▎     | 203/471 [00:42<00:58,  4.57it/s] 43%|████▎     | 204/471 [00:42<00:58,  4.55it/s] 44%|████▎     | 205/471 [00:42<00:56,  4.68it/s] 44%|████▎     | 206/471 [00:43<00:56,  4.70it/s] 44%|████▍     | 207/471 [00:43<00:56,  4.69it/s] 44%|████▍     | 208/471 [00:43<00:58,  4.53it/s] 44%|████▍     | 209/471 [00:43<00:56,  4.66it/s] 45%|████▍     | 210/471 [00:44<00:57,  4.53it/s] 45%|████▍     | 211/471 [00:44<00:53,  4.88it/s] 45%|████▌     | 212/471 [00:44<00:52,  4.97it/s] 45%|████▌     | 213/471 [00:44<00:48,  5.34it/s] 45%|████▌     | 214/471 [00:44<00:50,  5.14it/s] 46%|████▌     | 215/471 [00:45<00:52,  4.88it/s] 46%|████▌     | 216/471 [00:45<00:51,  4.93it/s] 46%|████▌     | 217/471 [00:45<00:54,  4.70it/s] 46%|████▋     | 218/471 [00:45<00:52,  4.78it/s] 46%|████▋     | 219/471 [00:45<00:53,  4.69it/s] 47%|████▋     | 220/471 [00:46<00:53,  4.73it/s] 47%|████▋     | 221/471 [00:46<00:55,  4.53it/s] 47%|████▋     | 222/471 [00:46<00:54,  4.59it/s] 47%|████▋     | 223/471 [00:46<00:54,  4.55it/s] 48%|████▊     | 224/471 [00:46<00:53,  4.61it/s] 48%|████▊     | 225/471 [00:47<00:53,  4.63it/s] 48%|████▊     | 226/471 [00:47<00:53,  4.55it/s] 48%|████▊     | 227/471 [00:47<00:54,  4.47it/s] 48%|████▊     | 228/471 [00:47<00:54,  4.46it/s] 49%|████▊     | 229/471 [00:48<00:53,  4.56it/s] 49%|████▉     | 230/471 [00:48<00:53,  4.54it/s] 49%|████▉     | 231/471 [00:48<00:51,  4.64it/s] 49%|████▉     | 232/471 [00:48<00:53,  4.44it/s] 49%|████▉     | 233/471 [00:48<00:51,  4.65it/s] 50%|████▉     | 234/471 [00:49<00:52,  4.47it/s] 50%|████▉     | 235/471 [00:49<00:48,  4.85it/s] 50%|█████     | 236/471 [00:49<00:51,  4.60it/s] 50%|█████     | 237/471 [00:49<00:50,  4.62it/s] 51%|█████     | 238/471 [00:50<00:51,  4.56it/s] 51%|█████     | 239/471 [00:50<00:50,  4.60it/s] 51%|█████     | 240/471 [00:50<00:50,  4.55it/s] 51%|█████     | 241/471 [00:50<00:49,  4.66it/s] 51%|█████▏    | 242/471 [00:50<00:49,  4.59it/s] 52%|█████▏    | 243/471 [00:51<00:50,  4.50it/s] 52%|█████▏    | 244/471 [00:51<00:49,  4.62it/s] 52%|█████▏    | 245/471 [00:51<00:49,  4.58it/s] 52%|█████▏    | 246/471 [00:51<00:47,  4.77it/s] 52%|█████▏    | 247/471 [00:51<00:48,  4.59it/s] 53%|█████▎    | 248/471 [00:52<00:48,  4.61it/s] 53%|█████▎    | 249/471 [00:52<00:49,  4.48it/s] 53%|█████▎    | 250/471 [00:52<00:47,  4.69it/s] 53%|█████▎    | 251/471 [00:52<00:47,  4.62it/s] 54%|█████▎    | 252/471 [00:53<00:45,  4.86it/s] 54%|█████▎    | 253/471 [00:53<00:46,  4.66it/s] 54%|█████▍    | 254/471 [00:53<00:46,  4.63it/s] 54%|█████▍    | 255/471 [00:53<00:47,  4.55it/s] 54%|█████▍    | 256/471 [00:53<00:46,  4.58it/s] 55%|█████▍    | 257/471 [00:54<00:46,  4.56it/s] 55%|█████▍    | 258/471 [00:54<00:45,  4.66it/s] 55%|█████▍    | 259/471 [00:54<00:45,  4.62it/s] 55%|█████▌    | 260/471 [00:54<00:46,  4.50it/s] 55%|█████▌    | 261/471 [00:55<00:45,  4.64it/s] 56%|█████▌    | 262/471 [00:55<00:45,  4.58it/s] 56%|█████▌    | 263/471 [00:55<00:43,  4.79it/s] 56%|█████▌    | 264/471 [00:55<00:44,  4.61it/s] 56%|█████▋    | 265/471 [00:55<00:43,  4.72it/s] 56%|█████▋    | 266/471 [00:56<00:45,  4.55it/s] 57%|█████▋    | 267/471 [00:56<00:42,  4.76it/s] 57%|█████▋    | 268/471 [00:56<00:44,  4.56it/s] 57%|█████▋    | 269/471 [00:56<00:42,  4.77it/s] 57%|█████▋    | 270/471 [00:56<00:44,  4.50it/s] 58%|█████▊    | 271/471 [00:57<00:43,  4.56it/s] 58%|█████▊    | 272/471 [00:57<00:43,  4.54it/s] 58%|█████▊    | 273/471 [00:57<00:42,  4.62it/s] 58%|█████▊    | 274/471 [00:57<00:41,  4.74it/s] 58%|█████▊    | 275/471 [00:58<00:42,  4.65it/s] 59%|█████▊    | 276/471 [00:58<00:42,  4.57it/s] 59%|█████▉    | 277/471 [00:58<00:42,  4.62it/s] 59%|█████▉    | 278/471 [00:58<00:42,  4.57it/s] 59%|█████▉    | 279/471 [00:58<00:40,  4.72it/s] 59%|█████▉    | 280/471 [00:59<00:41,  4.63it/s] 60%|█████▉    | 281/471 [00:59<00:41,  4.55it/s] 60%|█████▉    | 282/471 [00:59<00:41,  4.56it/s] 60%|██████    | 283/471 [00:59<00:41,  4.52it/s] 60%|██████    | 284/471 [00:59<00:40,  4.67it/s] 61%|██████    | 285/471 [01:00<00:41,  4.53it/s] 61%|██████    | 286/471 [01:00<00:39,  4.65it/s] 61%|██████    | 287/471 [01:00<00:41,  4.44it/s] 61%|██████    | 288/471 [01:00<00:39,  4.67it/s] 61%|██████▏   | 289/471 [01:01<00:40,  4.47it/s] 62%|██████▏   | 290/471 [01:01<00:37,  4.83it/s] 62%|██████▏   | 291/471 [01:01<00:38,  4.68it/s] 62%|██████▏   | 292/471 [01:01<00:38,  4.71it/s] 62%|██████▏   | 293/471 [01:01<00:39,  4.53it/s] 62%|██████▏   | 294/471 [01:02<00:38,  4.65it/s] 63%|██████▎   | 295/471 [01:02<00:38,  4.62it/s] 63%|██████▎   | 296/471 [01:02<00:37,  4.70it/s] 63%|██████▎   | 297/471 [01:02<00:37,  4.64it/s] 63%|██████▎   | 298/471 [01:03<00:38,  4.52it/s] 63%|██████▎   | 299/471 [01:03<00:37,  4.64it/s] 64%|██████▎   | 300/471 [01:03<00:37,  4.52it/s] 64%|██████▍   | 301/471 [01:03<00:35,  4.75it/s] 64%|██████▍   | 302/471 [01:03<00:37,  4.55it/s] 64%|██████▍   | 303/471 [01:04<00:35,  4.76it/s] 65%|██████▍   | 304/471 [01:04<00:37,  4.43it/s] 65%|██████▍   | 305/471 [01:04<00:34,  4.78it/s] 65%|██████▍   | 306/471 [01:04<00:36,  4.47it/s] 65%|██████▌   | 307/471 [01:04<00:34,  4.82it/s] 65%|██████▌   | 308/471 [01:05<00:36,  4.47it/s] 66%|██████▌   | 309/471 [01:05<00:35,  4.55it/s] 66%|██████▌   | 310/471 [01:05<00:34,  4.67it/s] 66%|██████▌   | 311/471 [01:05<00:35,  4.55it/s] 66%|██████▌   | 312/471 [01:06<00:32,  4.94it/s] 66%|██████▋   | 313/471 [01:06<00:34,  4.61it/s] 67%|██████▋   | 314/471 [01:06<00:32,  4.86it/s] 67%|██████▋   | 315/471 [01:06<00:34,  4.50it/s] 67%|██████▋   | 316/471 [01:06<00:31,  4.87it/s] 67%|██████▋   | 317/471 [01:07<00:33,  4.53it/s] 68%|██████▊   | 318/471 [01:07<00:31,  4.85it/s] 68%|██████▊   | 319/471 [01:07<00:33,  4.49it/s] 68%|██████▊   | 320/471 [01:07<00:32,  4.58it/s] 68%|██████▊   | 321/471 [01:07<00:32,  4.63it/s] 68%|██████▊   | 322/471 [01:08<00:32,  4.52it/s] 69%|██████▊   | 323/471 [01:08<00:28,  5.11it/s] 69%|██████▉   | 324/471 [01:08<00:31,  4.64it/s] 69%|██████▉   | 325/471 [01:08<00:29,  4.89it/s] 69%|██████▉   | 326/471 [01:09<00:31,  4.58it/s] 69%|██████▉   | 327/471 [01:09<00:29,  4.93it/s] 70%|██████▉   | 328/471 [01:09<00:30,  4.62it/s] 70%|██████▉   | 329/471 [01:09<00:28,  4.94it/s] 70%|███████   | 330/471 [01:09<00:30,  4.65it/s] 70%|███████   | 331/471 [01:10<00:30,  4.54it/s] 70%|███████   | 332/471 [01:10<00:29,  4.78it/s] 71%|███████   | 333/471 [01:10<00:29,  4.62it/s] 71%|███████   | 334/471 [01:10<00:27,  4.94it/s] 71%|███████   | 335/471 [01:10<00:29,  4.57it/s] 71%|███████▏  | 336/471 [01:11<00:27,  4.84it/s] 72%|███████▏  | 337/471 [01:11<00:29,  4.48it/s] 72%|███████▏  | 338/471 [01:11<00:27,  4.91it/s] 72%|███████▏  | 339/471 [01:11<00:29,  4.53it/s] 72%|███████▏  | 340/471 [01:11<00:27,  4.80it/s] 72%|███████▏  | 341/471 [01:12<00:28,  4.54it/s] 73%|███████▎  | 342/471 [01:12<00:28,  4.48it/s] 73%|███████▎  | 343/471 [01:12<00:27,  4.73it/s] 73%|███████▎  | 344/471 [01:12<00:27,  4.66it/s] 73%|███████▎  | 345/471 [01:13<00:25,  4.91it/s] 73%|███████▎  | 346/471 [01:13<00:26,  4.67it/s] 74%|███████▎  | 347/471 [01:13<00:26,  4.67it/s] 74%|███████▍  | 348/471 [01:13<00:27,  4.54it/s] 74%|███████▍  | 349/471 [01:13<00:26,  4.68it/s] 74%|███████▍  | 350/471 [01:14<00:26,  4.60it/s] 75%|███████▍  | 351/471 [01:14<00:25,  4.71it/s] 75%|███████▍  | 352/471 [01:14<00:26,  4.43it/s] 75%|███████▍  | 353/471 [01:14<00:25,  4.60it/s] 75%|███████▌  | 354/471 [01:15<00:26,  4.44it/s] 75%|███████▌  | 355/471 [01:15<00:24,  4.65it/s] 76%|███████▌  | 356/471 [01:15<00:25,  4.57it/s] 76%|███████▌  | 357/471 [01:15<00:23,  4.80it/s] 76%|███████▌  | 358/471 [01:15<00:23,  4.91it/s] 76%|███████▌  | 359/471 [01:16<00:22,  5.07it/s] 76%|███████▋  | 360/471 [01:16<00:21,  5.22it/s] 77%|███████▋  | 361/471 [01:16<00:20,  5.41it/s] 77%|███████▋  | 362/471 [01:16<00:20,  5.39it/s] 77%|███████▋  | 363/471 [01:16<00:20,  5.31it/s] 77%|███████▋  | 364/471 [01:16<00:19,  5.44it/s] 77%|███████▋  | 365/471 [01:17<00:19,  5.37it/s] 78%|███████▊  | 366/471 [01:17<00:18,  5.72it/s] 78%|███████▊  | 367/471 [01:17<00:18,  5.58it/s] 78%|███████▊  | 368/471 [01:17<00:16,  6.31it/s] 78%|███████▊  | 369/471 [01:17<00:16,  6.32it/s] 79%|███████▊  | 370/471 [01:17<00:15,  6.51it/s] 79%|███████▉  | 371/471 [01:18<00:16,  6.10it/s] 79%|███████▉  | 372/471 [01:18<00:16,  6.14it/s] 79%|███████▉  | 373/471 [01:18<00:16,  5.79it/s] 79%|███████▉  | 374/471 [01:18<00:16,  5.92it/s] 80%|███████▉  | 375/471 [01:18<00:16,  5.81it/s] 80%|███████▉  | 376/471 [01:18<00:16,  5.71it/s] 80%|████████  | 377/471 [01:19<00:16,  5.85it/s] 80%|████████  | 378/471 [01:19<00:15,  5.85it/s] 80%|████████  | 379/471 [01:19<00:14,  6.44it/s] 81%|████████  | 380/471 [01:19<00:14,  6.32it/s] 81%|████████  | 381/471 [01:19<00:12,  7.09it/s] 81%|████████  | 382/471 [01:19<00:13,  6.63it/s] 81%|████████▏ | 383/471 [01:19<00:12,  7.32it/s] 82%|████████▏ | 384/471 [01:20<00:12,  6.77it/s] 82%|████████▏ | 385/471 [01:20<00:12,  7.15it/s] 82%|████████▏ | 386/471 [01:20<00:11,  7.15it/s] 82%|████████▏ | 387/471 [01:20<00:12,  6.96it/s] 82%|████████▏ | 388/471 [01:20<00:11,  7.43it/s] 83%|████████▎ | 389/471 [01:20<00:11,  6.95it/s] 83%|████████▎ | 391/471 [01:21<00:11,  7.22it/s] 83%|████████▎ | 392/471 [01:21<00:10,  7.66it/s] 83%|████████▎ | 393/471 [01:21<00:11,  6.61it/s] 84%|████████▎ | 394/471 [01:21<00:11,  6.56it/s] 84%|████████▍ | 395/471 [01:21<00:11,  6.90it/s] 84%|████████▍ | 396/471 [01:21<00:11,  6.38it/s] 84%|████████▍ | 397/471 [01:21<00:10,  7.01it/s] 85%|████████▍ | 398/471 [01:22<00:11,  6.43it/s] 85%|████████▍ | 399/471 [01:22<00:11,  6.23it/s] 85%|████████▍ | 400/471 [01:22<00:13,  5.24it/s] 85%|████████▌ | 401/471 [01:22<00:13,  5.24it/s] 85%|████████▌ | 402/471 [01:23<00:14,  4.73it/s] 86%|████████▌ | 403/471 [01:23<00:13,  4.93it/s] 86%|████████▌ | 404/471 [01:23<00:14,  4.68it/s] 86%|████████▌ | 405/471 [01:23<00:14,  4.71it/s] 86%|████████▌ | 406/471 [01:23<00:14,  4.57it/s] 86%|████████▋ | 407/471 [01:24<00:13,  4.59it/s] 87%|████████▋ | 408/471 [01:24<00:13,  4.72it/s] 87%|████████▋ | 409/471 [01:24<00:13,  4.64it/s] 87%|████████▋ | 410/471 [01:24<00:12,  4.86it/s] 87%|████████▋ | 411/471 [01:24<00:13,  4.57it/s] 87%|████████▋ | 412/471 [01:25<00:12,  4.76it/s] 88%|████████▊ | 413/471 [01:25<00:12,  4.51it/s] 88%|████████▊ | 414/471 [01:25<00:11,  4.83it/s] 88%|████████▊ | 415/471 [01:25<00:12,  4.54it/s] 88%|████████▊ | 416/471 [01:26<00:11,  4.73it/s] 89%|████████▊ | 417/471 [01:26<00:12,  4.46it/s] 89%|████████▊ | 418/471 [01:26<00:10,  4.87it/s] 89%|████████▉ | 419/471 [01:26<00:10,  5.01it/s] 89%|████████▉ | 420/471 [01:26<00:09,  5.22it/s] 89%|████████▉ | 421/471 [01:26<00:09,  5.30it/s] 90%|████████▉ | 422/471 [01:27<00:09,  5.17it/s] 90%|████████▉ | 423/471 [01:27<00:08,  5.50it/s] 90%|█████████ | 424/471 [01:27<00:08,  5.29it/s] 90%|█████████ | 425/471 [01:27<00:07,  5.78it/s] 90%|█████████ | 426/471 [01:27<00:08,  5.41it/s] 91%|█████████ | 427/471 [01:28<00:07,  5.65it/s] 91%|█████████ | 428/471 [01:28<00:08,  5.31it/s] 91%|█████████ | 429/471 [01:28<00:07,  5.48it/s] 91%|█████████▏| 430/471 [01:28<00:07,  5.47it/s] 92%|█████████▏| 431/471 [01:28<00:07,  5.48it/s] 92%|█████████▏| 432/471 [01:28<00:07,  5.50it/s] 92%|█████████▏| 433/471 [01:29<00:07,  5.28it/s] 92%|█████████▏| 434/471 [01:29<00:06,  5.59it/s] 92%|█████████▏| 435/471 [01:29<00:07,  5.07it/s] 93%|█████████▎| 436/471 [01:29<00:06,  5.44it/s] 93%|█████████▎| 437/471 [01:29<00:06,  4.98it/s] 93%|█████████▎| 438/471 [01:30<00:06,  4.99it/s] 93%|█████████▎| 439/471 [01:30<00:07,  4.56it/s] 93%|█████████▎| 440/471 [01:30<00:06,  4.69it/s] 94%|█████████▎| 441/471 [01:30<00:06,  4.67it/s] 94%|█████████▍| 442/471 [01:31<00:06,  4.65it/s] 94%|█████████▍| 443/471 [01:31<00:05,  4.81it/s] 94%|█████████▍| 444/471 [01:31<00:05,  4.55it/s] 94%|█████████▍| 445/471 [01:31<00:05,  4.81it/s] 95%|█████████▍| 446/471 [01:31<00:05,  4.54it/s] 95%|█████████▍| 447/471 [01:32<00:04,  4.89it/s] 95%|█████████▌| 448/471 [01:32<00:05,  4.58it/s] 95%|█████████▌| 449/471 [01:32<00:04,  4.83it/s] 96%|█████████▌| 450/471 [01:32<00:04,  4.48it/s] 96%|█████████▌| 451/471 [01:32<00:04,  4.60it/s] 96%|█████████▌| 452/471 [01:33<00:04,  4.62it/s] 96%|█████████▌| 453/471 [01:33<00:03,  4.59it/s] 96%|█████████▋| 454/471 [01:33<00:03,  4.74it/s] 97%|█████████▋| 455/471 [01:33<00:03,  4.50it/s] 97%|█████████▋| 456/471 [01:34<00:03,  4.78it/s] 97%|█████████▋| 457/471 [01:34<00:03,  4.53it/s] 97%|█████████▋| 458/471 [01:34<00:02,  4.98it/s] 97%|█████████▋| 459/471 [01:34<00:02,  4.60it/s] 98%|█████████▊| 460/471 [01:34<00:02,  4.81it/s] 98%|█████████▊| 461/471 [01:35<00:02,  4.42it/s] 98%|█████████▊| 462/471 [01:35<00:01,  4.60it/s] 98%|█████████▊| 463/471 [01:35<00:01,  4.51it/s] 99%|█████████▊| 464/471 [01:35<00:01,  4.54it/s] 99%|█████████▊| 465/471 [01:36<00:01,  4.65it/s] 99%|█████████▉| 466/471 [01:36<00:01,  4.44it/s] 99%|█████████▉| 467/471 [01:36<00:00,  4.76it/s] 99%|█████████▉| 468/471 [01:36<00:00,  4.51it/s]100%|█████████▉| 469/471 [01:36<00:00,  5.07it/s]100%|█████████▉| 470/471 [01:37<00:00,  4.60it/s]100%|██████████| 471/471 [01:37<00:00,  4.88it/s]100%|██████████| 471/471 [01:37<00:00,  4.84it/s]
{'eval_loss': 2.0650651454925537, 'eval_model_preparation_time': 0.0045, 'eval_acc': 0.48141263940520446, 'eval_runtime': 97.5116, 'eval_samples_per_second': 77.242, 'eval_steps_per_second': 4.83}
ROUND:13
CLIENT:14
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  trainer = Trainer(
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.33it/s]                                              {'loss': 2.099, 'grad_norm': 6.063000679016113, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.33it/s]  5%|▌         | 2/40 [00:00<00:16,  2.32it/s]                                              {'loss': 2.2265, 'grad_norm': 3.7120089530944824, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.32it/s]  8%|▊         | 3/40 [00:01<00:15,  2.40it/s]                                              {'loss': 1.9498, 'grad_norm': 5.212320804595947, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.40it/s] 10%|█         | 4/40 [00:01<00:14,  2.55it/s]                                              {'loss': 2.2073, 'grad_norm': 6.734289169311523, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:14,  2.55it/s] 12%|█▎        | 5/40 [00:02<00:13,  2.53it/s]                                              {'loss': 2.1617, 'grad_norm': 4.703221797943115, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:13,  2.53it/s] 15%|█▌        | 6/40 [00:02<00:13,  2.53it/s]                                              {'loss': 2.3357, 'grad_norm': 4.4966254234313965, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:13,  2.53it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.56it/s]                                              {'loss': 2.3312, 'grad_norm': 4.681884765625, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.56it/s] 20%|██        | 8/40 [00:02<00:09,  3.28it/s]                                              {'loss': 1.9891, 'grad_norm': 54.98628234863281, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:09,  3.28it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.93it/s]                                              {'loss': 2.1619, 'grad_norm': 6.544932842254639, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.93it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.72it/s]                                               {'loss': 1.9981, 'grad_norm': 4.713042259216309, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.72it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.51it/s]                                               {'loss': 2.0353, 'grad_norm': 3.3707222938537598, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.51it/s] 30%|███       | 12/40 [00:04<00:11,  2.43it/s]                                               {'loss': 2.1851, 'grad_norm': 4.637601375579834, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:11,  2.43it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s]                                               {'loss': 2.1288, 'grad_norm': 5.8768815994262695, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.36it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s]                                               {'loss': 2.0251, 'grad_norm': 4.390827655792236, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.30it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.32it/s]                                               {'loss': 1.9897, 'grad_norm': 4.670158386230469, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.32it/s] 40%|████      | 16/40 [00:06<00:08,  2.92it/s]                                               {'loss': 1.9134, 'grad_norm': 26.84272575378418, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.92it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.61it/s]                                               {'loss': 1.8053, 'grad_norm': 4.511887073516846, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.61it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 1.9015, 'grad_norm': 4.499812602996826, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.38it/s]                                               {'loss': 2.0892, 'grad_norm': 3.3095428943634033, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.38it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 1.9676, 'grad_norm': 4.324430465698242, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s]                                               {'loss': 2.1492, 'grad_norm': 5.284371852874756, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.28it/s] 55%|█████▌    | 22/40 [00:08<00:08,  2.23it/s]                                               {'loss': 2.1247, 'grad_norm': 3.8737876415252686, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:08,  2.23it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s]                                               {'loss': 1.8039, 'grad_norm': 3.075274705886841, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.22it/s] 60%|██████    | 24/40 [00:09<00:05,  2.81it/s]                                               {'loss': 1.8643, 'grad_norm': 10.659016609191895, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.81it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.57it/s]                                               {'loss': 1.978, 'grad_norm': 6.7855610847473145, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.57it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.40it/s]                                               {'loss': 1.8407, 'grad_norm': 4.032538414001465, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.40it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.32it/s]                                               {'loss': 2.0433, 'grad_norm': 4.026661396026611, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.32it/s] 70%|███████   | 28/40 [00:11<00:05,  2.26it/s]                                               {'loss': 1.8741, 'grad_norm': 3.9744086265563965, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.26it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s]                                               {'loss': 2.2552, 'grad_norm': 3.915807008743286, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.25it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.21it/s]                                               {'loss': 1.9886, 'grad_norm': 3.907036781311035, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.21it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.19it/s]                                               {'loss': 1.8291, 'grad_norm': 3.3091888427734375, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.19it/s] 80%|████████  | 32/40 [00:12<00:02,  2.82it/s]                                               {'loss': 2.3703, 'grad_norm': 13.52034854888916, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.82it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.60it/s]                                               {'loss': 1.9148, 'grad_norm': 3.271946430206299, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.60it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s]                                               {'loss': 1.8841, 'grad_norm': 3.4848971366882324, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.47it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s]                                               {'loss': 1.9926, 'grad_norm': 4.248549938201904, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.42it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.35it/s]                                               {'loss': 1.9369, 'grad_norm': 5.027466773986816, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.35it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s]                                               {'loss': 2.1412, 'grad_norm': 4.093881607055664, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.30it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.30it/s]                                               {'loss': 2.04, 'grad_norm': 3.8138339519500732, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.30it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]                                               {'loss': 1.6931, 'grad_norm': 3.4091696739196777, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.24it/s]100%|██████████| 40/40 [00:16<00:00,  2.79it/s]                                               {'loss': 1.5188, 'grad_norm': 13.661322593688965, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.79it/s]                                               {'train_runtime': 16.3156, 'train_samples_per_second': 34.629, 'train_steps_per_second': 2.452, 'train_loss': 2.018606424331665, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.79it/s]100%|██████████| 40/40 [00:16<00:00,  2.45it/s]
CLIENT:74
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  logging_steps=1)
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]                                              {'loss': 2.5702, 'grad_norm': 6.4251484870910645, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.22it/s]  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]                                              {'loss': 2.138, 'grad_norm': 3.5208194255828857, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.18it/s]  8%|▊         | 3/40 [00:01<00:17,  2.14it/s]                                              {'loss': 2.1086, 'grad_norm': 3.7699079513549805, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.14it/s] 10%|█         | 4/40 [00:01<00:16,  2.12it/s]                                              {'loss': 2.4037, 'grad_norm': 6.338757514953613, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.12it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s]                                              {'loss': 2.3081, 'grad_norm': 3.7453150749206543, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.15it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s]                                              {'loss': 2.546, 'grad_norm': 4.541115760803223, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.13it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s]                                              {'loss': 2.2248, 'grad_norm': 5.226964950561523, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.14it/s]                                              {'loss': 3.3127, 'grad_norm': 15.14012336730957, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:14,  2.14it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.85it/s]                                              {'loss': 2.3617, 'grad_norm': 4.761575222015381, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.85it/s] 25%|██▌       | 10/40 [00:04<00:10,  2.81it/s]                                               {'loss': 2.1308, 'grad_norm': 3.348475456237793, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:10,  2.81it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.77it/s]                                               {'loss': 2.3083, 'grad_norm': 4.065670490264893, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.77it/s] 30%|███       | 12/40 [00:04<00:10,  2.74it/s]                                               {'loss': 2.3056, 'grad_norm': 4.509708404541016, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.74it/s] 32%|███▎      | 13/40 [00:05<00:09,  2.72it/s]                                               {'loss': 2.0938, 'grad_norm': 4.29052734375, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:09,  2.72it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.70it/s]                                               {'loss': 2.3073, 'grad_norm': 4.439016819000244, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.70it/s] 38%|███▊      | 15/40 [00:05<00:09,  2.70it/s]                                               {'loss': 2.39, 'grad_norm': 3.7480249404907227, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:05<00:09,  2.70it/s]                                               {'loss': 1.7242, 'grad_norm': 12.085648536682129, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.70it/s] 42%|████▎     | 17/40 [00:06<00:06,  3.29it/s]                                               {'loss': 2.2325, 'grad_norm': 3.2696144580841064, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:06,  3.29it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.16it/s]                                               {'loss': 2.2377, 'grad_norm': 3.775219678878784, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.16it/s] 48%|████▊     | 19/40 [00:07<00:06,  3.04it/s]                                               {'loss': 1.8542, 'grad_norm': 3.6485655307769775, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:06,  3.04it/s] 50%|█████     | 20/40 [00:07<00:07,  2.84it/s]                                               {'loss': 2.3282, 'grad_norm': 3.9701521396636963, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:07,  2.84it/s] 52%|█████▎    | 21/40 [00:08<00:07,  2.60it/s]                                               {'loss': 2.2136, 'grad_norm': 4.4743523597717285, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:07,  2.60it/s] 55%|█████▌    | 22/40 [00:08<00:07,  2.49it/s]                                               {'loss': 2.2145, 'grad_norm': 4.1602935791015625, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:07,  2.49it/s] 57%|█████▊    | 23/40 [00:08<00:07,  2.38it/s]                                               {'loss': 2.0605, 'grad_norm': 3.6697564125061035, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:07,  2.38it/s] 60%|██████    | 24/40 [00:09<00:05,  2.94it/s]                                               {'loss': 2.1192, 'grad_norm': 12.95002269744873, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.94it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s]                                               {'loss': 2.3029, 'grad_norm': 4.851267337799072, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.68it/s] 65%|██████▌   | 26/40 [00:09<00:05,  2.52it/s]                                               {'loss': 2.0932, 'grad_norm': 3.9120728969573975, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:05,  2.52it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.40it/s]                                               {'loss': 2.1652, 'grad_norm': 4.078273773193359, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.40it/s] 70%|███████   | 28/40 [00:10<00:05,  2.40it/s]                                               {'loss': 2.1507, 'grad_norm': 3.90063214302063, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:05,  2.40it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.31it/s]                                               {'loss': 2.0744, 'grad_norm': 4.636314392089844, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.31it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.28it/s]                                               {'loss': 2.2652, 'grad_norm': 3.6700141429901123, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.28it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.27it/s]                                               {'loss': 2.3735, 'grad_norm': 4.547078609466553, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.27it/s] 80%|████████  | 32/40 [00:12<00:02,  2.83it/s]                                               {'loss': 0.8856, 'grad_norm': 5.81955623626709, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  2.83it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.58it/s]                                               {'loss': 1.983, 'grad_norm': 3.821716785430908, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.58it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.50it/s]                                               {'loss': 2.1651, 'grad_norm': 3.9439690113067627, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.50it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.36it/s]                                               {'loss': 2.1565, 'grad_norm': 3.3215343952178955, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.36it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.32it/s]                                               {'loss': 1.9719, 'grad_norm': 4.478612422943115, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.32it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.28it/s]                                               {'loss': 2.3618, 'grad_norm': 3.6827805042266846, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.24it/s]                                               {'loss': 2.1789, 'grad_norm': 3.8526272773742676, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.24it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]                                               {'loss': 2.1475, 'grad_norm': 3.112212896347046, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.29it/s]100%|██████████| 40/40 [00:15<00:00,  2.95it/s]                                               {'loss': 2.434, 'grad_norm': 10.050516128540039, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.95it/s]                                               {'train_runtime': 15.7424, 'train_samples_per_second': 35.89, 'train_steps_per_second': 2.541, 'train_loss': 2.205094349384308, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.95it/s]100%|██████████| 40/40 [00:15<00:00,  2.54it/s]
CLIENT:15
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]                                              {'loss': 2.07, 'grad_norm': 5.008589744567871, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:29,  1.33it/s]  5%|▌         | 2/40 [00:01<00:21,  1.73it/s]                                              {'loss': 2.2436, 'grad_norm': 4.433249473571777, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:21,  1.73it/s]  8%|▊         | 3/40 [00:01<00:19,  1.86it/s]                                              {'loss': 1.952, 'grad_norm': 3.8218319416046143, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:19,  1.86it/s] 10%|█         | 4/40 [00:02<00:18,  1.97it/s]                                              {'loss': 1.9636, 'grad_norm': 3.541476249694824, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:18,  1.97it/s] 12%|█▎        | 5/40 [00:02<00:17,  2.03it/s]                                              {'loss': 1.9981, 'grad_norm': 3.285465955734253, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:17,  2.03it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.06it/s]                                              {'loss': 2.4557, 'grad_norm': 5.252508163452148, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.06it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.09it/s]                                              {'loss': 2.1933, 'grad_norm': 5.074090957641602, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.09it/s] 20%|██        | 8/40 [00:03<00:12,  2.53it/s]                                              {'loss': 1.7509, 'grad_norm': 11.505074501037598, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:12,  2.53it/s] 22%|██▎       | 9/40 [00:04<00:12,  2.40it/s]                                              {'loss': 1.9817, 'grad_norm': 4.3826704025268555, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:12,  2.40it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.35it/s]                                               {'loss': 1.9646, 'grad_norm': 3.342602014541626, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.35it/s] 28%|██▊       | 11/40 [00:05<00:12,  2.28it/s]                                               {'loss': 1.9875, 'grad_norm': 4.433927059173584, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:12,  2.28it/s] 30%|███       | 12/40 [00:05<00:12,  2.29it/s]                                               {'loss': 2.1752, 'grad_norm': 3.972951650619507, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.29it/s] 32%|███▎      | 13/40 [00:06<00:11,  2.31it/s]                                               {'loss': 2.005, 'grad_norm': 4.373712539672852, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:11,  2.31it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s]                                               {'loss': 2.1036, 'grad_norm': 4.559730052947998, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s]                                               {'loss': 1.8527, 'grad_norm': 4.179138660430908, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.24it/s] 40%|████      | 16/40 [00:07<00:08,  2.83it/s]                                               {'loss': 2.3955, 'grad_norm': 13.412557601928711, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.83it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s]                                               {'loss': 1.9364, 'grad_norm': 3.8066554069519043, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.57it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.47it/s]                                               {'loss': 1.9298, 'grad_norm': 3.298957347869873, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:08,  2.47it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s]                                               {'loss': 2.1272, 'grad_norm': 3.2591135501861572, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.40it/s] 50%|█████     | 20/40 [00:08<00:08,  2.35it/s]                                               {'loss': 1.994, 'grad_norm': 4.15117883682251, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.35it/s] 52%|█████▎    | 21/40 [00:09<00:07,  2.39it/s]                                               {'loss': 2.112, 'grad_norm': 3.4149892330169678, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:07,  2.39it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s]                                               {'loss': 1.8055, 'grad_norm': 3.340442180633545, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.32it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.32it/s]                                               {'loss': 1.957, 'grad_norm': 4.951134204864502, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.32it/s] 60%|██████    | 24/40 [00:10<00:05,  2.90it/s]                                               {'loss': 2.2704, 'grad_norm': 12.45640754699707, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.90it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s]                                               {'loss': 1.9116, 'grad_norm': 4.1204328536987305, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.63it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s]                                               {'loss': 1.9728, 'grad_norm': 3.8101537227630615, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.51it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.43it/s]                                               {'loss': 1.8882, 'grad_norm': 4.213939189910889, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.43it/s] 70%|███████   | 28/40 [00:12<00:05,  2.31it/s]                                               {'loss': 1.7484, 'grad_norm': 3.6029889583587646, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.31it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s]                                               {'loss': 2.1707, 'grad_norm': 3.94926381111145, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.28it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.23it/s]                                               {'loss': 1.7694, 'grad_norm': 4.33656644821167, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.23it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.104, 'grad_norm': 4.632511138916016, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s] 80%|████████  | 32/40 [00:13<00:02,  2.78it/s]                                               {'loss': 1.1105, 'grad_norm': 9.135662078857422, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.78it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.62it/s]                                               {'loss': 2.0855, 'grad_norm': 4.179183483123779, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.62it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s]                                               {'loss': 1.6573, 'grad_norm': 3.154289722442627, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.41it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.30it/s]                                               {'loss': 1.8161, 'grad_norm': 3.1683473587036133, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.30it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.24it/s]                                               {'loss': 1.9196, 'grad_norm': 2.7645576000213623, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.24it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.19it/s]                                               {'loss': 1.9405, 'grad_norm': 4.636901378631592, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.19it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.19it/s]                                               {'loss': 2.0465, 'grad_norm': 6.6697611808776855, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.19it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.14it/s]                                               {'loss': 1.8319, 'grad_norm': 3.550309658050537, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.14it/s]                                               {'loss': 2.2098, 'grad_norm': 11.722312927246094, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.14it/s]                                               {'train_runtime': 17.1607, 'train_samples_per_second': 32.924, 'train_steps_per_second': 2.331, 'train_loss': 1.9852031081914903, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.14it/s]100%|██████████| 40/40 [00:17<00:00,  2.33it/s]
CLIENT:4
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:17,  2.17it/s]                                              {'loss': 1.8571, 'grad_norm': 4.239661693572998, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:17,  2.17it/s]  5%|▌         | 2/40 [00:00<00:17,  2.16it/s]                                              {'loss': 2.0481, 'grad_norm': 4.800220012664795, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:17,  2.16it/s]  8%|▊         | 3/40 [00:01<00:17,  2.13it/s]                                              {'loss': 2.3396, 'grad_norm': 4.303920745849609, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:17,  2.13it/s] 10%|█         | 4/40 [00:01<00:16,  2.15it/s]                                              {'loss': 2.2853, 'grad_norm': 4.284611225128174, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.15it/s] 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s]                                              {'loss': 2.3107, 'grad_norm': 3.5827603340148926, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:16,  2.16it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s]                                              {'loss': 2.0234, 'grad_norm': 3.923750162124634, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.14it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s]                                              {'loss': 2.4917, 'grad_norm': 6.399054050445557, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.17it/s] 20%|██        | 8/40 [00:03<00:11,  2.89it/s]                                              {'loss': 2.4009, 'grad_norm': 11.485548973083496, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.89it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s]                                              {'loss': 2.21, 'grad_norm': 3.9962263107299805, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.63it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.50it/s]                                               {'loss': 2.1354, 'grad_norm': 3.6909308433532715, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.50it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.39it/s]                                               {'loss': 1.9687, 'grad_norm': 2.802910089492798, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.39it/s] 30%|███       | 12/40 [00:05<00:12,  2.31it/s]                                               {'loss': 2.0897, 'grad_norm': 3.7637834548950195, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.31it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.29it/s]                                               {'loss': 2.098, 'grad_norm': 3.5765907764434814, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.29it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.1368, 'grad_norm': 3.970794677734375, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s]                                               {'loss': 2.2289, 'grad_norm': 3.675783157348633, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.23it/s] 40%|████      | 16/40 [00:06<00:08,  2.85it/s]                                               {'loss': 1.6748, 'grad_norm': 18.14772605895996, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.85it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s]                                               {'loss': 1.8411, 'grad_norm': 2.912395715713501, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.56it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s]                                               {'loss': 2.2402, 'grad_norm': 4.037979602813721, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.45it/s] 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s]                                               {'loss': 2.0802, 'grad_norm': 3.681511640548706, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:08,  2.36it/s] 50%|█████     | 20/40 [00:08<00:08,  2.29it/s]                                               {'loss': 2.2456, 'grad_norm': 6.012470722198486, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.29it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.0375, 'grad_norm': 4.3490095138549805, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.20it/s]                                               {'loss': 2.1176, 'grad_norm': 5.690539360046387, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.20it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s]                                               {'loss': 2.1542, 'grad_norm': 6.148693561553955, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s] 60%|██████    | 24/40 [00:10<00:05,  2.84it/s]                                               {'loss': 2.5333, 'grad_norm': 14.380674362182617, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.84it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.72it/s]                                               {'loss': 2.1071, 'grad_norm': 3.9996590614318848, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.72it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.69it/s]                                               {'loss': 2.0689, 'grad_norm': 4.436830997467041, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.69it/s] 68%|██████▊   | 27/40 [00:11<00:04,  2.66it/s]                                               {'loss': 2.0611, 'grad_norm': 3.5344653129577637, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:04,  2.66it/s] 70%|███████   | 28/40 [00:11<00:04,  2.64it/s]                                               {'loss': 2.186, 'grad_norm': 4.09882116317749, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:04,  2.64it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.64it/s]                                               {'loss': 2.0988, 'grad_norm': 4.2327446937561035, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.64it/s] 75%|███████▌  | 30/40 [00:12<00:03,  2.64it/s]                                               {'loss': 2.0031, 'grad_norm': 3.848065137863159, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:03,  2.64it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.66it/s]                                               {'loss': 2.0227, 'grad_norm': 3.9327142238616943, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.66it/s]                                               {'loss': 1.7433, 'grad_norm': 12.43701457977295, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:03,  2.66it/s] 82%|████████▎ | 33/40 [00:13<00:02,  3.26it/s]                                               {'loss': 2.1291, 'grad_norm': 3.594268321990967, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  3.26it/s] 85%|████████▌ | 34/40 [00:13<00:01,  3.10it/s]                                               {'loss': 2.1354, 'grad_norm': 3.9203414916992188, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:01,  3.10it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.98it/s]                                               {'loss': 2.004, 'grad_norm': 3.1934499740600586, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.98it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.71it/s]                                               {'loss': 2.0655, 'grad_norm': 3.5372207164764404, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.71it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.52it/s]                                               {'loss': 2.0268, 'grad_norm': 4.199440002441406, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.52it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.51it/s]                                               {'loss': 2.2863, 'grad_norm': 4.160023212432861, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.51it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.57it/s]                                               {'loss': 1.7913, 'grad_norm': 3.467722177505493, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.57it/s]100%|██████████| 40/40 [00:15<00:00,  3.22it/s]                                               {'loss': 2.2785, 'grad_norm': 16.2435302734375, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.22it/s]                                               {'train_runtime': 15.8135, 'train_samples_per_second': 35.729, 'train_steps_per_second': 2.529, 'train_loss': 2.1139216482639314, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.22it/s]100%|██████████| 40/40 [00:15<00:00,  2.53it/s]
CLIENT:32
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:46,  1.19s/it]                                              {'loss': 2.2225, 'grad_norm': 4.620304107666016, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:46,  1.19s/it]  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]                                              {'loss': 2.0141, 'grad_norm': 4.198461532592773, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.32it/s]  8%|▊         | 3/40 [00:02<00:22,  1.63it/s]                                              {'loss': 2.2021, 'grad_norm': 4.653006076812744, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:22,  1.63it/s] 10%|█         | 4/40 [00:02<00:20,  1.79it/s]                                              {'loss': 2.1896, 'grad_norm': 3.933610439300537, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:20,  1.79it/s] 12%|█▎        | 5/40 [00:03<00:18,  1.93it/s]                                              {'loss': 2.0522, 'grad_norm': 3.7008509635925293, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:18,  1.93it/s] 15%|█▌        | 6/40 [00:03<00:16,  2.01it/s]                                              {'loss': 2.2832, 'grad_norm': 3.9484450817108154, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:16,  2.01it/s] 18%|█▊        | 7/40 [00:03<00:15,  2.07it/s]                                              {'loss': 2.0696, 'grad_norm': 4.5320000648498535, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:15,  2.07it/s] 20%|██        | 8/40 [00:04<00:11,  2.67it/s]                                              {'loss': 2.3167, 'grad_norm': 18.720718383789062, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:11,  2.67it/s] 22%|██▎       | 9/40 [00:04<00:12,  2.57it/s]                                              {'loss': 2.2371, 'grad_norm': 3.7875843048095703, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:12,  2.57it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s]                                               {'loss': 2.0172, 'grad_norm': 4.675245761871338, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.39it/s] 28%|██▊       | 11/40 [00:05<00:12,  2.33it/s]                                               {'loss': 2.1563, 'grad_norm': 4.050908088684082, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:12,  2.33it/s] 30%|███       | 12/40 [00:05<00:12,  2.27it/s]                                               {'loss': 2.1565, 'grad_norm': 5.7667236328125, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.27it/s] 32%|███▎      | 13/40 [00:06<00:12,  2.23it/s]                                               {'loss': 2.0787, 'grad_norm': 5.65358829498291, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:12,  2.23it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s]                                               {'loss': 1.9283, 'grad_norm': 3.7117652893066406, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.26it/s] 38%|███▊      | 15/40 [00:07<00:11,  2.22it/s]                                               {'loss': 2.0324, 'grad_norm': 4.826035022735596, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:07<00:11,  2.22it/s] 40%|████      | 16/40 [00:07<00:08,  2.79it/s]                                               {'loss': 2.109, 'grad_norm': 16.700178146362305, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:07<00:08,  2.79it/s] 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s]                                               {'loss': 2.1226, 'grad_norm': 4.712510108947754, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:08,  2.59it/s] 45%|████▌     | 18/40 [00:08<00:09,  2.40it/s]                                               {'loss': 2.1415, 'grad_norm': 3.570619821548462, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:08<00:09,  2.40it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.31it/s]                                               {'loss': 2.295, 'grad_norm': 4.1895060539245605, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:09,  2.31it/s] 50%|█████     | 20/40 [00:09<00:08,  2.30it/s]                                               {'loss': 2.1761, 'grad_norm': 4.106415271759033, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:09<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:09<00:08,  2.22it/s]                                               {'loss': 1.9046, 'grad_norm': 4.962963104248047, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:09<00:08,  2.22it/s] 55%|█████▌    | 22/40 [00:10<00:08,  2.21it/s]                                               {'loss': 1.8524, 'grad_norm': 3.804778814315796, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:10<00:08,  2.21it/s] 57%|█████▊    | 23/40 [00:10<00:07,  2.16it/s]                                               {'loss': 1.8782, 'grad_norm': 4.391207695007324, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:10<00:07,  2.16it/s] 60%|██████    | 24/40 [00:10<00:05,  2.82it/s]                                               {'loss': 2.2768, 'grad_norm': 24.67805290222168, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:05,  2.82it/s] 62%|██████▎   | 25/40 [00:11<00:05,  2.61it/s]                                               {'loss': 2.1126, 'grad_norm': 4.020736217498779, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:11<00:05,  2.61it/s] 65%|██████▌   | 26/40 [00:11<00:05,  2.41it/s]                                               {'loss': 1.8883, 'grad_norm': 3.693758010864258, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:11<00:05,  2.41it/s] 68%|██████▊   | 27/40 [00:12<00:05,  2.32it/s]                                               {'loss': 1.9574, 'grad_norm': 3.4017090797424316, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:12<00:05,  2.32it/s] 70%|███████   | 28/40 [00:12<00:05,  2.31it/s]                                               {'loss': 2.0793, 'grad_norm': 3.932908773422241, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:12<00:05,  2.31it/s] 72%|███████▎  | 29/40 [00:13<00:04,  2.22it/s]                                               {'loss': 2.1018, 'grad_norm': 3.8320229053497314, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:13<00:04,  2.22it/s] 75%|███████▌  | 30/40 [00:13<00:04,  2.21it/s]                                               {'loss': 2.1203, 'grad_norm': 4.460232257843018, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:13<00:04,  2.21it/s] 78%|███████▊  | 31/40 [00:14<00:04,  2.20it/s]                                               {'loss': 2.0768, 'grad_norm': 5.225499153137207, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:14<00:04,  2.20it/s]                                               {'loss': 1.5355, 'grad_norm': 7.738250255584717, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:14<00:03,  2.20it/s] 82%|████████▎ | 33/40 [00:14<00:02,  2.73it/s]                                               {'loss': 2.0522, 'grad_norm': 5.386434555053711, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:14<00:02,  2.73it/s] 85%|████████▌ | 34/40 [00:15<00:02,  2.58it/s]                                               {'loss': 2.0413, 'grad_norm': 3.855783462524414, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:15<00:02,  2.58it/s] 88%|████████▊ | 35/40 [00:15<00:02,  2.46it/s]                                               {'loss': 1.9284, 'grad_norm': 4.140734672546387, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:15<00:02,  2.46it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.41it/s]                                               {'loss': 2.0578, 'grad_norm': 5.129749774932861, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.41it/s] 92%|█████████▎| 37/40 [00:16<00:01,  2.31it/s]                                               {'loss': 1.8813, 'grad_norm': 5.068925380706787, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:16<00:01,  2.31it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.28it/s]                                               {'loss': 2.1185, 'grad_norm': 3.8257412910461426, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.28it/s] 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]                                               {'loss': 1.7384, 'grad_norm': 4.106136322021484, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:17<00:00,  2.26it/s]100%|██████████| 40/40 [00:17<00:00,  2.83it/s]                                               {'loss': 2.117, 'grad_norm': 10.723005294799805, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.83it/s]                                               {'train_runtime': 17.5352, 'train_samples_per_second': 32.221, 'train_steps_per_second': 2.281, 'train_loss': 2.06299010515213, 'epoch': 5.0}
100%|██████████| 40/40 [00:17<00:00,  2.83it/s]100%|██████████| 40/40 [00:17<00:00,  2.28it/s]
CLIENT:59
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:16,  2.34it/s]                                              {'loss': 1.9093, 'grad_norm': 5.920739650726318, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:16,  2.34it/s]  5%|▌         | 2/40 [00:00<00:16,  2.32it/s]                                              {'loss': 2.2914, 'grad_norm': 5.845128536224365, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.32it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.3524, 'grad_norm': 4.572526454925537, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:16,  2.24it/s]                                              {'loss': 2.1149, 'grad_norm': 5.168755054473877, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.24it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s]                                              {'loss': 2.0328, 'grad_norm': 4.24427604675293, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.20it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s]                                              {'loss': 2.2982, 'grad_norm': 5.668216228485107, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s]                                              {'loss': 2.1138, 'grad_norm': 3.697434663772583, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.20it/s] 20%|██        | 8/40 [00:03<00:11,  2.85it/s]                                              {'loss': 1.9256, 'grad_norm': 12.162163734436035, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.85it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.62it/s]                                              {'loss': 2.205, 'grad_norm': 3.9635262489318848, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.62it/s] 25%|██▌       | 10/40 [00:04<00:12,  2.47it/s]                                               {'loss': 2.0841, 'grad_norm': 6.40955114364624, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:12,  2.47it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.34it/s]                                               {'loss': 2.1193, 'grad_norm': 3.543797016143799, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.34it/s] 30%|███       | 12/40 [00:05<00:12,  2.30it/s]                                               {'loss': 2.1272, 'grad_norm': 3.2634482383728027, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:05<00:12,  2.30it/s] 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s]                                               {'loss': 2.2028, 'grad_norm': 4.486992359161377, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:11,  2.27it/s] 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s]                                               {'loss': 1.9433, 'grad_norm': 4.7075910568237305, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:06<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s]                                               {'loss': 1.8253, 'grad_norm': 4.323141098022461, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.25it/s] 40%|████      | 16/40 [00:06<00:08,  2.82it/s]                                               {'loss': 1.6813, 'grad_norm': 10.459845542907715, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.82it/s] 42%|████▎     | 17/40 [00:07<00:09,  2.55it/s]                                               {'loss': 2.0027, 'grad_norm': 3.5014169216156006, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:07<00:09,  2.55it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s]                                               {'loss': 2.0304, 'grad_norm': 4.689862251281738, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.43it/s] 48%|████▊     | 19/40 [00:08<00:09,  2.29it/s]                                               {'loss': 2.0029, 'grad_norm': 3.3782081604003906, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:08<00:09,  2.29it/s] 50%|█████     | 20/40 [00:08<00:08,  2.25it/s]                                               {'loss': 2.2152, 'grad_norm': 4.6700825691223145, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.25it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s]                                               {'loss': 2.0648, 'grad_norm': 5.961918830871582, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.27it/s] 55%|█████▌    | 22/40 [00:09<00:08,  2.19it/s]                                               {'loss': 1.4841, 'grad_norm': 3.145045757293701, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.19it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.17it/s]                                               {'loss': 2.1754, 'grad_norm': 3.9480037689208984, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.17it/s]                                               {'loss': 2.5592, 'grad_norm': 19.17392349243164, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:10<00:07,  2.17it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.68it/s]                                               {'loss': 1.9443, 'grad_norm': 3.830803632736206, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.68it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s]                                               {'loss': 1.9628, 'grad_norm': 3.2382616996765137, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.53it/s] 68%|██████▊   | 27/40 [00:11<00:05,  2.44it/s]                                               {'loss': 2.0375, 'grad_norm': 3.976278305053711, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:11<00:05,  2.44it/s] 70%|███████   | 28/40 [00:11<00:05,  2.33it/s]                                               {'loss': 1.7266, 'grad_norm': 3.3865931034088135, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.33it/s] 72%|███████▎  | 29/40 [00:12<00:04,  2.31it/s]                                               {'loss': 2.2166, 'grad_norm': 3.4568030834198, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:12<00:04,  2.31it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s]                                               {'loss': 2.0821, 'grad_norm': 3.8833816051483154, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.24it/s] 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s]                                               {'loss': 1.9077, 'grad_norm': 4.924076557159424, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:13<00:04,  2.21it/s] 80%|████████  | 32/40 [00:13<00:02,  2.79it/s]                                               {'loss': 1.9762, 'grad_norm': 57.6657600402832, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.79it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.54it/s]                                               {'loss': 2.112, 'grad_norm': 3.3555779457092285, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.54it/s] 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s]                                               {'loss': 1.8415, 'grad_norm': 4.695751667022705, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:14<00:02,  2.43it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s]                                               {'loss': 1.8111, 'grad_norm': 3.5604171752929688, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.37it/s] 90%|█████████ | 36/40 [00:15<00:01,  2.27it/s]                                               {'loss': 1.8898, 'grad_norm': 2.9136030673980713, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:15<00:01,  2.27it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s]                                               {'loss': 1.9378, 'grad_norm': 3.4337689876556396, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.26it/s] 95%|█████████▌| 38/40 [00:16<00:00,  2.21it/s]                                               {'loss': 2.2804, 'grad_norm': 3.4723386764526367, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:16<00:00,  2.21it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.19it/s]                                               {'loss': 1.6298, 'grad_norm': 3.3879923820495605, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.19it/s]100%|██████████| 40/40 [00:16<00:00,  2.76it/s]                                               {'loss': 2.5611, 'grad_norm': 16.8778133392334, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.76it/s]                                               {'train_runtime': 16.8476, 'train_samples_per_second': 33.536, 'train_steps_per_second': 2.374, 'train_loss': 2.0419674634933473, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.76it/s]100%|██████████| 40/40 [00:16<00:00,  2.37it/s]
CLIENT:91
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:14,  2.67it/s]                                              {'loss': 2.0655, 'grad_norm': 5.605532646179199, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:14,  2.67it/s]  5%|▌         | 2/40 [00:00<00:14,  2.66it/s]                                              {'loss': 2.1172, 'grad_norm': 5.527517318725586, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:14,  2.66it/s]  8%|▊         | 3/40 [00:01<00:13,  2.66it/s]                                              {'loss': 2.174, 'grad_norm': 3.911633014678955, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:13,  2.66it/s] 10%|█         | 4/40 [00:01<00:13,  2.66it/s]                                              {'loss': 2.4629, 'grad_norm': 5.878452777862549, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:13,  2.66it/s] 12%|█▎        | 5/40 [00:01<00:13,  2.66it/s]                                              {'loss': 2.28, 'grad_norm': 4.64215087890625, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:01<00:13,  2.66it/s] 15%|█▌        | 6/40 [00:02<00:12,  2.66it/s]                                              {'loss': 2.352, 'grad_norm': 6.20076322555542, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:12,  2.66it/s] 18%|█▊        | 7/40 [00:02<00:12,  2.64it/s]                                              {'loss': 1.9819, 'grad_norm': 5.0889129638671875, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:02<00:12,  2.64it/s] 20%|██        | 8/40 [00:02<00:10,  3.01it/s]                                              {'loss': 1.6566, 'grad_norm': 9.269380569458008, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:02<00:10,  3.01it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.71it/s]                                              {'loss': 2.2584, 'grad_norm': 4.556645393371582, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.71it/s] 25%|██▌       | 10/40 [00:03<00:11,  2.51it/s]                                               {'loss': 2.0087, 'grad_norm': 4.989811897277832, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:03<00:11,  2.51it/s] 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s]                                               {'loss': 2.1515, 'grad_norm': 5.583597183227539, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:12,  2.40it/s] 30%|███       | 12/40 [00:04<00:12,  2.29it/s]                                               {'loss': 2.0668, 'grad_norm': 5.399936676025391, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:12,  2.29it/s] 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s]                                               {'loss': 2.0659, 'grad_norm': 3.5073094367980957, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:12,  2.25it/s] 35%|███▌      | 14/40 [00:05<00:11,  2.23it/s]                                               {'loss': 2.2325, 'grad_norm': 4.061418533325195, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:11,  2.23it/s] 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s]                                               {'loss': 1.8913, 'grad_norm': 3.9307196140289307, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:11,  2.20it/s] 40%|████      | 16/40 [00:06<00:08,  2.84it/s]                                               {'loss': 1.6041, 'grad_norm': 22.84108543395996, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:08,  2.84it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.58it/s]                                               {'loss': 2.0319, 'grad_norm': 4.021299362182617, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.58it/s] 45%|████▌     | 18/40 [00:07<00:09,  2.42it/s]                                               {'loss': 2.0448, 'grad_norm': 6.2308220863342285, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:09,  2.42it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.35it/s]                                               {'loss': 2.1579, 'grad_norm': 3.3419737815856934, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.25it/s]                                               {'loss': 1.8776, 'grad_norm': 4.129878520965576, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.25it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.23it/s]                                               {'loss': 1.8529, 'grad_norm': 4.13226318359375, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.23it/s] 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s]                                               {'loss': 2.2042, 'grad_norm': 5.761984348297119, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:07,  2.26it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.1374, 'grad_norm': 5.017351150512695, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.32it/s]                                               {'loss': 2.3657, 'grad_norm': 18.460386276245117, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:06,  2.32it/s] 62%|██████▎   | 25/40 [00:09<00:05,  2.94it/s]                                               {'loss': 1.9884, 'grad_norm': 3.2277164459228516, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:05,  2.94it/s] 65%|██████▌   | 26/40 [00:10<00:04,  2.86it/s]                                               {'loss': 1.9316, 'grad_norm': 3.6119277477264404, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:04,  2.86it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.88it/s]                                               {'loss': 2.0654, 'grad_norm': 4.662567615509033, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.88it/s] 70%|███████   | 28/40 [00:10<00:04,  2.81it/s]                                               {'loss': 2.0488, 'grad_norm': 3.79561710357666, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.81it/s] 72%|███████▎  | 29/40 [00:11<00:04,  2.72it/s]                                               {'loss': 1.977, 'grad_norm': 4.358931541442871, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:04,  2.72it/s] 75%|███████▌  | 30/40 [00:11<00:03,  2.59it/s]                                               {'loss': 2.0143, 'grad_norm': 4.536148548126221, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:03,  2.59it/s] 78%|███████▊  | 31/40 [00:12<00:03,  2.41it/s]                                               {'loss': 1.9808, 'grad_norm': 3.963024139404297, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:03,  2.41it/s] 80%|████████  | 32/40 [00:12<00:02,  3.03it/s]                                               {'loss': 2.3064, 'grad_norm': 11.0289945602417, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:12<00:02,  3.03it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.79it/s]                                               {'loss': 2.056, 'grad_norm': 4.425692558288574, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.79it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s]                                               {'loss': 1.8115, 'grad_norm': 4.152562141418457, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:13<00:01,  2.52it/s]                                               {'loss': 2.1657, 'grad_norm': 3.5618653297424316, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:01,  2.52it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.55it/s]                                               {'loss': 1.8958, 'grad_norm': 5.486069679260254, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.55it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.55it/s]                                               {'loss': 2.0623, 'grad_norm': 5.079195022583008, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.55it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.60it/s]                                               {'loss': 1.785, 'grad_norm': 3.3360400199890137, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.60it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.58it/s]                                               {'loss': 1.9762, 'grad_norm': 4.578647613525391, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.58it/s]100%|██████████| 40/40 [00:15<00:00,  3.23it/s]                                               {'loss': 2.9317, 'grad_norm': 14.480864524841309, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.23it/s]                                               {'train_runtime': 15.4888, 'train_samples_per_second': 36.478, 'train_steps_per_second': 2.583, 'train_loss': 2.075966253876686, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  3.23it/s]100%|██████████| 40/40 [00:15<00:00,  2.58it/s]
CLIENT:10
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:15,  2.52it/s]                                              {'loss': 2.3597, 'grad_norm': 6.786637306213379, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:15,  2.52it/s]  5%|▌         | 2/40 [00:00<00:16,  2.25it/s]                                              {'loss': 2.1767, 'grad_norm': 3.970322847366333, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.25it/s]  8%|▊         | 3/40 [00:01<00:16,  2.23it/s]                                              {'loss': 2.3066, 'grad_norm': 4.334055423736572, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:16,  2.23it/s] 10%|█         | 4/40 [00:01<00:16,  2.21it/s]                                              {'loss': 1.9351, 'grad_norm': 4.581910610198975, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:16,  2.21it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s]                                              {'loss': 2.1948, 'grad_norm': 7.2313432693481445, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.19it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s]                                              {'loss': 1.9855, 'grad_norm': 5.326963424682617, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.22it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s]                                              {'loss': 2.3863, 'grad_norm': 4.6514573097229, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.22it/s] 20%|██        | 8/40 [00:03<00:10,  2.91it/s]                                              {'loss': 2.1696, 'grad_norm': 15.371167182922363, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:10,  2.91it/s] 22%|██▎       | 9/40 [00:03<00:10,  2.87it/s]                                              {'loss': 2.0422, 'grad_norm': 2.873563766479492, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:10,  2.87it/s] 25%|██▌       | 10/40 [00:04<00:10,  2.74it/s]                                               {'loss': 2.0353, 'grad_norm': 4.393303871154785, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:10,  2.74it/s] 28%|██▊       | 11/40 [00:04<00:10,  2.68it/s]                                               {'loss': 1.9712, 'grad_norm': 4.130955696105957, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:10,  2.68it/s] 30%|███       | 12/40 [00:04<00:10,  2.66it/s]                                               {'loss': 2.1865, 'grad_norm': 4.777749538421631, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.66it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.63it/s]                                               {'loss': 2.0091, 'grad_norm': 3.6411688327789307, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.63it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.64it/s]                                               {'loss': 1.9912, 'grad_norm': 3.5448970794677734, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.64it/s] 38%|███▊      | 15/40 [00:06<00:10,  2.46it/s]                                               {'loss': 2.069, 'grad_norm': 4.174164772033691, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:10,  2.46it/s] 40%|████      | 16/40 [00:06<00:07,  3.04it/s]                                               {'loss': 1.6567, 'grad_norm': 11.116876602172852, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:07,  3.04it/s] 42%|████▎     | 17/40 [00:06<00:08,  2.71it/s]                                               {'loss': 1.8323, 'grad_norm': 4.725917339324951, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:08,  2.71it/s] 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s]                                               {'loss': 1.8062, 'grad_norm': 3.0747950077056885, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:07<00:08,  2.48it/s] 48%|████▊     | 19/40 [00:07<00:08,  2.35it/s]                                               {'loss': 2.0429, 'grad_norm': 4.306686878204346, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:08,  2.35it/s] 50%|█████     | 20/40 [00:08<00:08,  2.30it/s]                                               {'loss': 2.0844, 'grad_norm': 4.921816825866699, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:08<00:08,  2.30it/s] 52%|█████▎    | 21/40 [00:08<00:08,  2.24it/s]                                               {'loss': 2.0945, 'grad_norm': 4.643137454986572, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:08<00:08,  2.24it/s] 55%|█████▌    | 22/40 [00:08<00:08,  2.20it/s]                                               {'loss': 1.9562, 'grad_norm': 4.474747180938721, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:09<00:08,  2.20it/s] 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s]                                               {'loss': 2.219, 'grad_norm': 4.082048416137695, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:09<00:07,  2.20it/s] 60%|██████    | 24/40 [00:09<00:05,  2.83it/s]                                               {'loss': 2.1594, 'grad_norm': 10.222553253173828, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:09<00:05,  2.83it/s] 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s]                                               {'loss': 2.1679, 'grad_norm': 4.415712356567383, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:10<00:05,  2.58it/s] 65%|██████▌   | 26/40 [00:10<00:05,  2.45it/s]                                               {'loss': 2.0387, 'grad_norm': 3.785069465637207, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:10<00:05,  2.45it/s] 68%|██████▊   | 27/40 [00:10<00:05,  2.30it/s]                                               {'loss': 1.7365, 'grad_norm': 3.064840793609619, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:05,  2.30it/s] 70%|███████   | 28/40 [00:11<00:05,  2.27it/s]                                               {'loss': 1.94, 'grad_norm': 3.7771875858306885, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:11<00:05,  2.27it/s] 72%|███████▎  | 29/40 [00:11<00:05,  2.20it/s]                                               {'loss': 1.9885, 'grad_norm': 3.897465229034424, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:11<00:05,  2.20it/s] 75%|███████▌  | 30/40 [00:12<00:04,  2.19it/s]                                               {'loss': 2.1212, 'grad_norm': 3.93025279045105, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:12<00:04,  2.19it/s] 78%|███████▊  | 31/40 [00:12<00:04,  2.17it/s]                                               {'loss': 1.9262, 'grad_norm': 3.70609450340271, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:12<00:04,  2.17it/s] 80%|████████  | 32/40 [00:13<00:02,  2.74it/s]                                               {'loss': 1.0193, 'grad_norm': 10.319390296936035, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:13<00:02,  2.74it/s] 82%|████████▎ | 33/40 [00:13<00:02,  2.61it/s]                                               {'loss': 1.9496, 'grad_norm': 4.240696907043457, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:13<00:02,  2.61it/s] 85%|████████▌ | 34/40 [00:13<00:02,  2.50it/s]                                               {'loss': 1.8749, 'grad_norm': 4.0398850440979, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:13<00:02,  2.50it/s] 88%|████████▊ | 35/40 [00:14<00:02,  2.43it/s]                                               {'loss': 2.0144, 'grad_norm': 3.5069873332977295, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:14<00:02,  2.43it/s] 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s]                                               {'loss': 2.0326, 'grad_norm': 3.5871975421905518, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:14<00:01,  2.39it/s] 92%|█████████▎| 37/40 [00:15<00:01,  2.28it/s]                                               {'loss': 1.8632, 'grad_norm': 4.669816017150879, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:15<00:01,  2.28it/s] 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s]                                               {'loss': 1.9529, 'grad_norm': 4.89766788482666, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:15<00:00,  2.23it/s] 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]                                               {'loss': 1.9518, 'grad_norm': 3.421290159225464, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:16<00:00,  2.25it/s]100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'loss': 0.7927, 'grad_norm': 5.211061000823975, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.88it/s]                                               {'train_runtime': 16.3635, 'train_samples_per_second': 34.528, 'train_steps_per_second': 2.444, 'train_loss': 1.9760178282856942, 'epoch': 5.0}
100%|██████████| 40/40 [00:16<00:00,  2.88it/s]100%|██████████| 40/40 [00:16<00:00,  2.44it/s]
CLIENT:50
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:18,  2.11it/s]                                              {'loss': 2.2396, 'grad_norm': 3.720219612121582, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:18,  2.11it/s]  5%|▌         | 2/40 [00:00<00:16,  2.25it/s]                                              {'loss': 2.2306, 'grad_norm': 5.957183837890625, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:00<00:16,  2.25it/s]  8%|▊         | 3/40 [00:01<00:15,  2.32it/s]                                              {'loss': 1.8337, 'grad_norm': 4.240652084350586, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:15,  2.32it/s] 10%|█         | 4/40 [00:01<00:15,  2.29it/s]                                              {'loss': 2.4035, 'grad_norm': 3.812730550765991, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:01<00:15,  2.29it/s] 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s]                                              {'loss': 2.1211, 'grad_norm': 4.801586627960205, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:02<00:15,  2.26it/s] 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s]                                              {'loss': 1.9842, 'grad_norm': 4.222315311431885, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:02<00:15,  2.20it/s] 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s]                                              {'loss': 2.0634, 'grad_norm': 4.070277690887451, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:03<00:14,  2.21it/s] 20%|██        | 8/40 [00:03<00:11,  2.91it/s]                                              {'loss': 2.1423, 'grad_norm': 24.522335052490234, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:03<00:11,  2.91it/s] 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s]                                              {'loss': 1.978, 'grad_norm': 3.973219394683838, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:03<00:11,  2.59it/s] 25%|██▌       | 10/40 [00:04<00:11,  2.50it/s]                                               {'loss': 2.1324, 'grad_norm': 3.869088888168335, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:04<00:11,  2.50it/s] 28%|██▊       | 11/40 [00:04<00:11,  2.55it/s]                                               {'loss': 1.9915, 'grad_norm': 3.5850329399108887, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:04<00:11,  2.55it/s] 30%|███       | 12/40 [00:04<00:10,  2.62it/s]                                               {'loss': 1.8436, 'grad_norm': 3.5613760948181152, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:04<00:10,  2.62it/s] 32%|███▎      | 13/40 [00:05<00:10,  2.65it/s]                                               {'loss': 2.139, 'grad_norm': 4.319924354553223, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:05<00:10,  2.65it/s] 35%|███▌      | 14/40 [00:05<00:09,  2.66it/s]                                               {'loss': 2.1304, 'grad_norm': 4.073791980743408, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:05<00:09,  2.66it/s] 38%|███▊      | 15/40 [00:06<00:09,  2.64it/s]                                               {'loss': 2.0268, 'grad_norm': 3.6100850105285645, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:06<00:09,  2.64it/s]                                               {'loss': 1.322, 'grad_norm': 10.471015930175781, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:06<00:09,  2.64it/s] 42%|████▎     | 17/40 [00:06<00:07,  3.26it/s]                                               {'loss': 1.6751, 'grad_norm': 3.5956320762634277, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:06<00:07,  3.26it/s] 45%|████▌     | 18/40 [00:06<00:06,  3.19it/s]                                               {'loss': 1.9251, 'grad_norm': 3.5158443450927734, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:06<00:06,  3.19it/s] 48%|████▊     | 19/40 [00:07<00:06,  3.16it/s]                                               {'loss': 1.9583, 'grad_norm': 4.228439807891846, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:07<00:06,  3.16it/s] 50%|█████     | 20/40 [00:07<00:06,  3.03it/s]                                               {'loss': 1.817, 'grad_norm': 4.207108974456787, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:07<00:06,  3.03it/s] 52%|█████▎    | 21/40 [00:07<00:06,  2.93it/s]                                               {'loss': 1.9136, 'grad_norm': 3.96370530128479, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:07<00:06,  2.93it/s] 55%|█████▌    | 22/40 [00:08<00:06,  2.82it/s]                                               {'loss': 2.2568, 'grad_norm': 5.066160202026367, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:08<00:06,  2.82it/s] 57%|█████▊    | 23/40 [00:08<00:06,  2.73it/s]                                               {'loss': 2.11, 'grad_norm': 3.847851514816284, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:08<00:06,  2.73it/s]                                               {'loss': 2.2779, 'grad_norm': 10.920367240905762, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:08<00:05,  2.73it/s] 62%|██████▎   | 25/40 [00:09<00:04,  3.20it/s]                                               {'loss': 1.7074, 'grad_norm': 4.106140613555908, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:09<00:04,  3.20it/s] 65%|██████▌   | 26/40 [00:09<00:04,  2.88it/s]                                               {'loss': 2.0792, 'grad_norm': 3.3993563652038574, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:09<00:04,  2.88it/s] 68%|██████▊   | 27/40 [00:10<00:04,  2.71it/s]                                               {'loss': 1.9094, 'grad_norm': 5.0764970779418945, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:10<00:04,  2.71it/s] 70%|███████   | 28/40 [00:10<00:04,  2.71it/s]                                               {'loss': 2.2797, 'grad_norm': 3.7005319595336914, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:10<00:04,  2.71it/s] 72%|███████▎  | 29/40 [00:10<00:04,  2.54it/s]                                               {'loss': 1.892, 'grad_norm': 4.155944347381592, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:10<00:04,  2.54it/s] 75%|███████▌  | 30/40 [00:11<00:04,  2.40it/s]                                               {'loss': 1.6553, 'grad_norm': 3.6724884510040283, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:11<00:04,  2.40it/s] 78%|███████▊  | 31/40 [00:11<00:03,  2.34it/s]                                               {'loss': 1.8158, 'grad_norm': 3.761936664581299, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:11<00:03,  2.34it/s] 80%|████████  | 32/40 [00:11<00:02,  2.93it/s]                                               {'loss': 2.0139, 'grad_norm': 19.261566162109375, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:11<00:02,  2.93it/s] 82%|████████▎ | 33/40 [00:12<00:02,  2.67it/s]                                               {'loss': 1.9557, 'grad_norm': 3.878185510635376, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:12<00:02,  2.67it/s] 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s]                                               {'loss': 1.7833, 'grad_norm': 3.696406602859497, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:12<00:02,  2.55it/s] 88%|████████▊ | 35/40 [00:13<00:02,  2.39it/s]                                               {'loss': 1.7746, 'grad_norm': 4.323119163513184, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:13<00:02,  2.39it/s] 90%|█████████ | 36/40 [00:13<00:01,  2.33it/s]                                               {'loss': 1.8192, 'grad_norm': 4.245869159698486, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:13<00:01,  2.33it/s] 92%|█████████▎| 37/40 [00:14<00:01,  2.21it/s]                                               {'loss': 1.9703, 'grad_norm': 4.41432523727417, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:14<00:01,  2.21it/s] 95%|█████████▌| 38/40 [00:14<00:00,  2.16it/s]                                               {'loss': 2.0821, 'grad_norm': 3.6519360542297363, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:14<00:00,  2.16it/s] 98%|█████████▊| 39/40 [00:15<00:00,  2.11it/s]                                               {'loss': 1.9426, 'grad_norm': 3.7638003826141357, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:15<00:00,  2.11it/s]100%|██████████| 40/40 [00:15<00:00,  2.63it/s]                                               {'loss': 2.8633, 'grad_norm': 17.546144485473633, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.63it/s]                                               {'train_runtime': 15.4956, 'train_samples_per_second': 36.462, 'train_steps_per_second': 2.581, 'train_loss': 2.001489022374153, 'epoch': 5.0}
100%|██████████| 40/40 [00:15<00:00,  2.63it/s]100%|██████████| 40/40 [00:15<00:00,  2.58it/s]
CLIENT:53
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:31,  1.24it/s]                                              {'loss': 2.1752, 'grad_norm': 5.1409430503845215, 'learning_rate': 0.00014017542509913794, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:31,  1.24it/s]  5%|▌         | 2/40 [00:01<00:27,  1.39it/s]                                              {'loss': 2.3825, 'grad_norm': 7.053323745727539, 'learning_rate': 0.0001366710394716595, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:27,  1.39it/s]  8%|▊         | 3/40 [00:02<00:23,  1.56it/s]                                              {'loss': 2.4323, 'grad_norm': 5.535926342010498, 'learning_rate': 0.00013316665384418105, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:23,  1.56it/s] 10%|█         | 4/40 [00:02<00:21,  1.67it/s]                                              {'loss': 2.1612, 'grad_norm': 5.166069507598877, 'learning_rate': 0.0001296622682167026, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:21,  1.67it/s] 12%|█▎        | 5/40 [00:03<00:20,  1.71it/s]                                              {'loss': 2.138, 'grad_norm': 4.739353179931641, 'learning_rate': 0.00012615788258922415, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:20,  1.71it/s] 15%|█▌        | 6/40 [00:03<00:19,  1.75it/s]                                              {'loss': 2.1497, 'grad_norm': 4.303718090057373, 'learning_rate': 0.0001226534969617457, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:19,  1.75it/s] 18%|█▊        | 7/40 [00:04<00:18,  1.80it/s]                                              {'loss': 1.9019, 'grad_norm': 4.384901523590088, 'learning_rate': 0.00011914911133426725, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:18,  1.80it/s] 20%|██        | 8/40 [00:04<00:13,  2.37it/s]                                              {'loss': 2.4737, 'grad_norm': 14.013958930969238, 'learning_rate': 0.0001156447257067888, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:13,  2.37it/s] 22%|██▎       | 9/40 [00:04<00:14,  2.20it/s]                                              {'loss': 2.0895, 'grad_norm': 3.622166395187378, 'learning_rate': 0.00011214034007931035, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:04<00:14,  2.20it/s] 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s]                                               {'loss': 2.333, 'grad_norm': 3.4143905639648438, 'learning_rate': 0.0001086359544518319, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:14,  2.09it/s] 28%|██▊       | 11/40 [00:05<00:14,  2.01it/s]                                               {'loss': 1.9602, 'grad_norm': 4.0552167892456055, 'learning_rate': 0.00010513156882435346, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:05<00:14,  2.01it/s] 30%|███       | 12/40 [00:06<00:13,  2.01it/s]                                               {'loss': 2.1728, 'grad_norm': 3.5300819873809814, 'learning_rate': 0.00010162718319687501, 'epoch': 1.5}
 30%|███       | 12/40 [00:06<00:13,  2.01it/s] 32%|███▎      | 13/40 [00:06<00:13,  1.95it/s]                                               {'loss': 1.846, 'grad_norm': 3.9945483207702637, 'learning_rate': 9.812279756939656e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:06<00:13,  1.95it/s] 35%|███▌      | 14/40 [00:07<00:13,  1.94it/s]                                               {'loss': 2.0296, 'grad_norm': 5.168824195861816, 'learning_rate': 9.461841194191811e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:07<00:13,  1.94it/s] 38%|███▊      | 15/40 [00:08<00:12,  1.93it/s]                                               {'loss': 2.128, 'grad_norm': 3.575148105621338, 'learning_rate': 9.111402631443966e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:08<00:12,  1.93it/s] 40%|████      | 16/40 [00:08<00:09,  2.42it/s]                                               {'loss': 2.0706, 'grad_norm': 11.06439208984375, 'learning_rate': 8.760964068696121e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:08<00:09,  2.42it/s] 42%|████▎     | 17/40 [00:08<00:10,  2.21it/s]                                               {'loss': 1.9958, 'grad_norm': 3.1580934524536133, 'learning_rate': 8.410525505948277e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:08<00:10,  2.21it/s] 45%|████▌     | 18/40 [00:09<00:10,  2.13it/s]                                               {'loss': 2.089, 'grad_norm': 4.2803826332092285, 'learning_rate': 8.060086943200432e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:09<00:10,  2.13it/s] 48%|████▊     | 19/40 [00:09<00:10,  2.05it/s]                                               {'loss': 2.0027, 'grad_norm': 4.07557487487793, 'learning_rate': 7.709648380452587e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:09<00:10,  2.05it/s] 50%|█████     | 20/40 [00:10<00:10,  1.98it/s]                                               {'loss': 1.9792, 'grad_norm': 4.4278364181518555, 'learning_rate': 7.359209817704742e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:10<00:10,  1.98it/s] 52%|█████▎    | 21/40 [00:10<00:09,  1.98it/s]                                               {'loss': 1.9517, 'grad_norm': 3.260751485824585, 'learning_rate': 7.008771254956897e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:10<00:09,  1.98it/s] 55%|█████▌    | 22/40 [00:11<00:09,  1.92it/s]                                               {'loss': 1.8934, 'grad_norm': 5.591465950012207, 'learning_rate': 6.658332692209052e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:11<00:09,  1.92it/s] 57%|█████▊    | 23/40 [00:11<00:08,  1.92it/s]                                               {'loss': 2.1207, 'grad_norm': 3.9701411724090576, 'learning_rate': 6.307894129461207e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:11<00:08,  1.92it/s] 60%|██████    | 24/40 [00:12<00:06,  2.43it/s]                                               {'loss': 3.7047, 'grad_norm': 29.9768123626709, 'learning_rate': 5.9574555667133626e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:12<00:06,  2.43it/s] 62%|██████▎   | 25/40 [00:12<00:06,  2.17it/s]                                               {'loss': 2.2616, 'grad_norm': 4.057392597198486, 'learning_rate': 5.607017003965518e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:12<00:06,  2.17it/s] 65%|██████▌   | 26/40 [00:13<00:06,  2.04it/s]                                               {'loss': 1.9793, 'grad_norm': 4.030190467834473, 'learning_rate': 5.256578441217673e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:13<00:06,  2.04it/s] 68%|██████▊   | 27/40 [00:13<00:06,  1.98it/s]                                               {'loss': 1.9835, 'grad_norm': 3.3228747844696045, 'learning_rate': 4.906139878469828e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:13<00:06,  1.98it/s] 70%|███████   | 28/40 [00:14<00:06,  1.92it/s]                                               {'loss': 1.7239, 'grad_norm': 2.9754767417907715, 'learning_rate': 4.555701315721983e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:14<00:06,  1.92it/s] 72%|███████▎  | 29/40 [00:14<00:05,  1.91it/s]                                               {'loss': 2.12, 'grad_norm': 4.1917595863342285, 'learning_rate': 4.205262752974138e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:14<00:05,  1.91it/s] 75%|███████▌  | 30/40 [00:15<00:05,  1.85it/s]                                               {'loss': 2.0534, 'grad_norm': 3.644745111465454, 'learning_rate': 3.8548241902262935e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:15<00:05,  1.85it/s] 78%|███████▊  | 31/40 [00:15<00:04,  1.92it/s]                                               {'loss': 1.7702, 'grad_norm': 3.0132997035980225, 'learning_rate': 3.5043856274784486e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:15<00:04,  1.92it/s]                                               {'loss': 1.9182, 'grad_norm': 15.65104866027832, 'learning_rate': 3.153947064730604e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:15<00:04,  1.92it/s] 82%|████████▎ | 33/40 [00:16<00:02,  2.44it/s]                                               {'loss': 1.8865, 'grad_norm': 3.768049955368042, 'learning_rate': 2.803508501982759e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:16<00:02,  2.44it/s] 85%|████████▌ | 34/40 [00:16<00:02,  2.38it/s]                                               {'loss': 2.1219, 'grad_norm': 3.75396728515625, 'learning_rate': 2.453069939234914e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:16<00:02,  2.38it/s] 88%|████████▊ | 35/40 [00:17<00:02,  2.29it/s]                                               {'loss': 1.9694, 'grad_norm': 3.582181930541992, 'learning_rate': 2.102631376487069e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:17<00:02,  2.29it/s] 90%|█████████ | 36/40 [00:17<00:01,  2.23it/s]                                               {'loss': 1.9828, 'grad_norm': 4.210419654846191, 'learning_rate': 1.7521928137392243e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:17<00:01,  2.23it/s] 92%|█████████▎| 37/40 [00:18<00:01,  2.25it/s]                                               {'loss': 2.0229, 'grad_norm': 4.233099937438965, 'learning_rate': 1.4017542509913794e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:18<00:01,  2.25it/s] 95%|█████████▌| 38/40 [00:18<00:00,  2.20it/s]                                               {'loss': 1.7179, 'grad_norm': 3.673227310180664, 'learning_rate': 1.0513156882435346e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:18<00:00,  2.20it/s] 98%|█████████▊| 39/40 [00:19<00:00,  2.09it/s]                                               {'loss': 2.0636, 'grad_norm': 3.587688446044922, 'learning_rate': 7.008771254956897e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:19<00:00,  2.09it/s]100%|██████████| 40/40 [00:19<00:00,  2.55it/s]                                               {'loss': 1.5968, 'grad_norm': 11.25239372253418, 'learning_rate': 3.5043856274784486e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  2.55it/s]                                               {'train_runtime': 19.5797, 'train_samples_per_second': 28.856, 'train_steps_per_second': 2.043, 'train_loss': 2.0838416874408723, 'epoch': 5.0}
100%|██████████| 40/40 [00:19<00:00,  2.55it/s]100%|██████████| 40/40 [00:19<00:00,  2.04it/s]
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:368: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  training_args = TrainingArguments(output_dir='save', save_steps=sys.maxsize,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/471 [00:00<?, ?it/s]  0%|          | 2/471 [00:00<00:51,  9.07it/s]  1%|          | 3/471 [00:00<01:26,  5.38it/s]  1%|          | 4/471 [00:00<01:34,  4.95it/s]  1%|          | 5/471 [00:01<01:44,  4.47it/s]  1%|▏         | 6/471 [00:01<01:44,  4.44it/s]  1%|▏         | 7/471 [00:01<01:50,  4.20it/s]  2%|▏         | 8/471 [00:01<01:53,  4.06it/s]  2%|▏         | 9/471 [00:02<01:54,  4.05it/s]  2%|▏         | 10/471 [00:02<01:57,  3.94it/s]  2%|▏         | 11/471 [00:02<01:53,  4.04it/s]  3%|▎         | 12/471 [00:02<01:54,  4.01it/s]  3%|▎         | 13/471 [00:03<01:53,  4.03it/s]  3%|▎         | 14/471 [00:03<01:57,  3.88it/s]  3%|▎         | 15/471 [00:03<01:53,  4.03it/s]  3%|▎         | 16/471 [00:03<01:57,  3.88it/s]  4%|▎         | 17/471 [00:04<01:50,  4.09it/s]  4%|▍         | 18/471 [00:04<01:53,  3.97it/s]  4%|▍         | 19/471 [00:04<01:51,  4.07it/s]  4%|▍         | 20/471 [00:04<01:57,  3.85it/s]  4%|▍         | 21/471 [00:05<01:54,  3.92it/s]  5%|▍         | 22/471 [00:05<01:57,  3.81it/s]  5%|▍         | 23/471 [00:05<01:52,  3.97it/s]  5%|▌         | 24/471 [00:05<01:56,  3.85it/s]  5%|▌         | 25/471 [00:06<01:56,  3.82it/s]  6%|▌         | 26/471 [00:06<01:54,  3.90it/s]  6%|▌         | 27/471 [00:06<01:52,  3.94it/s]  6%|▌         | 28/471 [00:06<01:50,  4.01it/s]  6%|▌         | 29/471 [00:07<01:52,  3.94it/s]  6%|▋         | 30/471 [00:07<01:50,  3.99it/s]  7%|▋         | 31/471 [00:07<01:58,  3.71it/s]  7%|▋         | 32/471 [00:07<01:58,  3.70it/s]  7%|▋         | 33/471 [00:08<02:05,  3.50it/s]  7%|▋         | 34/471 [00:08<01:57,  3.71it/s]  7%|▋         | 35/471 [00:08<02:05,  3.47it/s]  8%|▊         | 36/471 [00:09<02:01,  3.58it/s]  8%|▊         | 37/471 [00:09<02:04,  3.48it/s]  8%|▊         | 38/471 [00:09<01:54,  3.78it/s]  8%|▊         | 39/471 [00:09<01:55,  3.75it/s]  8%|▊         | 40/471 [00:10<01:57,  3.68it/s]  9%|▊         | 41/471 [00:10<02:05,  3.42it/s]  9%|▉         | 42/471 [00:10<02:06,  3.40it/s]  9%|▉         | 43/471 [00:11<02:03,  3.47it/s]  9%|▉         | 44/471 [00:11<02:04,  3.42it/s] 10%|▉         | 45/471 [00:11<02:02,  3.46it/s] 10%|▉         | 46/471 [00:11<02:07,  3.33it/s] 10%|▉         | 47/471 [00:12<02:07,  3.32it/s] 10%|█         | 48/471 [00:12<02:09,  3.27it/s] 10%|█         | 49/471 [00:12<02:03,  3.43it/s] 11%|█         | 50/471 [00:13<02:05,  3.37it/s] 11%|█         | 51/471 [00:13<02:03,  3.41it/s] 11%|█         | 52/471 [00:13<02:09,  3.24it/s] 11%|█▏        | 53/471 [00:14<02:04,  3.37it/s] 11%|█▏        | 54/471 [00:14<02:07,  3.28it/s] 12%|█▏        | 55/471 [00:14<01:59,  3.49it/s] 12%|█▏        | 56/471 [00:14<02:00,  3.45it/s] 12%|█▏        | 57/471 [00:15<01:56,  3.56it/s] 12%|█▏        | 58/471 [00:15<01:52,  3.68it/s] 13%|█▎        | 59/471 [00:15<01:44,  3.93it/s] 13%|█▎        | 60/471 [00:15<01:37,  4.21it/s] 13%|█▎        | 61/471 [00:16<01:35,  4.30it/s] 13%|█▎        | 62/471 [00:16<01:30,  4.53it/s] 13%|█▎        | 63/471 [00:16<01:33,  4.35it/s] 14%|█▎        | 64/471 [00:16<01:26,  4.73it/s] 14%|█▍        | 65/471 [00:16<01:30,  4.47it/s] 14%|█▍        | 66/471 [00:17<01:22,  4.90it/s] 14%|█▍        | 67/471 [00:17<01:29,  4.50it/s] 14%|█▍        | 68/471 [00:17<01:27,  4.59it/s] 15%|█▍        | 69/471 [00:17<01:27,  4.61it/s] 15%|█▍        | 70/471 [00:18<01:29,  4.50it/s] 15%|█▌        | 71/471 [00:18<01:22,  4.87it/s] 15%|█▌        | 72/471 [00:18<01:21,  4.91it/s] 15%|█▌        | 73/471 [00:18<01:12,  5.50it/s] 16%|█▌        | 74/471 [00:18<01:25,  4.62it/s] 16%|█▌        | 75/471 [00:19<01:24,  4.66it/s] 16%|█▌        | 76/471 [00:19<01:37,  4.06it/s] 16%|█▋        | 77/471 [00:19<01:33,  4.21it/s] 17%|█▋        | 78/471 [00:19<01:38,  3.99it/s] 17%|█▋        | 79/471 [00:20<01:36,  4.07it/s] 17%|█▋        | 80/471 [00:20<01:36,  4.05it/s] 17%|█▋        | 81/471 [00:20<01:42,  3.80it/s] 17%|█▋        | 82/471 [00:20<01:43,  3.74it/s] 18%|█▊        | 83/471 [00:21<01:50,  3.51it/s] 18%|█▊        | 84/471 [00:21<01:47,  3.59it/s] 18%|█▊        | 85/471 [00:21<01:56,  3.33it/s] 18%|█▊        | 86/471 [00:22<01:52,  3.44it/s] 18%|█▊        | 87/471 [00:22<01:58,  3.23it/s] 19%|█▊        | 88/471 [00:22<01:50,  3.45it/s] 19%|█▉        | 89/471 [00:23<01:56,  3.28it/s] 19%|█▉        | 90/471 [00:23<01:50,  3.43it/s] 19%|█▉        | 91/471 [00:23<01:55,  3.29it/s] 20%|█▉        | 92/471 [00:23<01:52,  3.36it/s] 20%|█▉        | 93/471 [00:24<01:54,  3.30it/s] 20%|█▉        | 94/471 [00:24<01:53,  3.32it/s] 20%|██        | 95/471 [00:24<01:52,  3.33it/s] 20%|██        | 96/471 [00:25<01:53,  3.30it/s] 21%|██        | 97/471 [00:25<01:52,  3.33it/s] 21%|██        | 98/471 [00:25<01:53,  3.28it/s] 21%|██        | 99/471 [00:26<01:49,  3.40it/s] 21%|██        | 100/471 [00:26<01:52,  3.31it/s] 21%|██▏       | 101/471 [00:26<01:48,  3.40it/s] 22%|██▏       | 102/471 [00:26<01:52,  3.27it/s] 22%|██▏       | 103/471 [00:27<01:51,  3.30it/s] 22%|██▏       | 104/471 [00:27<01:49,  3.34it/s] 22%|██▏       | 105/471 [00:27<01:49,  3.35it/s] 23%|██▎       | 106/471 [00:28<01:49,  3.34it/s] 23%|██▎       | 107/471 [00:28<01:48,  3.37it/s] 23%|██▎       | 108/471 [00:28<01:51,  3.24it/s] 23%|██▎       | 109/471 [00:29<01:46,  3.39it/s] 23%|██▎       | 110/471 [00:29<01:49,  3.31it/s] 24%|██▎       | 111/471 [00:29<01:44,  3.45it/s] 24%|██▍       | 112/471 [00:29<01:46,  3.37it/s] 24%|██▍       | 113/471 [00:30<01:45,  3.39it/s] 24%|██▍       | 114/471 [00:30<01:46,  3.35it/s] 24%|██▍       | 115/471 [00:30<01:44,  3.41it/s] 25%|██▍       | 116/471 [00:31<01:45,  3.37it/s] 25%|██▍       | 117/471 [00:31<01:43,  3.42it/s] 25%|██▌       | 118/471 [00:31<01:45,  3.34it/s] 25%|██▌       | 119/471 [00:31<01:46,  3.31it/s] 25%|██▌       | 120/471 [00:32<01:43,  3.39it/s] 26%|██▌       | 121/471 [00:32<01:45,  3.32it/s] 26%|██▌       | 122/471 [00:32<01:43,  3.37it/s] 26%|██▌       | 123/471 [00:33<01:45,  3.29it/s] 26%|██▋       | 124/471 [00:33<01:42,  3.38it/s] 27%|██▋       | 125/471 [00:33<01:47,  3.21it/s] 27%|██▋       | 126/471 [00:34<01:43,  3.33it/s] 27%|██▋       | 127/471 [00:34<01:44,  3.29it/s] 27%|██▋       | 128/471 [00:34<01:41,  3.38it/s] 27%|██▋       | 129/471 [00:35<01:43,  3.32it/s] 28%|██▊       | 130/471 [00:35<01:41,  3.34it/s] 28%|██▊       | 131/471 [00:35<01:43,  3.29it/s] 28%|██▊       | 132/471 [00:35<01:41,  3.33it/s] 28%|██▊       | 133/471 [00:36<01:41,  3.32it/s] 28%|██▊       | 134/471 [00:36<01:42,  3.29it/s] 29%|██▊       | 135/471 [00:36<01:41,  3.32it/s] 29%|██▉       | 136/471 [00:37<01:41,  3.29it/s] 29%|██▉       | 137/471 [00:37<01:40,  3.33it/s] 29%|██▉       | 138/471 [00:37<01:39,  3.35it/s] 30%|██▉       | 139/471 [00:37<01:36,  3.42it/s] 30%|██▉       | 140/471 [00:38<01:38,  3.35it/s] 30%|██▉       | 141/471 [00:38<01:38,  3.34it/s] 30%|███       | 142/471 [00:38<01:39,  3.30it/s] 30%|███       | 143/471 [00:39<01:38,  3.34it/s] 31%|███       | 144/471 [00:39<01:37,  3.34it/s] 31%|███       | 145/471 [00:39<01:37,  3.34it/s] 31%|███       | 146/471 [00:40<01:40,  3.23it/s] 31%|███       | 147/471 [00:40<01:36,  3.36it/s] 31%|███▏      | 148/471 [00:40<01:38,  3.28it/s] 32%|███▏      | 149/471 [00:40<01:34,  3.40it/s] 32%|███▏      | 150/471 [00:41<01:34,  3.40it/s] 32%|███▏      | 151/471 [00:41<01:32,  3.46it/s] 32%|███▏      | 152/471 [00:41<01:30,  3.54it/s] 32%|███▏      | 153/471 [00:42<01:29,  3.55it/s] 33%|███▎      | 154/471 [00:42<01:26,  3.66it/s] 33%|███▎      | 155/471 [00:42<01:27,  3.62it/s] 33%|███▎      | 156/471 [00:42<01:23,  3.78it/s] 33%|███▎      | 157/471 [00:43<01:25,  3.69it/s] 34%|███▎      | 158/471 [00:43<01:22,  3.79it/s] 34%|███▍      | 159/471 [00:43<01:25,  3.67it/s] 34%|███▍      | 160/471 [00:43<01:20,  3.86it/s] 34%|███▍      | 161/471 [00:44<01:23,  3.72it/s] 34%|███▍      | 162/471 [00:44<01:20,  3.82it/s] 35%|███▍      | 163/471 [00:44<01:29,  3.42it/s] 35%|███▍      | 164/471 [00:45<01:28,  3.49it/s] 35%|███▌      | 165/471 [00:45<01:31,  3.34it/s] 35%|███▌      | 166/471 [00:45<01:29,  3.40it/s] 35%|███▌      | 167/471 [00:46<01:32,  3.30it/s] 36%|███▌      | 168/471 [00:46<01:31,  3.30it/s] 36%|███▌      | 169/471 [00:46<01:33,  3.23it/s] 36%|███▌      | 170/471 [00:46<01:32,  3.25it/s] 36%|███▋      | 171/471 [00:47<01:31,  3.29it/s] 37%|███▋      | 172/471 [00:47<01:30,  3.32it/s] 37%|███▋      | 173/471 [00:47<01:28,  3.35it/s] 37%|███▋      | 174/471 [00:48<01:30,  3.28it/s] 37%|███▋      | 175/471 [00:48<01:28,  3.36it/s] 37%|███▋      | 176/471 [00:48<01:29,  3.28it/s] 38%|███▊      | 177/471 [00:49<01:25,  3.43it/s] 38%|███▊      | 178/471 [00:49<01:27,  3.33it/s] 38%|███▊      | 179/471 [00:49<01:27,  3.35it/s] 38%|███▊      | 180/471 [00:49<01:28,  3.29it/s] 38%|███▊      | 181/471 [00:50<01:25,  3.41it/s] 39%|███▊      | 182/471 [00:50<01:26,  3.33it/s] 39%|███▉      | 183/471 [00:50<01:24,  3.42it/s] 39%|███▉      | 184/471 [00:51<01:26,  3.31it/s] 39%|███▉      | 185/471 [00:51<01:27,  3.28it/s] 39%|███▉      | 186/471 [00:51<01:27,  3.25it/s] 40%|███▉      | 187/471 [00:52<01:26,  3.29it/s] 40%|███▉      | 188/471 [00:52<01:23,  3.37it/s] 40%|████      | 189/471 [00:52<01:22,  3.41it/s] 40%|████      | 190/471 [00:52<01:23,  3.37it/s] 41%|████      | 191/471 [00:53<01:25,  3.29it/s] 41%|████      | 192/471 [00:53<01:23,  3.33it/s] 41%|████      | 193/471 [00:53<01:22,  3.36it/s] 41%|████      | 194/471 [00:54<01:20,  3.46it/s] 41%|████▏     | 195/471 [00:54<01:22,  3.34it/s] 42%|████▏     | 196/471 [00:54<01:20,  3.42it/s] 42%|████▏     | 197/471 [00:55<01:25,  3.22it/s] 42%|████▏     | 198/471 [00:55<01:19,  3.43it/s] 42%|████▏     | 199/471 [00:55<01:24,  3.23it/s] 42%|████▏     | 200/471 [00:55<01:18,  3.46it/s] 43%|████▎     | 201/471 [00:56<01:24,  3.20it/s] 43%|████▎     | 202/471 [00:56<01:21,  3.31it/s] 43%|████▎     | 203/471 [00:56<01:22,  3.23it/s] 43%|████▎     | 204/471 [00:57<01:20,  3.30it/s] 44%|████▎     | 205/471 [00:57<01:18,  3.39it/s] 44%|████▎     | 206/471 [00:57<01:19,  3.32it/s] 44%|████▍     | 207/471 [00:58<01:18,  3.34it/s] 44%|████▍     | 208/471 [00:58<01:20,  3.26it/s] 44%|████▍     | 209/471 [00:58<01:15,  3.46it/s] 45%|████▍     | 210/471 [00:58<01:17,  3.35it/s] 45%|████▍     | 211/471 [00:59<01:15,  3.45it/s] 45%|████▌     | 212/471 [00:59<01:19,  3.26it/s] 45%|████▌     | 213/471 [00:59<01:15,  3.42it/s] 45%|████▌     | 214/471 [01:00<01:18,  3.26it/s] 46%|████▌     | 215/471 [01:00<01:16,  3.37it/s] 46%|████▌     | 216/471 [01:00<01:18,  3.24it/s] 46%|████▌     | 217/471 [01:01<01:17,  3.29it/s] 46%|████▋     | 218/471 [01:01<01:18,  3.21it/s] 46%|████▋     | 219/471 [01:01<01:18,  3.23it/s] 47%|████▋     | 220/471 [01:02<01:17,  3.25it/s] 47%|████▋     | 221/471 [01:02<01:16,  3.29it/s] 47%|████▋     | 222/471 [01:02<01:15,  3.31it/s] 47%|████▋     | 223/471 [01:02<01:16,  3.23it/s] 48%|████▊     | 224/471 [01:03<01:14,  3.30it/s] 48%|████▊     | 225/471 [01:03<01:15,  3.24it/s] 48%|████▊     | 226/471 [01:03<01:13,  3.35it/s] 48%|████▊     | 227/471 [01:04<01:13,  3.32it/s] 48%|████▊     | 228/471 [01:04<01:07,  3.61it/s] 49%|████▊     | 229/471 [01:04<01:08,  3.54it/s] 49%|████▉     | 230/471 [01:04<01:05,  3.69it/s] 49%|████▉     | 231/471 [01:05<01:06,  3.62it/s] 49%|████▉     | 232/471 [01:05<01:02,  3.83it/s] 49%|████▉     | 233/471 [01:05<01:04,  3.71it/s] 50%|████▉     | 234/471 [01:05<01:01,  3.87it/s] 50%|████▉     | 235/471 [01:06<01:03,  3.71it/s] 50%|█████     | 236/471 [01:06<01:00,  3.86it/s] 50%|█████     | 237/471 [01:06<01:02,  3.74it/s] 51%|█████     | 238/471 [01:06<01:01,  3.82it/s] 51%|█████     | 239/471 [01:07<01:00,  3.81it/s] 51%|█████     | 240/471 [01:07<00:59,  3.87it/s] 51%|█████     | 241/471 [01:07<00:54,  4.24it/s] 51%|█████▏    | 242/471 [01:07<00:54,  4.22it/s] 52%|█████▏    | 243/471 [01:08<00:51,  4.41it/s] 52%|█████▏    | 244/471 [01:08<00:52,  4.34it/s] 52%|█████▏    | 245/471 [01:08<00:50,  4.50it/s] 52%|█████▏    | 246/471 [01:08<00:50,  4.42it/s] 52%|█████▏    | 247/471 [01:09<00:49,  4.55it/s] 53%|█████▎    | 248/471 [01:09<00:51,  4.37it/s] 53%|█████▎    | 249/471 [01:09<00:49,  4.49it/s] 53%|█████▎    | 250/471 [01:09<00:50,  4.37it/s] 53%|█████▎    | 251/471 [01:09<00:49,  4.45it/s] 54%|█████▎    | 252/471 [01:10<00:48,  4.47it/s] 54%|█████▎    | 253/471 [01:10<00:48,  4.45it/s] 54%|█████▍    | 254/471 [01:10<00:46,  4.62it/s] 54%|█████▍    | 255/471 [01:10<00:53,  4.04it/s] 54%|█████▍    | 256/471 [01:11<00:56,  3.81it/s] 55%|█████▍    | 257/471 [01:11<01:00,  3.56it/s] 55%|█████▍    | 258/471 [01:11<01:00,  3.51it/s] 55%|█████▍    | 259/471 [01:12<01:00,  3.49it/s] 55%|█████▌    | 260/471 [01:12<01:01,  3.46it/s] 55%|█████▌    | 261/471 [01:12<01:01,  3.39it/s] 56%|█████▌    | 262/471 [01:13<01:03,  3.31it/s] 56%|█████▌    | 263/471 [01:13<01:02,  3.33it/s] 56%|█████▌    | 264/471 [01:13<01:03,  3.28it/s] 56%|█████▋    | 265/471 [01:13<01:01,  3.38it/s] 56%|█████▋    | 266/471 [01:14<01:03,  3.24it/s] 57%|█████▋    | 267/471 [01:14<01:01,  3.32it/s] 57%|█████▋    | 268/471 [01:14<01:03,  3.20it/s] 57%|█████▋    | 269/471 [01:15<01:00,  3.36it/s] 57%|█████▋    | 270/471 [01:15<01:00,  3.34it/s] 58%|█████▊    | 271/471 [01:15<00:59,  3.36it/s] 58%|█████▊    | 272/471 [01:16<01:00,  3.29it/s] 58%|█████▊    | 273/471 [01:16<01:00,  3.28it/s] 58%|█████▊    | 274/471 [01:16<00:59,  3.32it/s] 58%|█████▊    | 275/471 [01:16<00:58,  3.33it/s] 59%|█████▊    | 276/471 [01:17<00:57,  3.40it/s] 59%|█████▉    | 277/471 [01:17<00:59,  3.28it/s] 59%|█████▉    | 278/471 [01:17<00:58,  3.32it/s] 59%|█████▉    | 279/471 [01:18<00:58,  3.28it/s] 59%|█████▉    | 280/471 [01:18<00:56,  3.37it/s] 60%|█████▉    | 281/471 [01:18<00:57,  3.29it/s] 60%|█████▉    | 282/471 [01:19<00:57,  3.32it/s] 60%|██████    | 283/471 [01:19<00:58,  3.24it/s] 60%|██████    | 284/471 [01:19<00:56,  3.30it/s] 61%|██████    | 285/471 [01:19<00:55,  3.36it/s] 61%|██████    | 286/471 [01:20<00:56,  3.30it/s] 61%|██████    | 287/471 [01:20<00:54,  3.39it/s] 61%|██████    | 288/471 [01:20<00:55,  3.31it/s] 61%|██████▏   | 289/471 [01:21<00:54,  3.36it/s] 62%|██████▏   | 290/471 [01:21<00:54,  3.29it/s] 62%|██████▏   | 291/471 [01:21<00:53,  3.38it/s] 62%|██████▏   | 292/471 [01:22<00:52,  3.40it/s] 62%|██████▏   | 293/471 [01:22<00:50,  3.50it/s] 62%|██████▏   | 294/471 [01:22<00:52,  3.36it/s] 63%|██████▎   | 295/471 [01:22<00:52,  3.35it/s] 63%|██████▎   | 296/471 [01:23<00:53,  3.26it/s] 63%|██████▎   | 297/471 [01:23<00:52,  3.34it/s] 63%|██████▎   | 298/471 [01:23<00:52,  3.28it/s] 63%|██████▎   | 299/471 [01:24<00:52,  3.30it/s] 64%|██████▎   | 300/471 [01:24<00:52,  3.24it/s] 64%|██████▍   | 301/471 [01:24<00:51,  3.33it/s] 64%|██████▍   | 302/471 [01:25<00:50,  3.31it/s] 64%|██████▍   | 303/471 [01:25<00:50,  3.31it/s] 65%|██████▍   | 304/471 [01:25<00:49,  3.35it/s] 65%|██████▍   | 305/471 [01:25<00:51,  3.25it/s] 65%|██████▍   | 306/471 [01:26<00:50,  3.29it/s] 65%|██████▌   | 307/471 [01:26<00:50,  3.23it/s] 65%|██████▌   | 308/471 [01:26<00:48,  3.33it/s] 66%|██████▌   | 309/471 [01:27<00:49,  3.26it/s] 66%|██████▌   | 310/471 [01:27<00:47,  3.38it/s] 66%|██████▌   | 311/471 [01:27<00:50,  3.20it/s] 66%|██████▌   | 312/471 [01:28<00:46,  3.40it/s] 66%|██████▋   | 313/471 [01:28<00:49,  3.21it/s] 67%|██████▋   | 314/471 [01:28<00:45,  3.44it/s] 67%|██████▋   | 315/471 [01:29<00:47,  3.26it/s] 67%|██████▋   | 316/471 [01:29<00:46,  3.31it/s] 67%|██████▋   | 317/471 [01:29<00:46,  3.32it/s] 68%|██████▊   | 318/471 [01:29<00:46,  3.31it/s] 68%|██████▊   | 319/471 [01:30<00:45,  3.36it/s] 68%|██████▊   | 320/471 [01:30<00:45,  3.35it/s] 68%|██████▊   | 321/471 [01:30<00:44,  3.33it/s] 68%|██████▊   | 322/471 [01:31<00:45,  3.28it/s] 69%|██████▊   | 323/471 [01:31<00:44,  3.34it/s] 69%|██████▉   | 324/471 [01:31<00:44,  3.27it/s] 69%|██████▉   | 325/471 [01:31<00:42,  3.43it/s] 69%|██████▉   | 326/471 [01:32<00:44,  3.29it/s] 69%|██████▉   | 327/471 [01:32<00:43,  3.34it/s] 70%|██████▉   | 328/471 [01:32<00:44,  3.24it/s] 70%|██████▉   | 329/471 [01:33<00:42,  3.32it/s] 70%|███████   | 330/471 [01:33<00:43,  3.25it/s] 70%|███████   | 331/471 [01:33<00:41,  3.37it/s] 70%|███████   | 332/471 [01:34<00:41,  3.38it/s] 71%|███████   | 333/471 [01:34<00:39,  3.47it/s] 71%|███████   | 334/471 [01:34<00:39,  3.49it/s] 71%|███████   | 335/471 [01:34<00:37,  3.61it/s] 71%|███████▏  | 336/471 [01:35<00:37,  3.61it/s] 72%|███████▏  | 337/471 [01:35<00:35,  3.73it/s] 72%|███████▏  | 338/471 [01:35<00:35,  3.70it/s] 72%|███████▏  | 339/471 [01:35<00:36,  3.65it/s] 72%|███████▏  | 340/471 [01:36<00:34,  3.75it/s] 72%|███████▏  | 341/471 [01:36<00:35,  3.67it/s] 73%|███████▎  | 342/471 [01:36<00:33,  3.84it/s] 73%|███████▎  | 343/471 [01:37<00:35,  3.60it/s] 73%|███████▎  | 344/471 [01:37<00:35,  3.56it/s] 73%|███████▎  | 345/471 [01:37<00:37,  3.37it/s] 73%|███████▎  | 346/471 [01:37<00:36,  3.46it/s] 74%|███████▎  | 347/471 [01:38<00:37,  3.34it/s] 74%|███████▍  | 348/471 [01:38<00:35,  3.44it/s] 74%|███████▍  | 349/471 [01:38<00:37,  3.25it/s] 74%|███████▍  | 350/471 [01:39<00:36,  3.34it/s] 75%|███████▍  | 351/471 [01:39<00:36,  3.25it/s] 75%|███████▍  | 352/471 [01:39<00:36,  3.30it/s] 75%|███████▍  | 353/471 [01:40<00:35,  3.32it/s] 75%|███████▌  | 354/471 [01:40<00:35,  3.34it/s] 75%|███████▌  | 355/471 [01:40<00:35,  3.31it/s] 76%|███████▌  | 356/471 [01:41<00:34,  3.32it/s] 76%|███████▌  | 357/471 [01:41<00:34,  3.35it/s] 76%|███████▌  | 358/471 [01:41<00:33,  3.37it/s] 76%|███████▌  | 359/471 [01:41<00:31,  3.56it/s] 76%|███████▋  | 360/471 [01:42<00:31,  3.48it/s] 77%|███████▋  | 361/471 [01:42<00:30,  3.65it/s] 77%|███████▋  | 362/471 [01:42<00:31,  3.42it/s] 77%|███████▋  | 363/471 [01:42<00:30,  3.52it/s] 77%|███████▋  | 364/471 [01:43<00:31,  3.36it/s] 77%|███████▋  | 365/471 [01:43<00:30,  3.44it/s] 78%|███████▊  | 366/471 [01:43<00:31,  3.30it/s] 78%|███████▊  | 367/471 [01:44<00:31,  3.33it/s] 78%|███████▊  | 368/471 [01:44<00:31,  3.31it/s] 78%|███████▊  | 369/471 [01:44<00:30,  3.35it/s] 79%|███████▊  | 370/471 [01:45<00:29,  3.44it/s] 79%|███████▉  | 371/471 [01:45<00:30,  3.32it/s] 79%|███████▉  | 372/471 [01:45<00:30,  3.30it/s] 79%|███████▉  | 373/471 [01:46<00:30,  3.26it/s] 79%|███████▉  | 374/471 [01:46<00:29,  3.33it/s] 80%|███████▉  | 375/471 [01:46<00:29,  3.27it/s] 80%|███████▉  | 376/471 [01:46<00:28,  3.38it/s] 80%|████████  | 377/471 [01:47<00:28,  3.26it/s] 80%|████████  | 378/471 [01:47<00:27,  3.38it/s] 80%|████████  | 379/471 [01:47<00:28,  3.25it/s] 81%|████████  | 380/471 [01:48<00:26,  3.44it/s] 81%|████████  | 381/471 [01:48<00:27,  3.32it/s] 81%|████████  | 382/471 [01:48<00:26,  3.36it/s] 81%|████████▏ | 383/471 [01:49<00:27,  3.22it/s] 82%|████████▏ | 384/471 [01:49<00:26,  3.33it/s] 82%|████████▏ | 385/471 [01:49<00:26,  3.22it/s] 82%|████████▏ | 386/471 [01:49<00:25,  3.37it/s] 82%|████████▏ | 387/471 [01:50<00:26,  3.22it/s] 82%|████████▏ | 388/471 [01:50<00:25,  3.30it/s] 83%|████████▎ | 389/471 [01:50<00:25,  3.25it/s] 83%|████████▎ | 390/471 [01:51<00:24,  3.28it/s] 83%|████████▎ | 391/471 [01:51<00:23,  3.34it/s] 83%|████████▎ | 392/471 [01:51<00:23,  3.30it/s] 83%|████████▎ | 393/471 [01:52<00:23,  3.38it/s] 84%|████████▎ | 394/471 [01:52<00:23,  3.34it/s] 84%|████████▍ | 395/471 [01:52<00:21,  3.51it/s] 84%|████████▍ | 396/471 [01:52<00:21,  3.52it/s] 84%|████████▍ | 397/471 [01:53<00:20,  3.70it/s] 85%|████████▍ | 398/471 [01:53<00:20,  3.59it/s] 85%|████████▍ | 399/471 [01:53<00:19,  3.68it/s] 85%|████████▍ | 400/471 [01:53<00:19,  3.59it/s] 85%|████████▌ | 401/471 [01:54<00:18,  3.76it/s] 85%|████████▌ | 402/471 [01:54<00:18,  3.69it/s] 86%|████████▌ | 403/471 [01:54<00:18,  3.75it/s] 86%|████████▌ | 404/471 [01:55<00:18,  3.70it/s] 86%|████████▌ | 405/471 [01:55<00:18,  3.66it/s] 86%|████████▌ | 406/471 [01:55<00:17,  3.69it/s] 86%|████████▋ | 407/471 [01:55<00:17,  3.69it/s] 87%|████████▋ | 408/471 [01:56<00:16,  3.78it/s] 87%|████████▋ | 409/471 [01:56<00:17,  3.64it/s] 87%|████████▋ | 410/471 [01:56<00:17,  3.51it/s] 87%|████████▋ | 411/471 [01:57<00:17,  3.42it/s] 87%|████████▋ | 412/471 [01:57<00:17,  3.42it/s] 88%|████████▊ | 413/471 [01:57<00:17,  3.35it/s] 88%|████████▊ | 414/471 [01:57<00:16,  3.45it/s] 88%|████████▊ | 415/471 [01:58<00:16,  3.34it/s] 88%|████████▊ | 416/471 [01:58<00:15,  3.44it/s] 89%|████████▊ | 417/471 [01:58<00:15,  3.44it/s] 89%|████████▊ | 418/471 [01:59<00:14,  3.56it/s] 89%|████████▉ | 419/471 [01:59<00:14,  3.60it/s] 89%|████████▉ | 420/471 [01:59<00:13,  3.71it/s] 89%|████████▉ | 421/471 [01:59<00:13,  3.64it/s] 90%|████████▉ | 422/471 [02:00<00:13,  3.66it/s] 90%|████████▉ | 423/471 [02:00<00:13,  3.62it/s] 90%|█████████ | 424/471 [02:00<00:12,  3.75it/s] 90%|█████████ | 425/471 [02:00<00:11,  3.95it/s] 90%|█████████ | 426/471 [02:01<00:11,  3.98it/s] 91%|█████████ | 427/471 [02:01<00:10,  4.06it/s] 91%|█████████ | 428/471 [02:01<00:10,  4.06it/s] 91%|█████████ | 429/471 [02:01<00:10,  4.09it/s] 91%|█████████▏| 430/471 [02:02<00:10,  3.97it/s] 92%|█████████▏| 431/471 [02:02<00:10,  3.90it/s] 92%|█████████▏| 432/471 [02:02<00:10,  3.73it/s] 92%|█████████▏| 433/471 [02:02<00:10,  3.79it/s] 92%|█████████▏| 434/471 [02:03<00:10,  3.70it/s] 92%|█████████▏| 435/471 [02:03<00:09,  3.68it/s] 93%|█████████▎| 436/471 [02:03<00:09,  3.51it/s] 93%|█████████▎| 437/471 [02:04<00:09,  3.45it/s] 93%|█████████▎| 438/471 [02:04<00:09,  3.34it/s] 93%|█████████▎| 439/471 [02:04<00:09,  3.39it/s] 93%|█████████▎| 440/471 [02:05<00:09,  3.33it/s] 94%|█████████▎| 441/471 [02:05<00:08,  3.35it/s] 94%|█████████▍| 442/471 [02:05<00:08,  3.33it/s] 94%|█████████▍| 443/471 [02:05<00:08,  3.27it/s] 94%|█████████▍| 444/471 [02:06<00:08,  3.35it/s] 94%|█████████▍| 445/471 [02:06<00:07,  3.27it/s] 95%|█████████▍| 446/471 [02:06<00:07,  3.36it/s] 95%|█████████▍| 447/471 [02:07<00:07,  3.35it/s] 95%|█████████▌| 448/471 [02:07<00:06,  3.56it/s] 95%|█████████▌| 449/471 [02:07<00:06,  3.55it/s] 96%|█████████▌| 450/471 [02:07<00:05,  3.71it/s] 96%|█████████▌| 451/471 [02:08<00:05,  3.85it/s] 96%|█████████▌| 452/471 [02:08<00:04,  4.02it/s] 96%|█████████▌| 453/471 [02:08<00:04,  4.15it/s] 96%|█████████▋| 454/471 [02:08<00:04,  4.14it/s] 97%|█████████▋| 455/471 [02:09<00:03,  4.02it/s] 97%|█████████▋| 456/471 [02:09<00:03,  4.06it/s] 97%|█████████▋| 457/471 [02:09<00:03,  4.14it/s] 97%|█████████▋| 458/471 [02:09<00:03,  4.19it/s] 97%|█████████▋| 459/471 [02:09<00:02,  4.28it/s] 98%|█████████▊| 460/471 [02:10<00:02,  4.26it/s] 98%|█████████▊| 461/471 [02:10<00:02,  4.31it/s] 98%|█████████▊| 462/471 [02:10<00:02,  4.32it/s] 98%|█████████▊| 463/471 [02:10<00:01,  4.42it/s] 99%|█████████▊| 464/471 [02:11<00:01,  4.31it/s] 99%|█████████▊| 465/471 [02:11<00:01,  4.42it/s] 99%|█████████▉| 466/471 [02:11<00:01,  4.28it/s] 99%|█████████▉| 467/471 [02:11<00:00,  4.43it/s] 99%|█████████▉| 468/471 [02:12<00:00,  4.30it/s]100%|█████████▉| 469/471 [02:12<00:00,  4.19it/s]100%|█████████▉| 470/471 [02:12<00:00,  3.86it/s]100%|██████████| 471/471 [02:12<00:00,  3.85it/s]100%|██████████| 471/471 [02:12<00:00,  3.54it/s]
{'eval_loss': 2.03056001663208, 'eval_model_preparation_time': 0.0073, 'eval_acc': 0.4881837493361657, 'eval_runtime': 133.1676, 'eval_samples_per_second': 56.56, 'eval_steps_per_second': 3.537}
ROUND:14
CLIENT:72
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.61it/s]                                              {'loss': 2.0687, 'grad_norm': 4.781069278717041, 'learning_rate': 0.00013741196746494238, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.61it/s]  5%|▌         | 2/40 [00:01<00:24,  1.56it/s]                                              {'loss': 2.1842, 'grad_norm': 3.492642402648926, 'learning_rate': 0.0001339766682783188, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.56it/s]  8%|▊         | 3/40 [00:01<00:23,  1.55it/s]                                              {'loss': 2.0706, 'grad_norm': 4.402886390686035, 'learning_rate': 0.00013054136909169525, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.55it/s] 10%|█         | 4/40 [00:02<00:23,  1.54it/s]                                              {'loss': 2.3273, 'grad_norm': 4.918159008026123, 'learning_rate': 0.0001271060699050717, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.54it/s] 12%|█▎        | 5/40 [00:03<00:22,  1.53it/s]                                              {'loss': 2.079, 'grad_norm': 5.49984073638916, 'learning_rate': 0.00012367077071844814, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:22,  1.53it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.54it/s]                                              {'loss': 2.1077, 'grad_norm': 4.556416988372803, 'learning_rate': 0.00012023547153182458, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.54it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s]                                              {'loss': 1.9358, 'grad_norm': 3.610046148300171, 'learning_rate': 0.00011680017234520101, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.53it/s] 20%|██        | 8/40 [00:05<00:19,  1.68it/s]                                              {'loss': 2.326, 'grad_norm': 11.897904396057129, 'learning_rate': 0.00011336487315857746, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:19,  1.68it/s] 22%|██▎       | 9/40 [00:05<00:18,  1.64it/s]                                              {'loss': 1.8319, 'grad_norm': 3.887239694595337, 'learning_rate': 0.0001099295739719539, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:18,  1.64it/s] 25%|██▌       | 10/40 [00:06<00:18,  1.61it/s]                                               {'loss': 1.7961, 'grad_norm': 4.195404052734375, 'learning_rate': 0.00010649427478533034, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:18,  1.61it/s] 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s]                                               {'loss': 2.0986, 'grad_norm': 3.8498573303222656, 'learning_rate': 0.00010305897559870678, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:18,  1.59it/s] 30%|███       | 12/40 [00:07<00:17,  1.57it/s]                                               {'loss': 1.9684, 'grad_norm': 3.862440586090088, 'learning_rate': 9.962367641208322e-05, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.57it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.56it/s]                                               {'loss': 1.9303, 'grad_norm': 3.872330665588379, 'learning_rate': 9.618837722545966e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.56it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.57it/s]                                               {'loss': 2.0119, 'grad_norm': 3.983396291732788, 'learning_rate': 9.27530780388361e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.57it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.56it/s]                                               {'loss': 2.0462, 'grad_norm': 3.7740280628204346, 'learning_rate': 8.931777885221255e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.56it/s] 40%|████      | 16/40 [00:09<00:11,  2.00it/s]                                               {'loss': 1.6093, 'grad_norm': 14.672120094299316, 'learning_rate': 8.588247966558899e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:11,  2.00it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.84it/s]                                               {'loss': 1.8104, 'grad_norm': 3.6275200843811035, 'learning_rate': 8.244718047896542e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.84it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s]                                               {'loss': 1.8021, 'grad_norm': 3.2286133766174316, 'learning_rate': 7.901188129234186e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s]                                               {'loss': 1.8548, 'grad_norm': 3.8869869709014893, 'learning_rate': 7.557658210571832e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.74it/s] 50%|█████     | 20/40 [00:12<00:11,  1.75it/s]                                               {'loss': 1.8359, 'grad_norm': 3.6474435329437256, 'learning_rate': 7.214128291909475e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:11,  1.75it/s] 52%|█████▎    | 21/40 [00:12<00:10,  1.78it/s]                                               {'loss': 1.854, 'grad_norm': 4.382907867431641, 'learning_rate': 6.870598373247119e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:10,  1.78it/s] 55%|█████▌    | 22/40 [00:13<00:09,  1.84it/s]                                               {'loss': 2.0159, 'grad_norm': 4.296199321746826, 'learning_rate': 6.527068454584762e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:09,  1.84it/s] 57%|█████▊    | 23/40 [00:13<00:08,  1.90it/s]                                               {'loss': 1.9776, 'grad_norm': 3.588193893432617, 'learning_rate': 6.183538535922407e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:08,  1.90it/s] 60%|██████    | 24/40 [00:13<00:06,  2.42it/s]                                               {'loss': 1.1573, 'grad_norm': 6.69776725769043, 'learning_rate': 5.8400086172600505e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:06,  2.42it/s] 62%|██████▎   | 25/40 [00:14<00:07,  2.14it/s]                                               {'loss': 1.8261, 'grad_norm': 3.42738676071167, 'learning_rate': 5.496478698597695e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  2.14it/s] 65%|██████▌   | 26/40 [00:14<00:06,  2.03it/s]                                               {'loss': 2.0321, 'grad_norm': 3.5881760120391846, 'learning_rate': 5.152948779935339e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:06,  2.03it/s] 68%|██████▊   | 27/40 [00:15<00:06,  1.88it/s]                                               {'loss': 2.011, 'grad_norm': 4.432323932647705, 'learning_rate': 4.809418861272983e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:06,  1.88it/s] 70%|███████   | 28/40 [00:16<00:06,  1.77it/s]                                               {'loss': 1.7798, 'grad_norm': 4.627139568328857, 'learning_rate': 4.465888942610628e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:06,  1.77it/s] 72%|███████▎  | 29/40 [00:16<00:06,  1.69it/s]                                               {'loss': 1.6172, 'grad_norm': 3.693925142288208, 'learning_rate': 4.122359023948271e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:06,  1.69it/s] 75%|███████▌  | 30/40 [00:17<00:06,  1.63it/s]                                               {'loss': 1.8272, 'grad_norm': 3.860671281814575, 'learning_rate': 3.778829105285916e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:06,  1.63it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.62it/s]                                               {'loss': 1.8644, 'grad_norm': 5.008179664611816, 'learning_rate': 3.4352991866235594e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.62it/s] 80%|████████  | 32/40 [00:18<00:03,  2.08it/s]                                               {'loss': 1.1509, 'grad_norm': 23.419076919555664, 'learning_rate': 3.0917692679612035e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:03,  2.08it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.86it/s]                                               {'loss': 1.7703, 'grad_norm': 3.223010778427124, 'learning_rate': 2.7482393492988477e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.86it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.75it/s]                                               {'loss': 1.8577, 'grad_norm': 3.87243914604187, 'learning_rate': 2.4047094306364915e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.75it/s] 88%|████████▊ | 35/40 [00:20<00:02,  1.70it/s]                                               {'loss': 1.8479, 'grad_norm': 3.464146375656128, 'learning_rate': 2.0611795119741356e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  1.70it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.62it/s]                                               {'loss': 1.9988, 'grad_norm': 4.232052326202393, 'learning_rate': 1.7176495933117797e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:21<00:01,  1.60it/s]                                               {'loss': 1.648, 'grad_norm': 2.6739964485168457, 'learning_rate': 1.3741196746494238e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  1.60it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.57it/s]                                               {'loss': 2.0705, 'grad_norm': 4.147823810577393, 'learning_rate': 1.0305897559870678e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.57it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.55it/s]                                               {'loss': 1.5795, 'grad_norm': 2.8523850440979004, 'learning_rate': 6.870598373247119e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.55it/s]100%|██████████| 40/40 [00:23<00:00,  2.00it/s]                                               {'loss': 1.9241, 'grad_norm': 11.37344741821289, 'learning_rate': 3.4352991866235596e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.00it/s]                                               {'train_runtime': 23.1963, 'train_samples_per_second': 24.357, 'train_steps_per_second': 1.724, 'train_loss': 1.8876401424407958, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.00it/s]100%|██████████| 40/40 [00:23<00:00,  1.72it/s]
CLIENT:33
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.60it/s]                                              {'loss': 1.9325, 'grad_norm': 3.2837326526641846, 'learning_rate': 0.00013741196746494238, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.60it/s]  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]                                              {'loss': 2.1514, 'grad_norm': 6.028441905975342, 'learning_rate': 0.0001339766682783188, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.53it/s]  8%|▊         | 3/40 [00:01<00:23,  1.55it/s]                                              {'loss': 2.1236, 'grad_norm': 5.294883728027344, 'learning_rate': 0.00013054136909169525, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.55it/s] 10%|█         | 4/40 [00:02<00:23,  1.51it/s]                                              {'loss': 2.3158, 'grad_norm': 4.503406047821045, 'learning_rate': 0.0001271060699050717, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.51it/s] 12%|█▎        | 5/40 [00:03<00:23,  1.51it/s]                                              {'loss': 2.1901, 'grad_norm': 6.899227619171143, 'learning_rate': 0.00012367077071844814, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:23,  1.51it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.50it/s]                                              {'loss': 2.1094, 'grad_norm': 6.100861072540283, 'learning_rate': 0.00012023547153182458, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.50it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.50it/s]                                              {'loss': 2.1399, 'grad_norm': 4.772965431213379, 'learning_rate': 0.00011680017234520101, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.50it/s] 20%|██        | 8/40 [00:05<00:21,  1.47it/s]                                              {'loss': 2.2348, 'grad_norm': 29.48934555053711, 'learning_rate': 0.00011336487315857746, 'epoch': 1.0}
 20%|██        | 8/40 [00:05<00:21,  1.47it/s] 22%|██▎       | 9/40 [00:05<00:20,  1.49it/s]                                              {'loss': 2.0643, 'grad_norm': 4.391923904418945, 'learning_rate': 0.0001099295739719539, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:06<00:20,  1.49it/s] 25%|██▌       | 10/40 [00:06<00:19,  1.51it/s]                                               {'loss': 2.0038, 'grad_norm': 3.4695966243743896, 'learning_rate': 0.00010649427478533034, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:19,  1.51it/s] 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s]                                               {'loss': 1.9719, 'grad_norm': 8.033287048339844, 'learning_rate': 0.00010305897559870678, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:07<00:19,  1.51it/s] 30%|███       | 12/40 [00:07<00:18,  1.50it/s]                                               {'loss': 2.2895, 'grad_norm': 7.120360851287842, 'learning_rate': 9.962367641208322e-05, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:18,  1.50it/s] 32%|███▎      | 13/40 [00:08<00:17,  1.51it/s]                                               {'loss': 2.2523, 'grad_norm': 4.064680099487305, 'learning_rate': 9.618837722545966e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:08<00:17,  1.51it/s] 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s]                                               {'loss': 1.9393, 'grad_norm': 3.5192253589630127, 'learning_rate': 9.27530780388361e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:09<00:17,  1.51it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.51it/s]                                               {'loss': 2.0155, 'grad_norm': 4.713982582092285, 'learning_rate': 8.931777885221255e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.51it/s] 40%|████      | 16/40 [00:10<00:12,  1.93it/s]                                               {'loss': 1.9986, 'grad_norm': 16.194398880004883, 'learning_rate': 8.588247966558899e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:10<00:12,  1.93it/s] 42%|████▎     | 17/40 [00:10<00:12,  1.78it/s]                                               {'loss': 1.878, 'grad_norm': 4.033048629760742, 'learning_rate': 8.244718047896542e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:10<00:12,  1.78it/s] 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s]                                               {'loss': 2.0397, 'grad_norm': 4.086350917816162, 'learning_rate': 7.901188129234186e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:11<00:12,  1.76it/s] 48%|████▊     | 19/40 [00:11<00:11,  1.77it/s]                                               {'loss': 2.0014, 'grad_norm': 3.646023988723755, 'learning_rate': 7.557658210571832e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:11,  1.77it/s] 50%|█████     | 20/40 [00:12<00:11,  1.74it/s]                                               {'loss': 2.0069, 'grad_norm': 3.7494242191314697, 'learning_rate': 7.214128291909475e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:12<00:11,  1.74it/s] 52%|█████▎    | 21/40 [00:13<00:10,  1.75it/s]                                               {'loss': 2.1285, 'grad_norm': 4.7147088050842285, 'learning_rate': 6.870598373247119e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:13<00:10,  1.75it/s] 55%|█████▌    | 22/40 [00:13<00:10,  1.73it/s]                                               {'loss': 1.8985, 'grad_norm': 4.2547526359558105, 'learning_rate': 6.527068454584762e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:13<00:10,  1.73it/s] 57%|█████▊    | 23/40 [00:14<00:10,  1.69it/s]                                               {'loss': 1.9887, 'grad_norm': 5.6225666999816895, 'learning_rate': 6.183538535922407e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:14<00:10,  1.69it/s] 60%|██████    | 24/40 [00:14<00:07,  2.14it/s]                                               {'loss': 2.281, 'grad_norm': 17.175460815429688, 'learning_rate': 5.8400086172600505e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:14<00:07,  2.14it/s] 62%|██████▎   | 25/40 [00:15<00:07,  1.91it/s]                                               {'loss': 1.9413, 'grad_norm': 3.861220121383667, 'learning_rate': 5.496478698597695e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:15<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:15<00:07,  1.75it/s]                                               {'loss': 2.1224, 'grad_norm': 3.8300209045410156, 'learning_rate': 5.152948779935339e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:15<00:07,  1.75it/s] 68%|██████▊   | 27/40 [00:16<00:07,  1.70it/s]                                               {'loss': 2.0077, 'grad_norm': 7.2058305740356445, 'learning_rate': 4.809418861272983e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:16<00:07,  1.70it/s] 70%|███████   | 28/40 [00:17<00:07,  1.66it/s]                                               {'loss': 2.1969, 'grad_norm': 3.652825355529785, 'learning_rate': 4.465888942610628e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:17<00:07,  1.66it/s] 72%|███████▎  | 29/40 [00:17<00:06,  1.59it/s]                                               {'loss': 2.0356, 'grad_norm': 4.857317924499512, 'learning_rate': 4.122359023948271e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:17<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:18<00:06,  1.59it/s]                                               {'loss': 1.9145, 'grad_norm': 4.053892612457275, 'learning_rate': 3.778829105285916e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:18<00:06,  1.59it/s] 78%|███████▊  | 31/40 [00:19<00:05,  1.56it/s]                                               {'loss': 1.772, 'grad_norm': 3.9024717807769775, 'learning_rate': 3.4352991866235594e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:19<00:05,  1.56it/s] 80%|████████  | 32/40 [00:19<00:03,  2.00it/s]                                               {'loss': 2.4858, 'grad_norm': 18.084909439086914, 'learning_rate': 3.0917692679612035e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:19<00:03,  2.00it/s] 82%|████████▎ | 33/40 [00:19<00:03,  1.84it/s]                                               {'loss': 1.965, 'grad_norm': 3.313999652862549, 'learning_rate': 2.7482393492988477e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:19<00:03,  1.84it/s] 85%|████████▌ | 34/40 [00:20<00:03,  1.72it/s]                                               {'loss': 2.0099, 'grad_norm': 4.405773639678955, 'learning_rate': 2.4047094306364915e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:20<00:03,  1.72it/s] 88%|████████▊ | 35/40 [00:21<00:03,  1.66it/s]                                               {'loss': 1.9841, 'grad_norm': 4.149709701538086, 'learning_rate': 2.0611795119741356e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:21<00:03,  1.66it/s] 90%|█████████ | 36/40 [00:21<00:02,  1.62it/s]                                               {'loss': 1.9919, 'grad_norm': 5.504284858703613, 'learning_rate': 1.7176495933117797e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:21<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s]                                               {'loss': 1.9764, 'grad_norm': 4.727844715118408, 'learning_rate': 1.3741196746494238e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:22<00:01,  1.57it/s] 95%|█████████▌| 38/40 [00:23<00:01,  1.56it/s]                                               {'loss': 1.7845, 'grad_norm': 4.396286964416504, 'learning_rate': 1.0305897559870678e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:23<00:01,  1.56it/s] 98%|█████████▊| 39/40 [00:23<00:00,  1.56it/s]                                               {'loss': 1.8088, 'grad_norm': 4.53466796875, 'learning_rate': 6.870598373247119e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:23<00:00,  1.56it/s]100%|██████████| 40/40 [00:24<00:00,  2.00it/s]                                               {'loss': 2.0765, 'grad_norm': 15.874343872070312, 'learning_rate': 3.4352991866235596e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.00it/s]                                               {'train_runtime': 24.1303, 'train_samples_per_second': 23.415, 'train_steps_per_second': 1.658, 'train_loss': 2.0507122457027434, 'epoch': 5.0}
100%|██████████| 40/40 [00:24<00:00,  2.00it/s]100%|██████████| 40/40 [00:24<00:00,  1.66it/s]
CLIENT:58
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:01<00:52,  1.35s/it]                                              {'loss': 2.1947, 'grad_norm': 4.28451681137085, 'learning_rate': 0.00013741196746494238, 'epoch': 0.12}
  2%|▎         | 1/40 [00:01<00:52,  1.35s/it]  5%|▌         | 2/40 [00:01<00:33,  1.13it/s]                                              {'loss': 2.0973, 'grad_norm': 4.203600883483887, 'learning_rate': 0.0001339766682783188, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:33,  1.13it/s]  8%|▊         | 3/40 [00:02<00:27,  1.34it/s]                                              {'loss': 2.0576, 'grad_norm': 5.4848809242248535, 'learning_rate': 0.00013054136909169525, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:27,  1.34it/s] 10%|█         | 4/40 [00:03<00:24,  1.48it/s]                                              {'loss': 2.1568, 'grad_norm': 4.6589460372924805, 'learning_rate': 0.0001271060699050717, 'epoch': 0.5}
 10%|█         | 4/40 [00:03<00:24,  1.48it/s] 12%|█▎        | 5/40 [00:03<00:22,  1.56it/s]                                              {'loss': 2.0305, 'grad_norm': 6.135193824768066, 'learning_rate': 0.00012367077071844814, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:22,  1.56it/s] 15%|█▌        | 6/40 [00:04<00:20,  1.65it/s]                                              {'loss': 2.2617, 'grad_norm': 4.148303031921387, 'learning_rate': 0.00012023547153182458, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:04<00:20,  1.65it/s] 18%|█▊        | 7/40 [00:04<00:19,  1.68it/s]                                              {'loss': 2.0065, 'grad_norm': 3.4404051303863525, 'learning_rate': 0.00011680017234520101, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:19,  1.68it/s] 20%|██        | 8/40 [00:04<00:14,  2.20it/s]                                              {'loss': 1.7786, 'grad_norm': 14.874101638793945, 'learning_rate': 0.00011336487315857746, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.20it/s] 22%|██▎       | 9/40 [00:05<00:15,  2.04it/s]                                              {'loss': 2.0312, 'grad_norm': 4.732279300689697, 'learning_rate': 0.0001099295739719539, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:15,  2.04it/s] 25%|██▌       | 10/40 [00:06<00:15,  1.94it/s]                                               {'loss': 2.0277, 'grad_norm': 3.6966030597686768, 'learning_rate': 0.00010649427478533034, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:15,  1.94it/s] 28%|██▊       | 11/40 [00:06<00:15,  1.87it/s]                                               {'loss': 2.0301, 'grad_norm': 3.307504653930664, 'learning_rate': 0.00010305897559870678, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:15,  1.87it/s] 30%|███       | 12/40 [00:07<00:16,  1.74it/s]                                               {'loss': 2.09, 'grad_norm': 4.00048828125, 'learning_rate': 9.962367641208322e-05, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.74it/s] 32%|███▎      | 13/40 [00:07<00:16,  1.67it/s]                                               {'loss': 1.9853, 'grad_norm': 4.432232856750488, 'learning_rate': 9.618837722545966e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:16,  1.67it/s] 35%|███▌      | 14/40 [00:08<00:15,  1.66it/s]                                               {'loss': 2.0314, 'grad_norm': 6.843969821929932, 'learning_rate': 9.27530780388361e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:15,  1.66it/s] 38%|███▊      | 15/40 [00:09<00:15,  1.66it/s]                                               {'loss': 2.0789, 'grad_norm': 3.4740192890167236, 'learning_rate': 8.931777885221255e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:15,  1.66it/s] 40%|████      | 16/40 [00:09<00:11,  2.16it/s]                                               {'loss': 2.2846, 'grad_norm': 11.046184539794922, 'learning_rate': 8.588247966558899e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:11,  2.16it/s] 42%|████▎     | 17/40 [00:09<00:11,  2.01it/s]                                               {'loss': 1.7129, 'grad_norm': 3.0113234519958496, 'learning_rate': 8.244718047896542e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:11,  2.01it/s] 45%|████▌     | 18/40 [00:10<00:11,  1.89it/s]                                               {'loss': 1.8624, 'grad_norm': 5.04764461517334, 'learning_rate': 7.901188129234186e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:11,  1.89it/s] 48%|████▊     | 19/40 [00:11<00:11,  1.85it/s]                                               {'loss': 1.9637, 'grad_norm': 4.990541458129883, 'learning_rate': 7.557658210571832e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:11,  1.85it/s] 50%|█████     | 20/40 [00:11<00:10,  1.82it/s]                                               {'loss': 1.9516, 'grad_norm': 4.307699680328369, 'learning_rate': 7.214128291909475e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:10,  1.82it/s] 52%|█████▎    | 21/40 [00:12<00:10,  1.79it/s]                                               {'loss': 2.0772, 'grad_norm': 4.657124042510986, 'learning_rate': 6.870598373247119e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:10,  1.79it/s] 55%|█████▌    | 22/40 [00:12<00:10,  1.74it/s]                                               {'loss': 2.0026, 'grad_norm': 5.357555866241455, 'learning_rate': 6.527068454584762e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:10,  1.74it/s] 57%|█████▊    | 23/40 [00:13<00:10,  1.65it/s]                                               {'loss': 2.047, 'grad_norm': 4.3812079429626465, 'learning_rate': 6.183538535922407e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:10,  1.65it/s] 60%|██████    | 24/40 [00:13<00:07,  2.10it/s]                                               {'loss': 1.9864, 'grad_norm': 22.77823829650879, 'learning_rate': 5.8400086172600505e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:07,  2.10it/s] 62%|██████▎   | 25/40 [00:14<00:07,  1.91it/s]                                               {'loss': 1.8208, 'grad_norm': 3.672468900680542, 'learning_rate': 5.496478698597695e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  1.91it/s] 65%|██████▌   | 26/40 [00:14<00:08,  1.75it/s]                                               {'loss': 1.8935, 'grad_norm': 5.070695877075195, 'learning_rate': 5.152948779935339e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:08,  1.75it/s] 68%|██████▊   | 27/40 [00:15<00:07,  1.68it/s]                                               {'loss': 2.0872, 'grad_norm': 5.171694278717041, 'learning_rate': 4.809418861272983e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:07,  1.68it/s] 70%|███████   | 28/40 [00:16<00:07,  1.63it/s]                                               {'loss': 1.8708, 'grad_norm': 4.155125617980957, 'learning_rate': 4.465888942610628e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:16<00:07,  1.63it/s] 72%|███████▎  | 29/40 [00:16<00:06,  1.59it/s]                                               {'loss': 1.9641, 'grad_norm': 3.6622347831726074, 'learning_rate': 4.122359023948271e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:06,  1.59it/s] 75%|███████▌  | 30/40 [00:17<00:06,  1.60it/s]                                               {'loss': 1.9736, 'grad_norm': 4.609740734100342, 'learning_rate': 3.778829105285916e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:06,  1.60it/s] 78%|███████▊  | 31/40 [00:18<00:05,  1.64it/s]                                               {'loss': 1.9334, 'grad_norm': 4.707390308380127, 'learning_rate': 3.4352991866235594e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:18<00:05,  1.64it/s] 80%|████████  | 32/40 [00:18<00:03,  2.12it/s]                                               {'loss': 2.4171, 'grad_norm': 22.5144100189209, 'learning_rate': 3.0917692679612035e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:03,  2.12it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.91it/s]                                               {'loss': 1.9653, 'grad_norm': 3.843350410461426, 'learning_rate': 2.7482393492988477e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.91it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.77it/s]                                               {'loss': 1.824, 'grad_norm': 3.633875608444214, 'learning_rate': 2.4047094306364915e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.77it/s] 88%|████████▊ | 35/40 [00:20<00:02,  1.70it/s]                                               {'loss': 1.7704, 'grad_norm': 3.633989095687866, 'learning_rate': 2.0611795119741356e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  1.70it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.62it/s]                                               {'loss': 2.0214, 'grad_norm': 4.1136040687561035, 'learning_rate': 1.7176495933117797e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.62it/s] 92%|█████████▎| 37/40 [00:21<00:01,  1.60it/s]                                               {'loss': 1.8684, 'grad_norm': 4.6158976554870605, 'learning_rate': 1.3741196746494238e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  1.60it/s] 95%|█████████▌| 38/40 [00:22<00:01,  1.60it/s]                                               {'loss': 1.9755, 'grad_norm': 5.561349868774414, 'learning_rate': 1.0305897559870678e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:22<00:01,  1.60it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.61it/s]                                               {'loss': 2.0005, 'grad_norm': 3.9941446781158447, 'learning_rate': 6.870598373247119e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.61it/s]100%|██████████| 40/40 [00:22<00:00,  2.07it/s]                                               {'loss': 1.8196, 'grad_norm': 16.28838348388672, 'learning_rate': 3.4352991866235596e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.07it/s]                                               {'train_runtime': 23.077, 'train_samples_per_second': 24.483, 'train_steps_per_second': 1.733, 'train_loss': 1.9988104820251464, 'epoch': 5.0}
100%|██████████| 40/40 [00:23<00:00,  2.07it/s]100%|██████████| 40/40 [00:23<00:00,  1.73it/s]
CLIENT:2
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:35,  1.10it/s]                                              {'loss': 2.124, 'grad_norm': 4.114675998687744, 'learning_rate': 0.00013741196746494238, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:35,  1.10it/s]  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]                                              {'loss': 2.201, 'grad_norm': 5.821439266204834, 'learning_rate': 0.0001339766682783188, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:28,  1.34it/s]  8%|▊         | 3/40 [00:02<00:26,  1.42it/s]                                              {'loss': 1.9039, 'grad_norm': 4.105041027069092, 'learning_rate': 0.00013054136909169525, 'epoch': 0.38}
  8%|▊         | 3/40 [00:02<00:26,  1.42it/s] 10%|█         | 4/40 [00:02<00:23,  1.53it/s]                                              {'loss': 1.9743, 'grad_norm': 5.061305999755859, 'learning_rate': 0.0001271060699050717, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:23,  1.53it/s] 12%|█▎        | 5/40 [00:03<00:21,  1.63it/s]                                              {'loss': 2.2725, 'grad_norm': 4.875715732574463, 'learning_rate': 0.00012367077071844814, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:21,  1.63it/s] 15%|█▌        | 6/40 [00:03<00:20,  1.63it/s]                                              {'loss': 2.0484, 'grad_norm': 4.962559700012207, 'learning_rate': 0.00012023547153182458, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:20,  1.63it/s] 18%|█▊        | 7/40 [00:04<00:19,  1.67it/s]                                              {'loss': 2.142, 'grad_norm': 5.541947364807129, 'learning_rate': 0.00011680017234520101, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:19,  1.67it/s] 20%|██        | 8/40 [00:04<00:14,  2.20it/s]                                              {'loss': 0.8222, 'grad_norm': 6.450139999389648, 'learning_rate': 0.00011336487315857746, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:14,  2.20it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.92it/s]                                              {'loss': 1.9195, 'grad_norm': 3.5323755741119385, 'learning_rate': 0.0001099295739719539, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.92it/s] 25%|██▌       | 10/40 [00:05<00:16,  1.77it/s]                                               {'loss': 1.8355, 'grad_norm': 4.650053977966309, 'learning_rate': 0.00010649427478533034, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:16,  1.77it/s] 28%|██▊       | 11/40 [00:06<00:16,  1.71it/s]                                               {'loss': 1.9808, 'grad_norm': 4.039185047149658, 'learning_rate': 0.00010305897559870678, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:16,  1.71it/s] 30%|███       | 12/40 [00:07<00:16,  1.65it/s]                                               {'loss': 2.0673, 'grad_norm': 4.361112117767334, 'learning_rate': 9.962367641208322e-05, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:16,  1.65it/s] 32%|███▎      | 13/40 [00:07<00:16,  1.63it/s]                                               {'loss': 1.9179, 'grad_norm': 5.0231194496154785, 'learning_rate': 9.618837722545966e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:16,  1.63it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.59it/s]                                               {'loss': 2.0275, 'grad_norm': 4.544475555419922, 'learning_rate': 9.27530780388361e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.59it/s] 38%|███▊      | 15/40 [00:09<00:15,  1.64it/s]                                               {'loss': 2.0276, 'grad_norm': 4.0324907302856445, 'learning_rate': 8.931777885221255e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:15,  1.64it/s] 40%|████      | 16/40 [00:09<00:11,  2.10it/s]                                               {'loss': 1.6533, 'grad_norm': 10.555387496948242, 'learning_rate': 8.588247966558899e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:11,  2.10it/s] 42%|████▎     | 17/40 [00:09<00:11,  1.98it/s]                                               {'loss': 1.8015, 'grad_norm': 3.6587626934051514, 'learning_rate': 8.244718047896542e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:11,  1.98it/s] 45%|████▌     | 18/40 [00:10<00:11,  1.89it/s]                                               {'loss': 1.8928, 'grad_norm': 4.78666353225708, 'learning_rate': 7.901188129234186e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:11,  1.89it/s] 48%|████▊     | 19/40 [00:11<00:11,  1.85it/s]                                               {'loss': 1.7249, 'grad_norm': 3.020207166671753, 'learning_rate': 7.557658210571832e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:11,  1.85it/s] 50%|█████     | 20/40 [00:11<00:11,  1.80it/s]                                               {'loss': 1.9371, 'grad_norm': 3.9131433963775635, 'learning_rate': 7.214128291909475e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:11,  1.80it/s] 52%|█████▎    | 21/40 [00:12<00:10,  1.79it/s]                                               {'loss': 2.3287, 'grad_norm': 5.13979434967041, 'learning_rate': 6.870598373247119e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:10,  1.79it/s] 55%|█████▌    | 22/40 [00:12<00:10,  1.70it/s]                                               {'loss': 1.9955, 'grad_norm': 4.509467124938965, 'learning_rate': 6.527068454584762e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:10,  1.70it/s] 57%|█████▊    | 23/40 [00:13<00:10,  1.66it/s]                                               {'loss': 1.8813, 'grad_norm': 3.3767123222351074, 'learning_rate': 6.183538535922407e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:10,  1.66it/s] 60%|██████    | 24/40 [00:13<00:07,  2.12it/s]                                               {'loss': 2.0268, 'grad_norm': 12.72332763671875, 'learning_rate': 5.8400086172600505e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:07,  2.12it/s] 62%|██████▎   | 25/40 [00:14<00:07,  2.02it/s]                                               {'loss': 1.9057, 'grad_norm': 3.787182331085205, 'learning_rate': 5.496478698597695e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:14<00:07,  2.02it/s] 65%|██████▌   | 26/40 [00:14<00:07,  1.89it/s]                                               {'loss': 1.9494, 'grad_norm': 4.054750442504883, 'learning_rate': 5.152948779935339e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:07,  1.89it/s] 68%|██████▊   | 27/40 [00:15<00:07,  1.84it/s]                                               {'loss': 1.821, 'grad_norm': 3.9182801246643066, 'learning_rate': 4.809418861272983e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:07,  1.84it/s] 70%|███████   | 28/40 [00:15<00:06,  1.79it/s]                                               {'loss': 2.2486, 'grad_norm': 4.658812999725342, 'learning_rate': 4.465888942610628e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:06,  1.79it/s] 72%|███████▎  | 29/40 [00:16<00:06,  1.70it/s]                                               {'loss': 1.811, 'grad_norm': 4.39462423324585, 'learning_rate': 4.122359023948271e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:06,  1.70it/s] 75%|███████▌  | 30/40 [00:17<00:06,  1.66it/s]                                               {'loss': 1.6861, 'grad_norm': 4.083183765411377, 'learning_rate': 3.778829105285916e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:17<00:06,  1.66it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.60it/s]                                               {'loss': 2.1291, 'grad_norm': 5.741122245788574, 'learning_rate': 3.4352991866235594e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.60it/s] 80%|████████  | 32/40 [00:18<00:03,  2.06it/s]                                               {'loss': 2.2039, 'grad_norm': 15.96752643585205, 'learning_rate': 3.0917692679612035e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:18<00:03,  2.06it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.88it/s]                                               {'loss': 1.7787, 'grad_norm': 3.5481555461883545, 'learning_rate': 2.7482393492988477e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.88it/s] 85%|████████▌ | 34/40 [00:19<00:03,  1.76it/s]                                               {'loss': 2.2608, 'grad_norm': 3.7712459564208984, 'learning_rate': 2.4047094306364915e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:19<00:03,  1.76it/s] 88%|████████▊ | 35/40 [00:20<00:02,  1.70it/s]                                               {'loss': 1.7992, 'grad_norm': 4.0102620124816895, 'learning_rate': 2.0611795119741356e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:20<00:02,  1.70it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.65it/s]                                               {'loss': 1.7107, 'grad_norm': 4.0577826499938965, 'learning_rate': 1.7176495933117797e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.65it/s] 92%|█████████▎| 37/40 [00:21<00:01,  1.61it/s]                                               {'loss': 2.0026, 'grad_norm': 5.016417980194092, 'learning_rate': 1.3741196746494238e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:21<00:01,  1.61it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.60it/s]                                               {'loss': 1.7478, 'grad_norm': 5.20564079284668, 'learning_rate': 1.0305897559870678e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.60it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.58it/s]                                               {'loss': 1.8714, 'grad_norm': 4.520741939544678, 'learning_rate': 6.870598373247119e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.58it/s]100%|██████████| 40/40 [00:22<00:00,  1.98it/s]                                               {'loss': 2.448, 'grad_norm': 23.507465362548828, 'learning_rate': 3.4352991866235596e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.98it/s]                                               {'train_runtime': 22.9192, 'train_samples_per_second': 24.652, 'train_steps_per_second': 1.745, 'train_loss': 1.9470011472702027, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  1.98it/s]100%|██████████| 40/40 [00:22<00:00,  1.75it/s]
CLIENT:55
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:24,  1.58it/s]                                              {'loss': 2.0117, 'grad_norm': 3.8589649200439453, 'learning_rate': 0.00013741196746494238, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:24,  1.58it/s]  5%|▌         | 2/40 [00:01<00:23,  1.58it/s]                                              {'loss': 2.2795, 'grad_norm': 4.2481913566589355, 'learning_rate': 0.0001339766682783188, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:23,  1.58it/s]  8%|▊         | 3/40 [00:01<00:23,  1.57it/s]                                              {'loss': 2.1477, 'grad_norm': 3.4324216842651367, 'learning_rate': 0.00013054136909169525, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.57it/s] 10%|█         | 4/40 [00:02<00:22,  1.57it/s]                                              {'loss': 2.0448, 'grad_norm': 4.273215293884277, 'learning_rate': 0.0001271060699050717, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:22,  1.57it/s] 12%|█▎        | 5/40 [00:03<00:22,  1.56it/s]                                              {'loss': 2.2031, 'grad_norm': 6.9302544593811035, 'learning_rate': 0.00012367077071844814, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:22,  1.56it/s] 15%|█▌        | 6/40 [00:03<00:22,  1.53it/s]                                              {'loss': 1.9055, 'grad_norm': 3.704641580581665, 'learning_rate': 0.00012023547153182458, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:22,  1.53it/s] 18%|█▊        | 7/40 [00:04<00:21,  1.55it/s]                                              {'loss': 2.206, 'grad_norm': 4.044178009033203, 'learning_rate': 0.00011680017234520101, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:21,  1.55it/s] 20%|██        | 8/40 [00:04<00:16,  1.92it/s]                                              {'loss': 2.5575, 'grad_norm': 31.040557861328125, 'learning_rate': 0.00011336487315857746, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:16,  1.92it/s] 22%|██▎       | 9/40 [00:05<00:17,  1.75it/s]                                              {'loss': 2.0604, 'grad_norm': 4.802019119262695, 'learning_rate': 0.0001099295739719539, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:17,  1.75it/s] 25%|██▌       | 10/40 [00:06<00:17,  1.68it/s]                                               {'loss': 1.8524, 'grad_norm': 3.150634288787842, 'learning_rate': 0.00010649427478533034, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:06<00:17,  1.68it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.62it/s]                                               {'loss': 2.2077, 'grad_norm': 4.937520503997803, 'learning_rate': 0.00010305897559870678, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.62it/s] 30%|███       | 12/40 [00:07<00:17,  1.61it/s]                                               {'loss': 2.078, 'grad_norm': 3.1674585342407227, 'learning_rate': 9.962367641208322e-05, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.61it/s] 32%|███▎      | 13/40 [00:07<00:16,  1.65it/s]                                               {'loss': 2.1851, 'grad_norm': 3.815045118331909, 'learning_rate': 9.618837722545966e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:16,  1.65it/s] 35%|███▌      | 14/40 [00:08<00:15,  1.66it/s]                                               {'loss': 1.7643, 'grad_norm': 3.404924154281616, 'learning_rate': 9.27530780388361e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:15,  1.66it/s] 38%|███▊      | 15/40 [00:09<00:14,  1.68it/s]                                               {'loss': 1.8958, 'grad_norm': 4.132413387298584, 'learning_rate': 8.931777885221255e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:14,  1.68it/s] 40%|████      | 16/40 [00:09<00:10,  2.19it/s]                                               {'loss': 1.9101, 'grad_norm': 11.648801803588867, 'learning_rate': 8.588247966558899e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:10,  2.19it/s] 42%|████▎     | 17/40 [00:09<00:11,  2.00it/s]                                               {'loss': 1.953, 'grad_norm': 4.211116313934326, 'learning_rate': 8.244718047896542e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:11,  2.00it/s] 45%|████▌     | 18/40 [00:10<00:11,  1.90it/s]                                               {'loss': 2.1847, 'grad_norm': 4.67885160446167, 'learning_rate': 7.901188129234186e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:11,  1.90it/s] 48%|████▊     | 19/40 [00:11<00:11,  1.84it/s]                                               {'loss': 1.9466, 'grad_norm': 3.7370083332061768, 'learning_rate': 7.557658210571832e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:11,  1.84it/s] 50%|█████     | 20/40 [00:11<00:10,  1.83it/s]                                               {'loss': 1.8373, 'grad_norm': 4.906589508056641, 'learning_rate': 7.214128291909475e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:10,  1.83it/s] 52%|█████▎    | 21/40 [00:12<00:10,  1.82it/s]                                               {'loss': 2.2704, 'grad_norm': 4.540384292602539, 'learning_rate': 6.870598373247119e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:10,  1.82it/s] 55%|█████▌    | 22/40 [00:12<00:09,  1.82it/s]                                               {'loss': 1.7684, 'grad_norm': 3.2858293056488037, 'learning_rate': 6.527068454584762e-05, 'epoch': 2.75}
 55%|█████▌    | 22/40 [00:12<00:09,  1.82it/s] 57%|█████▊    | 23/40 [00:13<00:09,  1.80it/s]                                               {'loss': 1.9531, 'grad_norm': 4.558693885803223, 'learning_rate': 6.183538535922407e-05, 'epoch': 2.88}
 57%|█████▊    | 23/40 [00:13<00:09,  1.80it/s] 60%|██████    | 24/40 [00:13<00:07,  2.29it/s]                                               {'loss': 1.8214, 'grad_norm': 14.291531562805176, 'learning_rate': 5.8400086172600505e-05, 'epoch': 3.0}
 60%|██████    | 24/40 [00:13<00:07,  2.29it/s] 62%|██████▎   | 25/40 [00:13<00:07,  2.12it/s]                                               {'loss': 1.9329, 'grad_norm': 4.2359843254089355, 'learning_rate': 5.496478698597695e-05, 'epoch': 3.12}
 62%|██████▎   | 25/40 [00:13<00:07,  2.12it/s] 65%|██████▌   | 26/40 [00:14<00:06,  2.01it/s]                                               {'loss': 1.7172, 'grad_norm': 2.9119374752044678, 'learning_rate': 5.152948779935339e-05, 'epoch': 3.25}
 65%|██████▌   | 26/40 [00:14<00:06,  2.01it/s] 68%|██████▊   | 27/40 [00:15<00:06,  1.94it/s]                                               {'loss': 1.8921, 'grad_norm': 2.8389499187469482, 'learning_rate': 4.809418861272983e-05, 'epoch': 3.38}
 68%|██████▊   | 27/40 [00:15<00:06,  1.94it/s] 70%|███████   | 28/40 [00:15<00:06,  1.89it/s]                                               {'loss': 2.1031, 'grad_norm': 5.730923175811768, 'learning_rate': 4.465888942610628e-05, 'epoch': 3.5}
 70%|███████   | 28/40 [00:15<00:06,  1.89it/s] 72%|███████▎  | 29/40 [00:16<00:05,  1.87it/s]                                               {'loss': 1.8449, 'grad_norm': 3.124368190765381, 'learning_rate': 4.122359023948271e-05, 'epoch': 3.62}
 72%|███████▎  | 29/40 [00:16<00:05,  1.87it/s] 75%|███████▌  | 30/40 [00:16<00:05,  1.80it/s]                                               {'loss': 2.011, 'grad_norm': 5.002831935882568, 'learning_rate': 3.778829105285916e-05, 'epoch': 3.75}
 75%|███████▌  | 30/40 [00:16<00:05,  1.80it/s] 78%|███████▊  | 31/40 [00:17<00:05,  1.69it/s]                                               {'loss': 2.0478, 'grad_norm': 4.126353740692139, 'learning_rate': 3.4352991866235594e-05, 'epoch': 3.88}
 78%|███████▊  | 31/40 [00:17<00:05,  1.69it/s] 80%|████████  | 32/40 [00:17<00:03,  2.13it/s]                                               {'loss': 1.2417, 'grad_norm': 12.490164756774902, 'learning_rate': 3.0917692679612035e-05, 'epoch': 4.0}
 80%|████████  | 32/40 [00:17<00:03,  2.13it/s] 82%|████████▎ | 33/40 [00:18<00:03,  1.92it/s]                                               {'loss': 2.0936, 'grad_norm': 4.590278148651123, 'learning_rate': 2.7482393492988477e-05, 'epoch': 4.12}
 82%|████████▎ | 33/40 [00:18<00:03,  1.92it/s] 85%|████████▌ | 34/40 [00:18<00:03,  1.78it/s]                                               {'loss': 1.765, 'grad_norm': 3.6057426929473877, 'learning_rate': 2.4047094306364915e-05, 'epoch': 4.25}
 85%|████████▌ | 34/40 [00:18<00:03,  1.78it/s] 88%|████████▊ | 35/40 [00:19<00:02,  1.71it/s]                                               {'loss': 1.987, 'grad_norm': 3.7692642211914062, 'learning_rate': 2.0611795119741356e-05, 'epoch': 4.38}
 88%|████████▊ | 35/40 [00:19<00:02,  1.71it/s] 90%|█████████ | 36/40 [00:20<00:02,  1.65it/s]                                               {'loss': 2.1092, 'grad_norm': 3.847531795501709, 'learning_rate': 1.7176495933117797e-05, 'epoch': 4.5}
 90%|█████████ | 36/40 [00:20<00:02,  1.65it/s] 92%|█████████▎| 37/40 [00:20<00:01,  1.61it/s]                                               {'loss': 1.8164, 'grad_norm': 3.127977132797241, 'learning_rate': 1.3741196746494238e-05, 'epoch': 4.62}
 92%|█████████▎| 37/40 [00:20<00:01,  1.61it/s] 95%|█████████▌| 38/40 [00:21<00:01,  1.61it/s]                                               {'loss': 1.7901, 'grad_norm': 5.358456611633301, 'learning_rate': 1.0305897559870678e-05, 'epoch': 4.75}
 95%|█████████▌| 38/40 [00:21<00:01,  1.61it/s] 98%|█████████▊| 39/40 [00:22<00:00,  1.57it/s]                                               {'loss': 1.9253, 'grad_norm': 3.373192548751831, 'learning_rate': 6.870598373247119e-06, 'epoch': 4.88}
 98%|█████████▊| 39/40 [00:22<00:00,  1.57it/s]100%|██████████| 40/40 [00:22<00:00,  2.02it/s]                                               {'loss': 2.5044, 'grad_norm': 14.01120662689209, 'learning_rate': 3.4352991866235596e-06, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.02it/s]                                               {'train_runtime': 22.4848, 'train_samples_per_second': 25.128, 'train_steps_per_second': 1.779, 'train_loss': 1.995666366815567, 'epoch': 5.0}
100%|██████████| 40/40 [00:22<00:00,  2.02it/s]100%|██████████| 40/40 [00:22<00:00,  1.78it/s]
CLIENT:84
/home/suxiaoxin/Paper/Fed_LLM/fed_trainer.py:334: FutureWarning: `tokenizer` is deprecated and will be removed in version 5.0.0 for `Trainer.__init__`. Use `processing_class` instead.
  #   learning_rate=lr,
No label_names provided for model class `PeftModelForCausalLM`. Since `PeftModel` hides base models input arguments, if label_names is not given, label_names can't be set automatically within `Trainer`. Note that empty label_names list will be used instead.
  0%|          | 0/40 [00:00<?, ?it/s]  2%|▎         | 1/40 [00:00<00:23,  1.63it/s]                                              {'loss': 1.721, 'grad_norm': 3.2036378383636475, 'learning_rate': 0.00013741196746494238, 'epoch': 0.12}
  2%|▎         | 1/40 [00:00<00:23,  1.63it/s]  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]                                              {'loss': 2.1543, 'grad_norm': 3.992953062057495, 'learning_rate': 0.0001339766682783188, 'epoch': 0.25}
  5%|▌         | 2/40 [00:01<00:24,  1.58it/s]  8%|▊         | 3/40 [00:01<00:23,  1.57it/s]                                              {'loss': 1.945, 'grad_norm': 3.582534074783325, 'learning_rate': 0.00013054136909169525, 'epoch': 0.38}
  8%|▊         | 3/40 [00:01<00:23,  1.57it/s] 10%|█         | 4/40 [00:02<00:22,  1.63it/s]                                              {'loss': 2.1418, 'grad_norm': 5.112131118774414, 'learning_rate': 0.0001271060699050717, 'epoch': 0.5}
 10%|█         | 4/40 [00:02<00:22,  1.63it/s] 12%|█▎        | 5/40 [00:03<00:20,  1.69it/s]                                              {'loss': 1.8033, 'grad_norm': 4.171511650085449, 'learning_rate': 0.00012367077071844814, 'epoch': 0.62}
 12%|█▎        | 5/40 [00:03<00:20,  1.69it/s] 15%|█▌        | 6/40 [00:03<00:20,  1.63it/s]                                              {'loss': 2.3593, 'grad_norm': 5.736859321594238, 'learning_rate': 0.00012023547153182458, 'epoch': 0.75}
 15%|█▌        | 6/40 [00:03<00:20,  1.63it/s] 18%|█▊        | 7/40 [00:04<00:20,  1.61it/s]                                              {'loss': 2.0542, 'grad_norm': 4.816017150878906, 'learning_rate': 0.00011680017234520101, 'epoch': 0.88}
 18%|█▊        | 7/40 [00:04<00:20,  1.61it/s] 20%|██        | 8/40 [00:04<00:15,  2.06it/s]                                              {'loss': 0.7948, 'grad_norm': 6.8295464515686035, 'learning_rate': 0.00011336487315857746, 'epoch': 1.0}
 20%|██        | 8/40 [00:04<00:15,  2.06it/s] 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s]                                              {'loss': 2.2884, 'grad_norm': 3.684014320373535, 'learning_rate': 0.0001099295739719539, 'epoch': 1.12}
 22%|██▎       | 9/40 [00:05<00:16,  1.87it/s] 25%|██▌       | 10/40 [00:05<00:17,  1.75it/s]                                               {'loss': 1.9344, 'grad_norm': 4.043766498565674, 'learning_rate': 0.00010649427478533034, 'epoch': 1.25}
 25%|██▌       | 10/40 [00:05<00:17,  1.75it/s] 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s]                                               {'loss': 1.7815, 'grad_norm': 3.802236557006836, 'learning_rate': 0.00010305897559870678, 'epoch': 1.38}
 28%|██▊       | 11/40 [00:06<00:17,  1.70it/s] 30%|███       | 12/40 [00:07<00:17,  1.63it/s]                                               {'loss': 1.9272, 'grad_norm': 4.50709867477417, 'learning_rate': 9.962367641208322e-05, 'epoch': 1.5}
 30%|███       | 12/40 [00:07<00:17,  1.63it/s] 32%|███▎      | 13/40 [00:07<00:16,  1.61it/s]                                               {'loss': 1.6571, 'grad_norm': 2.8505055904388428, 'learning_rate': 9.618837722545966e-05, 'epoch': 1.62}
 32%|███▎      | 13/40 [00:07<00:16,  1.61it/s] 35%|███▌      | 14/40 [00:08<00:16,  1.58it/s]                                               {'loss': 2.1411, 'grad_norm': 3.6868622303009033, 'learning_rate': 9.27530780388361e-05, 'epoch': 1.75}
 35%|███▌      | 14/40 [00:08<00:16,  1.58it/s] 38%|███▊      | 15/40 [00:09<00:16,  1.55it/s]                                               {'loss': 1.8691, 'grad_norm': 4.546180248260498, 'learning_rate': 8.931777885221255e-05, 'epoch': 1.88}
 38%|███▊      | 15/40 [00:09<00:16,  1.55it/s] 40%|████      | 16/40 [00:09<00:11,  2.01it/s]                                               {'loss': 1.4887, 'grad_norm': 8.060486793518066, 'learning_rate': 8.588247966558899e-05, 'epoch': 2.0}
 40%|████      | 16/40 [00:09<00:11,  2.01it/s] 42%|████▎     | 17/40 [00:09<00:12,  1.84it/s]                                               {'loss': 1.9182, 'grad_norm': 4.478163719177246, 'learning_rate': 8.244718047896542e-05, 'epoch': 2.12}
 42%|████▎     | 17/40 [00:09<00:12,  1.84it/s] 45%|████▌     | 18/40 [00:10<00:12,  1.73it/s]                                               {'loss': 1.9344, 'grad_norm': 3.65297269821167, 'learning_rate': 7.901188129234186e-05, 'epoch': 2.25}
 45%|████▌     | 18/40 [00:10<00:12,  1.73it/s] 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s]                                               {'loss': 2.0285, 'grad_norm': 4.884296417236328, 'learning_rate': 7.557658210571832e-05, 'epoch': 2.38}
 48%|████▊     | 19/40 [00:11<00:12,  1.67it/s] 50%|█████     | 20/40 [00:11<00:12,  1.63it/s]                                               {'loss': 1.8982, 'grad_norm': 7.629284381866455, 'learning_rate': 7.214128291909475e-05, 'epoch': 2.5}
 50%|█████     | 20/40 [00:11<00:12,  1.63it/s] 52%|█████▎    | 21/40 [00:12<00:11,  1.61it/s]                                               {'loss': 1.8717, 'grad_norm': 4.123106479644775, 'learning_rate': 6.870598373247119e-05, 'epoch': 2.62}
 52%|█████▎    | 21/40 [00:12<00:11,  1.61it/s]